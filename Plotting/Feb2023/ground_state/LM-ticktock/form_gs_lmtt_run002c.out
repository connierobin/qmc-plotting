Rank =    0  Free Memory = 67956 MB
Rank =    1  Free Memory = 67955 MB
Rank =    2  Free Memory = 67955 MB
Rank =    3  Free Memory = 67955 MB
Rank =    4  Free Memory = 67955 MB
Rank =    5  Free Memory = 67955 MB
Rank =    6  Free Memory = 67954 MB
Rank =    7  Free Memory = 67954 MB
Rank =    8  Free Memory = 67954 MB
Rank =    9  Free Memory = 67954 MB
Rank =   10  Free Memory = 67954 MB
Rank =   11  Free Memory = 67954 MB
Rank =   12  Free Memory = 67954 MB
Rank =   13  Free Memory = 67954 MB
Rank =   14  Free Memory = 67953 MB
Rank =   15  Free Memory = 67939 MB
Rank =   16  Free Memory = 67938 MB
Rank =   17  Free Memory = 67938 MB
Rank =   18  Free Memory = 67938 MB
Rank =   19  Free Memory = 67938 MB
Rank =   20  Free Memory = 67938 MB
Rank =   21  Free Memory = 67938 MB
Rank =   22  Free Memory = 67938 MB
Rank =   23  Free Memory = 67938 MB
Rank =   24  Free Memory = 67938 MB
Rank =   25  Free Memory = 67938 MB
Rank =   26  Free Memory = 67938 MB
Rank =   27  Free Memory = 67938 MB
Rank =   28  Free Memory = 67938 MB
Rank =   29  Free Memory = 67938 MB
Rank =   30  Free Memory = 67938 MB
Rank =   31  Free Memory = 67938 MB
Rank =   32  Free Memory = 13039 MB
Rank =   33  Free Memory = 13039 MB
Rank =   34  Free Memory = 13039 MB
Rank =   35  Free Memory = 13039 MB
Rank =   36  Free Memory = 13039 MB
Rank =   37  Free Memory = 13039 MB
Rank =   38  Free Memory = 13039 MB
Rank =   39  Free Memory = 13039 MB
Rank =   40  Free Memory = 13039 MB
Rank =   41  Free Memory = 13039 MB
Rank =   42  Free Memory = 13039 MB
Rank =   43  Free Memory = 13039 MB
Rank =   44  Free Memory = 13039 MB
Rank =   45  Free Memory = 13039 MB
Rank =   46  Free Memory = 13039 MB
Rank =   47  Free Memory = 13039 MB
Rank =   48  Free Memory = 13039 MB
Rank =   49  Free Memory = 13039 MB
Rank =   50  Free Memory = 13039 MB
Rank =   51  Free Memory = 13039 MB
Rank =   52  Free Memory = 13039 MB
Rank =   53  Free Memory = 13039 MB
Rank =   54  Free Memory = 13039 MB
Rank =   55  Free Memory = 13039 MB
Rank =   56  Free Memory = 13039 MB
Rank =   57  Free Memory = 13039 MB
Rank =   58  Free Memory = 13039 MB
Rank =   59  Free Memory = 13039 MB
Rank =   60  Free Memory = 13039 MB
Rank =   61  Free Memory = 13039 MB
Rank =   62  Free Memory = 13039 MB
Rank =   63  Free Memory = 13039 MB
Rank =   64  Free Memory = 90523 MB
Rank =   65  Free Memory = 90523 MB
Rank =   66  Free Memory = 90522 MB
Rank =   67  Free Memory = 90522 MB
Rank =   68  Free Memory = 90522 MB
Rank =   69  Free Memory = 90522 MB
Rank =   70  Free Memory = 90522 MB
Rank =   71  Free Memory = 90522 MB
Rank =   72  Free Memory = 90522 MB
Rank =   73  Free Memory = 90522 MB
Rank =   74  Free Memory = 90522 MB
Rank =   75  Free Memory = 90522 MB
Rank =   76  Free Memory = 90522 MB
Rank =   77  Free Memory = 90522 MB
Rank =   78  Free Memory = 90522 MB
Rank =   79  Free Memory = 90522 MB
Rank =   80  Free Memory = 90522 MB
Rank =   81  Free Memory = 90522 MB
Rank =   82  Free Memory = 90522 MB
Rank =   83  Free Memory = 90522 MB
Rank =   84  Free Memory = 90522 MB
Rank =   85  Free Memory = 90522 MB
Rank =   86  Free Memory = 90522 MB
Rank =   87  Free Memory = 90522 MB
Rank =   88  Free Memory = 90522 MB
Rank =   89  Free Memory = 90522 MB
Rank =   90  Free Memory = 90522 MB
Rank =   91  Free Memory = 90522 MB
Rank =   92  Free Memory = 90522 MB
Rank =   93  Free Memory = 90522 MB
Rank =   94  Free Memory = 90522 MB
Rank =   95  Free Memory = 90522 MB
Rank =   96  Free Memory = 90307 MB
Rank =   97  Free Memory = 90307 MB
Rank =   98  Free Memory = 90307 MB
Rank =   99  Free Memory = 90307 MB
Rank =  100  Free Memory = 90307 MB
Rank =  101  Free Memory = 90307 MB
Rank =  102  Free Memory = 90307 MB
Rank =  103  Free Memory = 90307 MB
Rank =  104  Free Memory = 90307 MB
Rank =  105  Free Memory = 90307 MB
Rank =  106  Free Memory = 90307 MB
Rank =  107  Free Memory = 90307 MB
Rank =  108  Free Memory = 90307 MB
Rank =  109  Free Memory = 90307 MB
Rank =  110  Free Memory = 90307 MB
Rank =  111  Free Memory = 90307 MB
Rank =  112  Free Memory = 90307 MB
Rank =  113  Free Memory = 90307 MB
Rank =  114  Free Memory = 90307 MB
Rank =  115  Free Memory = 90307 MB
Rank =  116  Free Memory = 90307 MB
Rank =  117  Free Memory = 90307 MB
Rank =  118  Free Memory = 90307 MB
Rank =  119  Free Memory = 90307 MB
Rank =  120  Free Memory = 90307 MB
Rank =  121  Free Memory = 90307 MB
Rank =  122  Free Memory = 90307 MB
Rank =  123  Free Memory = 90307 MB
Rank =  124  Free Memory = 90307 MB
Rank =  125  Free Memory = 90307 MB
Rank =  126  Free Memory = 90307 MB
Rank =  127  Free Memory = 90307 MB
  Input file(s): opt_form_gs_lmtt_run002c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmtt_run002c.xml

  Project = FORM
  date    = 2023-03-22 15:37:52 PDT
  host    = n0062.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 832

  Range of prime numbers to use as seeds over processors and threads = 6397-7577


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.698102e-01    1         1 OFF
     uu_1                 9.665357e-02    1         1 OFF
     uu_2                -1.327459e-02    1         1 OFF
     uu_3                -7.674599e-02    1         1 OFF
     uu_4                -1.116158e-01    1         1 OFF
     uu_5                -1.303494e-01    1         1 OFF
     uu_6                -1.376914e-01    1         1 OFF
     uu_7                -1.300062e-01    1         1 OFF
     uu_8                -1.021693e-01    1         1 OFF
     uu_9                -2.842946e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.202002e-01    1         1 OFF
     ud_1                 1.390606e-01    1         1 OFF
     ud_2                -4.416736e-03    1         1 OFF
     ud_3                -8.148136e-02    1         1 OFF
     ud_4                -1.251239e-01    1         1 OFF
     ud_5                -1.500578e-01    1         1 OFF
     ud_6                -1.614465e-01    1         1 OFF
     ud_7                -1.567494e-01    1         1 OFF
     ud_8                -1.287947e-01    1         1 OFF
     ud_9                -5.772753e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.240832e-01    1         1 OFF
     eC_1                -3.672225e-01    1         1 OFF
     eC_2                -1.081697e-01    1         1 OFF
     eC_3                 5.388845e-02    1         1 OFF
     eC_4                 1.199591e-01    1         1 OFF
     eC_5                 2.194359e-01    1         1 OFF
     eC_6                 2.931217e-01    1         1 OFF
     eC_7                 2.355001e-01    1         1 OFF
     eC_8                 6.498786e-02    1         1 OFF
     eC_9                 1.087976e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.074573e+00    1         1 OFF
     eO_1                -7.029185e-01    1         1 OFF
     eO_2                -2.385368e-01    1         1 OFF
     eO_3                 8.416229e-02    1         1 OFF
     eO_4                 2.802689e-01    1         1 OFF
     eO_5                 4.227613e-01    1         1 OFF
     eO_6                 4.544062e-01    1         1 OFF
     eO_7                 4.330615e-01    1         1 OFF
     eO_8                 2.181507e-01    1         1 OFF
     eO_9                 8.082887e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.500931e-01    1         1 OFF
     eH1_1                -6.495886e-02    1         1 OFF
     eH1_2                -3.782840e-02    1         1 OFF
     eH1_3                -3.268237e-02    1         1 OFF
     eH1_4                 1.395443e-02    1         1 OFF
     eH1_5                 5.181481e-02    1         1 OFF
     eH1_6                 8.818766e-02    1         1 OFF
     eH1_7                 4.426934e-02    1         1 OFF
     eH1_8                 1.894238e-02    1         1 OFF
     eH1_9                 4.871976e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.526212e-01    1         1 OFF
     eH2_1                -6.644694e-02    1         1 OFF
     eH2_2                -3.941396e-02    1         1 OFF
     eH2_3                -3.451400e-02    1         1 OFF
     eH2_4                 1.189266e-02    1         1 OFF
     eH2_5                 4.974328e-02    1         1 OFF
     eH2_6                 8.511204e-02    1         1 OFF
     eH2_7                 4.176728e-02    1         1 OFF
     eH2_8                 2.148805e-02    1         1 OFF
     eH2_9                 5.754678e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.742340e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.1587e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8838
    reference variance = 0.445205
====================================================
  Execution time = 1.0134e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1358e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0022e-01
  Total weights = 7.856644575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8560e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484034381634
                                         uncertainty =       0.001270459264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484034381634
                                         uncertainty =       0.001270459264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245976550
  error estimate for blocks of size 2^( 2) =       0.000255052094
  error estimate for blocks of size 2^( 3) =       0.000263125611
  error estimate for blocks of size 2^( 4) =       0.000269089027
  error estimate for blocks of size 2^( 5) =       0.000272404605
  error estimate for blocks of size 2^( 6) =       0.000274208682
  error estimate for blocks of size 2^( 7) =       0.000275632633
  error estimate for blocks of size 2^( 8) =       0.000275197251
  error estimate for blocks of size 2^( 9) =       0.000275637355

      target function =                  N/A
              le_mean =     -22.824015081634
             les_mean =     521.435884257224
             stat err =       0.000275168980
             autocorr =       1.251444338652
              std dev =       0.695726745613
             le_variance =       0.484035704561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.282401508163e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824015081632       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824083000588       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824084214701       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824084681949       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.926671e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824015081632       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824040396375       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824040650020       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824040716429       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.297980e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824015081632       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824022295593       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824022379800       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824022389357       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.831500e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2269e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.157524e-01                 3 1 ON  0
ci_02 -2.504274e-02                3 1 ON  1
ci_03 -2.518474e-02                3 1 ON  2
ci_04 2.458525e-02                 3 1 ON  3
ci_05 -2.284271e-02                3 1 ON  4
ci_06 -2.227984e-02                3 1 ON  5
ci_07 2.495103e-02                 3 1 ON  6
ci_08 -4.426271e-03                3 1 ON  7
ci_09 -1.123681e-02                3 1 ON  8
ci_10 -1.161612e-02                3 1 ON  9
ci_11 1.630910e-02                 3 1 ON  10
ci_12 1.118498e-02                 3 1 ON  11
ci_13 1.211177e-02                 3 1 ON  12
ci_14 1.757170e-02                 3 1 ON  13
ci_15 8.516612e-03                 3 1 ON  14
ci_16 8.455685e-03                 3 1 ON  15
ci_17 -1.041953e-02                3 1 ON  16
ci_18 -9.322764e-03                3 1 ON  17
ci_19 9.313560e-03                 3 1 ON  18
ci_20 1.033463e-02                 3 1 ON  19
ci_21 8.510149e-03                 3 1 ON  20
ci_22 7.648280e-03                 3 1 ON  21
ci_23 5.956241e-03                 3 1 ON  22
ci_24 6.222604e-03                 3 1 ON  23
ci_25 5.043614e-03                 3 1 ON  24
ci_26 3.142677e-03                 3 1 ON  25
ci_27 2.816272e-03                 3 1 ON  26
ci_28 4.429643e-03                 3 1 ON  27
ci_29 3.549947e-03                 3 1 ON  28
ci_30 -6.185118e-04                3 1 ON  29
ci_31 3.210050e-04                 3 1 ON  30
ci_32 4.330019e-04                 3 1 ON  31
ci_33 -9.934182e-05                3 1 ON  32
ci_34 1.926880e-04                 3 1 ON  33
ci_35 1.712244e-03                 3 1 ON  34
ci_36 -1.054377e-03                3 1 ON  35
ci_37 -6.665784e-04                3 1 ON  36
ci_38 -8.375662e-04                3 1 ON  37
ci_39 -3.942278e-04                3 1 ON  38
ci_40 -1.142208e-03                3 1 ON  39
ci_41 6.885115e-04                 3 1 ON  40
ci_42 3.590509e-04                 3 1 ON  41
ci_43 -1.981670e-03                3 1 ON  42
ci_44 -2.219366e-03                3 1 ON  43
ci_45 -2.632224e-04                3 1 ON  44
ci_46 -2.901047e-04                3 1 ON  45
ci_47 -3.830910e-04                3 1 ON  46
ci_48 -7.368252e-04                3 1 ON  47
ci_49 -1.304173e-03                3 1 ON  48
ci_50 -7.091332e-04                3 1 ON  49
ci_51 2.450259e-05                 3 1 ON  50
ci_52 -5.474021e-04                3 1 ON  51
ci_53 -1.413946e-03                3 1 ON  52
ci_54 -1.024849e-03                3 1 ON  53
ci_55 -1.370077e-03                3 1 ON  54
ci_56 1.687105e-03                 3 1 ON  55
ci_57 1.540587e-03                 3 1 ON  56
ci_58 -1.335864e-03                3 1 ON  57
ci_59 -1.120626e-03                3 1 ON  58
ci_60 8.408859e-04                 3 1 ON  59
ci_61 2.284814e-03                 3 1 ON  60
ci_62 -5.528969e-04                3 1 ON  61
ci_63 -7.340530e-04                3 1 ON  62
ci_64 -1.229368e-04                3 1 ON  63
ci_65 -2.732994e-04                3 1 ON  64
ci_66 -2.867704e-04                3 1 ON  65
ci_67 -9.532561e-04                3 1 ON  66
ci_68 -2.424818e-03                3 1 ON  67
ci_69 -1.663736e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.9336
    reference variance = 0.423534
====================================================
  Execution time = 9.8185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0285e-01
  Total weights = 7.8570e+06
  Execution time = 1.4197e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR Start of engine's reset
Before block part of reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.69504e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486763551703
                                         uncertainty =       0.001957419254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486763551703
                                         uncertainty =       0.001957419254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246668858
  error estimate for blocks of size 2^( 2) =       0.000255755981
  error estimate for blocks of size 2^( 3) =       0.000263931060
  error estimate for blocks of size 2^( 4) =       0.000269703442
  error estimate for blocks of size 2^( 5) =       0.000273382603
  error estimate for blocks of size 2^( 6) =       0.000275430265
  error estimate for blocks of size 2^( 7) =       0.000276329024
  error estimate for blocks of size 2^( 8) =       0.000277344685
  error estimate for blocks of size 2^( 9) =       0.000277269092

      target function =                  N/A
              le_mean =     -22.824643911114
             les_mean =     521.483476278908
             stat err =       0.000276593267
             autocorr =       1.257345295773
              std dev =       0.697684888334
             le_variance =       0.486764203409

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.64295e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486175993039
                                         uncertainty =       0.001939364149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486175993039
                                         uncertainty =       0.001939364149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246519915
  error estimate for blocks of size 2^( 2) =       0.000255633986
  error estimate for blocks of size 2^( 3) =       0.000263833807
  error estimate for blocks of size 2^( 4) =       0.000269632803
  error estimate for blocks of size 2^( 5) =       0.000273323720
  error estimate for blocks of size 2^( 6) =       0.000275383234
  error estimate for blocks of size 2^( 7) =       0.000276304094
  error estimate for blocks of size 2^( 8) =       0.000277333380
  error estimate for blocks of size 2^( 9) =       0.000277240845

      target function =                  N/A
              le_mean =     -22.824647952555
             les_mean =     521.912927855944
             stat err =       0.000276565388
             autocorr =       1.258611327158
              std dev =       0.697263614992
             le_variance =       0.486176548792

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.69495e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486198272899
                                         uncertainty =       0.001940857156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486198272899
                                         uncertainty =       0.001940857156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246525592
  error estimate for blocks of size 2^( 2) =       0.000255631494
  error estimate for blocks of size 2^( 3) =       0.000263825649
  error estimate for blocks of size 2^( 4) =       0.000269616288
  error estimate for blocks of size 2^( 5) =       0.000273299868
  error estimate for blocks of size 2^( 6) =       0.000275355798
  error estimate for blocks of size 2^( 7) =       0.000276270871
  error estimate for blocks of size 2^( 8) =       0.000277294614
  error estimate for blocks of size 2^( 9) =       0.000277214914

      target function =                  N/A
              le_mean =     -22.824642303788
             les_mean =     521.469395187590
             stat err =       0.000276534049
             autocorr =       1.258268160179
              std dev =       0.697279669951
             le_variance =       0.486198938127

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 1.7942e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486670219292
                                         uncertainty =       0.001953806503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486670219292
                                         uncertainty =       0.001953806503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246645208
  error estimate for blocks of size 2^( 2) =       0.000255734946
  error estimate for blocks of size 2^( 3) =       0.000263913023
  error estimate for blocks of size 2^( 4) =       0.000269688858
  error estimate for blocks of size 2^( 5) =       0.000273368951
  error estimate for blocks of size 2^( 6) =       0.000275417924
  error estimate for blocks of size 2^( 7) =       0.000276318651
  error estimate for blocks of size 2^( 8) =       0.000277334759
  error estimate for blocks of size 2^( 9) =       0.000277256380

      target function =                  N/A
              le_mean =     -22.824641151467
             les_mean =     521.472223572283
             stat err =       0.000276581928
             autocorr =       1.257483334872
              std dev =       0.697617995323
             le_variance =       0.486670867398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824643911114        initial
     2.5000e-01     2.5000e+00             1.9267e-03       -22.824647952555  <--
     1.0000e+00     1.0000e+01             6.2980e-04       -22.824642303788
     4.0000e+00     4.0000e+01             1.8315e-04       -22.824641151467

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.6948e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.144288e-01 3 1  ON 0
ci_02                -2.429719e-02 3 1  ON 1
ci_03                -2.413976e-02 3 1  ON 2
ci_04                 2.360477e-02 3 1  ON 3
ci_05                -2.240687e-02 3 1  ON 4
ci_06                -2.209523e-02 3 1  ON 5
ci_07                 2.511637e-02 3 1  ON 6
ci_08                -4.180902e-03 3 1  ON 7
ci_09                -1.121133e-02 3 1  ON 8
ci_10                -1.127230e-02 3 1  ON 9
ci_11                 1.635698e-02 3 1  ON 10
ci_12                 1.117709e-02 3 1  ON 11
ci_13                 1.227152e-02 3 1  ON 12
ci_14                 1.738886e-02 3 1  ON 13
ci_15                 8.226741e-03 3 1  ON 14
ci_16                 8.184084e-03 3 1  ON 15
ci_17                -1.020940e-02 3 1  ON 16
ci_18                -9.329362e-03 3 1  ON 17
ci_19                 9.771005e-03 3 1  ON 18
ci_20                 1.046479e-02 3 1  ON 19
ci_21                 8.473637e-03 3 1  ON 20
ci_22                 7.943286e-03 3 1  ON 21
ci_23                 6.207891e-03 3 1  ON 22
ci_24                 6.489946e-03 3 1  ON 23
ci_25                 5.221050e-03 3 1  ON 24
ci_26                 2.959150e-03 3 1  ON 25
ci_27                 2.704388e-03 3 1  ON 26
ci_28                 4.019641e-03 3 1  ON 27
ci_29                 3.506788e-03 3 1  ON 28
ci_30                -2.375925e-04 3 1  ON 29
ci_31                 5.028951e-04 3 1  ON 30
ci_32                 3.167907e-04 3 1  ON 31
ci_33                 2.587080e-04 3 1  ON 32
ci_34                -2.575767e-05 3 1  ON 33
ci_35                 9.028728e-04 3 1  ON 34
ci_36                -8.670425e-04 3 1  ON 35
ci_37                -5.457147e-04 3 1  ON 36
ci_38                -6.030230e-04 3 1  ON 37
ci_39                -4.102051e-04 3 1  ON 38
ci_40                -1.280418e-03 3 1  ON 39
ci_41                 3.106975e-04 3 1  ON 40
ci_42                 1.854817e-05 3 1  ON 41
ci_43                -2.413786e-03 3 1  ON 42
ci_44                -2.550139e-03 3 1  ON 43
ci_45                -2.156583e-04 3 1  ON 44
ci_46                -1.320537e-04 3 1  ON 45
ci_47                -1.415336e-04 3 1  ON 46
ci_48                -4.464901e-04 3 1  ON 47
ci_49                -1.342821e-03 3 1  ON 48
ci_50                -6.521251e-04 3 1  ON 49
ci_51                -9.123278e-06 3 1  ON 50
ci_52                -3.828384e-04 3 1  ON 51
ci_53                -1.318591e-03 3 1  ON 52
ci_54                -9.684058e-04 3 1  ON 53
ci_55                -1.234812e-03 3 1  ON 54
ci_56                 1.723599e-03 3 1  ON 55
ci_57                 1.599748e-03 3 1  ON 56
ci_58                -1.457657e-03 3 1  ON 57
ci_59                -9.520940e-04 3 1  ON 58
ci_60                 8.679339e-04 3 1  ON 59
ci_61                 2.236807e-03 3 1  ON 60
ci_62                -3.180836e-04 3 1  ON 61
ci_63                -5.960429e-04 3 1  ON 62
ci_64                -1.218681e-04 3 1  ON 63
ci_65                -4.167146e-04 3 1  ON 64
ci_66                -3.755916e-04 3 1  ON 65
ci_67                -7.560434e-04 3 1  ON 66
ci_68                -2.186466e-03 3 1  ON 67
ci_69                -1.628557e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9220e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8561
    reference variance = 0.442145
====================================================
  Execution time = 9.8904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1337e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0179e-01
  Total weights = 7.856160625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9226e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482682319692
                                         uncertainty =       0.001338806866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482682319692
                                         uncertainty =       0.001338806866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245632533
  error estimate for blocks of size 2^( 2) =       0.000254658430
  error estimate for blocks of size 2^( 3) =       0.000262753914
  error estimate for blocks of size 2^( 4) =       0.000268793830
  error estimate for blocks of size 2^( 5) =       0.000272430922
  error estimate for blocks of size 2^( 6) =       0.000274325133
  error estimate for blocks of size 2^( 7) =       0.000275897130
  error estimate for blocks of size 2^( 8) =       0.000277048345
  error estimate for blocks of size 2^( 9) =       0.000277544554

      target function =                  N/A
              le_mean =     -22.824351694371
             les_mean =     521.452821263394
             stat err =       0.000276203790
             autocorr =       1.264408752516
              std dev =       0.694753720243
             le_variance =       0.482682731792


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282435169437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824351694363       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824380584045       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824384941948       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824385853878       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824386016037       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.851684e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824351694363       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824368111773       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824369490868       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824369595977       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.250751e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824351694363       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824357714923       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824358011312       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824358017226       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.897869e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1816e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.131781e-01 3 1  ON 0
ci_02                -2.322151e-02 3 1  ON 1
ci_03                -2.329248e-02 3 1  ON 2
ci_04                 2.289655e-02 3 1  ON 3
ci_05                -2.206104e-02 3 1  ON 4
ci_06                -2.162009e-02 3 1  ON 5
ci_07                 2.528227e-02 3 1  ON 6
ci_08                -3.826866e-03 3 1  ON 7
ci_09                -1.111946e-02 3 1  ON 8
ci_10                -1.099728e-02 3 1  ON 9
ci_11                 1.653274e-02 3 1  ON 10
ci_12                 1.087702e-02 3 1  ON 11
ci_13                 1.248075e-02 3 1  ON 12
ci_14                 1.742396e-02 3 1  ON 13
ci_15                 7.917838e-03 3 1  ON 14
ci_16                 7.943739e-03 3 1  ON 15
ci_17                -9.861131e-03 3 1  ON 16
ci_18                -9.239348e-03 3 1  ON 17
ci_19                 9.675800e-03 3 1  ON 18
ci_20                 1.041850e-02 3 1  ON 19
ci_21                 8.237681e-03 3 1  ON 20
ci_22                 7.880260e-03 3 1  ON 21
ci_23                 6.195740e-03 3 1  ON 22
ci_24                 7.080127e-03 3 1  ON 23
ci_25                 5.534702e-03 3 1  ON 24
ci_26                 2.919830e-03 3 1  ON 25
ci_27                 2.544626e-03 3 1  ON 26
ci_28                 3.415331e-03 3 1  ON 27
ci_29                 3.277923e-03 3 1  ON 28
ci_30                 2.365617e-04 3 1  ON 29
ci_31                 7.194464e-04 3 1  ON 30
ci_32                 2.757335e-04 3 1  ON 31
ci_33                 2.554753e-05 3 1  ON 32
ci_34                -4.254142e-04 3 1  ON 33
ci_35                 6.405748e-04 3 1  ON 34
ci_36                -9.915304e-04 3 1  ON 35
ci_37                -5.884773e-04 3 1  ON 36
ci_38                -6.021927e-04 3 1  ON 37
ci_39                -2.809364e-04 3 1  ON 38
ci_40                -1.433224e-03 3 1  ON 39
ci_41                 2.306602e-04 3 1  ON 40
ci_42                 8.902848e-05 3 1  ON 41
ci_43                -2.248326e-03 3 1  ON 42
ci_44                -2.628489e-03 3 1  ON 43
ci_45                -3.275634e-04 3 1  ON 44
ci_46                -4.877888e-04 3 1  ON 45
ci_47                -1.839002e-04 3 1  ON 46
ci_48                -4.263078e-04 3 1  ON 47
ci_49                -1.250301e-03 3 1  ON 48
ci_50                -5.497261e-04 3 1  ON 49
ci_51                -6.329195e-05 3 1  ON 50
ci_52                -3.121703e-04 3 1  ON 51
ci_53                -1.053830e-03 3 1  ON 52
ci_54                -1.232410e-03 3 1  ON 53
ci_55                -1.136003e-03 3 1  ON 54
ci_56                 1.632729e-03 3 1  ON 55
ci_57                 1.666489e-03 3 1  ON 56
ci_58                -1.159310e-03 3 1  ON 57
ci_59                -1.179896e-03 3 1  ON 58
ci_60                 7.320635e-04 3 1  ON 59
ci_61                 2.114079e-03 3 1  ON 60
ci_62                -2.970102e-04 3 1  ON 61
ci_63                -4.555367e-04 3 1  ON 62
ci_64                -4.671003e-04 3 1  ON 63
ci_65                -4.092556e-04 3 1  ON 64
ci_66                -3.058880e-04 3 1  ON 65
ci_67                -9.698111e-04 3 1  ON 66
ci_68                -2.018127e-03 3 1  ON 67
ci_69                -1.663459e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7811
    reference variance = 0.595689
====================================================
  Execution time = 9.9826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0312e-01
  Total weights = 7.8563e+06
  Execution time = 1.4188e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486680389616
                                         uncertainty =       0.001421328301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486680389616
                                         uncertainty =       0.001421328301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246648598
  error estimate for blocks of size 2^( 2) =       0.000255925756
  error estimate for blocks of size 2^( 3) =       0.000264002519
  error estimate for blocks of size 2^( 4) =       0.000269756710
  error estimate for blocks of size 2^( 5) =       0.000273238089
  error estimate for blocks of size 2^( 6) =       0.000275027024
  error estimate for blocks of size 2^( 7) =       0.000276976179
  error estimate for blocks of size 2^( 8) =       0.000277990993
  error estimate for blocks of size 2^( 9) =       0.000278823229

      target function =                  N/A
              le_mean =     -22.824548706505
             les_mean =     521.538848940237
             stat err =       0.000277204356
             autocorr =       1.263114733089
              std dev =       0.697627584283
             le_variance =       0.486684246352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485996026728
                                         uncertainty =       0.001413611282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485996026728
                                         uncertainty =       0.001413611282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246475127
  error estimate for blocks of size 2^( 2) =       0.000255781201
  error estimate for blocks of size 2^( 3) =       0.000263889974
  error estimate for blocks of size 2^( 4) =       0.000269669769
  error estimate for blocks of size 2^( 5) =       0.000273158565
  error estimate for blocks of size 2^( 6) =       0.000274953913
  error estimate for blocks of size 2^( 7) =       0.000276920060
  error estimate for blocks of size 2^( 8) =       0.000277908292
  error estimate for blocks of size 2^( 9) =       0.000278678370

      target function =                  N/A
              le_mean =     -22.824528703172
             les_mean =     521.500686070943
             stat err =       0.000277115159
             autocorr =       1.264079438336
              std dev =       0.697136935900
             le_variance =       0.485999907396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488875099047
                                         uncertainty =       0.003040208129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488875099047
                                         uncertainty =       0.003040208129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247203897
  error estimate for blocks of size 2^( 2) =       0.000256490862
  error estimate for blocks of size 2^( 3) =       0.000264624040
  error estimate for blocks of size 2^( 4) =       0.000270392155
  error estimate for blocks of size 2^( 5) =       0.000273894737
  error estimate for blocks of size 2^( 6) =       0.000275721113
  error estimate for blocks of size 2^( 7) =       0.000277632775
  error estimate for blocks of size 2^( 8) =       0.000278724502
  error estimate for blocks of size 2^( 9) =       0.000279517283

      target function =                  N/A
              le_mean =     -22.824554874174
             les_mean =     522.379628223269
             stat err =       0.000277898918
             autocorr =       1.263755588511
              std dev =       0.699198206345
             le_variance =       0.488878131756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486356449328
                                         uncertainty =       0.001423435621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486356449328
                                         uncertainty =       0.001423435621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246566500
  error estimate for blocks of size 2^( 2) =       0.000255849485
  error estimate for blocks of size 2^( 3) =       0.000263935864
  error estimate for blocks of size 2^( 4) =       0.000269696203
  error estimate for blocks of size 2^( 5) =       0.000273177648
  error estimate for blocks of size 2^( 6) =       0.000274966274
  error estimate for blocks of size 2^( 7) =       0.000276917196
  error estimate for blocks of size 2^( 8) =       0.000277923092
  error estimate for blocks of size 2^( 9) =       0.000278723196

      target function =                  N/A
              le_mean =     -22.824536898204
             les_mean =     521.475610086534
             stat err =       0.000277132440
             autocorr =       1.263300273849
              std dev =       0.697395375349
             le_variance =       0.486360309558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824548706505        initial
     6.2500e-02     6.2500e-01             2.8517e-03       -22.824528703172
     2.5000e-01     2.5000e+00             1.2508e-03       -22.824554874174  <--
     1.0000e+00     1.0000e+01             3.8979e-04       -22.824536898204

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7109e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.131781e-01 3 1  ON 0
ci_02                -2.322151e-02 3 1  ON 1
ci_03                -2.329248e-02 3 1  ON 2
ci_04                 2.289655e-02 3 1  ON 3
ci_05                -2.206104e-02 3 1  ON 4
ci_06                -2.162009e-02 3 1  ON 5
ci_07                 2.528227e-02 3 1  ON 6
ci_08                -3.826866e-03 3 1  ON 7
ci_09                -1.111946e-02 3 1  ON 8
ci_10                -1.099728e-02 3 1  ON 9
ci_11                 1.653274e-02 3 1  ON 10
ci_12                 1.087702e-02 3 1  ON 11
ci_13                 1.248075e-02 3 1  ON 12
ci_14                 1.742396e-02 3 1  ON 13
ci_15                 7.917838e-03 3 1  ON 14
ci_16                 7.943739e-03 3 1  ON 15
ci_17                -9.861131e-03 3 1  ON 16
ci_18                -9.239348e-03 3 1  ON 17
ci_19                 9.675800e-03 3 1  ON 18
ci_20                 1.041850e-02 3 1  ON 19
ci_21                 8.237681e-03 3 1  ON 20
ci_22                 7.880260e-03 3 1  ON 21
ci_23                 6.195740e-03 3 1  ON 22
ci_24                 7.080127e-03 3 1  ON 23
ci_25                 5.534702e-03 3 1  ON 24
ci_26                 2.919830e-03 3 1  ON 25
ci_27                 2.544626e-03 3 1  ON 26
ci_28                 3.415331e-03 3 1  ON 27
ci_29                 3.277923e-03 3 1  ON 28
ci_30                 2.365617e-04 3 1  ON 29
ci_31                 7.194464e-04 3 1  ON 30
ci_32                 2.757335e-04 3 1  ON 31
ci_33                 2.554753e-05 3 1  ON 32
ci_34                -4.254142e-04 3 1  ON 33
ci_35                 6.405748e-04 3 1  ON 34
ci_36                -9.915304e-04 3 1  ON 35
ci_37                -5.884773e-04 3 1  ON 36
ci_38                -6.021927e-04 3 1  ON 37
ci_39                -2.809364e-04 3 1  ON 38
ci_40                -1.433224e-03 3 1  ON 39
ci_41                 2.306602e-04 3 1  ON 40
ci_42                 8.902848e-05 3 1  ON 41
ci_43                -2.248326e-03 3 1  ON 42
ci_44                -2.628489e-03 3 1  ON 43
ci_45                -3.275634e-04 3 1  ON 44
ci_46                -4.877888e-04 3 1  ON 45
ci_47                -1.839002e-04 3 1  ON 46
ci_48                -4.263078e-04 3 1  ON 47
ci_49                -1.250301e-03 3 1  ON 48
ci_50                -5.497261e-04 3 1  ON 49
ci_51                -6.329195e-05 3 1  ON 50
ci_52                -3.121703e-04 3 1  ON 51
ci_53                -1.053830e-03 3 1  ON 52
ci_54                -1.232410e-03 3 1  ON 53
ci_55                -1.136003e-03 3 1  ON 54
ci_56                 1.632729e-03 3 1  ON 55
ci_57                 1.666489e-03 3 1  ON 56
ci_58                -1.159310e-03 3 1  ON 57
ci_59                -1.179896e-03 3 1  ON 58
ci_60                 7.320635e-04 3 1  ON 59
ci_61                 2.114079e-03 3 1  ON 60
ci_62                -2.970102e-04 3 1  ON 61
ci_63                -4.555367e-04 3 1  ON 62
ci_64                -4.671003e-04 3 1  ON 63
ci_65                -4.092556e-04 3 1  ON 64
ci_66                -3.058880e-04 3 1  ON 65
ci_67                -9.698111e-04 3 1  ON 66
ci_68                -2.018127e-03 3 1  ON 67
ci_69                -1.663459e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8926e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2864e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7915
    reference variance = 0.571482
====================================================
  Execution time = 9.8382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1371e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9899e-01
  Total weights = 7.856530294e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.1192e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483281256174
                                         uncertainty =       0.001189139936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483281256174
                                         uncertainty =       0.001189139936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245784664
  error estimate for blocks of size 2^( 2) =       0.000254945897
  error estimate for blocks of size 2^( 3) =       0.000263109014
  error estimate for blocks of size 2^( 4) =       0.000269042485
  error estimate for blocks of size 2^( 5) =       0.000273177849
  error estimate for blocks of size 2^( 6) =       0.000275346122
  error estimate for blocks of size 2^( 7) =       0.000275840802
  error estimate for blocks of size 2^( 8) =       0.000276170231
  error estimate for blocks of size 2^( 9) =       0.000276688158

      target function =                  N/A
              le_mean =     -22.824387259695
             les_mean =     521.451647792779
             stat err =       0.000276011328
             autocorr =       1.261084685235
              std dev =       0.695184010583
             le_variance =       0.483280808570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282438725969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824387259688       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824398849192       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824402119872       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824402651568       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824402701441       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.651183e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824387259688       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824393844082       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824394599910       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824394673740       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.159905e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824387259688       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824389673795       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824389727478       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824389760991       residual = 6.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.601489e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1960e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.120182e-01 3 1  ON 0
ci_02                -2.309898e-02 3 1  ON 1
ci_03                -2.291525e-02 3 1  ON 2
ci_04                 2.263593e-02 3 1  ON 3
ci_05                -2.171583e-02 3 1  ON 4
ci_06                -2.178496e-02 3 1  ON 5
ci_07                 2.494871e-02 3 1  ON 6
ci_08                -3.933632e-03 3 1  ON 7
ci_09                -1.094558e-02 3 1  ON 8
ci_10                -1.129849e-02 3 1  ON 9
ci_11                 1.635228e-02 3 1  ON 10
ci_12                 1.072134e-02 3 1  ON 11
ci_13                 1.242629e-02 3 1  ON 12
ci_14                 1.721657e-02 3 1  ON 13
ci_15                 7.868213e-03 3 1  ON 14
ci_16                 7.637259e-03 3 1  ON 15
ci_17                -9.713157e-03 3 1  ON 16
ci_18                -9.409032e-03 3 1  ON 17
ci_19                 9.846381e-03 3 1  ON 18
ci_20                 1.036247e-02 3 1  ON 19
ci_21                 8.051341e-03 3 1  ON 20
ci_22                 8.004873e-03 3 1  ON 21
ci_23                 6.273061e-03 3 1  ON 22
ci_24                 7.250166e-03 3 1  ON 23
ci_25                 5.371514e-03 3 1  ON 24
ci_26                 2.848903e-03 3 1  ON 25
ci_27                 2.587511e-03 3 1  ON 26
ci_28                 3.033410e-03 3 1  ON 27
ci_29                 2.898613e-03 3 1  ON 28
ci_30                 3.257917e-04 3 1  ON 29
ci_31                 5.893693e-04 3 1  ON 30
ci_32                 4.022952e-04 3 1  ON 31
ci_33                 2.549772e-04 3 1  ON 32
ci_34                -2.152216e-04 3 1  ON 33
ci_35                -4.467180e-05 3 1  ON 34
ci_36                -6.694253e-04 3 1  ON 35
ci_37                -5.418891e-04 3 1  ON 36
ci_38                -1.872152e-04 3 1  ON 37
ci_39                 8.522285e-05 3 1  ON 38
ci_40                -1.179497e-03 3 1  ON 39
ci_41                 4.286785e-04 3 1  ON 40
ci_42                 6.705946e-05 3 1  ON 41
ci_43                -2.482213e-03 3 1  ON 42
ci_44                -2.894443e-03 3 1  ON 43
ci_45                -3.915753e-04 3 1  ON 44
ci_46                -2.729781e-04 3 1  ON 45
ci_47                -2.412019e-04 3 1  ON 46
ci_48                -1.402697e-04 3 1  ON 47
ci_49                -1.181257e-03 3 1  ON 48
ci_50                -6.341658e-04 3 1  ON 49
ci_51                 1.182660e-05 3 1  ON 50
ci_52                -2.043723e-04 3 1  ON 51
ci_53                -7.632647e-04 3 1  ON 52
ci_54                -1.158524e-03 3 1  ON 53
ci_55                -8.042029e-04 3 1  ON 54
ci_56                 1.504205e-03 3 1  ON 55
ci_57                 1.979379e-03 3 1  ON 56
ci_58                -1.021185e-03 3 1  ON 57
ci_59                -1.156258e-03 3 1  ON 58
ci_60                 9.585076e-04 3 1  ON 59
ci_61                 1.901802e-03 3 1  ON 60
ci_62                -3.571817e-05 3 1  ON 61
ci_63                -1.524640e-04 3 1  ON 62
ci_64                -3.936911e-04 3 1  ON 63
ci_65                -2.719477e-04 3 1  ON 64
ci_66                -3.050706e-04 3 1  ON 65
ci_67                -8.689575e-04 3 1  ON 66
ci_68                -2.295975e-03 3 1  ON 67
ci_69                -1.815830e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8441
    reference variance = 0.664109
====================================================
  Execution time = 1.0009e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0417e-01
  Total weights = 7.8569e+06
  Execution time = 1.4192e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489122159720
                                         uncertainty =       0.002001918773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489122159720
                                         uncertainty =       0.002001918773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247266380
  error estimate for blocks of size 2^( 2) =       0.000256437161
  error estimate for blocks of size 2^( 3) =       0.000264519377
  error estimate for blocks of size 2^( 4) =       0.000270290888
  error estimate for blocks of size 2^( 5) =       0.000273910291
  error estimate for blocks of size 2^( 6) =       0.000275894553
  error estimate for blocks of size 2^( 7) =       0.000277075769
  error estimate for blocks of size 2^( 8) =       0.000277807510
  error estimate for blocks of size 2^( 9) =       0.000278775838

      target function =                  N/A
              le_mean =     -22.824772357382
             les_mean =     521.479828222919
             stat err =       0.000277388418
             autocorr =       1.258480540166
              std dev =       0.699374936154
             le_variance =       0.489125301320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488868948685
                                         uncertainty =       0.001989365857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488868948685
                                         uncertainty =       0.001989365857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247202325
  error estimate for blocks of size 2^( 2) =       0.000256389904
  error estimate for blocks of size 2^( 3) =       0.000264488151
  error estimate for blocks of size 2^( 4) =       0.000270274084
  error estimate for blocks of size 2^( 5) =       0.000273898059
  error estimate for blocks of size 2^( 6) =       0.000275880356
  error estimate for blocks of size 2^( 7) =       0.000277054573
  error estimate for blocks of size 2^( 8) =       0.000277798895
  error estimate for blocks of size 2^( 9) =       0.000278756523

      target function =                  N/A
              le_mean =     -22.824769625554
             les_mean =     521.478450509073
             stat err =       0.000277372587
             autocorr =       1.258989100183
              std dev =       0.699193762282
             le_variance =       0.488871917215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488872506291
                                         uncertainty =       0.001991602856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488872506291
                                         uncertainty =       0.001991602856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247203222
  error estimate for blocks of size 2^( 2) =       0.000256391553
  error estimate for blocks of size 2^( 3) =       0.000264490413
  error estimate for blocks of size 2^( 4) =       0.000270277331
  error estimate for blocks of size 2^( 5) =       0.000273900437
  error estimate for blocks of size 2^( 6) =       0.000275881922
  error estimate for blocks of size 2^( 7) =       0.000277058835
  error estimate for blocks of size 2^( 8) =       0.000277805250
  error estimate for blocks of size 2^( 9) =       0.000278769665

      target function =                  N/A
              le_mean =     -22.824772822918
             les_mean =     521.476734248163
             stat err =       0.000277378918
             autocorr =       1.259037445609
              std dev =       0.699196297468
             le_variance =       0.488875462393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489011652807
                                         uncertainty =       0.001999819364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489011652807
                                         uncertainty =       0.001999819364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247238433
  error estimate for blocks of size 2^( 2) =       0.000256412385
  error estimate for blocks of size 2^( 3) =       0.000264498514
  error estimate for blocks of size 2^( 4) =       0.000270272658
  error estimate for blocks of size 2^( 5) =       0.000273891910
  error estimate for blocks of size 2^( 6) =       0.000275877895
  error estimate for blocks of size 2^( 7) =       0.000277057599
  error estimate for blocks of size 2^( 8) =       0.000277794797
  error estimate for blocks of size 2^( 9) =       0.000278766301

      target function =                  N/A
              le_mean =     -22.824766513414
             les_mean =     521.478634761846
             stat err =       0.000277374148
             autocorr =       1.258635558970
              std dev =       0.699295890322
             le_variance =       0.489014742221


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824772357382        initial
     6.2500e-02     6.2500e-01             2.6512e-03       -22.824769625554
     2.5000e-01     2.5000e+00             1.1599e-03       -22.824772822918  <--
     1.0000e+00     1.0000e+01             3.6015e-04       -22.824766513414

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7135e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.120182e-01 3 1  ON 0
ci_02                -2.309898e-02 3 1  ON 1
ci_03                -2.291525e-02 3 1  ON 2
ci_04                 2.263593e-02 3 1  ON 3
ci_05                -2.171583e-02 3 1  ON 4
ci_06                -2.178496e-02 3 1  ON 5
ci_07                 2.494871e-02 3 1  ON 6
ci_08                -3.933632e-03 3 1  ON 7
ci_09                -1.094558e-02 3 1  ON 8
ci_10                -1.129849e-02 3 1  ON 9
ci_11                 1.635228e-02 3 1  ON 10
ci_12                 1.072134e-02 3 1  ON 11
ci_13                 1.242629e-02 3 1  ON 12
ci_14                 1.721657e-02 3 1  ON 13
ci_15                 7.868213e-03 3 1  ON 14
ci_16                 7.637259e-03 3 1  ON 15
ci_17                -9.713157e-03 3 1  ON 16
ci_18                -9.409032e-03 3 1  ON 17
ci_19                 9.846381e-03 3 1  ON 18
ci_20                 1.036247e-02 3 1  ON 19
ci_21                 8.051341e-03 3 1  ON 20
ci_22                 8.004873e-03 3 1  ON 21
ci_23                 6.273061e-03 3 1  ON 22
ci_24                 7.250166e-03 3 1  ON 23
ci_25                 5.371514e-03 3 1  ON 24
ci_26                 2.848903e-03 3 1  ON 25
ci_27                 2.587511e-03 3 1  ON 26
ci_28                 3.033410e-03 3 1  ON 27
ci_29                 2.898613e-03 3 1  ON 28
ci_30                 3.257917e-04 3 1  ON 29
ci_31                 5.893693e-04 3 1  ON 30
ci_32                 4.022952e-04 3 1  ON 31
ci_33                 2.549772e-04 3 1  ON 32
ci_34                -2.152216e-04 3 1  ON 33
ci_35                -4.467180e-05 3 1  ON 34
ci_36                -6.694253e-04 3 1  ON 35
ci_37                -5.418891e-04 3 1  ON 36
ci_38                -1.872152e-04 3 1  ON 37
ci_39                 8.522285e-05 3 1  ON 38
ci_40                -1.179497e-03 3 1  ON 39
ci_41                 4.286785e-04 3 1  ON 40
ci_42                 6.705946e-05 3 1  ON 41
ci_43                -2.482213e-03 3 1  ON 42
ci_44                -2.894443e-03 3 1  ON 43
ci_45                -3.915753e-04 3 1  ON 44
ci_46                -2.729781e-04 3 1  ON 45
ci_47                -2.412019e-04 3 1  ON 46
ci_48                -1.402697e-04 3 1  ON 47
ci_49                -1.181257e-03 3 1  ON 48
ci_50                -6.341658e-04 3 1  ON 49
ci_51                 1.182660e-05 3 1  ON 50
ci_52                -2.043723e-04 3 1  ON 51
ci_53                -7.632647e-04 3 1  ON 52
ci_54                -1.158524e-03 3 1  ON 53
ci_55                -8.042029e-04 3 1  ON 54
ci_56                 1.504205e-03 3 1  ON 55
ci_57                 1.979379e-03 3 1  ON 56
ci_58                -1.021185e-03 3 1  ON 57
ci_59                -1.156258e-03 3 1  ON 58
ci_60                 9.585076e-04 3 1  ON 59
ci_61                 1.901802e-03 3 1  ON 60
ci_62                -3.571817e-05 3 1  ON 61
ci_63                -1.524640e-04 3 1  ON 62
ci_64                -3.936911e-04 3 1  ON 63
ci_65                -2.719477e-04 3 1  ON 64
ci_66                -3.050706e-04 3 1  ON 65
ci_67                -8.689575e-04 3 1  ON 66
ci_68                -2.295975e-03 3 1  ON 67
ci_69                -1.815830e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9097e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2848e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.9317
    reference variance = 0.411103
====================================================
  Execution time = 9.8428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1378e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0274e-01
  Total weights = 7.856493614e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8723e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486498450574
                                         uncertainty =       0.001239842173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486498450574
                                         uncertainty =       0.001239842173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246601324
  error estimate for blocks of size 2^( 2) =       0.000255707046
  error estimate for blocks of size 2^( 3) =       0.000263859925
  error estimate for blocks of size 2^( 4) =       0.000269564833
  error estimate for blocks of size 2^( 5) =       0.000273328340
  error estimate for blocks of size 2^( 6) =       0.000274937477
  error estimate for blocks of size 2^( 7) =       0.000275805168
  error estimate for blocks of size 2^( 8) =       0.000277171249
  error estimate for blocks of size 2^( 9) =       0.000277521155

      target function =                  N/A
              le_mean =     -22.824409194621
             les_mean =     521.456394355059
             stat err =       0.000276358762
             autocorr =       1.255901759250
              std dev =       0.697493874875
             le_variance =       0.486497705488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282440919462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824409194620       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824420300773       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824421540090       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824422013292       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824421981664       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.308082e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824409194620       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824415668196       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824416025414       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824416169121       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.786180e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824409194620       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824411620566       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824411693722       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824411724682       residual = 4.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.066325e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2048e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.114396e-01 3 1  ON 0
ci_02                -2.276943e-02 3 1  ON 1
ci_03                -2.258781e-02 3 1  ON 2
ci_04                 2.233050e-02 3 1  ON 3
ci_05                -2.137921e-02 3 1  ON 4
ci_06                -2.171162e-02 3 1  ON 5
ci_07                 2.528400e-02 3 1  ON 6
ci_08                -3.957757e-03 3 1  ON 7
ci_09                -1.098341e-02 3 1  ON 8
ci_10                -1.107351e-02 3 1  ON 9
ci_11                 1.612754e-02 3 1  ON 10
ci_12                 1.062130e-02 3 1  ON 11
ci_13                 1.230287e-02 3 1  ON 12
ci_14                 1.763737e-02 3 1  ON 13
ci_15                 7.750441e-03 3 1  ON 14
ci_16                 7.798944e-03 3 1  ON 15
ci_17                -9.333269e-03 3 1  ON 16
ci_18                -9.574118e-03 3 1  ON 17
ci_19                 9.983257e-03 3 1  ON 18
ci_20                 1.020662e-02 3 1  ON 19
ci_21                 8.138681e-03 3 1  ON 20
ci_22                 8.126080e-03 3 1  ON 21
ci_23                 6.390843e-03 3 1  ON 22
ci_24                 7.221253e-03 3 1  ON 23
ci_25                 5.294112e-03 3 1  ON 24
ci_26                 3.025383e-03 3 1  ON 25
ci_27                 2.740614e-03 3 1  ON 26
ci_28                 3.176073e-03 3 1  ON 27
ci_29                 2.940821e-03 3 1  ON 28
ci_30                 5.767700e-04 3 1  ON 29
ci_31                 6.796481e-04 3 1  ON 30
ci_32                -1.741282e-05 3 1  ON 31
ci_33                 1.871378e-04 3 1  ON 32
ci_34                -1.586764e-04 3 1  ON 33
ci_35                -3.299360e-04 3 1  ON 34
ci_36                -5.222909e-04 3 1  ON 35
ci_37                -7.498123e-04 3 1  ON 36
ci_38                 1.115177e-04 3 1  ON 37
ci_39                -1.141383e-05 3 1  ON 38
ci_40                -1.458750e-03 3 1  ON 39
ci_41                 4.158147e-04 3 1  ON 40
ci_42                -6.788211e-05 3 1  ON 41
ci_43                -2.442371e-03 3 1  ON 42
ci_44                -2.525074e-03 3 1  ON 43
ci_45                -1.933014e-04 3 1  ON 44
ci_46                -3.346552e-04 3 1  ON 45
ci_47                -7.308589e-05 3 1  ON 46
ci_48                -4.094258e-04 3 1  ON 47
ci_49                -1.685489e-03 3 1  ON 48
ci_50                -7.844609e-04 3 1  ON 49
ci_51                 2.208998e-04 3 1  ON 50
ci_52                -7.987271e-05 3 1  ON 51
ci_53                -8.478587e-04 3 1  ON 52
ci_54                -1.433565e-03 3 1  ON 53
ci_55                -7.148750e-04 3 1  ON 54
ci_56                 1.619564e-03 3 1  ON 55
ci_57                 1.759316e-03 3 1  ON 56
ci_58                -1.095898e-03 3 1  ON 57
ci_59                -1.350030e-03 3 1  ON 58
ci_60                 8.358623e-04 3 1  ON 59
ci_61                 1.715507e-03 3 1  ON 60
ci_62                -1.943687e-04 3 1  ON 61
ci_63                -4.562572e-04 3 1  ON 62
ci_64                -3.532113e-04 3 1  ON 63
ci_65                -3.783339e-04 3 1  ON 64
ci_66                -6.090051e-04 3 1  ON 65
ci_67                -7.128595e-04 3 1  ON 66
ci_68                -2.056423e-03 3 1  ON 67
ci_69                -1.486306e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8606
    reference variance = 0.494469
====================================================
  Execution time = 1.0002e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9986e-01
  Total weights = 7.8565e+06
  Execution time = 1.4150e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493704181131
                                         uncertainty =       0.010823002185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493704181131
                                         uncertainty =       0.010823002185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000248423244
  error estimate for blocks of size 2^( 2) =       0.000257485374
  error estimate for blocks of size 2^( 3) =       0.000265460148
  error estimate for blocks of size 2^( 4) =       0.000271272329
  error estimate for blocks of size 2^( 5) =       0.000274911711
  error estimate for blocks of size 2^( 6) =       0.000276710012
  error estimate for blocks of size 2^( 7) =       0.000277320011
  error estimate for blocks of size 2^( 8) =       0.000278581117
  error estimate for blocks of size 2^( 9) =       0.000278800372

      target function =                  N/A
              le_mean =     -22.824457933760
             les_mean =     521.479116590513
             stat err =       0.000277852878
             autocorr =       1.250965527965
              std dev =       0.702647041606
             le_variance =       0.493712865077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482616355984
                                         uncertainty =       0.001271426095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482616355984
                                         uncertainty =       0.001271426095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245615630
  error estimate for blocks of size 2^( 2) =       0.000254811509
  error estimate for blocks of size 2^( 3) =       0.000262885566
  error estimate for blocks of size 2^( 4) =       0.000268790014
  error estimate for blocks of size 2^( 5) =       0.000272457240
  error estimate for blocks of size 2^( 6) =       0.000274319554
  error estimate for blocks of size 2^( 7) =       0.000274879873
  error estimate for blocks of size 2^( 8) =       0.000276100464
  error estimate for blocks of size 2^( 9) =       0.000276374469

      target function =                  N/A
              le_mean =     -22.824489246279
             les_mean =     521.497573691265
             stat err =       0.000275418590
             autocorr =       1.257403022626
              std dev =       0.694705910800
             le_variance =       0.482616302501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482632836908
                                         uncertainty =       0.001281941917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482632836908
                                         uncertainty =       0.001281941917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245619821
  error estimate for blocks of size 2^( 2) =       0.000254816518
  error estimate for blocks of size 2^( 3) =       0.000262892930
  error estimate for blocks of size 2^( 4) =       0.000268797039
  error estimate for blocks of size 2^( 5) =       0.000272464821
  error estimate for blocks of size 2^( 6) =       0.000274321694
  error estimate for blocks of size 2^( 7) =       0.000274880952
  error estimate for blocks of size 2^( 8) =       0.000276106741
  error estimate for blocks of size 2^( 9) =       0.000276367059

      target function =                  N/A
              le_mean =     -22.824490722410
             les_mean =     521.524441324522
             stat err =       0.000275419111
             autocorr =       1.257364872441
              std dev =       0.694717764978
             le_variance =       0.482632772976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486429870272
                                         uncertainty =       0.003802133346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486429870272
                                         uncertainty =       0.003802133346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246584829
  error estimate for blocks of size 2^( 2) =       0.000255743825
  error estimate for blocks of size 2^( 3) =       0.000263780593
  error estimate for blocks of size 2^( 4) =       0.000269665096
  error estimate for blocks of size 2^( 5) =       0.000273317242
  error estimate for blocks of size 2^( 6) =       0.000275187726
  error estimate for blocks of size 2^( 7) =       0.000275698112
  error estimate for blocks of size 2^( 8) =       0.000276862575
  error estimate for blocks of size 2^( 9) =       0.000277140254

      target function =                  N/A
              le_mean =     -22.824513163015
             les_mean =     521.465165326286
             stat err =       0.000276222167
             autocorr =       1.254828426254
              std dev =       0.697447218684
             le_variance =       0.486432622850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824457933760        initial
     6.2500e-02     6.2500e-01             1.3081e-03       -22.824489246279
     2.5000e-01     2.5000e+00             5.7862e-04       -22.824490722410
     1.0000e+00     1.0000e+01             2.0663e-04       -22.824513163015  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 1.7110e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.118337e-01 3 1  ON 0
ci_02                -2.297517e-02 3 1  ON 1
ci_03                -2.279392e-02 3 1  ON 2
ci_04                 2.251829e-02 3 1  ON 3
ci_05                -2.159352e-02 3 1  ON 4
ci_06                -2.175345e-02 3 1  ON 5
ci_07                 2.506325e-02 3 1  ON 6
ci_08                -3.950796e-03 3 1  ON 7
ci_09                -1.095904e-02 3 1  ON 8
ci_10                -1.122562e-02 3 1  ON 9
ci_11                 1.626933e-02 3 1  ON 10
ci_12                 1.068500e-02 3 1  ON 11
ci_13                 1.237928e-02 3 1  ON 12
ci_14                 1.734095e-02 3 1  ON 13
ci_15                 7.827480e-03 3 1  ON 14
ci_16                 7.691650e-03 3 1  ON 15
ci_17                -9.579299e-03 3 1  ON 16
ci_18                -9.463281e-03 3 1  ON 17
ci_19                 9.902003e-03 3 1  ON 18
ci_20                 1.030482e-02 3 1  ON 19
ci_21                 8.078148e-03 3 1  ON 20
ci_22                 8.050432e-03 3 1  ON 21
ci_23                 6.321862e-03 3 1  ON 22
ci_24                 7.240621e-03 3 1  ON 23
ci_25                 5.342409e-03 3 1  ON 24
ci_26                 2.908026e-03 3 1  ON 25
ci_27                 2.637984e-03 3 1  ON 26
ci_28                 3.086972e-03 3 1  ON 27
ci_29                 2.915127e-03 3 1  ON 28
ci_30                 4.176589e-04 3 1  ON 29
ci_31                 6.232825e-04 3 1  ON 30
ci_32                 2.374071e-04 3 1  ON 31
ci_33                 2.266945e-04 3 1  ON 32
ci_34                -1.946217e-04 3 1  ON 33
ci_35                -1.462604e-04 3 1  ON 34
ci_36                -6.107409e-04 3 1  ON 35
ci_37                -6.245601e-04 3 1  ON 36
ci_38                -6.501654e-05 3 1  ON 37
ci_39                 4.773147e-05 3 1  ON 38
ci_40                -1.307815e-03 3 1  ON 39
ci_41                 4.215112e-04 3 1  ON 40
ci_42                 1.754203e-05 3 1  ON 41
ci_43                -2.465976e-03 3 1  ON 42
ci_44                -2.763329e-03 3 1  ON 43
ci_45                -3.125716e-04 3 1  ON 44
ci_46                -2.959601e-04 3 1  ON 45
ci_47                -1.823963e-04 3 1  ON 46
ci_48                -2.310809e-04 3 1  ON 47
ci_49                -1.387889e-03 3 1  ON 48
ci_50                -7.017371e-04 3 1  ON 49
ci_51                 9.795474e-05 3 1  ON 50
ci_52                -1.522296e-04 3 1  ON 51
ci_53                -8.014120e-04 3 1  ON 52
ci_54                -1.253818e-03 3 1  ON 53
ci_55                -7.708107e-04 3 1  ON 54
ci_56                 1.551296e-03 3 1  ON 55
ci_57                 1.895213e-03 3 1  ON 56
ci_58                -1.047815e-03 3 1  ON 57
ci_59                -1.226807e-03 3 1  ON 58
ci_60                 9.200895e-04 3 1  ON 59
ci_61                 1.844486e-03 3 1  ON 60
ci_62                -1.059513e-04 3 1  ON 61
ci_63                -2.850876e-04 3 1  ON 62
ci_64                -3.837492e-04 3 1  ON 63
ci_65                -3.180314e-04 3 1  ON 64
ci_66                -4.246376e-04 3 1  ON 65
ci_67                -8.101007e-04 3 1  ON 66
ci_68                -2.205528e-03 3 1  ON 67
ci_69                -1.692903e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9159e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2860e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7912
    reference variance = 0.673638
====================================================
  Execution time = 9.8312e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1417e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0323e-01
  Total weights = 7.857030274e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8265e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486690080144
                                         uncertainty =       0.003370453423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486690080144
                                         uncertainty =       0.003370453423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246649476
  error estimate for blocks of size 2^( 2) =       0.000255784905
  error estimate for blocks of size 2^( 3) =       0.000264047268
  error estimate for blocks of size 2^( 4) =       0.000269840303
  error estimate for blocks of size 2^( 5) =       0.000273439980
  error estimate for blocks of size 2^( 6) =       0.000275139914
  error estimate for blocks of size 2^( 7) =       0.000275782426
  error estimate for blocks of size 2^( 8) =       0.000276775856
  error estimate for blocks of size 2^( 9) =       0.000277851080

      target function =                  N/A
              le_mean =     -22.824247731569
             les_mean =     521.449510600725
             stat err =       0.000276387319
             autocorr =       1.255670905745
              std dev =       0.697630069060
             le_variance =       0.486687713257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282424773157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824247731565       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824253630657       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824253979981       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824254077218       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.523220e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824247731565       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824249909301       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824249978144       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824250019119       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.010676e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824247731565       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824248349653       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824248365247       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824248377583       residual = 5.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.329991e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1660e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.116326e-01 3 1  ON 0
ci_02                -2.284214e-02 3 1  ON 1
ci_03                -2.268755e-02 3 1  ON 2
ci_04                 2.244218e-02 3 1  ON 3
ci_05                -2.160254e-02 3 1  ON 4
ci_06                -2.168420e-02 3 1  ON 5
ci_07                 2.509216e-02 3 1  ON 6
ci_08                -3.875924e-03 3 1  ON 7
ci_09                -1.090637e-02 3 1  ON 8
ci_10                -1.120994e-02 3 1  ON 9
ci_11                 1.622314e-02 3 1  ON 10
ci_12                 1.077489e-02 3 1  ON 11
ci_13                 1.229997e-02 3 1  ON 12
ci_14                 1.734560e-02 3 1  ON 13
ci_15                 7.783811e-03 3 1  ON 14
ci_16                 7.669289e-03 3 1  ON 15
ci_17                -9.544267e-03 3 1  ON 16
ci_18                -9.293333e-03 3 1  ON 17
ci_19                 9.775454e-03 3 1  ON 18
ci_20                 1.039585e-02 3 1  ON 19
ci_21                 8.185742e-03 3 1  ON 20
ci_22                 8.163002e-03 3 1  ON 21
ci_23                 6.342090e-03 3 1  ON 22
ci_24                 7.198663e-03 3 1  ON 23
ci_25                 5.378433e-03 3 1  ON 24
ci_26                 2.873184e-03 3 1  ON 25
ci_27                 2.667389e-03 3 1  ON 26
ci_28                 3.100780e-03 3 1  ON 27
ci_29                 2.894297e-03 3 1  ON 28
ci_30                 5.712187e-04 3 1  ON 29
ci_31                 7.014451e-04 3 1  ON 30
ci_32                 2.964012e-04 3 1  ON 31
ci_33                 3.382274e-04 3 1  ON 32
ci_34                -2.701526e-04 3 1  ON 33
ci_35                -1.556300e-04 3 1  ON 34
ci_36                -6.362301e-04 3 1  ON 35
ci_37                -5.861685e-04 3 1  ON 36
ci_38                -2.818602e-05 3 1  ON 37
ci_39                 5.312522e-05 3 1  ON 38
ci_40                -1.292440e-03 3 1  ON 39
ci_41                 3.844597e-04 3 1  ON 40
ci_42                -2.157664e-07 3 1  ON 41
ci_43                -2.414486e-03 3 1  ON 42
ci_44                -2.821867e-03 3 1  ON 43
ci_45                -3.211714e-04 3 1  ON 44
ci_46                -1.986429e-04 3 1  ON 45
ci_47                -1.135599e-04 3 1  ON 46
ci_48                -1.278615e-04 3 1  ON 47
ci_49                -1.363536e-03 3 1  ON 48
ci_50                -6.267903e-04 3 1  ON 49
ci_51                 9.455109e-05 3 1  ON 50
ci_52                -1.107473e-04 3 1  ON 51
ci_53                -7.472021e-04 3 1  ON 52
ci_54                -1.241298e-03 3 1  ON 53
ci_55                -8.120293e-04 3 1  ON 54
ci_56                 1.603483e-03 3 1  ON 55
ci_57                 1.964569e-03 3 1  ON 56
ci_58                -1.098922e-03 3 1  ON 57
ci_59                -1.253557e-03 3 1  ON 58
ci_60                 9.590278e-04 3 1  ON 59
ci_61                 1.808266e-03 3 1  ON 60
ci_62                -7.915635e-05 3 1  ON 61
ci_63                -2.694264e-04 3 1  ON 62
ci_64                -4.880758e-04 3 1  ON 63
ci_65                -2.991618e-04 3 1  ON 64
ci_66                -4.145464e-04 3 1  ON 65
ci_67                -7.405631e-04 3 1  ON 66
ci_68                -2.078365e-03 3 1  ON 67
ci_69                -1.690498e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.786
    reference variance = 0.393371
====================================================
  Execution time = 1.0255e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0252e-01
  Total weights = 7.8559e+06
  Execution time = 1.4127e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485393308435
                                         uncertainty =       0.001646297598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485393308435
                                         uncertainty =       0.001646297598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246321111
  error estimate for blocks of size 2^( 2) =       0.000255634141
  error estimate for blocks of size 2^( 3) =       0.000263899288
  error estimate for blocks of size 2^( 4) =       0.000269803923
  error estimate for blocks of size 2^( 5) =       0.000273826178
  error estimate for blocks of size 2^( 6) =       0.000275838190
  error estimate for blocks of size 2^( 7) =       0.000276720320
  error estimate for blocks of size 2^( 8) =       0.000276446477
  error estimate for blocks of size 2^( 9) =       0.000277214661

      target function =                  N/A
              le_mean =     -22.824238879002
             les_mean =     521.450950503803
             stat err =       0.000276554912
             autocorr =       1.260548276484
              std dev =       0.696701312689
             le_variance =       0.485392719103

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.071986
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485294728908
                                         uncertainty =       0.001629376163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485294728908
                                         uncertainty =       0.001629376163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246296089
  error estimate for blocks of size 2^( 2) =       0.000255616656
  error estimate for blocks of size 2^( 3) =       0.000263889924
  error estimate for blocks of size 2^( 4) =       0.000269801454
  error estimate for blocks of size 2^( 5) =       0.000273825269
  error estimate for blocks of size 2^( 6) =       0.000275842588
  error estimate for blocks of size 2^( 7) =       0.000276728640
  error estimate for blocks of size 2^( 8) =       0.000276459812
  error estimate for blocks of size 2^( 9) =       0.000277214100

      target function =                  N/A
              le_mean =     -22.824239148539
             les_mean =     521.449053009137
             stat err =       0.000276561285
             autocorr =       1.260862531982
              std dev =       0.696630537719
             le_variance =       0.485294106083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485319560325
                                         uncertainty =       0.001634466598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485319560325
                                         uncertainty =       0.001634466598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246302392
  error estimate for blocks of size 2^( 2) =       0.000255620905
  error estimate for blocks of size 2^( 3) =       0.000263891922
  error estimate for blocks of size 2^( 4) =       0.000269801357
  error estimate for blocks of size 2^( 5) =       0.000273824805
  error estimate for blocks of size 2^( 6) =       0.000275840937
  error estimate for blocks of size 2^( 7) =       0.000276724993
  error estimate for blocks of size 2^( 8) =       0.000276454163
  error estimate for blocks of size 2^( 9) =       0.000277212988

      target function =                  N/A
              le_mean =     -22.824238085532
             les_mean =     521.582451085896
             stat err =       0.000276558270
             autocorr =       1.260770504986
              std dev =       0.696648367421
             le_variance =       0.485318947831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485380988156
                                         uncertainty =       0.001644641802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485380988156
                                         uncertainty =       0.001644641802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246317984
  error estimate for blocks of size 2^( 2) =       0.000255631730
  error estimate for blocks of size 2^( 3) =       0.000263897794
  error estimate for blocks of size 2^( 4) =       0.000269803232
  error estimate for blocks of size 2^( 5) =       0.000273825481
  error estimate for blocks of size 2^( 6) =       0.000275838059
  error estimate for blocks of size 2^( 7) =       0.000276719458
  error estimate for blocks of size 2^( 8) =       0.000276447854
  error estimate for blocks of size 2^( 9) =       0.000277214065

      target function =                  N/A
              le_mean =     -22.824238286257
             les_mean =     521.454507179746
             stat err =       0.000276554859
             autocorr =       1.260579798326
              std dev =       0.696692468332
             le_variance =       0.485380395430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824238879002        initial
     2.5000e-01     2.5000e+00             6.5232e-04       -22.824239148539  <--
     1.0000e+00     1.0000e+01             2.0107e-04       -22.824238085532
     4.0000e+00     4.0000e+01             5.3300e-05       -22.824238286257

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7351e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.111814e-01 3 1  ON 0
ci_02                -2.260304e-02 3 1  ON 1
ci_03                -2.250390e-02 3 1  ON 2
ci_04                 2.232907e-02 3 1  ON 3
ci_05                -2.163319e-02 3 1  ON 4
ci_06                -2.156267e-02 3 1  ON 5
ci_07                 2.514524e-02 3 1  ON 6
ci_08                -3.767823e-03 3 1  ON 7
ci_09                -1.080453e-02 3 1  ON 8
ci_10                -1.118086e-02 3 1  ON 9
ci_11                 1.615743e-02 3 1  ON 10
ci_12                 1.093086e-02 3 1  ON 11
ci_13                 1.218251e-02 3 1  ON 12
ci_14                 1.736003e-02 3 1  ON 13
ci_15                 7.710447e-03 3 1  ON 14
ci_16                 7.636041e-03 3 1  ON 15
ci_17                -9.489300e-03 3 1  ON 16
ci_18                -8.979614e-03 3 1  ON 17
ci_19                 9.591919e-03 3 1  ON 18
ci_20                 1.055909e-02 3 1  ON 19
ci_21                 8.375533e-03 3 1  ON 20
ci_22                 8.369680e-03 3 1  ON 21
ci_23                 6.364044e-03 3 1  ON 22
ci_24                 7.118749e-03 3 1  ON 23
ci_25                 5.435707e-03 3 1  ON 24
ci_26                 2.812055e-03 3 1  ON 25
ci_27                 2.730251e-03 3 1  ON 26
ci_28                 3.123003e-03 3 1  ON 27
ci_29                 2.860826e-03 3 1  ON 28
ci_30                 8.726448e-04 3 1  ON 29
ci_31                 8.393196e-04 3 1  ON 30
ci_32                 3.798183e-04 3 1  ON 31
ci_33                 4.983477e-04 3 1  ON 32
ci_34                -3.960884e-04 3 1  ON 33
ci_35                -1.591776e-04 3 1  ON 34
ci_36                -6.801602e-04 3 1  ON 35
ci_37                -5.330172e-04 3 1  ON 36
ci_38                 2.959945e-05 3 1  ON 37
ci_39                 5.494459e-05 3 1  ON 38
ci_40                -1.272617e-03 3 1  ON 39
ci_41                 3.246061e-04 3 1  ON 40
ci_42                -2.878125e-05 3 1  ON 41
ci_43                -2.318888e-03 3 1  ON 42
ci_44                -2.930245e-03 3 1  ON 43
ci_45                -3.385237e-04 3 1  ON 44
ci_46                -5.538217e-05 3 1  ON 45
ci_47                 2.560459e-05 3 1  ON 46
ci_48                 8.763617e-05 3 1  ON 47
ci_49                -1.327214e-03 3 1  ON 48
ci_50                -5.370452e-04 3 1  ON 49
ci_51                 8.210021e-05 3 1  ON 50
ci_52                -5.034124e-05 3 1  ON 51
ci_53                -6.787372e-04 3 1  ON 52
ci_54                -1.219242e-03 3 1  ON 53
ci_55                -8.857947e-04 3 1  ON 54
ci_56                 1.684491e-03 3 1  ON 55
ci_57                 2.068905e-03 3 1  ON 56
ci_58                -1.183859e-03 3 1  ON 57
ci_59                -1.294881e-03 3 1  ON 58
ci_60                 1.053531e-03 3 1  ON 59
ci_61                 1.720837e-03 3 1  ON 60
ci_62                -3.819085e-05 3 1  ON 61
ci_63                -2.448018e-04 3 1  ON 62
ci_64                -6.597733e-04 3 1  ON 63
ci_65                -2.686970e-04 3 1  ON 64
ci_66                -3.993944e-04 3 1  ON 65
ci_67                -6.388288e-04 3 1  ON 66
ci_68                -1.872414e-03 3 1  ON 67
ci_69                -1.687936e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9012e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2846e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8635
    reference variance = 0.329109
====================================================
  Execution time = 9.8600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1398e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0008e-01
  Total weights = 7.857254080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.0571e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484145301602
                                         uncertainty =       0.001290886234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484145301602
                                         uncertainty =       0.001290886234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246004545
  error estimate for blocks of size 2^( 2) =       0.000255199184
  error estimate for blocks of size 2^( 3) =       0.000263539785
  error estimate for blocks of size 2^( 4) =       0.000269448692
  error estimate for blocks of size 2^( 5) =       0.000272724673
  error estimate for blocks of size 2^( 6) =       0.000275090353
  error estimate for blocks of size 2^( 7) =       0.000276015178
  error estimate for blocks of size 2^( 8) =       0.000274944726
  error estimate for blocks of size 2^( 9) =       0.000274578958

      target function =                  N/A
              le_mean =     -22.824516052095
             les_mean =     521.458610994084
             stat err =       0.000275157303
             autocorr =       1.251053340601
              std dev =       0.695805928265
             le_variance =       0.484145889809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282451605210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824516052091       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824519812293       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824520880865       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824521155184       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824521219469       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.201064e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824516052091       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824518246186       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824518652589       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824518739144       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.293022e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824516052091       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824516875087       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824516997940       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824517014580       residual = 2.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.668158e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1920e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.106521e-01 3 1  ON 0
ci_02                -2.245570e-02 3 1  ON 1
ci_03                -2.261601e-02 3 1  ON 2
ci_04                 2.218492e-02 3 1  ON 3
ci_05                -2.147422e-02 3 1  ON 4
ci_06                -2.140340e-02 3 1  ON 5
ci_07                 2.503949e-02 3 1  ON 6
ci_08                -3.889985e-03 3 1  ON 7
ci_09                -1.098411e-02 3 1  ON 8
ci_10                -1.117275e-02 3 1  ON 9
ci_11                 1.623263e-02 3 1  ON 10
ci_12                 1.079395e-02 3 1  ON 11
ci_13                 1.227462e-02 3 1  ON 12
ci_14                 1.705916e-02 3 1  ON 13
ci_15                 7.791311e-03 3 1  ON 14
ci_16                 7.785042e-03 3 1  ON 15
ci_17                -9.342101e-03 3 1  ON 16
ci_18                -8.924012e-03 3 1  ON 17
ci_19                 9.774324e-03 3 1  ON 18
ci_20                 1.078277e-02 3 1  ON 19
ci_21                 8.147086e-03 3 1  ON 20
ci_22                 8.255627e-03 3 1  ON 21
ci_23                 6.467800e-03 3 1  ON 22
ci_24                 7.113917e-03 3 1  ON 23
ci_25                 5.220433e-03 3 1  ON 24
ci_26                 3.073926e-03 3 1  ON 25
ci_27                 2.518766e-03 3 1  ON 26
ci_28                 3.033861e-03 3 1  ON 27
ci_29                 2.871645e-03 3 1  ON 28
ci_30                 7.940757e-04 3 1  ON 29
ci_31                 6.287306e-04 3 1  ON 30
ci_32                 3.396841e-04 3 1  ON 31
ci_33                 3.088256e-04 3 1  ON 32
ci_34                -3.947566e-04 3 1  ON 33
ci_35                -1.588049e-04 3 1  ON 34
ci_36                -3.812120e-04 3 1  ON 35
ci_37                -5.977764e-04 3 1  ON 36
ci_38                -2.961696e-05 3 1  ON 37
ci_39                -3.216511e-05 3 1  ON 38
ci_40                -1.344443e-03 3 1  ON 39
ci_41                 1.014817e-04 3 1  ON 40
ci_42                -2.369300e-04 3 1  ON 41
ci_43                -2.441508e-03 3 1  ON 42
ci_44                -2.716561e-03 3 1  ON 43
ci_45                -1.423613e-04 3 1  ON 44
ci_46                -3.869584e-05 3 1  ON 45
ci_47                -3.384957e-04 3 1  ON 46
ci_48                 1.351710e-05 3 1  ON 47
ci_49                -1.385745e-03 3 1  ON 48
ci_50                -7.529775e-04 3 1  ON 49
ci_51                 2.107276e-04 3 1  ON 50
ci_52                 1.622209e-05 3 1  ON 51
ci_53                -6.403474e-04 3 1  ON 52
ci_54                -1.028087e-03 3 1  ON 53
ci_55                -8.522596e-04 3 1  ON 54
ci_56                 1.631521e-03 3 1  ON 55
ci_57                 1.823790e-03 3 1  ON 56
ci_58                -1.309271e-03 3 1  ON 57
ci_59                -1.382827e-03 3 1  ON 58
ci_60                 6.785166e-04 3 1  ON 59
ci_61                 1.860601e-03 3 1  ON 60
ci_62                -3.204114e-04 3 1  ON 61
ci_63                -3.411378e-05 3 1  ON 62
ci_64                -4.032118e-04 3 1  ON 63
ci_65                -2.789986e-04 3 1  ON 64
ci_66                -5.022454e-04 3 1  ON 65
ci_67                -3.578642e-04 3 1  ON 66
ci_68                -1.831999e-03 3 1  ON 67
ci_69                -1.625736e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.783
    reference variance = 0.298382
====================================================
  Execution time = 1.0102e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0689e-01
  Total weights = 7.8563e+06
  Execution time = 1.4143e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487866845360
                                         uncertainty =       0.001596809714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487866845360
                                         uncertainty =       0.001596809714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246948269
  error estimate for blocks of size 2^( 2) =       0.000256052923
  error estimate for blocks of size 2^( 3) =       0.000264596676
  error estimate for blocks of size 2^( 4) =       0.000270549947
  error estimate for blocks of size 2^( 5) =       0.000274167207
  error estimate for blocks of size 2^( 6) =       0.000276068910
  error estimate for blocks of size 2^( 7) =       0.000276590513
  error estimate for blocks of size 2^( 8) =       0.000277127168
  error estimate for blocks of size 2^( 9) =       0.000277792948

      target function =                  N/A
              le_mean =     -22.825088435137
             les_mean =     521.500318824545
             stat err =       0.000276894885
             autocorr =       1.257239141635
              std dev =       0.698475182250
             le_variance =       0.487867580220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487781208442
                                         uncertainty =       0.001587427375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487781208442
                                         uncertainty =       0.001587427375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246926587
  error estimate for blocks of size 2^( 2) =       0.000256035143
  error estimate for blocks of size 2^( 3) =       0.000264582106
  error estimate for blocks of size 2^( 4) =       0.000270538306
  error estimate for blocks of size 2^( 5) =       0.000274156575
  error estimate for blocks of size 2^( 6) =       0.000276068437
  error estimate for blocks of size 2^( 7) =       0.000276594934
  error estimate for blocks of size 2^( 8) =       0.000277131637
  error estimate for blocks of size 2^( 9) =       0.000277800856

      target function =                  N/A
              le_mean =     -22.825090065964
             les_mean =     521.497126989351
             stat err =       0.000276898966
             autocorr =       1.257497005996
              std dev =       0.698413857483
             le_variance =       0.487781916325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487800398879
                                         uncertainty =       0.001587084926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487800398879
                                         uncertainty =       0.001587084926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246931443
  error estimate for blocks of size 2^( 2) =       0.000256038893
  error estimate for blocks of size 2^( 3) =       0.000264584318
  error estimate for blocks of size 2^( 4) =       0.000270539262
  error estimate for blocks of size 2^( 5) =       0.000274154802
  error estimate for blocks of size 2^( 6) =       0.000276062301
  error estimate for blocks of size 2^( 7) =       0.000276591599
  error estimate for blocks of size 2^( 8) =       0.000277128705
  error estimate for blocks of size 2^( 9) =       0.000277802524

      target function =                  N/A
              le_mean =     -22.825094167453
             les_mean =     521.500392653583
             stat err =       0.000276896282
             autocorr =       1.257423176742
              std dev =       0.698427591480
             le_variance =       0.487801100541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487830428606
                                         uncertainty =       0.001594329875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487830428606
                                         uncertainty =       0.001594329875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246939050
  error estimate for blocks of size 2^( 2) =       0.000256044666
  error estimate for blocks of size 2^( 3) =       0.000264588735
  error estimate for blocks of size 2^( 4) =       0.000270542541
  error estimate for blocks of size 2^( 5) =       0.000274159842
  error estimate for blocks of size 2^( 6) =       0.000276064203
  error estimate for blocks of size 2^( 7) =       0.000276588435
  error estimate for blocks of size 2^( 8) =       0.000277127774
  error estimate for blocks of size 2^( 9) =       0.000277793085

      target function =                  N/A
              le_mean =     -22.825088309123
             les_mean =     521.504903658174
             stat err =       0.000276893374
             autocorr =       1.257319295951
              std dev =       0.698449107723
             le_variance =       0.487831156079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825088435137        initial
     6.2500e-02     6.2500e-01             1.2011e-03       -22.825090065964
     2.5000e-01     2.5000e+00             5.2930e-04       -22.825094167453  <--
     1.0000e+00     1.0000e+01             1.6682e-04       -22.825088309123

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7205e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.106521e-01 3 1  ON 0
ci_02                -2.245570e-02 3 1  ON 1
ci_03                -2.261601e-02 3 1  ON 2
ci_04                 2.218492e-02 3 1  ON 3
ci_05                -2.147422e-02 3 1  ON 4
ci_06                -2.140340e-02 3 1  ON 5
ci_07                 2.503949e-02 3 1  ON 6
ci_08                -3.889985e-03 3 1  ON 7
ci_09                -1.098411e-02 3 1  ON 8
ci_10                -1.117275e-02 3 1  ON 9
ci_11                 1.623263e-02 3 1  ON 10
ci_12                 1.079395e-02 3 1  ON 11
ci_13                 1.227462e-02 3 1  ON 12
ci_14                 1.705916e-02 3 1  ON 13
ci_15                 7.791311e-03 3 1  ON 14
ci_16                 7.785042e-03 3 1  ON 15
ci_17                -9.342101e-03 3 1  ON 16
ci_18                -8.924012e-03 3 1  ON 17
ci_19                 9.774324e-03 3 1  ON 18
ci_20                 1.078277e-02 3 1  ON 19
ci_21                 8.147086e-03 3 1  ON 20
ci_22                 8.255627e-03 3 1  ON 21
ci_23                 6.467800e-03 3 1  ON 22
ci_24                 7.113917e-03 3 1  ON 23
ci_25                 5.220433e-03 3 1  ON 24
ci_26                 3.073926e-03 3 1  ON 25
ci_27                 2.518766e-03 3 1  ON 26
ci_28                 3.033861e-03 3 1  ON 27
ci_29                 2.871645e-03 3 1  ON 28
ci_30                 7.940757e-04 3 1  ON 29
ci_31                 6.287306e-04 3 1  ON 30
ci_32                 3.396841e-04 3 1  ON 31
ci_33                 3.088256e-04 3 1  ON 32
ci_34                -3.947566e-04 3 1  ON 33
ci_35                -1.588049e-04 3 1  ON 34
ci_36                -3.812120e-04 3 1  ON 35
ci_37                -5.977764e-04 3 1  ON 36
ci_38                -2.961696e-05 3 1  ON 37
ci_39                -3.216511e-05 3 1  ON 38
ci_40                -1.344443e-03 3 1  ON 39
ci_41                 1.014817e-04 3 1  ON 40
ci_42                -2.369300e-04 3 1  ON 41
ci_43                -2.441508e-03 3 1  ON 42
ci_44                -2.716561e-03 3 1  ON 43
ci_45                -1.423613e-04 3 1  ON 44
ci_46                -3.869584e-05 3 1  ON 45
ci_47                -3.384957e-04 3 1  ON 46
ci_48                 1.351710e-05 3 1  ON 47
ci_49                -1.385745e-03 3 1  ON 48
ci_50                -7.529775e-04 3 1  ON 49
ci_51                 2.107276e-04 3 1  ON 50
ci_52                 1.622209e-05 3 1  ON 51
ci_53                -6.403474e-04 3 1  ON 52
ci_54                -1.028087e-03 3 1  ON 53
ci_55                -8.522596e-04 3 1  ON 54
ci_56                 1.631521e-03 3 1  ON 55
ci_57                 1.823790e-03 3 1  ON 56
ci_58                -1.309271e-03 3 1  ON 57
ci_59                -1.382827e-03 3 1  ON 58
ci_60                 6.785166e-04 3 1  ON 59
ci_61                 1.860601e-03 3 1  ON 60
ci_62                -3.204114e-04 3 1  ON 61
ci_63                -3.411378e-05 3 1  ON 62
ci_64                -4.032118e-04 3 1  ON 63
ci_65                -2.789986e-04 3 1  ON 64
ci_66                -5.022454e-04 3 1  ON 65
ci_67                -3.578642e-04 3 1  ON 66
ci_68                -1.831999e-03 3 1  ON 67
ci_69                -1.625736e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9127e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7754
    reference variance = 0.40659
====================================================
  Execution time = 9.8480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1423e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9979e-01
  Total weights = 7.856984527e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8241e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483973943037
                                         uncertainty =       0.001183058995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483973943037
                                         uncertainty =       0.001183058995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245961036
  error estimate for blocks of size 2^( 2) =       0.000255241504
  error estimate for blocks of size 2^( 3) =       0.000263696969
  error estimate for blocks of size 2^( 4) =       0.000269711834
  error estimate for blocks of size 2^( 5) =       0.000273208287
  error estimate for blocks of size 2^( 6) =       0.000275193897
  error estimate for blocks of size 2^( 7) =       0.000275707767
  error estimate for blocks of size 2^( 8) =       0.000275754667
  error estimate for blocks of size 2^( 9) =       0.000277639684

      target function =                  N/A
              le_mean =     -22.824919403566
             les_mean =     521.476731765692
             stat err =       0.000276074004
             autocorr =       1.259848727146
              std dev =       0.695682865089
             le_variance =       0.483974648778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282491940357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824919403566       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824926566851       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824925885659       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824926375503       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824926377877       residual = 8.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.424775e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824919403566       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824923504810       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824923121541       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824923195528       residual = 8.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.149049e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824919403566       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824920917021       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824920807841       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824920801960       residual = 3.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.893796e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1675e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.100372e-01 3 1  ON 0
ci_02                -2.224079e-02 3 1  ON 1
ci_03                -2.256264e-02 3 1  ON 2
ci_04                 2.228176e-02 3 1  ON 3
ci_05                -2.136804e-02 3 1  ON 4
ci_06                -2.147315e-02 3 1  ON 5
ci_07                 2.497702e-02 3 1  ON 6
ci_08                -3.820821e-03 3 1  ON 7
ci_09                -1.115123e-02 3 1  ON 8
ci_10                -1.093378e-02 3 1  ON 9
ci_11                 1.623602e-02 3 1  ON 10
ci_12                 1.095960e-02 3 1  ON 11
ci_13                 1.213907e-02 3 1  ON 12
ci_14                 1.690656e-02 3 1  ON 13
ci_15                 7.583417e-03 3 1  ON 14
ci_16                 7.713394e-03 3 1  ON 15
ci_17                -9.392121e-03 3 1  ON 16
ci_18                -8.794413e-03 3 1  ON 17
ci_19                 9.920310e-03 3 1  ON 18
ci_20                 1.048689e-02 3 1  ON 19
ci_21                 8.287269e-03 3 1  ON 20
ci_22                 8.401991e-03 3 1  ON 21
ci_23                 6.219391e-03 3 1  ON 22
ci_24                 7.302102e-03 3 1  ON 23
ci_25                 5.253000e-03 3 1  ON 24
ci_26                 3.061545e-03 3 1  ON 25
ci_27                 2.690192e-03 3 1  ON 26
ci_28                 3.076709e-03 3 1  ON 27
ci_29                 2.957463e-03 3 1  ON 28
ci_30                 8.847625e-04 3 1  ON 29
ci_31                 6.881371e-04 3 1  ON 30
ci_32                 3.936351e-04 3 1  ON 31
ci_33                 8.669138e-05 3 1  ON 32
ci_34                -2.243769e-04 3 1  ON 33
ci_35                -8.672673e-05 3 1  ON 34
ci_36                -4.253226e-04 3 1  ON 35
ci_37                -9.323765e-04 3 1  ON 36
ci_38                 2.562598e-05 3 1  ON 37
ci_39                -1.723208e-04 3 1  ON 38
ci_40                -1.377844e-03 3 1  ON 39
ci_41                 2.138314e-04 3 1  ON 40
ci_42                -2.509188e-04 3 1  ON 41
ci_43                -2.003583e-03 3 1  ON 42
ci_44                -2.402515e-03 3 1  ON 43
ci_45                -3.690075e-05 3 1  ON 44
ci_46                -2.454853e-04 3 1  ON 45
ci_47                -4.208480e-04 3 1  ON 46
ci_48                 5.028742e-05 3 1  ON 47
ci_49                -1.104967e-03 3 1  ON 48
ci_50                -7.413837e-04 3 1  ON 49
ci_51                 2.438868e-04 3 1  ON 50
ci_52                -2.607419e-05 3 1  ON 51
ci_53                -9.670021e-04 3 1  ON 52
ci_54                -9.254752e-04 3 1  ON 53
ci_55                -8.562887e-04 3 1  ON 54
ci_56                 1.662378e-03 3 1  ON 55
ci_57                 1.732846e-03 3 1  ON 56
ci_58                -1.050395e-03 3 1  ON 57
ci_59                -1.348147e-03 3 1  ON 58
ci_60                 6.203705e-04 3 1  ON 59
ci_61                 2.267695e-03 3 1  ON 60
ci_62                -1.699239e-04 3 1  ON 61
ci_63                -5.795646e-05 3 1  ON 62
ci_64                -5.180459e-04 3 1  ON 63
ci_65                -2.011970e-04 3 1  ON 64
ci_66                -7.459154e-04 3 1  ON 65
ci_67                -3.953877e-04 3 1  ON 66
ci_68                -1.823590e-03 3 1  ON 67
ci_69                -1.729451e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8107
    reference variance = 0.337712
====================================================
  Execution time = 1.0128e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0234e-01
  Total weights = 7.8563e+06
  Execution time = 1.4149e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485418272610
                                         uncertainty =       0.001391614890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485418272610
                                         uncertainty =       0.001391614890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246327422
  error estimate for blocks of size 2^( 2) =       0.000255538115
  error estimate for blocks of size 2^( 3) =       0.000263816146
  error estimate for blocks of size 2^( 4) =       0.000269761147
  error estimate for blocks of size 2^( 5) =       0.000273435208
  error estimate for blocks of size 2^( 6) =       0.000275274806
  error estimate for blocks of size 2^( 7) =       0.000275898630
  error estimate for blocks of size 2^( 8) =       0.000276012010
  error estimate for blocks of size 2^( 9) =       0.000276790266

      target function =                  N/A
              le_mean =     -22.825104376530
             les_mean =     521.511162854935
             stat err =       0.000275993928
             autocorr =       1.255375159037
              std dev =       0.696719162121
             le_variance =       0.485417590867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485372724030
                                         uncertainty =       0.001388487015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485372724030
                                         uncertainty =       0.001388487015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246315865
  error estimate for blocks of size 2^( 2) =       0.000255531790
  error estimate for blocks of size 2^( 3) =       0.000263813991
  error estimate for blocks of size 2^( 4) =       0.000269760662
  error estimate for blocks of size 2^( 5) =       0.000273440419
  error estimate for blocks of size 2^( 6) =       0.000275278395
  error estimate for blocks of size 2^( 7) =       0.000275906482
  error estimate for blocks of size 2^( 8) =       0.000276028745
  error estimate for blocks of size 2^( 9) =       0.000276803663

      target function =                  N/A
              le_mean =     -22.825103981676
             les_mean =     521.533401323873
             stat err =       0.000276004321
             autocorr =       1.255587532424
              std dev =       0.696686472562
             le_variance =       0.485372041051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485388331194
                                         uncertainty =       0.001386215673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485388331194
                                         uncertainty =       0.001386215673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246319824
  error estimate for blocks of size 2^( 2) =       0.000255533809
  error estimate for blocks of size 2^( 3) =       0.000263814809
  error estimate for blocks of size 2^( 4) =       0.000269762267
  error estimate for blocks of size 2^( 5) =       0.000273441994
  error estimate for blocks of size 2^( 6) =       0.000275282955
  error estimate for blocks of size 2^( 7) =       0.000275913233
  error estimate for blocks of size 2^( 8) =       0.000276050570
  error estimate for blocks of size 2^( 9) =       0.000276822315

      target function =                  N/A
              le_mean =     -22.825108824659
             les_mean =     521.516036652502
             stat err =       0.000276017269
             autocorr =       1.255664960386
              std dev =       0.696697672452
             le_variance =       0.485387646800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485385301575
                                         uncertainty =       0.001390050640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485385301575
                                         uncertainty =       0.001390050640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246319059
  error estimate for blocks of size 2^( 2) =       0.000255530679
  error estimate for blocks of size 2^( 3) =       0.000263809572
  error estimate for blocks of size 2^( 4) =       0.000269754268
  error estimate for blocks of size 2^( 5) =       0.000273430392
  error estimate for blocks of size 2^( 6) =       0.000275270733
  error estimate for blocks of size 2^( 7) =       0.000275900976
  error estimate for blocks of size 2^( 8) =       0.000276020520
  error estimate for blocks of size 2^( 9) =       0.000276795187

      target function =                  N/A
              le_mean =     -22.825101371972
             les_mean =     521.509469529891
             stat err =       0.000275996854
             autocorr =       1.255487032212
              std dev =       0.696695506472
             le_variance =       0.485384628738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825104376530        initial
     6.2500e-02     6.2500e-01             1.4248e-03       -22.825103981676
     2.5000e-01     2.5000e+00             6.1490e-04       -22.825108824659  <--
     1.0000e+00     1.0000e+01             1.8938e-04       -22.825101371972

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7238e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.100372e-01 3 1  ON 0
ci_02                -2.224079e-02 3 1  ON 1
ci_03                -2.256264e-02 3 1  ON 2
ci_04                 2.228176e-02 3 1  ON 3
ci_05                -2.136804e-02 3 1  ON 4
ci_06                -2.147315e-02 3 1  ON 5
ci_07                 2.497702e-02 3 1  ON 6
ci_08                -3.820821e-03 3 1  ON 7
ci_09                -1.115123e-02 3 1  ON 8
ci_10                -1.093378e-02 3 1  ON 9
ci_11                 1.623602e-02 3 1  ON 10
ci_12                 1.095960e-02 3 1  ON 11
ci_13                 1.213907e-02 3 1  ON 12
ci_14                 1.690656e-02 3 1  ON 13
ci_15                 7.583417e-03 3 1  ON 14
ci_16                 7.713394e-03 3 1  ON 15
ci_17                -9.392121e-03 3 1  ON 16
ci_18                -8.794413e-03 3 1  ON 17
ci_19                 9.920310e-03 3 1  ON 18
ci_20                 1.048689e-02 3 1  ON 19
ci_21                 8.287269e-03 3 1  ON 20
ci_22                 8.401991e-03 3 1  ON 21
ci_23                 6.219391e-03 3 1  ON 22
ci_24                 7.302102e-03 3 1  ON 23
ci_25                 5.253000e-03 3 1  ON 24
ci_26                 3.061545e-03 3 1  ON 25
ci_27                 2.690192e-03 3 1  ON 26
ci_28                 3.076709e-03 3 1  ON 27
ci_29                 2.957463e-03 3 1  ON 28
ci_30                 8.847625e-04 3 1  ON 29
ci_31                 6.881371e-04 3 1  ON 30
ci_32                 3.936351e-04 3 1  ON 31
ci_33                 8.669138e-05 3 1  ON 32
ci_34                -2.243769e-04 3 1  ON 33
ci_35                -8.672673e-05 3 1  ON 34
ci_36                -4.253226e-04 3 1  ON 35
ci_37                -9.323765e-04 3 1  ON 36
ci_38                 2.562598e-05 3 1  ON 37
ci_39                -1.723208e-04 3 1  ON 38
ci_40                -1.377844e-03 3 1  ON 39
ci_41                 2.138314e-04 3 1  ON 40
ci_42                -2.509188e-04 3 1  ON 41
ci_43                -2.003583e-03 3 1  ON 42
ci_44                -2.402515e-03 3 1  ON 43
ci_45                -3.690075e-05 3 1  ON 44
ci_46                -2.454853e-04 3 1  ON 45
ci_47                -4.208480e-04 3 1  ON 46
ci_48                 5.028742e-05 3 1  ON 47
ci_49                -1.104967e-03 3 1  ON 48
ci_50                -7.413837e-04 3 1  ON 49
ci_51                 2.438868e-04 3 1  ON 50
ci_52                -2.607419e-05 3 1  ON 51
ci_53                -9.670021e-04 3 1  ON 52
ci_54                -9.254752e-04 3 1  ON 53
ci_55                -8.562887e-04 3 1  ON 54
ci_56                 1.662378e-03 3 1  ON 55
ci_57                 1.732846e-03 3 1  ON 56
ci_58                -1.050395e-03 3 1  ON 57
ci_59                -1.348147e-03 3 1  ON 58
ci_60                 6.203705e-04 3 1  ON 59
ci_61                 2.267695e-03 3 1  ON 60
ci_62                -1.699239e-04 3 1  ON 61
ci_63                -5.795646e-05 3 1  ON 62
ci_64                -5.180459e-04 3 1  ON 63
ci_65                -2.011970e-04 3 1  ON 64
ci_66                -7.459154e-04 3 1  ON 65
ci_67                -3.953877e-04 3 1  ON 66
ci_68                -1.823590e-03 3 1  ON 67
ci_69                -1.729451e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8913e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.9369
    reference variance = 0.737289
====================================================
  Execution time = 9.8802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1365e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0263e-01
  Total weights = 7.856728702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8111e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485387767660
                                         uncertainty =       0.001461769277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485387767660
                                         uncertainty =       0.001461769277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246319364
  error estimate for blocks of size 2^( 2) =       0.000255557273
  error estimate for blocks of size 2^( 3) =       0.000263697861
  error estimate for blocks of size 2^( 4) =       0.000269701829
  error estimate for blocks of size 2^( 5) =       0.000273283886
  error estimate for blocks of size 2^( 6) =       0.000275262095
  error estimate for blocks of size 2^( 7) =       0.000276596574
  error estimate for blocks of size 2^( 8) =       0.000276450332
  error estimate for blocks of size 2^( 9) =       0.000277206683

      target function =                  N/A
              le_mean =     -22.824722076789
             les_mean =     521.470570151851
             stat err =       0.000276378921
             autocorr =       1.258962305765
              std dev =       0.696696369277
             le_variance =       0.485385830963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282472207679e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824722076780       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824728251692       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824728594543       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824728277041       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824728241422       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.027691e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824722076780       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824725692602       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824725936070       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824725913499       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.569756e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824722076780       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824723437270       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824723573672       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824723595053       residual = 5.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.112167e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1694e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.103000e-01 3 1  ON 0
ci_02                -2.202304e-02 3 1  ON 1
ci_03                -2.248539e-02 3 1  ON 2
ci_04                 2.209214e-02 3 1  ON 3
ci_05                -2.140776e-02 3 1  ON 4
ci_06                -2.164305e-02 3 1  ON 5
ci_07                 2.506860e-02 3 1  ON 6
ci_08                -3.604345e-03 3 1  ON 7
ci_09                -1.108004e-02 3 1  ON 8
ci_10                -1.094794e-02 3 1  ON 9
ci_11                 1.650365e-02 3 1  ON 10
ci_12                 1.079049e-02 3 1  ON 11
ci_13                 1.196984e-02 3 1  ON 12
ci_14                 1.710062e-02 3 1  ON 13
ci_15                 7.379761e-03 3 1  ON 14
ci_16                 7.620529e-03 3 1  ON 15
ci_17                -9.003265e-03 3 1  ON 16
ci_18                -9.351389e-03 3 1  ON 17
ci_19                 9.489300e-03 3 1  ON 18
ci_20                 1.047483e-02 3 1  ON 19
ci_21                 8.449116e-03 3 1  ON 20
ci_22                 8.520949e-03 3 1  ON 21
ci_23                 6.494902e-03 3 1  ON 22
ci_24                 7.582255e-03 3 1  ON 23
ci_25                 4.932070e-03 3 1  ON 24
ci_26                 2.523376e-03 3 1  ON 25
ci_27                 2.828795e-03 3 1  ON 26
ci_28                 2.997301e-03 3 1  ON 27
ci_29                 2.741091e-03 3 1  ON 28
ci_30                 5.344005e-04 3 1  ON 29
ci_31                 5.185077e-04 3 1  ON 30
ci_32                 4.224441e-06 3 1  ON 31
ci_33                -1.251850e-04 3 1  ON 32
ci_34                -3.297144e-04 3 1  ON 33
ci_35                -3.940177e-04 3 1  ON 34
ci_36                -2.864086e-04 3 1  ON 35
ci_37                -6.975013e-04 3 1  ON 36
ci_38                -5.064857e-05 3 1  ON 37
ci_39                -1.105492e-04 3 1  ON 38
ci_40                -1.268511e-03 3 1  ON 39
ci_41                 9.074059e-05 3 1  ON 40
ci_42                 2.836966e-04 3 1  ON 41
ci_43                -2.305508e-03 3 1  ON 42
ci_44                -2.295631e-03 3 1  ON 43
ci_45                -2.025420e-04 3 1  ON 44
ci_46                -1.672841e-05 3 1  ON 45
ci_47                -2.983942e-04 3 1  ON 46
ci_48                 6.659141e-05 3 1  ON 47
ci_49                -1.000667e-03 3 1  ON 48
ci_50                -6.093151e-04 3 1  ON 49
ci_51                 2.063700e-04 3 1  ON 50
ci_52                 2.327124e-05 3 1  ON 51
ci_53                -1.115264e-03 3 1  ON 52
ci_54                -7.628499e-04 3 1  ON 53
ci_55                -8.916864e-04 3 1  ON 54
ci_56                 1.378731e-03 3 1  ON 55
ci_57                 1.622826e-03 3 1  ON 56
ci_58                -1.053267e-03 3 1  ON 57
ci_59                -1.458103e-03 3 1  ON 58
ci_60                 4.834696e-04 3 1  ON 59
ci_61                 2.326143e-03 3 1  ON 60
ci_62                -3.423140e-04 3 1  ON 61
ci_63                -3.997993e-05 3 1  ON 62
ci_64                -3.504080e-04 3 1  ON 63
ci_65                -4.919177e-04 3 1  ON 64
ci_66                -6.024984e-04 3 1  ON 65
ci_67                -3.046892e-04 3 1  ON 66
ci_68                -1.831879e-03 3 1  ON 67
ci_69                -1.620478e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8943
    reference variance = 0.516782
====================================================
  Execution time = 1.0359e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0328e-01
  Total weights = 7.8569e+06
  Execution time = 1.4137e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485459851261
                                         uncertainty =       0.001356216545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485459851261
                                         uncertainty =       0.001356216545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246337984
  error estimate for blocks of size 2^( 2) =       0.000255585294
  error estimate for blocks of size 2^( 3) =       0.000263749779
  error estimate for blocks of size 2^( 4) =       0.000269584754
  error estimate for blocks of size 2^( 5) =       0.000273161793
  error estimate for blocks of size 2^( 6) =       0.000274650002
  error estimate for blocks of size 2^( 7) =       0.000275439368
  error estimate for blocks of size 2^( 8) =       0.000276833319
  error estimate for blocks of size 2^( 9) =       0.000278293455

      target function =                  N/A
              le_mean =     -22.824439335392
             les_mean =     521.459686756036
             stat err =       0.000276304036
             autocorr =       1.258089945699
              std dev =       0.696749035837
             le_variance =       0.485459218940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485484787552
                                         uncertainty =       0.001364877130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485484787552
                                         uncertainty =       0.001364877130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246344291
  error estimate for blocks of size 2^( 2) =       0.000255591788
  error estimate for blocks of size 2^( 3) =       0.000263760247
  error estimate for blocks of size 2^( 4) =       0.000269592243
  error estimate for blocks of size 2^( 5) =       0.000273170227
  error estimate for blocks of size 2^( 6) =       0.000274662992
  error estimate for blocks of size 2^( 7) =       0.000275437882
  error estimate for blocks of size 2^( 8) =       0.000276822074
  error estimate for blocks of size 2^( 9) =       0.000278293198

      target function =                  N/A
              le_mean =     -22.824436853522
             les_mean =     521.616148469914
             stat err =       0.000276304037
             autocorr =       1.258025538652
              std dev =       0.696766873281
             le_variance =       0.485484075702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485464486389
                                         uncertainty =       0.001363428025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485464486389
                                         uncertainty =       0.001363428025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246339142
  error estimate for blocks of size 2^( 2) =       0.000255589020
  error estimate for blocks of size 2^( 3) =       0.000263757704
  error estimate for blocks of size 2^( 4) =       0.000269590065
  error estimate for blocks of size 2^( 5) =       0.000273169846
  error estimate for blocks of size 2^( 6) =       0.000274661946
  error estimate for blocks of size 2^( 7) =       0.000275439465
  error estimate for blocks of size 2^( 8) =       0.000276822282
  error estimate for blocks of size 2^( 9) =       0.000278314267

      target function =                  N/A
              le_mean =     -22.824441051774
             les_mean =     521.463108059206
             stat err =       0.000276309490
             autocorr =       1.258127784440
              std dev =       0.696752311731
             le_variance =       0.485463783902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485431472475
                                         uncertainty =       0.001357083305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485431472475
                                         uncertainty =       0.001357083305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246330781
  error estimate for blocks of size 2^( 2) =       0.000255579018
  error estimate for blocks of size 2^( 3) =       0.000263744467
  error estimate for blocks of size 2^( 4) =       0.000269579532
  error estimate for blocks of size 2^( 5) =       0.000273156920
  error estimate for blocks of size 2^( 6) =       0.000274646156
  error estimate for blocks of size 2^( 7) =       0.000275430609
  error estimate for blocks of size 2^( 8) =       0.000276820882
  error estimate for blocks of size 2^( 9) =       0.000278285573

      target function =                  N/A
              le_mean =     -22.824435287793
             les_mean =     521.532825004763
             stat err =       0.000276295805
             autocorr =       1.258088568068
              std dev =       0.696728661795
             le_variance =       0.485430828166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824439335392        initial
     6.2500e-02     6.2500e-01             1.0277e-03       -22.824436853522
     2.5000e-01     2.5000e+00             5.5698e-04       -22.824441051774  <--
     1.0000e+00     1.0000e+01             2.1122e-04       -22.824435287793

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7456e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.103000e-01 3 1  ON 0
ci_02                -2.202304e-02 3 1  ON 1
ci_03                -2.248539e-02 3 1  ON 2
ci_04                 2.209214e-02 3 1  ON 3
ci_05                -2.140776e-02 3 1  ON 4
ci_06                -2.164305e-02 3 1  ON 5
ci_07                 2.506860e-02 3 1  ON 6
ci_08                -3.604345e-03 3 1  ON 7
ci_09                -1.108004e-02 3 1  ON 8
ci_10                -1.094794e-02 3 1  ON 9
ci_11                 1.650365e-02 3 1  ON 10
ci_12                 1.079049e-02 3 1  ON 11
ci_13                 1.196984e-02 3 1  ON 12
ci_14                 1.710062e-02 3 1  ON 13
ci_15                 7.379761e-03 3 1  ON 14
ci_16                 7.620529e-03 3 1  ON 15
ci_17                -9.003265e-03 3 1  ON 16
ci_18                -9.351389e-03 3 1  ON 17
ci_19                 9.489300e-03 3 1  ON 18
ci_20                 1.047483e-02 3 1  ON 19
ci_21                 8.449116e-03 3 1  ON 20
ci_22                 8.520949e-03 3 1  ON 21
ci_23                 6.494902e-03 3 1  ON 22
ci_24                 7.582255e-03 3 1  ON 23
ci_25                 4.932070e-03 3 1  ON 24
ci_26                 2.523376e-03 3 1  ON 25
ci_27                 2.828795e-03 3 1  ON 26
ci_28                 2.997301e-03 3 1  ON 27
ci_29                 2.741091e-03 3 1  ON 28
ci_30                 5.344005e-04 3 1  ON 29
ci_31                 5.185077e-04 3 1  ON 30
ci_32                 4.224441e-06 3 1  ON 31
ci_33                -1.251850e-04 3 1  ON 32
ci_34                -3.297144e-04 3 1  ON 33
ci_35                -3.940177e-04 3 1  ON 34
ci_36                -2.864086e-04 3 1  ON 35
ci_37                -6.975013e-04 3 1  ON 36
ci_38                -5.064857e-05 3 1  ON 37
ci_39                -1.105492e-04 3 1  ON 38
ci_40                -1.268511e-03 3 1  ON 39
ci_41                 9.074059e-05 3 1  ON 40
ci_42                 2.836966e-04 3 1  ON 41
ci_43                -2.305508e-03 3 1  ON 42
ci_44                -2.295631e-03 3 1  ON 43
ci_45                -2.025420e-04 3 1  ON 44
ci_46                -1.672841e-05 3 1  ON 45
ci_47                -2.983942e-04 3 1  ON 46
ci_48                 6.659141e-05 3 1  ON 47
ci_49                -1.000667e-03 3 1  ON 48
ci_50                -6.093151e-04 3 1  ON 49
ci_51                 2.063700e-04 3 1  ON 50
ci_52                 2.327124e-05 3 1  ON 51
ci_53                -1.115264e-03 3 1  ON 52
ci_54                -7.628499e-04 3 1  ON 53
ci_55                -8.916864e-04 3 1  ON 54
ci_56                 1.378731e-03 3 1  ON 55
ci_57                 1.622826e-03 3 1  ON 56
ci_58                -1.053267e-03 3 1  ON 57
ci_59                -1.458103e-03 3 1  ON 58
ci_60                 4.834696e-04 3 1  ON 59
ci_61                 2.326143e-03 3 1  ON 60
ci_62                -3.423140e-04 3 1  ON 61
ci_63                -3.997993e-05 3 1  ON 62
ci_64                -3.504080e-04 3 1  ON 63
ci_65                -4.919177e-04 3 1  ON 64
ci_66                -6.024984e-04 3 1  ON 65
ci_67                -3.046892e-04 3 1  ON 66
ci_68                -1.831879e-03 3 1  ON 67
ci_69                -1.620478e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9151e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2845e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9048
    reference variance = 0.31696
====================================================
  Execution time = 9.9589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1402e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0306e-01
  Total weights = 7.856524006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8215e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483463475193
                                         uncertainty =       0.001435121835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483463475193
                                         uncertainty =       0.001435121835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245831456
  error estimate for blocks of size 2^( 2) =       0.000255070288
  error estimate for blocks of size 2^( 3) =       0.000263395826
  error estimate for blocks of size 2^( 4) =       0.000269429041
  error estimate for blocks of size 2^( 5) =       0.000272902381
  error estimate for blocks of size 2^( 6) =       0.000274678205
  error estimate for blocks of size 2^( 7) =       0.000275832923
  error estimate for blocks of size 2^( 8) =       0.000277216020
  error estimate for blocks of size 2^( 9) =       0.000277281645

      target function =                  N/A
              le_mean =     -22.824231782078
             les_mean =     521.448613059335
             stat err =       0.000276252198
             autocorr =       1.262805823612
              std dev =       0.695316359557
             le_variance =       0.483464839867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282423178208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824231782068       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824235514252       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824235067878       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824235220532       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.618958e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824231782068       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824233903528       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824233669932       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824233697302       residual = 8.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 8.870154e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824231782068       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824232560212       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824232484467       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824232485961       residual = 4.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.214321e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1783e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.100238e-01 3 1  ON 0
ci_02                -2.202627e-02 3 1  ON 1
ci_03                -2.222330e-02 3 1  ON 2
ci_04                 2.199956e-02 3 1  ON 3
ci_05                -2.149519e-02 3 1  ON 4
ci_06                -2.144546e-02 3 1  ON 5
ci_07                 2.595562e-02 3 1  ON 6
ci_08                -3.586962e-03 3 1  ON 7
ci_09                -1.121695e-02 3 1  ON 8
ci_10                -1.120789e-02 3 1  ON 9
ci_11                 1.637630e-02 3 1  ON 10
ci_12                 1.067697e-02 3 1  ON 11
ci_13                 1.178571e-02 3 1  ON 12
ci_14                 1.717350e-02 3 1  ON 13
ci_15                 7.810983e-03 3 1  ON 14
ci_16                 7.348925e-03 3 1  ON 15
ci_17                -9.261343e-03 3 1  ON 16
ci_18                -9.381078e-03 3 1  ON 17
ci_19                 9.577561e-03 3 1  ON 18
ci_20                 1.068252e-02 3 1  ON 19
ci_21                 8.132516e-03 3 1  ON 20
ci_22                 8.580036e-03 3 1  ON 21
ci_23                 6.314958e-03 3 1  ON 22
ci_24                 7.288785e-03 3 1  ON 23
ci_25                 5.350040e-03 3 1  ON 24
ci_26                 2.629019e-03 3 1  ON 25
ci_27                 2.847810e-03 3 1  ON 26
ci_28                 2.768274e-03 3 1  ON 27
ci_29                 2.883371e-03 3 1  ON 28
ci_30                 5.641456e-04 3 1  ON 29
ci_31                 2.715958e-04 3 1  ON 30
ci_32                 5.533885e-05 3 1  ON 31
ci_33                 2.105273e-04 3 1  ON 32
ci_34                -6.078021e-05 3 1  ON 33
ci_35                -4.080158e-04 3 1  ON 34
ci_36                -2.623061e-04 3 1  ON 35
ci_37                -2.758017e-04 3 1  ON 36
ci_38                 1.409776e-04 3 1  ON 37
ci_39                 7.745361e-05 3 1  ON 38
ci_40                -1.203063e-03 3 1  ON 39
ci_41                 7.394552e-05 3 1  ON 40
ci_42                 2.423748e-05 3 1  ON 41
ci_43                -2.525212e-03 3 1  ON 42
ci_44                -2.027726e-03 3 1  ON 43
ci_45                -1.785449e-04 3 1  ON 44
ci_46                -1.535316e-04 3 1  ON 45
ci_47                -2.737178e-04 3 1  ON 46
ci_48                 3.378521e-04 3 1  ON 47
ci_49                -1.144320e-03 3 1  ON 48
ci_50                -4.831190e-04 3 1  ON 49
ci_51                 1.324562e-04 3 1  ON 50
ci_52                -9.630256e-05 3 1  ON 51
ci_53                -1.094819e-03 3 1  ON 52
ci_54                -8.746076e-04 3 1  ON 53
ci_55                -7.838444e-04 3 1  ON 54
ci_56                 1.581185e-03 3 1  ON 55
ci_57                 1.578099e-03 3 1  ON 56
ci_58                -9.247788e-04 3 1  ON 57
ci_59                -1.249744e-03 3 1  ON 58
ci_60                 5.631316e-04 3 1  ON 59
ci_61                 2.424295e-03 3 1  ON 60
ci_62                -2.825313e-04 3 1  ON 61
ci_63                -2.795608e-04 3 1  ON 62
ci_64                -4.586798e-04 3 1  ON 63
ci_65                -4.624554e-04 3 1  ON 64
ci_66                -3.596412e-04 3 1  ON 65
ci_67                -5.880097e-05 3 1  ON 66
ci_68                -1.810542e-03 3 1  ON 67
ci_69                -1.593155e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7143
    reference variance = 0.53035
====================================================
  Execution time = 1.0203e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0242e-01
  Total weights = 7.8566e+06
  Execution time = 1.4196e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.160586
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485183779190
                                         uncertainty =       0.001431261842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485183779190
                                         uncertainty =       0.001431261842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246268372
  error estimate for blocks of size 2^( 2) =       0.000255461463
  error estimate for blocks of size 2^( 3) =       0.000263861696
  error estimate for blocks of size 2^( 4) =       0.000269907818
  error estimate for blocks of size 2^( 5) =       0.000273562939
  error estimate for blocks of size 2^( 6) =       0.000275621303
  error estimate for blocks of size 2^( 7) =       0.000276473735
  error estimate for blocks of size 2^( 8) =       0.000277068822
  error estimate for blocks of size 2^( 9) =       0.000277692896

      target function =                  N/A
              le_mean =     -22.824862680344
             les_mean =     521.562414647535
             stat err =       0.000276714189
             autocorr =       1.262541258741
              std dev =       0.696552142943
             le_variance =       0.485184887839

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.208441
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485293625136
                                         uncertainty =       0.001508009285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485293625136
                                         uncertainty =       0.001508009285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246296225
  error estimate for blocks of size 2^( 2) =       0.000255493722
  error estimate for blocks of size 2^( 3) =       0.000263899554
  error estimate for blocks of size 2^( 4) =       0.000269951460
  error estimate for blocks of size 2^( 5) =       0.000273610691
  error estimate for blocks of size 2^( 6) =       0.000275668285
  error estimate for blocks of size 2^( 7) =       0.000276514881
  error estimate for blocks of size 2^( 8) =       0.000277107109
  error estimate for blocks of size 2^( 9) =       0.000277748510

      target function =                  N/A
              le_mean =     -22.824858070798
             les_mean =     521.678591806485
             stat err =       0.000276759696
             autocorr =       1.262670926079
              std dev =       0.696630922216
             le_variance =       0.485294641788

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.155803
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485113719243
                                         uncertainty =       0.001449827202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485113719243
                                         uncertainty =       0.001449827202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246250577
  error estimate for blocks of size 2^( 2) =       0.000255450857
  error estimate for blocks of size 2^( 3) =       0.000263857202
  error estimate for blocks of size 2^( 4) =       0.000269911676
  error estimate for blocks of size 2^( 5) =       0.000273572157
  error estimate for blocks of size 2^( 6) =       0.000275620685
  error estimate for blocks of size 2^( 7) =       0.000276469425
  error estimate for blocks of size 2^( 8) =       0.000277066131
  error estimate for blocks of size 2^( 9) =       0.000277709911

      target function =                  N/A
              le_mean =     -22.824856843020
             les_mean =     521.483592053556
             stat err =       0.000276716538
             autocorr =       1.262745171008
              std dev =       0.696501812215
             le_variance =       0.485114774419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485131221890
                                         uncertainty =       0.001434872384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485131221890
                                         uncertainty =       0.001434872384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246255030
  error estimate for blocks of size 2^( 2) =       0.000255450675
  error estimate for blocks of size 2^( 3) =       0.000263852787
  error estimate for blocks of size 2^( 4) =       0.000269901533
  error estimate for blocks of size 2^( 5) =       0.000273559325
  error estimate for blocks of size 2^( 6) =       0.000275616489
  error estimate for blocks of size 2^( 7) =       0.000276465028
  error estimate for blocks of size 2^( 8) =       0.000277061640
  error estimate for blocks of size 2^( 9) =       0.000277701925

      target function =                  N/A
              le_mean =     -22.824854659767
             les_mean =     521.487752211816
             stat err =       0.000276711271
             autocorr =       1.262651438735
              std dev =       0.696514405338
             le_variance =       0.485132316843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824862680344        initial  <--
     6.2500e-02     6.2500e-01             1.6190e-03       -22.824858070798
     2.5000e-01     2.5000e+00             8.8702e-04       -22.824856843020
     1.0000e+00     1.0000e+01             3.2143e-04       -22.824854659767

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.3497
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.103000e-01 3 1  ON 0
ci_02                -2.202304e-02 3 1  ON 1
ci_03                -2.248539e-02 3 1  ON 2
ci_04                 2.209214e-02 3 1  ON 3
ci_05                -2.140776e-02 3 1  ON 4
ci_06                -2.164305e-02 3 1  ON 5
ci_07                 2.506860e-02 3 1  ON 6
ci_08                -3.604345e-03 3 1  ON 7
ci_09                -1.108004e-02 3 1  ON 8
ci_10                -1.094794e-02 3 1  ON 9
ci_11                 1.650365e-02 3 1  ON 10
ci_12                 1.079049e-02 3 1  ON 11
ci_13                 1.196984e-02 3 1  ON 12
ci_14                 1.710062e-02 3 1  ON 13
ci_15                 7.379761e-03 3 1  ON 14
ci_16                 7.620529e-03 3 1  ON 15
ci_17                -9.003265e-03 3 1  ON 16
ci_18                -9.351389e-03 3 1  ON 17
ci_19                 9.489300e-03 3 1  ON 18
ci_20                 1.047483e-02 3 1  ON 19
ci_21                 8.449116e-03 3 1  ON 20
ci_22                 8.520949e-03 3 1  ON 21
ci_23                 6.494902e-03 3 1  ON 22
ci_24                 7.582255e-03 3 1  ON 23
ci_25                 4.932070e-03 3 1  ON 24
ci_26                 2.523376e-03 3 1  ON 25
ci_27                 2.828795e-03 3 1  ON 26
ci_28                 2.997301e-03 3 1  ON 27
ci_29                 2.741091e-03 3 1  ON 28
ci_30                 5.344005e-04 3 1  ON 29
ci_31                 5.185077e-04 3 1  ON 30
ci_32                 4.224441e-06 3 1  ON 31
ci_33                -1.251850e-04 3 1  ON 32
ci_34                -3.297144e-04 3 1  ON 33
ci_35                -3.940177e-04 3 1  ON 34
ci_36                -2.864086e-04 3 1  ON 35
ci_37                -6.975013e-04 3 1  ON 36
ci_38                -5.064857e-05 3 1  ON 37
ci_39                -1.105492e-04 3 1  ON 38
ci_40                -1.268511e-03 3 1  ON 39
ci_41                 9.074059e-05 3 1  ON 40
ci_42                 2.836966e-04 3 1  ON 41
ci_43                -2.305508e-03 3 1  ON 42
ci_44                -2.295631e-03 3 1  ON 43
ci_45                -2.025420e-04 3 1  ON 44
ci_46                -1.672841e-05 3 1  ON 45
ci_47                -2.983942e-04 3 1  ON 46
ci_48                 6.659141e-05 3 1  ON 47
ci_49                -1.000667e-03 3 1  ON 48
ci_50                -6.093151e-04 3 1  ON 49
ci_51                 2.063700e-04 3 1  ON 50
ci_52                 2.327124e-05 3 1  ON 51
ci_53                -1.115264e-03 3 1  ON 52
ci_54                -7.628499e-04 3 1  ON 53
ci_55                -8.916864e-04 3 1  ON 54
ci_56                 1.378731e-03 3 1  ON 55
ci_57                 1.622826e-03 3 1  ON 56
ci_58                -1.053267e-03 3 1  ON 57
ci_59                -1.458103e-03 3 1  ON 58
ci_60                 4.834696e-04 3 1  ON 59
ci_61                 2.326143e-03 3 1  ON 60
ci_62                -3.423140e-04 3 1  ON 61
ci_63                -3.997993e-05 3 1  ON 62
ci_64                -3.504080e-04 3 1  ON 63
ci_65                -4.919177e-04 3 1  ON 64
ci_66                -6.024984e-04 3 1  ON 65
ci_67                -3.046892e-04 3 1  ON 66
ci_68                -1.831879e-03 3 1  ON 67
ci_69                -1.620478e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.9654
    reference variance = 0.785846
====================================================
  Execution time = 9.9254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1389e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9925e-01
  Total weights = 7.856536107e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8223e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483433729919
                                         uncertainty =       0.001218043662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483433729919
                                         uncertainty =       0.001218043662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245823099
  error estimate for blocks of size 2^( 2) =       0.000255009935
  error estimate for blocks of size 2^( 3) =       0.000263239704
  error estimate for blocks of size 2^( 4) =       0.000268947515
  error estimate for blocks of size 2^( 5) =       0.000272389545
  error estimate for blocks of size 2^( 6) =       0.000274063848
  error estimate for blocks of size 2^( 7) =       0.000275264295
  error estimate for blocks of size 2^( 8) =       0.000275238517
  error estimate for blocks of size 2^( 9) =       0.000274854005

      target function =                  N/A
              le_mean =     -22.824854298794
             les_mean =     521.473224578164
             stat err =       0.000274855166
             autocorr =       1.250150880298
              std dev =       0.695292720240
             le_variance =       0.483431966819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282485429879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824854298789       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824857362392       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824857490798       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824857513852       residual = 2.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.181045e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824854298789       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824855221260       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824855297111       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824855305036       residual = 4.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 9.426009e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824854298789       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824854541827       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824854565318       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824854567756       residual = 6.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.535538e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1750e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.102637e-01 3 1  ON 0
ci_02                -2.204400e-02 3 1  ON 1
ci_03                -2.246170e-02 3 1  ON 2
ci_04                 2.208555e-02 3 1  ON 3
ci_05                -2.140339e-02 3 1  ON 4
ci_06                -2.162885e-02 3 1  ON 5
ci_07                 2.510785e-02 3 1  ON 6
ci_08                -3.622731e-03 3 1  ON 7
ci_09                -1.106177e-02 3 1  ON 8
ci_10                -1.099519e-02 3 1  ON 9
ci_11                 1.647121e-02 3 1  ON 10
ci_12                 1.080937e-02 3 1  ON 11
ci_13                 1.192852e-02 3 1  ON 12
ci_14                 1.710314e-02 3 1  ON 13
ci_15                 7.388506e-03 3 1  ON 14
ci_16                 7.651437e-03 3 1  ON 15
ci_17                -8.986897e-03 3 1  ON 16
ci_18                -9.257933e-03 3 1  ON 17
ci_19                 9.494954e-03 3 1  ON 18
ci_20                 1.047823e-02 3 1  ON 19
ci_21                 8.420519e-03 3 1  ON 20
ci_22                 8.492083e-03 3 1  ON 21
ci_23                 6.528295e-03 3 1  ON 22
ci_24                 7.615480e-03 3 1  ON 23
ci_25                 4.968944e-03 3 1  ON 24
ci_26                 2.522782e-03 3 1  ON 25
ci_27                 2.833048e-03 3 1  ON 26
ci_28                 2.967563e-03 3 1  ON 27
ci_29                 2.724917e-03 3 1  ON 28
ci_30                 5.588784e-04 3 1  ON 29
ci_31                 5.836495e-04 3 1  ON 30
ci_32                 5.460478e-05 3 1  ON 31
ci_33                -1.140978e-04 3 1  ON 32
ci_34                -3.324844e-04 3 1  ON 33
ci_35                -3.190110e-04 3 1  ON 34
ci_36                -2.736742e-04 3 1  ON 35
ci_37                -6.612967e-04 3 1  ON 36
ci_38                -6.590981e-05 3 1  ON 37
ci_39                -9.689920e-05 3 1  ON 38
ci_40                -1.253708e-03 3 1  ON 39
ci_41                 1.131752e-04 3 1  ON 40
ci_42                 2.831082e-04 3 1  ON 41
ci_43                -2.339827e-03 3 1  ON 42
ci_44                -2.311263e-03 3 1  ON 43
ci_45                -2.147981e-04 3 1  ON 44
ci_46                -6.646179e-05 3 1  ON 45
ci_47                -2.443863e-04 3 1  ON 46
ci_48                 4.674030e-05 3 1  ON 47
ci_49                -1.094927e-03 3 1  ON 48
ci_50                -5.830971e-04 3 1  ON 49
ci_51                 1.894234e-04 3 1  ON 50
ci_52                 1.684326e-05 3 1  ON 51
ci_53                -1.045913e-03 3 1  ON 52
ci_54                -7.602258e-04 3 1  ON 53
ci_55                -8.467187e-04 3 1  ON 54
ci_56                 1.417431e-03 3 1  ON 55
ci_57                 1.643482e-03 3 1  ON 56
ci_58                -1.062407e-03 3 1  ON 57
ci_59                -1.451908e-03 3 1  ON 58
ci_60                 5.346322e-04 3 1  ON 59
ci_61                 2.330921e-03 3 1  ON 60
ci_62                -3.237901e-04 3 1  ON 61
ci_63                -5.957563e-05 3 1  ON 62
ci_64                -3.122827e-04 3 1  ON 63
ci_65                -5.209458e-04 3 1  ON 64
ci_66                -5.803713e-04 3 1  ON 65
ci_67                -3.102129e-04 3 1  ON 66
ci_68                -1.860585e-03 3 1  ON 67
ci_69                -1.661167e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.9392
    reference variance = 0.781088
====================================================
  Execution time = 1.0195e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0256e-01
  Total weights = 7.8578e+06
  Execution time = 1.4146e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485153038666
                                         uncertainty =       0.001396953356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485153038666
                                         uncertainty =       0.001396953356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246260484
  error estimate for blocks of size 2^( 2) =       0.000255492251
  error estimate for blocks of size 2^( 3) =       0.000263790491
  error estimate for blocks of size 2^( 4) =       0.000269512665
  error estimate for blocks of size 2^( 5) =       0.000273071763
  error estimate for blocks of size 2^( 6) =       0.000274606259
  error estimate for blocks of size 2^( 7) =       0.000276076081
  error estimate for blocks of size 2^( 8) =       0.000277294884
  error estimate for blocks of size 2^( 9) =       0.000278175500

      target function =                  N/A
              le_mean =     -22.824824948713
             les_mean =     521.475448728546
             stat err =       0.000276538181
             autocorr =       1.261016435769
              std dev =       0.696529832573
             le_variance =       0.485153807665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485136909615
                                         uncertainty =       0.001400050747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485136909615
                                         uncertainty =       0.001400050747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246256396
  error estimate for blocks of size 2^( 2) =       0.000255488956
  error estimate for blocks of size 2^( 3) =       0.000263788064
  error estimate for blocks of size 2^( 4) =       0.000269511077
  error estimate for blocks of size 2^( 5) =       0.000273072658
  error estimate for blocks of size 2^( 6) =       0.000274604421
  error estimate for blocks of size 2^( 7) =       0.000276070993
  error estimate for blocks of size 2^( 8) =       0.000277288557
  error estimate for blocks of size 2^( 9) =       0.000278169996

      target function =                  N/A
              le_mean =     -22.824827142660
             les_mean =     521.745733575599
             stat err =       0.000276533492
             autocorr =       1.261015531251
              std dev =       0.696518270493
             le_variance =       0.485137701131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485132138484
                                         uncertainty =       0.001398358891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485132138484
                                         uncertainty =       0.001398358891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246255182
  error estimate for blocks of size 2^( 2) =       0.000255487224
  error estimate for blocks of size 2^( 3) =       0.000263786054
  error estimate for blocks of size 2^( 4) =       0.000269508694
  error estimate for blocks of size 2^( 5) =       0.000273068293
  error estimate for blocks of size 2^( 6) =       0.000274601189
  error estimate for blocks of size 2^( 7) =       0.000276071526
  error estimate for blocks of size 2^( 8) =       0.000277291984
  error estimate for blocks of size 2^( 9) =       0.000278171722

      target function =                  N/A
              le_mean =     -22.824825093114
             les_mean =     521.475853183192
             stat err =       0.000276534105
             autocorr =       1.261033564888
              std dev =       0.696514835712
             le_variance =       0.485132916367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485149454943
                                         uncertainty =       0.001397080405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485149454943
                                         uncertainty =       0.001397080405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246259575
  error estimate for blocks of size 2^( 2) =       0.000255491385
  error estimate for blocks of size 2^( 3) =       0.000263789706
  error estimate for blocks of size 2^( 4) =       0.000269511957
  error estimate for blocks of size 2^( 5) =       0.000273071090
  error estimate for blocks of size 2^( 6) =       0.000274605304
  error estimate for blocks of size 2^( 7) =       0.000276075153
  error estimate for blocks of size 2^( 8) =       0.000277294162
  error estimate for blocks of size 2^( 9) =       0.000278174663

      target function =                  N/A
              le_mean =     -22.824824937602
             les_mean =     521.475856634477
             stat err =       0.000276537320
             autocorr =       1.261017897575
              std dev =       0.696527260941
             le_variance =       0.485150225234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824824948713        initial
     6.2500e-01     6.2500e+00             3.1810e-04       -22.824827142660  <--
     2.5000e+00     2.5000e+01             9.4260e-05       -22.824825093114
     1.0000e+01     1.0000e+02             2.5355e-05       -22.824824937602

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 1.7291e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.101696e-01 3 1  ON 0
ci_02                -2.209120e-02 3 1  ON 1
ci_03                -2.240439e-02 3 1  ON 2
ci_04                 2.207498e-02 3 1  ON 3
ci_05                -2.139236e-02 3 1  ON 4
ci_06                -2.159304e-02 3 1  ON 5
ci_07                 2.519607e-02 3 1  ON 6
ci_08                -3.659743e-03 3 1  ON 7
ci_09                -1.101588e-02 3 1  ON 8
ci_10                -1.110941e-02 3 1  ON 9
ci_11                 1.639677e-02 3 1  ON 10
ci_12                 1.085350e-02 3 1  ON 11
ci_13                 1.182658e-02 3 1  ON 12
ci_14                 1.710896e-02 3 1  ON 13
ci_15                 7.410298e-03 3 1  ON 14
ci_16                 7.723197e-03 3 1  ON 15
ci_17                -8.945125e-03 3 1  ON 16
ci_18                -9.033284e-03 3 1  ON 17
ci_19                 9.505138e-03 3 1  ON 18
ci_20                 1.048808e-02 3 1  ON 19
ci_21                 8.348121e-03 3 1  ON 20
ci_22                 8.412939e-03 3 1  ON 21
ci_23                 6.596717e-03 3 1  ON 22
ci_24                 7.702377e-03 3 1  ON 23
ci_25                 5.050340e-03 3 1  ON 24
ci_26                 2.515662e-03 3 1  ON 25
ci_27                 2.841568e-03 3 1  ON 26
ci_28                 2.896844e-03 3 1  ON 27
ci_29                 2.684697e-03 3 1  ON 28
ci_30                 6.139602e-04 3 1  ON 29
ci_31                 7.460998e-04 3 1  ON 30
ci_32                 1.617168e-04 3 1  ON 31
ci_33                -8.939480e-05 3 1  ON 32
ci_34                -3.349198e-04 3 1  ON 33
ci_35                -1.420137e-04 3 1  ON 34
ci_36                -2.466054e-04 3 1  ON 35
ci_37                -5.883958e-04 3 1  ON 36
ci_38                -9.826333e-05 3 1  ON 37
ci_39                -6.755384e-05 3 1  ON 38
ci_40                -1.224824e-03 3 1  ON 39
ci_41                 1.618493e-04 3 1  ON 40
ci_42                 2.833855e-04 3 1  ON 41
ci_43                -2.418666e-03 3 1  ON 42
ci_44                -2.351505e-03 3 1  ON 43
ci_45                -2.421163e-04 3 1  ON 44
ci_46                -1.726910e-04 3 1  ON 45
ci_47                -1.099988e-04 3 1  ON 46
ci_48                -3.295836e-06 3 1  ON 47
ci_49                -1.294839e-03 3 1  ON 48
ci_50                -5.343462e-04 3 1  ON 49
ci_51                 1.546700e-04 3 1  ON 50
ci_52                 2.397520e-06 3 1  ON 51
ci_53                -9.100582e-04 3 1  ON 52
ci_54                -7.552555e-04 3 1  ON 53
ci_55                -7.439581e-04 3 1  ON 54
ci_56                 1.499970e-03 3 1  ON 55
ci_57                 1.687399e-03 3 1  ON 56
ci_58                -1.083321e-03 3 1  ON 57
ci_59                -1.437135e-03 3 1  ON 58
ci_60                 6.742249e-04 3 1  ON 59
ci_61                 2.343556e-03 3 1  ON 60
ci_62                -2.876924e-04 3 1  ON 61
ci_63                -9.841623e-05 3 1  ON 62
ci_64                -2.239438e-04 3 1  ON 63
ci_65                -5.824825e-04 3 1  ON 64
ci_66                -5.298973e-04 3 1  ON 65
ci_67                -3.212441e-04 3 1  ON 66
ci_68                -1.926365e-03 3 1  ON 67
ci_69                -1.751683e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2852e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8173
    reference variance = 0.552174
====================================================
  Execution time = 9.9630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1356e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0075e-01
  Total weights = 7.856966290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8158e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484109719645
                                         uncertainty =       0.002242012995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484109719645
                                         uncertainty =       0.002242012995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245995480
  error estimate for blocks of size 2^( 2) =       0.000255291081
  error estimate for blocks of size 2^( 3) =       0.000263468255
  error estimate for blocks of size 2^( 4) =       0.000269353116
  error estimate for blocks of size 2^( 5) =       0.000272885585
  error estimate for blocks of size 2^( 6) =       0.000274745415
  error estimate for blocks of size 2^( 7) =       0.000275564474
  error estimate for blocks of size 2^( 8) =       0.000275916593
  error estimate for blocks of size 2^( 9) =       0.000276424700

      target function =                  N/A
              le_mean =     -22.824993431302
             les_mean =     521.481074991157
             stat err =       0.000275662795
             autocorr =       1.255746732291
              std dev =       0.695780288507
             le_variance =       0.484110209875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282499343130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824993431298       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824994745207       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824995109432       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824995049111       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 6.682076e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824993431298       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824993994906       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824994203586       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824994184701       residual = 4.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.758126e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824993431298       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824993602911       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824993677200       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824993672547       residual = 4.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 8.237232e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1781e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.101060e-01 3 1  ON 0
ci_02                -2.229786e-02 3 1  ON 1
ci_03                -2.238687e-02 3 1  ON 2
ci_04                 2.216659e-02 3 1  ON 3
ci_05                -2.142361e-02 3 1  ON 4
ci_06                -2.162062e-02 3 1  ON 5
ci_07                 2.514916e-02 3 1  ON 6
ci_08                -3.493701e-03 3 1  ON 7
ci_09                -1.095358e-02 3 1  ON 8
ci_10                -1.113469e-02 3 1  ON 9
ci_11                 1.612096e-02 3 1  ON 10
ci_12                 1.083898e-02 3 1  ON 11
ci_13                 1.192843e-02 3 1  ON 12
ci_14                 1.718626e-02 3 1  ON 13
ci_15                 7.496145e-03 3 1  ON 14
ci_16                 7.766770e-03 3 1  ON 15
ci_17                -8.762384e-03 3 1  ON 16
ci_18                -8.998206e-03 3 1  ON 17
ci_19                 9.456093e-03 3 1  ON 18
ci_20                 1.038513e-02 3 1  ON 19
ci_21                 8.254467e-03 3 1  ON 20
ci_22                 8.378275e-03 3 1  ON 21
ci_23                 6.440759e-03 3 1  ON 22
ci_24                 7.502814e-03 3 1  ON 23
ci_25                 5.086892e-03 3 1  ON 24
ci_26                 2.391714e-03 3 1  ON 25
ci_27                 2.882937e-03 3 1  ON 26
ci_28                 2.874030e-03 3 1  ON 27
ci_29                 2.837099e-03 3 1  ON 28
ci_30                 6.736832e-04 3 1  ON 29
ci_31                 8.035831e-04 3 1  ON 30
ci_32                 2.971127e-04 3 1  ON 31
ci_33                -3.155056e-05 3 1  ON 32
ci_34                -3.447301e-04 3 1  ON 33
ci_35                -1.674919e-04 3 1  ON 34
ci_36                -3.568020e-04 3 1  ON 35
ci_37                -5.520213e-04 3 1  ON 36
ci_38                -7.056007e-05 3 1  ON 37
ci_39                -1.546268e-04 3 1  ON 38
ci_40                -1.193952e-03 3 1  ON 39
ci_41                -1.469063e-05 3 1  ON 40
ci_42                 3.163304e-04 3 1  ON 41
ci_43                -2.309593e-03 3 1  ON 42
ci_44                -2.391912e-03 3 1  ON 43
ci_45                -1.476835e-04 3 1  ON 44
ci_46                -1.845869e-04 3 1  ON 45
ci_47                -2.288655e-04 3 1  ON 46
ci_48                -4.580713e-05 3 1  ON 47
ci_49                -1.254165e-03 3 1  ON 48
ci_50                -5.035909e-04 3 1  ON 49
ci_51                 4.131447e-05 3 1  ON 50
ci_52                 1.875369e-05 3 1  ON 51
ci_53                -9.065726e-04 3 1  ON 52
ci_54                -8.178612e-04 3 1  ON 53
ci_55                -8.345121e-04 3 1  ON 54
ci_56                 1.682114e-03 3 1  ON 55
ci_57                 1.661926e-03 3 1  ON 56
ci_58                -1.253041e-03 3 1  ON 57
ci_59                -1.449156e-03 3 1  ON 58
ci_60                 7.056159e-04 3 1  ON 59
ci_61                 2.474754e-03 3 1  ON 60
ci_62                -3.833364e-04 3 1  ON 61
ci_63                -9.600639e-05 3 1  ON 62
ci_64                -1.395685e-04 3 1  ON 63
ci_65                -5.082911e-04 3 1  ON 64
ci_66                -3.458254e-04 3 1  ON 65
ci_67                -3.434297e-04 3 1  ON 66
ci_68                -1.779587e-03 3 1  ON 67
ci_69                -1.620108e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8165
    reference variance = 0.30345
====================================================
  Execution time = 1.0188e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9895e-01
  Total weights = 7.8563e+06
  Execution time = 1.4156e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482009696599
                                         uncertainty =       0.001246524287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482009696599
                                         uncertainty =       0.001246524287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245461260
  error estimate for blocks of size 2^( 2) =       0.000254682085
  error estimate for blocks of size 2^( 3) =       0.000262974533
  error estimate for blocks of size 2^( 4) =       0.000268932235
  error estimate for blocks of size 2^( 5) =       0.000272399275
  error estimate for blocks of size 2^( 6) =       0.000274311786
  error estimate for blocks of size 2^( 7) =       0.000275988866
  error estimate for blocks of size 2^( 8) =       0.000276552725
  error estimate for blocks of size 2^( 9) =       0.000276970763

      target function =                  N/A
              le_mean =     -22.824718869316
             les_mean =     521.473369395708
             stat err =       0.000275956035
             autocorr =       1.263903375894
              std dev =       0.694269286116
             le_variance =       0.482009841643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482046472515
                                         uncertainty =       0.001242683619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482046472515
                                         uncertainty =       0.001242683619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245470616
  error estimate for blocks of size 2^( 2) =       0.000254691471
  error estimate for blocks of size 2^( 3) =       0.000262983608
  error estimate for blocks of size 2^( 4) =       0.000268942026
  error estimate for blocks of size 2^( 5) =       0.000272406380
  error estimate for blocks of size 2^( 6) =       0.000274317925
  error estimate for blocks of size 2^( 7) =       0.000275993552
  error estimate for blocks of size 2^( 8) =       0.000276544716
  error estimate for blocks of size 2^( 9) =       0.000276958482

      target function =                  N/A
              le_mean =     -22.824716802210
             les_mean =     521.469358176715
             stat err =       0.000275953669
             autocorr =       1.263785364715
              std dev =       0.694295747473
             le_variance =       0.482046584959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482037624514
                                         uncertainty =       0.001243290049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482037624514
                                         uncertainty =       0.001243290049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245468363
  error estimate for blocks of size 2^( 2) =       0.000254688996
  error estimate for blocks of size 2^( 3) =       0.000262981274
  error estimate for blocks of size 2^( 4) =       0.000268939944
  error estimate for blocks of size 2^( 5) =       0.000272404802
  error estimate for blocks of size 2^( 6) =       0.000274315971
  error estimate for blocks of size 2^( 7) =       0.000275991531
  error estimate for blocks of size 2^( 8) =       0.000276546587
  error estimate for blocks of size 2^( 9) =       0.000276957738

      target function =                  N/A
              le_mean =     -22.824715813859
             les_mean =     521.472541257228
             stat err =       0.000275952957
             autocorr =       1.263802032632
              std dev =       0.694289377189
             le_variance =       0.482037739278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482006211284
                                         uncertainty =       0.001245512486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482006211284
                                         uncertainty =       0.001245512486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245460372
  error estimate for blocks of size 2^( 2) =       0.000254681116
  error estimate for blocks of size 2^( 3) =       0.000262973623
  error estimate for blocks of size 2^( 4) =       0.000268931949
  error estimate for blocks of size 2^( 5) =       0.000272397993
  error estimate for blocks of size 2^( 6) =       0.000274310536
  error estimate for blocks of size 2^( 7) =       0.000275986555
  error estimate for blocks of size 2^( 8) =       0.000276548293
  error estimate for blocks of size 2^( 9) =       0.000276961359

      target function =                  N/A
              le_mean =     -22.824718040502
             les_mean =     521.475800735903
             stat err =       0.000275951686
             autocorr =       1.263872684188
              std dev =       0.694266773650
             le_variance =       0.482006352994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824718869316        initial  <--
     1.5625e-01     1.5625e+00             6.6821e-04       -22.824716802210
     6.2500e-01     6.2500e+00             2.7581e-04       -22.824715813859
     2.5000e+00     2.5000e+01             8.2372e-05       -22.824718040502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.7580
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.101696e-01 3 1  ON 0
ci_02                -2.209120e-02 3 1  ON 1
ci_03                -2.240439e-02 3 1  ON 2
ci_04                 2.207498e-02 3 1  ON 3
ci_05                -2.139236e-02 3 1  ON 4
ci_06                -2.159304e-02 3 1  ON 5
ci_07                 2.519607e-02 3 1  ON 6
ci_08                -3.659743e-03 3 1  ON 7
ci_09                -1.101588e-02 3 1  ON 8
ci_10                -1.110941e-02 3 1  ON 9
ci_11                 1.639677e-02 3 1  ON 10
ci_12                 1.085350e-02 3 1  ON 11
ci_13                 1.182658e-02 3 1  ON 12
ci_14                 1.710896e-02 3 1  ON 13
ci_15                 7.410298e-03 3 1  ON 14
ci_16                 7.723197e-03 3 1  ON 15
ci_17                -8.945125e-03 3 1  ON 16
ci_18                -9.033284e-03 3 1  ON 17
ci_19                 9.505138e-03 3 1  ON 18
ci_20                 1.048808e-02 3 1  ON 19
ci_21                 8.348121e-03 3 1  ON 20
ci_22                 8.412939e-03 3 1  ON 21
ci_23                 6.596717e-03 3 1  ON 22
ci_24                 7.702377e-03 3 1  ON 23
ci_25                 5.050340e-03 3 1  ON 24
ci_26                 2.515662e-03 3 1  ON 25
ci_27                 2.841568e-03 3 1  ON 26
ci_28                 2.896844e-03 3 1  ON 27
ci_29                 2.684697e-03 3 1  ON 28
ci_30                 6.139602e-04 3 1  ON 29
ci_31                 7.460998e-04 3 1  ON 30
ci_32                 1.617168e-04 3 1  ON 31
ci_33                -8.939480e-05 3 1  ON 32
ci_34                -3.349198e-04 3 1  ON 33
ci_35                -1.420137e-04 3 1  ON 34
ci_36                -2.466054e-04 3 1  ON 35
ci_37                -5.883958e-04 3 1  ON 36
ci_38                -9.826333e-05 3 1  ON 37
ci_39                -6.755384e-05 3 1  ON 38
ci_40                -1.224824e-03 3 1  ON 39
ci_41                 1.618493e-04 3 1  ON 40
ci_42                 2.833855e-04 3 1  ON 41
ci_43                -2.418666e-03 3 1  ON 42
ci_44                -2.351505e-03 3 1  ON 43
ci_45                -2.421163e-04 3 1  ON 44
ci_46                -1.726910e-04 3 1  ON 45
ci_47                -1.099988e-04 3 1  ON 46
ci_48                -3.295836e-06 3 1  ON 47
ci_49                -1.294839e-03 3 1  ON 48
ci_50                -5.343462e-04 3 1  ON 49
ci_51                 1.546700e-04 3 1  ON 50
ci_52                 2.397520e-06 3 1  ON 51
ci_53                -9.100582e-04 3 1  ON 52
ci_54                -7.552555e-04 3 1  ON 53
ci_55                -7.439581e-04 3 1  ON 54
ci_56                 1.499970e-03 3 1  ON 55
ci_57                 1.687399e-03 3 1  ON 56
ci_58                -1.083321e-03 3 1  ON 57
ci_59                -1.437135e-03 3 1  ON 58
ci_60                 6.742249e-04 3 1  ON 59
ci_61                 2.343556e-03 3 1  ON 60
ci_62                -2.876924e-04 3 1  ON 61
ci_63                -9.841623e-05 3 1  ON 62
ci_64                -2.239438e-04 3 1  ON 63
ci_65                -5.824825e-04 3 1  ON 64
ci_66                -5.298973e-04 3 1  ON 65
ci_67                -3.212441e-04 3 1  ON 66
ci_68                -1.926365e-03 3 1  ON 67
ci_69                -1.751683e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9057e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2849e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8888
    reference variance = 0.375108
====================================================
  Execution time = 9.9941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1352e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0067e-01
  Total weights = 7.856616720e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8235e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483983760683
                                         uncertainty =       0.001206948983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483983760683
                                         uncertainty =       0.001206948983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245964150
  error estimate for blocks of size 2^( 2) =       0.000255205690
  error estimate for blocks of size 2^( 3) =       0.000263482505
  error estimate for blocks of size 2^( 4) =       0.000269305740
  error estimate for blocks of size 2^( 5) =       0.000272806824
  error estimate for blocks of size 2^( 6) =       0.000274833467
  error estimate for blocks of size 2^( 7) =       0.000276429619
  error estimate for blocks of size 2^( 8) =       0.000278280314
  error estimate for blocks of size 2^( 9) =       0.000277882538

      target function =                  N/A
              le_mean =     -22.824953368028
             les_mean =     521.479168172223
             stat err =       0.000276856485
             autocorr =       1.266968379790
              std dev =       0.695691673816
             le_variance =       0.483986905016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282495336803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824953368028       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824953929555       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824953878186       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824953876441       residual = 2.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.390760e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824953368028       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824953521105       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824953506612       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824953505517       residual = 4.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.716211e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824953368028       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824953407183       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824953403473       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824953403131       residual = 5.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 9.454374e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1819e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.101520e-01 3 1  ON 0
ci_02                -2.207947e-02 3 1  ON 1
ci_03                -2.241104e-02 3 1  ON 2
ci_04                 2.207153e-02 3 1  ON 3
ci_05                -2.141248e-02 3 1  ON 4
ci_06                -2.157688e-02 3 1  ON 5
ci_07                 2.521395e-02 3 1  ON 6
ci_08                -3.653557e-03 3 1  ON 7
ci_09                -1.101968e-02 3 1  ON 8
ci_10                -1.110598e-02 3 1  ON 9
ci_11                 1.641269e-02 3 1  ON 10
ci_12                 1.086002e-02 3 1  ON 11
ci_13                 1.182445e-02 3 1  ON 12
ci_14                 1.710832e-02 3 1  ON 13
ci_15                 7.404973e-03 3 1  ON 14
ci_16                 7.716496e-03 3 1  ON 15
ci_17                -8.962178e-03 3 1  ON 16
ci_18                -9.016660e-03 3 1  ON 17
ci_19                 9.531006e-03 3 1  ON 18
ci_20                 1.047032e-02 3 1  ON 19
ci_21                 8.351190e-03 3 1  ON 20
ci_22                 8.375777e-03 3 1  ON 21
ci_23                 6.571098e-03 3 1  ON 22
ci_24                 7.711435e-03 3 1  ON 23
ci_25                 5.031401e-03 3 1  ON 24
ci_26                 2.519118e-03 3 1  ON 25
ci_27                 2.846887e-03 3 1  ON 26
ci_28                 2.910801e-03 3 1  ON 27
ci_29                 2.682606e-03 3 1  ON 28
ci_30                 6.117144e-04 3 1  ON 29
ci_31                 7.484785e-04 3 1  ON 30
ci_32                 1.655350e-04 3 1  ON 31
ci_33                -7.557086e-05 3 1  ON 32
ci_34                -3.159548e-04 3 1  ON 33
ci_35                -1.337263e-04 3 1  ON 34
ci_36                -2.505058e-04 3 1  ON 35
ci_37                -5.658078e-04 3 1  ON 36
ci_38                -1.056872e-04 3 1  ON 37
ci_39                -8.927626e-05 3 1  ON 38
ci_40                -1.252185e-03 3 1  ON 39
ci_41                 1.697623e-04 3 1  ON 40
ci_42                 2.911048e-04 3 1  ON 41
ci_43                -2.416513e-03 3 1  ON 42
ci_44                -2.367300e-03 3 1  ON 43
ci_45                -2.246019e-04 3 1  ON 44
ci_46                -1.724099e-04 3 1  ON 45
ci_47                -1.139869e-04 3 1  ON 46
ci_48                 1.784688e-05 3 1  ON 47
ci_49                -1.297565e-03 3 1  ON 48
ci_50                -5.349632e-04 3 1  ON 49
ci_51                 1.520205e-04 3 1  ON 50
ci_52                 1.500492e-05 3 1  ON 51
ci_53                -9.088314e-04 3 1  ON 52
ci_54                -7.444515e-04 3 1  ON 53
ci_55                -7.464953e-04 3 1  ON 54
ci_56                 1.502443e-03 3 1  ON 55
ci_57                 1.687393e-03 3 1  ON 56
ci_58                -1.096059e-03 3 1  ON 57
ci_59                -1.433291e-03 3 1  ON 58
ci_60                 6.793056e-04 3 1  ON 59
ci_61                 2.324728e-03 3 1  ON 60
ci_62                -2.832814e-04 3 1  ON 61
ci_63                -1.186299e-04 3 1  ON 62
ci_64                -2.065155e-04 3 1  ON 63
ci_65                -5.838569e-04 3 1  ON 64
ci_66                -5.201840e-04 3 1  ON 65
ci_67                -3.146217e-04 3 1  ON 66
ci_68                -1.917512e-03 3 1  ON 67
ci_69                -1.757091e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8259
    reference variance = 0.436641
====================================================
  Execution time = 9.9421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0101e-01
  Total weights = 7.8565e+06
  Execution time = 1.4514e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484983262463
                                         uncertainty =       0.001262147871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484983262463
                                         uncertainty =       0.001262147871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217355
  error estimate for blocks of size 2^( 2) =       0.000255321046
  error estimate for blocks of size 2^( 3) =       0.000263630863
  error estimate for blocks of size 2^( 4) =       0.000269669645
  error estimate for blocks of size 2^( 5) =       0.000273547746
  error estimate for blocks of size 2^( 6) =       0.000275430545
  error estimate for blocks of size 2^( 7) =       0.000276903487
  error estimate for blocks of size 2^( 8) =       0.000276615096
  error estimate for blocks of size 2^( 9) =       0.000275194391

      target function =                  N/A
              le_mean =     -22.824264623113
             les_mean =     521.448127764879
             stat err =       0.000276035880
             autocorr =       1.256879806442
              std dev =       0.696407845949
             le_variance =       0.484983887899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484970477040
                                         uncertainty =       0.001262925999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484970477040
                                         uncertainty =       0.001262925999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246214109
  error estimate for blocks of size 2^( 2) =       0.000255318480
  error estimate for blocks of size 2^( 3) =       0.000263628775
  error estimate for blocks of size 2^( 4) =       0.000269667761
  error estimate for blocks of size 2^( 5) =       0.000273546533
  error estimate for blocks of size 2^( 6) =       0.000275428577
  error estimate for blocks of size 2^( 7) =       0.000276901828
  error estimate for blocks of size 2^( 8) =       0.000276614273
  error estimate for blocks of size 2^( 9) =       0.000275194387

      target function =                  N/A
              le_mean =     -22.824264533764
             les_mean =     521.448171987638
             stat err =       0.000276034766
             autocorr =       1.256902809025
              std dev =       0.696398664048
             le_variance =       0.484971099288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484975622910
                                         uncertainty =       0.001262569134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484975622910
                                         uncertainty =       0.001262569134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246215415
  error estimate for blocks of size 2^( 2) =       0.000255319486
  error estimate for blocks of size 2^( 3) =       0.000263629568
  error estimate for blocks of size 2^( 4) =       0.000269668469
  error estimate for blocks of size 2^( 5) =       0.000273546931
  error estimate for blocks of size 2^( 6) =       0.000275429321
  error estimate for blocks of size 2^( 7) =       0.000276902465
  error estimate for blocks of size 2^( 8) =       0.000276614500
  error estimate for blocks of size 2^( 9) =       0.000275194355

      target function =                  N/A
              le_mean =     -22.824264512599
             les_mean =     521.448039448247
             stat err =       0.000276035160
             autocorr =       1.256893057158
              std dev =       0.696402359727
             le_variance =       0.484976246633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484982198472
                                         uncertainty =       0.001262200744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484982198472
                                         uncertainty =       0.001262200744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217085
  error estimate for blocks of size 2^( 2) =       0.000255320826
  error estimate for blocks of size 2^( 3) =       0.000263630676
  error estimate for blocks of size 2^( 4) =       0.000269669473
  error estimate for blocks of size 2^( 5) =       0.000273547620
  error estimate for blocks of size 2^( 6) =       0.000275430367
  error estimate for blocks of size 2^( 7) =       0.000276903335
  error estimate for blocks of size 2^( 8) =       0.000276615001
  error estimate for blocks of size 2^( 9) =       0.000275194372

      target function =                  N/A
              le_mean =     -22.824264600138
             les_mean =     521.448105763046
             stat err =       0.000276035769
             autocorr =       1.256881553156
              std dev =       0.696407081882
             le_variance =       0.484982823695


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824264623113        initial  <--
     1.5625e+00     1.5625e+01             1.3908e-04       -22.824264533764
     6.2500e+00     6.2500e+01             3.7162e-05       -22.824264512599
     2.5000e+01     2.5000e+02             9.4544e-06       -22.824264600138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.6297
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.101696e-01 3 1  ON 0
ci_02                -2.209120e-02 3 1  ON 1
ci_03                -2.240439e-02 3 1  ON 2
ci_04                 2.207498e-02 3 1  ON 3
ci_05                -2.139236e-02 3 1  ON 4
ci_06                -2.159304e-02 3 1  ON 5
ci_07                 2.519607e-02 3 1  ON 6
ci_08                -3.659743e-03 3 1  ON 7
ci_09                -1.101588e-02 3 1  ON 8
ci_10                -1.110941e-02 3 1  ON 9
ci_11                 1.639677e-02 3 1  ON 10
ci_12                 1.085350e-02 3 1  ON 11
ci_13                 1.182658e-02 3 1  ON 12
ci_14                 1.710896e-02 3 1  ON 13
ci_15                 7.410298e-03 3 1  ON 14
ci_16                 7.723197e-03 3 1  ON 15
ci_17                -8.945125e-03 3 1  ON 16
ci_18                -9.033284e-03 3 1  ON 17
ci_19                 9.505138e-03 3 1  ON 18
ci_20                 1.048808e-02 3 1  ON 19
ci_21                 8.348121e-03 3 1  ON 20
ci_22                 8.412939e-03 3 1  ON 21
ci_23                 6.596717e-03 3 1  ON 22
ci_24                 7.702377e-03 3 1  ON 23
ci_25                 5.050340e-03 3 1  ON 24
ci_26                 2.515662e-03 3 1  ON 25
ci_27                 2.841568e-03 3 1  ON 26
ci_28                 2.896844e-03 3 1  ON 27
ci_29                 2.684697e-03 3 1  ON 28
ci_30                 6.139602e-04 3 1  ON 29
ci_31                 7.460998e-04 3 1  ON 30
ci_32                 1.617168e-04 3 1  ON 31
ci_33                -8.939480e-05 3 1  ON 32
ci_34                -3.349198e-04 3 1  ON 33
ci_35                -1.420137e-04 3 1  ON 34
ci_36                -2.466054e-04 3 1  ON 35
ci_37                -5.883958e-04 3 1  ON 36
ci_38                -9.826333e-05 3 1  ON 37
ci_39                -6.755384e-05 3 1  ON 38
ci_40                -1.224824e-03 3 1  ON 39
ci_41                 1.618493e-04 3 1  ON 40
ci_42                 2.833855e-04 3 1  ON 41
ci_43                -2.418666e-03 3 1  ON 42
ci_44                -2.351505e-03 3 1  ON 43
ci_45                -2.421163e-04 3 1  ON 44
ci_46                -1.726910e-04 3 1  ON 45
ci_47                -1.099988e-04 3 1  ON 46
ci_48                -3.295836e-06 3 1  ON 47
ci_49                -1.294839e-03 3 1  ON 48
ci_50                -5.343462e-04 3 1  ON 49
ci_51                 1.546700e-04 3 1  ON 50
ci_52                 2.397520e-06 3 1  ON 51
ci_53                -9.100582e-04 3 1  ON 52
ci_54                -7.552555e-04 3 1  ON 53
ci_55                -7.439581e-04 3 1  ON 54
ci_56                 1.499970e-03 3 1  ON 55
ci_57                 1.687399e-03 3 1  ON 56
ci_58                -1.083321e-03 3 1  ON 57
ci_59                -1.437135e-03 3 1  ON 58
ci_60                 6.742249e-04 3 1  ON 59
ci_61                 2.343556e-03 3 1  ON 60
ci_62                -2.876924e-04 3 1  ON 61
ci_63                -9.841623e-05 3 1  ON 62
ci_64                -2.239438e-04 3 1  ON 63
ci_65                -5.824825e-04 3 1  ON 64
ci_66                -5.298973e-04 3 1  ON 65
ci_67                -3.212441e-04 3 1  ON 66
ci_68                -1.926365e-03 3 1  ON 67
ci_69                -1.751683e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8883e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2850e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8479
    reference variance = 0.410736
====================================================
  Execution time = 9.8548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1451e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0241e-01
  Total weights = 7.856408076e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8129e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485774465717
                                         uncertainty =       0.001310334725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485774465717
                                         uncertainty =       0.001310334725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246418290
  error estimate for blocks of size 2^( 2) =       0.000255555547
  error estimate for blocks of size 2^( 3) =       0.000263727670
  error estimate for blocks of size 2^( 4) =       0.000269812235
  error estimate for blocks of size 2^( 5) =       0.000273264959
  error estimate for blocks of size 2^( 6) =       0.000275261367
  error estimate for blocks of size 2^( 7) =       0.000276318168
  error estimate for blocks of size 2^( 8) =       0.000276209468
  error estimate for blocks of size 2^( 9) =       0.000275615427

      target function =                  N/A
              le_mean =     -22.824213477606
             les_mean =     521.447126872393
             stat err =       0.000275851107
             autocorr =       1.253151521947
              std dev =       0.696976174286
             le_variance =       0.485775787523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282421347761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824213477607       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824213601096       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824213607889       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824213608155       residual = 4.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.280786e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824213477607       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824213508762       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824213510502       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824213510577       residual = 4.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 3.228039e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824213477607       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824213485414       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824213485852       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824213485871       residual = 5.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 8.086552e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1669e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.101693e-01 3 1  ON 0
ci_02                -2.208980e-02 3 1  ON 1
ci_03                -2.240309e-02 3 1  ON 2
ci_04                 2.207577e-02 3 1  ON 3
ci_05                -2.139364e-02 3 1  ON 4
ci_06                -2.159243e-02 3 1  ON 5
ci_07                 2.519930e-02 3 1  ON 6
ci_08                -3.660242e-03 3 1  ON 7
ci_09                -1.101587e-02 3 1  ON 8
ci_10                -1.110785e-02 3 1  ON 9
ci_11                 1.639700e-02 3 1  ON 10
ci_12                 1.085415e-02 3 1  ON 11
ci_13                 1.182706e-02 3 1  ON 12
ci_14                 1.711006e-02 3 1  ON 13
ci_15                 7.410987e-03 3 1  ON 14
ci_16                 7.722565e-03 3 1  ON 15
ci_17                -8.946253e-03 3 1  ON 16
ci_18                -9.032444e-03 3 1  ON 17
ci_19                 9.507028e-03 3 1  ON 18
ci_20                 1.049090e-02 3 1  ON 19
ci_21                 8.346974e-03 3 1  ON 20
ci_22                 8.413468e-03 3 1  ON 21
ci_23                 6.595944e-03 3 1  ON 22
ci_24                 7.702665e-03 3 1  ON 23
ci_25                 5.051407e-03 3 1  ON 24
ci_26                 2.517846e-03 3 1  ON 25
ci_27                 2.840112e-03 3 1  ON 26
ci_28                 2.896024e-03 3 1  ON 27
ci_29                 2.684990e-03 3 1  ON 28
ci_30                 6.138843e-04 3 1  ON 29
ci_31                 7.444839e-04 3 1  ON 30
ci_32                 1.625954e-04 3 1  ON 31
ci_33                -9.031016e-05 3 1  ON 32
ci_34                -3.342036e-04 3 1  ON 33
ci_35                -1.412192e-04 3 1  ON 34
ci_36                -2.489638e-04 3 1  ON 35
ci_37                -5.866902e-04 3 1  ON 36
ci_38                -9.975916e-05 3 1  ON 37
ci_39                -6.839438e-05 3 1  ON 38
ci_40                -1.225596e-03 3 1  ON 39
ci_41                 1.603318e-04 3 1  ON 40
ci_42                 2.806104e-04 3 1  ON 41
ci_43                -2.421481e-03 3 1  ON 42
ci_44                -2.351366e-03 3 1  ON 43
ci_45                -2.403224e-04 3 1  ON 44
ci_46                -1.721847e-04 3 1  ON 45
ci_47                -1.081998e-04 3 1  ON 46
ci_48                -3.759790e-06 3 1  ON 47
ci_49                -1.295607e-03 3 1  ON 48
ci_50                -5.339267e-04 3 1  ON 49
ci_51                 1.546310e-04 3 1  ON 50
ci_52                 2.596227e-06 3 1  ON 51
ci_53                -9.099467e-04 3 1  ON 52
ci_54                -7.540744e-04 3 1  ON 53
ci_55                -7.418000e-04 3 1  ON 54
ci_56                 1.502227e-03 3 1  ON 55
ci_57                 1.687128e-03 3 1  ON 56
ci_58                -1.085473e-03 3 1  ON 57
ci_59                -1.436344e-03 3 1  ON 58
ci_60                 6.765662e-04 3 1  ON 59
ci_61                 2.342646e-03 3 1  ON 60
ci_62                -2.870160e-04 3 1  ON 61
ci_63                -1.005830e-04 3 1  ON 62
ci_64                -2.232414e-04 3 1  ON 63
ci_65                -5.828003e-04 3 1  ON 64
ci_66                -5.293309e-04 3 1  ON 65
ci_67                -3.221555e-04 3 1  ON 66
ci_68                -1.924187e-03 3 1  ON 67
ci_69                -1.749208e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.894
    reference variance = 0.624905
====================================================
  Execution time = 9.9506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0148e-01
  Total weights = 7.8564e+06
  Execution time = 1.4120e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457335813
                                         uncertainty =       0.001490593335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457335813
                                         uncertainty =       0.001490593335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246084126
  error estimate for blocks of size 2^( 2) =       0.000255306066
  error estimate for blocks of size 2^( 3) =       0.000263552804
  error estimate for blocks of size 2^( 4) =       0.000269483330
  error estimate for blocks of size 2^( 5) =       0.000272967128
  error estimate for blocks of size 2^( 6) =       0.000274917759
  error estimate for blocks of size 2^( 7) =       0.000276296786
  error estimate for blocks of size 2^( 8) =       0.000276231816
  error estimate for blocks of size 2^( 9) =       0.000276470402

      target function =                  N/A
              le_mean =     -22.824740008999
             les_mean =     521.470248545422
             stat err =       0.000275979191
             autocorr =       1.257724368428
              std dev =       0.696031016300
             le_variance =       0.484459175651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457044626
                                         uncertainty =       0.001490943642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457044626
                                         uncertainty =       0.001490943642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246084052
  error estimate for blocks of size 2^( 2) =       0.000255305953
  error estimate for blocks of size 2^( 3) =       0.000263552675
  error estimate for blocks of size 2^( 4) =       0.000269483165
  error estimate for blocks of size 2^( 5) =       0.000272966974
  error estimate for blocks of size 2^( 6) =       0.000274917617
  error estimate for blocks of size 2^( 7) =       0.000276296726
  error estimate for blocks of size 2^( 8) =       0.000276231696
  error estimate for blocks of size 2^( 9) =       0.000276470071

      target function =                  N/A
              le_mean =     -22.824739968275
             les_mean =     521.470208774365
             stat err =       0.000275979028
             autocorr =       1.257723637702
              std dev =       0.696030806499
             le_variance =       0.484458883595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457180690
                                         uncertainty =       0.001490770361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457180690
                                         uncertainty =       0.001490770361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246084086
  error estimate for blocks of size 2^( 2) =       0.000255306008
  error estimate for blocks of size 2^( 3) =       0.000263552736
  error estimate for blocks of size 2^( 4) =       0.000269483244
  error estimate for blocks of size 2^( 5) =       0.000272967048
  error estimate for blocks of size 2^( 6) =       0.000274917685
  error estimate for blocks of size 2^( 7) =       0.000276296753
  error estimate for blocks of size 2^( 8) =       0.000276231749
  error estimate for blocks of size 2^( 9) =       0.000276470228

      target function =                  N/A
              le_mean =     -22.824739987664
             les_mean =     521.470229609946
             stat err =       0.000275979104
             autocorr =       1.257723979340
              std dev =       0.696030904552
             le_variance =       0.484459020091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457315332
                                         uncertainty =       0.001490615505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484457315332
                                         uncertainty =       0.001490615505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246084121
  error estimate for blocks of size 2^( 2) =       0.000255306059
  error estimate for blocks of size 2^( 3) =       0.000263552795
  error estimate for blocks of size 2^( 4) =       0.000269483319
  error estimate for blocks of size 2^( 5) =       0.000272967117
  error estimate for blocks of size 2^( 6) =       0.000274917749
  error estimate for blocks of size 2^( 7) =       0.000276296782
  error estimate for blocks of size 2^( 8) =       0.000276231808
  error estimate for blocks of size 2^( 9) =       0.000276470381

      target function =                  N/A
              le_mean =     -22.824740006130
             les_mean =     521.470243913491
             stat err =       0.000275979180
             autocorr =       1.257724320568
              std dev =       0.696031001547
             le_variance =       0.484459155115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824740008999        initial  <--
     1.5625e+01     1.5625e+02             1.2808e-05       -22.824739968275
     6.2500e+01     6.2500e+02             3.2280e-06       -22.824739987664
     2.5000e+02     2.5000e+03             8.0866e-07       -22.824740006130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.7722
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.101696e-01 3 1  ON 0
ci_02                -2.209120e-02 3 1  ON 1
ci_03                -2.240439e-02 3 1  ON 2
ci_04                 2.207498e-02 3 1  ON 3
ci_05                -2.139236e-02 3 1  ON 4
ci_06                -2.159304e-02 3 1  ON 5
ci_07                 2.519607e-02 3 1  ON 6
ci_08                -3.659743e-03 3 1  ON 7
ci_09                -1.101588e-02 3 1  ON 8
ci_10                -1.110941e-02 3 1  ON 9
ci_11                 1.639677e-02 3 1  ON 10
ci_12                 1.085350e-02 3 1  ON 11
ci_13                 1.182658e-02 3 1  ON 12
ci_14                 1.710896e-02 3 1  ON 13
ci_15                 7.410298e-03 3 1  ON 14
ci_16                 7.723197e-03 3 1  ON 15
ci_17                -8.945125e-03 3 1  ON 16
ci_18                -9.033284e-03 3 1  ON 17
ci_19                 9.505138e-03 3 1  ON 18
ci_20                 1.048808e-02 3 1  ON 19
ci_21                 8.348121e-03 3 1  ON 20
ci_22                 8.412939e-03 3 1  ON 21
ci_23                 6.596717e-03 3 1  ON 22
ci_24                 7.702377e-03 3 1  ON 23
ci_25                 5.050340e-03 3 1  ON 24
ci_26                 2.515662e-03 3 1  ON 25
ci_27                 2.841568e-03 3 1  ON 26
ci_28                 2.896844e-03 3 1  ON 27
ci_29                 2.684697e-03 3 1  ON 28
ci_30                 6.139602e-04 3 1  ON 29
ci_31                 7.460998e-04 3 1  ON 30
ci_32                 1.617168e-04 3 1  ON 31
ci_33                -8.939480e-05 3 1  ON 32
ci_34                -3.349198e-04 3 1  ON 33
ci_35                -1.420137e-04 3 1  ON 34
ci_36                -2.466054e-04 3 1  ON 35
ci_37                -5.883958e-04 3 1  ON 36
ci_38                -9.826333e-05 3 1  ON 37
ci_39                -6.755384e-05 3 1  ON 38
ci_40                -1.224824e-03 3 1  ON 39
ci_41                 1.618493e-04 3 1  ON 40
ci_42                 2.833855e-04 3 1  ON 41
ci_43                -2.418666e-03 3 1  ON 42
ci_44                -2.351505e-03 3 1  ON 43
ci_45                -2.421163e-04 3 1  ON 44
ci_46                -1.726910e-04 3 1  ON 45
ci_47                -1.099988e-04 3 1  ON 46
ci_48                -3.295836e-06 3 1  ON 47
ci_49                -1.294839e-03 3 1  ON 48
ci_50                -5.343462e-04 3 1  ON 49
ci_51                 1.546700e-04 3 1  ON 50
ci_52                 2.397520e-06 3 1  ON 51
ci_53                -9.100582e-04 3 1  ON 52
ci_54                -7.552555e-04 3 1  ON 53
ci_55                -7.439581e-04 3 1  ON 54
ci_56                 1.499970e-03 3 1  ON 55
ci_57                 1.687399e-03 3 1  ON 56
ci_58                -1.083321e-03 3 1  ON 57
ci_59                -1.437135e-03 3 1  ON 58
ci_60                 6.742249e-04 3 1  ON 59
ci_61                 2.343556e-03 3 1  ON 60
ci_62                -2.876924e-04 3 1  ON 61
ci_63                -9.841623e-05 3 1  ON 62
ci_64                -2.239438e-04 3 1  ON 63
ci_65                -5.824825e-04 3 1  ON 64
ci_66                -5.298973e-04 3 1  ON 65
ci_67                -3.212441e-04 3 1  ON 66
ci_68                -1.926365e-03 3 1  ON 67
ci_69                -1.751683e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8747e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2851e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7768
    reference variance = 0.476498
====================================================
  Execution time = 9.8489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1390e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.2889e-01
  Total weights = 7.856184608e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8101e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488958852629
                                         uncertainty =       0.003698808128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488958852629
                                         uncertainty =       0.003698808128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247223286
  error estimate for blocks of size 2^( 2) =       0.000256444232
  error estimate for blocks of size 2^( 3) =       0.000264663529
  error estimate for blocks of size 2^( 4) =       0.000270614737
  error estimate for blocks of size 2^( 5) =       0.000274084590
  error estimate for blocks of size 2^( 6) =       0.000276517204
  error estimate for blocks of size 2^( 7) =       0.000277834655
  error estimate for blocks of size 2^( 8) =       0.000278276204
  error estimate for blocks of size 2^( 9) =       0.000279286722

      target function =                  N/A
              le_mean =     -22.824338674022
             les_mean =     521.479329865783
             stat err =       0.000277978696
             autocorr =       1.264282943939
              std dev =       0.699253047250
             le_variance =       0.488954824088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282433867402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824338674015       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824338687734       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824338687297       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824338687254       residual = 8.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 2.135288e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824338674015       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824338677448       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824338677338       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824338677328       residual = 8.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 5.347332e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824338674015       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824338674873       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824338674846       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824338674843       residual = 8.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 1.337404e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1661e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.101695e-01 3 1  ON 0
ci_02                -2.209116e-02 3 1  ON 1
ci_03                -2.240430e-02 3 1  ON 2
ci_04                 2.207487e-02 3 1  ON 3
ci_05                -2.139222e-02 3 1  ON 4
ci_06                -2.159305e-02 3 1  ON 5
ci_07                 2.519611e-02 3 1  ON 6
ci_08                -3.659724e-03 3 1  ON 7
ci_09                -1.101585e-02 3 1  ON 8
ci_10                -1.110939e-02 3 1  ON 9
ci_11                 1.639661e-02 3 1  ON 10
ci_12                 1.085363e-02 3 1  ON 11
ci_13                 1.182670e-02 3 1  ON 12
ci_14                 1.710880e-02 3 1  ON 13
ci_15                 7.410408e-03 3 1  ON 14
ci_16                 7.722788e-03 3 1  ON 15
ci_17                -8.945063e-03 3 1  ON 16
ci_18                -9.032983e-03 3 1  ON 17
ci_19                 9.505325e-03 3 1  ON 18
ci_20                 1.048813e-02 3 1  ON 19
ci_21                 8.348293e-03 3 1  ON 20
ci_22                 8.412880e-03 3 1  ON 21
ci_23                 6.596549e-03 3 1  ON 22
ci_24                 7.702222e-03 3 1  ON 23
ci_25                 5.050320e-03 3 1  ON 24
ci_26                 2.516068e-03 3 1  ON 25
ci_27                 2.841612e-03 3 1  ON 26
ci_28                 2.896772e-03 3 1  ON 27
ci_29                 2.684640e-03 3 1  ON 28
ci_30                 6.140576e-04 3 1  ON 29
ci_31                 7.461640e-04 3 1  ON 30
ci_32                 1.617673e-04 3 1  ON 31
ci_33                -8.935469e-05 3 1  ON 32
ci_34                -3.350176e-04 3 1  ON 33
ci_35                -1.416045e-04 3 1  ON 34
ci_36                -2.466006e-04 3 1  ON 35
ci_37                -5.884459e-04 3 1  ON 36
ci_38                -9.823061e-05 3 1  ON 37
ci_39                -6.748916e-05 3 1  ON 38
ci_40                -1.224289e-03 3 1  ON 39
ci_41                 1.620711e-04 3 1  ON 40
ci_42                 2.830657e-04 3 1  ON 41
ci_43                -2.419086e-03 3 1  ON 42
ci_44                -2.351769e-03 3 1  ON 43
ci_45                -2.420345e-04 3 1  ON 44
ci_46                -1.727036e-04 3 1  ON 45
ci_47                -1.099356e-04 3 1  ON 46
ci_48                -3.337440e-06 3 1  ON 47
ci_49                -1.294741e-03 3 1  ON 48
ci_50                -5.341548e-04 3 1  ON 49
ci_51                 1.545678e-04 3 1  ON 50
ci_52                 2.440411e-06 3 1  ON 51
ci_53                -9.100548e-04 3 1  ON 52
ci_54                -7.553456e-04 3 1  ON 53
ci_55                -7.439432e-04 3 1  ON 54
ci_56                 1.500103e-03 3 1  ON 55
ci_57                 1.687314e-03 3 1  ON 56
ci_58                -1.083364e-03 3 1  ON 57
ci_59                -1.437142e-03 3 1  ON 58
ci_60                 6.741846e-04 3 1  ON 59
ci_61                 2.343493e-03 3 1  ON 60
ci_62                -2.876327e-04 3 1  ON 61
ci_63                -9.843901e-05 3 1  ON 62
ci_64                -2.241723e-04 3 1  ON 63
ci_65                -5.825094e-04 3 1  ON 64
ci_66                -5.299369e-04 3 1  ON 65
ci_67                -3.211192e-04 3 1  ON 66
ci_68                -1.926039e-03 3 1  ON 67
ci_69                -1.751364e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8156
    reference variance = 0.287774
====================================================
  Execution time = 9.7707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0158e-01
  Total weights = 7.8565e+06
  Execution time = 1.4265e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494261286
                                         uncertainty =       0.002022269590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494261286
                                         uncertainty =       0.002022269590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246346764
  error estimate for blocks of size 2^( 2) =       0.000255546587
  error estimate for blocks of size 2^( 3) =       0.000263942270
  error estimate for blocks of size 2^( 4) =       0.000269782109
  error estimate for blocks of size 2^( 5) =       0.000273385548
  error estimate for blocks of size 2^( 6) =       0.000275244597
  error estimate for blocks of size 2^( 7) =       0.000276503261
  error estimate for blocks of size 2^( 8) =       0.000277016532
  error estimate for blocks of size 2^( 9) =       0.000279386439

      target function =                  N/A
              le_mean =     -22.824570059228
             les_mean =     521.462575932100
             stat err =       0.000277037707
             autocorr =       1.264689885560
              std dev =       0.696773869634
             le_variance =       0.485493825405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494167195
                                         uncertainty =       0.002022300302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494167195
                                         uncertainty =       0.002022300302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246346740
  error estimate for blocks of size 2^( 2) =       0.000255546573
  error estimate for blocks of size 2^( 3) =       0.000263942272
  error estimate for blocks of size 2^( 4) =       0.000269782120
  error estimate for blocks of size 2^( 5) =       0.000273385567
  error estimate for blocks of size 2^( 6) =       0.000275244614
  error estimate for blocks of size 2^( 7) =       0.000276503289
  error estimate for blocks of size 2^( 8) =       0.000277016580
  error estimate for blocks of size 2^( 9) =       0.000279386468

      target function =                  N/A
              le_mean =     -22.824570069587
             les_mean =     521.462580218835
             stat err =       0.000277037738
             autocorr =       1.264690408244
              std dev =       0.696773802144
             le_variance =       0.485493731354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494214079
                                         uncertainty =       0.002022284964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494214079
                                         uncertainty =       0.002022284964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246346752
  error estimate for blocks of size 2^( 2) =       0.000255546580
  error estimate for blocks of size 2^( 3) =       0.000263942271
  error estimate for blocks of size 2^( 4) =       0.000269782114
  error estimate for blocks of size 2^( 5) =       0.000273385557
  error estimate for blocks of size 2^( 6) =       0.000275244606
  error estimate for blocks of size 2^( 7) =       0.000276503275
  error estimate for blocks of size 2^( 8) =       0.000277016556
  error estimate for blocks of size 2^( 9) =       0.000279386454

      target function =                  N/A
              le_mean =     -22.824570064402
             les_mean =     521.462577970434
             stat err =       0.000277037723
             autocorr =       1.264690147206
              std dev =       0.696773835773
             le_variance =       0.485493778218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494255369
                                         uncertainty =       0.002022271512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485494255369
                                         uncertainty =       0.002022271512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246346763
  error estimate for blocks of size 2^( 2) =       0.000255546586
  error estimate for blocks of size 2^( 3) =       0.000263942270
  error estimate for blocks of size 2^( 4) =       0.000269782109
  error estimate for blocks of size 2^( 5) =       0.000273385549
  error estimate for blocks of size 2^( 6) =       0.000275244598
  error estimate for blocks of size 2^( 7) =       0.000276503262
  error estimate for blocks of size 2^( 8) =       0.000277016535
  error estimate for blocks of size 2^( 9) =       0.000279386441

      target function =                  N/A
              le_mean =     -22.824570059874
             les_mean =     521.462576175992
             stat err =       0.000277037709
             autocorr =       1.264689918246
              std dev =       0.696773865390
             le_variance =       0.485493819491


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824570059228        initial
     1.5625e+02     1.5625e+03             2.1353e-06       -22.824570069587  <--
     6.2500e+02     6.2500e+03             5.3473e-07       -22.824570064402
     2.5000e+03     2.5000e+04             1.3374e-07       -22.824570059874

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 1.7198e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209102e-02 3 1  ON 1
ci_03                -2.240405e-02 3 1  ON 2
ci_04                 2.207453e-02 3 1  ON 3
ci_05                -2.139178e-02 3 1  ON 4
ci_06                -2.159309e-02 3 1  ON 5
ci_07                 2.519622e-02 3 1  ON 6
ci_08                -3.659668e-03 3 1  ON 7
ci_09                -1.101576e-02 3 1  ON 8
ci_10                -1.110934e-02 3 1  ON 9
ci_11                 1.639612e-02 3 1  ON 10
ci_12                 1.085401e-02 3 1  ON 11
ci_13                 1.182708e-02 3 1  ON 12
ci_14                 1.710831e-02 3 1  ON 13
ci_15                 7.410736e-03 3 1  ON 14
ci_16                 7.721559e-03 3 1  ON 15
ci_17                -8.944877e-03 3 1  ON 16
ci_18                -9.032082e-03 3 1  ON 17
ci_19                 9.505882e-03 3 1  ON 18
ci_20                 1.048828e-02 3 1  ON 19
ci_21                 8.348808e-03 3 1  ON 20
ci_22                 8.412704e-03 3 1  ON 21
ci_23                 6.596045e-03 3 1  ON 22
ci_24                 7.701759e-03 3 1  ON 23
ci_25                 5.050263e-03 3 1  ON 24
ci_26                 2.517288e-03 3 1  ON 25
ci_27                 2.841743e-03 3 1  ON 26
ci_28                 2.896557e-03 3 1  ON 27
ci_29                 2.684468e-03 3 1  ON 28
ci_30                 6.143495e-04 3 1  ON 29
ci_31                 7.463565e-04 3 1  ON 30
ci_32                 1.619184e-04 3 1  ON 31
ci_33                -8.923445e-05 3 1  ON 32
ci_34                -3.353105e-04 3 1  ON 33
ci_35                -1.403783e-04 3 1  ON 34
ci_36                -2.465863e-04 3 1  ON 35
ci_37                -5.885959e-04 3 1  ON 36
ci_38                -9.813256e-05 3 1  ON 37
ci_39                -6.729537e-05 3 1  ON 38
ci_40                -1.222688e-03 3 1  ON 39
ci_41                 1.627356e-04 3 1  ON 40
ci_42                 2.821074e-04 3 1  ON 41
ci_43                -2.420344e-03 3 1  ON 42
ci_44                -2.352562e-03 3 1  ON 43
ci_45                -2.417895e-04 3 1  ON 44
ci_46                -1.727413e-04 3 1  ON 45
ci_47                -1.097459e-04 3 1  ON 46
ci_48                -3.462119e-06 3 1  ON 47
ci_49                -1.294447e-03 3 1  ON 48
ci_50                -5.335821e-04 3 1  ON 49
ci_51                 1.542614e-04 3 1  ON 50
ci_52                 2.568843e-06 3 1  ON 51
ci_53                -9.100447e-04 3 1  ON 52
ci_54                -7.556153e-04 3 1  ON 53
ci_55                -7.438985e-04 3 1  ON 54
ci_56                 1.500502e-03 3 1  ON 55
ci_57                 1.687060e-03 3 1  ON 56
ci_58                -1.083490e-03 3 1  ON 57
ci_59                -1.437163e-03 3 1  ON 58
ci_60                 6.740640e-04 3 1  ON 59
ci_61                 2.343305e-03 3 1  ON 60
ci_62                -2.874541e-04 3 1  ON 61
ci_63                -9.850728e-05 3 1  ON 62
ci_64                -2.248568e-04 3 1  ON 63
ci_65                -5.825896e-04 3 1  ON 64
ci_66                -5.300557e-04 3 1  ON 65
ci_67                -3.207452e-04 3 1  ON 66
ci_68                -1.925061e-03 3 1  ON 67
ci_69                -1.750409e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8860e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2848e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.9154
    reference variance = 0.447146
====================================================
  Execution time = 9.9000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1381e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0617e-01
  Total weights = 7.856617297e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8130e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487563727789
                                         uncertainty =       0.001659605037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487563727789
                                         uncertainty =       0.001659605037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246872085
  error estimate for blocks of size 2^( 2) =       0.000256054584
  error estimate for blocks of size 2^( 3) =       0.000264483987
  error estimate for blocks of size 2^( 4) =       0.000270455363
  error estimate for blocks of size 2^( 5) =       0.000274260695
  error estimate for blocks of size 2^( 6) =       0.000276002800
  error estimate for blocks of size 2^( 7) =       0.000277289695
  error estimate for blocks of size 2^( 8) =       0.000277752097
  error estimate for blocks of size 2^( 9) =       0.000278457878

      target function =                  N/A
              le_mean =     -22.824508097740
             les_mean =     521.464339516753
             stat err =       0.000277375618
             autocorr =       1.262387236104
              std dev =       0.698259701188
             le_variance =       0.487566610303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282450809774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824508097736       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824508143977       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824508146602       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824508147334       residual = 1.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 5.372803e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824508097736       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824508109333       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824508109993       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824508110178       residual = 1.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.347325e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824508097736       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824508100637       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824508100803       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824508100849       residual = 1.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 3.370901e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1715e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.101684e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240346e-02 3 1  ON 2
ci_04                 2.207375e-02 3 1  ON 3
ci_05                -2.139140e-02 3 1  ON 4
ci_06                -2.159304e-02 3 1  ON 5
ci_07                 2.519720e-02 3 1  ON 6
ci_08                -3.659729e-03 3 1  ON 7
ci_09                -1.101642e-02 3 1  ON 8
ci_10                -1.110883e-02 3 1  ON 9
ci_11                 1.639579e-02 3 1  ON 10
ci_12                 1.085438e-02 3 1  ON 11
ci_13                 1.182800e-02 3 1  ON 12
ci_14                 1.710730e-02 3 1  ON 13
ci_15                 7.410314e-03 3 1  ON 14
ci_16                 7.721435e-03 3 1  ON 15
ci_17                -8.946225e-03 3 1  ON 16
ci_18                -9.032488e-03 3 1  ON 17
ci_19                 9.505612e-03 3 1  ON 18
ci_20                 1.048883e-02 3 1  ON 19
ci_21                 8.348200e-03 3 1  ON 20
ci_22                 8.412940e-03 3 1  ON 21
ci_23                 6.595761e-03 3 1  ON 22
ci_24                 7.701771e-03 3 1  ON 23
ci_25                 5.050574e-03 3 1  ON 24
ci_26                 2.516796e-03 3 1  ON 25
ci_27                 2.840942e-03 3 1  ON 26
ci_28                 2.897269e-03 3 1  ON 27
ci_29                 2.684329e-03 3 1  ON 28
ci_30                 6.147850e-04 3 1  ON 29
ci_31                 7.462385e-04 3 1  ON 30
ci_32                 1.615622e-04 3 1  ON 31
ci_33                -8.914469e-05 3 1  ON 32
ci_34                -3.358565e-04 3 1  ON 33
ci_35                -1.397638e-04 3 1  ON 34
ci_36                -2.467168e-04 3 1  ON 35
ci_37                -5.885958e-04 3 1  ON 36
ci_38                -9.840488e-05 3 1  ON 37
ci_39                -6.736430e-05 3 1  ON 38
ci_40                -1.223615e-03 3 1  ON 39
ci_41                 1.623250e-04 3 1  ON 40
ci_42                 2.815541e-04 3 1  ON 41
ci_43                -2.420359e-03 3 1  ON 42
ci_44                -2.353280e-03 3 1  ON 43
ci_45                -2.412568e-04 3 1  ON 44
ci_46                -1.727828e-04 3 1  ON 45
ci_47                -1.094246e-04 3 1  ON 46
ci_48                -3.550303e-06 3 1  ON 47
ci_49                -1.294015e-03 3 1  ON 48
ci_50                -5.334064e-04 3 1  ON 49
ci_51                 1.542676e-04 3 1  ON 50
ci_52                 2.147551e-06 3 1  ON 51
ci_53                -9.099070e-04 3 1  ON 52
ci_54                -7.556087e-04 3 1  ON 53
ci_55                -7.437243e-04 3 1  ON 54
ci_56                 1.500611e-03 3 1  ON 55
ci_57                 1.687393e-03 3 1  ON 56
ci_58                -1.083564e-03 3 1  ON 57
ci_59                -1.436494e-03 3 1  ON 58
ci_60                 6.749435e-04 3 1  ON 59
ci_61                 2.344044e-03 3 1  ON 60
ci_62                -2.877589e-04 3 1  ON 61
ci_63                -9.889639e-05 3 1  ON 62
ci_64                -2.236099e-04 3 1  ON 63
ci_65                -5.819306e-04 3 1  ON 64
ci_66                -5.295443e-04 3 1  ON 65
ci_67                -3.199831e-04 3 1  ON 66
ci_68                -1.925142e-03 3 1  ON 67
ci_69                -1.749893e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8097
    reference variance = 0.492332
====================================================
  Execution time = 9.8000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0084e-01
  Total weights = 7.8567e+06
  Execution time = 1.4517e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477767364
                                         uncertainty =       0.001226720783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477767364
                                         uncertainty =       0.001226720783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246088908
  error estimate for blocks of size 2^( 2) =       0.000255375563
  error estimate for blocks of size 2^( 3) =       0.000263700807
  error estimate for blocks of size 2^( 4) =       0.000269771689
  error estimate for blocks of size 2^( 5) =       0.000273080802
  error estimate for blocks of size 2^( 6) =       0.000274895855
  error estimate for blocks of size 2^( 7) =       0.000276389527
  error estimate for blocks of size 2^( 8) =       0.000276922312
  error estimate for blocks of size 2^( 9) =       0.000276632447

      target function =                  N/A
              le_mean =     -22.824886844648
             les_mean =     521.476302163574
             stat err =       0.000276210035
             autocorr =       1.259780347621
              std dev =       0.696044542004
             le_variance =       0.484478004453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477328702
                                         uncertainty =       0.001226620463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477328702
                                         uncertainty =       0.001226620463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246088796
  error estimate for blocks of size 2^( 2) =       0.000255375503
  error estimate for blocks of size 2^( 3) =       0.000263700803
  error estimate for blocks of size 2^( 4) =       0.000269771698
  error estimate for blocks of size 2^( 5) =       0.000273080832
  error estimate for blocks of size 2^( 6) =       0.000274895859
  error estimate for blocks of size 2^( 7) =       0.000276389527
  error estimate for blocks of size 2^( 8) =       0.000276922335
  error estimate for blocks of size 2^( 9) =       0.000276632365

      target function =                  N/A
              le_mean =     -22.824886823945
             les_mean =     521.476303730117
             stat err =       0.000276210021
             autocorr =       1.259781363943
              std dev =       0.696044226372
             le_variance =       0.484477565065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477545960
                                         uncertainty =       0.001226670392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477545960
                                         uncertainty =       0.001226670392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246088852
  error estimate for blocks of size 2^( 2) =       0.000255375533
  error estimate for blocks of size 2^( 3) =       0.000263700805
  error estimate for blocks of size 2^( 4) =       0.000269771693
  error estimate for blocks of size 2^( 5) =       0.000273080817
  error estimate for blocks of size 2^( 6) =       0.000274895857
  error estimate for blocks of size 2^( 7) =       0.000276389526
  error estimate for blocks of size 2^( 8) =       0.000276922323
  error estimate for blocks of size 2^( 9) =       0.000276632406

      target function =                  N/A
              le_mean =     -22.824886834031
             les_mean =     521.476300071482
             stat err =       0.000276210028
             autocorr =       1.259780856566
              std dev =       0.696044382698
             le_variance =       0.484477782685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477739529
                                         uncertainty =       0.001226714474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484477739529
                                         uncertainty =       0.001226714474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246088901
  error estimate for blocks of size 2^( 2) =       0.000255375559
  error estimate for blocks of size 2^( 3) =       0.000263700807
  error estimate for blocks of size 2^( 4) =       0.000269771690
  error estimate for blocks of size 2^( 5) =       0.000273080804
  error estimate for blocks of size 2^( 6) =       0.000274895855
  error estimate for blocks of size 2^( 7) =       0.000276389527
  error estimate for blocks of size 2^( 8) =       0.000276922313
  error estimate for blocks of size 2^( 9) =       0.000276632442

      target function =                  N/A
              le_mean =     -22.824886843316
             les_mean =     521.476301497691
             stat err =       0.000276210034
             autocorr =       1.259780411507
              std dev =       0.696044521977
             le_variance =       0.484477976574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824886844648        initial  <--
     3.9062e+01     3.9062e+02             5.3728e-06       -22.824886823945
     1.5625e+02     1.5625e+03             1.3473e-06       -22.824886834031
     6.2500e+02     6.2500e+03             3.3709e-07       -22.824886843316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.7425
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209102e-02 3 1  ON 1
ci_03                -2.240405e-02 3 1  ON 2
ci_04                 2.207453e-02 3 1  ON 3
ci_05                -2.139178e-02 3 1  ON 4
ci_06                -2.159309e-02 3 1  ON 5
ci_07                 2.519622e-02 3 1  ON 6
ci_08                -3.659668e-03 3 1  ON 7
ci_09                -1.101576e-02 3 1  ON 8
ci_10                -1.110934e-02 3 1  ON 9
ci_11                 1.639612e-02 3 1  ON 10
ci_12                 1.085401e-02 3 1  ON 11
ci_13                 1.182708e-02 3 1  ON 12
ci_14                 1.710831e-02 3 1  ON 13
ci_15                 7.410736e-03 3 1  ON 14
ci_16                 7.721559e-03 3 1  ON 15
ci_17                -8.944877e-03 3 1  ON 16
ci_18                -9.032082e-03 3 1  ON 17
ci_19                 9.505882e-03 3 1  ON 18
ci_20                 1.048828e-02 3 1  ON 19
ci_21                 8.348808e-03 3 1  ON 20
ci_22                 8.412704e-03 3 1  ON 21
ci_23                 6.596045e-03 3 1  ON 22
ci_24                 7.701759e-03 3 1  ON 23
ci_25                 5.050263e-03 3 1  ON 24
ci_26                 2.517288e-03 3 1  ON 25
ci_27                 2.841743e-03 3 1  ON 26
ci_28                 2.896557e-03 3 1  ON 27
ci_29                 2.684468e-03 3 1  ON 28
ci_30                 6.143495e-04 3 1  ON 29
ci_31                 7.463565e-04 3 1  ON 30
ci_32                 1.619184e-04 3 1  ON 31
ci_33                -8.923445e-05 3 1  ON 32
ci_34                -3.353105e-04 3 1  ON 33
ci_35                -1.403783e-04 3 1  ON 34
ci_36                -2.465863e-04 3 1  ON 35
ci_37                -5.885959e-04 3 1  ON 36
ci_38                -9.813256e-05 3 1  ON 37
ci_39                -6.729537e-05 3 1  ON 38
ci_40                -1.222688e-03 3 1  ON 39
ci_41                 1.627356e-04 3 1  ON 40
ci_42                 2.821074e-04 3 1  ON 41
ci_43                -2.420344e-03 3 1  ON 42
ci_44                -2.352562e-03 3 1  ON 43
ci_45                -2.417895e-04 3 1  ON 44
ci_46                -1.727413e-04 3 1  ON 45
ci_47                -1.097459e-04 3 1  ON 46
ci_48                -3.462119e-06 3 1  ON 47
ci_49                -1.294447e-03 3 1  ON 48
ci_50                -5.335821e-04 3 1  ON 49
ci_51                 1.542614e-04 3 1  ON 50
ci_52                 2.568843e-06 3 1  ON 51
ci_53                -9.100447e-04 3 1  ON 52
ci_54                -7.556153e-04 3 1  ON 53
ci_55                -7.438985e-04 3 1  ON 54
ci_56                 1.500502e-03 3 1  ON 55
ci_57                 1.687060e-03 3 1  ON 56
ci_58                -1.083490e-03 3 1  ON 57
ci_59                -1.437163e-03 3 1  ON 58
ci_60                 6.740640e-04 3 1  ON 59
ci_61                 2.343305e-03 3 1  ON 60
ci_62                -2.874541e-04 3 1  ON 61
ci_63                -9.850728e-05 3 1  ON 62
ci_64                -2.248568e-04 3 1  ON 63
ci_65                -5.825896e-04 3 1  ON 64
ci_66                -5.300557e-04 3 1  ON 65
ci_67                -3.207452e-04 3 1  ON 66
ci_68                -1.925061e-03 3 1  ON 67
ci_69                -1.750409e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8689e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2849e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8191
    reference variance = 0.505346
====================================================
  Execution time = 9.8250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1386e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9955e-01
  Total weights = 7.856515095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8158e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483408251873
                                         uncertainty =       0.002164995895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483408251873
                                         uncertainty =       0.002164995895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245816842
  error estimate for blocks of size 2^( 2) =       0.000255022739
  error estimate for blocks of size 2^( 3) =       0.000263433700
  error estimate for blocks of size 2^( 4) =       0.000269530571
  error estimate for blocks of size 2^( 5) =       0.000273022860
  error estimate for blocks of size 2^( 6) =       0.000275559689
  error estimate for blocks of size 2^( 7) =       0.000276464977
  error estimate for blocks of size 2^( 8) =       0.000276235579
  error estimate for blocks of size 2^( 9) =       0.000276229480

      target function =                  N/A
              le_mean =     -22.824108259634
             les_mean =     521.439469591058
             stat err =       0.000276122431
             autocorr =       1.261769739465
              std dev =       0.695275023418
             le_variance =       0.483407358188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282410825963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824108259628       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824108264331       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824108264457       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 4.440215e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824108259628       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824108260804       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824108260836       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.110428e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824108259628       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824108259922       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824108259930       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.776303e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1642e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240402e-02 3 1  ON 2
ci_04                 2.207450e-02 3 1  ON 3
ci_05                -2.139178e-02 3 1  ON 4
ci_06                -2.159304e-02 3 1  ON 5
ci_07                 2.519629e-02 3 1  ON 6
ci_08                -3.659612e-03 3 1  ON 7
ci_09                -1.101569e-02 3 1  ON 8
ci_10                -1.110935e-02 3 1  ON 9
ci_11                 1.639608e-02 3 1  ON 10
ci_12                 1.085401e-02 3 1  ON 11
ci_13                 1.182717e-02 3 1  ON 12
ci_14                 1.710833e-02 3 1  ON 13
ci_15                 7.410794e-03 3 1  ON 14
ci_16                 7.721565e-03 3 1  ON 15
ci_17                -8.944897e-03 3 1  ON 16
ci_18                -9.032036e-03 3 1  ON 17
ci_19                 9.505956e-03 3 1  ON 18
ci_20                 1.048835e-02 3 1  ON 19
ci_21                 8.348828e-03 3 1  ON 20
ci_22                 8.412634e-03 3 1  ON 21
ci_23                 6.595999e-03 3 1  ON 22
ci_24                 7.701739e-03 3 1  ON 23
ci_25                 5.050351e-03 3 1  ON 24
ci_26                 2.517291e-03 3 1  ON 25
ci_27                 2.841855e-03 3 1  ON 26
ci_28                 2.896568e-03 3 1  ON 27
ci_29                 2.684526e-03 3 1  ON 28
ci_30                 6.143803e-04 3 1  ON 29
ci_31                 7.463706e-04 3 1  ON 30
ci_32                 1.619786e-04 3 1  ON 31
ci_33                -8.915267e-05 3 1  ON 32
ci_34                -3.352506e-04 3 1  ON 33
ci_35                -1.403843e-04 3 1  ON 34
ci_36                -2.466699e-04 3 1  ON 35
ci_37                -5.885464e-04 3 1  ON 36
ci_38                -9.814573e-05 3 1  ON 37
ci_39                -6.731107e-05 3 1  ON 38
ci_40                -1.222655e-03 3 1  ON 39
ci_41                 1.627118e-04 3 1  ON 40
ci_42                 2.820131e-04 3 1  ON 41
ci_43                -2.420302e-03 3 1  ON 42
ci_44                -2.352629e-03 3 1  ON 43
ci_45                -2.418060e-04 3 1  ON 44
ci_46                -1.727454e-04 3 1  ON 45
ci_47                -1.097252e-04 3 1  ON 46
ci_48                -3.399256e-06 3 1  ON 47
ci_49                -1.294470e-03 3 1  ON 48
ci_50                -5.335572e-04 3 1  ON 49
ci_51                 1.542286e-04 3 1  ON 50
ci_52                 2.558800e-06 3 1  ON 51
ci_53                -9.099652e-04 3 1  ON 52
ci_54                -7.556549e-04 3 1  ON 53
ci_55                -7.439584e-04 3 1  ON 54
ci_56                 1.500553e-03 3 1  ON 55
ci_57                 1.686979e-03 3 1  ON 56
ci_58                -1.083494e-03 3 1  ON 57
ci_59                -1.437151e-03 3 1  ON 58
ci_60                 6.741285e-04 3 1  ON 59
ci_61                 2.343219e-03 3 1  ON 60
ci_62                -2.875075e-04 3 1  ON 61
ci_63                -9.849993e-05 3 1  ON 62
ci_64                -2.248662e-04 3 1  ON 63
ci_65                -5.826094e-04 3 1  ON 64
ci_66                -5.299760e-04 3 1  ON 65
ci_67                -3.207008e-04 3 1  ON 66
ci_68                -1.924989e-03 3 1  ON 67
ci_69                -1.750372e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7598
    reference variance = 0.436359
====================================================
  Execution time = 9.7581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0513e-01
  Total weights = 7.8558e+06
  Execution time = 1.4095e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194185915
                                         uncertainty =       0.001487882819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194185915
                                         uncertainty =       0.001487882819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246777822
  error estimate for blocks of size 2^( 2) =       0.000256016297
  error estimate for blocks of size 2^( 3) =       0.000264340866
  error estimate for blocks of size 2^( 4) =       0.000270094024
  error estimate for blocks of size 2^( 5) =       0.000274014795
  error estimate for blocks of size 2^( 6) =       0.000276160318
  error estimate for blocks of size 2^( 7) =       0.000276365055
  error estimate for blocks of size 2^( 8) =       0.000277064432
  error estimate for blocks of size 2^( 9) =       0.000278545454

      target function =                  N/A
              le_mean =     -22.824447553366
             les_mean =     521.460537519790
             stat err =       0.000277033815
             autocorr =       1.260240147362
              std dev =       0.697993085626
             le_variance =       0.487194347582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194074744
                                         uncertainty =       0.001487880368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194074744
                                         uncertainty =       0.001487880368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246777794
  error estimate for blocks of size 2^( 2) =       0.000256016272
  error estimate for blocks of size 2^( 3) =       0.000264340843
  error estimate for blocks of size 2^( 4) =       0.000270094001
  error estimate for blocks of size 2^( 5) =       0.000274014776
  error estimate for blocks of size 2^( 6) =       0.000276160304
  error estimate for blocks of size 2^( 7) =       0.000276365053
  error estimate for blocks of size 2^( 8) =       0.000277064429
  error estimate for blocks of size 2^( 9) =       0.000278545439

      target function =                  N/A
              le_mean =     -22.824447549631
             les_mean =     521.460537154532
             stat err =       0.000277033806
             autocorr =       1.260240356369
              std dev =       0.697993005998
             le_variance =       0.487194236423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194130298
                                         uncertainty =       0.001487881593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194130298
                                         uncertainty =       0.001487881593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246777808
  error estimate for blocks of size 2^( 2) =       0.000256016284
  error estimate for blocks of size 2^( 3) =       0.000264340854
  error estimate for blocks of size 2^( 4) =       0.000270094012
  error estimate for blocks of size 2^( 5) =       0.000274014785
  error estimate for blocks of size 2^( 6) =       0.000276160311
  error estimate for blocks of size 2^( 7) =       0.000276365054
  error estimate for blocks of size 2^( 8) =       0.000277064430
  error estimate for blocks of size 2^( 9) =       0.000278545446

      target function =                  N/A
              le_mean =     -22.824447551496
             les_mean =     521.460537331364
             stat err =       0.000277033810
             autocorr =       1.260240251916
              std dev =       0.697993045790
             le_variance =       0.487194291972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194178961
                                         uncertainty =       0.001487882666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487194178961
                                         uncertainty =       0.001487882666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246777820
  error estimate for blocks of size 2^( 2) =       0.000256016296
  error estimate for blocks of size 2^( 3) =       0.000264340864
  error estimate for blocks of size 2^( 4) =       0.000270094022
  error estimate for blocks of size 2^( 5) =       0.000274014794
  error estimate for blocks of size 2^( 6) =       0.000276160317
  error estimate for blocks of size 2^( 7) =       0.000276365055
  error estimate for blocks of size 2^( 8) =       0.000277064432
  error estimate for blocks of size 2^( 9) =       0.000278545453

      target function =                  N/A
              le_mean =     -22.824447553132
             les_mean =     521.460537495596
             stat err =       0.000277033814
             autocorr =       1.260240160402
              std dev =       0.697993080645
             le_variance =       0.487194340628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824447553366        initial  <--
     3.9062e+02     3.9062e+03             4.4402e-07       -22.824447549631
     1.5625e+03     1.5625e+04             1.1104e-07       -22.824447551496
     6.2500e+03     6.2500e+04             2.7763e-08       -22.824447553132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.8540
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209102e-02 3 1  ON 1
ci_03                -2.240405e-02 3 1  ON 2
ci_04                 2.207453e-02 3 1  ON 3
ci_05                -2.139178e-02 3 1  ON 4
ci_06                -2.159309e-02 3 1  ON 5
ci_07                 2.519622e-02 3 1  ON 6
ci_08                -3.659668e-03 3 1  ON 7
ci_09                -1.101576e-02 3 1  ON 8
ci_10                -1.110934e-02 3 1  ON 9
ci_11                 1.639612e-02 3 1  ON 10
ci_12                 1.085401e-02 3 1  ON 11
ci_13                 1.182708e-02 3 1  ON 12
ci_14                 1.710831e-02 3 1  ON 13
ci_15                 7.410736e-03 3 1  ON 14
ci_16                 7.721559e-03 3 1  ON 15
ci_17                -8.944877e-03 3 1  ON 16
ci_18                -9.032082e-03 3 1  ON 17
ci_19                 9.505882e-03 3 1  ON 18
ci_20                 1.048828e-02 3 1  ON 19
ci_21                 8.348808e-03 3 1  ON 20
ci_22                 8.412704e-03 3 1  ON 21
ci_23                 6.596045e-03 3 1  ON 22
ci_24                 7.701759e-03 3 1  ON 23
ci_25                 5.050263e-03 3 1  ON 24
ci_26                 2.517288e-03 3 1  ON 25
ci_27                 2.841743e-03 3 1  ON 26
ci_28                 2.896557e-03 3 1  ON 27
ci_29                 2.684468e-03 3 1  ON 28
ci_30                 6.143495e-04 3 1  ON 29
ci_31                 7.463565e-04 3 1  ON 30
ci_32                 1.619184e-04 3 1  ON 31
ci_33                -8.923445e-05 3 1  ON 32
ci_34                -3.353105e-04 3 1  ON 33
ci_35                -1.403783e-04 3 1  ON 34
ci_36                -2.465863e-04 3 1  ON 35
ci_37                -5.885959e-04 3 1  ON 36
ci_38                -9.813256e-05 3 1  ON 37
ci_39                -6.729537e-05 3 1  ON 38
ci_40                -1.222688e-03 3 1  ON 39
ci_41                 1.627356e-04 3 1  ON 40
ci_42                 2.821074e-04 3 1  ON 41
ci_43                -2.420344e-03 3 1  ON 42
ci_44                -2.352562e-03 3 1  ON 43
ci_45                -2.417895e-04 3 1  ON 44
ci_46                -1.727413e-04 3 1  ON 45
ci_47                -1.097459e-04 3 1  ON 46
ci_48                -3.462119e-06 3 1  ON 47
ci_49                -1.294447e-03 3 1  ON 48
ci_50                -5.335821e-04 3 1  ON 49
ci_51                 1.542614e-04 3 1  ON 50
ci_52                 2.568843e-06 3 1  ON 51
ci_53                -9.100447e-04 3 1  ON 52
ci_54                -7.556153e-04 3 1  ON 53
ci_55                -7.438985e-04 3 1  ON 54
ci_56                 1.500502e-03 3 1  ON 55
ci_57                 1.687060e-03 3 1  ON 56
ci_58                -1.083490e-03 3 1  ON 57
ci_59                -1.437163e-03 3 1  ON 58
ci_60                 6.740640e-04 3 1  ON 59
ci_61                 2.343305e-03 3 1  ON 60
ci_62                -2.874541e-04 3 1  ON 61
ci_63                -9.850728e-05 3 1  ON 62
ci_64                -2.248568e-04 3 1  ON 63
ci_65                -5.825896e-04 3 1  ON 64
ci_66                -5.300557e-04 3 1  ON 65
ci_67                -3.207452e-04 3 1  ON 66
ci_68                -1.925061e-03 3 1  ON 67
ci_69                -1.750409e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8628e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2845e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.775
    reference variance = 0.423585
====================================================
  Execution time = 9.8457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1413e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0059e-01
  Total weights = 7.856524129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8148e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485130625176
                                         uncertainty =       0.001464194085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485130625176
                                         uncertainty =       0.001464194085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246255124
  error estimate for blocks of size 2^( 2) =       0.000255447317
  error estimate for blocks of size 2^( 3) =       0.000263675115
  error estimate for blocks of size 2^( 4) =       0.000269700186
  error estimate for blocks of size 2^( 5) =       0.000273304534
  error estimate for blocks of size 2^( 6) =       0.000274994185
  error estimate for blocks of size 2^( 7) =       0.000275565194
  error estimate for blocks of size 2^( 8) =       0.000276645290
  error estimate for blocks of size 2^( 9) =       0.000277677647

      target function =                  N/A
              le_mean =     -22.824522676587
             les_mean =     521.459422726497
             stat err =       0.000276220579
             autocorr =       1.258176331926
              std dev =       0.696514671675
             le_variance =       0.485132687859


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282452267659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824522676583       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824522676625       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824522676633       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824522676640       residual = 4.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 7.341431e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824522676583       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824522676593       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824522676596       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824522676596       residual = 4.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.835468e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824522676583       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824522676586       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824522676586       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824522676586       residual = 4.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 4.588740e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1662e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209103e-02 3 1  ON 1
ci_03                -2.240405e-02 3 1  ON 2
ci_04                 2.207454e-02 3 1  ON 3
ci_05                -2.139179e-02 3 1  ON 4
ci_06                -2.159309e-02 3 1  ON 5
ci_07                 2.519622e-02 3 1  ON 6
ci_08                -3.659667e-03 3 1  ON 7
ci_09                -1.101575e-02 3 1  ON 8
ci_10                -1.110933e-02 3 1  ON 9
ci_11                 1.639613e-02 3 1  ON 10
ci_12                 1.085402e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710830e-02 3 1  ON 13
ci_15                 7.410734e-03 3 1  ON 14
ci_16                 7.721553e-03 3 1  ON 15
ci_17                -8.944876e-03 3 1  ON 16
ci_18                -9.032081e-03 3 1  ON 17
ci_19                 9.505880e-03 3 1  ON 18
ci_20                 1.048829e-02 3 1  ON 19
ci_21                 8.348803e-03 3 1  ON 20
ci_22                 8.412696e-03 3 1  ON 21
ci_23                 6.596035e-03 3 1  ON 22
ci_24                 7.701762e-03 3 1  ON 23
ci_25                 5.050264e-03 3 1  ON 24
ci_26                 2.517283e-03 3 1  ON 25
ci_27                 2.841742e-03 3 1  ON 26
ci_28                 2.896560e-03 3 1  ON 27
ci_29                 2.684474e-03 3 1  ON 28
ci_30                 6.143516e-04 3 1  ON 29
ci_31                 7.463540e-04 3 1  ON 30
ci_32                 1.619102e-04 3 1  ON 31
ci_33                -8.923277e-05 3 1  ON 32
ci_34                -3.353151e-04 3 1  ON 33
ci_35                -1.403816e-04 3 1  ON 34
ci_36                -2.465846e-04 3 1  ON 35
ci_37                -5.885931e-04 3 1  ON 36
ci_38                -9.812786e-05 3 1  ON 37
ci_39                -6.729261e-05 3 1  ON 38
ci_40                -1.222696e-03 3 1  ON 39
ci_41                 1.627351e-04 3 1  ON 40
ci_42                 2.821009e-04 3 1  ON 41
ci_43                -2.420340e-03 3 1  ON 42
ci_44                -2.352558e-03 3 1  ON 43
ci_45                -2.417916e-04 3 1  ON 44
ci_46                -1.727401e-04 3 1  ON 45
ci_47                -1.097354e-04 3 1  ON 46
ci_48                -3.463426e-06 3 1  ON 47
ci_49                -1.294442e-03 3 1  ON 48
ci_50                -5.335863e-04 3 1  ON 49
ci_51                 1.542548e-04 3 1  ON 50
ci_52                 2.572439e-06 3 1  ON 51
ci_53                -9.100543e-04 3 1  ON 52
ci_54                -7.556157e-04 3 1  ON 53
ci_55                -7.439016e-04 3 1  ON 54
ci_56                 1.500499e-03 3 1  ON 55
ci_57                 1.687066e-03 3 1  ON 56
ci_58                -1.083489e-03 3 1  ON 57
ci_59                -1.437159e-03 3 1  ON 58
ci_60                 6.740629e-04 3 1  ON 59
ci_61                 2.343303e-03 3 1  ON 60
ci_62                -2.874358e-04 3 1  ON 61
ci_63                -9.851643e-05 3 1  ON 62
ci_64                -2.248540e-04 3 1  ON 63
ci_65                -5.825872e-04 3 1  ON 64
ci_66                -5.300583e-04 3 1  ON 65
ci_67                -3.207420e-04 3 1  ON 66
ci_68                -1.925054e-03 3 1  ON 67
ci_69                -1.750398e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8842
    reference variance = 0.626818
====================================================
  Execution time = 9.8456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9951e-01
  Total weights = 7.8567e+06
  Execution time = 1.4107e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876479248
                                         uncertainty =       0.001486514173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876479248
                                         uncertainty =       0.001486514173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245935910
  error estimate for blocks of size 2^( 2) =       0.000255134334
  error estimate for blocks of size 2^( 3) =       0.000263471262
  error estimate for blocks of size 2^( 4) =       0.000269250184
  error estimate for blocks of size 2^( 5) =       0.000272682237
  error estimate for blocks of size 2^( 6) =       0.000274255144
  error estimate for blocks of size 2^( 7) =       0.000275515300
  error estimate for blocks of size 2^( 8) =       0.000276485826
  error estimate for blocks of size 2^( 9) =       0.000276700141

      target function =                  N/A
              le_mean =     -22.824916619337
             les_mean =     521.476331031494
             stat err =       0.000275739103
             autocorr =       1.257050780014
              std dev =       0.695611799788
             le_variance =       0.483875776004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876475450
                                         uncertainty =       0.001486515406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876475450
                                         uncertainty =       0.001486515406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245935909
  error estimate for blocks of size 2^( 2) =       0.000255134333
  error estimate for blocks of size 2^( 3) =       0.000263471261
  error estimate for blocks of size 2^( 4) =       0.000269250183
  error estimate for blocks of size 2^( 5) =       0.000272682236
  error estimate for blocks of size 2^( 6) =       0.000274255143
  error estimate for blocks of size 2^( 7) =       0.000275515299
  error estimate for blocks of size 2^( 8) =       0.000276485825
  error estimate for blocks of size 2^( 9) =       0.000276700142

      target function =                  N/A
              le_mean =     -22.824916619339
             les_mean =     521.476330993715
             stat err =       0.000275739102
             autocorr =       1.257050787192
              std dev =       0.695611797059
             le_variance =       0.483875772208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876477349
                                         uncertainty =       0.001486514789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876477349
                                         uncertainty =       0.001486514789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245935910
  error estimate for blocks of size 2^( 2) =       0.000255134334
  error estimate for blocks of size 2^( 3) =       0.000263471261
  error estimate for blocks of size 2^( 4) =       0.000269250183
  error estimate for blocks of size 2^( 5) =       0.000272682236
  error estimate for blocks of size 2^( 6) =       0.000274255144
  error estimate for blocks of size 2^( 7) =       0.000275515300
  error estimate for blocks of size 2^( 8) =       0.000276485825
  error estimate for blocks of size 2^( 9) =       0.000276700141

      target function =                  N/A
              le_mean =     -22.824916619338
             les_mean =     521.476331012515
             stat err =       0.000275739102
             autocorr =       1.257050783634
              std dev =       0.695611798423
             le_variance =       0.483875774106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876479011
                                         uncertainty =       0.001486514250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483876479011
                                         uncertainty =       0.001486514250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245935910
  error estimate for blocks of size 2^( 2) =       0.000255134334
  error estimate for blocks of size 2^( 3) =       0.000263471262
  error estimate for blocks of size 2^( 4) =       0.000269250184
  error estimate for blocks of size 2^( 5) =       0.000272682237
  error estimate for blocks of size 2^( 6) =       0.000274255144
  error estimate for blocks of size 2^( 7) =       0.000275515300
  error estimate for blocks of size 2^( 8) =       0.000276485826
  error estimate for blocks of size 2^( 9) =       0.000276700141

      target function =                  N/A
              le_mean =     -22.824916619337
             les_mean =     521.476331029112
             stat err =       0.000275739103
             autocorr =       1.257050780432
              std dev =       0.695611799617
             le_variance =       0.483875775766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824916619337        initial
     3.9062e+03     3.9062e+04             7.3414e-08       -22.824916619339  <--
     1.5625e+04     1.5625e+05             1.8355e-08       -22.824916619338
     6.2500e+04     6.2500e+05             4.5887e-09       -22.824916619337

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 1.6997e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854387e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8659e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2844e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8077
    reference variance = 0.287188
====================================================
  Execution time = 9.8521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1367e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9837e-01
  Total weights = 7.856591506e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8060e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483144843838
                                         uncertainty =       0.001279000805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483144843838
                                         uncertainty =       0.001279000805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245750615
  error estimate for blocks of size 2^( 2) =       0.000254927802
  error estimate for blocks of size 2^( 3) =       0.000263290685
  error estimate for blocks of size 2^( 4) =       0.000268990744
  error estimate for blocks of size 2^( 5) =       0.000272916049
  error estimate for blocks of size 2^( 6) =       0.000274744776
  error estimate for blocks of size 2^( 7) =       0.000276175107
  error estimate for blocks of size 2^( 8) =       0.000276421709
  error estimate for blocks of size 2^( 9) =       0.000277309364

      target function =                  N/A
              le_mean =     -22.824553601455
             les_mean =     521.458612141678
             stat err =       0.000276162739
             autocorr =       1.262818497762
              std dev =       0.695087706219
             le_variance =       0.483146919337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282455360145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824553601453       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824553602836       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824553602769       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824553602752       residual = 5.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 2.154144e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824553601453       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824553601799       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824553601782       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824553601778       residual = 5.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 5.386555e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824553601453       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824553601539       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824553601535       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824553601534       residual = 5.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.346713e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1659e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240399e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159308e-02 3 1  ON 5
ci_07                 2.519628e-02 3 1  ON 6
ci_08                -3.659660e-03 3 1  ON 7
ci_09                -1.101572e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639614e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182710e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410748e-03 3 1  ON 14
ci_16                 7.721519e-03 3 1  ON 15
ci_17                -8.944890e-03 3 1  ON 16
ci_18                -9.032068e-03 3 1  ON 17
ci_19                 9.505916e-03 3 1  ON 18
ci_20                 1.048834e-02 3 1  ON 19
ci_21                 8.348795e-03 3 1  ON 20
ci_22                 8.412672e-03 3 1  ON 21
ci_23                 6.595950e-03 3 1  ON 22
ci_24                 7.701739e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517251e-03 3 1  ON 25
ci_27                 2.841721e-03 3 1  ON 26
ci_28                 2.896598e-03 3 1  ON 27
ci_29                 2.684493e-03 3 1  ON 28
ci_30                 6.143502e-04 3 1  ON 29
ci_31                 7.463507e-04 3 1  ON 30
ci_32                 1.618771e-04 3 1  ON 31
ci_33                -8.920893e-05 3 1  ON 32
ci_34                -3.353215e-04 3 1  ON 33
ci_35                -1.404138e-04 3 1  ON 34
ci_36                -2.466334e-04 3 1  ON 35
ci_37                -5.885974e-04 3 1  ON 36
ci_38                -9.814704e-05 3 1  ON 37
ci_39                -6.729166e-05 3 1  ON 38
ci_40                -1.222723e-03 3 1  ON 39
ci_41                 1.626981e-04 3 1  ON 40
ci_42                 2.820633e-04 3 1  ON 41
ci_43                -2.420315e-03 3 1  ON 42
ci_44                -2.352564e-03 3 1  ON 43
ci_45                -2.418096e-04 3 1  ON 44
ci_46                -1.727276e-04 3 1  ON 45
ci_47                -1.096931e-04 3 1  ON 46
ci_48                -3.470867e-06 3 1  ON 47
ci_49                -1.294451e-03 3 1  ON 48
ci_50                -5.335831e-04 3 1  ON 49
ci_51                 1.542289e-04 3 1  ON 50
ci_52                 2.595539e-06 3 1  ON 51
ci_53                -9.100742e-04 3 1  ON 52
ci_54                -7.556432e-04 3 1  ON 53
ci_55                -7.439128e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687119e-03 3 1  ON 56
ci_58                -1.083498e-03 3 1  ON 57
ci_59                -1.437132e-03 3 1  ON 58
ci_60                 6.740876e-04 3 1  ON 59
ci_61                 2.343289e-03 3 1  ON 60
ci_62                -2.873644e-04 3 1  ON 61
ci_63                -9.853552e-05 3 1  ON 62
ci_64                -2.248462e-04 3 1  ON 63
ci_65                -5.825713e-04 3 1  ON 64
ci_66                -5.300703e-04 3 1  ON 65
ci_67                -3.207199e-04 3 1  ON 66
ci_68                -1.925019e-03 3 1  ON 67
ci_69                -1.750363e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7982
    reference variance = 0.283283
====================================================
  Execution time = 9.8178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9955e-01
  Total weights = 7.8567e+06
  Execution time = 1.4113e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567464991
                                         uncertainty =       0.001232704444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567464991
                                         uncertainty =       0.001232704444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245857304
  error estimate for blocks of size 2^( 2) =       0.000254992837
  error estimate for blocks of size 2^( 3) =       0.000263318384
  error estimate for blocks of size 2^( 4) =       0.000269184444
  error estimate for blocks of size 2^( 5) =       0.000272631795
  error estimate for blocks of size 2^( 6) =       0.000274724728
  error estimate for blocks of size 2^( 7) =       0.000275618649
  error estimate for blocks of size 2^( 8) =       0.000276230146
  error estimate for blocks of size 2^( 9) =       0.000277520043

      target function =                  N/A
              le_mean =     -22.824408350830
             les_mean =     521.453164584618
             stat err =       0.000276023392
             autocorr =       1.260449775947
              std dev =       0.695389468174
             le_variance =       0.483566512447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567465831
                                         uncertainty =       0.001232704933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567465831
                                         uncertainty =       0.001232704933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245857304
  error estimate for blocks of size 2^( 2) =       0.000254992838
  error estimate for blocks of size 2^( 3) =       0.000263318386
  error estimate for blocks of size 2^( 4) =       0.000269184446
  error estimate for blocks of size 2^( 5) =       0.000272631799
  error estimate for blocks of size 2^( 6) =       0.000274724732
  error estimate for blocks of size 2^( 7) =       0.000275618654
  error estimate for blocks of size 2^( 8) =       0.000276230152
  error estimate for blocks of size 2^( 9) =       0.000277520050

      target function =                  N/A
              le_mean =     -22.824408349851
             les_mean =     521.453164734154
             stat err =       0.000276023397
             autocorr =       1.260449824642
              std dev =       0.695389468770
             le_variance =       0.483566513276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567465408
                                         uncertainty =       0.001232704689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567465408
                                         uncertainty =       0.001232704689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245857304
  error estimate for blocks of size 2^( 2) =       0.000254992837
  error estimate for blocks of size 2^( 3) =       0.000263318385
  error estimate for blocks of size 2^( 4) =       0.000269184445
  error estimate for blocks of size 2^( 5) =       0.000272631797
  error estimate for blocks of size 2^( 6) =       0.000274724730
  error estimate for blocks of size 2^( 7) =       0.000275618651
  error estimate for blocks of size 2^( 8) =       0.000276230149
  error estimate for blocks of size 2^( 9) =       0.000277520047

      target function =                  N/A
              le_mean =     -22.824408350341
             les_mean =     521.453164658855
             stat err =       0.000276023395
             autocorr =       1.260449800295
              std dev =       0.695389468469
             le_variance =       0.483566512858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567465042
                                         uncertainty =       0.001232704475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483567465042
                                         uncertainty =       0.001232704475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245857304
  error estimate for blocks of size 2^( 2) =       0.000254992837
  error estimate for blocks of size 2^( 3) =       0.000263318385
  error estimate for blocks of size 2^( 4) =       0.000269184444
  error estimate for blocks of size 2^( 5) =       0.000272631796
  error estimate for blocks of size 2^( 6) =       0.000274724729
  error estimate for blocks of size 2^( 7) =       0.000275618649
  error estimate for blocks of size 2^( 8) =       0.000276230147
  error estimate for blocks of size 2^( 9) =       0.000277520044

      target function =                  N/A
              le_mean =     -22.824408350769
             les_mean =     521.453164593838
             stat err =       0.000276023392
             autocorr =       1.260449778965
              std dev =       0.695389468210
             le_variance =       0.483566512497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824408350830        initial  <--
     9.7656e+02     9.7656e+03             2.1541e-07       -22.824408349851
     3.9062e+03     3.9062e+04             5.3866e-08       -22.824408350341
     1.5625e+04     1.5625e+05             1.3467e-08       -22.824408350769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.3620
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854387e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8596e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 0.880497
====================================================
  Execution time = 1.0075e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1341e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0531e-01
  Total weights = 7.856494929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8181e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488788518279
                                         uncertainty =       0.002255829019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488788518279
                                         uncertainty =       0.002255829019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247181543
  error estimate for blocks of size 2^( 2) =       0.000256417005
  error estimate for blocks of size 2^( 3) =       0.000264486523
  error estimate for blocks of size 2^( 4) =       0.000270139848
  error estimate for blocks of size 2^( 5) =       0.000273525884
  error estimate for blocks of size 2^( 6) =       0.000274723894
  error estimate for blocks of size 2^( 7) =       0.000276393548
  error estimate for blocks of size 2^( 8) =       0.000276936952
  error estimate for blocks of size 2^( 9) =       0.000279187595

      target function =                  N/A
              le_mean =     -22.824841071069
             les_mean =     521.478676460886
             stat err =       0.000276810497
             autocorr =       1.254102504169
              std dev =       0.699134979980
             le_variance =       0.488789720232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282484107107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824841071067       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824841071171       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824841071171       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824841071171       residual = 9.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 3.248593e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824841071067       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824841071093       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824841071093       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824841071093       residual = 9.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 8.121644e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824841071067       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824841071073       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824841071073       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824841071073       residual = 9.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 2.030421e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1895e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519624e-02 3 1  ON 6
ci_08                -3.659668e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410731e-03 3 1  ON 14
ci_16                 7.721531e-03 3 1  ON 15
ci_17                -8.944874e-03 3 1  ON 16
ci_18                -9.032077e-03 3 1  ON 17
ci_19                 9.505878e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412672e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701767e-03 3 1  ON 23
ci_25                 5.050266e-03 3 1  ON 24
ci_26                 2.517272e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896571e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143614e-04 3 1  ON 29
ci_31                 7.463460e-04 3 1  ON 30
ci_32                 1.618842e-04 3 1  ON 31
ci_33                -8.922645e-05 3 1  ON 32
ci_34                -3.353280e-04 3 1  ON 33
ci_35                -1.403920e-04 3 1  ON 34
ci_36                -2.465840e-04 3 1  ON 35
ci_37                -5.885832e-04 3 1  ON 36
ci_38                -9.811394e-05 3 1  ON 37
ci_39                -6.728249e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627306e-04 3 1  ON 40
ci_42                 2.820816e-04 3 1  ON 41
ci_43                -2.420332e-03 3 1  ON 42
ci_44                -2.352548e-03 3 1  ON 43
ci_45                -2.417956e-04 3 1  ON 44
ci_46                -1.727348e-04 3 1  ON 45
ci_47                -1.097021e-04 3 1  ON 46
ci_48                -3.467160e-06 3 1  ON 47
ci_49                -1.294428e-03 3 1  ON 48
ci_50                -5.335993e-04 3 1  ON 49
ci_51                 1.542313e-04 3 1  ON 50
ci_52                 2.582842e-06 3 1  ON 51
ci_53                -9.100828e-04 3 1  ON 52
ci_54                -7.556194e-04 3 1  ON 53
ci_55                -7.439114e-04 3 1  ON 54
ci_56                 1.500484e-03 3 1  ON 55
ci_57                 1.687086e-03 3 1  ON 56
ci_58                -1.083485e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740623e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873827e-04 3 1  ON 61
ci_63                -9.854550e-05 3 1  ON 62
ci_64                -2.248461e-04 3 1  ON 63
ci_65                -5.825784e-04 3 1  ON 64
ci_66                -5.300640e-04 3 1  ON 65
ci_67                -3.207349e-04 3 1  ON 66
ci_68                -1.925031e-03 3 1  ON 67
ci_69                -1.750364e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7841
    reference variance = 0.42944
====================================================
  Execution time = 9.7866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0070e-01
  Total weights = 7.8564e+06
  Execution time = 1.4091e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238049
                                         uncertainty =       0.001579340177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238049
                                         uncertainty =       0.001579340177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246104735
  error estimate for blocks of size 2^( 2) =       0.000255319852
  error estimate for blocks of size 2^( 3) =       0.000263649849
  error estimate for blocks of size 2^( 4) =       0.000269761662
  error estimate for blocks of size 2^( 5) =       0.000273348258
  error estimate for blocks of size 2^( 6) =       0.000275298442
  error estimate for blocks of size 2^( 7) =       0.000277017717
  error estimate for blocks of size 2^( 8) =       0.000277040360
  error estimate for blocks of size 2^( 9) =       0.000276967668

      target function =                  N/A
              le_mean =     -22.824347460796
             les_mean =     521.451535785272
             stat err =       0.000276581047
             autocorr =       1.263004485704
              std dev =       0.696089307495
             le_variance =       0.484540324009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238086
                                         uncertainty =       0.001579340739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238086
                                         uncertainty =       0.001579340739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246104735
  error estimate for blocks of size 2^( 2) =       0.000255319852
  error estimate for blocks of size 2^( 3) =       0.000263649850
  error estimate for blocks of size 2^( 4) =       0.000269761663
  error estimate for blocks of size 2^( 5) =       0.000273348258
  error estimate for blocks of size 2^( 6) =       0.000275298442
  error estimate for blocks of size 2^( 7) =       0.000277017717
  error estimate for blocks of size 2^( 8) =       0.000277040360
  error estimate for blocks of size 2^( 9) =       0.000276967669

      target function =                  N/A
              le_mean =     -22.824347460773
             les_mean =     521.451535797127
             stat err =       0.000276581047
             autocorr =       1.263004489590
              std dev =       0.696089307520
             le_variance =       0.484540324043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238068
                                         uncertainty =       0.001579340458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238068
                                         uncertainty =       0.001579340458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246104735
  error estimate for blocks of size 2^( 2) =       0.000255319852
  error estimate for blocks of size 2^( 3) =       0.000263649849
  error estimate for blocks of size 2^( 4) =       0.000269761663
  error estimate for blocks of size 2^( 5) =       0.000273348258
  error estimate for blocks of size 2^( 6) =       0.000275298442
  error estimate for blocks of size 2^( 7) =       0.000277017717
  error estimate for blocks of size 2^( 8) =       0.000277040360
  error estimate for blocks of size 2^( 9) =       0.000276967668

      target function =                  N/A
              le_mean =     -22.824347460785
             les_mean =     521.451535791191
             stat err =       0.000276581047
             autocorr =       1.263004487632
              std dev =       0.696089307508
             le_variance =       0.484540324026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238052
                                         uncertainty =       0.001579340213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484541238052
                                         uncertainty =       0.001579340213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246104735
  error estimate for blocks of size 2^( 2) =       0.000255319852
  error estimate for blocks of size 2^( 3) =       0.000263649849
  error estimate for blocks of size 2^( 4) =       0.000269761662
  error estimate for blocks of size 2^( 5) =       0.000273348258
  error estimate for blocks of size 2^( 6) =       0.000275298442
  error estimate for blocks of size 2^( 7) =       0.000277017717
  error estimate for blocks of size 2^( 8) =       0.000277040360
  error estimate for blocks of size 2^( 9) =       0.000276967668

      target function =                  N/A
              le_mean =     -22.824347460795
             les_mean =     521.451535786011
             stat err =       0.000276581047
             autocorr =       1.263004485968
              std dev =       0.696089307497
             le_variance =       0.484540324011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824347460796        initial  <--
     9.7656e+03     9.7656e+04             3.2486e-08       -22.824347460773
     3.9062e+04     3.9062e+05             8.1216e-09       -22.824347460785
     1.5625e+05     1.5625e+06             2.0304e-09       -22.824347460795

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.8106
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854387e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8776e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2840e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7942
    reference variance = 0.579738
====================================================
  Execution time = 1.0036e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1408e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9939e-01
  Total weights = 7.856562589e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8099e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483586673128
                                         uncertainty =       0.001314770397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483586673128
                                         uncertainty =       0.001314770397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245862451
  error estimate for blocks of size 2^( 2) =       0.000255139751
  error estimate for blocks of size 2^( 3) =       0.000263374960
  error estimate for blocks of size 2^( 4) =       0.000269454383
  error estimate for blocks of size 2^( 5) =       0.000273010913
  error estimate for blocks of size 2^( 6) =       0.000274512362
  error estimate for blocks of size 2^( 7) =       0.000275268788
  error estimate for blocks of size 2^( 8) =       0.000275537959
  error estimate for blocks of size 2^( 9) =       0.000275484435

      target function =                  N/A
              le_mean =     -22.824178657872
             les_mean =     521.442521948968
             stat err =       0.000275200886
             autocorr =       1.252896634728
              std dev =       0.695404024908
             le_variance =       0.483586757858


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282417865787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824178657868       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824178657879       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824178657880       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 1.967059e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824178657868       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824178657871       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824178657871       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 4.917656e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824178657868       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824178657869       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824178657869       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 1.229414e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1848e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348786e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841737e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143581e-04 3 1  ON 29
ci_31                 7.463466e-04 3 1  ON 30
ci_32                 1.618862e-04 3 1  ON 31
ci_33                -8.922749e-05 3 1  ON 32
ci_34                -3.353288e-04 3 1  ON 33
ci_35                -1.403914e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885846e-04 3 1  ON 36
ci_38                -9.811394e-05 3 1  ON 37
ci_39                -6.728421e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627339e-04 3 1  ON 40
ci_42                 2.820810e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417979e-04 3 1  ON 44
ci_46                -1.727368e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467267e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335985e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583220e-06 3 1  ON 51
ci_53                -9.100835e-04 3 1  ON 52
ci_54                -7.556171e-04 3 1  ON 53
ci_55                -7.439113e-04 3 1  ON 54
ci_56                 1.500493e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740599e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873811e-04 3 1  ON 61
ci_63                -9.854402e-05 3 1  ON 62
ci_64                -2.248453e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300661e-04 3 1  ON 65
ci_67                -3.207323e-04 3 1  ON 66
ci_68                -1.925033e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.9083
    reference variance = 0.423186
====================================================
  Execution time = 9.7845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0421e-01
  Total weights = 7.8575e+06
  Execution time = 1.4129e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096107
                                         uncertainty =       0.002121274752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096107
                                         uncertainty =       0.002121274752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419024
  error estimate for blocks of size 2^( 2) =       0.000255535227
  error estimate for blocks of size 2^( 3) =       0.000263865777
  error estimate for blocks of size 2^( 4) =       0.000269995628
  error estimate for blocks of size 2^( 5) =       0.000273721793
  error estimate for blocks of size 2^( 6) =       0.000275413877
  error estimate for blocks of size 2^( 7) =       0.000276116101
  error estimate for blocks of size 2^( 8) =       0.000276319152
  error estimate for blocks of size 2^( 9) =       0.000275847271

      target function =                  N/A
              le_mean =     -22.824169550305
             les_mean =     521.446925709783
             stat err =       0.000275924100
             autocorr =       1.253807325367
              std dev =       0.696978251989
             le_variance =       0.485778683745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096264
                                         uncertainty =       0.002121274807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096264
                                         uncertainty =       0.002121274807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419024
  error estimate for blocks of size 2^( 2) =       0.000255535227
  error estimate for blocks of size 2^( 3) =       0.000263865777
  error estimate for blocks of size 2^( 4) =       0.000269995628
  error estimate for blocks of size 2^( 5) =       0.000273721794
  error estimate for blocks of size 2^( 6) =       0.000275413877
  error estimate for blocks of size 2^( 7) =       0.000276116101
  error estimate for blocks of size 2^( 8) =       0.000276319152
  error estimate for blocks of size 2^( 9) =       0.000275847271

      target function =                  N/A
              le_mean =     -22.824169550299
             les_mean =     521.446925709955
             stat err =       0.000275924100
             autocorr =       1.253807325619
              std dev =       0.696978252101
             le_variance =       0.485778683902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096186
                                         uncertainty =       0.002121274780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096186
                                         uncertainty =       0.002121274780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419024
  error estimate for blocks of size 2^( 2) =       0.000255535227
  error estimate for blocks of size 2^( 3) =       0.000263865777
  error estimate for blocks of size 2^( 4) =       0.000269995628
  error estimate for blocks of size 2^( 5) =       0.000273721793
  error estimate for blocks of size 2^( 6) =       0.000275413877
  error estimate for blocks of size 2^( 7) =       0.000276116101
  error estimate for blocks of size 2^( 8) =       0.000276319152
  error estimate for blocks of size 2^( 9) =       0.000275847271

      target function =                  N/A
              le_mean =     -22.824169550302
             les_mean =     521.446925709869
             stat err =       0.000275924100
             autocorr =       1.253807325498
              std dev =       0.696978252045
             le_variance =       0.485778683823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096117
                                         uncertainty =       0.002121274756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776096117
                                         uncertainty =       0.002121274756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419024
  error estimate for blocks of size 2^( 2) =       0.000255535227
  error estimate for blocks of size 2^( 3) =       0.000263865777
  error estimate for blocks of size 2^( 4) =       0.000269995628
  error estimate for blocks of size 2^( 5) =       0.000273721793
  error estimate for blocks of size 2^( 6) =       0.000275413877
  error estimate for blocks of size 2^( 7) =       0.000276116101
  error estimate for blocks of size 2^( 8) =       0.000276319152
  error estimate for blocks of size 2^( 9) =       0.000275847271

      target function =                  N/A
              le_mean =     -22.824169550305
             les_mean =     521.446925709793
             stat err =       0.000275924100
             autocorr =       1.253807325404
              std dev =       0.696978251996
             le_variance =       0.485778683755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824169550305        initial  <--
     9.7656e+04     9.7656e+05             1.9671e-09       -22.824169550299
     3.9062e+05     3.9062e+06             4.9177e-10       -22.824169550302
     1.5625e+06     1.5625e+07             1.2294e-10       -22.824169550305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.7060
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854387e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8719e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8389
    reference variance = 0.324953
====================================================
  Execution time = 1.0206e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1350e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0041e-01
  Total weights = 7.856867209e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8088e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485027338966
                                         uncertainty =       0.001338757662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485027338966
                                         uncertainty =       0.001338757662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246228713
  error estimate for blocks of size 2^( 2) =       0.000255483091
  error estimate for blocks of size 2^( 3) =       0.000263710183
  error estimate for blocks of size 2^( 4) =       0.000269473355
  error estimate for blocks of size 2^( 5) =       0.000272817244
  error estimate for blocks of size 2^( 6) =       0.000274576299
  error estimate for blocks of size 2^( 7) =       0.000275336890
  error estimate for blocks of size 2^( 8) =       0.000275808424
  error estimate for blocks of size 2^( 9) =       0.000276048441

      target function =                  N/A
              le_mean =     -22.824780896783
             les_mean =     521.471034812819
             stat err =       0.000275442514
             autocorr =       1.251366591147
              std dev =       0.696439970208
             le_variance =       0.485028632103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282478089678e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824780896772       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824780896772       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824780896772       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824780896772       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 2.158073e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824780896772       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824780896772       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824780896772       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824780896772       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 5.395195e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824780896772       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824780896772       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824780896772       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824780896772       residual = 4.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+07 is 1.348799e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2016e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922775e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403916e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811376e-05 3 1  ON 37
ci_39                -6.728431e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467324e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583225e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8652
    reference variance = 0.927497
====================================================
  Execution time = 9.8103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9875e-01
  Total weights = 7.8562e+06
  Execution time = 1.4129e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561045
                                         uncertainty =       0.001144745242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561045
                                         uncertainty =       0.001144745242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245825776
  error estimate for blocks of size 2^( 2) =       0.000254971480
  error estimate for blocks of size 2^( 3) =       0.000263229087
  error estimate for blocks of size 2^( 4) =       0.000269061357
  error estimate for blocks of size 2^( 5) =       0.000272251888
  error estimate for blocks of size 2^( 6) =       0.000274035098
  error estimate for blocks of size 2^( 7) =       0.000274817252
  error estimate for blocks of size 2^( 8) =       0.000274985674
  error estimate for blocks of size 2^( 9) =       0.000274509318

      target function =                  N/A
              le_mean =     -22.824570982055
             les_mean =     521.459790777421
             stat err =       0.000274586835
             autocorr =       1.247683942143
              std dev =       0.695300292808
             le_variance =       0.483442497179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561031
                                         uncertainty =       0.001144745244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561031
                                         uncertainty =       0.001144745244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245825776
  error estimate for blocks of size 2^( 2) =       0.000254971480
  error estimate for blocks of size 2^( 3) =       0.000263229087
  error estimate for blocks of size 2^( 4) =       0.000269061357
  error estimate for blocks of size 2^( 5) =       0.000272251888
  error estimate for blocks of size 2^( 6) =       0.000274035098
  error estimate for blocks of size 2^( 7) =       0.000274817252
  error estimate for blocks of size 2^( 8) =       0.000274985674
  error estimate for blocks of size 2^( 9) =       0.000274509318

      target function =                  N/A
              le_mean =     -22.824570982054
             les_mean =     521.459790777245
             stat err =       0.000274586835
             autocorr =       1.247683942108
              std dev =       0.695300292797
             le_variance =       0.483442497164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561038
                                         uncertainty =       0.001144745243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561038
                                         uncertainty =       0.001144745243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245825776
  error estimate for blocks of size 2^( 2) =       0.000254971480
  error estimate for blocks of size 2^( 3) =       0.000263229087
  error estimate for blocks of size 2^( 4) =       0.000269061357
  error estimate for blocks of size 2^( 5) =       0.000272251888
  error estimate for blocks of size 2^( 6) =       0.000274035098
  error estimate for blocks of size 2^( 7) =       0.000274817252
  error estimate for blocks of size 2^( 8) =       0.000274985674
  error estimate for blocks of size 2^( 9) =       0.000274509318

      target function =                  N/A
              le_mean =     -22.824570982055
             les_mean =     521.459790777333
             stat err =       0.000274586835
             autocorr =       1.247683942124
              std dev =       0.695300292803
             le_variance =       0.483442497172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561044
                                         uncertainty =       0.001144745242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483442561044
                                         uncertainty =       0.001144745242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245825776
  error estimate for blocks of size 2^( 2) =       0.000254971480
  error estimate for blocks of size 2^( 3) =       0.000263229087
  error estimate for blocks of size 2^( 4) =       0.000269061357
  error estimate for blocks of size 2^( 5) =       0.000272251888
  error estimate for blocks of size 2^( 6) =       0.000274035098
  error estimate for blocks of size 2^( 7) =       0.000274817252
  error estimate for blocks of size 2^( 8) =       0.000274985674
  error estimate for blocks of size 2^( 9) =       0.000274509318

      target function =                  N/A
              le_mean =     -22.824570982055
             les_mean =     521.459790777410
             stat err =       0.000274586835
             autocorr =       1.247683942110
              std dev =       0.695300292808
             le_variance =       0.483442497178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824570982055        initial  <--
     9.7656e+05     9.7656e+06             2.1581e-10       -22.824570982054
     3.9062e+06     3.9062e+07             5.3952e-11       -22.824570982055
     1.5625e+07     1.5625e+08             1.3488e-11       -22.824570982055

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.9268
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854387e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8909e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7619
    reference variance = 0.513154
====================================================
  Execution time = 1.0166e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1382e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9970e-01
  Total weights = 7.857048212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8104e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483731627573
                                         uncertainty =       0.001401685078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483731627573
                                         uncertainty =       0.001401685078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245900059
  error estimate for blocks of size 2^( 2) =       0.000255142469
  error estimate for blocks of size 2^( 3) =       0.000263517393
  error estimate for blocks of size 2^( 4) =       0.000269232231
  error estimate for blocks of size 2^( 5) =       0.000272775343
  error estimate for blocks of size 2^( 6) =       0.000274201116
  error estimate for blocks of size 2^( 7) =       0.000275601117
  error estimate for blocks of size 2^( 8) =       0.000275778769
  error estimate for blocks of size 2^( 9) =       0.000275868896

      target function =                  N/A
              le_mean =     -22.824744175274
             les_mean =     521.468645451568
             stat err =       0.000275362474
             autocorr =       1.253984722391
              std dev =       0.695510396820
             le_variance =       0.483734712085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282474417527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824744175274       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824744175274       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824744175274       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+06 is 1.709821e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824744175274       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824744175274       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824744175274       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+07 is 4.274577e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824744175274       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824744175274       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824744175274       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+08 is 1.068637e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1978e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922772e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811378e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467344e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583227e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7351
    reference variance = 0.482343
====================================================
  Execution time = 9.7845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0236e-01
  Total weights = 7.8571e+06
  Execution time = 1.4079e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103689
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103689
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246099300
  error estimate for blocks of size 2^( 2) =       0.000255321736
  error estimate for blocks of size 2^( 3) =       0.000263570413
  error estimate for blocks of size 2^( 4) =       0.000269813827
  error estimate for blocks of size 2^( 5) =       0.000273205110
  error estimate for blocks of size 2^( 6) =       0.000275075543
  error estimate for blocks of size 2^( 7) =       0.000276300030
  error estimate for blocks of size 2^( 8) =       0.000276858118
  error estimate for blocks of size 2^( 9) =       0.000276646659

      target function =                  N/A
              le_mean =     -22.824770576790
             les_mean =     521.472513829637
             stat err =       0.000276220088
             autocorr =       1.259765642134
              std dev =       0.696073936114
             le_variance =       0.484518924537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103688
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103688
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246099300
  error estimate for blocks of size 2^( 2) =       0.000255321736
  error estimate for blocks of size 2^( 3) =       0.000263570413
  error estimate for blocks of size 2^( 4) =       0.000269813827
  error estimate for blocks of size 2^( 5) =       0.000273205110
  error estimate for blocks of size 2^( 6) =       0.000275075543
  error estimate for blocks of size 2^( 7) =       0.000276300030
  error estimate for blocks of size 2^( 8) =       0.000276858118
  error estimate for blocks of size 2^( 9) =       0.000276646659

      target function =                  N/A
              le_mean =     -22.824770576790
             les_mean =     521.472513829613
             stat err =       0.000276220088
             autocorr =       1.259765642107
              std dev =       0.696073936113
             le_variance =       0.484518924536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103688
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103688
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246099300
  error estimate for blocks of size 2^( 2) =       0.000255321736
  error estimate for blocks of size 2^( 3) =       0.000263570413
  error estimate for blocks of size 2^( 4) =       0.000269813827
  error estimate for blocks of size 2^( 5) =       0.000273205110
  error estimate for blocks of size 2^( 6) =       0.000275075543
  error estimate for blocks of size 2^( 7) =       0.000276300030
  error estimate for blocks of size 2^( 8) =       0.000276858118
  error estimate for blocks of size 2^( 9) =       0.000276646659

      target function =                  N/A
              le_mean =     -22.824770576790
             les_mean =     521.472513829625
             stat err =       0.000276220088
             autocorr =       1.259765642130
              std dev =       0.696073936114
             le_variance =       0.484518924537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103689
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484519103689
                                         uncertainty =       0.001426274843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246099300
  error estimate for blocks of size 2^( 2) =       0.000255321736
  error estimate for blocks of size 2^( 3) =       0.000263570413
  error estimate for blocks of size 2^( 4) =       0.000269813827
  error estimate for blocks of size 2^( 5) =       0.000273205110
  error estimate for blocks of size 2^( 6) =       0.000275075543
  error estimate for blocks of size 2^( 7) =       0.000276300030
  error estimate for blocks of size 2^( 8) =       0.000276858118
  error estimate for blocks of size 2^( 9) =       0.000276646659

      target function =                  N/A
              le_mean =     -22.824770576790
             les_mean =     521.472513829636
             stat err =       0.000276220088
             autocorr =       1.259765642102
              std dev =       0.696073936114
             le_variance =       0.484518924538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824770576790        initial  <--
     9.7656e+06     9.7656e+07             1.7098e-11       -22.824770576790
     3.9062e+07     3.9062e+08             4.2746e-12       -22.824770576790
     1.5625e+08     1.5625e+09             1.0686e-12       -22.824770576790

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.5072
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854387e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8829e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7893
    reference variance = 0.395954
====================================================
  Execution time = 1.0070e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1377e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0118e-01
  Total weights = 7.856787248e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8185e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483928976033
                                         uncertainty =       0.001242852527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483928976033
                                         uncertainty =       0.001242852527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245949229
  error estimate for blocks of size 2^( 2) =       0.000255259958
  error estimate for blocks of size 2^( 3) =       0.000263684590
  error estimate for blocks of size 2^( 4) =       0.000269655830
  error estimate for blocks of size 2^( 5) =       0.000273067672
  error estimate for blocks of size 2^( 6) =       0.000275714564
  error estimate for blocks of size 2^( 7) =       0.000275965758
  error estimate for blocks of size 2^( 8) =       0.000276554277
  error estimate for blocks of size 2^( 9) =       0.000276222791

      target function =                  N/A
              le_mean =     -22.824413658701
             les_mean =     521.455042493226
             stat err =       0.000276114348
             autocorr =       1.260337961563
              std dev =       0.695649470932
             le_variance =       0.483928186408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282441365870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824413658698       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824413658698       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824413658698       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824413658698       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+07 is 1.903157e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824413658698       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824413658698       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824413658698       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824413857428       residual = 4.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+08 is 4.758233e-13

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824413658698       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824413658698       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824413658698       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824413693674       residual = 5.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+09 is 1.189320e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1889e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7718
    reference variance = 0.305733
====================================================
  Execution time = 9.9492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0222e-01
  Total weights = 7.8568e+06
  Execution time = 1.4090e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246600254
  error estimate for blocks of size 2^( 2) =       0.000255822741
  error estimate for blocks of size 2^( 3) =       0.000264172054
  error estimate for blocks of size 2^( 4) =       0.000270327653
  error estimate for blocks of size 2^( 5) =       0.000274111994
  error estimate for blocks of size 2^( 6) =       0.000275838802
  error estimate for blocks of size 2^( 7) =       0.000276816592
  error estimate for blocks of size 2^( 8) =       0.000278094540
  error estimate for blocks of size 2^( 9) =       0.000279135410

      target function =                  N/A
              le_mean =     -22.824223893433
             les_mean =     521.447411575759
             stat err =       0.000277471336
             autocorr =       1.266045201125
              std dev =       0.697490847529
             le_variance =       0.486493482387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246600254
  error estimate for blocks of size 2^( 2) =       0.000255822741
  error estimate for blocks of size 2^( 3) =       0.000264172054
  error estimate for blocks of size 2^( 4) =       0.000270327653
  error estimate for blocks of size 2^( 5) =       0.000274111994
  error estimate for blocks of size 2^( 6) =       0.000275838802
  error estimate for blocks of size 2^( 7) =       0.000276816592
  error estimate for blocks of size 2^( 8) =       0.000278094540
  error estimate for blocks of size 2^( 9) =       0.000279135410

      target function =                  N/A
              le_mean =     -22.824223893433
             les_mean =     521.447411575760
             stat err =       0.000277471336
             autocorr =       1.266045201111
              std dev =       0.697490847529
             le_variance =       0.486493482387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246600254
  error estimate for blocks of size 2^( 2) =       0.000255822741
  error estimate for blocks of size 2^( 3) =       0.000264172054
  error estimate for blocks of size 2^( 4) =       0.000270327653
  error estimate for blocks of size 2^( 5) =       0.000274111994
  error estimate for blocks of size 2^( 6) =       0.000275838802
  error estimate for blocks of size 2^( 7) =       0.000276816592
  error estimate for blocks of size 2^( 8) =       0.000278094540
  error estimate for blocks of size 2^( 9) =       0.000279135410

      target function =                  N/A
              le_mean =     -22.824223893433
             les_mean =     521.447411575760
             stat err =       0.000277471336
             autocorr =       1.266045201145
              std dev =       0.697490847529
             le_variance =       0.486493482387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486492635017
                                         uncertainty =       0.001625757434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246600254
  error estimate for blocks of size 2^( 2) =       0.000255822741
  error estimate for blocks of size 2^( 3) =       0.000264172054
  error estimate for blocks of size 2^( 4) =       0.000270327653
  error estimate for blocks of size 2^( 5) =       0.000274111994
  error estimate for blocks of size 2^( 6) =       0.000275838802
  error estimate for blocks of size 2^( 7) =       0.000276816592
  error estimate for blocks of size 2^( 8) =       0.000278094540
  error estimate for blocks of size 2^( 9) =       0.000279135410

      target function =                  N/A
              le_mean =     -22.824223893433
             les_mean =     521.447411575759
             stat err =       0.000277471336
             autocorr =       1.266045201150
              std dev =       0.697490847529
             le_variance =       0.486493482387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824223893433        initial
     9.7656e+07     9.7656e+08             1.9032e-12       -22.824223893433
     3.9062e+08     3.9062e+09             4.7582e-13       -22.824223893433
     1.5625e+09     1.5625e+10             1.1893e-13       -22.824223893433  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+09     and shift_s =   1.5625e+10
*****************************************************************************

  Execution time = 1.7019e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8909e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.9861
    reference variance = 0.988153
====================================================
  Execution time = 1.0054e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1333e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9907e-01
  Total weights = 7.857002837e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8191e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483617949461
                                         uncertainty =       0.001441458688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483617949461
                                         uncertainty =       0.001441458688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245870106
  error estimate for blocks of size 2^( 2) =       0.000255108718
  error estimate for blocks of size 2^( 3) =       0.000263485691
  error estimate for blocks of size 2^( 4) =       0.000269173789
  error estimate for blocks of size 2^( 5) =       0.000272708245
  error estimate for blocks of size 2^( 6) =       0.000274606147
  error estimate for blocks of size 2^( 7) =       0.000275391800
  error estimate for blocks of size 2^( 8) =       0.000276195090
  error estimate for blocks of size 2^( 9) =       0.000275696998

      target function =                  N/A
              le_mean =     -22.824309877182
             les_mean =     521.448193164891
             stat err =       0.000275472509
             autocorr =       1.255292893204
              std dev =       0.695425678277
             le_variance =       0.483616874008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282430987718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824309877178       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824309877178       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824309877178       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824309877178       residual = 3.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+08 is 4.921275e-13

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824309877178       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824309877178       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824309877178       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824309877178       residual = 3.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+09 is 1.230319e-13

solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824309877178       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824309877178       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824309877178       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824309873707       residual = 3.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+09 is 3.075892e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1875e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7713
    reference variance = 0.713271
====================================================
  Execution time = 9.9446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0409e-01
  Total weights = 7.8566e+06
  Execution time = 1.4088e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246837435
  error estimate for blocks of size 2^( 2) =       0.000256127416
  error estimate for blocks of size 2^( 3) =       0.000264180266
  error estimate for blocks of size 2^( 4) =       0.000269929588
  error estimate for blocks of size 2^( 5) =       0.000273020805
  error estimate for blocks of size 2^( 6) =       0.000274567149
  error estimate for blocks of size 2^( 7) =       0.000275401188
  error estimate for blocks of size 2^( 8) =       0.000276697940
  error estimate for blocks of size 2^( 9) =       0.000276649266

      target function =                  N/A
              le_mean =     -22.824368581498
             les_mean =     521.455895088723
             stat err =       0.000275828886
             autocorr =       1.248698075529
              std dev =       0.698161695169
             le_variance =       0.487429752601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246837435
  error estimate for blocks of size 2^( 2) =       0.000256127416
  error estimate for blocks of size 2^( 3) =       0.000264180266
  error estimate for blocks of size 2^( 4) =       0.000269929588
  error estimate for blocks of size 2^( 5) =       0.000273020805
  error estimate for blocks of size 2^( 6) =       0.000274567149
  error estimate for blocks of size 2^( 7) =       0.000275401188
  error estimate for blocks of size 2^( 8) =       0.000276697940
  error estimate for blocks of size 2^( 9) =       0.000276649266

      target function =                  N/A
              le_mean =     -22.824368581498
             les_mean =     521.455895088724
             stat err =       0.000275828886
             autocorr =       1.248698075551
              std dev =       0.698161695169
             le_variance =       0.487429752601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246837435
  error estimate for blocks of size 2^( 2) =       0.000256127416
  error estimate for blocks of size 2^( 3) =       0.000264180266
  error estimate for blocks of size 2^( 4) =       0.000269929588
  error estimate for blocks of size 2^( 5) =       0.000273020805
  error estimate for blocks of size 2^( 6) =       0.000274567149
  error estimate for blocks of size 2^( 7) =       0.000275401188
  error estimate for blocks of size 2^( 8) =       0.000276697940
  error estimate for blocks of size 2^( 9) =       0.000276649266

      target function =                  N/A
              le_mean =     -22.824368581498
             les_mean =     521.455895088724
             stat err =       0.000275828886
             autocorr =       1.248698075543
              std dev =       0.698161695169
             le_variance =       0.487429752601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487428334647
                                         uncertainty =       0.001879058956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246837435
  error estimate for blocks of size 2^( 2) =       0.000256127416
  error estimate for blocks of size 2^( 3) =       0.000264180266
  error estimate for blocks of size 2^( 4) =       0.000269929588
  error estimate for blocks of size 2^( 5) =       0.000273020805
  error estimate for blocks of size 2^( 6) =       0.000274567149
  error estimate for blocks of size 2^( 7) =       0.000275401188
  error estimate for blocks of size 2^( 8) =       0.000276697940
  error estimate for blocks of size 2^( 9) =       0.000276649266

      target function =                  N/A
              le_mean =     -22.824368581498
             les_mean =     521.455895088723
             stat err =       0.000275828886
             autocorr =       1.248698075537
              std dev =       0.698161695169
             le_variance =       0.487429752601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824368581498        initial  <--
     3.9062e+08     3.9062e+09             4.9213e-13       -22.824368581498
     1.5625e+09     1.5625e+10             1.2303e-13       -22.824368581498
     6.2500e+09     6.2500e+10             3.0759e-14       -22.824368581498

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.1660
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8892e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8546
    reference variance = 0.257353
====================================================
  Execution time = 1.0066e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1385e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0109e-01
  Total weights = 7.856301672e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8202e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484474521134
                                         uncertainty =       0.001542085407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484474521134
                                         uncertainty =       0.001542085407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246088875
  error estimate for blocks of size 2^( 2) =       0.000255326723
  error estimate for blocks of size 2^( 3) =       0.000263648368
  error estimate for blocks of size 2^( 4) =       0.000269521634
  error estimate for blocks of size 2^( 5) =       0.000272760202
  error estimate for blocks of size 2^( 6) =       0.000274621772
  error estimate for blocks of size 2^( 7) =       0.000276082093
  error estimate for blocks of size 2^( 8) =       0.000277387609
  error estimate for blocks of size 2^( 9) =       0.000277940001

      target function =                  N/A
              le_mean =     -22.824479782134
             les_mean =     521.457971455302
             stat err =       0.000276507869
             autocorr =       1.262498952448
              std dev =       0.696044450443
             le_variance =       0.484477876992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282447978213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824479782130       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824479782130       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824479782130       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824479782130       residual = 6.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+09 is 5.874926e-14

solving harmonic davidson linear method for identity shift 1.5625e+10, overlap shift 1.5625e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824479782130       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824479782130       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824479782130       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824479288643       residual = 9.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+10 is 1.471721e-14

solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824479782130       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824479782130       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824479782130       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824479782130       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+10 is 3.681366e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1888e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7555
    reference variance = 0.332648
====================================================
  Execution time = 9.9367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0742e-01
  Total weights = 7.8568e+06
  Execution time = 1.4109e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246463621
  error estimate for blocks of size 2^( 2) =       0.000255629652
  error estimate for blocks of size 2^( 3) =       0.000263859926
  error estimate for blocks of size 2^( 4) =       0.000269593269
  error estimate for blocks of size 2^( 5) =       0.000273073483
  error estimate for blocks of size 2^( 6) =       0.000275112943
  error estimate for blocks of size 2^( 7) =       0.000276847335
  error estimate for blocks of size 2^( 8) =       0.000276775581
  error estimate for blocks of size 2^( 9) =       0.000277404583

      target function =                  N/A
              le_mean =     -22.825075263190
             les_mean =     521.491480943842
             stat err =       0.000276535110
             autocorr =       1.258910654680
              std dev =       0.697104391203
             le_variance =       0.485954532234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246463621
  error estimate for blocks of size 2^( 2) =       0.000255629652
  error estimate for blocks of size 2^( 3) =       0.000263859926
  error estimate for blocks of size 2^( 4) =       0.000269593269
  error estimate for blocks of size 2^( 5) =       0.000273073483
  error estimate for blocks of size 2^( 6) =       0.000275112943
  error estimate for blocks of size 2^( 7) =       0.000276847335
  error estimate for blocks of size 2^( 8) =       0.000276775581
  error estimate for blocks of size 2^( 9) =       0.000277404583

      target function =                  N/A
              le_mean =     -22.825075263190
             les_mean =     521.491480943842
             stat err =       0.000276535110
             autocorr =       1.258910654673
              std dev =       0.697104391203
             le_variance =       0.485954532234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246463621
  error estimate for blocks of size 2^( 2) =       0.000255629652
  error estimate for blocks of size 2^( 3) =       0.000263859926
  error estimate for blocks of size 2^( 4) =       0.000269593269
  error estimate for blocks of size 2^( 5) =       0.000273073483
  error estimate for blocks of size 2^( 6) =       0.000275112943
  error estimate for blocks of size 2^( 7) =       0.000276847335
  error estimate for blocks of size 2^( 8) =       0.000276775581
  error estimate for blocks of size 2^( 9) =       0.000277404583

      target function =                  N/A
              le_mean =     -22.825075263190
             les_mean =     521.491480943842
             stat err =       0.000276535110
             autocorr =       1.258910654673
              std dev =       0.697104391203
             le_variance =       0.485954532234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485956750976
                                         uncertainty =       0.001310999613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246463621
  error estimate for blocks of size 2^( 2) =       0.000255629652
  error estimate for blocks of size 2^( 3) =       0.000263859926
  error estimate for blocks of size 2^( 4) =       0.000269593269
  error estimate for blocks of size 2^( 5) =       0.000273073483
  error estimate for blocks of size 2^( 6) =       0.000275112943
  error estimate for blocks of size 2^( 7) =       0.000276847335
  error estimate for blocks of size 2^( 8) =       0.000276775581
  error estimate for blocks of size 2^( 9) =       0.000277404583

      target function =                  N/A
              le_mean =     -22.825075263190
             les_mean =     521.491480943842
             stat err =       0.000276535110
             autocorr =       1.258910654692
              std dev =       0.697104391203
             le_variance =       0.485954532234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825075263190        initial  <--
     3.9062e+09     3.9062e+10             5.8749e-14       -22.825075263190
     1.5625e+10     1.5625e+11             1.4717e-14       -22.825075263190
     6.2500e+10     6.2500e+11             3.6814e-15       -22.825075263190

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.1450
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8903e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.765
    reference variance = 0.480313
====================================================
  Execution time = 1.0014e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1348e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0316e-01
  Total weights = 7.856743787e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8175e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485160225121
                                         uncertainty =       0.001518053389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485160225121
                                         uncertainty =       0.001518053389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246262600
  error estimate for blocks of size 2^( 2) =       0.000255566802
  error estimate for blocks of size 2^( 3) =       0.000263806190
  error estimate for blocks of size 2^( 4) =       0.000269733155
  error estimate for blocks of size 2^( 5) =       0.000273230421
  error estimate for blocks of size 2^( 6) =       0.000275632077
  error estimate for blocks of size 2^( 7) =       0.000276725695
  error estimate for blocks of size 2^( 8) =       0.000277840649
  error estimate for blocks of size 2^( 9) =       0.000277324598

      target function =                  N/A
              le_mean =     -22.824062237434
             les_mean =     521.440973374076
             stat err =       0.000276880754
             autocorr =       1.264120923020
              std dev =       0.696535816905
             le_variance =       0.485162144232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282406223743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824062237426       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824062237426       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824062237426       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824062237426       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+10 is 8.228991e-15

solving harmonic davidson linear method for identity shift 1.5625e+11, overlap shift 1.5625e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824062237426       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824062237426       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824062237426       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824015011132       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.823950381272       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824046637628       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824115022210       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.823845708657       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824153410133       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.823994036605       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824050541333       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.823969331822       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824093788020       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.823928002604       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824052406909       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.823915123454       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824442426461       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.824197017708       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.824368778322       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.824035661960       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.824312952200       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.823967317975       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.823896985002       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.824025234414       residual = 7.92e-06           smallest_sin_value = 9.99e-01
davidson iteration   24:   krylov dim =  25   energy =     -22.823976603856       residual = 5.48e-06           smallest_sin_value = 9.97e-01
davidson iteration   25 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         25 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+11 is 2.072464e-15

solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824062237426       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824062237426       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824062237426       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824062237426       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824062237426       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.823686038754       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.823913384945       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824428074395       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824018412235       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824373001170       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.823968506005       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824133502335       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.823839810132       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824083086557       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824356827897       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.824918804535       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.823939696828       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.824446774048       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.823773625397       residual = 3.17e-04           smallest_sin_value = 9.98e-01
davidson iteration   19:   krylov dim =  20   energy =     -22.824024712648       residual = 5.72e-04           smallest_sin_value = 9.92e-01
davidson iteration   20 stopping due to small subspace S singular value of 9.46e-01
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+11 is 5.252529e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1836e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8096
    reference variance = 0.390013
====================================================
  Execution time = 9.8957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0248e-01
  Total weights = 7.8571e+06
  Execution time = 1.4082e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246003447
  error estimate for blocks of size 2^( 2) =       0.000255110679
  error estimate for blocks of size 2^( 3) =       0.000263488104
  error estimate for blocks of size 2^( 4) =       0.000269371185
  error estimate for blocks of size 2^( 5) =       0.000273322583
  error estimate for blocks of size 2^( 6) =       0.000275000660
  error estimate for blocks of size 2^( 7) =       0.000275777749
  error estimate for blocks of size 2^( 8) =       0.000275547560
  error estimate for blocks of size 2^( 9) =       0.000276641316

      target function =                  N/A
              le_mean =     -22.824703679325
             les_mean =     521.469577347793
             stat err =       0.000275741821
             autocorr =       1.256385442887
              std dev =       0.695802820973
             le_variance =       0.484141565674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246003447
  error estimate for blocks of size 2^( 2) =       0.000255110679
  error estimate for blocks of size 2^( 3) =       0.000263488104
  error estimate for blocks of size 2^( 4) =       0.000269371185
  error estimate for blocks of size 2^( 5) =       0.000273322583
  error estimate for blocks of size 2^( 6) =       0.000275000660
  error estimate for blocks of size 2^( 7) =       0.000275777749
  error estimate for blocks of size 2^( 8) =       0.000275547560
  error estimate for blocks of size 2^( 9) =       0.000276641316

      target function =                  N/A
              le_mean =     -22.824703679325
             les_mean =     521.469577347793
             stat err =       0.000275741821
             autocorr =       1.256385442892
              std dev =       0.695802820973
             le_variance =       0.484141565674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246003447
  error estimate for blocks of size 2^( 2) =       0.000255110679
  error estimate for blocks of size 2^( 3) =       0.000263488104
  error estimate for blocks of size 2^( 4) =       0.000269371185
  error estimate for blocks of size 2^( 5) =       0.000273322583
  error estimate for blocks of size 2^( 6) =       0.000275000660
  error estimate for blocks of size 2^( 7) =       0.000275777749
  error estimate for blocks of size 2^( 8) =       0.000275547560
  error estimate for blocks of size 2^( 9) =       0.000276641316

      target function =                  N/A
              le_mean =     -22.824703679325
             les_mean =     521.469577347793
             stat err =       0.000275741821
             autocorr =       1.256385442884
              std dev =       0.695802820973
             le_variance =       0.484141565674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484142711819
                                         uncertainty =       0.001128124294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246003447
  error estimate for blocks of size 2^( 2) =       0.000255110679
  error estimate for blocks of size 2^( 3) =       0.000263488104
  error estimate for blocks of size 2^( 4) =       0.000269371185
  error estimate for blocks of size 2^( 5) =       0.000273322583
  error estimate for blocks of size 2^( 6) =       0.000275000660
  error estimate for blocks of size 2^( 7) =       0.000275777749
  error estimate for blocks of size 2^( 8) =       0.000275547560
  error estimate for blocks of size 2^( 9) =       0.000276641316

      target function =                  N/A
              le_mean =     -22.824703679325
             les_mean =     521.469577347793
             stat err =       0.000275741821
             autocorr =       1.256385442902
              std dev =       0.695802820973
             le_variance =       0.484141565674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824703679325        initial  <--
     3.9062e+10     3.9062e+11             8.2290e-15       -22.824703679325
     1.5625e+11     1.5625e+12             2.0725e-15       -22.824703679325
     6.2500e+11     6.2500e+12             5.2525e-16       -22.824703679325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.5436
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8791e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9063
    reference variance = 0.360992
====================================================
  Execution time = 1.0007e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1377e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0318e-01
  Total weights = 7.856333615e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8216e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484838493370
                                         uncertainty =       0.001219675523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484838493370
                                         uncertainty =       0.001219675523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246180674
  error estimate for blocks of size 2^( 2) =       0.000255279129
  error estimate for blocks of size 2^( 3) =       0.000263614553
  error estimate for blocks of size 2^( 4) =       0.000269505256
  error estimate for blocks of size 2^( 5) =       0.000272670486
  error estimate for blocks of size 2^( 6) =       0.000274514361
  error estimate for blocks of size 2^( 7) =       0.000276140519
  error estimate for blocks of size 2^( 8) =       0.000276618794
  error estimate for blocks of size 2^( 9) =       0.000277723903

      target function =                  N/A
              le_mean =     -22.824891465208
             les_mean =     521.478848769579
             stat err =       0.000276249394
             autocorr =       1.259200120976
              std dev =       0.696304095426
             le_variance =       0.484839393307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282489146521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824891465207       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824891465207       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824891465207       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824891465207       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825024037938       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824940865720       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824597012156       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824567328927       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824429116706       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824518507516       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.823792242515       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825635674737       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825480961242       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.824693393061       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.824644424935       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825312455752       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.824505740485       residual = 7.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.824682658414       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.824408853419       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.825428731601       residual = 9.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.824836470152       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.825192031463       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.823491662454       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.825461621438       residual = 7.16e-05           smallest_sin_value = 9.98e-01
davidson iteration   24 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+11 is 6.969445e-16

solving harmonic davidson linear method for identity shift 1.5625e+12, overlap shift 1.5625e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824891465207       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824891465207       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824891465207       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824460890429       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826107179457       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825651647264       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.823319931162       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824973745264       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.828489339361       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.822715576833       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825762851520       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826893488913       residual = 8.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826350698966       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.826191828481       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825667876269       residual = 5.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825827617689       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825356410142       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.823652836107       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.826484729242       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.824898891808       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.821677143379       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.824415151026       residual = 1.13e-03           smallest_sin_value = 9.99e-01
davidson iteration   22:   krylov dim =  23   energy =     -22.831136891400       residual = 5.48e-04           smallest_sin_value = 9.92e-01
davidson iteration   23 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+12 is 1.639691e-16

solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824891465207       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824891465207       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.16e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1831e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9019
    reference variance = 0.617791
====================================================
  Execution time = 9.9388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0354e-01
  Total weights = 7.8568e+06
  Execution time = 1.4059e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246637883
  error estimate for blocks of size 2^( 2) =       0.000255977436
  error estimate for blocks of size 2^( 3) =       0.000264327363
  error estimate for blocks of size 2^( 4) =       0.000270407886
  error estimate for blocks of size 2^( 5) =       0.000273912143
  error estimate for blocks of size 2^( 6) =       0.000275498955
  error estimate for blocks of size 2^( 7) =       0.000276363301
  error estimate for blocks of size 2^( 8) =       0.000276238277
  error estimate for blocks of size 2^( 9) =       0.000275937959

      target function =                  N/A
              le_mean =     -22.824301810211
             les_mean =     521.452293653452
             stat err =       0.000276009623
             autocorr =       1.252359113662
              std dev =       0.697597278099
             le_variance =       0.486641962411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246637883
  error estimate for blocks of size 2^( 2) =       0.000255977436
  error estimate for blocks of size 2^( 3) =       0.000264327363
  error estimate for blocks of size 2^( 4) =       0.000270407886
  error estimate for blocks of size 2^( 5) =       0.000273912143
  error estimate for blocks of size 2^( 6) =       0.000275498955
  error estimate for blocks of size 2^( 7) =       0.000276363301
  error estimate for blocks of size 2^( 8) =       0.000276238277
  error estimate for blocks of size 2^( 9) =       0.000275937959

      target function =                  N/A
              le_mean =     -22.824301810211
             les_mean =     521.452293653452
             stat err =       0.000276009623
             autocorr =       1.252359113634
              std dev =       0.697597278099
             le_variance =       0.486641962411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246637883
  error estimate for blocks of size 2^( 2) =       0.000255977436
  error estimate for blocks of size 2^( 3) =       0.000264327363
  error estimate for blocks of size 2^( 4) =       0.000270407886
  error estimate for blocks of size 2^( 5) =       0.000273912143
  error estimate for blocks of size 2^( 6) =       0.000275498955
  error estimate for blocks of size 2^( 7) =       0.000276363301
  error estimate for blocks of size 2^( 8) =       0.000276238277
  error estimate for blocks of size 2^( 9) =       0.000275937959

      target function =                  N/A
              le_mean =     -22.824301810211
             les_mean =     521.452293653452
             stat err =       0.000276009623
             autocorr =       1.252359113664
              std dev =       0.697597278099
             le_variance =       0.486641962411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486643362246
                                         uncertainty =       0.001528547303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246637883
  error estimate for blocks of size 2^( 2) =       0.000255977436
  error estimate for blocks of size 2^( 3) =       0.000264327363
  error estimate for blocks of size 2^( 4) =       0.000270407886
  error estimate for blocks of size 2^( 5) =       0.000273912143
  error estimate for blocks of size 2^( 6) =       0.000275498955
  error estimate for blocks of size 2^( 7) =       0.000276363301
  error estimate for blocks of size 2^( 8) =       0.000276238277
  error estimate for blocks of size 2^( 9) =       0.000275937959

      target function =                  N/A
              le_mean =     -22.824301810211
             les_mean =     521.452293653452
             stat err =       0.000276009623
             autocorr =       1.252359113662
              std dev =       0.697597278099
             le_variance =       0.486641962411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824301810211        initial  <--
     3.9062e+11     3.9062e+12             6.9694e-16       -22.824301810211
     1.5625e+12     1.5625e+13             1.6397e-16       -22.824301810211
     6.2500e+12     6.2500e+13             0.0000e+00       -22.824301810211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.9719
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8829e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8213
    reference variance = 0.347372
====================================================
  Execution time = 1.0008e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1400e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0241e-01
  Total weights = 7.856350907e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8187e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486046789998
                                         uncertainty =       0.001577009036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486046789998
                                         uncertainty =       0.001577009036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246487542
  error estimate for blocks of size 2^( 2) =       0.000255695641
  error estimate for blocks of size 2^( 3) =       0.000263957414
  error estimate for blocks of size 2^( 4) =       0.000269813831
  error estimate for blocks of size 2^( 5) =       0.000273347916
  error estimate for blocks of size 2^( 6) =       0.000275384066
  error estimate for blocks of size 2^( 7) =       0.000276368074
  error estimate for blocks of size 2^( 8) =       0.000277131867
  error estimate for blocks of size 2^( 9) =       0.000276614460

      target function =                  N/A
              le_mean =     -22.824487386404
             les_mean =     521.459634169913
             stat err =       0.000276374617
             autocorr =       1.257205750541
              std dev =       0.697172049363
             le_variance =       0.486048866413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282448738640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824487386397       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487386397       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+13, overlap shift 1.5625e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824487386397       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487386397       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824487386397       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487386397       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.71e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1828e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8462
    reference variance = 0.370125
====================================================
  Execution time = 9.9724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0430e-01
  Total weights = 7.8567e+06
  Execution time = 1.4072e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246757503
  error estimate for blocks of size 2^( 2) =       0.000255897358
  error estimate for blocks of size 2^( 3) =       0.000264288794
  error estimate for blocks of size 2^( 4) =       0.000270310118
  error estimate for blocks of size 2^( 5) =       0.000273813769
  error estimate for blocks of size 2^( 6) =       0.000276015431
  error estimate for blocks of size 2^( 7) =       0.000277606790
  error estimate for blocks of size 2^( 8) =       0.000278374089
  error estimate for blocks of size 2^( 9) =       0.000280095755

      target function =                  N/A
              le_mean =     -22.824512581167
             les_mean =     521.462677925078
             stat err =       0.000278023016
             autocorr =       1.269465102671
              std dev =       0.697935615083
             le_variance =       0.487114122801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246757503
  error estimate for blocks of size 2^( 2) =       0.000255897358
  error estimate for blocks of size 2^( 3) =       0.000264288794
  error estimate for blocks of size 2^( 4) =       0.000270310118
  error estimate for blocks of size 2^( 5) =       0.000273813769
  error estimate for blocks of size 2^( 6) =       0.000276015431
  error estimate for blocks of size 2^( 7) =       0.000277606790
  error estimate for blocks of size 2^( 8) =       0.000278374089
  error estimate for blocks of size 2^( 9) =       0.000280095755

      target function =                  N/A
              le_mean =     -22.824512581167
             les_mean =     521.462677925078
             stat err =       0.000278023016
             autocorr =       1.269465102671
              std dev =       0.697935615083
             le_variance =       0.487114122801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246757503
  error estimate for blocks of size 2^( 2) =       0.000255897358
  error estimate for blocks of size 2^( 3) =       0.000264288794
  error estimate for blocks of size 2^( 4) =       0.000270310118
  error estimate for blocks of size 2^( 5) =       0.000273813769
  error estimate for blocks of size 2^( 6) =       0.000276015431
  error estimate for blocks of size 2^( 7) =       0.000277606790
  error estimate for blocks of size 2^( 8) =       0.000278374089
  error estimate for blocks of size 2^( 9) =       0.000280095755

      target function =                  N/A
              le_mean =     -22.824512581167
             les_mean =     521.462677925078
             stat err =       0.000278023016
             autocorr =       1.269465102671
              std dev =       0.697935615083
             le_variance =       0.487114122801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487116029820
                                         uncertainty =       0.001949726622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246757503
  error estimate for blocks of size 2^( 2) =       0.000255897358
  error estimate for blocks of size 2^( 3) =       0.000264288794
  error estimate for blocks of size 2^( 4) =       0.000270310118
  error estimate for blocks of size 2^( 5) =       0.000273813769
  error estimate for blocks of size 2^( 6) =       0.000276015431
  error estimate for blocks of size 2^( 7) =       0.000277606790
  error estimate for blocks of size 2^( 8) =       0.000278374089
  error estimate for blocks of size 2^( 9) =       0.000280095755

      target function =                  N/A
              le_mean =     -22.824512581167
             les_mean =     521.462677925078
             stat err =       0.000278023016
             autocorr =       1.269465102671
              std dev =       0.697935615083
             le_variance =       0.487114122801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824512581167        initial  <--
     3.9062e+12     3.9062e+13             0.0000e+00       -22.824512581167
     1.5625e+13     1.5625e+14             0.0000e+00       -22.824512581167
     6.2500e+13     6.2500e+14             0.0000e+00       -22.824512581167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.3413
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8863e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7569
    reference variance = 0.533832
====================================================
  Execution time = 1.0003e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1357e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0416e-01
  Total weights = 7.856898412e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8156e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948217128
                                         uncertainty =       0.001173602771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948217128
                                         uncertainty =       0.001173602771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245954042
  error estimate for blocks of size 2^( 2) =       0.000255131794
  error estimate for blocks of size 2^( 3) =       0.000263555923
  error estimate for blocks of size 2^( 4) =       0.000269376205
  error estimate for blocks of size 2^( 5) =       0.000273059802
  error estimate for blocks of size 2^( 6) =       0.000274989841
  error estimate for blocks of size 2^( 7) =       0.000275822311
  error estimate for blocks of size 2^( 8) =       0.000275706575
  error estimate for blocks of size 2^( 9) =       0.000274644575

      target function =                  N/A
              le_mean =     -22.824768689353
             les_mean =     521.474221711746
             stat err =       0.000275290826
             autocorr =       1.252782127968
              std dev =       0.695663082932
             le_variance =       0.483947124955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282476868935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824768689350       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824768689350       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+14, overlap shift 1.5625e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824768689350       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824768689350       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824768689350       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824768689350       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1823e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7966
    reference variance = 0.400435
====================================================
  Execution time = 9.9044e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0228e-01
  Total weights = 7.8563e+06
  Execution time = 1.4101e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246494233
  error estimate for blocks of size 2^( 2) =       0.000255807472
  error estimate for blocks of size 2^( 3) =       0.000264138223
  error estimate for blocks of size 2^( 4) =       0.000270013159
  error estimate for blocks of size 2^( 5) =       0.000273675676
  error estimate for blocks of size 2^( 6) =       0.000274683511
  error estimate for blocks of size 2^( 7) =       0.000276076001
  error estimate for blocks of size 2^( 8) =       0.000275794289
  error estimate for blocks of size 2^( 9) =       0.000277019310

      target function =                  N/A
              le_mean =     -22.824719839033
             les_mean =     521.470111133250
             stat err =       0.000275893278
             autocorr =       1.252762403199
              std dev =       0.697190975415
             le_variance =       0.486075256201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246494233
  error estimate for blocks of size 2^( 2) =       0.000255807472
  error estimate for blocks of size 2^( 3) =       0.000264138223
  error estimate for blocks of size 2^( 4) =       0.000270013159
  error estimate for blocks of size 2^( 5) =       0.000273675676
  error estimate for blocks of size 2^( 6) =       0.000274683511
  error estimate for blocks of size 2^( 7) =       0.000276076001
  error estimate for blocks of size 2^( 8) =       0.000275794289
  error estimate for blocks of size 2^( 9) =       0.000277019310

      target function =                  N/A
              le_mean =     -22.824719839033
             les_mean =     521.470111133250
             stat err =       0.000275893278
             autocorr =       1.252762403199
              std dev =       0.697190975415
             le_variance =       0.486075256201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246494233
  error estimate for blocks of size 2^( 2) =       0.000255807472
  error estimate for blocks of size 2^( 3) =       0.000264138223
  error estimate for blocks of size 2^( 4) =       0.000270013159
  error estimate for blocks of size 2^( 5) =       0.000273675676
  error estimate for blocks of size 2^( 6) =       0.000274683511
  error estimate for blocks of size 2^( 7) =       0.000276076001
  error estimate for blocks of size 2^( 8) =       0.000275794289
  error estimate for blocks of size 2^( 9) =       0.000277019310

      target function =                  N/A
              le_mean =     -22.824719839033
             les_mean =     521.470111133250
             stat err =       0.000275893278
             autocorr =       1.252762403199
              std dev =       0.697190975415
             le_variance =       0.486075256201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074131315
                                         uncertainty =       0.001377608013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246494233
  error estimate for blocks of size 2^( 2) =       0.000255807472
  error estimate for blocks of size 2^( 3) =       0.000264138223
  error estimate for blocks of size 2^( 4) =       0.000270013159
  error estimate for blocks of size 2^( 5) =       0.000273675676
  error estimate for blocks of size 2^( 6) =       0.000274683511
  error estimate for blocks of size 2^( 7) =       0.000276076001
  error estimate for blocks of size 2^( 8) =       0.000275794289
  error estimate for blocks of size 2^( 9) =       0.000277019310

      target function =                  N/A
              le_mean =     -22.824719839033
             les_mean =     521.470111133250
             stat err =       0.000275893278
             autocorr =       1.252762403199
              std dev =       0.697190975415
             le_variance =       0.486075256201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824719839033        initial  <--
     3.9062e+13     3.9062e+14             0.0000e+00       -22.824719839033
     1.5625e+14     1.5625e+15             0.0000e+00       -22.824719839033
     6.2500e+14     6.2500e+15             0.0000e+00       -22.824719839033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.7683
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8801e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8169
    reference variance = 0.268087
====================================================
  Execution time = 9.9073e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1398e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9869e-01
  Total weights = 7.856788573e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8314e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481212578726
                                         uncertainty =       0.001193554367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481212578726
                                         uncertainty =       0.001193554367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245258423
  error estimate for blocks of size 2^( 2) =       0.000254443452
  error estimate for blocks of size 2^( 3) =       0.000262917375
  error estimate for blocks of size 2^( 4) =       0.000268795974
  error estimate for blocks of size 2^( 5) =       0.000272712822
  error estimate for blocks of size 2^( 6) =       0.000274312425
  error estimate for blocks of size 2^( 7) =       0.000275580192
  error estimate for blocks of size 2^( 8) =       0.000274699119
  error estimate for blocks of size 2^( 9) =       0.000275412657

      target function =                  N/A
              le_mean =     -22.824091410133
             les_mean =     521.437833794461
             stat err =       0.000275001098
             autocorr =       1.257248114019
              std dev =       0.693695576438
             le_variance =       0.481213552769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282409141013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824091410123       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824091410123       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824091410123       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824091410123       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.43e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+14 is 5.696801e-19

solving harmonic davidson linear method for identity shift 1.5625e+15, overlap shift 1.5625e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824091410123       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824091410123       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824091410123       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.46e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+15 is 1.293934e-19

solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824091410123       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824091410123       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824091410123       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824091410123       residual = 3.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+15 is 3.607157e-20

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1740e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8441
    reference variance = 0.336102
====================================================
  Execution time = 1.0100e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0730e-01
  Total weights = 7.8565e+06
  Execution time = 1.4079e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247008887
  error estimate for blocks of size 2^( 2) =       0.000256204237
  error estimate for blocks of size 2^( 3) =       0.000264481965
  error estimate for blocks of size 2^( 4) =       0.000270361317
  error estimate for blocks of size 2^( 5) =       0.000273585332
  error estimate for blocks of size 2^( 6) =       0.000275601829
  error estimate for blocks of size 2^( 7) =       0.000276216809
  error estimate for blocks of size 2^( 8) =       0.000276396932
  error estimate for blocks of size 2^( 9) =       0.000276034039

      target function =                  N/A
              le_mean =     -22.824708382623
             les_mean =     521.474611093394
             stat err =       0.000276062402
             autocorr =       1.249077446256
              std dev =       0.698646637083
             le_variance =       0.488107123508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247008887
  error estimate for blocks of size 2^( 2) =       0.000256204237
  error estimate for blocks of size 2^( 3) =       0.000264481965
  error estimate for blocks of size 2^( 4) =       0.000270361317
  error estimate for blocks of size 2^( 5) =       0.000273585332
  error estimate for blocks of size 2^( 6) =       0.000275601829
  error estimate for blocks of size 2^( 7) =       0.000276216809
  error estimate for blocks of size 2^( 8) =       0.000276396932
  error estimate for blocks of size 2^( 9) =       0.000276034039

      target function =                  N/A
              le_mean =     -22.824708382623
             les_mean =     521.474611093394
             stat err =       0.000276062402
             autocorr =       1.249077446278
              std dev =       0.698646637083
             le_variance =       0.488107123508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247008887
  error estimate for blocks of size 2^( 2) =       0.000256204237
  error estimate for blocks of size 2^( 3) =       0.000264481965
  error estimate for blocks of size 2^( 4) =       0.000270361317
  error estimate for blocks of size 2^( 5) =       0.000273585332
  error estimate for blocks of size 2^( 6) =       0.000275601829
  error estimate for blocks of size 2^( 7) =       0.000276216809
  error estimate for blocks of size 2^( 8) =       0.000276396932
  error estimate for blocks of size 2^( 9) =       0.000276034039

      target function =                  N/A
              le_mean =     -22.824708382623
             les_mean =     521.474611093394
             stat err =       0.000276062402
             autocorr =       1.249077446278
              std dev =       0.698646637083
             le_variance =       0.488107123508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488105359611
                                         uncertainty =       0.001648771861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247008887
  error estimate for blocks of size 2^( 2) =       0.000256204237
  error estimate for blocks of size 2^( 3) =       0.000264481965
  error estimate for blocks of size 2^( 4) =       0.000270361317
  error estimate for blocks of size 2^( 5) =       0.000273585332
  error estimate for blocks of size 2^( 6) =       0.000275601829
  error estimate for blocks of size 2^( 7) =       0.000276216809
  error estimate for blocks of size 2^( 8) =       0.000276396932
  error estimate for blocks of size 2^( 9) =       0.000276034039

      target function =                  N/A
              le_mean =     -22.824708382623
             les_mean =     521.474611093394
             stat err =       0.000276062402
             autocorr =       1.249077446256
              std dev =       0.698646637083
             le_variance =       0.488107123508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824708382623        initial  <--
     3.9062e+14     3.9062e+15             5.6968e-19       -22.824708382623
     1.5625e+15     1.5625e+16             1.2939e-19       -22.824708382623
     6.2500e+15     6.2500e+16             3.6072e-20       -22.824708382623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.6081
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8901e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.9029
    reference variance = 0.982693
====================================================
  Execution time = 9.8081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1370e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0284e-01
  Total weights = 7.856621563e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8203e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074279283
                                         uncertainty =       0.001529729760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486074279283
                                         uncertainty =       0.001529729760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246494343
  error estimate for blocks of size 2^( 2) =       0.000255635231
  error estimate for blocks of size 2^( 3) =       0.000263890988
  error estimate for blocks of size 2^( 4) =       0.000269848850
  error estimate for blocks of size 2^( 5) =       0.000273375116
  error estimate for blocks of size 2^( 6) =       0.000274571612
  error estimate for blocks of size 2^( 7) =       0.000275917158
  error estimate for blocks of size 2^( 8) =       0.000276897232
  error estimate for blocks of size 2^( 9) =       0.000277226379

      target function =                  N/A
              le_mean =     -22.824998465181
             les_mean =     521.483394155698
             stat err =       0.000276153095
             autocorr =       1.255121928855
              std dev =       0.697191285823
             le_variance =       0.486075689028


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282499846518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824998465177       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824998465177       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.89e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+16, overlap shift 1.5625e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824998465177       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824998465177       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.89e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824998465177       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824998465177       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.98e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1630e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.9667
    reference variance = 1.16735
====================================================
  Execution time = 1.0122e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0021e-01
  Total weights = 7.8568e+06
  Execution time = 1.4098e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246140353
  error estimate for blocks of size 2^( 2) =       0.000255425548
  error estimate for blocks of size 2^( 3) =       0.000263863929
  error estimate for blocks of size 2^( 4) =       0.000269789878
  error estimate for blocks of size 2^( 5) =       0.000272901117
  error estimate for blocks of size 2^( 6) =       0.000274830464
  error estimate for blocks of size 2^( 7) =       0.000275780822
  error estimate for blocks of size 2^( 8) =       0.000276444272
  error estimate for blocks of size 2^( 9) =       0.000275918794

      target function =                  N/A
              le_mean =     -22.824760366111
             les_mean =     521.469896102811
             stat err =       0.000275743588
             autocorr =       1.255004275194
              std dev =       0.696190051385
             le_variance =       0.484680587648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246140353
  error estimate for blocks of size 2^( 2) =       0.000255425548
  error estimate for blocks of size 2^( 3) =       0.000263863929
  error estimate for blocks of size 2^( 4) =       0.000269789878
  error estimate for blocks of size 2^( 5) =       0.000272901117
  error estimate for blocks of size 2^( 6) =       0.000274830464
  error estimate for blocks of size 2^( 7) =       0.000275780822
  error estimate for blocks of size 2^( 8) =       0.000276444272
  error estimate for blocks of size 2^( 9) =       0.000275918794

      target function =                  N/A
              le_mean =     -22.824760366111
             les_mean =     521.469896102811
             stat err =       0.000275743588
             autocorr =       1.255004275194
              std dev =       0.696190051385
             le_variance =       0.484680587648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246140353
  error estimate for blocks of size 2^( 2) =       0.000255425548
  error estimate for blocks of size 2^( 3) =       0.000263863929
  error estimate for blocks of size 2^( 4) =       0.000269789878
  error estimate for blocks of size 2^( 5) =       0.000272901117
  error estimate for blocks of size 2^( 6) =       0.000274830464
  error estimate for blocks of size 2^( 7) =       0.000275780822
  error estimate for blocks of size 2^( 8) =       0.000276444272
  error estimate for blocks of size 2^( 9) =       0.000275918794

      target function =                  N/A
              le_mean =     -22.824760366111
             les_mean =     521.469896102811
             stat err =       0.000275743588
             autocorr =       1.255004275194
              std dev =       0.696190051385
             le_variance =       0.484680587648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484677437611
                                         uncertainty =       0.001155916771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246140353
  error estimate for blocks of size 2^( 2) =       0.000255425548
  error estimate for blocks of size 2^( 3) =       0.000263863929
  error estimate for blocks of size 2^( 4) =       0.000269789878
  error estimate for blocks of size 2^( 5) =       0.000272901117
  error estimate for blocks of size 2^( 6) =       0.000274830464
  error estimate for blocks of size 2^( 7) =       0.000275780822
  error estimate for blocks of size 2^( 8) =       0.000276444272
  error estimate for blocks of size 2^( 9) =       0.000275918794

      target function =                  N/A
              le_mean =     -22.824760366111
             les_mean =     521.469896102811
             stat err =       0.000275743588
             autocorr =       1.255004275194
              std dev =       0.696190051385
             le_variance =       0.484680587648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824760366111        initial  <--
     3.9062e+15     3.9062e+16             0.0000e+00       -22.824760366111
     1.5625e+16     1.5625e+17             0.0000e+00       -22.824760366111
     6.2500e+16     6.2500e+17             0.0000e+00       -22.824760366111

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.9205
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8822e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7757
    reference variance = 0.489105
====================================================
  Execution time = 9.8908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1371e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0131e-01
  Total weights = 7.856304024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8173e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484493366940
                                         uncertainty =       0.001195635163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484493366940
                                         uncertainty =       0.001195635163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246092932
  error estimate for blocks of size 2^( 2) =       0.000255320955
  error estimate for blocks of size 2^( 3) =       0.000263643308
  error estimate for blocks of size 2^( 4) =       0.000269591837
  error estimate for blocks of size 2^( 5) =       0.000273049661
  error estimate for blocks of size 2^( 6) =       0.000275014976
  error estimate for blocks of size 2^( 7) =       0.000276397250
  error estimate for blocks of size 2^( 8) =       0.000277180818
  error estimate for blocks of size 2^( 9) =       0.000276705046

      target function =                  N/A
              le_mean =     -22.825074881714
             les_mean =     521.485349392408
             stat err =       0.000276324522
             autocorr =       1.260783668322
              std dev =       0.696055923991
             le_variance =       0.484493849323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282507488171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825074881708       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825074881708       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+17, overlap shift 1.5625e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825074881708       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825074881708       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825074881708       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825074881708       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1709e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8708
    reference variance = 0.379556
====================================================
  Execution time = 9.9599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9896e-01
  Total weights = 7.8566e+06
  Execution time = 1.4596e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245847116
  error estimate for blocks of size 2^( 2) =       0.000255122307
  error estimate for blocks of size 2^( 3) =       0.000263448868
  error estimate for blocks of size 2^( 4) =       0.000269335915
  error estimate for blocks of size 2^( 5) =       0.000272998203
  error estimate for blocks of size 2^( 6) =       0.000275231200
  error estimate for blocks of size 2^( 7) =       0.000276102515
  error estimate for blocks of size 2^( 8) =       0.000277359885
  error estimate for blocks of size 2^( 9) =       0.000278695046

      target function =                  N/A
              le_mean =     -22.824580812387
             les_mean =     521.460448166285
             stat err =       0.000276847162
             autocorr =       1.268089526128
              std dev =       0.695360650534
             le_variance =       0.483526434311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245847116
  error estimate for blocks of size 2^( 2) =       0.000255122307
  error estimate for blocks of size 2^( 3) =       0.000263448868
  error estimate for blocks of size 2^( 4) =       0.000269335915
  error estimate for blocks of size 2^( 5) =       0.000272998203
  error estimate for blocks of size 2^( 6) =       0.000275231200
  error estimate for blocks of size 2^( 7) =       0.000276102515
  error estimate for blocks of size 2^( 8) =       0.000277359885
  error estimate for blocks of size 2^( 9) =       0.000278695046

      target function =                  N/A
              le_mean =     -22.824580812387
             les_mean =     521.460448166285
             stat err =       0.000276847162
             autocorr =       1.268089526128
              std dev =       0.695360650534
             le_variance =       0.483526434311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245847116
  error estimate for blocks of size 2^( 2) =       0.000255122307
  error estimate for blocks of size 2^( 3) =       0.000263448868
  error estimate for blocks of size 2^( 4) =       0.000269335915
  error estimate for blocks of size 2^( 5) =       0.000272998203
  error estimate for blocks of size 2^( 6) =       0.000275231200
  error estimate for blocks of size 2^( 7) =       0.000276102515
  error estimate for blocks of size 2^( 8) =       0.000277359885
  error estimate for blocks of size 2^( 9) =       0.000278695046

      target function =                  N/A
              le_mean =     -22.824580812387
             les_mean =     521.460448166285
             stat err =       0.000276847162
             autocorr =       1.268089526128
              std dev =       0.695360650534
             le_variance =       0.483526434311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483523040457
                                         uncertainty =       0.001713236648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245847116
  error estimate for blocks of size 2^( 2) =       0.000255122307
  error estimate for blocks of size 2^( 3) =       0.000263448868
  error estimate for blocks of size 2^( 4) =       0.000269335915
  error estimate for blocks of size 2^( 5) =       0.000272998203
  error estimate for blocks of size 2^( 6) =       0.000275231200
  error estimate for blocks of size 2^( 7) =       0.000276102515
  error estimate for blocks of size 2^( 8) =       0.000277359885
  error estimate for blocks of size 2^( 9) =       0.000278695046

      target function =                  N/A
              le_mean =     -22.824580812387
             les_mean =     521.460448166285
             stat err =       0.000276847162
             autocorr =       1.268089526128
              std dev =       0.695360650534
             le_variance =       0.483526434311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824580812387        initial  <--
     3.9062e+16     3.9062e+17             0.0000e+00       -22.824580812387
     1.5625e+17     1.5625e+18             0.0000e+00       -22.824580812387
     6.2500e+17     6.2500e+18             0.0000e+00       -22.824580812387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.8550
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8796e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7629
    reference variance = 0.217449
====================================================
  Execution time = 9.8333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1385e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9929e-01
  Total weights = 7.856516959e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8206e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483280009244
                                         uncertainty =       0.001340916674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483280009244
                                         uncertainty =       0.001340916674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245784545
  error estimate for blocks of size 2^( 2) =       0.000255054865
  error estimate for blocks of size 2^( 3) =       0.000263334268
  error estimate for blocks of size 2^( 4) =       0.000269347439
  error estimate for blocks of size 2^( 5) =       0.000272820131
  error estimate for blocks of size 2^( 6) =       0.000274860005
  error estimate for blocks of size 2^( 7) =       0.000275371475
  error estimate for blocks of size 2^( 8) =       0.000277123676
  error estimate for blocks of size 2^( 9) =       0.000278473281

      target function =                  N/A
              le_mean =     -22.824720884189
             les_mean =     521.467174820882
             stat err =       0.000276457109
             autocorr =       1.265162710442
              std dev =       0.695183673566
             le_variance =       0.483280339993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282472088419e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824720884187       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824720884187       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+18, overlap shift 1.5625e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824720884187       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824720884187       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824720884187       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824720884187       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1655e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7927
    reference variance = 0.414758
====================================================
  Execution time = 1.0178e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9956e-01
  Total weights = 7.8568e+06
  Execution time = 1.4128e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245716717
  error estimate for blocks of size 2^( 2) =       0.000254865870
  error estimate for blocks of size 2^( 3) =       0.000263066730
  error estimate for blocks of size 2^( 4) =       0.000268933460
  error estimate for blocks of size 2^( 5) =       0.000272539765
  error estimate for blocks of size 2^( 6) =       0.000274791697
  error estimate for blocks of size 2^( 7) =       0.000275946007
  error estimate for blocks of size 2^( 8) =       0.000275566185
  error estimate for blocks of size 2^( 9) =       0.000274812305

      target function =                  N/A
              le_mean =     -22.824517611527
             les_mean =     521.458168878853
             stat err =       0.000275279048
             autocorr =       1.255095894038
              std dev =       0.694991826785
             le_variance =       0.483013639298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245716717
  error estimate for blocks of size 2^( 2) =       0.000254865870
  error estimate for blocks of size 2^( 3) =       0.000263066730
  error estimate for blocks of size 2^( 4) =       0.000268933460
  error estimate for blocks of size 2^( 5) =       0.000272539765
  error estimate for blocks of size 2^( 6) =       0.000274791697
  error estimate for blocks of size 2^( 7) =       0.000275946007
  error estimate for blocks of size 2^( 8) =       0.000275566185
  error estimate for blocks of size 2^( 9) =       0.000274812305

      target function =                  N/A
              le_mean =     -22.824517611527
             les_mean =     521.458168878853
             stat err =       0.000275279048
             autocorr =       1.255095894038
              std dev =       0.694991826785
             le_variance =       0.483013639298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245716717
  error estimate for blocks of size 2^( 2) =       0.000254865870
  error estimate for blocks of size 2^( 3) =       0.000263066730
  error estimate for blocks of size 2^( 4) =       0.000268933460
  error estimate for blocks of size 2^( 5) =       0.000272539765
  error estimate for blocks of size 2^( 6) =       0.000274791697
  error estimate for blocks of size 2^( 7) =       0.000275946007
  error estimate for blocks of size 2^( 8) =       0.000275566185
  error estimate for blocks of size 2^( 9) =       0.000274812305

      target function =                  N/A
              le_mean =     -22.824517611527
             les_mean =     521.458168878853
             stat err =       0.000275279048
             autocorr =       1.255095894038
              std dev =       0.694991826785
             le_variance =       0.483013639298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483012107543
                                         uncertainty =       0.001112221298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245716717
  error estimate for blocks of size 2^( 2) =       0.000254865870
  error estimate for blocks of size 2^( 3) =       0.000263066730
  error estimate for blocks of size 2^( 4) =       0.000268933460
  error estimate for blocks of size 2^( 5) =       0.000272539765
  error estimate for blocks of size 2^( 6) =       0.000274791697
  error estimate for blocks of size 2^( 7) =       0.000275946007
  error estimate for blocks of size 2^( 8) =       0.000275566185
  error estimate for blocks of size 2^( 9) =       0.000274812305

      target function =                  N/A
              le_mean =     -22.824517611527
             les_mean =     521.458168878853
             stat err =       0.000275279048
             autocorr =       1.255095894038
              std dev =       0.694991826785
             le_variance =       0.483013639298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824517611527        initial  <--
     3.9062e+17     3.9062e+18             0.0000e+00       -22.824517611527
     1.5625e+18     1.5625e+19             0.0000e+00       -22.824517611527
     6.2500e+18     6.2500e+19             0.0000e+00       -22.824517611527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.9738
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8954e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7302
    reference variance = 0.340989
====================================================
  Execution time = 9.9203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1446e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9872e-01
  Total weights = 7.857381915e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8169e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483097821399
                                         uncertainty =       0.001288074718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483097821399
                                         uncertainty =       0.001288074718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245738589
  error estimate for blocks of size 2^( 2) =       0.000254938184
  error estimate for blocks of size 2^( 3) =       0.000263258192
  error estimate for blocks of size 2^( 4) =       0.000269194572
  error estimate for blocks of size 2^( 5) =       0.000272513530
  error estimate for blocks of size 2^( 6) =       0.000274103731
  error estimate for blocks of size 2^( 7) =       0.000274651584
  error estimate for blocks of size 2^( 8) =       0.000274389557
  error estimate for blocks of size 2^( 9) =       0.000275021663

      target function =                  N/A
              le_mean =     -22.824437820481
             les_mean =     521.453685801493
             stat err =       0.000274541634
             autocorr =       1.248158409918
              std dev =       0.695053690123
             le_variance =       0.483099632153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282443782048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824437820479       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824437820479       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+19, overlap shift 1.5625e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824437820479       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824437820479       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824437820479       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824437820479       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1738e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8621
    reference variance = 0.378301
====================================================
  Execution time = 1.0056e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0340e-01
  Total weights = 7.8568e+06
  Execution time = 1.4100e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246964121
  error estimate for blocks of size 2^( 2) =       0.000256204914
  error estimate for blocks of size 2^( 3) =       0.000264567230
  error estimate for blocks of size 2^( 4) =       0.000270431764
  error estimate for blocks of size 2^( 5) =       0.000273894762
  error estimate for blocks of size 2^( 6) =       0.000275607581
  error estimate for blocks of size 2^( 7) =       0.000276331390
  error estimate for blocks of size 2^( 8) =       0.000276296939
  error estimate for blocks of size 2^( 9) =       0.000275626948

      target function =                  N/A
              le_mean =     -22.824297556568
             les_mean =     521.451963421420
             stat err =       0.000275965715
             autocorr =       1.248655210272
              std dev =       0.698520017322
             le_variance =       0.487930214599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246964121
  error estimate for blocks of size 2^( 2) =       0.000256204914
  error estimate for blocks of size 2^( 3) =       0.000264567230
  error estimate for blocks of size 2^( 4) =       0.000270431764
  error estimate for blocks of size 2^( 5) =       0.000273894762
  error estimate for blocks of size 2^( 6) =       0.000275607581
  error estimate for blocks of size 2^( 7) =       0.000276331390
  error estimate for blocks of size 2^( 8) =       0.000276296939
  error estimate for blocks of size 2^( 9) =       0.000275626948

      target function =                  N/A
              le_mean =     -22.824297556568
             les_mean =     521.451963421420
             stat err =       0.000275965715
             autocorr =       1.248655210272
              std dev =       0.698520017322
             le_variance =       0.487930214599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246964121
  error estimate for blocks of size 2^( 2) =       0.000256204914
  error estimate for blocks of size 2^( 3) =       0.000264567230
  error estimate for blocks of size 2^( 4) =       0.000270431764
  error estimate for blocks of size 2^( 5) =       0.000273894762
  error estimate for blocks of size 2^( 6) =       0.000275607581
  error estimate for blocks of size 2^( 7) =       0.000276331390
  error estimate for blocks of size 2^( 8) =       0.000276296939
  error estimate for blocks of size 2^( 9) =       0.000275626948

      target function =                  N/A
              le_mean =     -22.824297556568
             les_mean =     521.451963421420
             stat err =       0.000275965715
             autocorr =       1.248655210272
              std dev =       0.698520017322
             le_variance =       0.487930214599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487923993663
                                         uncertainty =       0.002934428941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246964121
  error estimate for blocks of size 2^( 2) =       0.000256204914
  error estimate for blocks of size 2^( 3) =       0.000264567230
  error estimate for blocks of size 2^( 4) =       0.000270431764
  error estimate for blocks of size 2^( 5) =       0.000273894762
  error estimate for blocks of size 2^( 6) =       0.000275607581
  error estimate for blocks of size 2^( 7) =       0.000276331390
  error estimate for blocks of size 2^( 8) =       0.000276296939
  error estimate for blocks of size 2^( 9) =       0.000275626948

      target function =                  N/A
              le_mean =     -22.824297556568
             les_mean =     521.451963421420
             stat err =       0.000275965715
             autocorr =       1.248655210272
              std dev =       0.698520017322
             le_variance =       0.487930214599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824297556568        initial  <--
     3.9062e+18     3.9062e+19             0.0000e+00       -22.824297556568
     1.5625e+19     1.5625e+20             0.0000e+00       -22.824297556568
     6.2500e+19     6.2500e+20             0.0000e+00       -22.824297556568

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.7001
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8909e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8184
    reference variance = 0.639345
====================================================
  Execution time = 9.8967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1358e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0109e-01
  Total weights = 7.856809873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8122e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483699470093
                                         uncertainty =       0.001264823012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483699470093
                                         uncertainty =       0.001264823012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245891383
  error estimate for blocks of size 2^( 2) =       0.000255116408
  error estimate for blocks of size 2^( 3) =       0.000263351627
  error estimate for blocks of size 2^( 4) =       0.000269366679
  error estimate for blocks of size 2^( 5) =       0.000273234129
  error estimate for blocks of size 2^( 6) =       0.000275361173
  error estimate for blocks of size 2^( 7) =       0.000276633647
  error estimate for blocks of size 2^( 8) =       0.000276856972
  error estimate for blocks of size 2^( 9) =       0.000277237406

      target function =                  N/A
              le_mean =     -22.824847800023
             les_mean =     521.474764346049
             stat err =       0.000276522300
             autocorr =       1.264659760880
              std dev =       0.695485858054
             le_variance =       0.483700578753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282484780002e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824847800013       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824847800013       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824847800019       residual = 1.73e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824847800013       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+19 is 6.004066e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+20, overlap shift 1.5625e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824847800013       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824847800013       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824847800027       residual = 1.73e+04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824847800013       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+20 is 1.501017e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824847800013       residual = 6.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824847800013       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824847800001       residual = 1.73e+04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+20 is 3.752541e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1710e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8154
    reference variance = 0.246395
====================================================
  Execution time = 1.0034e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0005e-01
  Total weights = 7.8570e+06
  Execution time = 1.4084e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246118865
  error estimate for blocks of size 2^( 2) =       0.000255377128
  error estimate for blocks of size 2^( 3) =       0.000263802796
  error estimate for blocks of size 2^( 4) =       0.000269862362
  error estimate for blocks of size 2^( 5) =       0.000273458590
  error estimate for blocks of size 2^( 6) =       0.000275393813
  error estimate for blocks of size 2^( 7) =       0.000276377524
  error estimate for blocks of size 2^( 8) =       0.000275900307
  error estimate for blocks of size 2^( 9) =       0.000276419831

      target function =                  N/A
              le_mean =     -22.824655347623
             les_mean =     521.464943437313
             stat err =       0.000276022869
             autocorr =       1.257767364468
              std dev =       0.696129274717
             le_variance =       0.484595967118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246118865
  error estimate for blocks of size 2^( 2) =       0.000255377128
  error estimate for blocks of size 2^( 3) =       0.000263802796
  error estimate for blocks of size 2^( 4) =       0.000269862362
  error estimate for blocks of size 2^( 5) =       0.000273458590
  error estimate for blocks of size 2^( 6) =       0.000275393813
  error estimate for blocks of size 2^( 7) =       0.000276377524
  error estimate for blocks of size 2^( 8) =       0.000275900307
  error estimate for blocks of size 2^( 9) =       0.000276419831

      target function =                  N/A
              le_mean =     -22.824655347623
             les_mean =     521.464943437313
             stat err =       0.000276022869
             autocorr =       1.257767364468
              std dev =       0.696129274717
             le_variance =       0.484595967118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246118865
  error estimate for blocks of size 2^( 2) =       0.000255377128
  error estimate for blocks of size 2^( 3) =       0.000263802796
  error estimate for blocks of size 2^( 4) =       0.000269862362
  error estimate for blocks of size 2^( 5) =       0.000273458590
  error estimate for blocks of size 2^( 6) =       0.000275393813
  error estimate for blocks of size 2^( 7) =       0.000276377524
  error estimate for blocks of size 2^( 8) =       0.000275900307
  error estimate for blocks of size 2^( 9) =       0.000276419831

      target function =                  N/A
              le_mean =     -22.824655347623
             les_mean =     521.464943437313
             stat err =       0.000276022869
             autocorr =       1.257767364468
              std dev =       0.696129274717
             le_variance =       0.484595967118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484595813848
                                         uncertainty =       0.001525854555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246118865
  error estimate for blocks of size 2^( 2) =       0.000255377128
  error estimate for blocks of size 2^( 3) =       0.000263802796
  error estimate for blocks of size 2^( 4) =       0.000269862362
  error estimate for blocks of size 2^( 5) =       0.000273458590
  error estimate for blocks of size 2^( 6) =       0.000275393813
  error estimate for blocks of size 2^( 7) =       0.000276377524
  error estimate for blocks of size 2^( 8) =       0.000275900307
  error estimate for blocks of size 2^( 9) =       0.000276419831

      target function =                  N/A
              le_mean =     -22.824655347623
             les_mean =     521.464943437313
             stat err =       0.000276022869
             autocorr =       1.257767364468
              std dev =       0.696129274717
             le_variance =       0.484595967118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824655347623        initial  <--
     3.9062e+19     3.9062e+20             6.0041e-24       -22.824655347623
     1.5625e+20     1.5625e+21             1.5010e-24       -22.824655347623
     6.2500e+20     6.2500e+21             3.7525e-25       -22.824655347623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.8066
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9191e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.731
    reference variance = 0.351265
====================================================
  Execution time = 9.8931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1390e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0100e-01
  Total weights = 7.857250525e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8221e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484334427519
                                         uncertainty =       0.001452109243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484334427519
                                         uncertainty =       0.001452109243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246053075
  error estimate for blocks of size 2^( 2) =       0.000255186803
  error estimate for blocks of size 2^( 3) =       0.000263470190
  error estimate for blocks of size 2^( 4) =       0.000269597645
  error estimate for blocks of size 2^( 5) =       0.000273070732
  error estimate for blocks of size 2^( 6) =       0.000274752071
  error estimate for blocks of size 2^( 7) =       0.000275752816
  error estimate for blocks of size 2^( 8) =       0.000276135480
  error estimate for blocks of size 2^( 9) =       0.000277529206

      target function =                  N/A
              le_mean =     -22.824487835576
             les_mean =     521.458242020949
             stat err =       0.000276042393
             autocorr =       1.258618099117
              std dev =       0.695943191861
             le_variance =       0.484336926298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282448783558e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824487835573       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487835573       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824487835573       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+20 is 5.422290e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+21, overlap shift 1.5625e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824487835573       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487835573       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824487835573       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+21 is 1.355573e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824487835573       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487835573       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824487835573       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+21 is 3.388931e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1717e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8441
    reference variance = 0.434494
====================================================
  Execution time = 1.0023e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0032e-01
  Total weights = 7.8568e+06
  Execution time = 1.4160e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245880183
  error estimate for blocks of size 2^( 2) =       0.000255021813
  error estimate for blocks of size 2^( 3) =       0.000263283796
  error estimate for blocks of size 2^( 4) =       0.000269297500
  error estimate for blocks of size 2^( 5) =       0.000272897505
  error estimate for blocks of size 2^( 6) =       0.000274928682
  error estimate for blocks of size 2^( 7) =       0.000275774210
  error estimate for blocks of size 2^( 8) =       0.000277030036
  error estimate for blocks of size 2^( 9) =       0.000278968570

      target function =                  N/A
              le_mean =     -22.824507916177
             les_mean =     521.458486582640
             stat err =       0.000276675374
             autocorr =       1.266175651616
              std dev =       0.695454178366
             le_variance =       0.483656514207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245880183
  error estimate for blocks of size 2^( 2) =       0.000255021813
  error estimate for blocks of size 2^( 3) =       0.000263283796
  error estimate for blocks of size 2^( 4) =       0.000269297500
  error estimate for blocks of size 2^( 5) =       0.000272897505
  error estimate for blocks of size 2^( 6) =       0.000274928682
  error estimate for blocks of size 2^( 7) =       0.000275774210
  error estimate for blocks of size 2^( 8) =       0.000277030036
  error estimate for blocks of size 2^( 9) =       0.000278968570

      target function =                  N/A
              le_mean =     -22.824507916177
             les_mean =     521.458486582640
             stat err =       0.000276675374
             autocorr =       1.266175651616
              std dev =       0.695454178366
             le_variance =       0.483656514207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245880183
  error estimate for blocks of size 2^( 2) =       0.000255021813
  error estimate for blocks of size 2^( 3) =       0.000263283796
  error estimate for blocks of size 2^( 4) =       0.000269297500
  error estimate for blocks of size 2^( 5) =       0.000272897505
  error estimate for blocks of size 2^( 6) =       0.000274928682
  error estimate for blocks of size 2^( 7) =       0.000275774210
  error estimate for blocks of size 2^( 8) =       0.000277030036
  error estimate for blocks of size 2^( 9) =       0.000278968570

      target function =                  N/A
              le_mean =     -22.824507916177
             les_mean =     521.458486582640
             stat err =       0.000276675374
             autocorr =       1.266175651616
              std dev =       0.695454178366
             le_variance =       0.483656514207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653685629
                                         uncertainty =       0.001133446558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245880183
  error estimate for blocks of size 2^( 2) =       0.000255021813
  error estimate for blocks of size 2^( 3) =       0.000263283796
  error estimate for blocks of size 2^( 4) =       0.000269297500
  error estimate for blocks of size 2^( 5) =       0.000272897505
  error estimate for blocks of size 2^( 6) =       0.000274928682
  error estimate for blocks of size 2^( 7) =       0.000275774210
  error estimate for blocks of size 2^( 8) =       0.000277030036
  error estimate for blocks of size 2^( 9) =       0.000278968570

      target function =                  N/A
              le_mean =     -22.824507916177
             les_mean =     521.458486582640
             stat err =       0.000276675374
             autocorr =       1.266175651616
              std dev =       0.695454178366
             le_variance =       0.483656514207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824507916177        initial  <--
     3.9062e+20     3.9062e+21             5.4223e-25       -22.824507916177
     1.5625e+21     1.5625e+22             1.3556e-25       -22.824507916177
     6.2500e+21     6.2500e+22             3.3889e-26       -22.824507916177

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.4911
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8866e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.9518
    reference variance = 1.64331
====================================================
  Execution time = 9.8915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1371e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0234e-01
  Total weights = 7.856887530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8226e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486536145698
                                         uncertainty =       0.002966458048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486536145698
                                         uncertainty =       0.002966458048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246611358
  error estimate for blocks of size 2^( 2) =       0.000255740526
  error estimate for blocks of size 2^( 3) =       0.000264014598
  error estimate for blocks of size 2^( 4) =       0.000269973479
  error estimate for blocks of size 2^( 5) =       0.000273410835
  error estimate for blocks of size 2^( 6) =       0.000275327606
  error estimate for blocks of size 2^( 7) =       0.000275725898
  error estimate for blocks of size 2^( 8) =       0.000275386509
  error estimate for blocks of size 2^( 9) =       0.000276819917

      target function =                  N/A
              le_mean =     -22.824182711813
             les_mean =     521.445653217671
             stat err =       0.000275814982
             autocorr =       1.250862454958
              std dev =       0.697522254821
             le_variance =       0.486537295970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282418271181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824182711808       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824182711808       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+22, overlap shift 1.5625e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824182711808       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824182711808       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824182711808       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824182711808       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1715e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7117
    reference variance = 1.11007
====================================================
  Execution time = 1.0029e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0033e-01
  Total weights = 7.8570e+06
  Execution time = 1.4127e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245982219
  error estimate for blocks of size 2^( 2) =       0.000255309389
  error estimate for blocks of size 2^( 3) =       0.000263543214
  error estimate for blocks of size 2^( 4) =       0.000269563238
  error estimate for blocks of size 2^( 5) =       0.000273048836
  error estimate for blocks of size 2^( 6) =       0.000275536968
  error estimate for blocks of size 2^( 7) =       0.000276540298
  error estimate for blocks of size 2^( 8) =       0.000277477479
  error estimate for blocks of size 2^( 9) =       0.000278534901

      target function =                  N/A
              le_mean =     -22.824465818339
             les_mean =     521.456565330623
             stat err =       0.000277022412
             autocorr =       1.268301135991
              std dev =       0.695742780280
             le_variance =       0.484058016312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245982219
  error estimate for blocks of size 2^( 2) =       0.000255309389
  error estimate for blocks of size 2^( 3) =       0.000263543214
  error estimate for blocks of size 2^( 4) =       0.000269563238
  error estimate for blocks of size 2^( 5) =       0.000273048836
  error estimate for blocks of size 2^( 6) =       0.000275536968
  error estimate for blocks of size 2^( 7) =       0.000276540298
  error estimate for blocks of size 2^( 8) =       0.000277477479
  error estimate for blocks of size 2^( 9) =       0.000278534901

      target function =                  N/A
              le_mean =     -22.824465818339
             les_mean =     521.456565330623
             stat err =       0.000277022412
             autocorr =       1.268301135991
              std dev =       0.695742780280
             le_variance =       0.484058016312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245982219
  error estimate for blocks of size 2^( 2) =       0.000255309389
  error estimate for blocks of size 2^( 3) =       0.000263543214
  error estimate for blocks of size 2^( 4) =       0.000269563238
  error estimate for blocks of size 2^( 5) =       0.000273048836
  error estimate for blocks of size 2^( 6) =       0.000275536968
  error estimate for blocks of size 2^( 7) =       0.000276540298
  error estimate for blocks of size 2^( 8) =       0.000277477479
  error estimate for blocks of size 2^( 9) =       0.000278534901

      target function =                  N/A
              le_mean =     -22.824465818339
             les_mean =     521.456565330623
             stat err =       0.000277022412
             autocorr =       1.268301135991
              std dev =       0.695742780280
             le_variance =       0.484058016312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484054639518
                                         uncertainty =       0.001551869657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245982219
  error estimate for blocks of size 2^( 2) =       0.000255309389
  error estimate for blocks of size 2^( 3) =       0.000263543214
  error estimate for blocks of size 2^( 4) =       0.000269563238
  error estimate for blocks of size 2^( 5) =       0.000273048836
  error estimate for blocks of size 2^( 6) =       0.000275536968
  error estimate for blocks of size 2^( 7) =       0.000276540298
  error estimate for blocks of size 2^( 8) =       0.000277477479
  error estimate for blocks of size 2^( 9) =       0.000278534901

      target function =                  N/A
              le_mean =     -22.824465818339
             les_mean =     521.456565330623
             stat err =       0.000277022412
             autocorr =       1.268301135991
              std dev =       0.695742780280
             le_variance =       0.484058016312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824465818339        initial  <--
     3.9062e+21     3.9062e+22             0.0000e+00       -22.824465818339
     1.5625e+22     1.5625e+23             0.0000e+00       -22.824465818339
     6.2500e+22     6.2500e+23             0.0000e+00       -22.824465818339

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.6823
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8884e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.899
    reference variance = 0.504907
====================================================
  Execution time = 9.8919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1339e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9979e-01
  Total weights = 7.857311547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8207e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484323827423
                                         uncertainty =       0.001255980172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484323827423
                                         uncertainty =       0.001255980172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246049600
  error estimate for blocks of size 2^( 2) =       0.000255134906
  error estimate for blocks of size 2^( 3) =       0.000263340331
  error estimate for blocks of size 2^( 4) =       0.000269273258
  error estimate for blocks of size 2^( 5) =       0.000272928806
  error estimate for blocks of size 2^( 6) =       0.000275126462
  error estimate for blocks of size 2^( 7) =       0.000276287182
  error estimate for blocks of size 2^( 8) =       0.000276571437
  error estimate for blocks of size 2^( 9) =       0.000277647790

      target function =                  N/A
              le_mean =     -22.824648224776
             les_mean =     521.464354222950
             stat err =       0.000276408218
             autocorr =       1.261991916504
              std dev =       0.695933363569
             le_variance =       0.484323246529


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282464822478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824648224774       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824648224774       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+23, overlap shift 1.5625e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824648224774       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824648224774       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824648224774       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824648224774       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1714e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7558
    reference variance = 0.42312
====================================================
  Execution time = 1.0031e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9933e-01
  Total weights = 7.8567e+06
  Execution time = 1.4102e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245926989
  error estimate for blocks of size 2^( 2) =       0.000255138211
  error estimate for blocks of size 2^( 3) =       0.000263459985
  error estimate for blocks of size 2^( 4) =       0.000269172664
  error estimate for blocks of size 2^( 5) =       0.000272687290
  error estimate for blocks of size 2^( 6) =       0.000274351400
  error estimate for blocks of size 2^( 7) =       0.000275509013
  error estimate for blocks of size 2^( 8) =       0.000276874555
  error estimate for blocks of size 2^( 9) =       0.000276875007

      target function =                  N/A
              le_mean =     -22.824403191026
             les_mean =     521.452713745128
             stat err =       0.000275902494
             autocorr =       1.258632277854
              std dev =       0.695586567326
             le_variance =       0.483840672644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245926989
  error estimate for blocks of size 2^( 2) =       0.000255138211
  error estimate for blocks of size 2^( 3) =       0.000263459985
  error estimate for blocks of size 2^( 4) =       0.000269172664
  error estimate for blocks of size 2^( 5) =       0.000272687290
  error estimate for blocks of size 2^( 6) =       0.000274351400
  error estimate for blocks of size 2^( 7) =       0.000275509013
  error estimate for blocks of size 2^( 8) =       0.000276874555
  error estimate for blocks of size 2^( 9) =       0.000276875007

      target function =                  N/A
              le_mean =     -22.824403191026
             les_mean =     521.452713745128
             stat err =       0.000275902494
             autocorr =       1.258632277854
              std dev =       0.695586567326
             le_variance =       0.483840672644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245926989
  error estimate for blocks of size 2^( 2) =       0.000255138211
  error estimate for blocks of size 2^( 3) =       0.000263459985
  error estimate for blocks of size 2^( 4) =       0.000269172664
  error estimate for blocks of size 2^( 5) =       0.000272687290
  error estimate for blocks of size 2^( 6) =       0.000274351400
  error estimate for blocks of size 2^( 7) =       0.000275509013
  error estimate for blocks of size 2^( 8) =       0.000276874555
  error estimate for blocks of size 2^( 9) =       0.000276875007

      target function =                  N/A
              le_mean =     -22.824403191026
             les_mean =     521.452713745128
             stat err =       0.000275902494
             autocorr =       1.258632277854
              std dev =       0.695586567326
             le_variance =       0.483840672644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483842248206
                                         uncertainty =       0.001477742532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245926989
  error estimate for blocks of size 2^( 2) =       0.000255138211
  error estimate for blocks of size 2^( 3) =       0.000263459985
  error estimate for blocks of size 2^( 4) =       0.000269172664
  error estimate for blocks of size 2^( 5) =       0.000272687290
  error estimate for blocks of size 2^( 6) =       0.000274351400
  error estimate for blocks of size 2^( 7) =       0.000275509013
  error estimate for blocks of size 2^( 8) =       0.000276874555
  error estimate for blocks of size 2^( 9) =       0.000276875007

      target function =                  N/A
              le_mean =     -22.824403191026
             les_mean =     521.452713745128
             stat err =       0.000275902494
             autocorr =       1.258632277854
              std dev =       0.695586567326
             le_variance =       0.483840672644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824403191026        initial  <--
     3.9062e+22     3.9062e+23             0.0000e+00       -22.824403191026
     1.5625e+23     1.5625e+24             0.0000e+00       -22.824403191026
     6.2500e+23     6.2500e+24             0.0000e+00       -22.824403191026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.1493
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8829e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.9006
    reference variance = 0.425549
====================================================
  Execution time = 1.0048e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1407e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0361e-01
  Total weights = 7.857148480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8152e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484982444330
                                         uncertainty =       0.001434897002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484982444330
                                         uncertainty =       0.001434897002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217787
  error estimate for blocks of size 2^( 2) =       0.000255299829
  error estimate for blocks of size 2^( 3) =       0.000263579019
  error estimate for blocks of size 2^( 4) =       0.000269481898
  error estimate for blocks of size 2^( 5) =       0.000272672442
  error estimate for blocks of size 2^( 6) =       0.000274240478
  error estimate for blocks of size 2^( 7) =       0.000274580571
  error estimate for blocks of size 2^( 8) =       0.000275988546
  error estimate for blocks of size 2^( 9) =       0.000275841756

      target function =                  N/A
              le_mean =     -22.824429120536
             les_mean =     521.458173622351
             stat err =       0.000275162837
             autocorr =       1.248937515445
              std dev =       0.696409067589
             le_variance =       0.484985589420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282442912054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824429120531       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824429120531       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+24, overlap shift 1.5625e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824429120531       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824429120531       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824429120531       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824429120531       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1864e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7894
    reference variance = 0.4137
====================================================
  Execution time = 1.0015e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0848e-01
  Total weights = 7.8561e+06
  Execution time = 1.4126e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247703067
  error estimate for blocks of size 2^( 2) =       0.000256873348
  error estimate for blocks of size 2^( 3) =       0.000265190456
  error estimate for blocks of size 2^( 4) =       0.000271113614
  error estimate for blocks of size 2^( 5) =       0.000274150923
  error estimate for blocks of size 2^( 6) =       0.000276285471
  error estimate for blocks of size 2^( 7) =       0.000277099739
  error estimate for blocks of size 2^( 8) =       0.000277639789
  error estimate for blocks of size 2^( 9) =       0.000278847268

      target function =                  N/A
              le_mean =     -22.824202034174
             les_mean =     521.452679979397
             stat err =       0.000277468067
             autocorr =       1.254767460861
              std dev =       0.700610074670
             le_variance =       0.490854476729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247703067
  error estimate for blocks of size 2^( 2) =       0.000256873348
  error estimate for blocks of size 2^( 3) =       0.000265190456
  error estimate for blocks of size 2^( 4) =       0.000271113614
  error estimate for blocks of size 2^( 5) =       0.000274150923
  error estimate for blocks of size 2^( 6) =       0.000276285471
  error estimate for blocks of size 2^( 7) =       0.000277099739
  error estimate for blocks of size 2^( 8) =       0.000277639789
  error estimate for blocks of size 2^( 9) =       0.000278847268

      target function =                  N/A
              le_mean =     -22.824202034174
             les_mean =     521.452679979397
             stat err =       0.000277468067
             autocorr =       1.254767460861
              std dev =       0.700610074670
             le_variance =       0.490854476729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247703067
  error estimate for blocks of size 2^( 2) =       0.000256873348
  error estimate for blocks of size 2^( 3) =       0.000265190456
  error estimate for blocks of size 2^( 4) =       0.000271113614
  error estimate for blocks of size 2^( 5) =       0.000274150923
  error estimate for blocks of size 2^( 6) =       0.000276285471
  error estimate for blocks of size 2^( 7) =       0.000277099739
  error estimate for blocks of size 2^( 8) =       0.000277639789
  error estimate for blocks of size 2^( 9) =       0.000278847268

      target function =                  N/A
              le_mean =     -22.824202034174
             les_mean =     521.452679979397
             stat err =       0.000277468067
             autocorr =       1.254767460861
              std dev =       0.700610074670
             le_variance =       0.490854476729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490850618533
                                         uncertainty =       0.002294815708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247703067
  error estimate for blocks of size 2^( 2) =       0.000256873348
  error estimate for blocks of size 2^( 3) =       0.000265190456
  error estimate for blocks of size 2^( 4) =       0.000271113614
  error estimate for blocks of size 2^( 5) =       0.000274150923
  error estimate for blocks of size 2^( 6) =       0.000276285471
  error estimate for blocks of size 2^( 7) =       0.000277099739
  error estimate for blocks of size 2^( 8) =       0.000277639789
  error estimate for blocks of size 2^( 9) =       0.000278847268

      target function =                  N/A
              le_mean =     -22.824202034174
             les_mean =     521.452679979397
             stat err =       0.000277468067
             autocorr =       1.254767460861
              std dev =       0.700610074670
             le_variance =       0.490854476729


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824202034174        initial  <--
     3.9062e+23     3.9062e+24             0.0000e+00       -22.824202034174
     1.5625e+24     1.5625e+25             0.0000e+00       -22.824202034174
     6.2500e+24     6.2500e+25             0.0000e+00       -22.824202034174

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.0446
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8971e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7509
    reference variance = 0.301237
====================================================
  Execution time = 1.0073e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1359e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0004e-01
  Total weights = 7.857020923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8179e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653018931
                                         uncertainty =       0.001341118288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483653018931
                                         uncertainty =       0.001341118288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245879810
  error estimate for blocks of size 2^( 2) =       0.000255111706
  error estimate for blocks of size 2^( 3) =       0.000263419844
  error estimate for blocks of size 2^( 4) =       0.000269319553
  error estimate for blocks of size 2^( 5) =       0.000272949767
  error estimate for blocks of size 2^( 6) =       0.000274905731
  error estimate for blocks of size 2^( 7) =       0.000275178391
  error estimate for blocks of size 2^( 8) =       0.000275780376
  error estimate for blocks of size 2^( 9) =       0.000275566033

      target function =                  N/A
              le_mean =     -22.824534982832
             les_mean =     521.459433420605
             stat err =       0.000275357633
             autocorr =       1.254147162740
              std dev =       0.695453124877
             le_variance =       0.483655048902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282453498283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824534982825       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824534982825       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5625e+25, overlap shift 1.5625e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824534982825       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824534982825       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+25 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824534982825       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824534982825       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1892e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7959
    reference variance = 0.2998
====================================================
  Execution time = 9.8903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0400e-01
  Total weights = 7.8559e+06
  Execution time = 1.4211e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246434130
  error estimate for blocks of size 2^( 2) =       0.000255654146
  error estimate for blocks of size 2^( 3) =       0.000263914266
  error estimate for blocks of size 2^( 4) =       0.000269720378
  error estimate for blocks of size 2^( 5) =       0.000273466495
  error estimate for blocks of size 2^( 6) =       0.000275133082
  error estimate for blocks of size 2^( 7) =       0.000276181000
  error estimate for blocks of size 2^( 8) =       0.000275824667
  error estimate for blocks of size 2^( 9) =       0.000276739808

      target function =                  N/A
              le_mean =     -22.824773043395
             les_mean =     521.474263690253
             stat err =       0.000275969639
             autocorr =       1.254067470433
              std dev =       0.697020976344
             le_variance =       0.485838241464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246434130
  error estimate for blocks of size 2^( 2) =       0.000255654146
  error estimate for blocks of size 2^( 3) =       0.000263914266
  error estimate for blocks of size 2^( 4) =       0.000269720378
  error estimate for blocks of size 2^( 5) =       0.000273466495
  error estimate for blocks of size 2^( 6) =       0.000275133082
  error estimate for blocks of size 2^( 7) =       0.000276181000
  error estimate for blocks of size 2^( 8) =       0.000275824667
  error estimate for blocks of size 2^( 9) =       0.000276739808

      target function =                  N/A
              le_mean =     -22.824773043395
             les_mean =     521.474263690253
             stat err =       0.000275969639
             autocorr =       1.254067470433
              std dev =       0.697020976344
             le_variance =       0.485838241464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246434130
  error estimate for blocks of size 2^( 2) =       0.000255654146
  error estimate for blocks of size 2^( 3) =       0.000263914266
  error estimate for blocks of size 2^( 4) =       0.000269720378
  error estimate for blocks of size 2^( 5) =       0.000273466495
  error estimate for blocks of size 2^( 6) =       0.000275133082
  error estimate for blocks of size 2^( 7) =       0.000276181000
  error estimate for blocks of size 2^( 8) =       0.000275824667
  error estimate for blocks of size 2^( 9) =       0.000276739808

      target function =                  N/A
              le_mean =     -22.824773043395
             les_mean =     521.474263690253
             stat err =       0.000275969639
             autocorr =       1.254067470433
              std dev =       0.697020976344
             le_variance =       0.485838241464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485839097436
                                         uncertainty =       0.001524226655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246434130
  error estimate for blocks of size 2^( 2) =       0.000255654146
  error estimate for blocks of size 2^( 3) =       0.000263914266
  error estimate for blocks of size 2^( 4) =       0.000269720378
  error estimate for blocks of size 2^( 5) =       0.000273466495
  error estimate for blocks of size 2^( 6) =       0.000275133082
  error estimate for blocks of size 2^( 7) =       0.000276181000
  error estimate for blocks of size 2^( 8) =       0.000275824667
  error estimate for blocks of size 2^( 9) =       0.000276739808

      target function =                  N/A
              le_mean =     -22.824773043395
             les_mean =     521.474263690253
             stat err =       0.000275969639
             autocorr =       1.254067470433
              std dev =       0.697020976344
             le_variance =       0.485838241464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824773043395        initial  <--
     3.9062e+24     3.9062e+25             0.0000e+00       -22.824773043395
     1.5625e+25     1.5625e+26             0.0000e+00       -22.824773043395
     6.2500e+25     6.2500e+26             0.0000e+00       -22.824773043395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.8428
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8879e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8145
    reference variance = 0.508222
====================================================
  Execution time = 1.0026e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1417e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9929e-01
  Total weights = 7.857071272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8186e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482882316433
                                         uncertainty =       0.001157428654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482882316433
                                         uncertainty =       0.001157428654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245684185
  error estimate for blocks of size 2^( 2) =       0.000255036620
  error estimate for blocks of size 2^( 3) =       0.000263225755
  error estimate for blocks of size 2^( 4) =       0.000269304642
  error estimate for blocks of size 2^( 5) =       0.000272918651
  error estimate for blocks of size 2^( 6) =       0.000274658797
  error estimate for blocks of size 2^( 7) =       0.000275127513
  error estimate for blocks of size 2^( 8) =       0.000276196972
  error estimate for blocks of size 2^( 9) =       0.000277504313

      target function =                  N/A
              le_mean =     -22.823975639118
             les_mean =     521.433152828480
             stat err =       0.000275871899
             autocorr =       1.260841589240
              std dev =       0.694899812656
             le_variance =       0.482885749629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282397563912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.823975639108       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.823975639108       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+26, overlap shift 1.5625e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.823975639108       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.823975639108       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.823975639108       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.823975639108       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1846e+02
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.796
    reference variance = 0.847467
====================================================
  Execution time = 9.7671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0113e-01
  Total weights = 7.8568e+06
  Execution time = 1.4576e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246332132
  error estimate for blocks of size 2^( 2) =       0.000255664065
  error estimate for blocks of size 2^( 3) =       0.000263908092
  error estimate for blocks of size 2^( 4) =       0.000269516713
  error estimate for blocks of size 2^( 5) =       0.000273195907
  error estimate for blocks of size 2^( 6) =       0.000275108786
  error estimate for blocks of size 2^( 7) =       0.000276288824
  error estimate for blocks of size 2^( 8) =       0.000276435509
  error estimate for blocks of size 2^( 9) =       0.000275031980

      target function =                  N/A
              le_mean =     -22.824281492325
             les_mean =     521.448953669218
             stat err =       0.000275716275
             autocorr =       1.252802671824
              std dev =       0.696732485032
             le_variance =       0.485436155698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246332132
  error estimate for blocks of size 2^( 2) =       0.000255664065
  error estimate for blocks of size 2^( 3) =       0.000263908092
  error estimate for blocks of size 2^( 4) =       0.000269516713
  error estimate for blocks of size 2^( 5) =       0.000273195907
  error estimate for blocks of size 2^( 6) =       0.000275108786
  error estimate for blocks of size 2^( 7) =       0.000276288824
  error estimate for blocks of size 2^( 8) =       0.000276435509
  error estimate for blocks of size 2^( 9) =       0.000275031980

      target function =                  N/A
              le_mean =     -22.824281492325
             les_mean =     521.448953669218
             stat err =       0.000275716275
             autocorr =       1.252802671824
              std dev =       0.696732485032
             le_variance =       0.485436155698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246332132
  error estimate for blocks of size 2^( 2) =       0.000255664065
  error estimate for blocks of size 2^( 3) =       0.000263908092
  error estimate for blocks of size 2^( 4) =       0.000269516713
  error estimate for blocks of size 2^( 5) =       0.000273195907
  error estimate for blocks of size 2^( 6) =       0.000275108786
  error estimate for blocks of size 2^( 7) =       0.000276288824
  error estimate for blocks of size 2^( 8) =       0.000276435509
  error estimate for blocks of size 2^( 9) =       0.000275031980

      target function =                  N/A
              le_mean =     -22.824281492325
             les_mean =     521.448953669218
             stat err =       0.000275716275
             autocorr =       1.252802671824
              std dev =       0.696732485032
             le_variance =       0.485436155698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485434181980
                                         uncertainty =       0.001808909149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246332132
  error estimate for blocks of size 2^( 2) =       0.000255664065
  error estimate for blocks of size 2^( 3) =       0.000263908092
  error estimate for blocks of size 2^( 4) =       0.000269516713
  error estimate for blocks of size 2^( 5) =       0.000273195907
  error estimate for blocks of size 2^( 6) =       0.000275108786
  error estimate for blocks of size 2^( 7) =       0.000276288824
  error estimate for blocks of size 2^( 8) =       0.000276435509
  error estimate for blocks of size 2^( 9) =       0.000275031980

      target function =                  N/A
              le_mean =     -22.824281492325
             les_mean =     521.448953669218
             stat err =       0.000275716275
             autocorr =       1.252802671824
              std dev =       0.696732485032
             le_variance =       0.485436155698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824281492325        initial  <--
     3.9062e+25     3.9062e+26             0.0000e+00       -22.824281492325
     1.5625e+26     1.5625e+27             0.0000e+00       -22.824281492325
     6.2500e+26     6.2500e+27             0.0000e+00       -22.824281492325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.0597
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8752e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8476
    reference variance = 0.57233
====================================================
  Execution time = 1.0023e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1405e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9884e-01
  Total weights = 7.856059700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8267e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483058509853
                                         uncertainty =       0.001248557053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483058509853
                                         uncertainty =       0.001248557053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245728008
  error estimate for blocks of size 2^( 2) =       0.000255067069
  error estimate for blocks of size 2^( 3) =       0.000263340224
  error estimate for blocks of size 2^( 4) =       0.000269080293
  error estimate for blocks of size 2^( 5) =       0.000272273374
  error estimate for blocks of size 2^( 6) =       0.000274233632
  error estimate for blocks of size 2^( 7) =       0.000274643477
  error estimate for blocks of size 2^( 8) =       0.000274520906
  error estimate for blocks of size 2^( 9) =       0.000274452370

      target function =                  N/A
              le_mean =     -22.824612399099
             les_mean =     521.461771506631
             stat err =       0.000274462596
             autocorr =       1.247547282708
              std dev =       0.695023763295
             le_variance =       0.483058031545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282461239910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824612399094       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824612399094       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+27, overlap shift 1.5625e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824612399094       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824612399094       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824612399094       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824612399094       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140278 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1851e+02
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.9316
    reference variance = 0.588623
====================================================
  Execution time = 9.7586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0181e-01
  Total weights = 7.8569e+06
  Execution time = 1.4102e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246183262
  error estimate for blocks of size 2^( 2) =       0.000255573556
  error estimate for blocks of size 2^( 3) =       0.000263817289
  error estimate for blocks of size 2^( 4) =       0.000269907579
  error estimate for blocks of size 2^( 5) =       0.000273208764
  error estimate for blocks of size 2^( 6) =       0.000275571358
  error estimate for blocks of size 2^( 7) =       0.000276637671
  error estimate for blocks of size 2^( 8) =       0.000276357654
  error estimate for blocks of size 2^( 9) =       0.000276572307

      target function =                  N/A
              le_mean =     -22.824392922865
             les_mean =     521.454726067207
             stat err =       0.000276284748
             autocorr =       1.259495956387
              std dev =       0.696311415411
             le_variance =       0.484849587232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246183262
  error estimate for blocks of size 2^( 2) =       0.000255573556
  error estimate for blocks of size 2^( 3) =       0.000263817289
  error estimate for blocks of size 2^( 4) =       0.000269907579
  error estimate for blocks of size 2^( 5) =       0.000273208764
  error estimate for blocks of size 2^( 6) =       0.000275571358
  error estimate for blocks of size 2^( 7) =       0.000276637671
  error estimate for blocks of size 2^( 8) =       0.000276357654
  error estimate for blocks of size 2^( 9) =       0.000276572307

      target function =                  N/A
              le_mean =     -22.824392922865
             les_mean =     521.454726067207
             stat err =       0.000276284748
             autocorr =       1.259495956394
              std dev =       0.696311415411
             le_variance =       0.484849587232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246183262
  error estimate for blocks of size 2^( 2) =       0.000255573556
  error estimate for blocks of size 2^( 3) =       0.000263817289
  error estimate for blocks of size 2^( 4) =       0.000269907579
  error estimate for blocks of size 2^( 5) =       0.000273208764
  error estimate for blocks of size 2^( 6) =       0.000275571358
  error estimate for blocks of size 2^( 7) =       0.000276637671
  error estimate for blocks of size 2^( 8) =       0.000276357654
  error estimate for blocks of size 2^( 9) =       0.000276572307

      target function =                  N/A
              le_mean =     -22.824392922865
             les_mean =     521.454726067207
             stat err =       0.000276284748
             autocorr =       1.259495956394
              std dev =       0.696311415411
             le_variance =       0.484849587232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484848004738
                                         uncertainty =       0.001327417403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246183262
  error estimate for blocks of size 2^( 2) =       0.000255573556
  error estimate for blocks of size 2^( 3) =       0.000263817289
  error estimate for blocks of size 2^( 4) =       0.000269907579
  error estimate for blocks of size 2^( 5) =       0.000273208764
  error estimate for blocks of size 2^( 6) =       0.000275571358
  error estimate for blocks of size 2^( 7) =       0.000276637671
  error estimate for blocks of size 2^( 8) =       0.000276357654
  error estimate for blocks of size 2^( 9) =       0.000276572307

      target function =                  N/A
              le_mean =     -22.824392922865
             les_mean =     521.454726067207
             stat err =       0.000276284748
             autocorr =       1.259495956394
              std dev =       0.696311415411
             le_variance =       0.484849587232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824392922865        initial  <--
     3.9062e+26     3.9062e+27             0.0000e+00       -22.824392922865
     1.5625e+27     1.5625e+28             0.0000e+00       -22.824392922865
     6.2500e+27     6.2500e+28             0.0000e+00       -22.824392922865

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.8045
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8732e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8528
    reference variance = 0.419209
====================================================
  Execution time = 9.9913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1379e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9903e-01
  Total weights = 7.857145597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8195e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483049042112
                                         uncertainty =       0.001258365437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483049042112
                                         uncertainty =       0.001258365437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245726016
  error estimate for blocks of size 2^( 2) =       0.000255009610
  error estimate for blocks of size 2^( 3) =       0.000263239045
  error estimate for blocks of size 2^( 4) =       0.000269195722
  error estimate for blocks of size 2^( 5) =       0.000273036499
  error estimate for blocks of size 2^( 6) =       0.000275098561
  error estimate for blocks of size 2^( 7) =       0.000276448552
  error estimate for blocks of size 2^( 8) =       0.000277597761
  error estimate for blocks of size 2^( 9) =       0.000278149935

      target function =                  N/A
              le_mean =     -22.824286811674
             les_mean =     521.447098030599
             stat err =       0.000276823702
             autocorr =       1.269124614189
              std dev =       0.695018128362
             le_variance =       0.483050198752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282428681167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824286811670       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824286811670       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825007412361       residual = 1.84e+11           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824286811694       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+27 is 5.567363e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+28, overlap shift 1.5625e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824286811670       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824286811670       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824286811670       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+28 is 1.303604e-32

solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824286811670       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824286811670       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824286811670       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+28 is 3.259009e-33

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1812e+02
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7907
    reference variance = 0.328953
====================================================
  Execution time = 9.7501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0031e-01
  Total weights = 7.8569e+06
  Execution time = 1.4105e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246111128
  error estimate for blocks of size 2^( 2) =       0.000255312911
  error estimate for blocks of size 2^( 3) =       0.000263556295
  error estimate for blocks of size 2^( 4) =       0.000269387388
  error estimate for blocks of size 2^( 5) =       0.000272865836
  error estimate for blocks of size 2^( 6) =       0.000274646819
  error estimate for blocks of size 2^( 7) =       0.000275927426
  error estimate for blocks of size 2^( 8) =       0.000277508307
  error estimate for blocks of size 2^( 9) =       0.000278370734

      target function =                  N/A
              le_mean =     -22.824235726754
             les_mean =     521.446043740651
             stat err =       0.000276613322
             autocorr =       1.263233640642
              std dev =       0.696107389283
             le_variance =       0.484565497414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246111128
  error estimate for blocks of size 2^( 2) =       0.000255312911
  error estimate for blocks of size 2^( 3) =       0.000263556295
  error estimate for blocks of size 2^( 4) =       0.000269387388
  error estimate for blocks of size 2^( 5) =       0.000272865836
  error estimate for blocks of size 2^( 6) =       0.000274646819
  error estimate for blocks of size 2^( 7) =       0.000275927426
  error estimate for blocks of size 2^( 8) =       0.000277508307
  error estimate for blocks of size 2^( 9) =       0.000278370734

      target function =                  N/A
              le_mean =     -22.824235726754
             les_mean =     521.446043740651
             stat err =       0.000276613322
             autocorr =       1.263233640642
              std dev =       0.696107389283
             le_variance =       0.484565497414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246111128
  error estimate for blocks of size 2^( 2) =       0.000255312911
  error estimate for blocks of size 2^( 3) =       0.000263556295
  error estimate for blocks of size 2^( 4) =       0.000269387388
  error estimate for blocks of size 2^( 5) =       0.000272865836
  error estimate for blocks of size 2^( 6) =       0.000274646819
  error estimate for blocks of size 2^( 7) =       0.000275927426
  error estimate for blocks of size 2^( 8) =       0.000277508307
  error estimate for blocks of size 2^( 9) =       0.000278370734

      target function =                  N/A
              le_mean =     -22.824235726754
             les_mean =     521.446043740651
             stat err =       0.000276613322
             autocorr =       1.263233640642
              std dev =       0.696107389283
             le_variance =       0.484565497414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484565495477
                                         uncertainty =       0.001396089681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246111128
  error estimate for blocks of size 2^( 2) =       0.000255312911
  error estimate for blocks of size 2^( 3) =       0.000263556295
  error estimate for blocks of size 2^( 4) =       0.000269387388
  error estimate for blocks of size 2^( 5) =       0.000272865836
  error estimate for blocks of size 2^( 6) =       0.000274646819
  error estimate for blocks of size 2^( 7) =       0.000275927426
  error estimate for blocks of size 2^( 8) =       0.000277508307
  error estimate for blocks of size 2^( 9) =       0.000278370734

      target function =                  N/A
              le_mean =     -22.824235726754
             les_mean =     521.446043740651
             stat err =       0.000276613322
             autocorr =       1.263233640642
              std dev =       0.696107389283
             le_variance =       0.484565497414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824235726754        initial  <--
     3.9062e+27     3.9062e+28             5.5674e-32       -22.824235726754
     1.5625e+28     1.5625e+29             1.3036e-32       -22.824235726754
     6.2500e+28     6.2500e+29             3.2590e-33       -22.824235726754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.6609
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8679e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7989
    reference variance = 0.328069
====================================================
  Execution time = 9.9963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1403e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9971e-01
  Total weights = 7.856470373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8143e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483086665347
                                         uncertainty =       0.001286696387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483086665347
                                         uncertainty =       0.001286696387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245735849
  error estimate for blocks of size 2^( 2) =       0.000255022714
  error estimate for blocks of size 2^( 3) =       0.000263323090
  error estimate for blocks of size 2^( 4) =       0.000269265496
  error estimate for blocks of size 2^( 5) =       0.000272912626
  error estimate for blocks of size 2^( 6) =       0.000275122918
  error estimate for blocks of size 2^( 7) =       0.000276386934
  error estimate for blocks of size 2^( 8) =       0.000277629143
  error estimate for blocks of size 2^( 9) =       0.000278581325

      target function =                  N/A
              le_mean =     -22.824288725627
             les_mean =     521.447861919379
             stat err =       0.000276930080
             autocorr =       1.269998556444
              std dev =       0.695045940317
             le_variance =       0.483088859151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282428872563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824288725625       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824288725625       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+29, overlap shift 1.5625e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824288725625       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824288725625       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824288725625       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824288725625       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1812e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7334
    reference variance = 0.421354
====================================================
  Execution time = 9.7504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9699e-01
  Total weights = 7.8567e+06
  Execution time = 1.4120e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245442363
  error estimate for blocks of size 2^( 2) =       0.000254565758
  error estimate for blocks of size 2^( 3) =       0.000262763283
  error estimate for blocks of size 2^( 4) =       0.000268588504
  error estimate for blocks of size 2^( 5) =       0.000272379022
  error estimate for blocks of size 2^( 6) =       0.000274295968
  error estimate for blocks of size 2^( 7) =       0.000275674546
  error estimate for blocks of size 2^( 8) =       0.000276203077
  error estimate for blocks of size 2^( 9) =       0.000276913978

      target function =                  N/A
              le_mean =     -22.824100295083
             les_mean =     521.436547681326
             stat err =       0.000275771892
             autocorr =       1.262411521880
              std dev =       0.694215838469
             le_variance =       0.481935630381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245442363
  error estimate for blocks of size 2^( 2) =       0.000254565758
  error estimate for blocks of size 2^( 3) =       0.000262763283
  error estimate for blocks of size 2^( 4) =       0.000268588504
  error estimate for blocks of size 2^( 5) =       0.000272379022
  error estimate for blocks of size 2^( 6) =       0.000274295968
  error estimate for blocks of size 2^( 7) =       0.000275674546
  error estimate for blocks of size 2^( 8) =       0.000276203077
  error estimate for blocks of size 2^( 9) =       0.000276913978

      target function =                  N/A
              le_mean =     -22.824100295083
             les_mean =     521.436547681326
             stat err =       0.000275771892
             autocorr =       1.262411521881
              std dev =       0.694215838469
             le_variance =       0.481935630381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245442363
  error estimate for blocks of size 2^( 2) =       0.000254565758
  error estimate for blocks of size 2^( 3) =       0.000262763283
  error estimate for blocks of size 2^( 4) =       0.000268588504
  error estimate for blocks of size 2^( 5) =       0.000272379022
  error estimate for blocks of size 2^( 6) =       0.000274295968
  error estimate for blocks of size 2^( 7) =       0.000275674546
  error estimate for blocks of size 2^( 8) =       0.000276203077
  error estimate for blocks of size 2^( 9) =       0.000276913978

      target function =                  N/A
              le_mean =     -22.824100295083
             les_mean =     521.436547681326
             stat err =       0.000275771892
             autocorr =       1.262411521881
              std dev =       0.694215838469
             le_variance =       0.481935630381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481934131184
                                         uncertainty =       0.001364359452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245442363
  error estimate for blocks of size 2^( 2) =       0.000254565758
  error estimate for blocks of size 2^( 3) =       0.000262763283
  error estimate for blocks of size 2^( 4) =       0.000268588504
  error estimate for blocks of size 2^( 5) =       0.000272379022
  error estimate for blocks of size 2^( 6) =       0.000274295968
  error estimate for blocks of size 2^( 7) =       0.000275674546
  error estimate for blocks of size 2^( 8) =       0.000276203077
  error estimate for blocks of size 2^( 9) =       0.000276913978

      target function =                  N/A
              le_mean =     -22.824100295083
             les_mean =     521.436547681326
             stat err =       0.000275771892
             autocorr =       1.262411521881
              std dev =       0.694215838469
             le_variance =       0.481935630381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824100295083        initial  <--
     3.9062e+28     3.9062e+29             0.0000e+00       -22.824100295083
     1.5625e+29     1.5625e+30             0.0000e+00       -22.824100295083
     6.2500e+29     6.2500e+30             0.0000e+00       -22.824100295083

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.5275
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8665e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2830e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8955
    reference variance = 0.493001
====================================================
  Execution time = 1.0027e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1385e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0085e-01
  Total weights = 7.857114518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8120e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484641296496
                                         uncertainty =       0.001420989124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484641296496
                                         uncertainty =       0.001420989124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246130054
  error estimate for blocks of size 2^( 2) =       0.000255327295
  error estimate for blocks of size 2^( 3) =       0.000263600981
  error estimate for blocks of size 2^( 4) =       0.000269589826
  error estimate for blocks of size 2^( 5) =       0.000273198230
  error estimate for blocks of size 2^( 6) =       0.000275234845
  error estimate for blocks of size 2^( 7) =       0.000276595586
  error estimate for blocks of size 2^( 8) =       0.000276474031
  error estimate for blocks of size 2^( 9) =       0.000277619213

      target function =                  N/A
              le_mean =     -22.824374655146
             les_mean =     521.452928269671
             stat err =       0.000276480919
             autocorr =       1.261830539407
              std dev =       0.696160921405
             le_variance =       0.484640028492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282437465515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824374655140       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824374655140       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+30, overlap shift 1.5625e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824374655140       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824374655140       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824374655140       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824374655140       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143793 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1840e+02
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8547
    reference variance = 0.318319
====================================================
  Execution time = 9.7640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0448e-01
  Total weights = 7.8571e+06
  Execution time = 1.4084e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246233412
  error estimate for blocks of size 2^( 2) =       0.000255440485
  error estimate for blocks of size 2^( 3) =       0.000263697175
  error estimate for blocks of size 2^( 4) =       0.000269590796
  error estimate for blocks of size 2^( 5) =       0.000273052703
  error estimate for blocks of size 2^( 6) =       0.000275091454
  error estimate for blocks of size 2^( 7) =       0.000276163443
  error estimate for blocks of size 2^( 8) =       0.000277198978
  error estimate for blocks of size 2^( 9) =       0.000276908207

      target function =                  N/A
              le_mean =     -22.824469459224
             les_mean =     521.460885982414
             stat err =       0.000276340521
             autocorr =       1.259491315766
              std dev =       0.696453260888
             le_variance =       0.485047144601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246233412
  error estimate for blocks of size 2^( 2) =       0.000255440485
  error estimate for blocks of size 2^( 3) =       0.000263697175
  error estimate for blocks of size 2^( 4) =       0.000269590796
  error estimate for blocks of size 2^( 5) =       0.000273052703
  error estimate for blocks of size 2^( 6) =       0.000275091454
  error estimate for blocks of size 2^( 7) =       0.000276163443
  error estimate for blocks of size 2^( 8) =       0.000277198978
  error estimate for blocks of size 2^( 9) =       0.000276908207

      target function =                  N/A
              le_mean =     -22.824469459224
             les_mean =     521.460885982414
             stat err =       0.000276340521
             autocorr =       1.259491315766
              std dev =       0.696453260888
             le_variance =       0.485047144601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246233412
  error estimate for blocks of size 2^( 2) =       0.000255440485
  error estimate for blocks of size 2^( 3) =       0.000263697175
  error estimate for blocks of size 2^( 4) =       0.000269590796
  error estimate for blocks of size 2^( 5) =       0.000273052703
  error estimate for blocks of size 2^( 6) =       0.000275091454
  error estimate for blocks of size 2^( 7) =       0.000276163443
  error estimate for blocks of size 2^( 8) =       0.000277198978
  error estimate for blocks of size 2^( 9) =       0.000276908207

      target function =                  N/A
              le_mean =     -22.824469459224
             les_mean =     521.460885982414
             stat err =       0.000276340521
             autocorr =       1.259491315766
              std dev =       0.696453260888
             le_variance =       0.485047144601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485049231294
                                         uncertainty =       0.001596853016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246233412
  error estimate for blocks of size 2^( 2) =       0.000255440485
  error estimate for blocks of size 2^( 3) =       0.000263697175
  error estimate for blocks of size 2^( 4) =       0.000269590796
  error estimate for blocks of size 2^( 5) =       0.000273052703
  error estimate for blocks of size 2^( 6) =       0.000275091454
  error estimate for blocks of size 2^( 7) =       0.000276163443
  error estimate for blocks of size 2^( 8) =       0.000277198978
  error estimate for blocks of size 2^( 9) =       0.000276908207

      target function =                  N/A
              le_mean =     -22.824469459224
             les_mean =     521.460885982414
             stat err =       0.000276340521
             autocorr =       1.259491315766
              std dev =       0.696453260888
             le_variance =       0.485047144601


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824469459224        initial  <--
     3.9062e+29     3.9062e+30             0.0000e+00       -22.824469459224
     1.5625e+30     1.5625e+31             0.0000e+00       -22.824469459224
     6.2500e+30     6.2500e+31             0.0000e+00       -22.824469459224

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.7772
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8719e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.9249
    reference variance = 0.498422
====================================================
  Execution time = 1.0019e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1385e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0067e-01
  Total weights = 7.856683605e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8115e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483985634714
                                         uncertainty =       0.001330843033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483985634714
                                         uncertainty =       0.001330843033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245964539
  error estimate for blocks of size 2^( 2) =       0.000255227115
  error estimate for blocks of size 2^( 3) =       0.000263407383
  error estimate for blocks of size 2^( 4) =       0.000269235555
  error estimate for blocks of size 2^( 5) =       0.000272441157
  error estimate for blocks of size 2^( 6) =       0.000274135411
  error estimate for blocks of size 2^( 7) =       0.000275408297
  error estimate for blocks of size 2^( 8) =       0.000276299236
  error estimate for blocks of size 2^( 9) =       0.000277158589

      target function =                  N/A
              le_mean =     -22.824352978927
             les_mean =     521.451760677780
             stat err =       0.000275750383
             autocorr =       1.256861001031
              std dev =       0.695692774304
             le_variance =       0.483988436219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282435297893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824352978923       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824352978923       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+31, overlap shift 1.5625e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824352978923       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824352978923       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824352978923       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824352978923       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1831e+02
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8662
    reference variance = 0.292764
====================================================
  Execution time = 9.7550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9820e-01
  Total weights = 7.8568e+06
  Execution time = 1.4120e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245872463
  error estimate for blocks of size 2^( 2) =       0.000255150210
  error estimate for blocks of size 2^( 3) =       0.000263465982
  error estimate for blocks of size 2^( 4) =       0.000269264426
  error estimate for blocks of size 2^( 5) =       0.000272735166
  error estimate for blocks of size 2^( 6) =       0.000274495120
  error estimate for blocks of size 2^( 7) =       0.000275170429
  error estimate for blocks of size 2^( 8) =       0.000275426742
  error estimate for blocks of size 2^( 9) =       0.000274820923

      target function =                  N/A
              le_mean =     -22.824805230299
             les_mean =     521.469929146381
             stat err =       0.000274978303
             autocorr =       1.250768901046
              std dev =       0.695432342205
             le_variance =       0.483626142585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245872463
  error estimate for blocks of size 2^( 2) =       0.000255150210
  error estimate for blocks of size 2^( 3) =       0.000263465982
  error estimate for blocks of size 2^( 4) =       0.000269264426
  error estimate for blocks of size 2^( 5) =       0.000272735166
  error estimate for blocks of size 2^( 6) =       0.000274495120
  error estimate for blocks of size 2^( 7) =       0.000275170429
  error estimate for blocks of size 2^( 8) =       0.000275426742
  error estimate for blocks of size 2^( 9) =       0.000274820923

      target function =                  N/A
              le_mean =     -22.824805230299
             les_mean =     521.469929146381
             stat err =       0.000274978303
             autocorr =       1.250768901046
              std dev =       0.695432342205
             le_variance =       0.483626142585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245872463
  error estimate for blocks of size 2^( 2) =       0.000255150210
  error estimate for blocks of size 2^( 3) =       0.000263465982
  error estimate for blocks of size 2^( 4) =       0.000269264426
  error estimate for blocks of size 2^( 5) =       0.000272735166
  error estimate for blocks of size 2^( 6) =       0.000274495120
  error estimate for blocks of size 2^( 7) =       0.000275170429
  error estimate for blocks of size 2^( 8) =       0.000275426742
  error estimate for blocks of size 2^( 9) =       0.000274820923

      target function =                  N/A
              le_mean =     -22.824805230299
             les_mean =     521.469929146381
             stat err =       0.000274978303
             autocorr =       1.250768901046
              std dev =       0.695432342205
             le_variance =       0.483626142585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483622554407
                                         uncertainty =       0.001370712044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245872463
  error estimate for blocks of size 2^( 2) =       0.000255150210
  error estimate for blocks of size 2^( 3) =       0.000263465982
  error estimate for blocks of size 2^( 4) =       0.000269264426
  error estimate for blocks of size 2^( 5) =       0.000272735166
  error estimate for blocks of size 2^( 6) =       0.000274495120
  error estimate for blocks of size 2^( 7) =       0.000275170429
  error estimate for blocks of size 2^( 8) =       0.000275426742
  error estimate for blocks of size 2^( 9) =       0.000274820923

      target function =                  N/A
              le_mean =     -22.824805230299
             les_mean =     521.469929146381
             stat err =       0.000274978303
             autocorr =       1.250768901046
              std dev =       0.695432342205
             le_variance =       0.483626142585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824805230299        initial  <--
     3.9062e+30     3.9062e+31             0.0000e+00       -22.824805230299
     1.5625e+31     1.5625e+32             0.0000e+00       -22.824805230299
     6.2500e+31     6.2500e+32             0.0000e+00       -22.824805230299

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.3943
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8671e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8022
    reference variance = 4.10006
====================================================
  Execution time = 1.0041e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1364e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0507e-01
  Total weights = 7.856409616e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8560e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484869289365
                                         uncertainty =       0.001251647688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484869289365
                                         uncertainty =       0.001251647688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246188471
  error estimate for blocks of size 2^( 2) =       0.000255278934
  error estimate for blocks of size 2^( 3) =       0.000263410524
  error estimate for blocks of size 2^( 4) =       0.000269494853
  error estimate for blocks of size 2^( 5) =       0.000273229339
  error estimate for blocks of size 2^( 6) =       0.000275458261
  error estimate for blocks of size 2^( 7) =       0.000276262105
  error estimate for blocks of size 2^( 8) =       0.000276561773
  error estimate for blocks of size 2^( 9) =       0.000276232491

      target function =                  N/A
              le_mean =     -22.824578709349
             les_mean =     521.466465751750
             stat err =       0.000276128658
             autocorr =       1.258019988375
              std dev =       0.696326148517
             le_variance =       0.484870105108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282457870935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+31, overlap shift 3.9062e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824578709345       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824578709345       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+32, overlap shift 1.5625e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824578709345       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824578709345       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824578709345       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824578709345       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1899e+02
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8935
    reference variance = 0.261577
====================================================
  Execution time = 9.7820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0172e-01
  Total weights = 7.8571e+06
  Execution time = 1.4093e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245756721
  error estimate for blocks of size 2^( 2) =       0.000254925529
  error estimate for blocks of size 2^( 3) =       0.000263246396
  error estimate for blocks of size 2^( 4) =       0.000269365145
  error estimate for blocks of size 2^( 5) =       0.000272650227
  error estimate for blocks of size 2^( 6) =       0.000274752336
  error estimate for blocks of size 2^( 7) =       0.000275996643
  error estimate for blocks of size 2^( 8) =       0.000275931650
  error estimate for blocks of size 2^( 9) =       0.000277111895

      target function =                  N/A
              le_mean =     -22.824528837588
             les_mean =     521.460833551150
             stat err =       0.000275948131
             autocorr =       1.260793924171
              std dev =       0.695104974974
             le_variance =       0.483170926234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245756721
  error estimate for blocks of size 2^( 2) =       0.000254925529
  error estimate for blocks of size 2^( 3) =       0.000263246396
  error estimate for blocks of size 2^( 4) =       0.000269365145
  error estimate for blocks of size 2^( 5) =       0.000272650227
  error estimate for blocks of size 2^( 6) =       0.000274752336
  error estimate for blocks of size 2^( 7) =       0.000275996643
  error estimate for blocks of size 2^( 8) =       0.000275931650
  error estimate for blocks of size 2^( 9) =       0.000277111895

      target function =                  N/A
              le_mean =     -22.824528837588
             les_mean =     521.460833551150
             stat err =       0.000275948131
             autocorr =       1.260793924171
              std dev =       0.695104974974
             le_variance =       0.483170926234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245756721
  error estimate for blocks of size 2^( 2) =       0.000254925529
  error estimate for blocks of size 2^( 3) =       0.000263246396
  error estimate for blocks of size 2^( 4) =       0.000269365145
  error estimate for blocks of size 2^( 5) =       0.000272650227
  error estimate for blocks of size 2^( 6) =       0.000274752336
  error estimate for blocks of size 2^( 7) =       0.000275996643
  error estimate for blocks of size 2^( 8) =       0.000275931650
  error estimate for blocks of size 2^( 9) =       0.000277111895

      target function =                  N/A
              le_mean =     -22.824528837588
             les_mean =     521.460833551150
             stat err =       0.000275948131
             autocorr =       1.260793924171
              std dev =       0.695104974974
             le_variance =       0.483170926234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483168924415
                                         uncertainty =       0.001721683726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245756721
  error estimate for blocks of size 2^( 2) =       0.000254925529
  error estimate for blocks of size 2^( 3) =       0.000263246396
  error estimate for blocks of size 2^( 4) =       0.000269365145
  error estimate for blocks of size 2^( 5) =       0.000272650227
  error estimate for blocks of size 2^( 6) =       0.000274752336
  error estimate for blocks of size 2^( 7) =       0.000275996643
  error estimate for blocks of size 2^( 8) =       0.000275931650
  error estimate for blocks of size 2^( 9) =       0.000277111895

      target function =                  N/A
              le_mean =     -22.824528837588
             les_mean =     521.460833551150
             stat err =       0.000275948131
             autocorr =       1.260793924171
              std dev =       0.695104974974
             le_variance =       0.483170926234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824528837588        initial  <--
     3.9062e+31     3.9062e+32             0.0000e+00       -22.824528837588
     1.5625e+32     1.5625e+33             0.0000e+00       -22.824528837588
     6.2500e+32     6.2500e+33             0.0000e+00       -22.824528837588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.5468
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8754e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8822
    reference variance = 0.307432
====================================================
  Execution time = 1.0002e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1366e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9989e-01
  Total weights = 7.856572617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8546e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483061695169
                                         uncertainty =       0.001227735898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483061695169
                                         uncertainty =       0.001227735898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245729472
  error estimate for blocks of size 2^( 2) =       0.000255007641
  error estimate for blocks of size 2^( 3) =       0.000263316420
  error estimate for blocks of size 2^( 4) =       0.000269023290
  error estimate for blocks of size 2^( 5) =       0.000272426251
  error estimate for blocks of size 2^( 6) =       0.000274021419
  error estimate for blocks of size 2^( 7) =       0.000275579087
  error estimate for blocks of size 2^( 8) =       0.000275909059
  error estimate for blocks of size 2^( 9) =       0.000275919932

      target function =                  N/A
              le_mean =     -22.824606358807
             les_mean =     521.462545088216
             stat err =       0.000275357374
             autocorr =       1.255679858487
              std dev =       0.695027904721
             le_variance =       0.483063788340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282460635881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+32, overlap shift 3.9062e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824606358806       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824606358806       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+33, overlap shift 1.5625e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824606358806       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824606358806       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824606358806       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824606358806       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1858e+02
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.739
    reference variance = 0.423845
====================================================
  Execution time = 9.7379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0427e-01
  Total weights = 7.8573e+06
  Execution time = 1.4085e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246242077
  error estimate for blocks of size 2^( 2) =       0.000255557454
  error estimate for blocks of size 2^( 3) =       0.000263830142
  error estimate for blocks of size 2^( 4) =       0.000270085478
  error estimate for blocks of size 2^( 5) =       0.000273521834
  error estimate for blocks of size 2^( 6) =       0.000275106223
  error estimate for blocks of size 2^( 7) =       0.000276839146
  error estimate for blocks of size 2^( 8) =       0.000277493660
  error estimate for blocks of size 2^( 9) =       0.000277006653

      target function =                  N/A
              le_mean =     -22.824764256365
             les_mean =     521.474130092534
             stat err =       0.000276611420
             autocorr =       1.261873103737
              std dev =       0.696477768853
             le_variance =       0.485081282507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246242077
  error estimate for blocks of size 2^( 2) =       0.000255557454
  error estimate for blocks of size 2^( 3) =       0.000263830142
  error estimate for blocks of size 2^( 4) =       0.000270085478
  error estimate for blocks of size 2^( 5) =       0.000273521834
  error estimate for blocks of size 2^( 6) =       0.000275106223
  error estimate for blocks of size 2^( 7) =       0.000276839146
  error estimate for blocks of size 2^( 8) =       0.000277493660
  error estimate for blocks of size 2^( 9) =       0.000277006653

      target function =                  N/A
              le_mean =     -22.824764256365
             les_mean =     521.474130092534
             stat err =       0.000276611420
             autocorr =       1.261873103737
              std dev =       0.696477768853
             le_variance =       0.485081282507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246242077
  error estimate for blocks of size 2^( 2) =       0.000255557454
  error estimate for blocks of size 2^( 3) =       0.000263830142
  error estimate for blocks of size 2^( 4) =       0.000270085478
  error estimate for blocks of size 2^( 5) =       0.000273521834
  error estimate for blocks of size 2^( 6) =       0.000275106223
  error estimate for blocks of size 2^( 7) =       0.000276839146
  error estimate for blocks of size 2^( 8) =       0.000277493660
  error estimate for blocks of size 2^( 9) =       0.000277006653

      target function =                  N/A
              le_mean =     -22.824764256365
             les_mean =     521.474130092534
             stat err =       0.000276611420
             autocorr =       1.261873103737
              std dev =       0.696477768853
             le_variance =       0.485081282507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485079082737
                                         uncertainty =       0.001395878843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246242077
  error estimate for blocks of size 2^( 2) =       0.000255557454
  error estimate for blocks of size 2^( 3) =       0.000263830142
  error estimate for blocks of size 2^( 4) =       0.000270085478
  error estimate for blocks of size 2^( 5) =       0.000273521834
  error estimate for blocks of size 2^( 6) =       0.000275106223
  error estimate for blocks of size 2^( 7) =       0.000276839146
  error estimate for blocks of size 2^( 8) =       0.000277493660
  error estimate for blocks of size 2^( 9) =       0.000277006653

      target function =                  N/A
              le_mean =     -22.824764256365
             les_mean =     521.474130092534
             stat err =       0.000276611420
             autocorr =       1.261873103737
              std dev =       0.696477768853
             le_variance =       0.485081282507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824764256365        initial  <--
     3.9062e+32     3.9062e+33             0.0000e+00       -22.824764256365
     1.5625e+33     1.5625e+34             0.0000e+00       -22.824764256365
     6.2500e+33     6.2500e+34             0.0000e+00       -22.824764256365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.1020
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8674e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2832e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.9438
    reference variance = 0.553236
====================================================
  Execution time = 1.0015e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1396e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0388e-01
  Total weights = 7.857158183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8170e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483141740628
                                         uncertainty =       0.001397324490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483141740628
                                         uncertainty =       0.001397324490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245749975
  error estimate for blocks of size 2^( 2) =       0.000255052816
  error estimate for blocks of size 2^( 3) =       0.000263335999
  error estimate for blocks of size 2^( 4) =       0.000269267075
  error estimate for blocks of size 2^( 5) =       0.000273074267
  error estimate for blocks of size 2^( 6) =       0.000275087340
  error estimate for blocks of size 2^( 7) =       0.000276162121
  error estimate for blocks of size 2^( 8) =       0.000276239684
  error estimate for blocks of size 2^( 9) =       0.000275443097

      target function =                  N/A
              le_mean =     -22.824288060624
             les_mean =     521.452009501526
             stat err =       0.000275733060
             autocorr =       1.258898503577
              std dev =       0.695085895519
             le_variance =       0.483144402150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282428806062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+33, overlap shift 3.9062e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824288060618       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824288060618       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+34, overlap shift 1.5625e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824288060618       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824288060618       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824288060618       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824288060618       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1834e+02
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.9994
    reference variance = 1.33867
====================================================
  Execution time = 9.9380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0285e-01
  Total weights = 7.8567e+06
  Execution time = 1.4097e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246272506
  error estimate for blocks of size 2^( 2) =       0.000255538980
  error estimate for blocks of size 2^( 3) =       0.000263877446
  error estimate for blocks of size 2^( 4) =       0.000269639269
  error estimate for blocks of size 2^( 5) =       0.000273345350
  error estimate for blocks of size 2^( 6) =       0.000274879823
  error estimate for blocks of size 2^( 7) =       0.000275764416
  error estimate for blocks of size 2^( 8) =       0.000275555876
  error estimate for blocks of size 2^( 9) =       0.000275170973

      target function =                  N/A
              le_mean =     -22.824315501547
             les_mean =     521.452228111208
             stat err =       0.000275342772
             autocorr =       1.250015794308
              std dev =       0.696563836457
             le_variance =       0.485201178260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246272506
  error estimate for blocks of size 2^( 2) =       0.000255538980
  error estimate for blocks of size 2^( 3) =       0.000263877446
  error estimate for blocks of size 2^( 4) =       0.000269639269
  error estimate for blocks of size 2^( 5) =       0.000273345350
  error estimate for blocks of size 2^( 6) =       0.000274879823
  error estimate for blocks of size 2^( 7) =       0.000275764416
  error estimate for blocks of size 2^( 8) =       0.000275555876
  error estimate for blocks of size 2^( 9) =       0.000275170973

      target function =                  N/A
              le_mean =     -22.824315501547
             les_mean =     521.452228111208
             stat err =       0.000275342772
             autocorr =       1.250015794308
              std dev =       0.696563836457
             le_variance =       0.485201178260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246272506
  error estimate for blocks of size 2^( 2) =       0.000255538980
  error estimate for blocks of size 2^( 3) =       0.000263877446
  error estimate for blocks of size 2^( 4) =       0.000269639269
  error estimate for blocks of size 2^( 5) =       0.000273345350
  error estimate for blocks of size 2^( 6) =       0.000274879823
  error estimate for blocks of size 2^( 7) =       0.000275764416
  error estimate for blocks of size 2^( 8) =       0.000275555876
  error estimate for blocks of size 2^( 9) =       0.000275170973

      target function =                  N/A
              le_mean =     -22.824315501547
             les_mean =     521.452228111208
             stat err =       0.000275342772
             autocorr =       1.250015794308
              std dev =       0.696563836457
             le_variance =       0.485201178260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485200330963
                                         uncertainty =       0.001616146941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246272506
  error estimate for blocks of size 2^( 2) =       0.000255538980
  error estimate for blocks of size 2^( 3) =       0.000263877446
  error estimate for blocks of size 2^( 4) =       0.000269639269
  error estimate for blocks of size 2^( 5) =       0.000273345350
  error estimate for blocks of size 2^( 6) =       0.000274879823
  error estimate for blocks of size 2^( 7) =       0.000275764416
  error estimate for blocks of size 2^( 8) =       0.000275555876
  error estimate for blocks of size 2^( 9) =       0.000275170973

      target function =                  N/A
              le_mean =     -22.824315501547
             les_mean =     521.452228111208
             stat err =       0.000275342772
             autocorr =       1.250015794308
              std dev =       0.696563836457
             le_variance =       0.485201178260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824315501547        initial  <--
     3.9062e+33     3.9062e+34             0.0000e+00       -22.824315501547
     1.5625e+34     1.5625e+35             0.0000e+00       -22.824315501547
     6.2500e+34     6.2500e+35             0.0000e+00       -22.824315501547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.1146
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8846e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7864
    reference variance = 0.525668
====================================================
  Execution time = 1.0071e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1396e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0264e-01
  Total weights = 7.856884282e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8253e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487325152468
                                         uncertainty =       0.002819012501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487325152468
                                         uncertainty =       0.002819012501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246811927
  error estimate for blocks of size 2^( 2) =       0.000256056761
  error estimate for blocks of size 2^( 3) =       0.000264436697
  error estimate for blocks of size 2^( 4) =       0.000270498310
  error estimate for blocks of size 2^( 5) =       0.000274068197
  error estimate for blocks of size 2^( 6) =       0.000275844465
  error estimate for blocks of size 2^( 7) =       0.000276716922
  error estimate for blocks of size 2^( 8) =       0.000277575232
  error estimate for blocks of size 2^( 9) =       0.000277068798

      target function =                  N/A
              le_mean =     -22.824840647007
             les_mean =     521.475989541171
             stat err =       0.000276801354
             autocorr =       1.257778410485
              std dev =       0.698089548864
             le_variance =       0.487329018233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282484064701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+34, overlap shift 3.9062e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824840647001       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824840647001       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824840647001       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+34 is 4.911527e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+35, overlap shift 1.5625e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824840647001       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824840647001       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824840647001       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+35 is 1.227882e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+35, overlap shift 6.2500e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824840647001       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824840647001       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824840647001       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+35 is 3.069705e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1898e+02
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8443
    reference variance = 0.403572
====================================================
  Execution time = 9.9473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0255e-01
  Total weights = 7.8563e+06
  Execution time = 1.4097e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217886
  error estimate for blocks of size 2^( 2) =       0.000255512665
  error estimate for blocks of size 2^( 3) =       0.000263882501
  error estimate for blocks of size 2^( 4) =       0.000269907307
  error estimate for blocks of size 2^( 5) =       0.000273220609
  error estimate for blocks of size 2^( 6) =       0.000274816734
  error estimate for blocks of size 2^( 7) =       0.000276276970
  error estimate for blocks of size 2^( 8) =       0.000277684870
  error estimate for blocks of size 2^( 9) =       0.000278551583

      target function =                  N/A
              le_mean =     -22.824694082352
             les_mean =     521.469208210752
             stat err =       0.000276832539
             autocorr =       1.264139720334
              std dev =       0.696409346501
             le_variance =       0.484985977894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217886
  error estimate for blocks of size 2^( 2) =       0.000255512665
  error estimate for blocks of size 2^( 3) =       0.000263882501
  error estimate for blocks of size 2^( 4) =       0.000269907307
  error estimate for blocks of size 2^( 5) =       0.000273220609
  error estimate for blocks of size 2^( 6) =       0.000274816734
  error estimate for blocks of size 2^( 7) =       0.000276276970
  error estimate for blocks of size 2^( 8) =       0.000277684870
  error estimate for blocks of size 2^( 9) =       0.000278551583

      target function =                  N/A
              le_mean =     -22.824694082352
             les_mean =     521.469208210752
             stat err =       0.000276832539
             autocorr =       1.264139720334
              std dev =       0.696409346501
             le_variance =       0.484985977894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217886
  error estimate for blocks of size 2^( 2) =       0.000255512665
  error estimate for blocks of size 2^( 3) =       0.000263882501
  error estimate for blocks of size 2^( 4) =       0.000269907307
  error estimate for blocks of size 2^( 5) =       0.000273220609
  error estimate for blocks of size 2^( 6) =       0.000274816734
  error estimate for blocks of size 2^( 7) =       0.000276276970
  error estimate for blocks of size 2^( 8) =       0.000277684870
  error estimate for blocks of size 2^( 9) =       0.000278551583

      target function =                  N/A
              le_mean =     -22.824694082352
             les_mean =     521.469208210752
             stat err =       0.000276832539
             autocorr =       1.264139720334
              std dev =       0.696409346501
             le_variance =       0.484985977894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484986231899
                                         uncertainty =       0.001416567651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246217886
  error estimate for blocks of size 2^( 2) =       0.000255512665
  error estimate for blocks of size 2^( 3) =       0.000263882501
  error estimate for blocks of size 2^( 4) =       0.000269907307
  error estimate for blocks of size 2^( 5) =       0.000273220609
  error estimate for blocks of size 2^( 6) =       0.000274816734
  error estimate for blocks of size 2^( 7) =       0.000276276970
  error estimate for blocks of size 2^( 8) =       0.000277684870
  error estimate for blocks of size 2^( 9) =       0.000278551583

      target function =                  N/A
              le_mean =     -22.824694082352
             les_mean =     521.469208210752
             stat err =       0.000276832539
             autocorr =       1.264139720334
              std dev =       0.696409346501
             le_variance =       0.484985977894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824694082352        initial  <--
     3.9062e+34     3.9062e+35             4.9115e-39       -22.824694082352
     1.5625e+35     1.5625e+36             1.2279e-39       -22.824694082352
     6.2500e+35     6.2500e+36             3.0697e-40       -22.824694082352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.2540
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8932e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2835e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.9126
    reference variance = 0.474528
====================================================
  Execution time = 1.0059e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1370e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9994e-01
  Total weights = 7.857211413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8123e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483811371554
                                         uncertainty =       0.001363775894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483811371554
                                         uncertainty =       0.001363775894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245919716
  error estimate for blocks of size 2^( 2) =       0.000255083964
  error estimate for blocks of size 2^( 3) =       0.000263398758
  error estimate for blocks of size 2^( 4) =       0.000269227048
  error estimate for blocks of size 2^( 5) =       0.000272777561
  error estimate for blocks of size 2^( 6) =       0.000274880539
  error estimate for blocks of size 2^( 7) =       0.000276257824
  error estimate for blocks of size 2^( 8) =       0.000277022403
  error estimate for blocks of size 2^( 9) =       0.000278042529

      target function =                  N/A
              le_mean =     -22.824426343993
             les_mean =     521.454377700740
             stat err =       0.000276550824
             autocorr =       1.264629224990
              std dev =       0.695565996501
             le_variance =       0.483812055488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282442634399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+35, overlap shift 3.9062e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824426343991       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824426343991       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+36, overlap shift 1.5625e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824426343991       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824426343991       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+36, overlap shift 6.2500e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824426343991       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824426343991       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1873e+02
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.9097
    reference variance = 0.539101
====================================================
  Execution time = 9.9440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9978e-01
  Total weights = 7.8572e+06
  Execution time = 1.4106e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245737224
  error estimate for blocks of size 2^( 2) =       0.000254953516
  error estimate for blocks of size 2^( 3) =       0.000263215214
  error estimate for blocks of size 2^( 4) =       0.000269158807
  error estimate for blocks of size 2^( 5) =       0.000272788622
  error estimate for blocks of size 2^( 6) =       0.000274492979
  error estimate for blocks of size 2^( 7) =       0.000275386855
  error estimate for blocks of size 2^( 8) =       0.000276430013
  error estimate for blocks of size 2^( 9) =       0.000278375504

      target function =                  N/A
              le_mean =     -22.824790964385
             les_mean =     521.470860728640
             stat err =       0.000276171338
             autocorr =       1.263034780371
              std dev =       0.695049830585
             le_variance =       0.483094266997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245737224
  error estimate for blocks of size 2^( 2) =       0.000254953516
  error estimate for blocks of size 2^( 3) =       0.000263215214
  error estimate for blocks of size 2^( 4) =       0.000269158807
  error estimate for blocks of size 2^( 5) =       0.000272788622
  error estimate for blocks of size 2^( 6) =       0.000274492979
  error estimate for blocks of size 2^( 7) =       0.000275386855
  error estimate for blocks of size 2^( 8) =       0.000276430013
  error estimate for blocks of size 2^( 9) =       0.000278375504

      target function =                  N/A
              le_mean =     -22.824790964385
             les_mean =     521.470860728640
             stat err =       0.000276171338
             autocorr =       1.263034780371
              std dev =       0.695049830585
             le_variance =       0.483094266997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245737224
  error estimate for blocks of size 2^( 2) =       0.000254953516
  error estimate for blocks of size 2^( 3) =       0.000263215214
  error estimate for blocks of size 2^( 4) =       0.000269158807
  error estimate for blocks of size 2^( 5) =       0.000272788622
  error estimate for blocks of size 2^( 6) =       0.000274492979
  error estimate for blocks of size 2^( 7) =       0.000275386855
  error estimate for blocks of size 2^( 8) =       0.000276430013
  error estimate for blocks of size 2^( 9) =       0.000278375504

      target function =                  N/A
              le_mean =     -22.824790964385
             les_mean =     521.470860728640
             stat err =       0.000276171338
             autocorr =       1.263034780371
              std dev =       0.695049830585
             le_variance =       0.483094266997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483092502892
                                         uncertainty =       0.001321764808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245737224
  error estimate for blocks of size 2^( 2) =       0.000254953516
  error estimate for blocks of size 2^( 3) =       0.000263215214
  error estimate for blocks of size 2^( 4) =       0.000269158807
  error estimate for blocks of size 2^( 5) =       0.000272788622
  error estimate for blocks of size 2^( 6) =       0.000274492979
  error estimate for blocks of size 2^( 7) =       0.000275386855
  error estimate for blocks of size 2^( 8) =       0.000276430013
  error estimate for blocks of size 2^( 9) =       0.000278375504

      target function =                  N/A
              le_mean =     -22.824790964385
             les_mean =     521.470860728640
             stat err =       0.000276171338
             autocorr =       1.263034780371
              std dev =       0.695049830585
             le_variance =       0.483094266997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824790964385        initial  <--
     3.9062e+35     3.9062e+36             0.0000e+00       -22.824790964385
     1.5625e+36     1.5625e+37             0.0000e+00       -22.824790964385
     6.2500e+36     6.2500e+37             0.0000e+00       -22.824790964385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.2881
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8907e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8516
    reference variance = 1.15312
====================================================
  Execution time = 1.0115e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1398e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9983e-01
  Total weights = 7.857098824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8139e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483329741405
                                         uncertainty =       0.001335318734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483329741405
                                         uncertainty =       0.001335318734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245797709
  error estimate for blocks of size 2^( 2) =       0.000255149504
  error estimate for blocks of size 2^( 3) =       0.000263529293
  error estimate for blocks of size 2^( 4) =       0.000269279332
  error estimate for blocks of size 2^( 5) =       0.000272778253
  error estimate for blocks of size 2^( 6) =       0.000274830608
  error estimate for blocks of size 2^( 7) =       0.000276127017
  error estimate for blocks of size 2^( 8) =       0.000276958196
  error estimate for blocks of size 2^( 9) =       0.000277280123

      target function =                  N/A
              le_mean =     -22.824082379237
             les_mean =     521.438562935165
             stat err =       0.000276298986
             autocorr =       1.263580513531
              std dev =       0.695220908096
             le_variance =       0.483332111054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282408237924e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+36, overlap shift 3.9062e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824082379230       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824082379230       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+37, overlap shift 1.5625e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824082379230       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824082379230       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+37, overlap shift 6.2500e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824082379230       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824082379230       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153823 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1930e+02
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.9117
    reference variance = 1.13559
====================================================
  Execution time = 9.9342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0053e-01
  Total weights = 7.8565e+06
  Execution time = 1.4097e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246062526
  error estimate for blocks of size 2^( 2) =       0.000255311178
  error estimate for blocks of size 2^( 3) =       0.000263265892
  error estimate for blocks of size 2^( 4) =       0.000269179754
  error estimate for blocks of size 2^( 5) =       0.000272706753
  error estimate for blocks of size 2^( 6) =       0.000274929902
  error estimate for blocks of size 2^( 7) =       0.000275822698
  error estimate for blocks of size 2^( 8) =       0.000276504438
  error estimate for blocks of size 2^( 9) =       0.000277323809

      target function =                  N/A
              le_mean =     -22.824655402734
             les_mean =     521.465423177986
             stat err =       0.000276145212
             autocorr =       1.259459130046
              std dev =       0.695969921949
             le_variance =       0.484374132258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246062526
  error estimate for blocks of size 2^( 2) =       0.000255311178
  error estimate for blocks of size 2^( 3) =       0.000263265892
  error estimate for blocks of size 2^( 4) =       0.000269179754
  error estimate for blocks of size 2^( 5) =       0.000272706753
  error estimate for blocks of size 2^( 6) =       0.000274929902
  error estimate for blocks of size 2^( 7) =       0.000275822698
  error estimate for blocks of size 2^( 8) =       0.000276504438
  error estimate for blocks of size 2^( 9) =       0.000277323809

      target function =                  N/A
              le_mean =     -22.824655402734
             les_mean =     521.465423177986
             stat err =       0.000276145212
             autocorr =       1.259459130046
              std dev =       0.695969921949
             le_variance =       0.484374132258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246062526
  error estimate for blocks of size 2^( 2) =       0.000255311178
  error estimate for blocks of size 2^( 3) =       0.000263265892
  error estimate for blocks of size 2^( 4) =       0.000269179754
  error estimate for blocks of size 2^( 5) =       0.000272706753
  error estimate for blocks of size 2^( 6) =       0.000274929902
  error estimate for blocks of size 2^( 7) =       0.000275822698
  error estimate for blocks of size 2^( 8) =       0.000276504438
  error estimate for blocks of size 2^( 9) =       0.000277323809

      target function =                  N/A
              le_mean =     -22.824655402734
             les_mean =     521.465423177986
             stat err =       0.000276145212
             autocorr =       1.259459130046
              std dev =       0.695969921949
             le_variance =       0.484374132258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484373979018
                                         uncertainty =       0.001394669681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246062526
  error estimate for blocks of size 2^( 2) =       0.000255311178
  error estimate for blocks of size 2^( 3) =       0.000263265892
  error estimate for blocks of size 2^( 4) =       0.000269179754
  error estimate for blocks of size 2^( 5) =       0.000272706753
  error estimate for blocks of size 2^( 6) =       0.000274929902
  error estimate for blocks of size 2^( 7) =       0.000275822698
  error estimate for blocks of size 2^( 8) =       0.000276504438
  error estimate for blocks of size 2^( 9) =       0.000277323809

      target function =                  N/A
              le_mean =     -22.824655402734
             les_mean =     521.465423177986
             stat err =       0.000276145212
             autocorr =       1.259459130046
              std dev =       0.695969921949
             le_variance =       0.484374132258


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824655402734        initial  <--
     3.9062e+36     3.9062e+37             0.0000e+00       -22.824655402734
     1.5625e+37     1.5625e+38             0.0000e+00       -22.824655402734
     6.2500e+37     6.2500e+38             0.0000e+00       -22.824655402734

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.0814
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8939e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.9528
    reference variance = 2.23404
====================================================
  Execution time = 1.0002e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1421e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0364e-01
  Total weights = 7.857576981e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8129e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486138146091
                                         uncertainty =       0.002246352667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486138146091
                                         uncertainty =       0.002246352667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246509719
  error estimate for blocks of size 2^( 2) =       0.000255641117
  error estimate for blocks of size 2^( 3) =       0.000264012086
  error estimate for blocks of size 2^( 4) =       0.000269767724
  error estimate for blocks of size 2^( 5) =       0.000273481627
  error estimate for blocks of size 2^( 6) =       0.000275305475
  error estimate for blocks of size 2^( 7) =       0.000275979686
  error estimate for blocks of size 2^( 8) =       0.000277072674
  error estimate for blocks of size 2^( 9) =       0.000277672654

      target function =                  N/A
              le_mean =     -22.824841150116
             les_mean =     521.477018103012
             stat err =       0.000276507622
             autocorr =       1.258189684467
              std dev =       0.697234776918
             le_variance =       0.486136334143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282484115012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+37, overlap shift 3.9062e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824841150108       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824841150108       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824841499329       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+37 is 6.602582e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+38, overlap shift 1.5625e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824841150108       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824841150108       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824841150108       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824841150108       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+38 is 1.687420e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+38, overlap shift 6.2500e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824841150108       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824841150108       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824841150108       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824841150108       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+38 is 4.218551e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155488 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1816e+02
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8896
    reference variance = 1.24361
====================================================
  Execution time = 9.9511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9940e-01
  Total weights = 7.8569e+06
  Execution time = 1.4099e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245816157
  error estimate for blocks of size 2^( 2) =       0.000254941828
  error estimate for blocks of size 2^( 3) =       0.000263206061
  error estimate for blocks of size 2^( 4) =       0.000269153436
  error estimate for blocks of size 2^( 5) =       0.000272596333
  error estimate for blocks of size 2^( 6) =       0.000274604057
  error estimate for blocks of size 2^( 7) =       0.000275147740
  error estimate for blocks of size 2^( 8) =       0.000275454109
  error estimate for blocks of size 2^( 9) =       0.000275955214

      target function =                  N/A
              le_mean =     -22.824645172285
             les_mean =     521.463823107808
             stat err =       0.000275290280
             autocorr =       1.254182982272
              std dev =       0.695273087304
             le_variance =       0.483404665929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245816157
  error estimate for blocks of size 2^( 2) =       0.000254941828
  error estimate for blocks of size 2^( 3) =       0.000263206061
  error estimate for blocks of size 2^( 4) =       0.000269153436
  error estimate for blocks of size 2^( 5) =       0.000272596333
  error estimate for blocks of size 2^( 6) =       0.000274604057
  error estimate for blocks of size 2^( 7) =       0.000275147740
  error estimate for blocks of size 2^( 8) =       0.000275454109
  error estimate for blocks of size 2^( 9) =       0.000275955214

      target function =                  N/A
              le_mean =     -22.824645172285
             les_mean =     521.463823107808
             stat err =       0.000275290280
             autocorr =       1.254182982272
              std dev =       0.695273087304
             le_variance =       0.483404665929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245816157
  error estimate for blocks of size 2^( 2) =       0.000254941828
  error estimate for blocks of size 2^( 3) =       0.000263206061
  error estimate for blocks of size 2^( 4) =       0.000269153436
  error estimate for blocks of size 2^( 5) =       0.000272596333
  error estimate for blocks of size 2^( 6) =       0.000274604057
  error estimate for blocks of size 2^( 7) =       0.000275147740
  error estimate for blocks of size 2^( 8) =       0.000275454109
  error estimate for blocks of size 2^( 9) =       0.000275955214

      target function =                  N/A
              le_mean =     -22.824645172285
             les_mean =     521.463823107808
             stat err =       0.000275290280
             autocorr =       1.254182982272
              std dev =       0.695273087304
             le_variance =       0.483404665929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483402884124
                                         uncertainty =       0.001481785427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245816157
  error estimate for blocks of size 2^( 2) =       0.000254941828
  error estimate for blocks of size 2^( 3) =       0.000263206061
  error estimate for blocks of size 2^( 4) =       0.000269153436
  error estimate for blocks of size 2^( 5) =       0.000272596333
  error estimate for blocks of size 2^( 6) =       0.000274604057
  error estimate for blocks of size 2^( 7) =       0.000275147740
  error estimate for blocks of size 2^( 8) =       0.000275454109
  error estimate for blocks of size 2^( 9) =       0.000275955214

      target function =                  N/A
              le_mean =     -22.824645172285
             les_mean =     521.463823107808
             stat err =       0.000275290280
             autocorr =       1.254182982272
              std dev =       0.695273087304
             le_variance =       0.483404665929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824645172285        initial  <--
     3.9062e+37     3.9062e+38             6.6026e-42       -22.824645172285
     1.5625e+38     1.5625e+39             1.6874e-42       -22.824645172285
     6.2500e+38     6.2500e+39             4.2186e-43       -22.824645172285

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.2536
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8842e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8538
    reference variance = 0.344288
====================================================
  Execution time = 1.0000e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1412e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9904e-01
  Total weights = 7.857196300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8199e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483502287868
                                         uncertainty =       0.001393098527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483502287868
                                         uncertainty =       0.001393098527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245842332
  error estimate for blocks of size 2^( 2) =       0.000255092718
  error estimate for blocks of size 2^( 3) =       0.000263492246
  error estimate for blocks of size 2^( 4) =       0.000269457548
  error estimate for blocks of size 2^( 5) =       0.000272869090
  error estimate for blocks of size 2^( 6) =       0.000274716878
  error estimate for blocks of size 2^( 7) =       0.000275476080
  error estimate for blocks of size 2^( 8) =       0.000276140025
  error estimate for blocks of size 2^( 9) =       0.000276410347

      target function =                  N/A
              le_mean =     -22.824385065258
             les_mean =     521.451597926541
             stat err =       0.000275685832
             autocorr =       1.257521911812
              std dev =       0.695347121357
             le_variance =       0.483507619180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282438506526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+38, overlap shift 3.9062e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824385065250       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824385065250       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+39, overlap shift 1.5625e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824385065250       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824385065250       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+39, overlap shift 6.2500e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824385065250       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824385065250       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1822e+02
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8068
    reference variance = 0.360285
====================================================
  Execution time = 9.9988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0841e-01
  Total weights = 7.8570e+06
  Execution time = 1.4108e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247613063
  error estimate for blocks of size 2^( 2) =       0.000256866964
  error estimate for blocks of size 2^( 3) =       0.000265071200
  error estimate for blocks of size 2^( 4) =       0.000271171312
  error estimate for blocks of size 2^( 5) =       0.000274903414
  error estimate for blocks of size 2^( 6) =       0.000276314101
  error estimate for blocks of size 2^( 7) =       0.000277320071
  error estimate for blocks of size 2^( 8) =       0.000278347111
  error estimate for blocks of size 2^( 9) =       0.000278573869

      target function =                  N/A
              le_mean =     -22.824921052323
             les_mean =     521.485433770276
             stat err =       0.000277638788
             autocorr =       1.257225484164
              std dev =       0.700355502564
             le_variance =       0.490497829971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247613063
  error estimate for blocks of size 2^( 2) =       0.000256866964
  error estimate for blocks of size 2^( 3) =       0.000265071200
  error estimate for blocks of size 2^( 4) =       0.000271171312
  error estimate for blocks of size 2^( 5) =       0.000274903414
  error estimate for blocks of size 2^( 6) =       0.000276314101
  error estimate for blocks of size 2^( 7) =       0.000277320071
  error estimate for blocks of size 2^( 8) =       0.000278347111
  error estimate for blocks of size 2^( 9) =       0.000278573869

      target function =                  N/A
              le_mean =     -22.824921052323
             les_mean =     521.485433770276
             stat err =       0.000277638788
             autocorr =       1.257225484164
              std dev =       0.700355502564
             le_variance =       0.490497829971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247613063
  error estimate for blocks of size 2^( 2) =       0.000256866964
  error estimate for blocks of size 2^( 3) =       0.000265071200
  error estimate for blocks of size 2^( 4) =       0.000271171312
  error estimate for blocks of size 2^( 5) =       0.000274903414
  error estimate for blocks of size 2^( 6) =       0.000276314101
  error estimate for blocks of size 2^( 7) =       0.000277320071
  error estimate for blocks of size 2^( 8) =       0.000278347111
  error estimate for blocks of size 2^( 9) =       0.000278573869

      target function =                  N/A
              le_mean =     -22.824921052323
             les_mean =     521.485433770276
             stat err =       0.000277638788
             autocorr =       1.257225484164
              std dev =       0.700355502564
             le_variance =       0.490497829971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490499488493
                                         uncertainty =       0.003061489074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247613063
  error estimate for blocks of size 2^( 2) =       0.000256866964
  error estimate for blocks of size 2^( 3) =       0.000265071200
  error estimate for blocks of size 2^( 4) =       0.000271171312
  error estimate for blocks of size 2^( 5) =       0.000274903414
  error estimate for blocks of size 2^( 6) =       0.000276314101
  error estimate for blocks of size 2^( 7) =       0.000277320071
  error estimate for blocks of size 2^( 8) =       0.000278347111
  error estimate for blocks of size 2^( 9) =       0.000278573869

      target function =                  N/A
              le_mean =     -22.824921052323
             les_mean =     521.485433770276
             stat err =       0.000277638788
             autocorr =       1.257225484164
              std dev =       0.700355502564
             le_variance =       0.490497829971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824921052323        initial  <--
     3.9062e+38     3.9062e+39             0.0000e+00       -22.824921052323
     1.5625e+39     1.5625e+40             0.0000e+00       -22.824921052323
     6.2500e+39     6.2500e+40             0.0000e+00       -22.824921052323

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.6913
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8891e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8088
    reference variance = 0.329311
====================================================
  Execution time = 9.9698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1438e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0068e-01
  Total weights = 7.856769670e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8374e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483745505829
                                         uncertainty =       0.001278925985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483745505829
                                         uncertainty =       0.001278925985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245903071
  error estimate for blocks of size 2^( 2) =       0.000255216818
  error estimate for blocks of size 2^( 3) =       0.000263692677
  error estimate for blocks of size 2^( 4) =       0.000269710474
  error estimate for blocks of size 2^( 5) =       0.000273170428
  error estimate for blocks of size 2^( 6) =       0.000275029898
  error estimate for blocks of size 2^( 7) =       0.000275234632
  error estimate for blocks of size 2^( 8) =       0.000276422815
  error estimate for blocks of size 2^( 9) =       0.000277288894

      target function =                  N/A
              le_mean =     -22.824481351788
             les_mean =     521.457625511619
             stat err =       0.000275994060
             autocorr =       1.259712861199
              std dev =       0.695518917332
             le_variance =       0.483746564366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282448135179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+39, overlap shift 3.9062e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824481351782       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824481351782       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+40, overlap shift 1.5625e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824481351782       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824481351782       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+40, overlap shift 6.2500e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824481351782       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824481351782       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1808e+02
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7885
    reference variance = 0.338615
====================================================
  Execution time = 9.9543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0406e-01
  Total weights = 7.8569e+06
  Execution time = 1.4112e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246605209
  error estimate for blocks of size 2^( 2) =       0.000255757200
  error estimate for blocks of size 2^( 3) =       0.000264121065
  error estimate for blocks of size 2^( 4) =       0.000270196960
  error estimate for blocks of size 2^( 5) =       0.000273498714
  error estimate for blocks of size 2^( 6) =       0.000275814330
  error estimate for blocks of size 2^( 7) =       0.000277418950
  error estimate for blocks of size 2^( 8) =       0.000277199175
  error estimate for blocks of size 2^( 9) =       0.000276543258

      target function =                  N/A
              le_mean =     -22.824682659278
             les_mean =     521.470194283244
             stat err =       0.000276743928
             autocorr =       1.259365263281
              std dev =       0.697504862993
             le_variance =       0.486513033899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246605209
  error estimate for blocks of size 2^( 2) =       0.000255757200
  error estimate for blocks of size 2^( 3) =       0.000264121065
  error estimate for blocks of size 2^( 4) =       0.000270196960
  error estimate for blocks of size 2^( 5) =       0.000273498714
  error estimate for blocks of size 2^( 6) =       0.000275814330
  error estimate for blocks of size 2^( 7) =       0.000277418950
  error estimate for blocks of size 2^( 8) =       0.000277199175
  error estimate for blocks of size 2^( 9) =       0.000276543258

      target function =                  N/A
              le_mean =     -22.824682659278
             les_mean =     521.470194283244
             stat err =       0.000276743928
             autocorr =       1.259365263281
              std dev =       0.697504862993
             le_variance =       0.486513033899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246605209
  error estimate for blocks of size 2^( 2) =       0.000255757200
  error estimate for blocks of size 2^( 3) =       0.000264121065
  error estimate for blocks of size 2^( 4) =       0.000270196960
  error estimate for blocks of size 2^( 5) =       0.000273498714
  error estimate for blocks of size 2^( 6) =       0.000275814330
  error estimate for blocks of size 2^( 7) =       0.000277418950
  error estimate for blocks of size 2^( 8) =       0.000277199175
  error estimate for blocks of size 2^( 9) =       0.000276543258

      target function =                  N/A
              le_mean =     -22.824682659278
             les_mean =     521.470194283244
             stat err =       0.000276743928
             autocorr =       1.259365263281
              std dev =       0.697504862993
             le_variance =       0.486513033899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486511394530
                                         uncertainty =       0.001580139989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246605209
  error estimate for blocks of size 2^( 2) =       0.000255757200
  error estimate for blocks of size 2^( 3) =       0.000264121065
  error estimate for blocks of size 2^( 4) =       0.000270196960
  error estimate for blocks of size 2^( 5) =       0.000273498714
  error estimate for blocks of size 2^( 6) =       0.000275814330
  error estimate for blocks of size 2^( 7) =       0.000277418950
  error estimate for blocks of size 2^( 8) =       0.000277199175
  error estimate for blocks of size 2^( 9) =       0.000276543258

      target function =                  N/A
              le_mean =     -22.824682659278
             les_mean =     521.470194283244
             stat err =       0.000276743928
             autocorr =       1.259365263281
              std dev =       0.697504862993
             le_variance =       0.486513033899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824682659278        initial  <--
     3.9062e+39     3.9062e+40             0.0000e+00       -22.824682659278
     1.5625e+40     1.5625e+41             0.0000e+00       -22.824682659278
     6.2500e+40     6.2500e+41             0.0000e+00       -22.824682659278

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.3771
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8847e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2838e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6946
    reference variance = 0.601211
====================================================
  Execution time = 9.8407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1426e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0294e-01
  Total weights = 7.856538095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8519e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485452351806
                                         uncertainty =       0.001481490785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485452351806
                                         uncertainty =       0.001481490785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246337443
  error estimate for blocks of size 2^( 2) =       0.000255453964
  error estimate for blocks of size 2^( 3) =       0.000263657650
  error estimate for blocks of size 2^( 4) =       0.000269711762
  error estimate for blocks of size 2^( 5) =       0.000273603017
  error estimate for blocks of size 2^( 6) =       0.000275070768
  error estimate for blocks of size 2^( 7) =       0.000275909205
  error estimate for blocks of size 2^( 8) =       0.000278264070
  error estimate for blocks of size 2^( 9) =       0.000278222297

      target function =                  N/A
              le_mean =     -22.825173913168
             les_mean =     521.491503169863
             stat err =       0.000276866585
             autocorr =       1.263223595399
              std dev =       0.696747505830
             le_variance =       0.485457086881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282517391317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+40, overlap shift 3.9062e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825173913163       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825173913163       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+41, overlap shift 1.5625e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825173913163       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825173913163       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+41, overlap shift 6.2500e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825173913163       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825173913163       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1694e+02
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.9015
    reference variance = 0.446344
====================================================
  Execution time = 9.7624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0543e-01
  Total weights = 7.8564e+06
  Execution time = 1.4139e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246308833
  error estimate for blocks of size 2^( 2) =       0.000255559741
  error estimate for blocks of size 2^( 3) =       0.000263730119
  error estimate for blocks of size 2^( 4) =       0.000269467374
  error estimate for blocks of size 2^( 5) =       0.000272967911
  error estimate for blocks of size 2^( 6) =       0.000275375518
  error estimate for blocks of size 2^( 7) =       0.000276485189
  error estimate for blocks of size 2^( 8) =       0.000276639788
  error estimate for blocks of size 2^( 9) =       0.000277925048

      target function =                  N/A
              le_mean =     -22.824526866661
             les_mean =     521.464452325505
             stat err =       0.000276606386
             autocorr =       1.261143283586
              std dev =       0.696666584161
             le_variance =       0.485344329487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246308833
  error estimate for blocks of size 2^( 2) =       0.000255559741
  error estimate for blocks of size 2^( 3) =       0.000263730119
  error estimate for blocks of size 2^( 4) =       0.000269467374
  error estimate for blocks of size 2^( 5) =       0.000272967911
  error estimate for blocks of size 2^( 6) =       0.000275375518
  error estimate for blocks of size 2^( 7) =       0.000276485189
  error estimate for blocks of size 2^( 8) =       0.000276639788
  error estimate for blocks of size 2^( 9) =       0.000277925048

      target function =                  N/A
              le_mean =     -22.824526866661
             les_mean =     521.464452325505
             stat err =       0.000276606386
             autocorr =       1.261143283586
              std dev =       0.696666584161
             le_variance =       0.485344329487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246308833
  error estimate for blocks of size 2^( 2) =       0.000255559741
  error estimate for blocks of size 2^( 3) =       0.000263730119
  error estimate for blocks of size 2^( 4) =       0.000269467374
  error estimate for blocks of size 2^( 5) =       0.000272967911
  error estimate for blocks of size 2^( 6) =       0.000275375518
  error estimate for blocks of size 2^( 7) =       0.000276485189
  error estimate for blocks of size 2^( 8) =       0.000276639788
  error estimate for blocks of size 2^( 9) =       0.000277925048

      target function =                  N/A
              le_mean =     -22.824526866661
             les_mean =     521.464452325505
             stat err =       0.000276606386
             autocorr =       1.261143283586
              std dev =       0.696666584161
             le_variance =       0.485344329487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485343713095
                                         uncertainty =       0.002406238669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246308833
  error estimate for blocks of size 2^( 2) =       0.000255559741
  error estimate for blocks of size 2^( 3) =       0.000263730119
  error estimate for blocks of size 2^( 4) =       0.000269467374
  error estimate for blocks of size 2^( 5) =       0.000272967911
  error estimate for blocks of size 2^( 6) =       0.000275375518
  error estimate for blocks of size 2^( 7) =       0.000276485189
  error estimate for blocks of size 2^( 8) =       0.000276639788
  error estimate for blocks of size 2^( 9) =       0.000277925048

      target function =                  N/A
              le_mean =     -22.824526866661
             les_mean =     521.464452325505
             stat err =       0.000276606386
             autocorr =       1.261143283586
              std dev =       0.696666584161
             le_variance =       0.485344329487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824526866661        initial  <--
     3.9062e+40     3.9062e+41             0.0000e+00       -22.824526866661
     1.5625e+41     1.5625e+42             0.0000e+00       -22.824526866661
     6.2500e+41     6.2500e+42             0.0000e+00       -22.824526866661

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 168.3777
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8532e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8266
    reference variance = 0.333053
====================================================
  Execution time = 1.0009e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1360e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0196e-01
  Total weights = 7.856606710e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8157e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485609463107
                                         uncertainty =       0.001523051804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485609463107
                                         uncertainty =       0.001523051804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246376201
  error estimate for blocks of size 2^( 2) =       0.000255619292
  error estimate for blocks of size 2^( 3) =       0.000263701012
  error estimate for blocks of size 2^( 4) =       0.000269607992
  error estimate for blocks of size 2^( 5) =       0.000272988063
  error estimate for blocks of size 2^( 6) =       0.000274672225
  error estimate for blocks of size 2^( 7) =       0.000275751843
  error estimate for blocks of size 2^( 8) =       0.000275897409
  error estimate for blocks of size 2^( 9) =       0.000275735095

      target function =                  N/A
              le_mean =     -22.824449699986
             les_mean =     521.457462209322
             stat err =       0.000275514143
             autocorr =       1.250518979680
              std dev =       0.696857129206
             le_variance =       0.485609858525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282444969999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+41, overlap shift 3.9062e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824449699978       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824449699978       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+42, overlap shift 1.5625e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824449699978       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824449699978       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+42, overlap shift 6.2500e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824449699978       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824449699978       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1826e+02
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8538
    reference variance = 0.695421
====================================================
  Execution time = 9.9060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9884e-01
  Total weights = 7.8572e+06
  Execution time = 1.4110e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245749076
  error estimate for blocks of size 2^( 2) =       0.000254950009
  error estimate for blocks of size 2^( 3) =       0.000263308306
  error estimate for blocks of size 2^( 4) =       0.000269163567
  error estimate for blocks of size 2^( 5) =       0.000272651842
  error estimate for blocks of size 2^( 6) =       0.000274436055
  error estimate for blocks of size 2^( 7) =       0.000275172732
  error estimate for blocks of size 2^( 8) =       0.000275433896
  error estimate for blocks of size 2^( 9) =       0.000275490655

      target function =                  N/A
              le_mean =     -22.824693434500
             les_mean =     521.465471035237
             stat err =       0.000275133334
             autocorr =       1.253437362337
              std dev =       0.695083352398
             le_variance =       0.483140866781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245749076
  error estimate for blocks of size 2^( 2) =       0.000254950009
  error estimate for blocks of size 2^( 3) =       0.000263308306
  error estimate for blocks of size 2^( 4) =       0.000269163567
  error estimate for blocks of size 2^( 5) =       0.000272651842
  error estimate for blocks of size 2^( 6) =       0.000274436055
  error estimate for blocks of size 2^( 7) =       0.000275172732
  error estimate for blocks of size 2^( 8) =       0.000275433896
  error estimate for blocks of size 2^( 9) =       0.000275490655

      target function =                  N/A
              le_mean =     -22.824693434500
             les_mean =     521.465471035237
             stat err =       0.000275133334
             autocorr =       1.253437362337
              std dev =       0.695083352398
             le_variance =       0.483140866781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245749076
  error estimate for blocks of size 2^( 2) =       0.000254950009
  error estimate for blocks of size 2^( 3) =       0.000263308306
  error estimate for blocks of size 2^( 4) =       0.000269163567
  error estimate for blocks of size 2^( 5) =       0.000272651842
  error estimate for blocks of size 2^( 6) =       0.000274436055
  error estimate for blocks of size 2^( 7) =       0.000275172732
  error estimate for blocks of size 2^( 8) =       0.000275433896
  error estimate for blocks of size 2^( 9) =       0.000275490655

      target function =                  N/A
              le_mean =     -22.824693434500
             les_mean =     521.465471035237
             stat err =       0.000275133334
             autocorr =       1.253437362337
              std dev =       0.695083352398
             le_variance =       0.483140866781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483139154827
                                         uncertainty =       0.001218936089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245749076
  error estimate for blocks of size 2^( 2) =       0.000254950009
  error estimate for blocks of size 2^( 3) =       0.000263308306
  error estimate for blocks of size 2^( 4) =       0.000269163567
  error estimate for blocks of size 2^( 5) =       0.000272651842
  error estimate for blocks of size 2^( 6) =       0.000274436055
  error estimate for blocks of size 2^( 7) =       0.000275172732
  error estimate for blocks of size 2^( 8) =       0.000275433896
  error estimate for blocks of size 2^( 9) =       0.000275490655

      target function =                  N/A
              le_mean =     -22.824693434500
             les_mean =     521.465471035237
             stat err =       0.000275133334
             autocorr =       1.253437362337
              std dev =       0.695083352398
             le_variance =       0.483140866781


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824693434500        initial  <--
     3.9062e+41     3.9062e+42             0.0000e+00       -22.824693434500
     1.5625e+42     1.5625e+43             0.0000e+00       -22.824693434500
     6.2500e+42     6.2500e+43             0.0000e+00       -22.824693434500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 169.8658
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8813e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.875
    reference variance = 0.25881
====================================================
  Execution time = 1.0082e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1405e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0056e-01
  Total weights = 7.856206845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8106e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485089353661
                                         uncertainty =       0.001321832734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485089353661
                                         uncertainty =       0.001321832734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246244506
  error estimate for blocks of size 2^( 2) =       0.000255479155
  error estimate for blocks of size 2^( 3) =       0.000263821407
  error estimate for blocks of size 2^( 4) =       0.000269857459
  error estimate for blocks of size 2^( 5) =       0.000273254991
  error estimate for blocks of size 2^( 6) =       0.000275708664
  error estimate for blocks of size 2^( 7) =       0.000276386850
  error estimate for blocks of size 2^( 8) =       0.000276550835
  error estimate for blocks of size 2^( 9) =       0.000276146335

      target function =                  N/A
              le_mean =     -22.824730877669
             les_mean =     521.468898673463
             stat err =       0.000276198171
             autocorr =       1.258080694917
              std dev =       0.696484639738
             le_variance =       0.485090853391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282473087767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+42, overlap shift 3.9062e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824730877662       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824730877662       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+43, overlap shift 1.5625e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824730877662       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824730877662       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+43, overlap shift 6.2500e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824730877662       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824730877662       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1894e+02
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8147
    reference variance = 0.397418
====================================================
  Execution time = 1.0160e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0145e-01
  Total weights = 7.8569e+06
  Execution time = 1.4108e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245954647
  error estimate for blocks of size 2^( 2) =       0.000254989644
  error estimate for blocks of size 2^( 3) =       0.000263197857
  error estimate for blocks of size 2^( 4) =       0.000268940681
  error estimate for blocks of size 2^( 5) =       0.000272816071
  error estimate for blocks of size 2^( 6) =       0.000274814432
  error estimate for blocks of size 2^( 7) =       0.000276058418
  error estimate for blocks of size 2^( 8) =       0.000277251730
  error estimate for blocks of size 2^( 9) =       0.000278311838

      target function =                  N/A
              le_mean =     -22.824513467421
             les_mean =     521.459863875889
             stat err =       0.000276609105
             autocorr =       1.264802972348
              std dev =       0.695664794683
             le_variance =       0.483949506561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245954647
  error estimate for blocks of size 2^( 2) =       0.000254989644
  error estimate for blocks of size 2^( 3) =       0.000263197857
  error estimate for blocks of size 2^( 4) =       0.000268940681
  error estimate for blocks of size 2^( 5) =       0.000272816071
  error estimate for blocks of size 2^( 6) =       0.000274814432
  error estimate for blocks of size 2^( 7) =       0.000276058418
  error estimate for blocks of size 2^( 8) =       0.000277251730
  error estimate for blocks of size 2^( 9) =       0.000278311838

      target function =                  N/A
              le_mean =     -22.824513467421
             les_mean =     521.459863875889
             stat err =       0.000276609105
             autocorr =       1.264802972348
              std dev =       0.695664794683
             le_variance =       0.483949506561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245954647
  error estimate for blocks of size 2^( 2) =       0.000254989644
  error estimate for blocks of size 2^( 3) =       0.000263197857
  error estimate for blocks of size 2^( 4) =       0.000268940681
  error estimate for blocks of size 2^( 5) =       0.000272816071
  error estimate for blocks of size 2^( 6) =       0.000274814432
  error estimate for blocks of size 2^( 7) =       0.000276058418
  error estimate for blocks of size 2^( 8) =       0.000277251730
  error estimate for blocks of size 2^( 9) =       0.000278311838

      target function =                  N/A
              le_mean =     -22.824513467421
             les_mean =     521.459863875889
             stat err =       0.000276609105
             autocorr =       1.264802972348
              std dev =       0.695664794683
             le_variance =       0.483949506561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483948642305
                                         uncertainty =       0.001315145928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245954647
  error estimate for blocks of size 2^( 2) =       0.000254989644
  error estimate for blocks of size 2^( 3) =       0.000263197857
  error estimate for blocks of size 2^( 4) =       0.000268940681
  error estimate for blocks of size 2^( 5) =       0.000272816071
  error estimate for blocks of size 2^( 6) =       0.000274814432
  error estimate for blocks of size 2^( 7) =       0.000276058418
  error estimate for blocks of size 2^( 8) =       0.000277251730
  error estimate for blocks of size 2^( 9) =       0.000278311838

      target function =                  N/A
              le_mean =     -22.824513467421
             les_mean =     521.459863875889
             stat err =       0.000276609105
             autocorr =       1.264802972348
              std dev =       0.695664794683
             le_variance =       0.483949506561


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824513467421        initial  <--
     3.9062e+42     3.9062e+43             0.0000e+00       -22.824513467421
     1.5625e+43     1.5625e+44             0.0000e+00       -22.824513467421
     6.2500e+43     6.2500e+44             0.0000e+00       -22.824513467421

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.3122
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9126e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8471
    reference variance = 0.261488
====================================================
  Execution time = 1.0169e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1436e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0243e-01
  Total weights = 7.857500525e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8175e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485437507160
                                         uncertainty =       0.001536477017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485437507160
                                         uncertainty =       0.001536477017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246333149
  error estimate for blocks of size 2^( 2) =       0.000255515821
  error estimate for blocks of size 2^( 3) =       0.000263795448
  error estimate for blocks of size 2^( 4) =       0.000269490483
  error estimate for blocks of size 2^( 5) =       0.000272481579
  error estimate for blocks of size 2^( 6) =       0.000274381507
  error estimate for blocks of size 2^( 7) =       0.000275317102
  error estimate for blocks of size 2^( 8) =       0.000276099074
  error estimate for blocks of size 2^( 9) =       0.000276472593

      target function =                  N/A
              le_mean =     -22.824708011738
             les_mean =     521.469729506168
             stat err =       0.000275567569
             autocorr =       1.251441333391
              std dev =       0.696735359130
             le_variance =       0.485440160662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282470801174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+43, overlap shift 3.9063e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824708011736       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824708011736       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+44, overlap shift 1.5625e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824708011736       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824708011736       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+44, overlap shift 6.2500e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824708011736       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824708011736       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1988e+02
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.871
    reference variance = 0.506322
====================================================
  Execution time = 9.9588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9870e-01
  Total weights = 7.8567e+06
  Execution time = 1.4087e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245693057
  error estimate for blocks of size 2^( 2) =       0.000254973935
  error estimate for blocks of size 2^( 3) =       0.000263185956
  error estimate for blocks of size 2^( 4) =       0.000269041132
  error estimate for blocks of size 2^( 5) =       0.000272631721
  error estimate for blocks of size 2^( 6) =       0.000274378730
  error estimate for blocks of size 2^( 7) =       0.000275565566
  error estimate for blocks of size 2^( 8) =       0.000277072297
  error estimate for blocks of size 2^( 9) =       0.000277649746

      target function =                  N/A
              le_mean =     -22.824548038517
             les_mean =     521.458697418808
             stat err =       0.000276166585
             autocorr =       1.263445428942
              std dev =       0.694924907836
             le_variance =       0.482920627531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245693057
  error estimate for blocks of size 2^( 2) =       0.000254973935
  error estimate for blocks of size 2^( 3) =       0.000263185956
  error estimate for blocks of size 2^( 4) =       0.000269041132
  error estimate for blocks of size 2^( 5) =       0.000272631721
  error estimate for blocks of size 2^( 6) =       0.000274378730
  error estimate for blocks of size 2^( 7) =       0.000275565566
  error estimate for blocks of size 2^( 8) =       0.000277072297
  error estimate for blocks of size 2^( 9) =       0.000277649746

      target function =                  N/A
              le_mean =     -22.824548038517
             les_mean =     521.458697418808
             stat err =       0.000276166585
             autocorr =       1.263445428942
              std dev =       0.694924907836
             le_variance =       0.482920627531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245693057
  error estimate for blocks of size 2^( 2) =       0.000254973935
  error estimate for blocks of size 2^( 3) =       0.000263185956
  error estimate for blocks of size 2^( 4) =       0.000269041132
  error estimate for blocks of size 2^( 5) =       0.000272631721
  error estimate for blocks of size 2^( 6) =       0.000274378730
  error estimate for blocks of size 2^( 7) =       0.000275565566
  error estimate for blocks of size 2^( 8) =       0.000277072297
  error estimate for blocks of size 2^( 9) =       0.000277649746

      target function =                  N/A
              le_mean =     -22.824548038517
             les_mean =     521.458697418808
             stat err =       0.000276166585
             autocorr =       1.263445428942
              std dev =       0.694924907836
             le_variance =       0.482920627531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482923044679
                                         uncertainty =       0.001439603839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245693057
  error estimate for blocks of size 2^( 2) =       0.000254973935
  error estimate for blocks of size 2^( 3) =       0.000263185956
  error estimate for blocks of size 2^( 4) =       0.000269041132
  error estimate for blocks of size 2^( 5) =       0.000272631721
  error estimate for blocks of size 2^( 6) =       0.000274378730
  error estimate for blocks of size 2^( 7) =       0.000275565566
  error estimate for blocks of size 2^( 8) =       0.000277072297
  error estimate for blocks of size 2^( 9) =       0.000277649746

      target function =                  N/A
              le_mean =     -22.824548038517
             les_mean =     521.458697418808
             stat err =       0.000276166585
             autocorr =       1.263445428942
              std dev =       0.694924907836
             le_variance =       0.482920627531


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824548038517        initial  <--
     3.9062e+43     3.9063e+44             0.0000e+00       -22.824548038517
     1.5625e+44     1.5625e+45             0.0000e+00       -22.824548038517
     6.2500e+44     6.2500e+45             0.0000e+00       -22.824548038517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.2876
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9018e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2837e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8529
    reference variance = 0.45293
====================================================
  Execution time = 1.0058e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1369e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0157e-01
  Total weights = 7.857213222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8147e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484937309378
                                         uncertainty =       0.001237450535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484937309378
                                         uncertainty =       0.001237450535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246205701
  error estimate for blocks of size 2^( 2) =       0.000255361183
  error estimate for blocks of size 2^( 3) =       0.000263718535
  error estimate for blocks of size 2^( 4) =       0.000269680544
  error estimate for blocks of size 2^( 5) =       0.000273218145
  error estimate for blocks of size 2^( 6) =       0.000275057302
  error estimate for blocks of size 2^( 7) =       0.000276385613
  error estimate for blocks of size 2^( 8) =       0.000276216556
  error estimate for blocks of size 2^( 9) =       0.000276867466

      target function =                  N/A
              le_mean =     -22.824596730079
             les_mean =     521.463786093441
             stat err =       0.000276131735
             autocorr =       1.257871947352
              std dev =       0.696374883272
             le_variance =       0.484937978052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282459673008e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9063e+44, overlap shift 3.9063e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824596730074       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596730074       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9063e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e+45, overlap shift 1.5625e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824596730074       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596730074       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 6.2500e+45, overlap shift 6.2500e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824596730074       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596730074       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1874e+02
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.9295
    reference variance = 0.613481
====================================================
  Execution time = 9.9902e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0368e-01
  Total weights = 7.8571e+06
  Execution time = 1.4092e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246798063
  error estimate for blocks of size 2^( 2) =       0.000255945991
  error estimate for blocks of size 2^( 3) =       0.000264164335
  error estimate for blocks of size 2^( 4) =       0.000269955466
  error estimate for blocks of size 2^( 5) =       0.000273306729
  error estimate for blocks of size 2^( 6) =       0.000274828566
  error estimate for blocks of size 2^( 7) =       0.000275821210
  error estimate for blocks of size 2^( 8) =       0.000276344752
  error estimate for blocks of size 2^( 9) =       0.000275987192

      target function =                  N/A
              le_mean =     -22.825013599174
             les_mean =     521.484930607437
             stat err =       0.000275745430
             autocorr =       1.248340766465
              std dev =       0.698050335787
             le_variance =       0.487274271293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246798063
  error estimate for blocks of size 2^( 2) =       0.000255945991
  error estimate for blocks of size 2^( 3) =       0.000264164335
  error estimate for blocks of size 2^( 4) =       0.000269955466
  error estimate for blocks of size 2^( 5) =       0.000273306729
  error estimate for blocks of size 2^( 6) =       0.000274828566
  error estimate for blocks of size 2^( 7) =       0.000275821210
  error estimate for blocks of size 2^( 8) =       0.000276344752
  error estimate for blocks of size 2^( 9) =       0.000275987192

      target function =                  N/A
              le_mean =     -22.825013599174
             les_mean =     521.484930607437
             stat err =       0.000275745430
             autocorr =       1.248340766465
              std dev =       0.698050335787
             le_variance =       0.487274271293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246798063
  error estimate for blocks of size 2^( 2) =       0.000255945991
  error estimate for blocks of size 2^( 3) =       0.000264164335
  error estimate for blocks of size 2^( 4) =       0.000269955466
  error estimate for blocks of size 2^( 5) =       0.000273306729
  error estimate for blocks of size 2^( 6) =       0.000274828566
  error estimate for blocks of size 2^( 7) =       0.000275821210
  error estimate for blocks of size 2^( 8) =       0.000276344752
  error estimate for blocks of size 2^( 9) =       0.000275987192

      target function =                  N/A
              le_mean =     -22.825013599174
             les_mean =     521.484930607437
             stat err =       0.000275745430
             autocorr =       1.248340766465
              std dev =       0.698050335787
             le_variance =       0.487274271293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487272305006
                                         uncertainty =       0.001276416300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246798063
  error estimate for blocks of size 2^( 2) =       0.000255945991
  error estimate for blocks of size 2^( 3) =       0.000264164335
  error estimate for blocks of size 2^( 4) =       0.000269955466
  error estimate for blocks of size 2^( 5) =       0.000273306729
  error estimate for blocks of size 2^( 6) =       0.000274828566
  error estimate for blocks of size 2^( 7) =       0.000275821210
  error estimate for blocks of size 2^( 8) =       0.000276344752
  error estimate for blocks of size 2^( 9) =       0.000275987192

      target function =                  N/A
              le_mean =     -22.825013599174
             les_mean =     521.484930607437
             stat err =       0.000275745430
             autocorr =       1.248340766465
              std dev =       0.698050335787
             le_variance =       0.487274271293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825013599174        initial  <--
     3.9063e+44     3.9063e+45             0.0000e+00       -22.825013599174
     1.5625e+45     1.5625e+46             0.0000e+00       -22.825013599174
     6.2500e+45     6.2500e+46             0.0000e+00       -22.825013599174

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 170.6307
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.101690e-01 3 1  ON 0
ci_02                -2.209106e-02 3 1  ON 1
ci_03                -2.240403e-02 3 1  ON 2
ci_04                 2.207455e-02 3 1  ON 3
ci_05                -2.139181e-02 3 1  ON 4
ci_06                -2.159307e-02 3 1  ON 5
ci_07                 2.519623e-02 3 1  ON 6
ci_08                -3.659665e-03 3 1  ON 7
ci_09                -1.101573e-02 3 1  ON 8
ci_10                -1.110930e-02 3 1  ON 9
ci_11                 1.639615e-02 3 1  ON 10
ci_12                 1.085403e-02 3 1  ON 11
ci_13                 1.182709e-02 3 1  ON 12
ci_14                 1.710829e-02 3 1  ON 13
ci_15                 7.410727e-03 3 1  ON 14
ci_16                 7.721533e-03 3 1  ON 15
ci_17                -8.944870e-03 3 1  ON 16
ci_18                -9.032076e-03 3 1  ON 17
ci_19                 9.505874e-03 3 1  ON 18
ci_20                 1.048832e-02 3 1  ON 19
ci_21                 8.348787e-03 3 1  ON 20
ci_22                 8.412674e-03 3 1  ON 21
ci_23                 6.596002e-03 3 1  ON 22
ci_24                 7.701769e-03 3 1  ON 23
ci_25                 5.050268e-03 3 1  ON 24
ci_26                 2.517270e-03 3 1  ON 25
ci_27                 2.841738e-03 3 1  ON 26
ci_28                 2.896572e-03 3 1  ON 27
ci_29                 2.684490e-03 3 1  ON 28
ci_30                 6.143579e-04 3 1  ON 29
ci_31                 7.463465e-04 3 1  ON 30
ci_32                 1.618858e-04 3 1  ON 31
ci_33                -8.922773e-05 3 1  ON 32
ci_34                -3.353287e-04 3 1  ON 33
ci_35                -1.403917e-04 3 1  ON 34
ci_36                -2.465795e-04 3 1  ON 35
ci_37                -5.885849e-04 3 1  ON 36
ci_38                -9.811377e-05 3 1  ON 37
ci_39                -6.728433e-05 3 1  ON 38
ci_40                -1.222719e-03 3 1  ON 39
ci_41                 1.627338e-04 3 1  ON 40
ci_42                 2.820814e-04 3 1  ON 41
ci_43                -2.420330e-03 3 1  ON 42
ci_44                -2.352549e-03 3 1  ON 43
ci_45                -2.417978e-04 3 1  ON 44
ci_46                -1.727367e-04 3 1  ON 45
ci_47                -1.097040e-04 3 1  ON 46
ci_48                -3.467346e-06 3 1  ON 47
ci_49                -1.294427e-03 3 1  ON 48
ci_50                -5.335988e-04 3 1  ON 49
ci_51                 1.542350e-04 3 1  ON 50
ci_52                 2.583226e-06 3 1  ON 51
ci_53                -9.100833e-04 3 1  ON 52
ci_54                -7.556168e-04 3 1  ON 53
ci_55                -7.439112e-04 3 1  ON 54
ci_56                 1.500492e-03 3 1  ON 55
ci_57                 1.687084e-03 3 1  ON 56
ci_58                -1.083487e-03 3 1  ON 57
ci_59                -1.437146e-03 3 1  ON 58
ci_60                 6.740598e-04 3 1  ON 59
ci_61                 2.343297e-03 3 1  ON 60
ci_62                -2.873807e-04 3 1  ON 61
ci_63                -9.854388e-05 3 1  ON 62
ci_64                -2.248456e-04 3 1  ON 63
ci_65                -5.825798e-04 3 1  ON 64
ci_66                -5.300662e-04 3 1  ON 65
ci_67                -3.207324e-04 3 1  ON 66
ci_68                -1.925034e-03 3 1  ON 67
ci_69                -1.750362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.8938e+02 secs
  Total Execution time = 1.7328e+04 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
