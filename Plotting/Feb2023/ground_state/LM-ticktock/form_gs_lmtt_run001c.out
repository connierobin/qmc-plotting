Rank =    0  Free Memory = 70671 MB
Rank =    1  Free Memory = 70671 MB
Rank =    2  Free Memory = 70670 MB
Rank =    3  Free Memory = 70669 MB
Rank =    4  Free Memory = 70669 MB
Rank =    5  Free Memory = 70668 MB
Rank =    6  Free Memory = 70668 MB
Rank =    7  Free Memory = 70668 MB
Rank =    8  Free Memory = 70667 MB
Rank =    9  Free Memory = 70667 MB
Rank =   10  Free Memory = 70667 MB
Rank =   11  Free Memory = 70667 MB
Rank =   12  Free Memory = 70667 MB
Rank =   13  Free Memory = 70667 MB
Rank =   14  Free Memory = 70654 MB
Rank =   15  Free Memory = 70654 MB
Rank =   16  Free Memory = 70654 MB
Rank =   17  Free Memory = 70654 MB
Rank =   18  Free Memory = 70654 MB
Rank =   19  Free Memory = 70654 MB
Rank =   20  Free Memory = 70654 MB
Rank =   21  Free Memory = 70654 MB
Rank =   22  Free Memory = 70654 MB
Rank =   23  Free Memory = 70654 MB
Rank =   24  Free Memory = 70654 MB
Rank =   25  Free Memory = 70654 MB
Rank =   26  Free Memory = 70654 MB
Rank =   27  Free Memory = 70654 MB
Rank =   28  Free Memory = 70654 MB
Rank =   29  Free Memory = 70654 MB
Rank =   30  Free Memory = 70654 MB
Rank =   31  Free Memory = 70654 MB
Rank =   32  Free Memory = 70968 MB
Rank =   33  Free Memory = 70968 MB
Rank =   34  Free Memory = 70968 MB
Rank =   35  Free Memory = 70968 MB
Rank =   36  Free Memory = 70968 MB
Rank =   37  Free Memory = 70968 MB
Rank =   38  Free Memory = 70968 MB
Rank =   39  Free Memory = 70968 MB
Rank =   40  Free Memory = 70968 MB
Rank =   41  Free Memory = 70968 MB
Rank =   42  Free Memory = 70968 MB
Rank =   43  Free Memory = 70968 MB
Rank =   44  Free Memory = 70968 MB
Rank =   45  Free Memory = 70968 MB
Rank =   46  Free Memory = 70968 MB
Rank =   47  Free Memory = 70968 MB
Rank =   48  Free Memory = 70968 MB
Rank =   49  Free Memory = 70968 MB
Rank =   50  Free Memory = 70968 MB
Rank =   51  Free Memory = 70968 MB
Rank =   52  Free Memory = 70968 MB
Rank =   53  Free Memory = 70968 MB
Rank =   54  Free Memory = 70968 MB
Rank =   55  Free Memory = 70968 MB
Rank =   56  Free Memory = 70968 MB
Rank =   57  Free Memory = 70968 MB
Rank =   58  Free Memory = 70968 MB
Rank =   59  Free Memory = 70968 MB
Rank =   60  Free Memory = 70968 MB
Rank =   61  Free Memory = 70968 MB
Rank =   62  Free Memory = 70968 MB
Rank =   63  Free Memory = 70968 MB
Rank =   64  Free Memory = 66508 MB
Rank =   65  Free Memory = 66508 MB
Rank =   66  Free Memory = 66508 MB
Rank =   67  Free Memory = 66508 MB
Rank =   68  Free Memory = 66508 MB
Rank =   69  Free Memory = 66508 MB
Rank =   70  Free Memory = 66508 MB
Rank =   71  Free Memory = 66508 MB
Rank =   72  Free Memory = 66508 MB
Rank =   73  Free Memory = 66508 MB
Rank =   74  Free Memory = 66508 MB
Rank =   75  Free Memory = 66508 MB
Rank =   76  Free Memory = 66508 MB
Rank =   77  Free Memory = 66508 MB
Rank =   78  Free Memory = 66508 MB
Rank =   79  Free Memory = 66508 MB
Rank =   80  Free Memory = 66508 MB
Rank =   81  Free Memory = 66508 MB
Rank =   82  Free Memory = 66508 MB
Rank =   83  Free Memory = 66508 MB
Rank =   84  Free Memory = 66508 MB
Rank =   85  Free Memory = 66508 MB
Rank =   86  Free Memory = 66508 MB
Rank =   87  Free Memory = 66508 MB
Rank =   88  Free Memory = 66508 MB
Rank =   89  Free Memory = 66508 MB
Rank =   90  Free Memory = 66508 MB
Rank =   91  Free Memory = 66508 MB
Rank =   92  Free Memory = 66508 MB
Rank =   93  Free Memory = 66508 MB
Rank =   94  Free Memory = 66508 MB
Rank =   95  Free Memory = 66508 MB
Rank =   96  Free Memory = 90025 MB
Rank =   97  Free Memory = 90025 MB
Rank =   98  Free Memory = 90025 MB
Rank =   99  Free Memory = 90025 MB
Rank =  100  Free Memory = 90025 MB
Rank =  101  Free Memory = 90025 MB
Rank =  102  Free Memory = 90025 MB
Rank =  103  Free Memory = 90025 MB
Rank =  104  Free Memory = 90025 MB
Rank =  105  Free Memory = 90025 MB
Rank =  106  Free Memory = 90025 MB
Rank =  107  Free Memory = 90025 MB
Rank =  108  Free Memory = 90025 MB
Rank =  109  Free Memory = 90025 MB
Rank =  110  Free Memory = 90025 MB
Rank =  111  Free Memory = 90025 MB
Rank =  112  Free Memory = 90025 MB
Rank =  113  Free Memory = 90025 MB
Rank =  114  Free Memory = 90025 MB
Rank =  115  Free Memory = 90025 MB
Rank =  116  Free Memory = 90025 MB
Rank =  117  Free Memory = 90025 MB
Rank =  118  Free Memory = 90025 MB
Rank =  119  Free Memory = 90025 MB
Rank =  120  Free Memory = 90025 MB
Rank =  121  Free Memory = 90025 MB
Rank =  122  Free Memory = 90025 MB
Rank =  123  Free Memory = 90025 MB
Rank =  124  Free Memory = 90025 MB
Rank =  125  Free Memory = 90025 MB
Rank =  126  Free Memory = 90025 MB
Rank =  127  Free Memory = 90025 MB
  Input file(s): opt_form_gs_lmtt_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmtt_run001c.xml

  Project = FORM
  date    = 2023-02-15 16:29:01 PST
  host    = n0062.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 205

  Range of prime numbers to use as seeds over processors and threads = 1279-2251


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.520783e-01    1         1 OFF
     uu_1                 8.118465e-02    1         1 OFF
     uu_2                -2.289514e-02    1         1 OFF
     uu_3                -7.809540e-02    1         1 OFF
     uu_4                -1.007945e-01    1         1 OFF
     uu_5                -1.041466e-01    1         1 OFF
     uu_6                -9.248937e-02    1         1 OFF
     uu_7                -6.167856e-02    1         1 OFF
     uu_8                -1.356309e-02    1         1 OFF
     uu_9                 4.774809e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.865722e-01    1         1 OFF
     ud_1                 1.089656e-01    1         1 OFF
     ud_2                -2.717957e-02    1         1 OFF
     ud_3                -9.336090e-02    1         1 OFF
     ud_4                -1.225980e-01    1         1 OFF
     ud_5                -1.296576e-01    1         1 OFF
     ud_6                -1.194160e-01    1         1 OFF
     ud_7                -8.720805e-02    1         1 OFF
     ud_8                -3.650140e-02    1         1 OFF
     ud_9                 3.168597e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.050954e-01    1         1 OFF
     eC_1                -2.549057e-01    1         1 OFF
     eC_2                 1.583892e-04    1         1 OFF
     eC_3                 1.537812e-01    1         1 OFF
     eC_4                 1.925015e-01    1         1 OFF
     eC_5                 1.961238e-01    1         1 OFF
     eC_6                 8.678353e-02    1         1 OFF
     eC_7                 2.352923e-02    1         1 OFF
     eC_8                 4.138097e-03    1         1 OFF
     eC_9                 2.142561e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.966764e-01    1         1 OFF
     eO_1                -4.465232e-01    1         1 OFF
     eO_2                -2.758139e-02    1         1 OFF
     eO_3                 2.256688e-01    1         1 OFF
     eO_4                 3.273497e-01    1         1 OFF
     eO_5                 3.483617e-01    1         1 OFF
     eO_6                 2.488800e-01    1         1 OFF
     eO_7                 9.783621e-02    1         1 OFF
     eO_8                 4.730079e-03    1         1 OFF
     eO_9                 8.877369e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.936747e-02    1         1 OFF
     eH1_1                -1.821057e-02    1         1 OFF
     eH1_2                 1.157517e-03    1         1 OFF
     eH1_3                -1.190901e-02    1         1 OFF
     eH1_4                 6.931901e-03    1         1 OFF
     eH1_5                 1.618511e-02    1         1 OFF
     eH1_6                 3.588845e-02    1         1 OFF
     eH1_7                 3.864144e-02    1         1 OFF
     eH1_8                 2.289899e-02    1         1 OFF
     eH1_9                 5.952142e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.936560e-02    1         1 OFF
     eH2_1                -1.729256e-02    1         1 OFF
     eH2_2                 2.245597e-03    1         1 OFF
     eH2_3                -1.145151e-02    1         1 OFF
     eH2_4                 7.313767e-03    1         1 OFF
     eH2_5                 1.689074e-02    1         1 OFF
     eH2_6                 3.566797e-02    1         1 OFF
     eH2_7                 3.617456e-02    1         1 OFF
     eH2_8                 2.320293e-02    1         1 OFF
     eH2_9                 4.930411e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.741256e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.3551e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8397
    reference variance = 0.473437
====================================================
  Execution time = 2.6491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9252e-01
  Total weights = 1.963756503e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473294621266
                                         uncertainty =       0.002085540876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473294621266
                                         uncertainty =       0.002085540876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486495433
  error estimate for blocks of size 2^( 2) =       0.000507184223
  error estimate for blocks of size 2^( 3) =       0.000527540027
  error estimate for blocks of size 2^( 4) =       0.000542223491
  error estimate for blocks of size 2^( 5) =       0.000552375431
  error estimate for blocks of size 2^( 6) =       0.000558417738
  error estimate for blocks of size 2^( 7) =       0.000561854033

      target function =                  N/A
              le_mean =     -22.818501566386
             les_mean =     521.176531277216
             stat err =       0.000553717673
             autocorr =       1.295445764239
              std dev =       0.688008439291
             le_variance =       0.473355612536


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281850156639e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818501566331       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818515717249       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818516713775       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818516939753       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.139342e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818501566331       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818506729604       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818507023249       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818507110634       residual = 6.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.995797e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818501566331       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818503024670       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818503102625       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818503131457       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.113347e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1134e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.150380e-01                 3 1 ON  0
ci_02 -2.640995e-02                3 1 ON  1
ci_03 -2.630500e-02                3 1 ON  2
ci_04 2.552101e-02                 3 1 ON  3
ci_05 -2.299954e-02                3 1 ON  4
ci_06 -2.363245e-02                3 1 ON  5
ci_07 2.645488e-02                 3 1 ON  6
ci_08 -4.293606e-03                3 1 ON  7
ci_09 -1.073745e-02                3 1 ON  8
ci_10 -1.198953e-02                3 1 ON  9
ci_11 1.617756e-02                 3 1 ON  10
ci_12 1.091838e-02                 3 1 ON  11
ci_13 1.155485e-02                 3 1 ON  12
ci_14 1.665328e-02                 3 1 ON  13
ci_15 7.672964e-03                 3 1 ON  14
ci_16 7.770789e-03                 3 1 ON  15
ci_17 -9.629752e-03                3 1 ON  16
ci_18 -9.481810e-03                3 1 ON  17
ci_19 9.287071e-03                 3 1 ON  18
ci_20 1.099155e-02                 3 1 ON  19
ci_21 7.896240e-03                 3 1 ON  20
ci_22 7.906112e-03                 3 1 ON  21
ci_23 6.746699e-03                 3 1 ON  22
ci_24 6.273148e-03                 3 1 ON  23
ci_25 5.148208e-03                 3 1 ON  24
ci_26 2.282917e-03                 3 1 ON  25
ci_27 2.415823e-03                 3 1 ON  26
ci_28 4.086835e-03                 3 1 ON  27
ci_29 4.119984e-03                 3 1 ON  28
ci_30 6.954601e-04                 3 1 ON  29
ci_31 7.802425e-04                 3 1 ON  30
ci_32 4.032374e-04                 3 1 ON  31
ci_33 3.030116e-05                 3 1 ON  32
ci_34 7.775733e-04                 3 1 ON  33
ci_35 -5.535127e-04                3 1 ON  34
ci_36 -9.624645e-04                3 1 ON  35
ci_37 -6.402633e-04                3 1 ON  36
ci_38 -4.436097e-04                3 1 ON  37
ci_39 2.052216e-04                 3 1 ON  38
ci_40 -1.206570e-03                3 1 ON  39
ci_41 9.612480e-04                 3 1 ON  40
ci_42 2.489646e-04                 3 1 ON  41
ci_43 -2.265647e-03                3 1 ON  42
ci_44 -2.356247e-03                3 1 ON  43
ci_45 -9.700167e-05                3 1 ON  44
ci_46 -6.767491e-04                3 1 ON  45
ci_47 -1.523286e-03                3 1 ON  46
ci_48 -6.739011e-04                3 1 ON  47
ci_49 -1.391155e-03                3 1 ON  48
ci_50 -3.996379e-04                3 1 ON  49
ci_51 5.429154e-04                 3 1 ON  50
ci_52 1.190471e-04                 3 1 ON  51
ci_53 -1.064493e-03                3 1 ON  52
ci_54 -1.509838e-03                3 1 ON  53
ci_55 -1.237870e-03                3 1 ON  54
ci_56 2.188191e-03                 3 1 ON  55
ci_57 1.070196e-03                 3 1 ON  56
ci_58 -9.662984e-04                3 1 ON  57
ci_59 -1.957310e-03                3 1 ON  58
ci_60 5.810974e-04                 3 1 ON  59
ci_61 1.566093e-03                 3 1 ON  60
ci_62 -5.690518e-04                3 1 ON  61
ci_63 1.535840e-05                 3 1 ON  62
ci_64 -5.471028e-04                3 1 ON  63
ci_65 -5.725320e-04                3 1 ON  64
ci_66 2.986850e-04                 3 1 ON  65
ci_67 -7.191026e-04                3 1 ON  66
ci_68 -1.448746e-03                3 1 ON  67
ci_69 -1.527636e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8637
    reference variance = 0.295015
====================================================
  Execution time = 2.5307e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9539e-01
  Total weights = 1.9638e+06
  Execution time = 3.5924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477797868450
                                         uncertainty =       0.003626538456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477797868450
                                         uncertainty =       0.003626538456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488709954
  error estimate for blocks of size 2^( 2) =       0.000509172486
  error estimate for blocks of size 2^( 3) =       0.000528727303
  error estimate for blocks of size 2^( 4) =       0.000544321756
  error estimate for blocks of size 2^( 5) =       0.000553320119
  error estimate for blocks of size 2^( 6) =       0.000560223439
  error estimate for blocks of size 2^( 7) =       0.000563117202

      target function =                  N/A
              le_mean =     -22.819793830494
             les_mean =     521.271604671707
             stat err =       0.000555245629
             autocorr =       1.290826663609
              std dev =       0.691140244843
             le_variance =       0.477674838041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477357414054
                                         uncertainty =       0.003512964016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477357414054
                                         uncertainty =       0.003512964016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488482994
  error estimate for blocks of size 2^( 2) =       0.000508968068
  error estimate for blocks of size 2^( 3) =       0.000528548902
  error estimate for blocks of size 2^( 4) =       0.000544174426
  error estimate for blocks of size 2^( 5) =       0.000553188292
  error estimate for blocks of size 2^( 6) =       0.000560129841
  error estimate for blocks of size 2^( 7) =       0.000563042833

      target function =                  N/A
              le_mean =     -22.819799150353
             les_mean =     521.245421402927
             stat err =       0.000555133848
             autocorr =       1.291506267475
              std dev =       0.690819275762
             le_variance =       0.477231271764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477451525897
                                         uncertainty =       0.003546945430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477451525897
                                         uncertainty =       0.003546945430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488531565
  error estimate for blocks of size 2^( 2) =       0.000509010595
  error estimate for blocks of size 2^( 3) =       0.000528584467
  error estimate for blocks of size 2^( 4) =       0.000544202295
  error estimate for blocks of size 2^( 5) =       0.000553213427
  error estimate for blocks of size 2^( 6) =       0.000560148792
  error estimate for blocks of size 2^( 7) =       0.000563062340

      target function =                  N/A
              le_mean =     -22.819796192560
             les_mean =     521.239347848580
             stat err =       0.000555156714
             autocorr =       1.291355844978
              std dev =       0.690887965408
             le_variance =       0.477326180746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477732964307
                                         uncertainty =       0.003615410732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477732964307
                                         uncertainty =       0.003615410732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488676588
  error estimate for blocks of size 2^( 2) =       0.000509141277
  error estimate for blocks of size 2^( 3) =       0.000528698039
  error estimate for blocks of size 2^( 4) =       0.000544299148
  error estimate for blocks of size 2^( 5) =       0.000553301923
  error estimate for blocks of size 2^( 6) =       0.000560211866
  error estimate for blocks of size 2^( 7) =       0.000563123396

      target function =                  N/A
              le_mean =     -22.819795550958
             les_mean =     521.243803502825
             stat err =       0.000555234083
             autocorr =       1.290949250054
              std dev =       0.691093058209
             le_variance =       0.477609615104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819793830494        initial
     2.5000e-01     2.5000e+00             1.1393e-03       -22.819799150353  <--
     1.0000e+00     1.0000e+01             3.9958e-04       -22.819796192560
     4.0000e+00     4.0000e+01             1.1133e-04       -22.819795550958

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3269e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.147261e-01 3 1  ON 0
ci_02                -2.590529e-02 3 1  ON 1
ci_03                -2.556523e-02 3 1  ON 2
ci_04                 2.533271e-02 3 1  ON 3
ci_05                -2.314847e-02 3 1  ON 4
ci_06                -2.385225e-02 3 1  ON 5
ci_07                 2.646299e-02 3 1  ON 6
ci_08                -4.266374e-03 3 1  ON 7
ci_09                -1.118053e-02 3 1  ON 8
ci_10                -1.141020e-02 3 1  ON 9
ci_11                 1.611887e-02 3 1  ON 10
ci_12                 1.092735e-02 3 1  ON 11
ci_13                 1.164314e-02 3 1  ON 12
ci_14                 1.660678e-02 3 1  ON 13
ci_15                 7.586335e-03 3 1  ON 14
ci_16                 7.922778e-03 3 1  ON 15
ci_17                -9.600086e-03 3 1  ON 16
ci_18                -9.870202e-03 3 1  ON 17
ci_19                 9.403292e-03 3 1  ON 18
ci_20                 1.118567e-02 3 1  ON 19
ci_21                 7.561239e-03 3 1  ON 20
ci_22                 7.804219e-03 3 1  ON 21
ci_23                 6.664483e-03 3 1  ON 22
ci_24                 6.530326e-03 3 1  ON 23
ci_25                 5.056955e-03 3 1  ON 24
ci_26                 2.116627e-03 3 1  ON 25
ci_27                 2.700221e-03 3 1  ON 26
ci_28                 4.454691e-03 3 1  ON 27
ci_29                 4.013909e-03 3 1  ON 28
ci_30                 6.753284e-04 3 1  ON 29
ci_31                 1.065933e-03 3 1  ON 30
ci_32                 2.786319e-04 3 1  ON 31
ci_33                 5.762597e-05 3 1  ON 32
ci_34                 9.075332e-04 3 1  ON 33
ci_35                -3.044907e-05 3 1  ON 34
ci_36                -9.123875e-04 3 1  ON 35
ci_37                -5.082864e-04 3 1  ON 36
ci_38                -2.776535e-04 3 1  ON 37
ci_39                 4.439460e-04 3 1  ON 38
ci_40                -1.354319e-03 3 1  ON 39
ci_41                 5.385063e-04 3 1  ON 40
ci_42                 3.768934e-04 3 1  ON 41
ci_43                -2.425539e-03 3 1  ON 42
ci_44                -2.710337e-03 3 1  ON 43
ci_45                 1.661019e-05 3 1  ON 44
ci_46                -5.679842e-04 3 1  ON 45
ci_47                -1.426267e-03 3 1  ON 46
ci_48                -6.309392e-04 3 1  ON 47
ci_49                -1.400727e-03 3 1  ON 48
ci_50                -4.849149e-04 3 1  ON 49
ci_51                 6.684959e-04 3 1  ON 50
ci_52                 2.514836e-04 3 1  ON 51
ci_53                -1.132199e-03 3 1  ON 52
ci_54                -1.434917e-03 3 1  ON 53
ci_55                -1.048585e-03 3 1  ON 54
ci_56                 2.163404e-03 3 1  ON 55
ci_57                 7.259693e-04 3 1  ON 56
ci_58                -1.186866e-03 3 1  ON 57
ci_59                -2.088711e-03 3 1  ON 58
ci_60                 4.501696e-04 3 1  ON 59
ci_61                 1.774599e-03 3 1  ON 60
ci_62                -5.981829e-04 3 1  ON 61
ci_63                -9.008468e-05 3 1  ON 62
ci_64                -6.226780e-04 3 1  ON 63
ci_65                -4.479687e-04 3 1  ON 64
ci_66                 1.535817e-04 3 1  ON 65
ci_67                -9.752052e-04 3 1  ON 66
ci_68                -1.364662e-03 3 1  ON 67
ci_69                -9.153092e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2852e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7953
    reference variance = 0.590587
====================================================
  Execution time = 2.5582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9465e-01
  Total weights = 1.963886974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476958093988
                                         uncertainty =       0.002330941607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476958093988
                                         uncertainty =       0.002330941607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488310541
  error estimate for blocks of size 2^( 2) =       0.000509366263
  error estimate for blocks of size 2^( 3) =       0.000529440775
  error estimate for blocks of size 2^( 4) =       0.000544824695
  error estimate for blocks of size 2^( 5) =       0.000554822497
  error estimate for blocks of size 2^( 6) =       0.000563360041
  error estimate for blocks of size 2^( 7) =       0.000564592334

      target function =                  N/A
              le_mean =     -22.820487561571
             les_mean =     521.269303160260
             stat err =       0.000556899892
             autocorr =       1.300654859574
              std dev =       0.690575389973
             le_variance =       0.476894369237


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282048756157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820487561444       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820509649505       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820524987576       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820525758272       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820525714267       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.820525791464       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.666573e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820487561444       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820501447047       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820508632046       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820508873980       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820508866449       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.122106e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820487561444       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820493148279       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820495270815       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820495350889       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820495383486       residual = 2.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.634397e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0249e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.143669e-01 3 1  ON 0
ci_02                -2.607956e-02 3 1  ON 1
ci_03                -2.483009e-02 3 1  ON 2
ci_04                 2.442050e-02 3 1  ON 3
ci_05                -2.304732e-02 3 1  ON 4
ci_06                -2.412404e-02 3 1  ON 5
ci_07                 2.580263e-02 3 1  ON 6
ci_08                -4.402973e-03 3 1  ON 7
ci_09                -1.120069e-02 3 1  ON 8
ci_10                -1.174689e-02 3 1  ON 9
ci_11                 1.581768e-02 3 1  ON 10
ci_12                 1.102893e-02 3 1  ON 11
ci_13                 1.175314e-02 3 1  ON 12
ci_14                 1.632159e-02 3 1  ON 13
ci_15                 7.890861e-03 3 1  ON 14
ci_16                 7.387346e-03 3 1  ON 15
ci_17                -9.784201e-03 3 1  ON 16
ci_18                -9.791048e-03 3 1  ON 17
ci_19                 9.533073e-03 3 1  ON 18
ci_20                 1.085019e-02 3 1  ON 19
ci_21                 7.771700e-03 3 1  ON 20
ci_22                 7.298978e-03 3 1  ON 21
ci_23                 6.953586e-03 3 1  ON 22
ci_24                 6.295096e-03 3 1  ON 23
ci_25                 4.849390e-03 3 1  ON 24
ci_26                 2.350419e-03 3 1  ON 25
ci_27                 2.333372e-03 3 1  ON 26
ci_28                 4.331869e-03 3 1  ON 27
ci_29                 3.863957e-03 3 1  ON 28
ci_30                 6.661409e-04 3 1  ON 29
ci_31                 7.129444e-04 3 1  ON 30
ci_32                 6.353105e-05 3 1  ON 31
ci_33                 5.214722e-05 3 1  ON 32
ci_34                 8.082221e-04 3 1  ON 33
ci_35                -4.073741e-04 3 1  ON 34
ci_36                -1.646335e-03 3 1  ON 35
ci_37                -3.846689e-04 3 1  ON 36
ci_38                -7.962734e-04 3 1  ON 37
ci_39                -7.778235e-05 3 1  ON 38
ci_40                -9.493524e-04 3 1  ON 39
ci_41                 1.149562e-03 3 1  ON 40
ci_42                 5.247602e-04 3 1  ON 41
ci_43                -2.124184e-03 3 1  ON 42
ci_44                -1.966994e-03 3 1  ON 43
ci_45                -1.549474e-04 3 1  ON 44
ci_46                -3.667108e-04 3 1  ON 45
ci_47                -9.106846e-04 3 1  ON 46
ci_48                -6.337688e-04 3 1  ON 47
ci_49                -1.845192e-03 3 1  ON 48
ci_50                 3.740324e-05 3 1  ON 49
ci_51                 2.283575e-04 3 1  ON 50
ci_52                 3.323043e-04 3 1  ON 51
ci_53                -1.173997e-03 3 1  ON 52
ci_54                -1.053728e-03 3 1  ON 53
ci_55                -1.423413e-03 3 1  ON 54
ci_56                 1.813494e-03 3 1  ON 55
ci_57                 1.355474e-03 3 1  ON 56
ci_58                -1.719290e-03 3 1  ON 57
ci_59                -1.666993e-03 3 1  ON 58
ci_60                 1.135717e-03 3 1  ON 59
ci_61                 2.140227e-03 3 1  ON 60
ci_62                -4.482010e-04 3 1  ON 61
ci_63                -4.279332e-04 3 1  ON 62
ci_64                 2.073243e-04 3 1  ON 63
ci_65                -5.224436e-04 3 1  ON 64
ci_66                -2.927720e-04 3 1  ON 65
ci_67                -5.006057e-04 3 1  ON 66
ci_68                -1.322220e-03 3 1  ON 67
ci_69                -1.345461e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8027
    reference variance = 0.448676
====================================================
  Execution time = 2.5076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9525e-01
  Total weights = 1.9637e+06
  Execution time = 3.5738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478481344999
                                         uncertainty =       0.002425696407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478481344999
                                         uncertainty =       0.002425696407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489189023
  error estimate for blocks of size 2^( 2) =       0.000510303274
  error estimate for blocks of size 2^( 3) =       0.000530363504
  error estimate for blocks of size 2^( 4) =       0.000544871661
  error estimate for blocks of size 2^( 5) =       0.000553401651
  error estimate for blocks of size 2^( 6) =       0.000558738053
  error estimate for blocks of size 2^( 7) =       0.000560893175

      target function =                  N/A
              le_mean =     -22.820803188171
             les_mean =     521.299095215231
             stat err =       0.000554476135
             autocorr =       1.284731314381
              std dev =       0.691817751332
             le_variance =       0.478611801058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478453821388
                                         uncertainty =       0.002424041292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478453821388
                                         uncertainty =       0.002424041292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489176890
  error estimate for blocks of size 2^( 2) =       0.000510303754
  error estimate for blocks of size 2^( 3) =       0.000530390282
  error estimate for blocks of size 2^( 4) =       0.000544924818
  error estimate for blocks of size 2^( 5) =       0.000553440008
  error estimate for blocks of size 2^( 6) =       0.000558730784
  error estimate for blocks of size 2^( 7) =       0.000560874455

      target function =                  N/A
              le_mean =     -22.820791996628
             les_mean =     521.294578457815
             stat err =       0.000554492516
             autocorr =       1.284870963459
              std dev =       0.691800592600
             le_variance =       0.478588059921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478578728192
                                         uncertainty =       0.002432512590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478578728192
                                         uncertainty =       0.002432512590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489240897
  error estimate for blocks of size 2^( 2) =       0.000510357214
  error estimate for blocks of size 2^( 3) =       0.000530443712
  error estimate for blocks of size 2^( 4) =       0.000544995800
  error estimate for blocks of size 2^( 5) =       0.000553524395
  error estimate for blocks of size 2^( 6) =       0.000558782356
  error estimate for blocks of size 2^( 7) =       0.000560896267

      target function =                  N/A
              le_mean =     -22.820796480766
             les_mean =     521.813431156667
             stat err =       0.000554549704
             autocorr =       1.284799767571
              std dev =       0.691891111279
             le_variance =       0.478713309866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480442980506
                                         uncertainty =       0.003307603800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480442980506
                                         uncertainty =       0.003307603800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490190031
  error estimate for blocks of size 2^( 2) =       0.000511296422
  error estimate for blocks of size 2^( 3) =       0.000531291842
  error estimate for blocks of size 2^( 4) =       0.000545749077
  error estimate for blocks of size 2^( 5) =       0.000554217021
  error estimate for blocks of size 2^( 6) =       0.000559370356
  error estimate for blocks of size 2^( 7) =       0.000561367383

      target function =                  N/A
              le_mean =     -22.820764429143
             les_mean =     525.153385611967
             stat err =       0.000555175959
             autocorr =       1.282721440118
              std dev =       0.693233390113
             le_variance =       0.480572533167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820803188171        initial  <--
     6.2500e-02     6.2500e-01             1.6666e-03       -22.820791996628
     2.5000e-01     2.5000e+00             9.1221e-04       -22.820796480766
     1.0000e+00     1.0000e+01             3.6344e-04       -22.820764429143

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9783
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.147261e-01 3 1  ON 0
ci_02                -2.590529e-02 3 1  ON 1
ci_03                -2.556523e-02 3 1  ON 2
ci_04                 2.533271e-02 3 1  ON 3
ci_05                -2.314847e-02 3 1  ON 4
ci_06                -2.385225e-02 3 1  ON 5
ci_07                 2.646299e-02 3 1  ON 6
ci_08                -4.266374e-03 3 1  ON 7
ci_09                -1.118053e-02 3 1  ON 8
ci_10                -1.141020e-02 3 1  ON 9
ci_11                 1.611887e-02 3 1  ON 10
ci_12                 1.092735e-02 3 1  ON 11
ci_13                 1.164314e-02 3 1  ON 12
ci_14                 1.660678e-02 3 1  ON 13
ci_15                 7.586335e-03 3 1  ON 14
ci_16                 7.922778e-03 3 1  ON 15
ci_17                -9.600086e-03 3 1  ON 16
ci_18                -9.870202e-03 3 1  ON 17
ci_19                 9.403292e-03 3 1  ON 18
ci_20                 1.118567e-02 3 1  ON 19
ci_21                 7.561239e-03 3 1  ON 20
ci_22                 7.804219e-03 3 1  ON 21
ci_23                 6.664483e-03 3 1  ON 22
ci_24                 6.530326e-03 3 1  ON 23
ci_25                 5.056955e-03 3 1  ON 24
ci_26                 2.116627e-03 3 1  ON 25
ci_27                 2.700221e-03 3 1  ON 26
ci_28                 4.454691e-03 3 1  ON 27
ci_29                 4.013909e-03 3 1  ON 28
ci_30                 6.753284e-04 3 1  ON 29
ci_31                 1.065933e-03 3 1  ON 30
ci_32                 2.786319e-04 3 1  ON 31
ci_33                 5.762597e-05 3 1  ON 32
ci_34                 9.075332e-04 3 1  ON 33
ci_35                -3.044907e-05 3 1  ON 34
ci_36                -9.123875e-04 3 1  ON 35
ci_37                -5.082864e-04 3 1  ON 36
ci_38                -2.776535e-04 3 1  ON 37
ci_39                 4.439460e-04 3 1  ON 38
ci_40                -1.354319e-03 3 1  ON 39
ci_41                 5.385063e-04 3 1  ON 40
ci_42                 3.768934e-04 3 1  ON 41
ci_43                -2.425539e-03 3 1  ON 42
ci_44                -2.710337e-03 3 1  ON 43
ci_45                 1.661019e-05 3 1  ON 44
ci_46                -5.679842e-04 3 1  ON 45
ci_47                -1.426267e-03 3 1  ON 46
ci_48                -6.309392e-04 3 1  ON 47
ci_49                -1.400727e-03 3 1  ON 48
ci_50                -4.849149e-04 3 1  ON 49
ci_51                 6.684959e-04 3 1  ON 50
ci_52                 2.514836e-04 3 1  ON 51
ci_53                -1.132199e-03 3 1  ON 52
ci_54                -1.434917e-03 3 1  ON 53
ci_55                -1.048585e-03 3 1  ON 54
ci_56                 2.163404e-03 3 1  ON 55
ci_57                 7.259693e-04 3 1  ON 56
ci_58                -1.186866e-03 3 1  ON 57
ci_59                -2.088711e-03 3 1  ON 58
ci_60                 4.501696e-04 3 1  ON 59
ci_61                 1.774599e-03 3 1  ON 60
ci_62                -5.981829e-04 3 1  ON 61
ci_63                -9.008468e-05 3 1  ON 62
ci_64                -6.226780e-04 3 1  ON 63
ci_65                -4.479687e-04 3 1  ON 64
ci_66                 1.535817e-04 3 1  ON 65
ci_67                -9.752052e-04 3 1  ON 66
ci_68                -1.364662e-03 3 1  ON 67
ci_69                -9.153092e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3234e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8195
    reference variance = 0.494814
====================================================
  Execution time = 2.7563e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9202e-01
  Total weights = 1.963863969e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475701226596
                                         uncertainty =       0.002319870452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475701226596
                                         uncertainty =       0.002319870452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487666814
  error estimate for blocks of size 2^( 2) =       0.000508420139
  error estimate for blocks of size 2^( 3) =       0.000527757794
  error estimate for blocks of size 2^( 4) =       0.000542055840
  error estimate for blocks of size 2^( 5) =       0.000550400981
  error estimate for blocks of size 2^( 6) =       0.000556680252
  error estimate for blocks of size 2^( 7) =       0.000558015920

      target function =                  N/A
              le_mean =     -22.820139040571
             les_mean =     521.250768126353
             stat err =       0.000551788248
             autocorr =       1.280260917488
              std dev =       0.689665022563
             le_variance =       0.475637843347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282013904057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820139040497       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820146920314       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820147334179       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820147300154       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 5.214185e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820139040497       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820141475448       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820141560028       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820141549317       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.589268e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820139040497       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820139687410       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820139706354       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820139703858       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 4.203148e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2187e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.147321e-01 3 1  ON 0
ci_02                -2.588011e-02 3 1  ON 1
ci_03                -2.552575e-02 3 1  ON 2
ci_04                 2.520151e-02 3 1  ON 3
ci_05                -2.313100e-02 3 1  ON 4
ci_06                -2.378092e-02 3 1  ON 5
ci_07                 2.635634e-02 3 1  ON 6
ci_08                -4.240147e-03 3 1  ON 7
ci_09                -1.120950e-02 3 1  ON 8
ci_10                -1.147802e-02 3 1  ON 9
ci_11                 1.615741e-02 3 1  ON 10
ci_12                 1.083514e-02 3 1  ON 11
ci_13                 1.171499e-02 3 1  ON 12
ci_14                 1.663829e-02 3 1  ON 13
ci_15                 7.574872e-03 3 1  ON 14
ci_16                 7.777968e-03 3 1  ON 15
ci_17                -9.577513e-03 3 1  ON 16
ci_18                -9.868913e-03 3 1  ON 17
ci_19                 9.376394e-03 3 1  ON 18
ci_20                 1.111731e-02 3 1  ON 19
ci_21                 7.549965e-03 3 1  ON 20
ci_22                 7.814586e-03 3 1  ON 21
ci_23                 6.670278e-03 3 1  ON 22
ci_24                 6.545149e-03 3 1  ON 23
ci_25                 5.195721e-03 3 1  ON 24
ci_26                 2.099918e-03 3 1  ON 25
ci_27                 2.695148e-03 3 1  ON 26
ci_28                 4.401306e-03 3 1  ON 27
ci_29                 3.982261e-03 3 1  ON 28
ci_30                 6.572098e-04 3 1  ON 29
ci_31                 1.021519e-03 3 1  ON 30
ci_32                 2.200656e-04 3 1  ON 31
ci_33                 1.315715e-04 3 1  ON 32
ci_34                 8.671737e-04 3 1  ON 33
ci_35                -5.363218e-06 3 1  ON 34
ci_36                -8.496849e-04 3 1  ON 35
ci_37                -5.290198e-04 3 1  ON 36
ci_38                -2.249576e-04 3 1  ON 37
ci_39                 3.347741e-04 3 1  ON 38
ci_40                -1.420461e-03 3 1  ON 39
ci_41                 5.447650e-04 3 1  ON 40
ci_42                 4.838852e-04 3 1  ON 41
ci_43                -2.382774e-03 3 1  ON 42
ci_44                -2.633489e-03 3 1  ON 43
ci_45                -4.892999e-05 3 1  ON 44
ci_46                -4.666982e-04 3 1  ON 45
ci_47                -1.369841e-03 3 1  ON 46
ci_48                -6.507315e-04 3 1  ON 47
ci_49                -1.405656e-03 3 1  ON 48
ci_50                -5.032365e-04 3 1  ON 49
ci_51                 5.828748e-04 3 1  ON 50
ci_52                 1.175705e-04 3 1  ON 51
ci_53                -1.089713e-03 3 1  ON 52
ci_54                -1.338256e-03 3 1  ON 53
ci_55                -1.075356e-03 3 1  ON 54
ci_56                 2.036500e-03 3 1  ON 55
ci_57                 7.557446e-04 3 1  ON 56
ci_58                -1.223265e-03 3 1  ON 57
ci_59                -1.944063e-03 3 1  ON 58
ci_60                 5.494680e-04 3 1  ON 59
ci_61                 1.811082e-03 3 1  ON 60
ci_62                -5.438178e-04 3 1  ON 61
ci_63                -9.231906e-05 3 1  ON 62
ci_64                -6.466449e-04 3 1  ON 63
ci_65                -5.575826e-04 3 1  ON 64
ci_66                 1.990331e-04 3 1  ON 65
ci_67                -9.665598e-04 3 1  ON 66
ci_68                -1.339045e-03 3 1  ON 67
ci_69                -1.074236e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8012
    reference variance = 0.415568
====================================================
  Execution time = 2.4871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9088e-01
  Total weights = 1.9636e+06
  Execution time = 3.5938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476592128453
                                         uncertainty =       0.002698306231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476592128453
                                         uncertainty =       0.002698306231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488150536
  error estimate for blocks of size 2^( 2) =       0.000508404866
  error estimate for blocks of size 2^( 3) =       0.000528186253
  error estimate for blocks of size 2^( 4) =       0.000542859083
  error estimate for blocks of size 2^( 5) =       0.000552935716
  error estimate for blocks of size 2^( 6) =       0.000555464176
  error estimate for blocks of size 2^( 7) =       0.000557933290

      target function =                  N/A
              le_mean =     -22.820643439807
             les_mean =     521.274740796872
             stat err =       0.000552298066
             autocorr =       1.280087049602
              std dev =       0.690349108905
             le_variance =       0.476581892166

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0380597
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476549552106
                                         uncertainty =       0.002689830648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476549552106
                                         uncertainty =       0.002689830648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488127510
  error estimate for blocks of size 2^( 2) =       0.000508390905
  error estimate for blocks of size 2^( 3) =       0.000528186480
  error estimate for blocks of size 2^( 4) =       0.000542872813
  error estimate for blocks of size 2^( 5) =       0.000552949259
  error estimate for blocks of size 2^( 6) =       0.000555470555
  error estimate for blocks of size 2^( 7) =       0.000557962474

      target function =                  N/A
              le_mean =     -22.820642357404
             les_mean =     521.276077949036
             stat err =       0.000552313775
             autocorr =       1.280280651349
              std dev =       0.690316544245
             le_variance =       0.476536931258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476551520550
                                         uncertainty =       0.002692965686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476551520550
                                         uncertainty =       0.002692965686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488128978
  error estimate for blocks of size 2^( 2) =       0.000508388770
  error estimate for blocks of size 2^( 3) =       0.000528178686
  error estimate for blocks of size 2^( 4) =       0.000542861402
  error estimate for blocks of size 2^( 5) =       0.000552936047
  error estimate for blocks of size 2^( 6) =       0.000555461405
  error estimate for blocks of size 2^( 7) =       0.000557946422

      target function =                  N/A
              le_mean =     -22.820641573921
             les_mean =     521.272549479796
             stat err =       0.000552301319
             autocorr =       1.280215199321
              std dev =       0.690318621353
             le_variance =       0.476539798987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476584678427
                                         uncertainty =       0.002697613820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476584678427
                                         uncertainty =       0.002697613820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488146618
  error estimate for blocks of size 2^( 2) =       0.000508401703
  error estimate for blocks of size 2^( 3) =       0.000528184406
  error estimate for blocks of size 2^( 4) =       0.000542858627
  error estimate for blocks of size 2^( 5) =       0.000552934410
  error estimate for blocks of size 2^( 6) =       0.000555464474
  error estimate for blocks of size 2^( 7) =       0.000557937836

      target function =                  N/A
              le_mean =     -22.820643530679
             les_mean =     521.281945753568
             stat err =       0.000552298837
             autocorr =       1.280111169848
              std dev =       0.690343568048
             le_variance =       0.476574241945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820643439807        initial
     6.2500e-01     6.2500e+00             5.2142e-04       -22.820642357404
     2.5000e+00     2.5000e+01             1.5893e-04       -22.820641573921
     1.0000e+01     1.0000e+02             4.2031e-05       -22.820643530679  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.2870e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529736e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643507e-02 3 1  ON 6
ci_08                -4.259309e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142776e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583382e-03 3 1  ON 14
ci_16                 7.884927e-03 3 1  ON 15
ci_17                -9.594189e-03 3 1  ON 16
ci_18                -9.869923e-03 3 1  ON 17
ci_19                 9.395787e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558203e-03 3 1  ON 20
ci_22                 7.806936e-03 3 1  ON 21
ci_23                 6.665913e-03 3 1  ON 22
ci_24                 6.534144e-03 3 1  ON 23
ci_25                 5.093891e-03 3 1  ON 24
ci_26                 2.112255e-03 3 1  ON 25
ci_27                 2.698880e-03 3 1  ON 26
ci_28                 4.440861e-03 3 1  ON 27
ci_29                 4.005515e-03 3 1  ON 28
ci_30                 6.704345e-04 3 1  ON 29
ci_31                 1.054129e-03 3 1  ON 30
ci_32                 2.630740e-04 3 1  ON 31
ci_33                 7.782041e-05 3 1  ON 32
ci_34                 8.968107e-04 3 1  ON 33
ci_35                -2.386659e-05 3 1  ON 34
ci_36                -8.953063e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.634703e-04 3 1  ON 37
ci_39                 4.144785e-04 3 1  ON 38
ci_40                -1.372563e-03 3 1  ON 39
ci_41                 5.404473e-04 3 1  ON 40
ci_42                 4.057251e-04 3 1  ON 41
ci_43                -2.414405e-03 3 1  ON 42
ci_44                -2.690264e-03 3 1  ON 43
ci_45                -1.235775e-06 3 1  ON 44
ci_46                -5.407643e-04 3 1  ON 45
ci_47                -1.411669e-03 3 1  ON 46
ci_48                -6.363824e-04 3 1  ON 47
ci_49                -1.402289e-03 3 1  ON 48
ci_50                -4.900365e-04 3 1  ON 49
ci_51                 6.455414e-04 3 1  ON 50
ci_52                 2.153054e-04 3 1  ON 51
ci_53                -1.120555e-03 3 1  ON 52
ci_54                -1.409405e-03 3 1  ON 53
ci_55                -1.055707e-03 3 1  ON 54
ci_56                 2.128987e-03 3 1  ON 55
ci_57                 7.338728e-04 3 1  ON 56
ci_58                -1.196396e-03 3 1  ON 57
ci_59                -2.050427e-03 3 1  ON 58
ci_60                 4.754313e-04 3 1  ON 59
ci_61                 1.783890e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.084210e-05 3 1  ON 62
ci_64                -6.291547e-04 3 1  ON 63
ci_65                -4.772180e-04 3 1  ON 64
ci_66                 1.659315e-04 3 1  ON 65
ci_67                -9.729712e-04 3 1  ON 66
ci_68                -1.357785e-03 3 1  ON 67
ci_69                -9.573406e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8753
    reference variance = 0.687912
====================================================
  Execution time = 2.5590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9401e-01
  Total weights = 1.963850115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479068380700
                                         uncertainty =       0.003630551026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479068380700
                                         uncertainty =       0.003630551026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489428277
  error estimate for blocks of size 2^( 2) =       0.000509849936
  error estimate for blocks of size 2^( 3) =       0.000529963898
  error estimate for blocks of size 2^( 4) =       0.000544674383
  error estimate for blocks of size 2^( 5) =       0.000555915937
  error estimate for blocks of size 2^( 6) =       0.000560759138
  error estimate for blocks of size 2^( 7) =       0.000564363417

      target function =                  N/A
              le_mean =     -22.820406602399
             les_mean =     521.264968012277
             stat err =       0.000556428219
             autocorr =       1.292528650247
              std dev =       0.692156107184
             le_variance =       0.479080076712


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282040660240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820406602321       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820409140696       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820409187742       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820409175158       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.445919e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820406602321       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820407272991       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820407285894       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820407281782       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.868607e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820406602321       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820406772406       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820406775725       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820406774628       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 9.844235e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0234e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.147421e-01 3 1  ON 0
ci_02                -2.588562e-02 3 1  ON 1
ci_03                -2.554510e-02 3 1  ON 2
ci_04                 2.527351e-02 3 1  ON 3
ci_05                -2.315647e-02 3 1  ON 4
ci_06                -2.383595e-02 3 1  ON 5
ci_07                 2.641260e-02 3 1  ON 6
ci_08                -4.267827e-03 3 1  ON 7
ci_09                -1.121278e-02 3 1  ON 8
ci_10                -1.144320e-02 3 1  ON 9
ci_11                 1.612264e-02 3 1  ON 10
ci_12                 1.088803e-02 3 1  ON 11
ci_13                 1.165539e-02 3 1  ON 12
ci_14                 1.662330e-02 3 1  ON 13
ci_15                 7.592775e-03 3 1  ON 14
ci_16                 7.881288e-03 3 1  ON 15
ci_17                -9.594777e-03 3 1  ON 16
ci_18                -9.868066e-03 3 1  ON 17
ci_19                 9.378075e-03 3 1  ON 18
ci_20                 1.114596e-02 3 1  ON 19
ci_21                 7.540113e-03 3 1  ON 20
ci_22                 7.804137e-03 3 1  ON 21
ci_23                 6.665230e-03 3 1  ON 22
ci_24                 6.541882e-03 3 1  ON 23
ci_25                 5.077753e-03 3 1  ON 24
ci_26                 2.101520e-03 3 1  ON 25
ci_27                 2.692879e-03 3 1  ON 26
ci_28                 4.445101e-03 3 1  ON 27
ci_29                 3.989998e-03 3 1  ON 28
ci_30                 6.681492e-04 3 1  ON 29
ci_31                 1.039714e-03 3 1  ON 30
ci_32                 2.648349e-04 3 1  ON 31
ci_33                 4.773431e-05 3 1  ON 32
ci_34                 8.877413e-04 3 1  ON 33
ci_35                 1.020025e-05 3 1  ON 34
ci_36                -8.923964e-04 3 1  ON 35
ci_37                -5.377506e-04 3 1  ON 36
ci_38                -2.635087e-04 3 1  ON 37
ci_39                 3.956422e-04 3 1  ON 38
ci_40                -1.354595e-03 3 1  ON 39
ci_41                 5.209509e-04 3 1  ON 40
ci_42                 3.837171e-04 3 1  ON 41
ci_43                -2.406232e-03 3 1  ON 42
ci_44                -2.676365e-03 3 1  ON 43
ci_45                -8.555126e-06 3 1  ON 44
ci_46                -5.307424e-04 3 1  ON 45
ci_47                -1.384835e-03 3 1  ON 46
ci_48                -6.356667e-04 3 1  ON 47
ci_49                -1.405339e-03 3 1  ON 48
ci_50                -4.898340e-04 3 1  ON 49
ci_51                 6.331743e-04 3 1  ON 50
ci_52                 2.184196e-04 3 1  ON 51
ci_53                -1.122511e-03 3 1  ON 52
ci_54                -1.385075e-03 3 1  ON 53
ci_55                -1.042543e-03 3 1  ON 54
ci_56                 2.128944e-03 3 1  ON 55
ci_57                 7.324949e-04 3 1  ON 56
ci_58                -1.198217e-03 3 1  ON 57
ci_59                -2.028086e-03 3 1  ON 58
ci_60                 4.699261e-04 3 1  ON 59
ci_61                 1.771440e-03 3 1  ON 60
ci_62                -5.785364e-04 3 1  ON 61
ci_63                -1.000637e-04 3 1  ON 62
ci_64                -6.364490e-04 3 1  ON 63
ci_65                -4.757712e-04 3 1  ON 64
ci_66                 1.272454e-04 3 1  ON 65
ci_67                -9.619756e-04 3 1  ON 66
ci_68                -1.368043e-03 3 1  ON 67
ci_69                -9.490073e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.9406
    reference variance = 0.868034
====================================================
  Execution time = 2.4975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9673e-01
  Total weights = 1.9639e+06
  Execution time = 3.5783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479350449306
                                         uncertainty =       0.003891023475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479350449306
                                         uncertainty =       0.003891023475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489534813
  error estimate for blocks of size 2^( 2) =       0.000510336932
  error estimate for blocks of size 2^( 3) =       0.000530080864
  error estimate for blocks of size 2^( 4) =       0.000545160816
  error estimate for blocks of size 2^( 5) =       0.000554584527
  error estimate for blocks of size 2^( 6) =       0.000558627721
  error estimate for blocks of size 2^( 7) =       0.000564349127

      target function =                  N/A
              le_mean =     -22.819998688971
             les_mean =     521.277701076220
             stat err =       0.000555680548
             autocorr =       1.288496444926
              std dev =       0.692306771545
             le_variance =       0.479288665927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479324760704
                                         uncertainty =       0.003895666400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479324760704
                                         uncertainty =       0.003895666400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489521752
  error estimate for blocks of size 2^( 2) =       0.000510325030
  error estimate for blocks of size 2^( 3) =       0.000530069737
  error estimate for blocks of size 2^( 4) =       0.000545150191
  error estimate for blocks of size 2^( 5) =       0.000554576135
  error estimate for blocks of size 2^( 6) =       0.000558621320
  error estimate for blocks of size 2^( 7) =       0.000564342719

      target function =                  N/A
              le_mean =     -22.819998403174
             les_mean =     521.249017404662
             stat err =       0.000555672591
             autocorr =       1.288528304725
              std dev =       0.692288300191
             le_variance =       0.479263090581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479336187771
                                         uncertainty =       0.003893520226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479336187771
                                         uncertainty =       0.003893520226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489527560
  error estimate for blocks of size 2^( 2) =       0.000510330288
  error estimate for blocks of size 2^( 3) =       0.000530074625
  error estimate for blocks of size 2^( 4) =       0.000545154798
  error estimate for blocks of size 2^( 5) =       0.000554579661
  error estimate for blocks of size 2^( 6) =       0.000558623909
  error estimate for blocks of size 2^( 7) =       0.000564345048

      target function =                  N/A
              le_mean =     -22.819998406268
             les_mean =     521.249403430580
             stat err =       0.000555675854
             autocorr =       1.288512858821
              std dev =       0.692296514282
             le_variance =       0.479274463687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479348521580
                                         uncertainty =       0.003891326018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479348521580
                                         uncertainty =       0.003891326018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489533832
  error estimate for blocks of size 2^( 2) =       0.000510336016
  error estimate for blocks of size 2^( 3) =       0.000530080038
  error estimate for blocks of size 2^( 4) =       0.000545159946
  error estimate for blocks of size 2^( 5) =       0.000554583754
  error estimate for blocks of size 2^( 6) =       0.000558626853
  error estimate for blocks of size 2^( 7) =       0.000564348069

      target function =                  N/A
              le_mean =     -22.819998587518
             les_mean =     521.249064744125
             stat err =       0.000555679656
             autocorr =       1.288497469607
              std dev =       0.692305384855
             le_variance =       0.479286745899


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819998688971        initial  <--
     2.5000e+00     2.5000e+01             1.4459e-04       -22.819998403174
     1.0000e+01     1.0000e+02             3.8686e-05       -22.819998406268
     4.0000e+01     4.0000e+02             9.8442e-06       -22.819998587518

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8775
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529736e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643507e-02 3 1  ON 6
ci_08                -4.259309e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142776e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583382e-03 3 1  ON 14
ci_16                 7.884927e-03 3 1  ON 15
ci_17                -9.594189e-03 3 1  ON 16
ci_18                -9.869923e-03 3 1  ON 17
ci_19                 9.395787e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558203e-03 3 1  ON 20
ci_22                 7.806936e-03 3 1  ON 21
ci_23                 6.665913e-03 3 1  ON 22
ci_24                 6.534144e-03 3 1  ON 23
ci_25                 5.093891e-03 3 1  ON 24
ci_26                 2.112255e-03 3 1  ON 25
ci_27                 2.698880e-03 3 1  ON 26
ci_28                 4.440861e-03 3 1  ON 27
ci_29                 4.005515e-03 3 1  ON 28
ci_30                 6.704345e-04 3 1  ON 29
ci_31                 1.054129e-03 3 1  ON 30
ci_32                 2.630740e-04 3 1  ON 31
ci_33                 7.782041e-05 3 1  ON 32
ci_34                 8.968107e-04 3 1  ON 33
ci_35                -2.386659e-05 3 1  ON 34
ci_36                -8.953063e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.634703e-04 3 1  ON 37
ci_39                 4.144785e-04 3 1  ON 38
ci_40                -1.372563e-03 3 1  ON 39
ci_41                 5.404473e-04 3 1  ON 40
ci_42                 4.057251e-04 3 1  ON 41
ci_43                -2.414405e-03 3 1  ON 42
ci_44                -2.690264e-03 3 1  ON 43
ci_45                -1.235775e-06 3 1  ON 44
ci_46                -5.407643e-04 3 1  ON 45
ci_47                -1.411669e-03 3 1  ON 46
ci_48                -6.363824e-04 3 1  ON 47
ci_49                -1.402289e-03 3 1  ON 48
ci_50                -4.900365e-04 3 1  ON 49
ci_51                 6.455414e-04 3 1  ON 50
ci_52                 2.153054e-04 3 1  ON 51
ci_53                -1.120555e-03 3 1  ON 52
ci_54                -1.409405e-03 3 1  ON 53
ci_55                -1.055707e-03 3 1  ON 54
ci_56                 2.128987e-03 3 1  ON 55
ci_57                 7.338728e-04 3 1  ON 56
ci_58                -1.196396e-03 3 1  ON 57
ci_59                -2.050427e-03 3 1  ON 58
ci_60                 4.754313e-04 3 1  ON 59
ci_61                 1.783890e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.084210e-05 3 1  ON 62
ci_64                -6.291547e-04 3 1  ON 63
ci_65                -4.772180e-04 3 1  ON 64
ci_66                 1.659315e-04 3 1  ON 65
ci_67                -9.729712e-04 3 1  ON 66
ci_68                -1.357785e-03 3 1  ON 67
ci_69                -9.573406e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3125e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.688
    reference variance = 1.21213
====================================================
  Execution time = 2.5572e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9199e-01
  Total weights = 1.963923030e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476491938573
                                         uncertainty =       0.001997751942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476491938573
                                         uncertainty =       0.001997751942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488134174
  error estimate for blocks of size 2^( 2) =       0.000508934809
  error estimate for blocks of size 2^( 3) =       0.000528723994
  error estimate for blocks of size 2^( 4) =       0.000544366008
  error estimate for blocks of size 2^( 5) =       0.000554019363
  error estimate for blocks of size 2^( 6) =       0.000559842934
  error estimate for blocks of size 2^( 7) =       0.000564525665

      target function =                  N/A
              le_mean =     -22.819109446510
             les_mean =     521.203740967393
             stat err =       0.000555688493
             autocorr =       1.295938465241
              std dev =       0.690325968616
             le_variance =       0.476549942946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281910944651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819109446434       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819109851162       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819109920094       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819109916427       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 2.973633e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819109446434       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819109548200       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819109565778       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819109564827       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 7.490139e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819109446434       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819109471912       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819109476329       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819109476089       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 1.876072e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0190e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.147228e-01 3 1  ON 0
ci_02                -2.589844e-02 3 1  ON 1
ci_03                -2.555785e-02 3 1  ON 2
ci_04                 2.528987e-02 3 1  ON 3
ci_05                -2.314466e-02 3 1  ON 4
ci_06                -2.383145e-02 3 1  ON 5
ci_07                 2.643309e-02 3 1  ON 6
ci_08                -4.260496e-03 3 1  ON 7
ci_09                -1.119028e-02 3 1  ON 8
ci_10                -1.143047e-02 3 1  ON 9
ci_11                 1.613027e-02 3 1  ON 10
ci_12                 1.090099e-02 3 1  ON 11
ci_13                 1.165584e-02 3 1  ON 12
ci_14                 1.661383e-02 3 1  ON 13
ci_15                 7.581297e-03 3 1  ON 14
ci_16                 7.887797e-03 3 1  ON 15
ci_17                -9.594602e-03 3 1  ON 16
ci_18                -9.866517e-03 3 1  ON 17
ci_19                 9.399190e-03 3 1  ON 18
ci_20                 1.116293e-02 3 1  ON 19
ci_21                 7.560220e-03 3 1  ON 20
ci_22                 7.805678e-03 3 1  ON 21
ci_23                 6.663064e-03 3 1  ON 22
ci_24                 6.535015e-03 3 1  ON 23
ci_25                 5.095418e-03 3 1  ON 24
ci_26                 2.110322e-03 3 1  ON 25
ci_27                 2.696460e-03 3 1  ON 26
ci_28                 4.440245e-03 3 1  ON 27
ci_29                 4.004869e-03 3 1  ON 28
ci_30                 6.713084e-04 3 1  ON 29
ci_31                 1.055206e-03 3 1  ON 30
ci_32                 2.632685e-04 3 1  ON 31
ci_33                 7.674535e-05 3 1  ON 32
ci_34                 8.990511e-04 3 1  ON 33
ci_35                -2.247911e-05 3 1  ON 34
ci_36                -8.963924e-04 3 1  ON 35
ci_37                -5.171770e-04 3 1  ON 36
ci_38                -2.661849e-04 3 1  ON 37
ci_39                 4.131000e-04 3 1  ON 38
ci_40                -1.371055e-03 3 1  ON 39
ci_41                 5.420872e-04 3 1  ON 40
ci_42                 4.086516e-04 3 1  ON 41
ci_43                -2.411842e-03 3 1  ON 42
ci_44                -2.689146e-03 3 1  ON 43
ci_45                -3.229130e-06 3 1  ON 44
ci_46                -5.393082e-04 3 1  ON 45
ci_47                -1.412150e-03 3 1  ON 46
ci_48                -6.360124e-04 3 1  ON 47
ci_49                -1.403428e-03 3 1  ON 48
ci_50                -4.915700e-04 3 1  ON 49
ci_51                 6.433291e-04 3 1  ON 50
ci_52                 2.153734e-04 3 1  ON 51
ci_53                -1.119286e-03 3 1  ON 52
ci_54                -1.406068e-03 3 1  ON 53
ci_55                -1.058235e-03 3 1  ON 54
ci_56                 2.125842e-03 3 1  ON 55
ci_57                 7.369440e-04 3 1  ON 56
ci_58                -1.197639e-03 3 1  ON 57
ci_59                -2.048472e-03 3 1  ON 58
ci_60                 4.748621e-04 3 1  ON 59
ci_61                 1.783344e-03 3 1  ON 60
ci_62                -5.810035e-04 3 1  ON 61
ci_63                -9.151706e-05 3 1  ON 62
ci_64                -6.261037e-04 3 1  ON 63
ci_65                -4.743816e-04 3 1  ON 64
ci_66                 1.621437e-04 3 1  ON 65
ci_67                -9.722458e-04 3 1  ON 66
ci_68                -1.355178e-03 3 1  ON 67
ci_69                -9.588530e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.763
    reference variance = 0.593913
====================================================
  Execution time = 2.4845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9075e-01
  Total weights = 1.9636e+06
  Execution time = 3.5897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477490048433
                                         uncertainty =       0.002324320503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477490048433
                                         uncertainty =       0.002324320503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488584534
  error estimate for blocks of size 2^( 2) =       0.000509768950
  error estimate for blocks of size 2^( 3) =       0.000529689680
  error estimate for blocks of size 2^( 4) =       0.000544845581
  error estimate for blocks of size 2^( 5) =       0.000554662160
  error estimate for blocks of size 2^( 6) =       0.000557912261
  error estimate for blocks of size 2^( 7) =       0.000560348555

      target function =                  N/A
              le_mean =     -22.819697190476
             les_mean =     521.229306813485
             stat err =       0.000554442140
             autocorr =       1.287754367283
              std dev =       0.690962873876
             le_variance =       0.477429693075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477483686166
                                         uncertainty =       0.002323969236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477483686166
                                         uncertainty =       0.002323969236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488581286
  error estimate for blocks of size 2^( 2) =       0.000509766138
  error estimate for blocks of size 2^( 3) =       0.000529687373
  error estimate for blocks of size 2^( 4) =       0.000544843962
  error estimate for blocks of size 2^( 5) =       0.000554660726
  error estimate for blocks of size 2^( 6) =       0.000557911672
  error estimate for blocks of size 2^( 7) =       0.000560346909

      target function =                  N/A
              le_mean =     -22.819697072673
             les_mean =     521.229440777587
             stat err =       0.000554440817
             autocorr =       1.287765342481
              std dev =       0.690958281585
             le_variance =       0.477423346891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477486823192
                                         uncertainty =       0.002324143079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477486823192
                                         uncertainty =       0.002324143079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488582888
  error estimate for blocks of size 2^( 2) =       0.000509767525
  error estimate for blocks of size 2^( 3) =       0.000529688511
  error estimate for blocks of size 2^( 4) =       0.000544844761
  error estimate for blocks of size 2^( 5) =       0.000554661440
  error estimate for blocks of size 2^( 6) =       0.000557911975
  error estimate for blocks of size 2^( 7) =       0.000560347732

      target function =                  N/A
              le_mean =     -22.819697130943
             les_mean =     521.229351436724
             stat err =       0.000554441477
             autocorr =       1.287759966531
              std dev =       0.690960545865
             le_variance =       0.477426475942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477489641950
                                         uncertainty =       0.002324298246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477489641950
                                         uncertainty =       0.002324298246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488584326
  error estimate for blocks of size 2^( 2) =       0.000509768770
  error estimate for blocks of size 2^( 3) =       0.000529689533
  error estimate for blocks of size 2^( 4) =       0.000544845478
  error estimate for blocks of size 2^( 5) =       0.000554662070
  error estimate for blocks of size 2^( 6) =       0.000557912226
  error estimate for blocks of size 2^( 7) =       0.000560348452

      target function =                  N/A
              le_mean =     -22.819697182889
             les_mean =     521.229310872230
             stat err =       0.000554442056
             autocorr =       1.287755074244
              std dev =       0.690962580470
             le_variance =       0.477429287609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819697190476        initial  <--
     2.5000e+01     2.5000e+02             2.9736e-05       -22.819697072673
     1.0000e+02     1.0000e+03             7.4901e-06       -22.819697130943
     4.0000e+02     4.0000e+03             1.8761e-06       -22.819697182889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8024
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529736e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643507e-02 3 1  ON 6
ci_08                -4.259309e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142776e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583382e-03 3 1  ON 14
ci_16                 7.884927e-03 3 1  ON 15
ci_17                -9.594189e-03 3 1  ON 16
ci_18                -9.869923e-03 3 1  ON 17
ci_19                 9.395787e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558203e-03 3 1  ON 20
ci_22                 7.806936e-03 3 1  ON 21
ci_23                 6.665913e-03 3 1  ON 22
ci_24                 6.534144e-03 3 1  ON 23
ci_25                 5.093891e-03 3 1  ON 24
ci_26                 2.112255e-03 3 1  ON 25
ci_27                 2.698880e-03 3 1  ON 26
ci_28                 4.440861e-03 3 1  ON 27
ci_29                 4.005515e-03 3 1  ON 28
ci_30                 6.704345e-04 3 1  ON 29
ci_31                 1.054129e-03 3 1  ON 30
ci_32                 2.630740e-04 3 1  ON 31
ci_33                 7.782041e-05 3 1  ON 32
ci_34                 8.968107e-04 3 1  ON 33
ci_35                -2.386659e-05 3 1  ON 34
ci_36                -8.953063e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.634703e-04 3 1  ON 37
ci_39                 4.144785e-04 3 1  ON 38
ci_40                -1.372563e-03 3 1  ON 39
ci_41                 5.404473e-04 3 1  ON 40
ci_42                 4.057251e-04 3 1  ON 41
ci_43                -2.414405e-03 3 1  ON 42
ci_44                -2.690264e-03 3 1  ON 43
ci_45                -1.235775e-06 3 1  ON 44
ci_46                -5.407643e-04 3 1  ON 45
ci_47                -1.411669e-03 3 1  ON 46
ci_48                -6.363824e-04 3 1  ON 47
ci_49                -1.402289e-03 3 1  ON 48
ci_50                -4.900365e-04 3 1  ON 49
ci_51                 6.455414e-04 3 1  ON 50
ci_52                 2.153054e-04 3 1  ON 51
ci_53                -1.120555e-03 3 1  ON 52
ci_54                -1.409405e-03 3 1  ON 53
ci_55                -1.055707e-03 3 1  ON 54
ci_56                 2.128987e-03 3 1  ON 55
ci_57                 7.338728e-04 3 1  ON 56
ci_58                -1.196396e-03 3 1  ON 57
ci_59                -2.050427e-03 3 1  ON 58
ci_60                 4.754313e-04 3 1  ON 59
ci_61                 1.783890e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.084210e-05 3 1  ON 62
ci_64                -6.291547e-04 3 1  ON 63
ci_65                -4.772180e-04 3 1  ON 64
ci_66                 1.659315e-04 3 1  ON 65
ci_67                -9.729712e-04 3 1  ON 66
ci_68                -1.357785e-03 3 1  ON 67
ci_69                -9.573406e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3001e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8688
    reference variance = 0.393405
====================================================
  Execution time = 2.5779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9491e-01
  Total weights = 1.964192034e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478556551189
                                         uncertainty =       0.001995135066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478556551189
                                         uncertainty =       0.001995135066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489220285
  error estimate for blocks of size 2^( 2) =       0.000510566267
  error estimate for blocks of size 2^( 3) =       0.000530512220
  error estimate for blocks of size 2^( 4) =       0.000546136340
  error estimate for blocks of size 2^( 5) =       0.000555635541
  error estimate for blocks of size 2^( 6) =       0.000560853660
  error estimate for blocks of size 2^( 7) =       0.000561937558

      target function =                  N/A
              le_mean =     -22.820317821257
             les_mean =     521.261815599177
             stat err =       0.000556140775
             autocorr =       1.292291726228
              std dev =       0.691861961353
             le_variance =       0.478672973567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282031782126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820317821189       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820317845320       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820317844818       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820317845020       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.504331e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820317821189       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820317827225       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820317827099       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820317827150       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 3.763749e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820317821189       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820317822698       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820317822667       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820317822679       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 9.411201e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014437 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0434e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.147277e-01 3 1  ON 0
ci_02                -2.589867e-02 3 1  ON 1
ci_03                -2.555453e-02 3 1  ON 2
ci_04                 2.529709e-02 3 1  ON 3
ci_05                -2.314387e-02 3 1  ON 4
ci_06                -2.383362e-02 3 1  ON 5
ci_07                 2.643474e-02 3 1  ON 6
ci_08                -4.259371e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142763e-02 3 1  ON 9
ci_11                 1.612908e-02 3 1  ON 10
ci_12                 1.090304e-02 3 1  ON 11
ci_13                 1.166190e-02 3 1  ON 12
ci_14                 1.661455e-02 3 1  ON 13
ci_15                 7.583576e-03 3 1  ON 14
ci_16                 7.885057e-03 3 1  ON 15
ci_17                -9.594240e-03 3 1  ON 16
ci_18                -9.869828e-03 3 1  ON 17
ci_19                 9.396163e-03 3 1  ON 18
ci_20                 1.116715e-02 3 1  ON 19
ci_21                 7.558084e-03 3 1  ON 20
ci_22                 7.806988e-03 3 1  ON 21
ci_23                 6.665630e-03 3 1  ON 22
ci_24                 6.534350e-03 3 1  ON 23
ci_25                 5.093850e-03 3 1  ON 24
ci_26                 2.112343e-03 3 1  ON 25
ci_27                 2.699063e-03 3 1  ON 26
ci_28                 4.440865e-03 3 1  ON 27
ci_29                 4.005707e-03 3 1  ON 28
ci_30                 6.703549e-04 3 1  ON 29
ci_31                 1.053966e-03 3 1  ON 30
ci_32                 2.630338e-04 3 1  ON 31
ci_33                 7.794965e-05 3 1  ON 32
ci_34                 8.966367e-04 3 1  ON 33
ci_35                -2.404997e-05 3 1  ON 34
ci_36                -8.952633e-04 3 1  ON 35
ci_37                -5.143073e-04 3 1  ON 36
ci_38                -2.634021e-04 3 1  ON 37
ci_39                 4.143001e-04 3 1  ON 38
ci_40                -1.372729e-03 3 1  ON 39
ci_41                 5.404917e-04 3 1  ON 40
ci_42                 4.056186e-04 3 1  ON 41
ci_43                -2.414357e-03 3 1  ON 42
ci_44                -2.690046e-03 3 1  ON 43
ci_45                -1.162028e-06 3 1  ON 44
ci_46                -5.406899e-04 3 1  ON 45
ci_47                -1.411595e-03 3 1  ON 46
ci_48                -6.362282e-04 3 1  ON 47
ci_49                -1.402315e-03 3 1  ON 48
ci_50                -4.899810e-04 3 1  ON 49
ci_51                 6.455402e-04 3 1  ON 50
ci_52                 2.153580e-04 3 1  ON 51
ci_53                -1.120454e-03 3 1  ON 52
ci_54                -1.409093e-03 3 1  ON 53
ci_55                -1.055741e-03 3 1  ON 54
ci_56                 2.128668e-03 3 1  ON 55
ci_57                 7.340269e-04 3 1  ON 56
ci_58                -1.196313e-03 3 1  ON 57
ci_59                -2.050411e-03 3 1  ON 58
ci_60                 4.755773e-04 3 1  ON 59
ci_61                 1.783994e-03 3 1  ON 60
ci_62                -5.831834e-04 3 1  ON 61
ci_63                -9.105159e-05 3 1  ON 62
ci_64                -6.290852e-04 3 1  ON 63
ci_65                -4.773467e-04 3 1  ON 64
ci_66                 1.658094e-04 3 1  ON 65
ci_67                -9.729547e-04 3 1  ON 66
ci_68                -1.357541e-03 3 1  ON 67
ci_69                -9.571645e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7671
    reference variance = 0.238092
====================================================
  Execution time = 2.5134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9110e-01
  Total weights = 1.9634e+06
  Execution time = 3.5896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175730750
                                         uncertainty =       0.002756985788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175730750
                                         uncertainty =       0.002756985788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487420460
  error estimate for blocks of size 2^( 2) =       0.000508348422
  error estimate for blocks of size 2^( 3) =       0.000528668018
  error estimate for blocks of size 2^( 4) =       0.000544707646
  error estimate for blocks of size 2^( 5) =       0.000554390854
  error estimate for blocks of size 2^( 6) =       0.000561823863
  error estimate for blocks of size 2^( 7) =       0.000562980320

      target function =                  N/A
              le_mean =     -22.820604906771
             les_mean =     521.271112575432
             stat err =       0.000555975671
             autocorr =       1.301080188645
              std dev =       0.689316625510
             le_variance =       0.475157410204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175514486
                                         uncertainty =       0.002756972150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175514486
                                         uncertainty =       0.002756972150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487420350
  error estimate for blocks of size 2^( 2) =       0.000508348335
  error estimate for blocks of size 2^( 3) =       0.000528667961
  error estimate for blocks of size 2^( 4) =       0.000544707621
  error estimate for blocks of size 2^( 5) =       0.000554390840
  error estimate for blocks of size 2^( 6) =       0.000561823826
  error estimate for blocks of size 2^( 7) =       0.000562980334

      target function =                  N/A
              le_mean =     -22.820604888585
             les_mean =     521.271108772629
             stat err =       0.000555975655
             autocorr =       1.301080705562
              std dev =       0.689316469205
             le_variance =       0.475157194718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175622456
                                         uncertainty =       0.002756978962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175622456
                                         uncertainty =       0.002756978962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487420405
  error estimate for blocks of size 2^( 2) =       0.000508348379
  error estimate for blocks of size 2^( 3) =       0.000528667990
  error estimate for blocks of size 2^( 4) =       0.000544707634
  error estimate for blocks of size 2^( 5) =       0.000554390847
  error estimate for blocks of size 2^( 6) =       0.000561823844
  error estimate for blocks of size 2^( 7) =       0.000562980327

      target function =                  N/A
              le_mean =     -22.820604897659
             les_mean =     521.271110644689
             stat err =       0.000555975663
             autocorr =       1.301080447316
              std dev =       0.689316547240
             le_variance =       0.475157302299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175717201
                                         uncertainty =       0.002756984935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475175717201
                                         uncertainty =       0.002756984935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487420453
  error estimate for blocks of size 2^( 2) =       0.000508348417
  error estimate for blocks of size 2^( 3) =       0.000528668015
  error estimate for blocks of size 2^( 4) =       0.000544707644
  error estimate for blocks of size 2^( 5) =       0.000554390853
  error estimate for blocks of size 2^( 6) =       0.000561823860
  error estimate for blocks of size 2^( 7) =       0.000562980321

      target function =                  N/A
              le_mean =     -22.820604905631
             les_mean =     521.271112330867
             stat err =       0.000555975670
             autocorr =       1.301080220992
              std dev =       0.689316615717
             le_variance =       0.475157396704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820604906771        initial  <--
     2.5000e+02     2.5000e+03             1.5043e-06       -22.820604888585
     1.0000e+03     1.0000e+04             3.7637e-07       -22.820604897659
     4.0000e+03     4.0000e+04             9.4112e-08       -22.820604905631

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1094
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529736e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643507e-02 3 1  ON 6
ci_08                -4.259309e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142776e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583382e-03 3 1  ON 14
ci_16                 7.884927e-03 3 1  ON 15
ci_17                -9.594189e-03 3 1  ON 16
ci_18                -9.869923e-03 3 1  ON 17
ci_19                 9.395787e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558203e-03 3 1  ON 20
ci_22                 7.806936e-03 3 1  ON 21
ci_23                 6.665913e-03 3 1  ON 22
ci_24                 6.534144e-03 3 1  ON 23
ci_25                 5.093891e-03 3 1  ON 24
ci_26                 2.112255e-03 3 1  ON 25
ci_27                 2.698880e-03 3 1  ON 26
ci_28                 4.440861e-03 3 1  ON 27
ci_29                 4.005515e-03 3 1  ON 28
ci_30                 6.704345e-04 3 1  ON 29
ci_31                 1.054129e-03 3 1  ON 30
ci_32                 2.630740e-04 3 1  ON 31
ci_33                 7.782041e-05 3 1  ON 32
ci_34                 8.968107e-04 3 1  ON 33
ci_35                -2.386659e-05 3 1  ON 34
ci_36                -8.953063e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.634703e-04 3 1  ON 37
ci_39                 4.144785e-04 3 1  ON 38
ci_40                -1.372563e-03 3 1  ON 39
ci_41                 5.404473e-04 3 1  ON 40
ci_42                 4.057251e-04 3 1  ON 41
ci_43                -2.414405e-03 3 1  ON 42
ci_44                -2.690264e-03 3 1  ON 43
ci_45                -1.235775e-06 3 1  ON 44
ci_46                -5.407643e-04 3 1  ON 45
ci_47                -1.411669e-03 3 1  ON 46
ci_48                -6.363824e-04 3 1  ON 47
ci_49                -1.402289e-03 3 1  ON 48
ci_50                -4.900365e-04 3 1  ON 49
ci_51                 6.455414e-04 3 1  ON 50
ci_52                 2.153054e-04 3 1  ON 51
ci_53                -1.120555e-03 3 1  ON 52
ci_54                -1.409405e-03 3 1  ON 53
ci_55                -1.055707e-03 3 1  ON 54
ci_56                 2.128987e-03 3 1  ON 55
ci_57                 7.338728e-04 3 1  ON 56
ci_58                -1.196396e-03 3 1  ON 57
ci_59                -2.050427e-03 3 1  ON 58
ci_60                 4.754313e-04 3 1  ON 59
ci_61                 1.783890e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.084210e-05 3 1  ON 62
ci_64                -6.291547e-04 3 1  ON 63
ci_65                -4.772180e-04 3 1  ON 64
ci_66                 1.659315e-04 3 1  ON 65
ci_67                -9.729712e-04 3 1  ON 66
ci_68                -1.357785e-03 3 1  ON 67
ci_69                -9.573406e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8079
    reference variance = 0.273271
====================================================
  Execution time = 2.7562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 5.1070e-01
  Total weights = 1.963657285e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490236446499
                                         uncertainty =       0.009381363015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490236446499
                                         uncertainty =       0.009381363015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495055943
  error estimate for blocks of size 2^( 2) =       0.000515742860
  error estimate for blocks of size 2^( 3) =       0.000535255923
  error estimate for blocks of size 2^( 4) =       0.000549954670
  error estimate for blocks of size 2^( 5) =       0.000560022265
  error estimate for blocks of size 2^( 6) =       0.000565000032
  error estimate for blocks of size 2^( 7) =       0.000569708095

      target function =                  N/A
              le_mean =     -22.819793718594
             les_mean =     521.253687296645
             stat err =       0.000561171265
             autocorr =       1.284938357946
              std dev =       0.700114828071
             le_variance =       0.490160772485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281979371859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819793718500       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819793722052       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819793722145       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819793722146       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 1.722284e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819793718500       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819793719388       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819793719412       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819793719412       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 4.305906e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819793718500       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819793718722       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819793718728       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819793718728       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+04 is 1.076489e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2127e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555477e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383359e-02 3 1  ON 5
ci_07                 2.643506e-02 3 1  ON 6
ci_08                -4.259321e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612917e-02 3 1  ON 10
ci_12                 1.090286e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583410e-03 3 1  ON 14
ci_16                 7.884950e-03 3 1  ON 15
ci_17                -9.594182e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395770e-03 3 1  ON 18
ci_20                 1.116731e-02 3 1  ON 19
ci_21                 7.558203e-03 3 1  ON 20
ci_22                 7.806950e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534151e-03 3 1  ON 23
ci_25                 5.093893e-03 3 1  ON 24
ci_26                 2.112248e-03 3 1  ON 25
ci_27                 2.698883e-03 3 1  ON 26
ci_28                 4.440820e-03 3 1  ON 27
ci_29                 4.005510e-03 3 1  ON 28
ci_30                 6.704433e-04 3 1  ON 29
ci_31                 1.054115e-03 3 1  ON 30
ci_32                 2.630821e-04 3 1  ON 31
ci_33                 7.782484e-05 3 1  ON 32
ci_34                 8.968208e-04 3 1  ON 33
ci_35                -2.387289e-05 3 1  ON 34
ci_36                -8.953348e-04 3 1  ON 35
ci_37                -5.142870e-04 3 1  ON 36
ci_38                -2.634895e-04 3 1  ON 37
ci_39                 4.144659e-04 3 1  ON 38
ci_40                -1.372546e-03 3 1  ON 39
ci_41                 5.404528e-04 3 1  ON 40
ci_42                 4.057386e-04 3 1  ON 41
ci_43                -2.414403e-03 3 1  ON 42
ci_44                -2.690260e-03 3 1  ON 43
ci_45                -1.231541e-06 3 1  ON 44
ci_46                -5.407418e-04 3 1  ON 45
ci_47                -1.411659e-03 3 1  ON 46
ci_48                -6.363755e-04 3 1  ON 47
ci_49                -1.402287e-03 3 1  ON 48
ci_50                -4.900675e-04 3 1  ON 49
ci_51                 6.455202e-04 3 1  ON 50
ci_52                 2.153100e-04 3 1  ON 51
ci_53                -1.120559e-03 3 1  ON 52
ci_54                -1.409397e-03 3 1  ON 53
ci_55                -1.055701e-03 3 1  ON 54
ci_56                 2.128977e-03 3 1  ON 55
ci_57                 7.338753e-04 3 1  ON 56
ci_58                -1.196412e-03 3 1  ON 57
ci_59                -2.050399e-03 3 1  ON 58
ci_60                 4.754374e-04 3 1  ON 59
ci_61                 1.783896e-03 3 1  ON 60
ci_62                -5.833743e-04 3 1  ON 61
ci_63                -9.082309e-05 3 1  ON 62
ci_64                -6.291599e-04 3 1  ON 63
ci_65                -4.772234e-04 3 1  ON 64
ci_66                 1.659209e-04 3 1  ON 65
ci_67                -9.729603e-04 3 1  ON 66
ci_68                -1.357768e-03 3 1  ON 67
ci_69                -9.573570e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7113
    reference variance = 0.318442
====================================================
  Execution time = 2.5009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9368e-01
  Total weights = 1.9635e+06
  Execution time = 3.5709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949733733
                                         uncertainty =       0.002364520305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949733733
                                         uncertainty =       0.002364520305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488884681
  error estimate for blocks of size 2^( 2) =       0.000509627433
  error estimate for blocks of size 2^( 3) =       0.000529477173
  error estimate for blocks of size 2^( 4) =       0.000544150493
  error estimate for blocks of size 2^( 5) =       0.000553523007
  error estimate for blocks of size 2^( 6) =       0.000557484404
  error estimate for blocks of size 2^( 7) =       0.000559837986

      target function =                  N/A
              le_mean =     -22.820325887327
             les_mean =     521.260961671421
             stat err =       0.000553748973
             autocorr =       1.282959681411
              std dev =       0.691387346942
             le_variance =       0.478016463511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949706101
                                         uncertainty =       0.002364519426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949706101
                                         uncertainty =       0.002364519426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488884667
  error estimate for blocks of size 2^( 2) =       0.000509627421
  error estimate for blocks of size 2^( 3) =       0.000529477164
  error estimate for blocks of size 2^( 4) =       0.000544150486
  error estimate for blocks of size 2^( 5) =       0.000553523005
  error estimate for blocks of size 2^( 6) =       0.000557484407
  error estimate for blocks of size 2^( 7) =       0.000559837987

      target function =                  N/A
              le_mean =     -22.820325886436
             les_mean =     521.260946399843
             stat err =       0.000553748971
             autocorr =       1.282959748748
              std dev =       0.691387326938
             le_variance =       0.478016435850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949719915
                                         uncertainty =       0.002364519865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949719915
                                         uncertainty =       0.002364519865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488884674
  error estimate for blocks of size 2^( 2) =       0.000509627427
  error estimate for blocks of size 2^( 3) =       0.000529477168
  error estimate for blocks of size 2^( 4) =       0.000544150490
  error estimate for blocks of size 2^( 5) =       0.000553523006
  error estimate for blocks of size 2^( 6) =       0.000557484405
  error estimate for blocks of size 2^( 7) =       0.000559837987

      target function =                  N/A
              le_mean =     -22.820325886881
             les_mean =     521.260953951421
             stat err =       0.000553748972
             autocorr =       1.282959715095
              std dev =       0.691387336938
             le_variance =       0.478016449679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949732005
                                         uncertainty =       0.002364520250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477949732005
                                         uncertainty =       0.002364520250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488884681
  error estimate for blocks of size 2^( 2) =       0.000509627433
  error estimate for blocks of size 2^( 3) =       0.000529477172
  error estimate for blocks of size 2^( 4) =       0.000544150493
  error estimate for blocks of size 2^( 5) =       0.000553523007
  error estimate for blocks of size 2^( 6) =       0.000557484404
  error estimate for blocks of size 2^( 7) =       0.000559837987

      target function =                  N/A
              le_mean =     -22.820325887271
             les_mean =     521.260960697098
             stat err =       0.000553748973
             autocorr =       1.282959685627
              std dev =       0.691387345691
             le_variance =       0.478016461782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820325887327        initial  <--
     2.5000e+03     2.5000e+04             1.7223e-07       -22.820325886436
     1.0000e+04     1.0000e+05             4.3059e-08       -22.820325886881
     4.0000e+04     4.0000e+05             1.0765e-08       -22.820325887271

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8996
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529736e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643507e-02 3 1  ON 6
ci_08                -4.259309e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142776e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583382e-03 3 1  ON 14
ci_16                 7.884927e-03 3 1  ON 15
ci_17                -9.594189e-03 3 1  ON 16
ci_18                -9.869923e-03 3 1  ON 17
ci_19                 9.395787e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558203e-03 3 1  ON 20
ci_22                 7.806936e-03 3 1  ON 21
ci_23                 6.665913e-03 3 1  ON 22
ci_24                 6.534144e-03 3 1  ON 23
ci_25                 5.093891e-03 3 1  ON 24
ci_26                 2.112255e-03 3 1  ON 25
ci_27                 2.698880e-03 3 1  ON 26
ci_28                 4.440861e-03 3 1  ON 27
ci_29                 4.005515e-03 3 1  ON 28
ci_30                 6.704345e-04 3 1  ON 29
ci_31                 1.054129e-03 3 1  ON 30
ci_32                 2.630740e-04 3 1  ON 31
ci_33                 7.782041e-05 3 1  ON 32
ci_34                 8.968107e-04 3 1  ON 33
ci_35                -2.386659e-05 3 1  ON 34
ci_36                -8.953063e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.634703e-04 3 1  ON 37
ci_39                 4.144785e-04 3 1  ON 38
ci_40                -1.372563e-03 3 1  ON 39
ci_41                 5.404473e-04 3 1  ON 40
ci_42                 4.057251e-04 3 1  ON 41
ci_43                -2.414405e-03 3 1  ON 42
ci_44                -2.690264e-03 3 1  ON 43
ci_45                -1.235775e-06 3 1  ON 44
ci_46                -5.407643e-04 3 1  ON 45
ci_47                -1.411669e-03 3 1  ON 46
ci_48                -6.363824e-04 3 1  ON 47
ci_49                -1.402289e-03 3 1  ON 48
ci_50                -4.900365e-04 3 1  ON 49
ci_51                 6.455414e-04 3 1  ON 50
ci_52                 2.153054e-04 3 1  ON 51
ci_53                -1.120555e-03 3 1  ON 52
ci_54                -1.409405e-03 3 1  ON 53
ci_55                -1.055707e-03 3 1  ON 54
ci_56                 2.128987e-03 3 1  ON 55
ci_57                 7.338728e-04 3 1  ON 56
ci_58                -1.196396e-03 3 1  ON 57
ci_59                -2.050427e-03 3 1  ON 58
ci_60                 4.754313e-04 3 1  ON 59
ci_61                 1.783890e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.084210e-05 3 1  ON 62
ci_64                -6.291547e-04 3 1  ON 63
ci_65                -4.772180e-04 3 1  ON 64
ci_66                 1.659315e-04 3 1  ON 65
ci_67                -9.729712e-04 3 1  ON 66
ci_68                -1.357785e-03 3 1  ON 67
ci_69                -9.573406e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8044
    reference variance = 0.347637
====================================================
  Execution time = 2.5488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9302e-01
  Total weights = 1.963920057e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475816241503
                                         uncertainty =       0.002237637307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475816241503
                                         uncertainty =       0.002237637307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487745223
  error estimate for blocks of size 2^( 2) =       0.000508723826
  error estimate for blocks of size 2^( 3) =       0.000528634435
  error estimate for blocks of size 2^( 4) =       0.000543584612
  error estimate for blocks of size 2^( 5) =       0.000553708251
  error estimate for blocks of size 2^( 6) =       0.000557080075
  error estimate for blocks of size 2^( 7) =       0.000562211215

      target function =                  N/A
              le_mean =     -22.819581776175
             les_mean =     521.226329697745
             stat err =       0.000554146038
             autocorr =       1.290810281197
              std dev =       0.689775909268
             le_variance =       0.475790805006


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281958177618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819581776136       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819581776468       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819581776504       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819581776508       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 2.599172e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819581776136       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819581776219       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819581776228       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819581776229       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 6.497960e-09

solving harmonic davidson linear method for identity shift 4.0000e+05, overlap shift 4.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819581776136       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819581776157       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819581776159       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819581776160       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+05 is 1.624492e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0031e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589876e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529735e-02 3 1  ON 3
ci_05                -2.314385e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643507e-02 3 1  ON 6
ci_08                -4.259310e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142776e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583383e-03 3 1  ON 14
ci_16                 7.884926e-03 3 1  ON 15
ci_17                -9.594190e-03 3 1  ON 16
ci_18                -9.869926e-03 3 1  ON 17
ci_19                 9.395785e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558205e-03 3 1  ON 20
ci_22                 7.806943e-03 3 1  ON 21
ci_23                 6.665914e-03 3 1  ON 22
ci_24                 6.534146e-03 3 1  ON 23
ci_25                 5.093890e-03 3 1  ON 24
ci_26                 2.112256e-03 3 1  ON 25
ci_27                 2.698879e-03 3 1  ON 26
ci_28                 4.440860e-03 3 1  ON 27
ci_29                 4.005514e-03 3 1  ON 28
ci_30                 6.704333e-04 3 1  ON 29
ci_31                 1.054129e-03 3 1  ON 30
ci_32                 2.630725e-04 3 1  ON 31
ci_33                 7.782118e-05 3 1  ON 32
ci_34                 8.968106e-04 3 1  ON 33
ci_35                -2.386817e-05 3 1  ON 34
ci_36                -8.953077e-04 3 1  ON 35
ci_37                -5.142991e-04 3 1  ON 36
ci_38                -2.634709e-04 3 1  ON 37
ci_39                 4.144775e-04 3 1  ON 38
ci_40                -1.372566e-03 3 1  ON 39
ci_41                 5.404449e-04 3 1  ON 40
ci_42                 4.057232e-04 3 1  ON 41
ci_43                -2.414406e-03 3 1  ON 42
ci_44                -2.690260e-03 3 1  ON 43
ci_45                -1.236693e-06 3 1  ON 44
ci_46                -5.407648e-04 3 1  ON 45
ci_47                -1.411666e-03 3 1  ON 46
ci_48                -6.363846e-04 3 1  ON 47
ci_49                -1.402288e-03 3 1  ON 48
ci_50                -4.900373e-04 3 1  ON 49
ci_51                 6.455416e-04 3 1  ON 50
ci_52                 2.153072e-04 3 1  ON 51
ci_53                -1.120556e-03 3 1  ON 52
ci_54                -1.409403e-03 3 1  ON 53
ci_55                -1.055707e-03 3 1  ON 54
ci_56                 2.128985e-03 3 1  ON 55
ci_57                 7.338755e-04 3 1  ON 56
ci_58                -1.196397e-03 3 1  ON 57
ci_59                -2.050426e-03 3 1  ON 58
ci_60                 4.754330e-04 3 1  ON 59
ci_61                 1.783889e-03 3 1  ON 60
ci_62                -5.833815e-04 3 1  ON 61
ci_63                -9.084097e-05 3 1  ON 62
ci_64                -6.291540e-04 3 1  ON 63
ci_65                -4.772198e-04 3 1  ON 64
ci_66                 1.659312e-04 3 1  ON 65
ci_67                -9.729722e-04 3 1  ON 66
ci_68                -1.357786e-03 3 1  ON 67
ci_69                -9.573398e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8204
    reference variance = 0.459237
====================================================
  Execution time = 2.5299e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9663e-01
  Total weights = 1.9636e+06
  Execution time = 3.5996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892389767
                                         uncertainty =       0.002596812932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892389767
                                         uncertainty =       0.002596812932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490354442
  error estimate for blocks of size 2^( 2) =       0.000510965421
  error estimate for blocks of size 2^( 3) =       0.000530130466
  error estimate for blocks of size 2^( 4) =       0.000544375943
  error estimate for blocks of size 2^( 5) =       0.000552139649
  error estimate for blocks of size 2^( 6) =       0.000557433571
  error estimate for blocks of size 2^( 7) =       0.000559678019

      target function =                  N/A
              le_mean =     -22.821211380189
             les_mean =     521.304317974006
             stat err =       0.000553406796
             autocorr =       1.273704690337
              std dev =       0.693465902157
             le_variance =       0.480894957455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892388008
                                         uncertainty =       0.002596812925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892388008
                                         uncertainty =       0.002596812925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490354441
  error estimate for blocks of size 2^( 2) =       0.000510965420
  error estimate for blocks of size 2^( 3) =       0.000530130465
  error estimate for blocks of size 2^( 4) =       0.000544375942
  error estimate for blocks of size 2^( 5) =       0.000552139648
  error estimate for blocks of size 2^( 6) =       0.000557433570
  error estimate for blocks of size 2^( 7) =       0.000559678020

      target function =                  N/A
              le_mean =     -22.821211380396
             les_mean =     521.304317986068
             stat err =       0.000553406795
             autocorr =       1.273704692873
              std dev =       0.693465900892
             le_variance =       0.480894955700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892388888
                                         uncertainty =       0.002596812929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892388888
                                         uncertainty =       0.002596812929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490354441
  error estimate for blocks of size 2^( 2) =       0.000510965420
  error estimate for blocks of size 2^( 3) =       0.000530130466
  error estimate for blocks of size 2^( 4) =       0.000544375943
  error estimate for blocks of size 2^( 5) =       0.000552139649
  error estimate for blocks of size 2^( 6) =       0.000557433571
  error estimate for blocks of size 2^( 7) =       0.000559678019

      target function =                  N/A
              le_mean =     -22.821211380292
             les_mean =     521.304317980036
             stat err =       0.000553406795
             autocorr =       1.273704691601
              std dev =       0.693465901525
             le_variance =       0.480894956577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892389657
                                         uncertainty =       0.002596812932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480892389657
                                         uncertainty =       0.002596812932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490354442
  error estimate for blocks of size 2^( 2) =       0.000510965421
  error estimate for blocks of size 2^( 3) =       0.000530130466
  error estimate for blocks of size 2^( 4) =       0.000544375943
  error estimate for blocks of size 2^( 5) =       0.000552139649
  error estimate for blocks of size 2^( 6) =       0.000557433571
  error estimate for blocks of size 2^( 7) =       0.000559678019

      target function =                  N/A
              le_mean =     -22.821211380202
             les_mean =     521.304317974759
             stat err =       0.000553406796
             autocorr =       1.273704690495
              std dev =       0.693465902078
             le_variance =       0.480894957345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.821211380189        initial
     2.5000e+04     2.5000e+05             2.5992e-08       -22.821211380396  <--
     1.0000e+05     1.0000e+06             6.4980e-09       -22.821211380292
     4.0000e+05     4.0000e+06             1.6245e-09       -22.821211380202

*****************************************************************************
Applying the update for shift_i =   2.5000e+04     and shift_s =   2.5000e+05
*****************************************************************************

  Execution time = 4.3300e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589875e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529735e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383363e-02 3 1  ON 5
ci_07                 2.643506e-02 3 1  ON 6
ci_08                -4.259313e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142775e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090288e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583385e-03 3 1  ON 14
ci_16                 7.884922e-03 3 1  ON 15
ci_17                -9.594191e-03 3 1  ON 16
ci_18                -9.869932e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558209e-03 3 1  ON 20
ci_22                 7.806962e-03 3 1  ON 21
ci_23                 6.665917e-03 3 1  ON 22
ci_24                 6.534152e-03 3 1  ON 23
ci_25                 5.093887e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698876e-03 3 1  ON 26
ci_28                 4.440858e-03 3 1  ON 27
ci_29                 4.005509e-03 3 1  ON 28
ci_30                 6.704299e-04 3 1  ON 29
ci_31                 1.054128e-03 3 1  ON 30
ci_32                 2.630682e-04 3 1  ON 31
ci_33                 7.782351e-05 3 1  ON 32
ci_34                 8.968106e-04 3 1  ON 33
ci_35                -2.387290e-05 3 1  ON 34
ci_36                -8.953121e-04 3 1  ON 35
ci_37                -5.143032e-04 3 1  ON 36
ci_38                -2.634726e-04 3 1  ON 37
ci_39                 4.144746e-04 3 1  ON 38
ci_40                -1.372577e-03 3 1  ON 39
ci_41                 5.404378e-04 3 1  ON 40
ci_42                 4.057175e-04 3 1  ON 41
ci_43                -2.414408e-03 3 1  ON 42
ci_44                -2.690250e-03 3 1  ON 43
ci_45                -1.239448e-06 3 1  ON 44
ci_46                -5.407663e-04 3 1  ON 45
ci_47                -1.411657e-03 3 1  ON 46
ci_48                -6.363914e-04 3 1  ON 47
ci_49                -1.402283e-03 3 1  ON 48
ci_50                -4.900397e-04 3 1  ON 49
ci_51                 6.455422e-04 3 1  ON 50
ci_52                 2.153124e-04 3 1  ON 51
ci_53                -1.120558e-03 3 1  ON 52
ci_54                -1.409397e-03 3 1  ON 53
ci_55                -1.055705e-03 3 1  ON 54
ci_56                 2.128979e-03 3 1  ON 55
ci_57                 7.338835e-04 3 1  ON 56
ci_58                -1.196400e-03 3 1  ON 57
ci_59                -2.050424e-03 3 1  ON 58
ci_60                 4.754384e-04 3 1  ON 59
ci_61                 1.783886e-03 3 1  ON 60
ci_62                -5.833749e-04 3 1  ON 61
ci_63                -9.083759e-05 3 1  ON 62
ci_64                -6.291518e-04 3 1  ON 63
ci_65                -4.772250e-04 3 1  ON 64
ci_66                 1.659302e-04 3 1  ON 65
ci_67                -9.729753e-04 3 1  ON 66
ci_68                -1.357789e-03 3 1  ON 67
ci_69                -9.573372e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3338e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8931
    reference variance = 0.622359
====================================================
  Execution time = 2.5618e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9175e-01
  Total weights = 1.963536601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523421297
                                         uncertainty =       0.002269785850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523421297
                                         uncertainty =       0.002269785850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488101981
  error estimate for blocks of size 2^( 2) =       0.000508969823
  error estimate for blocks of size 2^( 3) =       0.000529113396
  error estimate for blocks of size 2^( 4) =       0.000543770381
  error estimate for blocks of size 2^( 5) =       0.000552900391
  error estimate for blocks of size 2^( 6) =       0.000560298902
  error estimate for blocks of size 2^( 7) =       0.000562514933

      target function =                  N/A
              le_mean =     -22.819796661703
             les_mean =     521.234867814488
             stat err =       0.000554871152
             autocorr =       1.292299425349
              std dev =       0.690280441693
             le_variance =       0.476487088184


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281979666170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819796661640       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819796662974       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819796662905       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819796662907       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 5.744824e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819796661640       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819796661974       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819796661956       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819796661957       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 1.436240e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819796661640       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819796661723       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819796661719       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819796661719       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+05 is 3.590621e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0163e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589874e-02 3 1  ON 1
ci_03                -2.555475e-02 3 1  ON 2
ci_04                 2.529734e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383362e-02 3 1  ON 5
ci_07                 2.643505e-02 3 1  ON 6
ci_08                -4.259306e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142775e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090289e-02 3 1  ON 11
ci_13                 1.166181e-02 3 1  ON 12
ci_14                 1.661475e-02 3 1  ON 13
ci_15                 7.583385e-03 3 1  ON 14
ci_16                 7.884913e-03 3 1  ON 15
ci_17                -9.594192e-03 3 1  ON 16
ci_18                -9.869926e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116733e-02 3 1  ON 19
ci_21                 7.558214e-03 3 1  ON 20
ci_22                 7.806961e-03 3 1  ON 21
ci_23                 6.665917e-03 3 1  ON 22
ci_24                 6.534156e-03 3 1  ON 23
ci_25                 5.093884e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698868e-03 3 1  ON 26
ci_28                 4.440844e-03 3 1  ON 27
ci_29                 4.005505e-03 3 1  ON 28
ci_30                 6.704296e-04 3 1  ON 29
ci_31                 1.054119e-03 3 1  ON 30
ci_32                 2.630609e-04 3 1  ON 31
ci_33                 7.781194e-05 3 1  ON 32
ci_34                 8.968080e-04 3 1  ON 33
ci_35                -2.387657e-05 3 1  ON 34
ci_36                -8.953151e-04 3 1  ON 35
ci_37                -5.143015e-04 3 1  ON 36
ci_38                -2.634853e-04 3 1  ON 37
ci_39                 4.144703e-04 3 1  ON 38
ci_40                -1.372572e-03 3 1  ON 39
ci_41                 5.404373e-04 3 1  ON 40
ci_42                 4.057169e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690244e-03 3 1  ON 43
ci_45                -1.246578e-06 3 1  ON 44
ci_46                -5.407638e-04 3 1  ON 45
ci_47                -1.411645e-03 3 1  ON 46
ci_48                -6.364001e-04 3 1  ON 47
ci_49                -1.402281e-03 3 1  ON 48
ci_50                -4.900401e-04 3 1  ON 49
ci_51                 6.455360e-04 3 1  ON 50
ci_52                 2.153107e-04 3 1  ON 51
ci_53                -1.120555e-03 3 1  ON 52
ci_54                -1.409390e-03 3 1  ON 53
ci_55                -1.055697e-03 3 1  ON 54
ci_56                 2.128972e-03 3 1  ON 55
ci_57                 7.338953e-04 3 1  ON 56
ci_58                -1.196391e-03 3 1  ON 57
ci_59                -2.050414e-03 3 1  ON 58
ci_60                 4.754448e-04 3 1  ON 59
ci_61                 1.783878e-03 3 1  ON 60
ci_62                -5.833771e-04 3 1  ON 61
ci_63                -9.084486e-05 3 1  ON 62
ci_64                -6.291554e-04 3 1  ON 63
ci_65                -4.772348e-04 3 1  ON 64
ci_66                 1.659192e-04 3 1  ON 65
ci_67                -9.729689e-04 3 1  ON 66
ci_68                -1.357790e-03 3 1  ON 67
ci_69                -9.573384e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6963
    reference variance = 0.588191
====================================================
  Execution time = 2.5002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9561e-01
  Total weights = 1.9639e+06
  Execution time = 3.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074620915
                                         uncertainty =       0.002913587265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074620915
                                         uncertainty =       0.002913587265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489473641
  error estimate for blocks of size 2^( 2) =       0.000509942119
  error estimate for blocks of size 2^( 3) =       0.000529396846
  error estimate for blocks of size 2^( 4) =       0.000544329261
  error estimate for blocks of size 2^( 5) =       0.000553192098
  error estimate for blocks of size 2^( 6) =       0.000559311133
  error estimate for blocks of size 2^( 7) =       0.000559411477

      target function =                  N/A
              le_mean =     -22.820400035673
             les_mean =     521.266266162549
             stat err =       0.000554060992
             autocorr =       1.281316833486
              std dev =       0.692220261921
             le_variance =       0.479168891014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074603449
                                         uncertainty =       0.002913586054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074603449
                                         uncertainty =       0.002913586054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489473632
  error estimate for blocks of size 2^( 2) =       0.000509942111
  error estimate for blocks of size 2^( 3) =       0.000529396839
  error estimate for blocks of size 2^( 4) =       0.000544329255
  error estimate for blocks of size 2^( 5) =       0.000553192094
  error estimate for blocks of size 2^( 6) =       0.000559311128
  error estimate for blocks of size 2^( 7) =       0.000559411474

      target function =                  N/A
              le_mean =     -22.820400036033
             les_mean =     521.266266004756
             stat err =       0.000554060988
             autocorr =       1.281316859272
              std dev =       0.692220249382
             le_variance =       0.479168873654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074612182
                                         uncertainty =       0.002913586660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074612182
                                         uncertainty =       0.002913586660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489473637
  error estimate for blocks of size 2^( 2) =       0.000509942115
  error estimate for blocks of size 2^( 3) =       0.000529396843
  error estimate for blocks of size 2^( 4) =       0.000544329258
  error estimate for blocks of size 2^( 5) =       0.000553192096
  error estimate for blocks of size 2^( 6) =       0.000559311130
  error estimate for blocks of size 2^( 7) =       0.000559411476

      target function =                  N/A
              le_mean =     -22.820400035853
             les_mean =     521.266266083551
             stat err =       0.000554060990
             autocorr =       1.281316846375
              std dev =       0.692220255651
             le_variance =       0.479168882334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074619824
                                         uncertainty =       0.002913587189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479074619824
                                         uncertainty =       0.002913587189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489473641
  error estimate for blocks of size 2^( 2) =       0.000509942119
  error estimate for blocks of size 2^( 3) =       0.000529396845
  error estimate for blocks of size 2^( 4) =       0.000544329260
  error estimate for blocks of size 2^( 5) =       0.000553192098
  error estimate for blocks of size 2^( 6) =       0.000559311132
  error estimate for blocks of size 2^( 7) =       0.000559411477

      target function =                  N/A
              le_mean =     -22.820400035695
             les_mean =     521.266266152663
             stat err =       0.000554060992
             autocorr =       1.281316835097
              std dev =       0.692220261137
             le_variance =       0.479168889929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820400035673        initial
     6.2500e+03     6.2500e+04             5.7448e-08       -22.820400036033  <--
     2.5000e+04     2.5000e+05             1.4362e-08       -22.820400035853
     1.0000e+05     1.0000e+06             3.5906e-09       -22.820400035695

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 4.2984e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777726e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388756e-05 3 1  ON 34
ci_36                -8.953241e-04 3 1  ON 35
ci_37                -5.142963e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057154e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.267967e-06 3 1  ON 44
ci_46                -5.407560e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455172e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339307e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754639e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833839e-04 3 1  ON 61
ci_63                -9.086665e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658860e-04 3 1  ON 65
ci_67                -9.729497e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8845
    reference variance = 0.501793
====================================================
  Execution time = 2.5548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9973e-01
  Total weights = 1.963507262e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481722325836
                                         uncertainty =       0.002874831102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481722325836
                                         uncertainty =       0.002874831102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490787444
  error estimate for blocks of size 2^( 2) =       0.000511382957
  error estimate for blocks of size 2^( 3) =       0.000530906960
  error estimate for blocks of size 2^( 4) =       0.000546358259
  error estimate for blocks of size 2^( 5) =       0.000557075178
  error estimate for blocks of size 2^( 6) =       0.000563255010
  error estimate for blocks of size 2^( 7) =       0.000566468184

      target function =                  N/A
              le_mean =     -22.820616503897
             les_mean =     521.280266061118
             stat err =       0.000558289158
             autocorr =       1.293991728857
              std dev =       0.694078259663
             le_variance =       0.481744630537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282061650390e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820616503834       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820616505617       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820616505459       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820616505478       residual = 7.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 2.969057e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820616503834       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820616504280       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820616504240       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820616504245       residual = 7.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 7.423418e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820616503834       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820616503946       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820616503936       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820616503937       residual = 7.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 1.855903e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0202e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589870e-02 3 1  ON 1
ci_03                -2.555471e-02 3 1  ON 2
ci_04                 2.529726e-02 3 1  ON 3
ci_05                -2.314387e-02 3 1  ON 4
ci_06                -2.383358e-02 3 1  ON 5
ci_07                 2.643501e-02 3 1  ON 6
ci_08                -4.259295e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142775e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090295e-02 3 1  ON 11
ci_13                 1.166184e-02 3 1  ON 12
ci_14                 1.661472e-02 3 1  ON 13
ci_15                 7.583405e-03 3 1  ON 14
ci_16                 7.884899e-03 3 1  ON 15
ci_17                -9.594243e-03 3 1  ON 16
ci_18                -9.869916e-03 3 1  ON 17
ci_19                 9.395727e-03 3 1  ON 18
ci_20                 1.116730e-02 3 1  ON 19
ci_21                 7.558238e-03 3 1  ON 20
ci_22                 7.806955e-03 3 1  ON 21
ci_23                 6.665935e-03 3 1  ON 22
ci_24                 6.534183e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112316e-03 3 1  ON 25
ci_27                 2.698850e-03 3 1  ON 26
ci_28                 4.440775e-03 3 1  ON 27
ci_29                 4.005488e-03 3 1  ON 28
ci_30                 6.704240e-04 3 1  ON 29
ci_31                 1.054089e-03 3 1  ON 30
ci_32                 2.630137e-04 3 1  ON 31
ci_33                 7.778342e-05 3 1  ON 32
ci_34                 8.967419e-04 3 1  ON 33
ci_35                -2.385808e-05 3 1  ON 34
ci_36                -8.953021e-04 3 1  ON 35
ci_37                -5.142760e-04 3 1  ON 36
ci_38                -2.635119e-04 3 1  ON 37
ci_39                 4.144382e-04 3 1  ON 38
ci_40                -1.372535e-03 3 1  ON 39
ci_41                 5.404295e-04 3 1  ON 40
ci_42                 4.057465e-04 3 1  ON 41
ci_43                -2.414430e-03 3 1  ON 42
ci_44                -2.690188e-03 3 1  ON 43
ci_45                -1.248213e-06 3 1  ON 44
ci_46                -5.407663e-04 3 1  ON 45
ci_47                -1.411609e-03 3 1  ON 46
ci_48                -6.364196e-04 3 1  ON 47
ci_49                -1.402279e-03 3 1  ON 48
ci_50                -4.900940e-04 3 1  ON 49
ci_51                 6.455006e-04 3 1  ON 50
ci_52                 2.153141e-04 3 1  ON 51
ci_53                -1.120532e-03 3 1  ON 52
ci_54                -1.409329e-03 3 1  ON 53
ci_55                -1.055683e-03 3 1  ON 54
ci_56                 2.128909e-03 3 1  ON 55
ci_57                 7.339311e-04 3 1  ON 56
ci_58                -1.196340e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754689e-04 3 1  ON 59
ci_61                 1.783842e-03 3 1  ON 60
ci_62                -5.833551e-04 3 1  ON 61
ci_63                -9.083297e-05 3 1  ON 62
ci_64                -6.291684e-04 3 1  ON 63
ci_65                -4.772282e-04 3 1  ON 64
ci_66                 1.658164e-04 3 1  ON 65
ci_67                -9.729327e-04 3 1  ON 66
ci_68                -1.357781e-03 3 1  ON 67
ci_69                -9.574162e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7853
    reference variance = 0.309502
====================================================
  Execution time = 2.5042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 5.0019e-01
  Total weights = 1.9639e+06
  Execution time = 3.5772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898498971
                                         uncertainty =       0.002682627320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898498971
                                         uncertainty =       0.002682627320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490334109
  error estimate for blocks of size 2^( 2) =       0.000511302877
  error estimate for blocks of size 2^( 3) =       0.000530393969
  error estimate for blocks of size 2^( 4) =       0.000546044982
  error estimate for blocks of size 2^( 5) =       0.000555827339
  error estimate for blocks of size 2^( 6) =       0.000561352637
  error estimate for blocks of size 2^( 7) =       0.000565225077

      target function =                  N/A
              le_mean =     -22.820739192817
             les_mean =     521.286329157663
             stat err =       0.000557112509
             autocorr =       1.290926775131
              std dev =       0.693437147631
             le_variance =       0.480855077714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898494248
                                         uncertainty =       0.002682629515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898494248
                                         uncertainty =       0.002682629515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490334107
  error estimate for blocks of size 2^( 2) =       0.000511302877
  error estimate for blocks of size 2^( 3) =       0.000530393979
  error estimate for blocks of size 2^( 4) =       0.000546044993
  error estimate for blocks of size 2^( 5) =       0.000555827352
  error estimate for blocks of size 2^( 6) =       0.000561352644
  error estimate for blocks of size 2^( 7) =       0.000565225074

      target function =                  N/A
              le_mean =     -22.820739191362
             les_mean =     521.286329335815
             stat err =       0.000557112516
             autocorr =       1.290926820515
              std dev =       0.693437144164
             le_variance =       0.480855072906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898496606
                                         uncertainty =       0.002682628417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898496606
                                         uncertainty =       0.002682628417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490334108
  error estimate for blocks of size 2^( 2) =       0.000511302877
  error estimate for blocks of size 2^( 3) =       0.000530393974
  error estimate for blocks of size 2^( 4) =       0.000546044987
  error estimate for blocks of size 2^( 5) =       0.000555827345
  error estimate for blocks of size 2^( 6) =       0.000561352641
  error estimate for blocks of size 2^( 7) =       0.000565225076

      target function =                  N/A
              le_mean =     -22.820739192089
             les_mean =     521.286329246622
             stat err =       0.000557112512
             autocorr =       1.290926797835
              std dev =       0.693437145895
             le_variance =       0.480855075307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898498675
                                         uncertainty =       0.002682627457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480898498675
                                         uncertainty =       0.002682627457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490334109
  error estimate for blocks of size 2^( 2) =       0.000511302877
  error estimate for blocks of size 2^( 3) =       0.000530393970
  error estimate for blocks of size 2^( 4) =       0.000546044982
  error estimate for blocks of size 2^( 5) =       0.000555827340
  error estimate for blocks of size 2^( 6) =       0.000561352638
  error estimate for blocks of size 2^( 7) =       0.000565225077

      target function =                  N/A
              le_mean =     -22.820739192726
             les_mean =     521.286329168770
             stat err =       0.000557112509
             autocorr =       1.290926777970
              std dev =       0.693437147414
             le_variance =       0.480855077413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820739192817        initial  <--
     1.5625e+03     1.5625e+04             2.9691e-07       -22.820739191362
     6.2500e+03     6.2500e+04             7.4234e-08       -22.820739192089
     2.5000e+04     2.5000e+05             1.8559e-08       -22.820739192726

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9445
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777726e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388756e-05 3 1  ON 34
ci_36                -8.953241e-04 3 1  ON 35
ci_37                -5.142963e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057154e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.267967e-06 3 1  ON 44
ci_46                -5.407560e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455172e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339307e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754639e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833839e-04 3 1  ON 61
ci_63                -9.086665e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658860e-04 3 1  ON 65
ci_67                -9.729497e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.847
    reference variance = 0.617898
====================================================
  Execution time = 2.7331e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8901e-01
  Total weights = 1.963501872e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473693127274
                                         uncertainty =       0.002513376695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473693127274
                                         uncertainty =       0.002513376695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486650129
  error estimate for blocks of size 2^( 2) =       0.000507621421
  error estimate for blocks of size 2^( 3) =       0.000527275845
  error estimate for blocks of size 2^( 4) =       0.000541810041
  error estimate for blocks of size 2^( 5) =       0.000551894855
  error estimate for blocks of size 2^( 6) =       0.000558338281
  error estimate for blocks of size 2^( 7) =       0.000559953465

      target function =                  N/A
              le_mean =     -22.819490822580
             les_mean =     521.218168204661
             stat err =       0.000552999161
             autocorr =       1.291264642505
              std dev =       0.688227211906
             le_variance =       0.473656695207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281949082258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819490822494       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819490822844       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819490822854       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819490822853       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 2.772198e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819490822494       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819490822582       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819490822584       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819490822608       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 6.930592e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819490822494       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819490822516       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819490822517       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819490822517       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+05 is 1.732654e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1890e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259286e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583383e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594190e-03 3 1  ON 16
ci_18                -9.869909e-03 3 1  ON 17
ci_19                 9.395783e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806961e-03 3 1  ON 21
ci_23                 6.665917e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093873e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698841e-03 3 1  ON 26
ci_28                 4.440798e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704323e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630404e-04 3 1  ON 31
ci_33                 7.777904e-05 3 1  ON 32
ci_34                 8.967995e-04 3 1  ON 33
ci_35                -2.388521e-05 3 1  ON 34
ci_36                -8.953235e-04 3 1  ON 35
ci_37                -5.142917e-04 3 1  ON 36
ci_38                -2.635244e-04 3 1  ON 37
ci_39                 4.144514e-04 3 1  ON 38
ci_40                -1.372554e-03 3 1  ON 39
ci_41                 5.404345e-04 3 1  ON 40
ci_42                 4.057169e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.266124e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411605e-03 3 1  ON 46
ci_48                -6.364274e-04 3 1  ON 47
ci_49                -1.402275e-03 3 1  ON 48
ci_50                -4.900400e-04 3 1  ON 49
ci_51                 6.455128e-04 3 1  ON 50
ci_52                 2.153043e-04 3 1  ON 51
ci_53                -1.120552e-03 3 1  ON 52
ci_54                -1.409368e-03 3 1  ON 53
ci_55                -1.055676e-03 3 1  ON 54
ci_56                 2.128950e-03 3 1  ON 55
ci_57                 7.339366e-04 3 1  ON 56
ci_58                -1.196363e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754652e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833824e-04 3 1  ON 61
ci_63                -9.087039e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772654e-04 3 1  ON 64
ci_66                 1.658857e-04 3 1  ON 65
ci_67                -9.729456e-04 3 1  ON 66
ci_68                -1.357792e-03 3 1  ON 67
ci_69                -9.573405e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8106
    reference variance = 0.508022
====================================================
  Execution time = 2.4891e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9574e-01
  Total weights = 1.9635e+06
  Execution time = 3.5851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664662377
                                         uncertainty =       0.002703076904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664662377
                                         uncertainty =       0.002703076904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488204785
  error estimate for blocks of size 2^( 2) =       0.000509104371
  error estimate for blocks of size 2^( 3) =       0.000528650794
  error estimate for blocks of size 2^( 4) =       0.000543359892
  error estimate for blocks of size 2^( 5) =       0.000552945570
  error estimate for blocks of size 2^( 6) =       0.000555856325
  error estimate for blocks of size 2^( 7) =       0.000559963363

      target function =                  N/A
              le_mean =     -22.820128763395
             les_mean =     521.254021725148
             stat err =       0.000553031287
             autocorr =       1.283202922969
              std dev =       0.690425828344
             le_variance =       0.476687824444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664658324
                                         uncertainty =       0.002703078994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664658324
                                         uncertainty =       0.002703078994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488204783
  error estimate for blocks of size 2^( 2) =       0.000509104370
  error estimate for blocks of size 2^( 3) =       0.000528650793
  error estimate for blocks of size 2^( 4) =       0.000543359892
  error estimate for blocks of size 2^( 5) =       0.000552945570
  error estimate for blocks of size 2^( 6) =       0.000555856328
  error estimate for blocks of size 2^( 7) =       0.000559963365

      target function =                  N/A
              le_mean =     -22.820128763179
             les_mean =     521.254021714228
             stat err =       0.000553031289
             autocorr =       1.283202939759
              std dev =       0.690425825424
             le_variance =       0.476687820413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664660350
                                         uncertainty =       0.002703077949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664660350
                                         uncertainty =       0.002703077949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488204784
  error estimate for blocks of size 2^( 2) =       0.000509104371
  error estimate for blocks of size 2^( 3) =       0.000528650793
  error estimate for blocks of size 2^( 4) =       0.000543359892
  error estimate for blocks of size 2^( 5) =       0.000552945570
  error estimate for blocks of size 2^( 6) =       0.000555856326
  error estimate for blocks of size 2^( 7) =       0.000559963364

      target function =                  N/A
              le_mean =     -22.820128763287
             les_mean =     521.254021719507
             stat err =       0.000553031288
             autocorr =       1.283202931366
              std dev =       0.690425826884
             le_variance =       0.476687822429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664662123
                                         uncertainty =       0.002703077035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476664662123
                                         uncertainty =       0.002703077035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488204785
  error estimate for blocks of size 2^( 2) =       0.000509104371
  error estimate for blocks of size 2^( 3) =       0.000528650794
  error estimate for blocks of size 2^( 4) =       0.000543359892
  error estimate for blocks of size 2^( 5) =       0.000552945570
  error estimate for blocks of size 2^( 6) =       0.000555856325
  error estimate for blocks of size 2^( 7) =       0.000559963363

      target function =                  N/A
              le_mean =     -22.820128763381
             les_mean =     521.254021724423
             stat err =       0.000553031287
             autocorr =       1.283202924003
              std dev =       0.690425828161
             le_variance =       0.476687824192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820128763395        initial  <--
     1.5625e+04     1.5625e+05             2.7722e-08       -22.820128763179
     6.2500e+04     6.2500e+05             6.9306e-09       -22.820128763287
     2.5000e+05     2.5000e+06             1.7327e-09       -22.820128763381

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.8486
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777726e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388756e-05 3 1  ON 34
ci_36                -8.953241e-04 3 1  ON 35
ci_37                -5.142963e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057154e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.267967e-06 3 1  ON 44
ci_46                -5.407560e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455172e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339307e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754639e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833839e-04 3 1  ON 61
ci_63                -9.086665e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658860e-04 3 1  ON 65
ci_67                -9.729497e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8864
    reference variance = 0.524411
====================================================
  Execution time = 2.5587e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9537e-01
  Total weights = 1.963501694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476351267079
                                         uncertainty =       0.002348398379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476351267079
                                         uncertainty =       0.002348398379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488061686
  error estimate for blocks of size 2^( 2) =       0.000509163839
  error estimate for blocks of size 2^( 3) =       0.000528695808
  error estimate for blocks of size 2^( 4) =       0.000543518797
  error estimate for blocks of size 2^( 5) =       0.000552195575
  error estimate for blocks of size 2^( 6) =       0.000557282950
  error estimate for blocks of size 2^( 7) =       0.000558660364

      target function =                  N/A
              le_mean =     -22.818850242680
             les_mean =     521.195295137247
             stat err =       0.000552914421
             autocorr =       1.283412910757
              std dev =       0.690223455230
             le_variance =       0.476408418150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281885024268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818850242580       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818850242638       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818850242643       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818850242643       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 4.588639e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818850242580       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818850242594       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818850242596       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818850242596       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+05 is 1.147160e-09

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818850242580       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818850242583       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818850242584       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818850242473       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+06 is 2.867900e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0136e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583385e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869909e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534170e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440801e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704295e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630394e-04 3 1  ON 31
ci_33                 7.777706e-05 3 1  ON 32
ci_34                 8.968000e-04 3 1  ON 33
ci_35                -2.388752e-05 3 1  ON 34
ci_36                -8.953240e-04 3 1  ON 35
ci_37                -5.142971e-04 3 1  ON 36
ci_38                -2.635238e-04 3 1  ON 37
ci_39                 4.144574e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404359e-04 3 1  ON 40
ci_42                 4.057157e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690226e-03 3 1  ON 43
ci_45                -1.267980e-06 3 1  ON 44
ci_46                -5.407552e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364258e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900412e-04 3 1  ON 49
ci_51                 6.455170e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339310e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754648e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833839e-04 3 1  ON 61
ci_63                -9.086718e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772638e-04 3 1  ON 64
ci_66                 1.658860e-04 3 1  ON 65
ci_67                -9.729495e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573419e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8194
    reference variance = 0.355338
====================================================
  Execution time = 2.5817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9158e-01
  Total weights = 1.9636e+06
  Execution time = 3.5785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181247261
                                         uncertainty =       0.002204640207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181247261
                                         uncertainty =       0.002204640207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487392029
  error estimate for blocks of size 2^( 2) =       0.000508555217
  error estimate for blocks of size 2^( 3) =       0.000528884449
  error estimate for blocks of size 2^( 4) =       0.000543611654
  error estimate for blocks of size 2^( 5) =       0.000552774252
  error estimate for blocks of size 2^( 6) =       0.000559941643
  error estimate for blocks of size 2^( 7) =       0.000562901497

      target function =                  N/A
              le_mean =     -22.819067870364
             les_mean =     521.201438885015
             stat err =       0.000554807261
             autocorr =       1.295768533374
              std dev =       0.689276417116
             le_variance =       0.475101979192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181246509
                                         uncertainty =       0.002204640191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181246509
                                         uncertainty =       0.002204640191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487392028
  error estimate for blocks of size 2^( 2) =       0.000508555216
  error estimate for blocks of size 2^( 3) =       0.000528884449
  error estimate for blocks of size 2^( 4) =       0.000543611654
  error estimate for blocks of size 2^( 5) =       0.000552774251
  error estimate for blocks of size 2^( 6) =       0.000559941643
  error estimate for blocks of size 2^( 7) =       0.000562901497

      target function =                  N/A
              le_mean =     -22.819067870316
             les_mean =     521.201438967534
             stat err =       0.000554807261
             autocorr =       1.295768534935
              std dev =       0.689276416569
             le_variance =       0.475101978438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181246885
                                         uncertainty =       0.002204640199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181246885
                                         uncertainty =       0.002204640199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487392028
  error estimate for blocks of size 2^( 2) =       0.000508555217
  error estimate for blocks of size 2^( 3) =       0.000528884449
  error estimate for blocks of size 2^( 4) =       0.000543611654
  error estimate for blocks of size 2^( 5) =       0.000552774251
  error estimate for blocks of size 2^( 6) =       0.000559941643
  error estimate for blocks of size 2^( 7) =       0.000562901497

      target function =                  N/A
              le_mean =     -22.819067870340
             les_mean =     521.201438926273
             stat err =       0.000554807261
             autocorr =       1.295768534146
              std dev =       0.689276416843
             le_variance =       0.475101978815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181247214
                                         uncertainty =       0.002204640206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475181247214
                                         uncertainty =       0.002204640206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487392029
  error estimate for blocks of size 2^( 2) =       0.000508555217
  error estimate for blocks of size 2^( 3) =       0.000528884449
  error estimate for blocks of size 2^( 4) =       0.000543611654
  error estimate for blocks of size 2^( 5) =       0.000552774252
  error estimate for blocks of size 2^( 6) =       0.000559941643
  error estimate for blocks of size 2^( 7) =       0.000562901497

      target function =                  N/A
              le_mean =     -22.819067870361
             les_mean =     521.201438890172
             stat err =       0.000554807261
             autocorr =       1.295768533460
              std dev =       0.689276417082
             le_variance =       0.475101979145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819067870364        initial  <--
     1.5625e+05     1.5625e+06             4.5886e-09       -22.819067870316
     6.2500e+05     6.2500e+06             1.1472e-09       -22.819067870340
     2.5000e+06     2.5000e+07             2.8679e-10       -22.819067870361

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6954
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777726e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388756e-05 3 1  ON 34
ci_36                -8.953241e-04 3 1  ON 35
ci_37                -5.142963e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057154e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.267967e-06 3 1  ON 44
ci_46                -5.407560e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455172e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339307e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754639e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833839e-04 3 1  ON 61
ci_63                -9.086665e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658860e-04 3 1  ON 65
ci_67                -9.729497e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3838e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8642
    reference variance = 0.454678
====================================================
  Execution time = 2.5529e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5391e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9170e-01
  Total weights = 1.963999668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476144036454
                                         uncertainty =       0.002598731314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476144036454
                                         uncertainty =       0.002598731314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487920036
  error estimate for blocks of size 2^( 2) =       0.000508696435
  error estimate for blocks of size 2^( 3) =       0.000528349840
  error estimate for blocks of size 2^( 4) =       0.000543335380
  error estimate for blocks of size 2^( 5) =       0.000553904052
  error estimate for blocks of size 2^( 6) =       0.000558381802
  error estimate for blocks of size 2^( 7) =       0.000560983027

      target function =                  N/A
              le_mean =     -22.820315878231
             les_mean =     521.258521368878
             stat err =       0.000554151065
             autocorr =       1.289908905093
              std dev =       0.690023131832
             le_variance =       0.476131922463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282031587823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820315878190       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820315878195       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820315878195       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820315878195       residual = 7.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 3.104624e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820315878190       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820315878192       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820315878192       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820315878192       residual = 7.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+06 is 7.761572e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820315878190       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820315878191       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820315878191       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820315883260       residual = 7.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+07 is 1.940391e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0075e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777726e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388757e-05 3 1  ON 34
ci_36                -8.953241e-04 3 1  ON 35
ci_37                -5.142964e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057154e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.267988e-06 3 1  ON 44
ci_46                -5.407560e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455172e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339307e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754639e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833838e-04 3 1  ON 61
ci_63                -9.086666e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658859e-04 3 1  ON 65
ci_67                -9.729496e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8258
    reference variance = 0.390088
====================================================
  Execution time = 2.5479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9525e-01
  Total weights = 1.9637e+06
  Execution time = 3.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912503
                                         uncertainty =       0.002673655782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912503
                                         uncertainty =       0.002673655782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490134185
  error estimate for blocks of size 2^( 2) =       0.000510642768
  error estimate for blocks of size 2^( 3) =       0.000530106976
  error estimate for blocks of size 2^( 4) =       0.000545636564
  error estimate for blocks of size 2^( 5) =       0.000555437247
  error estimate for blocks of size 2^( 6) =       0.000561771950
  error estimate for blocks of size 2^( 7) =       0.000564741180

      target function =                  N/A
              le_mean =     -22.819218272407
             les_mean =     521.211973874706
             stat err =       0.000556896735
             autocorr =       1.290979530326
              std dev =       0.693154411649
             le_variance =       0.480463038388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912426
                                         uncertainty =       0.002673655759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912426
                                         uncertainty =       0.002673655759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490134185
  error estimate for blocks of size 2^( 2) =       0.000510642768
  error estimate for blocks of size 2^( 3) =       0.000530106976
  error estimate for blocks of size 2^( 4) =       0.000545636564
  error estimate for blocks of size 2^( 5) =       0.000555437247
  error estimate for blocks of size 2^( 6) =       0.000561771950
  error estimate for blocks of size 2^( 7) =       0.000564741180

      target function =                  N/A
              le_mean =     -22.819218272409
             les_mean =     521.211973874813
             stat err =       0.000556896735
             autocorr =       1.290979530454
              std dev =       0.693154411594
             le_variance =       0.480463038312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912464
                                         uncertainty =       0.002673655771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912464
                                         uncertainty =       0.002673655771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490134185
  error estimate for blocks of size 2^( 2) =       0.000510642768
  error estimate for blocks of size 2^( 3) =       0.000530106976
  error estimate for blocks of size 2^( 4) =       0.000545636564
  error estimate for blocks of size 2^( 5) =       0.000555437247
  error estimate for blocks of size 2^( 6) =       0.000561771950
  error estimate for blocks of size 2^( 7) =       0.000564741180

      target function =                  N/A
              le_mean =     -22.819218272408
             les_mean =     521.211973874759
             stat err =       0.000556896735
             autocorr =       1.290979530393
              std dev =       0.693154411621
             le_variance =       0.480463038350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912498
                                         uncertainty =       0.002673655781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480488912498
                                         uncertainty =       0.002673655781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490134185
  error estimate for blocks of size 2^( 2) =       0.000510642768
  error estimate for blocks of size 2^( 3) =       0.000530106976
  error estimate for blocks of size 2^( 4) =       0.000545636564
  error estimate for blocks of size 2^( 5) =       0.000555437247
  error estimate for blocks of size 2^( 6) =       0.000561771950
  error estimate for blocks of size 2^( 7) =       0.000564741180

      target function =                  N/A
              le_mean =     -22.819218272407
             les_mean =     521.211973874712
             stat err =       0.000556896735
             autocorr =       1.290979530332
              std dev =       0.693154411646
             le_variance =       0.480463038384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819218272407        initial
     1.5625e+06     1.5625e+07             3.1046e-10       -22.819218272409  <--
     6.2500e+06     6.2500e+07             7.7616e-11       -22.819218272408
     2.5000e+07     2.5000e+08             1.9404e-11       -22.819218272407

*****************************************************************************
Applying the update for shift_i =   1.5625e+06     and shift_s =   1.5625e+07
*****************************************************************************

  Execution time = 4.3454e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777725e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388760e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142965e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404358e-04 3 1  ON 40
ci_42                 4.057153e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268049e-06 3 1  ON 44
ci_46                -5.407559e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900413e-04 3 1  ON 49
ci_51                 6.455171e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339309e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833838e-04 3 1  ON 61
ci_63                -9.086667e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658858e-04 3 1  ON 65
ci_67                -9.729495e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3536e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7259
    reference variance = 0.399893
====================================================
  Execution time = 2.5568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9663e-01
  Total weights = 1.963677614e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480408686475
                                         uncertainty =       0.003184035605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480408686475
                                         uncertainty =       0.003184035605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490128583
  error estimate for blocks of size 2^( 2) =       0.000510847221
  error estimate for blocks of size 2^( 3) =       0.000530475959
  error estimate for blocks of size 2^( 4) =       0.000546450709
  error estimate for blocks of size 2^( 5) =       0.000557008790
  error estimate for blocks of size 2^( 6) =       0.000562214960
  error estimate for blocks of size 2^( 7) =       0.000566085079

      target function =                  N/A
              le_mean =     -22.819735952898
             les_mean =     521.236975039407
             stat err =       0.000557939885
             autocorr =       1.295850070886
              std dev =       0.693146488902
             le_variance =       0.480452055078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281973595290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819735952798       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819735952821       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819735952822       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819735952822       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 1.175335e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819735952798       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819735952803       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819735952804       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819735952164       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 2.938338e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819735952798       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819735952799       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819735952799       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819735952799       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+06 is 7.345857e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0186e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704289e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630391e-04 3 1  ON 31
ci_33                 7.777720e-05 3 1  ON 32
ci_34                 8.968001e-04 3 1  ON 33
ci_35                -2.388750e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142965e-04 3 1  ON 36
ci_38                -2.635236e-04 3 1  ON 37
ci_39                 4.144572e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404359e-04 3 1  ON 40
ci_42                 4.057155e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268144e-06 3 1  ON 44
ci_46                -5.407557e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364264e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455170e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339309e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833838e-04 3 1  ON 61
ci_63                -9.086664e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658855e-04 3 1  ON 65
ci_67                -9.729496e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8576
    reference variance = 0.485423
====================================================
  Execution time = 2.5040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9551e-01
  Total weights = 1.9638e+06
  Execution time = 3.5888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512760192
                                         uncertainty =       0.002449242459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512760192
                                         uncertainty =       0.002449242459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488620338
  error estimate for blocks of size 2^( 2) =       0.000509526655
  error estimate for blocks of size 2^( 3) =       0.000528722412
  error estimate for blocks of size 2^( 4) =       0.000543623236
  error estimate for blocks of size 2^( 5) =       0.000553131102
  error estimate for blocks of size 2^( 6) =       0.000557093395
  error estimate for blocks of size 2^( 7) =       0.000562080634

      target function =                  N/A
              le_mean =     -22.820946538490
             les_mean =     521.291107676832
             stat err =       0.000553982092
             autocorr =       1.285429822687
              std dev =       0.691013509166
             le_variance =       0.477499669849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512759740
                                         uncertainty =       0.002449242404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512759740
                                         uncertainty =       0.002449242404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488620338
  error estimate for blocks of size 2^( 2) =       0.000509526655
  error estimate for blocks of size 2^( 3) =       0.000528722412
  error estimate for blocks of size 2^( 4) =       0.000543623236
  error estimate for blocks of size 2^( 5) =       0.000553131102
  error estimate for blocks of size 2^( 6) =       0.000557093395
  error estimate for blocks of size 2^( 7) =       0.000562080634

      target function =                  N/A
              le_mean =     -22.820946538488
             les_mean =     521.291107675076
             stat err =       0.000553982092
             autocorr =       1.285429823377
              std dev =       0.691013508839
             le_variance =       0.477499669398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512759966
                                         uncertainty =       0.002449242431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512759966
                                         uncertainty =       0.002449242431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488620338
  error estimate for blocks of size 2^( 2) =       0.000509526655
  error estimate for blocks of size 2^( 3) =       0.000528722412
  error estimate for blocks of size 2^( 4) =       0.000543623236
  error estimate for blocks of size 2^( 5) =       0.000553131102
  error estimate for blocks of size 2^( 6) =       0.000557093395
  error estimate for blocks of size 2^( 7) =       0.000562080634

      target function =                  N/A
              le_mean =     -22.820946538489
             les_mean =     521.291107675954
             stat err =       0.000553982092
             autocorr =       1.285429823039
              std dev =       0.691013509002
             le_variance =       0.477499669624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512760164
                                         uncertainty =       0.002449242456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477512760164
                                         uncertainty =       0.002449242456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488620338
  error estimate for blocks of size 2^( 2) =       0.000509526655
  error estimate for blocks of size 2^( 3) =       0.000528722412
  error estimate for blocks of size 2^( 4) =       0.000543623236
  error estimate for blocks of size 2^( 5) =       0.000553131102
  error estimate for blocks of size 2^( 6) =       0.000557093395
  error estimate for blocks of size 2^( 7) =       0.000562080634

      target function =                  N/A
              le_mean =     -22.820946538490
             les_mean =     521.291107676722
             stat err =       0.000553982092
             autocorr =       1.285429822749
              std dev =       0.691013509145
             le_variance =       0.477499669821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820946538490        initial  <--
     3.9062e+05     3.9062e+06             1.1753e-09       -22.820946538488
     1.5625e+06     1.5625e+07             2.9383e-10       -22.820946538489
     6.2500e+06     6.2500e+07             7.3459e-11       -22.820946538490

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0055
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777725e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388760e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142965e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144573e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404358e-04 3 1  ON 40
ci_42                 4.057153e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268049e-06 3 1  ON 44
ci_46                -5.407559e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900413e-04 3 1  ON 49
ci_51                 6.455171e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339309e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833838e-04 3 1  ON 61
ci_63                -9.086667e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658858e-04 3 1  ON 65
ci_67                -9.729495e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8412
    reference variance = 0.333441
====================================================
  Execution time = 2.7522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.0326e-01
  Total weights = 1.963645868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485009346746
                                         uncertainty =       0.005791353028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485009346746
                                         uncertainty =       0.005791353028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492399178
  error estimate for blocks of size 2^( 2) =       0.000513058458
  error estimate for blocks of size 2^( 3) =       0.000532813819
  error estimate for blocks of size 2^( 4) =       0.000546764177
  error estimate for blocks of size 2^( 5) =       0.000556066271
  error estimate for blocks of size 2^( 6) =       0.000560691241
  error estimate for blocks of size 2^( 7) =       0.000560612868

      target function =                  N/A
              le_mean =     -22.819463866077
             les_mean =     521.231194679959
             stat err =       0.000556033639
             autocorr =       1.275168260739
              std dev =       0.696357595823
             le_variance =       0.484913901261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281946386608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819463866005       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819463866007       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819463866007       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819463865646       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 1.078765e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819463866005       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819463866005       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819463866005       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819463868815       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+07 is 2.696908e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819463866005       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819463866005       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819463866005       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819463866005       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+07 is 6.742286e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2086e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777722e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388759e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142965e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144572e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404358e-04 3 1  ON 40
ci_42                 4.057153e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268076e-06 3 1  ON 44
ci_46                -5.407559e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900413e-04 3 1  ON 49
ci_51                 6.455171e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339309e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833838e-04 3 1  ON 61
ci_63                -9.086665e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658858e-04 3 1  ON 65
ci_67                -9.729495e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8637
    reference variance = 0.361605
====================================================
  Execution time = 2.4961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 5.0560e-01
  Total weights = 1.9636e+06
  Execution time = 3.5786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044634
                                         uncertainty =       0.004342632809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044634
                                         uncertainty =       0.004342632809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491311223
  error estimate for blocks of size 2^( 2) =       0.000512185438
  error estimate for blocks of size 2^( 3) =       0.000532031088
  error estimate for blocks of size 2^( 4) =       0.000547644432
  error estimate for blocks of size 2^( 5) =       0.000556638193
  error estimate for blocks of size 2^( 6) =       0.000562659754
  error estimate for blocks of size 2^( 7) =       0.000564851454

      target function =                  N/A
              le_mean =     -22.820594200814
             les_mean =     521.285124194416
             stat err =       0.000557948458
             autocorr =       1.289658705014
              std dev =       0.694818994914
             le_variance =       0.482773435693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044572
                                         uncertainty =       0.004342632801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044572
                                         uncertainty =       0.004342632801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491311223
  error estimate for blocks of size 2^( 2) =       0.000512185438
  error estimate for blocks of size 2^( 3) =       0.000532031088
  error estimate for blocks of size 2^( 4) =       0.000547644432
  error estimate for blocks of size 2^( 5) =       0.000556638193
  error estimate for blocks of size 2^( 6) =       0.000562659754
  error estimate for blocks of size 2^( 7) =       0.000564851454

      target function =                  N/A
              le_mean =     -22.820594200815
             les_mean =     521.285124194067
             stat err =       0.000557948458
             autocorr =       1.289658705061
              std dev =       0.694818994869
             le_variance =       0.482773435631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044603
                                         uncertainty =       0.004342632805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044603
                                         uncertainty =       0.004342632805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491311223
  error estimate for blocks of size 2^( 2) =       0.000512185438
  error estimate for blocks of size 2^( 3) =       0.000532031088
  error estimate for blocks of size 2^( 4) =       0.000547644432
  error estimate for blocks of size 2^( 5) =       0.000556638193
  error estimate for blocks of size 2^( 6) =       0.000562659754
  error estimate for blocks of size 2^( 7) =       0.000564851454

      target function =                  N/A
              le_mean =     -22.820594200815
             les_mean =     521.285124194241
             stat err =       0.000557948458
             autocorr =       1.289658705035
              std dev =       0.694818994891
             le_variance =       0.482773435661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044630
                                         uncertainty =       0.004342632809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482896044630
                                         uncertainty =       0.004342632809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491311223
  error estimate for blocks of size 2^( 2) =       0.000512185438
  error estimate for blocks of size 2^( 3) =       0.000532031088
  error estimate for blocks of size 2^( 4) =       0.000547644432
  error estimate for blocks of size 2^( 5) =       0.000556638193
  error estimate for blocks of size 2^( 6) =       0.000562659754
  error estimate for blocks of size 2^( 7) =       0.000564851454

      target function =                  N/A
              le_mean =     -22.820594200815
             les_mean =     521.285124194394
             stat err =       0.000557948458
             autocorr =       1.289658705011
              std dev =       0.694818994911
             le_variance =       0.482773435689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820594200814        initial
     3.9062e+06     3.9062e+07             1.0788e-10       -22.820594200815  <--
     1.5625e+07     1.5625e+08             2.6969e-11       -22.820594200815
     6.2500e+07     6.2500e+08             6.7423e-12       -22.820594200815

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 4.2872e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630392e-04 3 1  ON 31
ci_33                 7.777715e-05 3 1  ON 32
ci_34                 8.968001e-04 3 1  ON 33
ci_35                -2.388755e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142965e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144572e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404358e-04 3 1  ON 40
ci_42                 4.057153e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268157e-06 3 1  ON 44
ci_46                -5.407559e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455171e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339310e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.086659e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658858e-04 3 1  ON 65
ci_67                -9.729495e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573421e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8261
    reference variance = 0.374655
====================================================
  Execution time = 2.5428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9469e-01
  Total weights = 1.963493668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478561663150
                                         uncertainty =       0.003634726339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478561663150
                                         uncertainty =       0.003634726339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489097498
  error estimate for blocks of size 2^( 2) =       0.000510162476
  error estimate for blocks of size 2^( 3) =       0.000530117389
  error estimate for blocks of size 2^( 4) =       0.000545861077
  error estimate for blocks of size 2^( 5) =       0.000555915757
  error estimate for blocks of size 2^( 6) =       0.000562355202
  error estimate for blocks of size 2^( 7) =       0.000567489063

      target function =                  N/A
              le_mean =     -22.819254067177
             les_mean =     521.213046522755
             stat err =       0.000557905275
             autocorr =       1.301158047873
              std dev =       0.691688315329
             le_variance =       0.478432725563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281925406718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819254067106       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819254067112       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819254067112       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819254067112       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 4.597502e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819254067106       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819254067107       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819254067107       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819254067107       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 1.149376e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819254067106       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819254067106       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819254067106       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819254067118       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+07 is 2.873440e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0058e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704290e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630391e-04 3 1  ON 31
ci_33                 7.777713e-05 3 1  ON 32
ci_34                 8.968002e-04 3 1  ON 33
ci_35                -2.388748e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142966e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144572e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057154e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268233e-06 3 1  ON 44
ci_46                -5.407559e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455170e-04 3 1  ON 50
ci_52                 2.153056e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339311e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050385e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.086659e-05 3 1  ON 62
ci_64                -6.291661e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658857e-04 3 1  ON 65
ci_67                -9.729494e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573422e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7799
    reference variance = 0.458426
====================================================
  Execution time = 2.4869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9040e-01
  Total weights = 1.9638e+06
  Execution time = 3.5922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980529
                                         uncertainty =       0.002075271828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980529
                                         uncertainty =       0.002075271828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487889341
  error estimate for blocks of size 2^( 2) =       0.000508397881
  error estimate for blocks of size 2^( 3) =       0.000528731496
  error estimate for blocks of size 2^( 4) =       0.000544507601
  error estimate for blocks of size 2^( 5) =       0.000553285305
  error estimate for blocks of size 2^( 6) =       0.000556299928
  error estimate for blocks of size 2^( 7) =       0.000561112955

      target function =                  N/A
              le_mean =     -22.820377000098
             les_mean =     521.260009631578
             stat err =       0.000553801447
             autocorr =       1.288443897811
              std dev =       0.689979722557
             le_variance =       0.476072017540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980459
                                         uncertainty =       0.002075271829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980459
                                         uncertainty =       0.002075271829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487889341
  error estimate for blocks of size 2^( 2) =       0.000508397881
  error estimate for blocks of size 2^( 3) =       0.000528731496
  error estimate for blocks of size 2^( 4) =       0.000544507601
  error estimate for blocks of size 2^( 5) =       0.000553285305
  error estimate for blocks of size 2^( 6) =       0.000556299928
  error estimate for blocks of size 2^( 7) =       0.000561112955

      target function =                  N/A
              le_mean =     -22.820377000100
             les_mean =     521.260009631522
             stat err =       0.000553801447
             autocorr =       1.288443897972
              std dev =       0.689979722507
             le_variance =       0.476072017470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980494
                                         uncertainty =       0.002075271829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980494
                                         uncertainty =       0.002075271829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487889341
  error estimate for blocks of size 2^( 2) =       0.000508397881
  error estimate for blocks of size 2^( 3) =       0.000528731496
  error estimate for blocks of size 2^( 4) =       0.000544507601
  error estimate for blocks of size 2^( 5) =       0.000553285305
  error estimate for blocks of size 2^( 6) =       0.000556299928
  error estimate for blocks of size 2^( 7) =       0.000561112955

      target function =                  N/A
              le_mean =     -22.820377000099
             les_mean =     521.260009631550
             stat err =       0.000553801447
             autocorr =       1.288443897894
              std dev =       0.689979722532
             le_variance =       0.476072017505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980525
                                         uncertainty =       0.002075271828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476105980525
                                         uncertainty =       0.002075271828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487889341
  error estimate for blocks of size 2^( 2) =       0.000508397881
  error estimate for blocks of size 2^( 3) =       0.000528731496
  error estimate for blocks of size 2^( 4) =       0.000544507601
  error estimate for blocks of size 2^( 5) =       0.000553285305
  error estimate for blocks of size 2^( 6) =       0.000556299928
  error estimate for blocks of size 2^( 7) =       0.000561112955

      target function =                  N/A
              le_mean =     -22.820377000099
             les_mean =     521.260009631575
             stat err =       0.000553801447
             autocorr =       1.288443897819
              std dev =       0.689979722554
             le_variance =       0.476072017536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820377000098        initial
     9.7656e+05     9.7656e+06             4.5975e-10       -22.820377000100  <--
     3.9062e+06     3.9062e+07             1.1494e-10       -22.820377000099
     1.5625e+07     1.5625e+08             2.8734e-11       -22.820377000099

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 4.2855e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112262e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704289e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630390e-04 3 1  ON 31
ci_33                 7.777706e-05 3 1  ON 32
ci_34                 8.968004e-04 3 1  ON 33
ci_35                -2.388730e-05 3 1  ON 34
ci_36                -8.953243e-04 3 1  ON 35
ci_37                -5.142966e-04 3 1  ON 36
ci_38                -2.635235e-04 3 1  ON 37
ci_39                 4.144570e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404357e-04 3 1  ON 40
ci_42                 4.057157e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690226e-03 3 1  ON 43
ci_45                -1.268458e-06 3 1  ON 44
ci_46                -5.407558e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364263e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455169e-04 3 1  ON 50
ci_52                 2.153057e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339314e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833837e-04 3 1  ON 61
ci_63                -9.086658e-05 3 1  ON 62
ci_64                -6.291662e-04 3 1  ON 63
ci_65                -4.772644e-04 3 1  ON 64
ci_66                 1.658856e-04 3 1  ON 65
ci_67                -9.729493e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573425e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2919e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7925
    reference variance = 0.341531
====================================================
  Execution time = 2.5556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9259e-01
  Total weights = 1.963649537e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478503274315
                                         uncertainty =       0.002751878252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478503274315
                                         uncertainty =       0.002751878252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489103369
  error estimate for blocks of size 2^( 2) =       0.000509663983
  error estimate for blocks of size 2^( 3) =       0.000529489637
  error estimate for blocks of size 2^( 4) =       0.000544142212
  error estimate for blocks of size 2^( 5) =       0.000553581257
  error estimate for blocks of size 2^( 6) =       0.000560858430
  error estimate for blocks of size 2^( 7) =       0.000562894415

      target function =                  N/A
              le_mean =     -22.819595700881
             les_mean =     521.226533033193
             stat err =       0.000555369078
             autocorr =       1.289324045370
              std dev =       0.691696618180
             le_variance =       0.478444211602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281959570088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819595700817       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819595700827       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819595700827       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819595700827       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 1.754189e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819595700817       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819595700820       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819595700820       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819595700820       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 4.385475e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819595700817       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819595700818       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819595700818       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819595702116       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+06 is 1.096369e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0113e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529732e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259285e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395776e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698845e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704287e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630389e-04 3 1  ON 31
ci_33                 7.777696e-05 3 1  ON 32
ci_34                 8.968000e-04 3 1  ON 33
ci_35                -2.388703e-05 3 1  ON 34
ci_36                -8.953244e-04 3 1  ON 35
ci_37                -5.142967e-04 3 1  ON 36
ci_38                -2.635234e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404356e-04 3 1  ON 40
ci_42                 4.057157e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268588e-06 3 1  ON 44
ci_46                -5.407557e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455169e-04 3 1  ON 50
ci_52                 2.153057e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339314e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833835e-04 3 1  ON 61
ci_63                -9.086692e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772646e-04 3 1  ON 64
ci_66                 1.658854e-04 3 1  ON 65
ci_67                -9.729492e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573424e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8424
    reference variance = 0.533594
====================================================
  Execution time = 2.4837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9508e-01
  Total weights = 1.9639e+06
  Execution time = 3.6024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570864
                                         uncertainty =       0.003038572510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570864
                                         uncertainty =       0.003038572510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489248458
  error estimate for blocks of size 2^( 2) =       0.000510171850
  error estimate for blocks of size 2^( 3) =       0.000530920796
  error estimate for blocks of size 2^( 4) =       0.000546348620
  error estimate for blocks of size 2^( 5) =       0.000554969954
  error estimate for blocks of size 2^( 6) =       0.000560769531
  error estimate for blocks of size 2^( 7) =       0.000564618046

      target function =                  N/A
              le_mean =     -22.819854747613
             les_mean =     521.240847379853
             stat err =       0.000556676538
             autocorr =       1.294633689614
              std dev =       0.691901804414
             le_variance =       0.478728106951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570437
                                         uncertainty =       0.003038572414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570437
                                         uncertainty =       0.003038572414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489248458
  error estimate for blocks of size 2^( 2) =       0.000510171850
  error estimate for blocks of size 2^( 3) =       0.000530920796
  error estimate for blocks of size 2^( 4) =       0.000546348620
  error estimate for blocks of size 2^( 5) =       0.000554969954
  error estimate for blocks of size 2^( 6) =       0.000560769531
  error estimate for blocks of size 2^( 7) =       0.000564618046

      target function =                  N/A
              le_mean =     -22.819854747648
             les_mean =     521.240847379514
             stat err =       0.000556676538
             autocorr =       1.294633690067
              std dev =       0.691901804103
             le_variance =       0.478728106521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570650
                                         uncertainty =       0.003038572462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570650
                                         uncertainty =       0.003038572462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489248458
  error estimate for blocks of size 2^( 2) =       0.000510171850
  error estimate for blocks of size 2^( 3) =       0.000530920796
  error estimate for blocks of size 2^( 4) =       0.000546348620
  error estimate for blocks of size 2^( 5) =       0.000554969954
  error estimate for blocks of size 2^( 6) =       0.000560769531
  error estimate for blocks of size 2^( 7) =       0.000564618046

      target function =                  N/A
              le_mean =     -22.819854747631
             les_mean =     521.240847379684
             stat err =       0.000556676538
             autocorr =       1.294633689835
              std dev =       0.691901804259
             le_variance =       0.478728106736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570837
                                         uncertainty =       0.003038572504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478831570837
                                         uncertainty =       0.003038572504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489248458
  error estimate for blocks of size 2^( 2) =       0.000510171850
  error estimate for blocks of size 2^( 3) =       0.000530920796
  error estimate for blocks of size 2^( 4) =       0.000546348620
  error estimate for blocks of size 2^( 5) =       0.000554969954
  error estimate for blocks of size 2^( 6) =       0.000560769531
  error estimate for blocks of size 2^( 7) =       0.000564618046

      target function =                  N/A
              le_mean =     -22.819854747615
             les_mean =     521.240847379832
             stat err =       0.000556676538
             autocorr =       1.294633689641
              std dev =       0.691901804395
             le_variance =       0.478728106925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819854747613        initial
     2.4414e+05     2.4414e+06             1.7542e-09       -22.819854747648  <--
     9.7656e+05     9.7656e+06             4.3855e-10       -22.819854747631
     3.9062e+06     3.9062e+07             1.0964e-10       -22.819854747615

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 4.2845e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704283e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630386e-04 3 1  ON 31
ci_33                 7.777665e-05 3 1  ON 32
ci_34                 8.967987e-04 3 1  ON 33
ci_35                -2.388622e-05 3 1  ON 34
ci_36                -8.953246e-04 3 1  ON 35
ci_37                -5.142968e-04 3 1  ON 36
ci_38                -2.635234e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404351e-04 3 1  ON 40
ci_42                 4.057157e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268976e-06 3 1  ON 44
ci_46                -5.407554e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900415e-04 3 1  ON 49
ci_51                 6.455168e-04 3 1  ON 50
ci_52                 2.153055e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339314e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754641e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833832e-04 3 1  ON 61
ci_63                -9.086792e-05 3 1  ON 62
ci_64                -6.291664e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658848e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2965e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8391
    reference variance = 0.46427
====================================================
  Execution time = 2.5471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9578e-01
  Total weights = 1.963820820e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480901607693
                                         uncertainty =       0.003249397488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480901607693
                                         uncertainty =       0.003249397488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490331207
  error estimate for blocks of size 2^( 2) =       0.000511184646
  error estimate for blocks of size 2^( 3) =       0.000530362338
  error estimate for blocks of size 2^( 4) =       0.000544721057
  error estimate for blocks of size 2^( 5) =       0.000553502107
  error estimate for blocks of size 2^( 6) =       0.000558640563
  error estimate for blocks of size 2^( 7) =       0.000560523543

      target function =                  N/A
              le_mean =     -22.819623448255
             les_mean =     521.230995789540
             stat err =       0.000554346817
             autocorr =       1.278156541296
              std dev =       0.693433043418
             le_variance =       0.480849385704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281962344826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819623448197       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819623448232       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819623448228       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819623448227       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 9.140123e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819623448197       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819623448206       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819623448205       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819623448205       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 2.285038e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819623448197       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819623448199       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819623448199       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819623448199       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 5.712599e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0076e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583383e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594193e-03 3 1  ON 16
ci_18                -9.869907e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534170e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704282e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630389e-04 3 1  ON 31
ci_33                 7.777436e-05 3 1  ON 32
ci_34                 8.967978e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953245e-04 3 1  ON 35
ci_37                -5.142970e-04 3 1  ON 36
ci_38                -2.635237e-04 3 1  ON 37
ci_39                 4.144569e-04 3 1  ON 38
ci_40                -1.372560e-03 3 1  ON 39
ci_41                 5.404359e-04 3 1  ON 40
ci_42                 4.057151e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690226e-03 3 1  ON 43
ci_45                -1.269668e-06 3 1  ON 44
ci_46                -5.407547e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364265e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455150e-04 3 1  ON 50
ci_52                 2.153051e-04 3 1  ON 51
ci_53                -1.120548e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128949e-03 3 1  ON 55
ci_57                 7.339317e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754643e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833839e-04 3 1  ON 61
ci_63                -9.086816e-05 3 1  ON 62
ci_64                -6.291674e-04 3 1  ON 63
ci_65                -4.772658e-04 3 1  ON 64
ci_66                 1.658837e-04 3 1  ON 65
ci_67                -9.729475e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573416e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8212
    reference variance = 0.42632
====================================================
  Execution time = 2.4786e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9341e-01
  Total weights = 1.9637e+06
  Execution time = 3.5950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161271970
                                         uncertainty =       0.002283891591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161271970
                                         uncertainty =       0.002283891591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487966561
  error estimate for blocks of size 2^( 2) =       0.000508886899
  error estimate for blocks of size 2^( 3) =       0.000528882824
  error estimate for blocks of size 2^( 4) =       0.000544555382
  error estimate for blocks of size 2^( 5) =       0.000554109261
  error estimate for blocks of size 2^( 6) =       0.000561447943
  error estimate for blocks of size 2^( 7) =       0.000566388888

      target function =                  N/A
              le_mean =     -22.819529726242
             les_mean =     521.224351150836
             stat err =       0.000556625369
             autocorr =       1.301205431571
              std dev =       0.690088928544
             le_variance =       0.476222729300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161272146
                                         uncertainty =       0.002283891592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161272146
                                         uncertainty =       0.002283891592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487966561
  error estimate for blocks of size 2^( 2) =       0.000508886899
  error estimate for blocks of size 2^( 3) =       0.000528882824
  error estimate for blocks of size 2^( 4) =       0.000544555383
  error estimate for blocks of size 2^( 5) =       0.000554109262
  error estimate for blocks of size 2^( 6) =       0.000561447944
  error estimate for blocks of size 2^( 7) =       0.000566388888

      target function =                  N/A
              le_mean =     -22.819529726203
             les_mean =     521.224351140795
             stat err =       0.000556625369
             autocorr =       1.301205433479
              std dev =       0.690088928667
             le_variance =       0.476222729469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161272058
                                         uncertainty =       0.002283891592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161272058
                                         uncertainty =       0.002283891592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487966561
  error estimate for blocks of size 2^( 2) =       0.000508886899
  error estimate for blocks of size 2^( 3) =       0.000528882824
  error estimate for blocks of size 2^( 4) =       0.000544555383
  error estimate for blocks of size 2^( 5) =       0.000554109261
  error estimate for blocks of size 2^( 6) =       0.000561447943
  error estimate for blocks of size 2^( 7) =       0.000566388888

      target function =                  N/A
              le_mean =     -22.819529726222
             les_mean =     521.224351145814
             stat err =       0.000556625369
             autocorr =       1.301205432523
              std dev =       0.690088928606
             le_variance =       0.476222729384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161271981
                                         uncertainty =       0.002283891591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476161271981
                                         uncertainty =       0.002283891591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487966561
  error estimate for blocks of size 2^( 2) =       0.000508886899
  error estimate for blocks of size 2^( 3) =       0.000528882824
  error estimate for blocks of size 2^( 4) =       0.000544555382
  error estimate for blocks of size 2^( 5) =       0.000554109261
  error estimate for blocks of size 2^( 6) =       0.000561447943
  error estimate for blocks of size 2^( 7) =       0.000566388888

      target function =                  N/A
              le_mean =     -22.819529726239
             les_mean =     521.224351150208
             stat err =       0.000556625369
             autocorr =       1.301205431687
              std dev =       0.690088928552
             le_variance =       0.476222729310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819529726242        initial  <--
     6.1035e+04     6.1035e+05             9.1401e-09       -22.819529726203
     2.4414e+05     2.4414e+06             2.2850e-09       -22.819529726222
     9.7656e+05     9.7656e+06             5.7126e-10       -22.819529726239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7876
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704283e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630386e-04 3 1  ON 31
ci_33                 7.777665e-05 3 1  ON 32
ci_34                 8.967987e-04 3 1  ON 33
ci_35                -2.388622e-05 3 1  ON 34
ci_36                -8.953246e-04 3 1  ON 35
ci_37                -5.142968e-04 3 1  ON 36
ci_38                -2.635234e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404351e-04 3 1  ON 40
ci_42                 4.057157e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.268976e-06 3 1  ON 44
ci_46                -5.407554e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900415e-04 3 1  ON 49
ci_51                 6.455168e-04 3 1  ON 50
ci_52                 2.153055e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339314e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754641e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833832e-04 3 1  ON 61
ci_63                -9.086792e-05 3 1  ON 62
ci_64                -6.291664e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658848e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573420e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8816
    reference variance = 0.541503
====================================================
  Execution time = 2.5518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9201e-01
  Total weights = 1.963417227e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477353574794
                                         uncertainty =       0.002245867424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477353574794
                                         uncertainty =       0.002245867424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488511211
  error estimate for blocks of size 2^( 2) =       0.000509393364
  error estimate for blocks of size 2^( 3) =       0.000529234384
  error estimate for blocks of size 2^( 4) =       0.000544340483
  error estimate for blocks of size 2^( 5) =       0.000554726037
  error estimate for blocks of size 2^( 6) =       0.000559699529
  error estimate for blocks of size 2^( 7) =       0.000562743673

      target function =                  N/A
              le_mean =     -22.818819961625
             les_mean =     521.190549597878
             stat err =       0.000555377430
             autocorr =       1.292490570670
              std dev =       0.690859180162
             le_variance =       0.477286406814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281881996163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818819961537       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818819961554       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818819961554       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818819961761       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 1.169384e-09

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818819961537       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818819961541       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818819961541       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818819962498       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 2.923461e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818819961537       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818819961538       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818819961538       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818819961538       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+06 is 7.308673e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0609e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704283e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630385e-04 3 1  ON 31
ci_33                 7.777671e-05 3 1  ON 32
ci_34                 8.967986e-04 3 1  ON 33
ci_35                -2.388620e-05 3 1  ON 34
ci_36                -8.953246e-04 3 1  ON 35
ci_37                -5.142969e-04 3 1  ON 36
ci_38                -2.635233e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404352e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690225e-03 3 1  ON 43
ci_45                -1.269079e-06 3 1  ON 44
ci_46                -5.407554e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900415e-04 3 1  ON 49
ci_51                 6.455167e-04 3 1  ON 50
ci_52                 2.153054e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128948e-03 3 1  ON 55
ci_57                 7.339317e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754641e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833831e-04 3 1  ON 61
ci_63                -9.086802e-05 3 1  ON 62
ci_64                -6.291664e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658847e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573421e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8638
    reference variance = 0.244635
====================================================
  Execution time = 2.4954e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9121e-01
  Total weights = 1.9637e+06
  Execution time = 3.5968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313324
                                         uncertainty =       0.002252612951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313324
                                         uncertainty =       0.002252612951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487852319
  error estimate for blocks of size 2^( 2) =       0.000508369261
  error estimate for blocks of size 2^( 3) =       0.000527450799
  error estimate for blocks of size 2^( 4) =       0.000542869109
  error estimate for blocks of size 2^( 5) =       0.000552162612
  error estimate for blocks of size 2^( 6) =       0.000557217721
  error estimate for blocks of size 2^( 7) =       0.000558585312

      target function =                  N/A
              le_mean =     -22.820782062485
             les_mean =     521.279302487544
             stat err =       0.000552708689
             autocorr =       1.283558998832
              std dev =       0.689927366203
             le_variance =       0.475999770635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313319
                                         uncertainty =       0.002252612958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313319
                                         uncertainty =       0.002252612958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487852319
  error estimate for blocks of size 2^( 2) =       0.000508369261
  error estimate for blocks of size 2^( 3) =       0.000527450799
  error estimate for blocks of size 2^( 4) =       0.000542869109
  error estimate for blocks of size 2^( 5) =       0.000552162612
  error estimate for blocks of size 2^( 6) =       0.000557217721
  error estimate for blocks of size 2^( 7) =       0.000558585312

      target function =                  N/A
              le_mean =     -22.820782062488
             les_mean =     521.279302488836
             stat err =       0.000552708689
             autocorr =       1.283558999052
              std dev =       0.689927366200
             le_variance =       0.475999770631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313322
                                         uncertainty =       0.002252612955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313322
                                         uncertainty =       0.002252612955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487852319
  error estimate for blocks of size 2^( 2) =       0.000508369261
  error estimate for blocks of size 2^( 3) =       0.000527450799
  error estimate for blocks of size 2^( 4) =       0.000542869109
  error estimate for blocks of size 2^( 5) =       0.000552162612
  error estimate for blocks of size 2^( 6) =       0.000557217721
  error estimate for blocks of size 2^( 7) =       0.000558585312

      target function =                  N/A
              le_mean =     -22.820782062487
             les_mean =     521.279302488190
             stat err =       0.000552708689
             autocorr =       1.283558998942
              std dev =       0.689927366201
             le_variance =       0.475999770633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313324
                                         uncertainty =       0.002252612951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476054313324
                                         uncertainty =       0.002252612951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487852319
  error estimate for blocks of size 2^( 2) =       0.000508369261
  error estimate for blocks of size 2^( 3) =       0.000527450799
  error estimate for blocks of size 2^( 4) =       0.000542869109
  error estimate for blocks of size 2^( 5) =       0.000552162612
  error estimate for blocks of size 2^( 6) =       0.000557217721
  error estimate for blocks of size 2^( 7) =       0.000558585312

      target function =                  N/A
              le_mean =     -22.820782062485
             les_mean =     521.279302487624
             stat err =       0.000552708689
             autocorr =       1.283558998845
              std dev =       0.689927366202
             le_variance =       0.475999770635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820782062485        initial
     6.1035e+05     6.1035e+06             1.1694e-09       -22.820782062488  <--
     2.4414e+06     2.4414e+07             2.9235e-10       -22.820782062487
     9.7656e+06     9.7656e+07             7.3087e-11       -22.820782062485

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 4.2946e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704281e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630383e-04 3 1  ON 31
ci_33                 7.777688e-05 3 1  ON 32
ci_34                 8.967984e-04 3 1  ON 33
ci_35                -2.388612e-05 3 1  ON 34
ci_36                -8.953245e-04 3 1  ON 35
ci_37                -5.142969e-04 3 1  ON 36
ci_38                -2.635232e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404354e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269387e-06 3 1  ON 44
ci_46                -5.407552e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455163e-04 3 1  ON 50
ci_52                 2.153052e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339326e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754642e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833827e-04 3 1  ON 61
ci_63                -9.086831e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772651e-04 3 1  ON 64
ci_66                 1.658843e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573422e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3561e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.826
    reference variance = 0.268779
====================================================
  Execution time = 2.5515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9514e-01
  Total weights = 1.963417410e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481038661403
                                         uncertainty =       0.002488650762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481038661403
                                         uncertainty =       0.002488650762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490539597
  error estimate for blocks of size 2^( 2) =       0.000510696518
  error estimate for blocks of size 2^( 3) =       0.000530048257
  error estimate for blocks of size 2^( 4) =       0.000545510006
  error estimate for blocks of size 2^( 5) =       0.000554382643
  error estimate for blocks of size 2^( 6) =       0.000558807859
  error estimate for blocks of size 2^( 7) =       0.000559799525

      target function =                  N/A
              le_mean =     -22.820849657782
             les_mean =     521.286315783244
             stat err =       0.000554625009
             autocorr =       1.278352886060
              std dev =       0.693727751478
             le_variance =       0.481258193171


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282084965778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820849657732       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820849657807       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820849657809       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820849657808       residual = 8.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 3.445355e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820849657732       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820849657751       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820849657751       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820849657751       residual = 8.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 8.613397e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820849657732       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820849657736       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820849657736       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820849657736       residual = 8.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 2.153351e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0176e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869907e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558228e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534170e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704279e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630382e-04 3 1  ON 31
ci_33                 7.777658e-05 3 1  ON 32
ci_34                 8.967984e-04 3 1  ON 33
ci_35                -2.388596e-05 3 1  ON 34
ci_36                -8.953245e-04 3 1  ON 35
ci_37                -5.142966e-04 3 1  ON 36
ci_38                -2.635236e-04 3 1  ON 37
ci_39                 4.144567e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404351e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269345e-06 3 1  ON 44
ci_46                -5.407553e-04 3 1  ON 45
ci_47                -1.411609e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900412e-04 3 1  ON 49
ci_51                 6.455160e-04 3 1  ON 50
ci_52                 2.153051e-04 3 1  ON 51
ci_53                -1.120548e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339329e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754644e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833827e-04 3 1  ON 61
ci_63                -9.086833e-05 3 1  ON 62
ci_64                -6.291665e-04 3 1  ON 63
ci_65                -4.772649e-04 3 1  ON 64
ci_66                 1.658844e-04 3 1  ON 65
ci_67                -9.729485e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573421e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8167
    reference variance = 0.581372
====================================================
  Execution time = 2.4960e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9698e-01
  Total weights = 1.9637e+06
  Execution time = 3.5886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061798594
                                         uncertainty =       0.002665024709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061798594
                                         uncertainty =       0.002665024709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489910094
  error estimate for blocks of size 2^( 2) =       0.000510419718
  error estimate for blocks of size 2^( 3) =       0.000530063066
  error estimate for blocks of size 2^( 4) =       0.000545455987
  error estimate for blocks of size 2^( 5) =       0.000555320679
  error estimate for blocks of size 2^( 6) =       0.000561190476
  error estimate for blocks of size 2^( 7) =       0.000564586970

      target function =                  N/A
              le_mean =     -22.820106874609
             les_mean =     521.254256331987
             stat err =       0.000556638528
             autocorr =       1.290962866579
              std dev =       0.692837499679
             le_variance =       0.480023800961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061797808
                                         uncertainty =       0.002665024739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061797808
                                         uncertainty =       0.002665024739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489910094
  error estimate for blocks of size 2^( 2) =       0.000510419718
  error estimate for blocks of size 2^( 3) =       0.000530063066
  error estimate for blocks of size 2^( 4) =       0.000545455987
  error estimate for blocks of size 2^( 5) =       0.000555320679
  error estimate for blocks of size 2^( 6) =       0.000561190476
  error estimate for blocks of size 2^( 7) =       0.000564586970

      target function =                  N/A
              le_mean =     -22.820106874594
             les_mean =     521.254256328369
             stat err =       0.000556638528
             autocorr =       1.290962867524
              std dev =       0.692837499116
             le_variance =       0.480023800181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061798201
                                         uncertainty =       0.002665024724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061798201
                                         uncertainty =       0.002665024724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489910094
  error estimate for blocks of size 2^( 2) =       0.000510419718
  error estimate for blocks of size 2^( 3) =       0.000530063066
  error estimate for blocks of size 2^( 4) =       0.000545455987
  error estimate for blocks of size 2^( 5) =       0.000555320679
  error estimate for blocks of size 2^( 6) =       0.000561190476
  error estimate for blocks of size 2^( 7) =       0.000564586970

      target function =                  N/A
              le_mean =     -22.820106874601
             les_mean =     521.254256330178
             stat err =       0.000556638528
             autocorr =       1.290962867051
              std dev =       0.692837499397
             le_variance =       0.480023800571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061798545
                                         uncertainty =       0.002665024711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480061798545
                                         uncertainty =       0.002665024711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489910094
  error estimate for blocks of size 2^( 2) =       0.000510419718
  error estimate for blocks of size 2^( 3) =       0.000530063066
  error estimate for blocks of size 2^( 4) =       0.000545455987
  error estimate for blocks of size 2^( 5) =       0.000555320679
  error estimate for blocks of size 2^( 6) =       0.000561190476
  error estimate for blocks of size 2^( 7) =       0.000564586970

      target function =                  N/A
              le_mean =     -22.820106874608
             les_mean =     521.254256331760
             stat err =       0.000556638528
             autocorr =       1.290962866631
              std dev =       0.692837499643
             le_variance =       0.480023800912


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820106874609        initial  <--
     1.5259e+05     1.5259e+06             3.4454e-09       -22.820106874594
     6.1035e+05     6.1035e+06             8.6134e-10       -22.820106874601
     2.4414e+06     2.4414e+07             2.1534e-10       -22.820106874608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9353
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704281e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630383e-04 3 1  ON 31
ci_33                 7.777688e-05 3 1  ON 32
ci_34                 8.967984e-04 3 1  ON 33
ci_35                -2.388612e-05 3 1  ON 34
ci_36                -8.953245e-04 3 1  ON 35
ci_37                -5.142969e-04 3 1  ON 36
ci_38                -2.635232e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404354e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269387e-06 3 1  ON 44
ci_46                -5.407552e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455163e-04 3 1  ON 50
ci_52                 2.153052e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339326e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754642e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833827e-04 3 1  ON 61
ci_63                -9.086831e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772651e-04 3 1  ON 64
ci_66                 1.658843e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573422e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7588
    reference variance = 0.430006
====================================================
  Execution time = 2.5561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9359e-01
  Total weights = 1.963210396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477427466422
                                         uncertainty =       0.002461493531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477427466422
                                         uncertainty =       0.002461493531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488572990
  error estimate for blocks of size 2^( 2) =       0.000509064060
  error estimate for blocks of size 2^( 3) =       0.000529105585
  error estimate for blocks of size 2^( 4) =       0.000543524866
  error estimate for blocks of size 2^( 5) =       0.000551944766
  error estimate for blocks of size 2^( 6) =       0.000556247823
  error estimate for blocks of size 2^( 7) =       0.000560675157

      target function =                  N/A
              le_mean =     -22.820410788143
             les_mean =     521.264741733472
             stat err =       0.000553098153
             autocorr =       1.281579369909
              std dev =       0.690946549123
             le_variance =       0.477407133745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282041078814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820410788098       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820410788103       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820410788103       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820410788103       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 2.843213e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820410788098       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820410788099       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820410788100       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820410788100       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 7.108033e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820410788098       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820410788099       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820410788099       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820410788529       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+07 is 1.777008e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0107e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704281e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630383e-04 3 1  ON 31
ci_33                 7.777684e-05 3 1  ON 32
ci_34                 8.967984e-04 3 1  ON 33
ci_35                -2.388610e-05 3 1  ON 34
ci_36                -8.953245e-04 3 1  ON 35
ci_37                -5.142969e-04 3 1  ON 36
ci_38                -2.635232e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404354e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269349e-06 3 1  ON 44
ci_46                -5.407552e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455163e-04 3 1  ON 50
ci_52                 2.153051e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339327e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754641e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833827e-04 3 1  ON 61
ci_63                -9.086830e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658842e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573422e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8468
    reference variance = 0.425228
====================================================
  Execution time = 2.4906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8978e-01
  Total weights = 1.9638e+06
  Execution time = 3.5726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506707
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506707
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487639015
  error estimate for blocks of size 2^( 2) =       0.000508769573
  error estimate for blocks of size 2^( 3) =       0.000528225553
  error estimate for blocks of size 2^( 4) =       0.000542102069
  error estimate for blocks of size 2^( 5) =       0.000550282431
  error estimate for blocks of size 2^( 6) =       0.000556670516
  error estimate for blocks of size 2^( 7) =       0.000558160144

      target function =                  N/A
              le_mean =     -22.819274646266
             les_mean =     521.209071810898
             stat err =       0.000551803790
             autocorr =       1.280479020931
              std dev =       0.689625708371
             le_variance =       0.475583617646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506693
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506693
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487639015
  error estimate for blocks of size 2^( 2) =       0.000508769573
  error estimate for blocks of size 2^( 3) =       0.000528225553
  error estimate for blocks of size 2^( 4) =       0.000542102069
  error estimate for blocks of size 2^( 5) =       0.000550282431
  error estimate for blocks of size 2^( 6) =       0.000556670516
  error estimate for blocks of size 2^( 7) =       0.000558160144

      target function =                  N/A
              le_mean =     -22.819274646269
             les_mean =     521.209071811194
             stat err =       0.000551803790
             autocorr =       1.280479021000
              std dev =       0.689625708359
             le_variance =       0.475583617630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506700
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506700
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487639015
  error estimate for blocks of size 2^( 2) =       0.000508769573
  error estimate for blocks of size 2^( 3) =       0.000528225553
  error estimate for blocks of size 2^( 4) =       0.000542102069
  error estimate for blocks of size 2^( 5) =       0.000550282431
  error estimate for blocks of size 2^( 6) =       0.000556670516
  error estimate for blocks of size 2^( 7) =       0.000558160144

      target function =                  N/A
              le_mean =     -22.819274646268
             les_mean =     521.209071811046
             stat err =       0.000551803790
             autocorr =       1.280479020967
              std dev =       0.689625708365
             le_variance =       0.475583617638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506706
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475133506706
                                         uncertainty =       0.002204191154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487639015
  error estimate for blocks of size 2^( 2) =       0.000508769573
  error estimate for blocks of size 2^( 3) =       0.000528225553
  error estimate for blocks of size 2^( 4) =       0.000542102069
  error estimate for blocks of size 2^( 5) =       0.000550282431
  error estimate for blocks of size 2^( 6) =       0.000556670516
  error estimate for blocks of size 2^( 7) =       0.000558160144

      target function =                  N/A
              le_mean =     -22.819274646267
             les_mean =     521.209071810916
             stat err =       0.000551803790
             autocorr =       1.280479020934
              std dev =       0.689625708370
             le_variance =       0.475583617645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819274646266        initial
     1.5259e+06     1.5259e+07             2.8432e-10       -22.819274646269  <--
     6.1035e+06     6.1035e+07             7.1080e-11       -22.819274646268
     2.4414e+07     2.4414e+08             1.7770e-11       -22.819274646267

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 4.2791e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534169e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440800e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704280e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630383e-04 3 1  ON 31
ci_33                 7.777671e-05 3 1  ON 32
ci_34                 8.967984e-04 3 1  ON 33
ci_35                -2.388601e-05 3 1  ON 34
ci_36                -8.953246e-04 3 1  ON 35
ci_37                -5.142968e-04 3 1  ON 36
ci_38                -2.635231e-04 3 1  ON 37
ci_39                 4.144571e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404355e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269236e-06 3 1  ON 44
ci_46                -5.407551e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900414e-04 3 1  ON 49
ci_51                 6.455162e-04 3 1  ON 50
ci_52                 2.153050e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339328e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754641e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833825e-04 3 1  ON 61
ci_63                -9.086828e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658840e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573422e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.9192
    reference variance = 0.636253
====================================================
  Execution time = 2.5514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9600e-01
  Total weights = 1.963680103e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479575388053
                                         uncertainty =       0.003073580358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479575388053
                                         uncertainty =       0.003073580358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489628931
  error estimate for blocks of size 2^( 2) =       0.000510085109
  error estimate for blocks of size 2^( 3) =       0.000530008803
  error estimate for blocks of size 2^( 4) =       0.000545838229
  error estimate for blocks of size 2^( 5) =       0.000554954073
  error estimate for blocks of size 2^( 6) =       0.000559042363
  error estimate for blocks of size 2^( 7) =       0.000562952261

      target function =                  N/A
              le_mean =     -22.820061309108
             les_mean =     521.251199774717
             stat err =       0.000555696731
             autocorr =       1.288076161851
              std dev =       0.692439874069
             le_variance =       0.479472979201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282006130911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820061309034       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820061309049       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820061309049       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820061309049       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 1.270596e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820061309034       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820061309038       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820061309038       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820061309038       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 3.176492e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820061309034       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820061309035       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820061309035       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820061306685       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 7.941232e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0065e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259284e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869908e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558227e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665918e-03 3 1  ON 22
ci_24                 6.534170e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704279e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630384e-04 3 1  ON 31
ci_33                 7.777678e-05 3 1  ON 32
ci_34                 8.967985e-04 3 1  ON 33
ci_35                -2.388609e-05 3 1  ON 34
ci_36                -8.953247e-04 3 1  ON 35
ci_37                -5.142968e-04 3 1  ON 36
ci_38                -2.635233e-04 3 1  ON 37
ci_39                 4.144569e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404356e-04 3 1  ON 40
ci_42                 4.057162e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269224e-06 3 1  ON 44
ci_46                -5.407552e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900415e-04 3 1  ON 49
ci_51                 6.455161e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339331e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833823e-04 3 1  ON 61
ci_63                -9.086832e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772651e-04 3 1  ON 64
ci_66                 1.658840e-04 3 1  ON 65
ci_67                -9.729489e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573424e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6845
    reference variance = 0.44245
====================================================
  Execution time = 2.5197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9760e-01
  Total weights = 1.9639e+06
  Execution time = 3.5743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485554
                                         uncertainty =       0.002740449086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485554
                                         uncertainty =       0.002740449086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490500916
  error estimate for blocks of size 2^( 2) =       0.000511565288
  error estimate for blocks of size 2^( 3) =       0.000531615263
  error estimate for blocks of size 2^( 4) =       0.000547043917
  error estimate for blocks of size 2^( 5) =       0.000556083850
  error estimate for blocks of size 2^( 6) =       0.000562249025
  error estimate for blocks of size 2^( 7) =       0.000565177908

      target function =                  N/A
              le_mean =     -22.819869415950
             les_mean =     521.244042571531
             stat err =       0.000557638675
             autocorr =       1.292486833453
              std dev =       0.693673047662
             le_variance =       0.481182297053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485524
                                         uncertainty =       0.002740449094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485524
                                         uncertainty =       0.002740449094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490500916
  error estimate for blocks of size 2^( 2) =       0.000511565288
  error estimate for blocks of size 2^( 3) =       0.000531615263
  error estimate for blocks of size 2^( 4) =       0.000547043917
  error estimate for blocks of size 2^( 5) =       0.000556083850
  error estimate for blocks of size 2^( 6) =       0.000562249025
  error estimate for blocks of size 2^( 7) =       0.000565177908

      target function =                  N/A
              le_mean =     -22.819869415953
             les_mean =     521.244042570329
             stat err =       0.000557638675
             autocorr =       1.292486833980
              std dev =       0.693673047641
             le_variance =       0.481182297023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485539
                                         uncertainty =       0.002740449090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485539
                                         uncertainty =       0.002740449090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490500916
  error estimate for blocks of size 2^( 2) =       0.000511565288
  error estimate for blocks of size 2^( 3) =       0.000531615263
  error estimate for blocks of size 2^( 4) =       0.000547043917
  error estimate for blocks of size 2^( 5) =       0.000556083850
  error estimate for blocks of size 2^( 6) =       0.000562249025
  error estimate for blocks of size 2^( 7) =       0.000565177908

      target function =                  N/A
              le_mean =     -22.819869415951
             les_mean =     521.244042570930
             stat err =       0.000557638675
             autocorr =       1.292486833720
              std dev =       0.693673047651
             le_variance =       0.481182297038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485552
                                         uncertainty =       0.002740449086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481182485552
                                         uncertainty =       0.002740449086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490500916
  error estimate for blocks of size 2^( 2) =       0.000511565288
  error estimate for blocks of size 2^( 3) =       0.000531615263
  error estimate for blocks of size 2^( 4) =       0.000547043917
  error estimate for blocks of size 2^( 5) =       0.000556083850
  error estimate for blocks of size 2^( 6) =       0.000562249025
  error estimate for blocks of size 2^( 7) =       0.000565177908

      target function =                  N/A
              le_mean =     -22.819869415950
             les_mean =     521.244042571456
             stat err =       0.000557638675
             autocorr =       1.292486833482
              std dev =       0.693673047661
             le_variance =       0.481182297051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819869415950        initial
     3.8147e+05     3.8147e+06             1.2706e-09       -22.819869415953  <--
     1.5259e+06     1.5259e+07             3.1765e-10       -22.819869415951
     6.1035e+06     6.1035e+07             7.9412e-11       -22.819869415950

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 4.3078e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583384e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869907e-03 3 1  ON 17
ci_19                 9.395777e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558228e-03 3 1  ON 20
ci_22                 7.806958e-03 3 1  ON 21
ci_23                 6.665917e-03 3 1  ON 22
ci_24                 6.534170e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630387e-04 3 1  ON 31
ci_33                 7.777701e-05 3 1  ON 32
ci_34                 8.967985e-04 3 1  ON 33
ci_35                -2.388633e-05 3 1  ON 34
ci_36                -8.953247e-04 3 1  ON 35
ci_37                -5.142970e-04 3 1  ON 36
ci_38                -2.635236e-04 3 1  ON 37
ci_39                 4.144563e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404360e-04 3 1  ON 40
ci_42                 4.057165e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690224e-03 3 1  ON 43
ci_45                -1.269190e-06 3 1  ON 44
ci_46                -5.407555e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455159e-04 3 1  ON 50
ci_52                 2.153043e-04 3 1  ON 51
ci_53                -1.120549e-03 3 1  ON 52
ci_54                -1.409371e-03 3 1  ON 53
ci_55                -1.055675e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339338e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050384e-03 3 1  ON 58
ci_60                 4.754640e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833818e-04 3 1  ON 61
ci_63                -9.086843e-05 3 1  ON 62
ci_64                -6.291663e-04 3 1  ON 63
ci_65                -4.772653e-04 3 1  ON 64
ci_66                 1.658838e-04 3 1  ON 65
ci_67                -9.729488e-04 3 1  ON 66
ci_68                -1.357795e-03 3 1  ON 67
ci_69                -9.573427e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8425
    reference variance = 0.538243
====================================================
  Execution time = 2.5426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9926e-01
  Total weights = 1.963638341e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484445925841
                                         uncertainty =       0.009758534975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484445925841
                                         uncertainty =       0.009758534975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492196919
  error estimate for blocks of size 2^( 2) =       0.000512473466
  error estimate for blocks of size 2^( 3) =       0.000532707210
  error estimate for blocks of size 2^( 4) =       0.000549208287
  error estimate for blocks of size 2^( 5) =       0.000559022982
  error estimate for blocks of size 2^( 6) =       0.000566209219
  error estimate for blocks of size 2^( 7) =       0.000567712993

      target function =                  N/A
              le_mean =     -22.819397865513
             les_mean =     521.224174205865
             stat err =       0.000560538370
             autocorr =       1.296978900908
              std dev =       0.696071558444
             le_variance =       0.484515614474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281939786551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819397865405       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819397865464       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819397865464       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819397865458       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 5.010105e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819397865405       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819397865420       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819397865420       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819397865420       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 1.252529e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819397865405       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819397865409       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819397865409       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819397865409       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 3.131324e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9986e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583385e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869907e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558228e-03 3 1  ON 20
ci_22                 7.806957e-03 3 1  ON 21
ci_23                 6.665917e-03 3 1  ON 22
ci_24                 6.534170e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698844e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630382e-04 3 1  ON 31
ci_33                 7.777691e-05 3 1  ON 32
ci_34                 8.967980e-04 3 1  ON 33
ci_35                -2.388608e-05 3 1  ON 34
ci_36                -8.953249e-04 3 1  ON 35
ci_37                -5.142972e-04 3 1  ON 36
ci_38                -2.635238e-04 3 1  ON 37
ci_39                 4.144558e-04 3 1  ON 38
ci_40                -1.372558e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057163e-04 3 1  ON 41
ci_43                -2.414411e-03 3 1  ON 42
ci_44                -2.690223e-03 3 1  ON 43
ci_45                -1.268793e-06 3 1  ON 44
ci_46                -5.407558e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402276e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455157e-04 3 1  ON 50
ci_52                 2.153045e-04 3 1  ON 51
ci_53                -1.120548e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055674e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339350e-04 3 1  ON 56
ci_58                -1.196364e-03 3 1  ON 57
ci_59                -2.050383e-03 3 1  ON 58
ci_60                 4.754633e-04 3 1  ON 59
ci_61                 1.783856e-03 3 1  ON 60
ci_62                -5.833815e-04 3 1  ON 61
ci_63                -9.086843e-05 3 1  ON 62
ci_64                -6.291671e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658835e-04 3 1  ON 65
ci_67                -9.729483e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573424e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8875
    reference variance = 0.529861
====================================================
  Execution time = 2.6728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9348e-01
  Total weights = 1.9637e+06
  Execution time = 3.5864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503995
                                         uncertainty =       0.002078273664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503995
                                         uncertainty =       0.002078273664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488361348
  error estimate for blocks of size 2^( 2) =       0.000509428854
  error estimate for blocks of size 2^( 3) =       0.000529397224
  error estimate for blocks of size 2^( 4) =       0.000544682786
  error estimate for blocks of size 2^( 5) =       0.000554438452
  error estimate for blocks of size 2^( 6) =       0.000560736799
  error estimate for blocks of size 2^( 7) =       0.000562006416

      target function =                  N/A
              le_mean =     -22.819649426447
             les_mean =     521.229882790701
             stat err =       0.000555466113
             autocorr =       1.293697001226
              std dev =       0.690647241751
             le_variance =       0.476993612538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503216
                                         uncertainty =       0.002078273684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503216
                                         uncertainty =       0.002078273684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488361348
  error estimate for blocks of size 2^( 2) =       0.000509428854
  error estimate for blocks of size 2^( 3) =       0.000529397224
  error estimate for blocks of size 2^( 4) =       0.000544682786
  error estimate for blocks of size 2^( 5) =       0.000554438451
  error estimate for blocks of size 2^( 6) =       0.000560736799
  error estimate for blocks of size 2^( 7) =       0.000562006416

      target function =                  N/A
              le_mean =     -22.819649426464
             les_mean =     521.229882789330
             stat err =       0.000555466113
             autocorr =       1.293697001951
              std dev =       0.690647241181
             le_variance =       0.476993611751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503605
                                         uncertainty =       0.002078273674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503605
                                         uncertainty =       0.002078273674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488361348
  error estimate for blocks of size 2^( 2) =       0.000509428854
  error estimate for blocks of size 2^( 3) =       0.000529397224
  error estimate for blocks of size 2^( 4) =       0.000544682786
  error estimate for blocks of size 2^( 5) =       0.000554438452
  error estimate for blocks of size 2^( 6) =       0.000560736799
  error estimate for blocks of size 2^( 7) =       0.000562006416

      target function =                  N/A
              le_mean =     -22.819649426456
             les_mean =     521.229882790016
             stat err =       0.000555466113
             autocorr =       1.293697001588
              std dev =       0.690647241466
             le_variance =       0.476993612145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503946
                                         uncertainty =       0.002078273665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477021503946
                                         uncertainty =       0.002078273665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488361348
  error estimate for blocks of size 2^( 2) =       0.000509428854
  error estimate for blocks of size 2^( 3) =       0.000529397224
  error estimate for blocks of size 2^( 4) =       0.000544682786
  error estimate for blocks of size 2^( 5) =       0.000554438452
  error estimate for blocks of size 2^( 6) =       0.000560736799
  error estimate for blocks of size 2^( 7) =       0.000562006416

      target function =                  N/A
              le_mean =     -22.819649426448
             les_mean =     521.229882790616
             stat err =       0.000555466113
             autocorr =       1.293697001270
              std dev =       0.690647241715
             le_variance =       0.476993612489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819649426447        initial
     9.5367e+04     9.5367e+05             5.0101e-09       -22.819649426464  <--
     3.8147e+05     3.8147e+06             1.2525e-09       -22.819649426456
     1.5259e+06     1.5259e+07             3.1313e-10       -22.819649426448

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 4.4666e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777659e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267601e-06 3 1  ON 44
ci_46                -5.407567e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086842e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4664e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.886
    reference variance = 0.39018
====================================================
  Execution time = 2.5668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9728e-01
  Total weights = 1.963517537e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481736197363
                                         uncertainty =       0.002489655671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481736197363
                                         uncertainty =       0.002489655671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490789440
  error estimate for blocks of size 2^( 2) =       0.000511524276
  error estimate for blocks of size 2^( 3) =       0.000531561631
  error estimate for blocks of size 2^( 4) =       0.000545855777
  error estimate for blocks of size 2^( 5) =       0.000554947997
  error estimate for blocks of size 2^( 6) =       0.000559850087
  error estimate for blocks of size 2^( 7) =       0.000562566118

      target function =                  N/A
              le_mean =     -22.819779266516
             les_mean =     521.239601957409
             stat err =       0.000555804995
             autocorr =       1.282491428261
              std dev =       0.694081082323
             le_variance =       0.481748548838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281977926652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819779266440       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819779266765       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819779266768       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819779266765       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 2.075247e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819779266440       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819779266521       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819779266522       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819779266521       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 5.188151e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819779266440       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819779266460       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819779266460       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819779266181       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 1.297040e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044302 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0314e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142777e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583387e-03 3 1  ON 14
ci_16                 7.884885e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869905e-03 3 1  ON 17
ci_19                 9.395774e-03 3 1  ON 18
ci_20                 1.116731e-02 3 1  ON 19
ci_21                 7.558233e-03 3 1  ON 20
ci_22                 7.806957e-03 3 1  ON 21
ci_23                 6.665915e-03 3 1  ON 22
ci_24                 6.534168e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698845e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704272e-04 3 1  ON 29
ci_31                 1.054092e-03 3 1  ON 30
ci_32                 2.630333e-04 3 1  ON 31
ci_33                 7.777750e-05 3 1  ON 32
ci_34                 8.967977e-04 3 1  ON 33
ci_35                -2.388381e-05 3 1  ON 34
ci_36                -8.953254e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635230e-04 3 1  ON 37
ci_39                 4.144528e-04 3 1  ON 38
ci_40                -1.372559e-03 3 1  ON 39
ci_41                 5.404358e-04 3 1  ON 40
ci_42                 4.057171e-04 3 1  ON 41
ci_43                -2.414406e-03 3 1  ON 42
ci_44                -2.690219e-03 3 1  ON 43
ci_45                -1.266555e-06 3 1  ON 44
ci_46                -5.407556e-04 3 1  ON 45
ci_47                -1.411610e-03 3 1  ON 46
ci_48                -6.364285e-04 3 1  ON 47
ci_49                -1.402277e-03 3 1  ON 48
ci_50                -4.900451e-04 3 1  ON 49
ci_51                 6.455118e-04 3 1  ON 50
ci_52                 2.153033e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055670e-03 3 1  ON 54
ci_56                 2.128944e-03 3 1  ON 55
ci_57                 7.339380e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754620e-04 3 1  ON 59
ci_61                 1.783857e-03 3 1  ON 60
ci_62                -5.833825e-04 3 1  ON 61
ci_63                -9.087028e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772644e-04 3 1  ON 64
ci_66                 1.658803e-04 3 1  ON 65
ci_67                -9.729462e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573437e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.753
    reference variance = 0.387602
====================================================
  Execution time = 2.4848e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9929e-01
  Total weights = 1.9638e+06
  Execution time = 3.5880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267866824
                                         uncertainty =       0.002977434899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267866824
                                         uncertainty =       0.002977434899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491623512
  error estimate for blocks of size 2^( 2) =       0.000512002330
  error estimate for blocks of size 2^( 3) =       0.000532521608
  error estimate for blocks of size 2^( 4) =       0.000547389744
  error estimate for blocks of size 2^( 5) =       0.000556582726
  error estimate for blocks of size 2^( 6) =       0.000563114351
  error estimate for blocks of size 2^( 7) =       0.000565235123

      target function =                  N/A
              le_mean =     -22.820944251157
             les_mean =     521.294785454330
             stat err =       0.000558080486
             autocorr =       1.288630437120
              std dev =       0.695260637777
             le_variance =       0.483387354442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267862832
                                         uncertainty =       0.002977434045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267862832
                                         uncertainty =       0.002977434045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491623510
  error estimate for blocks of size 2^( 2) =       0.000512002328
  error estimate for blocks of size 2^( 3) =       0.000532521607
  error estimate for blocks of size 2^( 4) =       0.000547389744
  error estimate for blocks of size 2^( 5) =       0.000556582725
  error estimate for blocks of size 2^( 6) =       0.000563114351
  error estimate for blocks of size 2^( 7) =       0.000565235123

      target function =                  N/A
              le_mean =     -22.820944251013
             les_mean =     521.294785464466
             stat err =       0.000558080486
             autocorr =       1.288630446614
              std dev =       0.695260634996
             le_variance =       0.483387350575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267864828
                                         uncertainty =       0.002977434472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267864828
                                         uncertainty =       0.002977434472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491623511
  error estimate for blocks of size 2^( 2) =       0.000512002329
  error estimate for blocks of size 2^( 3) =       0.000532521608
  error estimate for blocks of size 2^( 4) =       0.000547389744
  error estimate for blocks of size 2^( 5) =       0.000556582726
  error estimate for blocks of size 2^( 6) =       0.000563114351
  error estimate for blocks of size 2^( 7) =       0.000565235123

      target function =                  N/A
              le_mean =     -22.820944251085
             les_mean =     521.294785459394
             stat err =       0.000558080486
             autocorr =       1.288630441867
              std dev =       0.695260636386
             le_variance =       0.483387352508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267866575
                                         uncertainty =       0.002977434846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483267866575
                                         uncertainty =       0.002977434846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491623512
  error estimate for blocks of size 2^( 2) =       0.000512002329
  error estimate for blocks of size 2^( 3) =       0.000532521608
  error estimate for blocks of size 2^( 4) =       0.000547389744
  error estimate for blocks of size 2^( 5) =       0.000556582726
  error estimate for blocks of size 2^( 6) =       0.000563114351
  error estimate for blocks of size 2^( 7) =       0.000565235123

      target function =                  N/A
              le_mean =     -22.820944251148
             les_mean =     521.294785454963
             stat err =       0.000558080486
             autocorr =       1.288630437712
              std dev =       0.695260637603
             le_variance =       0.483387354200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820944251157        initial  <--
     2.3842e+04     2.3842e+05             2.0752e-08       -22.820944251013
     9.5367e+04     9.5367e+05             5.1882e-09       -22.820944251085
     3.8147e+05     3.8147e+06             1.2970e-09       -22.820944251148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7998
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777659e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267601e-06 3 1  ON 44
ci_46                -5.407567e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086842e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8111
    reference variance = 0.346103
====================================================
  Execution time = 2.5672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9053e-01
  Total weights = 1.963745474e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474199320568
                                         uncertainty =       0.002388671757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474199320568
                                         uncertainty =       0.002388671757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486901923
  error estimate for blocks of size 2^( 2) =       0.000507734226
  error estimate for blocks of size 2^( 3) =       0.000527104262
  error estimate for blocks of size 2^( 4) =       0.000542306297
  error estimate for blocks of size 2^( 5) =       0.000552094921
  error estimate for blocks of size 2^( 6) =       0.000558019856
  error estimate for blocks of size 2^( 7) =       0.000561317593

      target function =                  N/A
              le_mean =     -22.819053914156
             les_mean =     521.199748960518
             stat err =       0.000553434667
             autocorr =       1.291961997493
              std dev =       0.688583303191
             le_variance =       0.474146965433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281905391416e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819053914077       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819053914114       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819053914115       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819053914189       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 1.880352e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819053914077       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819053914087       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819053914087       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819053914087       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 4.700883e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819053914077       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819053914080       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819053914080       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819053914080       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 1.175222e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0215e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583387e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704277e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630365e-04 3 1  ON 31
ci_33                 7.777635e-05 3 1  ON 32
ci_34                 8.967966e-04 3 1  ON 33
ci_35                -2.388543e-05 3 1  ON 34
ci_36                -8.953249e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144540e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057157e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267688e-06 3 1  ON 44
ci_46                -5.407565e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339389e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086850e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658828e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573417e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.9042
    reference variance = 0.702179
====================================================
  Execution time = 2.5101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 5.0638e-01
  Total weights = 1.9636e+06
  Execution time = 3.5831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311396980
                                         uncertainty =       0.003665237589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311396980
                                         uncertainty =       0.003665237589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492095736
  error estimate for blocks of size 2^( 2) =       0.000512459280
  error estimate for blocks of size 2^( 3) =       0.000531810947
  error estimate for blocks of size 2^( 4) =       0.000547324136
  error estimate for blocks of size 2^( 5) =       0.000556788838
  error estimate for blocks of size 2^( 6) =       0.000562446548
  error estimate for blocks of size 2^( 7) =       0.000564139920

      target function =                  N/A
              le_mean =     -22.819785113955
             les_mean =     521.248974126072
             stat err =       0.000557674860
             autocorr =       1.284289495608
              std dev =       0.695928464124
             le_variance =       0.484316427178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311399450
                                         uncertainty =       0.003665239273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311399450
                                         uncertainty =       0.003665239273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492095737
  error estimate for blocks of size 2^( 2) =       0.000512459282
  error estimate for blocks of size 2^( 3) =       0.000531810949
  error estimate for blocks of size 2^( 4) =       0.000547324137
  error estimate for blocks of size 2^( 5) =       0.000556788839
  error estimate for blocks of size 2^( 6) =       0.000562446549
  error estimate for blocks of size 2^( 7) =       0.000564139921

      target function =                  N/A
              le_mean =     -22.819785113945
             les_mean =     521.248974139085
             stat err =       0.000557674862
             autocorr =       1.284289493912
              std dev =       0.695928465898
             le_variance =       0.484316429647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311398215
                                         uncertainty =       0.003665238431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311398215
                                         uncertainty =       0.003665238431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492095737
  error estimate for blocks of size 2^( 2) =       0.000512459281
  error estimate for blocks of size 2^( 3) =       0.000531810948
  error estimate for blocks of size 2^( 4) =       0.000547324137
  error estimate for blocks of size 2^( 5) =       0.000556788838
  error estimate for blocks of size 2^( 6) =       0.000562446548
  error estimate for blocks of size 2^( 7) =       0.000564139921

      target function =                  N/A
              le_mean =     -22.819785113950
             les_mean =     521.248974132579
             stat err =       0.000557674861
             autocorr =       1.284289494757
              std dev =       0.695928465011
             le_variance =       0.484316428412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311397134
                                         uncertainty =       0.003665237694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484311397134
                                         uncertainty =       0.003665237694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492095736
  error estimate for blocks of size 2^( 2) =       0.000512459280
  error estimate for blocks of size 2^( 3) =       0.000531810947
  error estimate for blocks of size 2^( 4) =       0.000547324136
  error estimate for blocks of size 2^( 5) =       0.000556788838
  error estimate for blocks of size 2^( 6) =       0.000562446548
  error estimate for blocks of size 2^( 7) =       0.000564139921

      target function =                  N/A
              le_mean =     -22.819785113954
             les_mean =     521.248974126886
             stat err =       0.000557674861
             autocorr =       1.284289495506
              std dev =       0.695928464235
             le_variance =       0.484316427332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819785113955        initial  <--
     2.3842e+05     2.3842e+06             1.8804e-09       -22.819785113945
     9.5367e+05     9.5367e+06             4.7009e-10       -22.819785113950
     3.8147e+06     3.8147e+07             1.1752e-10       -22.819785113954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0439
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777659e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267601e-06 3 1  ON 44
ci_46                -5.407567e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086842e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8246
    reference variance = 0.276454
====================================================
  Execution time = 2.5467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8886e-01
  Total weights = 1.963805615e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473274681322
                                         uncertainty =       0.002507441157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473274681322
                                         uncertainty =       0.002507441157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486514035
  error estimate for blocks of size 2^( 2) =       0.000507682562
  error estimate for blocks of size 2^( 3) =       0.000527103857
  error estimate for blocks of size 2^( 4) =       0.000541206548
  error estimate for blocks of size 2^( 5) =       0.000551597690
  error estimate for blocks of size 2^( 6) =       0.000557230518
  error estimate for blocks of size 2^( 7) =       0.000559349907

      target function =                  N/A
              le_mean =     -22.819167834169
             les_mean =     521.203277018818
             stat err =       0.000552346166
             autocorr =       1.288937740865
              std dev =       0.688034746858
             le_variance =       0.473391812884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281916783417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819167834057       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819167834061       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819167834061       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819167834061       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 1.779512e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819167834057       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819167834058       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819167834058       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819167834058       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 4.448791e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819167834057       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819167834057       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819167834057       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819167834915       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+07 is 1.112195e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0097e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630367e-04 3 1  ON 31
ci_33                 7.777657e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142978e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267626e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339389e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086843e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729465e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7989
    reference variance = 0.411583
====================================================
  Execution time = 2.5019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8966e-01
  Total weights = 1.9634e+06
  Execution time = 3.5802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073840
                                         uncertainty =       0.001947204248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073840
                                         uncertainty =       0.001947204248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486087148
  error estimate for blocks of size 2^( 2) =       0.000506952253
  error estimate for blocks of size 2^( 3) =       0.000526257832
  error estimate for blocks of size 2^( 4) =       0.000541537575
  error estimate for blocks of size 2^( 5) =       0.000551011780
  error estimate for blocks of size 2^( 6) =       0.000557082853
  error estimate for blocks of size 2^( 7) =       0.000561618237

      target function =                  N/A
              le_mean =     -22.820061879644
             les_mean =     521.244879543334
             stat err =       0.000552812611
             autocorr =       1.293384363775
              std dev =       0.687431037529
             le_variance =       0.472561431358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073706
                                         uncertainty =       0.001947204240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073706
                                         uncertainty =       0.001947204240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486087148
  error estimate for blocks of size 2^( 2) =       0.000506952253
  error estimate for blocks of size 2^( 3) =       0.000526257832
  error estimate for blocks of size 2^( 4) =       0.000541537575
  error estimate for blocks of size 2^( 5) =       0.000551011780
  error estimate for blocks of size 2^( 6) =       0.000557082853
  error estimate for blocks of size 2^( 7) =       0.000561618237

      target function =                  N/A
              le_mean =     -22.820061879640
             les_mean =     521.244879542534
             stat err =       0.000552812611
             autocorr =       1.293384363897
              std dev =       0.687431037431
             le_variance =       0.472561431224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073773
                                         uncertainty =       0.001947204244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073773
                                         uncertainty =       0.001947204244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486087148
  error estimate for blocks of size 2^( 2) =       0.000506952253
  error estimate for blocks of size 2^( 3) =       0.000526257832
  error estimate for blocks of size 2^( 4) =       0.000541537575
  error estimate for blocks of size 2^( 5) =       0.000551011780
  error estimate for blocks of size 2^( 6) =       0.000557082853
  error estimate for blocks of size 2^( 7) =       0.000561618237

      target function =                  N/A
              le_mean =     -22.820061879642
             les_mean =     521.244879542934
             stat err =       0.000552812611
             autocorr =       1.293384363819
              std dev =       0.687431037480
             le_variance =       0.472561431291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073831
                                         uncertainty =       0.001947204248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472537073831
                                         uncertainty =       0.001947204248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486087148
  error estimate for blocks of size 2^( 2) =       0.000506952253
  error estimate for blocks of size 2^( 3) =       0.000526257832
  error estimate for blocks of size 2^( 4) =       0.000541537575
  error estimate for blocks of size 2^( 5) =       0.000551011780
  error estimate for blocks of size 2^( 6) =       0.000557082853
  error estimate for blocks of size 2^( 7) =       0.000561618237

      target function =                  N/A
              le_mean =     -22.820061879644
             les_mean =     521.244879543284
             stat err =       0.000552812611
             autocorr =       1.293384363777
              std dev =       0.687431037523
             le_variance =       0.472561431349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820061879644        initial  <--
     2.3842e+06     2.3842e+07             1.7795e-10       -22.820061879640
     9.5367e+06     9.5367e+07             4.4488e-11       -22.820061879642
     3.8147e+07     3.8147e+08             1.1122e-11       -22.820061879644

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0583
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777659e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267601e-06 3 1  ON 44
ci_46                -5.407567e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086842e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8122
    reference variance = 0.319156
====================================================
  Execution time = 2.5369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.8953e-01
  Total weights = 1.963440938e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474810380641
                                         uncertainty =       0.002442510709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474810380641
                                         uncertainty =       0.002442510709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487230408
  error estimate for blocks of size 2^( 2) =       0.000507940912
  error estimate for blocks of size 2^( 3) =       0.000527969524
  error estimate for blocks of size 2^( 4) =       0.000543503405
  error estimate for blocks of size 2^( 5) =       0.000553408252
  error estimate for blocks of size 2^( 6) =       0.000559887061
  error estimate for blocks of size 2^( 7) =       0.000561425146

      target function =                  N/A
              le_mean =     -22.821087761153
             les_mean =     521.291572940767
             stat err =       0.000554555966
             autocorr =       1.295453993598
              std dev =       0.689047851158
             le_variance =       0.474786941186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282108776115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.821087761054       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.821087761054       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.821087761054       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.821087768057       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 1.966551e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.821087761054       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.821087761054       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.821087761054       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.821087761054       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+07 is 4.916359e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.821087761054       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.821087761054       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.821087761054       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.821087761054       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+08 is 1.229094e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0010e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777659e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267602e-06 3 1  ON 44
ci_46                -5.407567e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086843e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8263
    reference variance = 0.462769
====================================================
  Execution time = 2.6536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9239e-01
  Total weights = 1.9640e+06
  Execution time = 3.5962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018062
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018062
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488821006
  error estimate for blocks of size 2^( 2) =       0.000509605844
  error estimate for blocks of size 2^( 3) =       0.000529231460
  error estimate for blocks of size 2^( 4) =       0.000544212186
  error estimate for blocks of size 2^( 5) =       0.000553229840
  error estimate for blocks of size 2^( 6) =       0.000559827722
  error estimate for blocks of size 2^( 7) =       0.000562867076

      target function =                  N/A
              le_mean =     -22.819243569050
             les_mean =     521.210272015308
             stat err =       0.000555034206
             autocorr =       1.289257830886
              std dev =       0.691297295616
             le_variance =       0.477891950926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018061
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018061
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488821006
  error estimate for blocks of size 2^( 2) =       0.000509605844
  error estimate for blocks of size 2^( 3) =       0.000529231460
  error estimate for blocks of size 2^( 4) =       0.000544212186
  error estimate for blocks of size 2^( 5) =       0.000553229840
  error estimate for blocks of size 2^( 6) =       0.000559827722
  error estimate for blocks of size 2^( 7) =       0.000562867076

      target function =                  N/A
              le_mean =     -22.819243569050
             les_mean =     521.210272015320
             stat err =       0.000555034206
             autocorr =       1.289257830885
              std dev =       0.691297295615
             le_variance =       0.477891950924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018062
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018062
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488821006
  error estimate for blocks of size 2^( 2) =       0.000509605844
  error estimate for blocks of size 2^( 3) =       0.000529231460
  error estimate for blocks of size 2^( 4) =       0.000544212186
  error estimate for blocks of size 2^( 5) =       0.000553229840
  error estimate for blocks of size 2^( 6) =       0.000559827722
  error estimate for blocks of size 2^( 7) =       0.000562867076

      target function =                  N/A
              le_mean =     -22.819243569050
             les_mean =     521.210272015314
             stat err =       0.000555034206
             autocorr =       1.289257830878
              std dev =       0.691297295615
             le_variance =       0.477891950925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018062
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477690018062
                                         uncertainty =       0.002631012363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488821006
  error estimate for blocks of size 2^( 2) =       0.000509605844
  error estimate for blocks of size 2^( 3) =       0.000529231460
  error estimate for blocks of size 2^( 4) =       0.000544212186
  error estimate for blocks of size 2^( 5) =       0.000553229840
  error estimate for blocks of size 2^( 6) =       0.000559827722
  error estimate for blocks of size 2^( 7) =       0.000562867076

      target function =                  N/A
              le_mean =     -22.819243569050
             les_mean =     521.210272015308
             stat err =       0.000555034206
             autocorr =       1.289257830888
              std dev =       0.691297295616
             le_variance =       0.477891950926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819243569050        initial
     2.3842e+07     2.3842e+08             1.9666e-11       -22.819243569050  <--
     9.5367e+07     9.5367e+08             4.9164e-12       -22.819243569050
     3.8147e+08     3.8147e+09             1.2291e-12       -22.819243569050

*****************************************************************************
Applying the update for shift_i =   2.3842e+07     and shift_s =   2.3842e+08
*****************************************************************************

  Execution time = 4.4516e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777658e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953253e-04 3 1  ON 35
ci_37                -5.142978e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144543e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267607e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086844e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7947
    reference variance = 0.321422
====================================================
  Execution time = 2.5354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8687e-01
  Total weights = 1.963670294e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472432993864
                                         uncertainty =       0.002060140749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472432993864
                                         uncertainty =       0.002060140749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486035865
  error estimate for blocks of size 2^( 2) =       0.000506617973
  error estimate for blocks of size 2^( 3) =       0.000526087949
  error estimate for blocks of size 2^( 4) =       0.000541819925
  error estimate for blocks of size 2^( 5) =       0.000551185356
  error estimate for blocks of size 2^( 6) =       0.000557180688
  error estimate for blocks of size 2^( 7) =       0.000560393567

      target function =                  N/A
              le_mean =     -22.819516977936
             les_mean =     521.217229085722
             stat err =       0.000552644884
             autocorr =       1.292872427128
              std dev =       0.687358511689
             le_variance =       0.472461723591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281951697794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819516977869       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819516977870       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819516977870       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819516977870       residual = 6.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+06 is 8.399158e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819516977869       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819516977869       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819516977869       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819516977869       residual = 6.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 2.099785e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819516977869       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819516977869       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819516977869       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819516974010       residual = 6.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+07 is 5.249451e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0010e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777658e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267610e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455153e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050382e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833805e-04 3 1  ON 61
ci_63                -9.086845e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7457
    reference variance = 0.312092
====================================================
  Execution time = 2.4996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9367e-01
  Total weights = 1.9634e+06
  Execution time = 3.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420767
                                         uncertainty =       0.002466713848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420767
                                         uncertainty =       0.002466713848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489453289
  error estimate for blocks of size 2^( 2) =       0.000510443480
  error estimate for blocks of size 2^( 3) =       0.000530028033
  error estimate for blocks of size 2^( 4) =       0.000544675024
  error estimate for blocks of size 2^( 5) =       0.000555381426
  error estimate for blocks of size 2^( 6) =       0.000560114327
  error estimate for blocks of size 2^( 7) =       0.000563333235

      target function =                  N/A
              le_mean =     -22.819122407772
             les_mean =     521.206020669422
             stat err =       0.000555876003
             autocorr =       1.289832600548
              std dev =       0.692191479576
             le_variance =       0.479129044398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420766
                                         uncertainty =       0.002466713849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420766
                                         uncertainty =       0.002466713849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489453289
  error estimate for blocks of size 2^( 2) =       0.000510443480
  error estimate for blocks of size 2^( 3) =       0.000530028033
  error estimate for blocks of size 2^( 4) =       0.000544675024
  error estimate for blocks of size 2^( 5) =       0.000555381426
  error estimate for blocks of size 2^( 6) =       0.000560114327
  error estimate for blocks of size 2^( 7) =       0.000563333235

      target function =                  N/A
              le_mean =     -22.819122407772
             les_mean =     521.206020669502
             stat err =       0.000555876003
             autocorr =       1.289832600548
              std dev =       0.692191479575
             le_variance =       0.479129044396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420766
                                         uncertainty =       0.002466713849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420766
                                         uncertainty =       0.002466713849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489453289
  error estimate for blocks of size 2^( 2) =       0.000510443480
  error estimate for blocks of size 2^( 3) =       0.000530028033
  error estimate for blocks of size 2^( 4) =       0.000544675024
  error estimate for blocks of size 2^( 5) =       0.000555381426
  error estimate for blocks of size 2^( 6) =       0.000560114327
  error estimate for blocks of size 2^( 7) =       0.000563333235

      target function =                  N/A
              le_mean =     -22.819122407772
             les_mean =     521.206020669462
             stat err =       0.000555876003
             autocorr =       1.289832600547
              std dev =       0.692191479576
             le_variance =       0.479129044397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420767
                                         uncertainty =       0.002466713848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479138420767
                                         uncertainty =       0.002466713848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489453289
  error estimate for blocks of size 2^( 2) =       0.000510443480
  error estimate for blocks of size 2^( 3) =       0.000530028033
  error estimate for blocks of size 2^( 4) =       0.000544675024
  error estimate for blocks of size 2^( 5) =       0.000555381426
  error estimate for blocks of size 2^( 6) =       0.000560114327
  error estimate for blocks of size 2^( 7) =       0.000563333235

      target function =                  N/A
              le_mean =     -22.819122407772
             les_mean =     521.206020669427
             stat err =       0.000555876003
             autocorr =       1.289832600550
              std dev =       0.692191479576
             le_variance =       0.479129044398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819122407772        initial
     5.9605e+06     5.9605e+07             8.3992e-11       -22.819122407772  <--
     2.3842e+07     2.3842e+08             2.0998e-11       -22.819122407772
     9.5367e+07     9.5367e+08             5.2495e-12       -22.819122407772

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 4.2867e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777655e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267621e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086850e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658825e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8697
    reference variance = 0.689603
====================================================
  Execution time = 2.5488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9719e-01
  Total weights = 1.963499648e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482893194382
                                         uncertainty =       0.008430472068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482893194382
                                         uncertainty =       0.008430472068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491348416
  error estimate for blocks of size 2^( 2) =       0.000512139719
  error estimate for blocks of size 2^( 3) =       0.000531740701
  error estimate for blocks of size 2^( 4) =       0.000546913796
  error estimate for blocks of size 2^( 5) =       0.000556472232
  error estimate for blocks of size 2^( 6) =       0.000561558594
  error estimate for blocks of size 2^( 7) =       0.000563281493

      target function =                  N/A
              le_mean =     -22.819629952233
             les_mean =     521.232696778767
             stat err =       0.000557056529
             autocorr =       1.285344125370
              std dev =       0.694871593550
             le_variance =       0.482846531522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281962995223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819629952132       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819629952140       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819629952141       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819629952141       residual = 9.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+06 is 3.121862e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819629952132       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819629952134       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819629952134       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819629952134       residual = 9.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+06 is 7.804642e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819629952132       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819629952133       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819629952133       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819629952251       residual = 9.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 1.951164e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0128e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777657e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388528e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057159e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267647e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900417e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339389e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086857e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658826e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.9029
    reference variance = 0.46361
====================================================
  Execution time = 2.4836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9228e-01
  Total weights = 1.9636e+06
  Execution time = 3.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753596
                                         uncertainty =       0.002675460018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753596
                                         uncertainty =       0.002675460018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486879145
  error estimate for blocks of size 2^( 2) =       0.000507718898
  error estimate for blocks of size 2^( 3) =       0.000528417739
  error estimate for blocks of size 2^( 4) =       0.000543911086
  error estimate for blocks of size 2^( 5) =       0.000554140646
  error estimate for blocks of size 2^( 6) =       0.000561273493
  error estimate for blocks of size 2^( 7) =       0.000564070804

      target function =                  N/A
              le_mean =     -22.820542284401
             les_mean =     521.269435064078
             stat err =       0.000555849007
             autocorr =       1.303380811589
              std dev =       0.688551090560
             le_variance =       0.474102604311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753544
                                         uncertainty =       0.002675460017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753544
                                         uncertainty =       0.002675460017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486879145
  error estimate for blocks of size 2^( 2) =       0.000507718898
  error estimate for blocks of size 2^( 3) =       0.000528417739
  error estimate for blocks of size 2^( 4) =       0.000543911086
  error estimate for blocks of size 2^( 5) =       0.000554140646
  error estimate for blocks of size 2^( 6) =       0.000561273493
  error estimate for blocks of size 2^( 7) =       0.000564070804

      target function =                  N/A
              le_mean =     -22.820542284399
             les_mean =     521.269435063695
             stat err =       0.000555849007
             autocorr =       1.303380811712
              std dev =       0.688551090522
             le_variance =       0.474102604258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753570
                                         uncertainty =       0.002675460018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753570
                                         uncertainty =       0.002675460018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486879145
  error estimate for blocks of size 2^( 2) =       0.000507718898
  error estimate for blocks of size 2^( 3) =       0.000528417739
  error estimate for blocks of size 2^( 4) =       0.000543911086
  error estimate for blocks of size 2^( 5) =       0.000554140646
  error estimate for blocks of size 2^( 6) =       0.000561273493
  error estimate for blocks of size 2^( 7) =       0.000564070804

      target function =                  N/A
              le_mean =     -22.820542284400
             les_mean =     521.269435063887
             stat err =       0.000555849007
             autocorr =       1.303380811660
              std dev =       0.688551090541
             le_variance =       0.474102604285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753593
                                         uncertainty =       0.002675460018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474155753593
                                         uncertainty =       0.002675460018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486879145
  error estimate for blocks of size 2^( 2) =       0.000507718898
  error estimate for blocks of size 2^( 3) =       0.000528417739
  error estimate for blocks of size 2^( 4) =       0.000543911086
  error estimate for blocks of size 2^( 5) =       0.000554140646
  error estimate for blocks of size 2^( 6) =       0.000561273493
  error estimate for blocks of size 2^( 7) =       0.000564070804

      target function =                  N/A
              le_mean =     -22.820542284401
             les_mean =     521.269435064054
             stat err =       0.000555849007
             autocorr =       1.303380811600
              std dev =       0.688551090557
             le_variance =       0.474102604308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820542284401        initial  <--
     1.4901e+06     1.4901e+07             3.1219e-10       -22.820542284399
     5.9605e+06     5.9605e+07             7.8046e-11       -22.820542284400
     2.3842e+07     2.3842e+08             1.9512e-11       -22.820542284401

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7325
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630368e-04 3 1  ON 31
ci_33                 7.777655e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267621e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086850e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658825e-04 3 1  ON 65
ci_67                -9.729466e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8636
    reference variance = 0.461615
====================================================
  Execution time = 2.5430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9403e-01
  Total weights = 1.963893960e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479030549330
                                         uncertainty =       0.002675652109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479030549330
                                         uncertainty =       0.002675652109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489337309
  error estimate for blocks of size 2^( 2) =       0.000510459505
  error estimate for blocks of size 2^( 3) =       0.000530922774
  error estimate for blocks of size 2^( 4) =       0.000546332061
  error estimate for blocks of size 2^( 5) =       0.000556264226
  error estimate for blocks of size 2^( 6) =       0.000562685258
  error estimate for blocks of size 2^( 7) =       0.000561904655

      target function =                  N/A
              le_mean =     -22.820087077431
             les_mean =     521.250408566067
             stat err =       0.000556796550
             autocorr =       1.294721658699
              std dev =       0.692027458291
             le_variance =       0.478902003029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282008707743e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820087077361       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820087077362       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820087077362       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820087077362       residual = 9.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 3.196656e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820087077361       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820087077361       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820087077362       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820087077362       residual = 9.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 7.991661e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820087077361       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820087077361       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820087077361       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820087077361       residual = 9.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 1.997913e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9969e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630367e-04 3 1  ON 31
ci_33                 7.777655e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057159e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267616e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120546e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086850e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658825e-04 3 1  ON 65
ci_67                -9.729465e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8549
    reference variance = 0.435991
====================================================
  Execution time = 2.4934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8809e-01
  Total weights = 1.9638e+06
  Execution time = 3.5794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747602
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747602
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486699366
  error estimate for blocks of size 2^( 2) =       0.000507699035
  error estimate for blocks of size 2^( 3) =       0.000528040809
  error estimate for blocks of size 2^( 4) =       0.000543943811
  error estimate for blocks of size 2^( 5) =       0.000552408287
  error estimate for blocks of size 2^( 6) =       0.000558634428
  error estimate for blocks of size 2^( 7) =       0.000558041825

      target function =                  N/A
              le_mean =     -22.820012652848
             les_mean =     521.241072264523
             stat err =       0.000553257088
             autocorr =       1.292207959244
              std dev =       0.688296844487
             le_variance =       0.473752546131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747604
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747604
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486699366
  error estimate for blocks of size 2^( 2) =       0.000507699035
  error estimate for blocks of size 2^( 3) =       0.000528040809
  error estimate for blocks of size 2^( 4) =       0.000543943811
  error estimate for blocks of size 2^( 5) =       0.000552408287
  error estimate for blocks of size 2^( 6) =       0.000558634428
  error estimate for blocks of size 2^( 7) =       0.000558041825

      target function =                  N/A
              le_mean =     -22.820012652848
             les_mean =     521.241072264560
             stat err =       0.000553257088
             autocorr =       1.292207959252
              std dev =       0.688296844488
             le_variance =       0.473752546132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747603
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747603
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486699366
  error estimate for blocks of size 2^( 2) =       0.000507699035
  error estimate for blocks of size 2^( 3) =       0.000528040809
  error estimate for blocks of size 2^( 4) =       0.000543943811
  error estimate for blocks of size 2^( 5) =       0.000552408287
  error estimate for blocks of size 2^( 6) =       0.000558634428
  error estimate for blocks of size 2^( 7) =       0.000558041825

      target function =                  N/A
              le_mean =     -22.820012652848
             les_mean =     521.241072264541
             stat err =       0.000553257088
             autocorr =       1.292207959245
              std dev =       0.688296844487
             le_variance =       0.473752546131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747602
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473662747602
                                         uncertainty =       0.002267554833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486699366
  error estimate for blocks of size 2^( 2) =       0.000507699035
  error estimate for blocks of size 2^( 3) =       0.000528040809
  error estimate for blocks of size 2^( 4) =       0.000543943811
  error estimate for blocks of size 2^( 5) =       0.000552408287
  error estimate for blocks of size 2^( 6) =       0.000558634428
  error estimate for blocks of size 2^( 7) =       0.000558041825

      target function =                  N/A
              le_mean =     -22.820012652848
             les_mean =     521.241072264525
             stat err =       0.000553257088
             autocorr =       1.292207959249
              std dev =       0.688296844487
             le_variance =       0.473752546131


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820012652848        initial
     1.4901e+07     1.4901e+08             3.1967e-11       -22.820012652848  <--
     5.9605e+07     5.9605e+08             7.9917e-12       -22.820012652848
     2.3842e+08     2.3842e+09             1.9979e-12       -22.820012652848

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 4.2852e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630367e-04 3 1  ON 31
ci_33                 7.777655e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388529e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057159e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267603e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086851e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658825e-04 3 1  ON 65
ci_67                -9.729465e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8746
    reference variance = 0.557602
====================================================
  Execution time = 2.5617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9866e-01
  Total weights = 1.963572138e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479581393893
                                         uncertainty =       0.002858746239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479581393893
                                         uncertainty =       0.002858746239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489652015
  error estimate for blocks of size 2^( 2) =       0.000510184081
  error estimate for blocks of size 2^( 3) =       0.000529869456
  error estimate for blocks of size 2^( 4) =       0.000545202929
  error estimate for blocks of size 2^( 5) =       0.000553637487
  error estimate for blocks of size 2^( 6) =       0.000557114626
  error estimate for blocks of size 2^( 7) =       0.000561410396

      target function =                  N/A
              le_mean =     -22.819812183817
             les_mean =     521.242492631413
             stat err =       0.000554341360
             autocorr =       1.281679602617
              std dev =       0.692472520908
             le_variance =       0.479518192213


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281981218382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819812183748       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819812183750       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819812183750       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819812183750       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 1.334574e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819812183748       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819812183749       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819812183749       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819812183749       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 3.336439e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819812183748       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819812183748       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819812183748       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819812184541       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 8.341068e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0168e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630367e-04 3 1  ON 31
ci_33                 7.777654e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388530e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057159e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267621e-06 3 1  ON 44
ci_46                -5.407566e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339388e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833804e-04 3 1  ON 61
ci_63                -9.086852e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658825e-04 3 1  ON 65
ci_67                -9.729465e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573415e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8179
    reference variance = 0.597514
====================================================
  Execution time = 2.6917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9772e-01
  Total weights = 1.9637e+06
  Execution time = 3.5890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402607
                                         uncertainty =       0.003063988392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402607
                                         uncertainty =       0.003063988392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490097280
  error estimate for blocks of size 2^( 2) =       0.000510924943
  error estimate for blocks of size 2^( 3) =       0.000531001122
  error estimate for blocks of size 2^( 4) =       0.000546284774
  error estimate for blocks of size 2^( 5) =       0.000555697195
  error estimate for blocks of size 2^( 6) =       0.000559694060
  error estimate for blocks of size 2^( 7) =       0.000564575593

      target function =                  N/A
              le_mean =     -22.819028327584
             les_mean =     521.205772020520
             stat err =       0.000556562906
             autocorr =       1.289626446039
              std dev =       0.693102220633
             le_variance =       0.480390688246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402588
                                         uncertainty =       0.003063988391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402588
                                         uncertainty =       0.003063988391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490097280
  error estimate for blocks of size 2^( 2) =       0.000510924943
  error estimate for blocks of size 2^( 3) =       0.000531001122
  error estimate for blocks of size 2^( 4) =       0.000546284774
  error estimate for blocks of size 2^( 5) =       0.000555697195
  error estimate for blocks of size 2^( 6) =       0.000559694060
  error estimate for blocks of size 2^( 7) =       0.000564575593

      target function =                  N/A
              le_mean =     -22.819028327584
             les_mean =     521.205772020546
             stat err =       0.000556562906
             autocorr =       1.289626446081
              std dev =       0.693102220619
             le_variance =       0.480390688227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402598
                                         uncertainty =       0.003063988392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402598
                                         uncertainty =       0.003063988392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490097280
  error estimate for blocks of size 2^( 2) =       0.000510924943
  error estimate for blocks of size 2^( 3) =       0.000531001122
  error estimate for blocks of size 2^( 4) =       0.000546284774
  error estimate for blocks of size 2^( 5) =       0.000555697195
  error estimate for blocks of size 2^( 6) =       0.000559694060
  error estimate for blocks of size 2^( 7) =       0.000564575593

      target function =                  N/A
              le_mean =     -22.819028327584
             les_mean =     521.205772020533
             stat err =       0.000556562906
             autocorr =       1.289626446052
              std dev =       0.693102220626
             le_variance =       0.480390688237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402606
                                         uncertainty =       0.003063988392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480320402606
                                         uncertainty =       0.003063988392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490097280
  error estimate for blocks of size 2^( 2) =       0.000510924943
  error estimate for blocks of size 2^( 3) =       0.000531001122
  error estimate for blocks of size 2^( 4) =       0.000546284774
  error estimate for blocks of size 2^( 5) =       0.000555697195
  error estimate for blocks of size 2^( 6) =       0.000559694060
  error estimate for blocks of size 2^( 7) =       0.000564575593

      target function =                  N/A
              le_mean =     -22.819028327584
             les_mean =     521.205772020522
             stat err =       0.000556562906
             autocorr =       1.289626446037
              std dev =       0.693102220632
             le_variance =       0.480390688245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819028327584        initial
     3.7253e+06     3.7253e+07             1.3346e-10       -22.819028327584  <--
     1.4901e+07     1.4901e+08             3.3364e-11       -22.819028327584
     5.9605e+07     5.9605e+08             8.3411e-12       -22.819028327584

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 4.4856e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704278e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630367e-04 3 1  ON 31
ci_33                 7.777651e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388531e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142977e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144542e-04 3 1  ON 38
ci_40                -1.372557e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057159e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267674e-06 3 1  ON 44
ci_46                -5.407565e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364262e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455152e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339389e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833803e-04 3 1  ON 61
ci_63                -9.086856e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772642e-04 3 1  ON 64
ci_66                 1.658825e-04 3 1  ON 65
ci_67                -9.729465e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573416e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5031e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8755
    reference variance = 0.272557
====================================================
  Execution time = 2.5549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9184e-01
  Total weights = 1.963758883e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477492162454
                                         uncertainty =       0.003400450607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477492162454
                                         uncertainty =       0.003400450607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488651949
  error estimate for blocks of size 2^( 2) =       0.000509234489
  error estimate for blocks of size 2^( 3) =       0.000528978763
  error estimate for blocks of size 2^( 4) =       0.000544122772
  error estimate for blocks of size 2^( 5) =       0.000553217353
  error estimate for blocks of size 2^( 6) =       0.000560174141
  error estimate for blocks of size 2^( 7) =       0.000565706999

      target function =                  N/A
              le_mean =     -22.819218991729
             les_mean =     521.208598792705
             stat err =       0.000555805316
             autocorr =       1.293737366766
              std dev =       0.691058213859
             le_variance =       0.477561454942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281921899173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819218991668       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819218991677       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819218991677       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819218991602       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 5.212670e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819218991668       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819218991670       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819218991670       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819218991333       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 1.303167e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819218991668       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819218991668       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819218991668       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819218991668       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 3.257919e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0121e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884884e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698846e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704277e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630366e-04 3 1  ON 31
ci_33                 7.777649e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388525e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142978e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144541e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404362e-04 3 1  ON 40
ci_42                 4.057159e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267690e-06 3 1  ON 44
ci_46                -5.407565e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455151e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128947e-03 3 1  ON 55
ci_57                 7.339390e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833803e-04 3 1  ON 61
ci_63                -9.086862e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772643e-04 3 1  ON 64
ci_66                 1.658824e-04 3 1  ON 65
ci_67                -9.729465e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573416e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7402
    reference variance = 0.480173
====================================================
  Execution time = 2.5058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9249e-01
  Total weights = 1.9635e+06
  Execution time = 3.5798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786803
                                         uncertainty =       0.002134035687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786803
                                         uncertainty =       0.002134035687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488314367
  error estimate for blocks of size 2^( 2) =       0.000509279264
  error estimate for blocks of size 2^( 3) =       0.000528454650
  error estimate for blocks of size 2^( 4) =       0.000542825779
  error estimate for blocks of size 2^( 5) =       0.000553235140
  error estimate for blocks of size 2^( 6) =       0.000559703786
  error estimate for blocks of size 2^( 7) =       0.000563084414

      target function =                  N/A
              le_mean =     -22.819226221423
             les_mean =     521.209573652210
             stat err =       0.000554712280
             autocorr =       1.290436253289
              std dev =       0.690580800480
             le_variance =       0.476901841992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786692
                                         uncertainty =       0.002134035686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786692
                                         uncertainty =       0.002134035686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488314367
  error estimate for blocks of size 2^( 2) =       0.000509279264
  error estimate for blocks of size 2^( 3) =       0.000528454650
  error estimate for blocks of size 2^( 4) =       0.000542825779
  error estimate for blocks of size 2^( 5) =       0.000553235140
  error estimate for blocks of size 2^( 6) =       0.000559703786
  error estimate for blocks of size 2^( 7) =       0.000563084414

      target function =                  N/A
              le_mean =     -22.819226221429
             les_mean =     521.209573656574
             stat err =       0.000554712280
             autocorr =       1.290436253456
              std dev =       0.690580800400
             le_variance =       0.476901841881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786747
                                         uncertainty =       0.002134035686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786747
                                         uncertainty =       0.002134035686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488314367
  error estimate for blocks of size 2^( 2) =       0.000509279264
  error estimate for blocks of size 2^( 3) =       0.000528454650
  error estimate for blocks of size 2^( 4) =       0.000542825779
  error estimate for blocks of size 2^( 5) =       0.000553235140
  error estimate for blocks of size 2^( 6) =       0.000559703786
  error estimate for blocks of size 2^( 7) =       0.000563084414

      target function =                  N/A
              le_mean =     -22.819226221426
             les_mean =     521.209573654392
             stat err =       0.000554712280
             autocorr =       1.290436253383
              std dev =       0.690580800440
             le_variance =       0.476901841936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786796
                                         uncertainty =       0.002134035687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477006786796
                                         uncertainty =       0.002134035687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488314367
  error estimate for blocks of size 2^( 2) =       0.000509279264
  error estimate for blocks of size 2^( 3) =       0.000528454650
  error estimate for blocks of size 2^( 4) =       0.000542825779
  error estimate for blocks of size 2^( 5) =       0.000553235140
  error estimate for blocks of size 2^( 6) =       0.000559703786
  error estimate for blocks of size 2^( 7) =       0.000563084414

      target function =                  N/A
              le_mean =     -22.819226221424
             les_mean =     521.209573652483
             stat err =       0.000554712280
             autocorr =       1.290436253306
              std dev =       0.690580800475
             le_variance =       0.476901841985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819226221423        initial
     9.3132e+05     9.3132e+06             5.2127e-10       -22.819226221429  <--
     3.7253e+06     3.7253e+07             1.3032e-10       -22.819226221426
     1.4901e+07     1.4901e+08             3.2579e-11       -22.819226221424

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 4.2983e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142777e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704276e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777643e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388508e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142979e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144538e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267735e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455148e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339392e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833802e-04 3 1  ON 61
ci_63                -9.086880e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772647e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8361
    reference variance = 0.523907
====================================================
  Execution time = 2.5392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9785e-01
  Total weights = 1.963584976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481894949089
                                         uncertainty =       0.003375437797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481894949089
                                         uncertainty =       0.003375437797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490847928
  error estimate for blocks of size 2^( 2) =       0.000511771696
  error estimate for blocks of size 2^( 3) =       0.000531644760
  error estimate for blocks of size 2^( 4) =       0.000547149417
  error estimate for blocks of size 2^( 5) =       0.000556905401
  error estimate for blocks of size 2^( 6) =       0.000562297080
  error estimate for blocks of size 2^( 7) =       0.000565875438

      target function =                  N/A
              le_mean =     -22.819094084824
             les_mean =     521.208901695439
             stat err =       0.000558056834
             autocorr =       1.292596386255
              std dev =       0.694163797145
             le_variance =       0.481863377267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281909408482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819094084722       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819094084751       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819094084752       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819094084797       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 1.436524e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819094084722       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819094084729       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819094084730       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819094084730       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 3.591313e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819094084722       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819094084724       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819094084724       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819094084587       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 8.978283e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0023e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142777e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704276e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630360e-04 3 1  ON 31
ci_33                 7.777618e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388478e-05 3 1  ON 34
ci_36                -8.953250e-04 3 1  ON 35
ci_37                -5.142979e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144535e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404360e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.268094e-06 3 1  ON 44
ci_46                -5.407565e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900421e-04 3 1  ON 49
ci_51                 6.455146e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339395e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754614e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833800e-04 3 1  ON 61
ci_63                -9.086896e-05 3 1  ON 62
ci_64                -6.291693e-04 3 1  ON 63
ci_65                -4.772649e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729467e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573417e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.777
    reference variance = 0.313552
====================================================
  Execution time = 2.4864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9224e-01
  Total weights = 1.9635e+06
  Execution time = 3.6025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630820253
                                         uncertainty =       0.002300549132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630820253
                                         uncertainty =       0.002300549132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487629334
  error estimate for blocks of size 2^( 2) =       0.000508667845
  error estimate for blocks of size 2^( 3) =       0.000527859353
  error estimate for blocks of size 2^( 4) =       0.000542539690
  error estimate for blocks of size 2^( 5) =       0.000550672434
  error estimate for blocks of size 2^( 6) =       0.000557605162
  error estimate for blocks of size 2^( 7) =       0.000562586100

      target function =                  N/A
              le_mean =     -22.819835034670
             les_mean =     521.237111977670
             stat err =       0.000553350847
             autocorr =       1.287720205899
              std dev =       0.689612017840
             le_variance =       0.475564735150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630819457
                                         uncertainty =       0.002300548959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630819457
                                         uncertainty =       0.002300548959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487629334
  error estimate for blocks of size 2^( 2) =       0.000508667845
  error estimate for blocks of size 2^( 3) =       0.000527859353
  error estimate for blocks of size 2^( 4) =       0.000542539689
  error estimate for blocks of size 2^( 5) =       0.000550672433
  error estimate for blocks of size 2^( 6) =       0.000557605162
  error estimate for blocks of size 2^( 7) =       0.000562586100

      target function =                  N/A
              le_mean =     -22.819835034668
             les_mean =     521.237111973825
             stat err =       0.000553350846
             autocorr =       1.287720206350
              std dev =       0.689612017265
             le_variance =       0.475564734356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630819855
                                         uncertainty =       0.002300549046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630819855
                                         uncertainty =       0.002300549046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487629334
  error estimate for blocks of size 2^( 2) =       0.000508667845
  error estimate for blocks of size 2^( 3) =       0.000527859353
  error estimate for blocks of size 2^( 4) =       0.000542539690
  error estimate for blocks of size 2^( 5) =       0.000550672434
  error estimate for blocks of size 2^( 6) =       0.000557605162
  error estimate for blocks of size 2^( 7) =       0.000562586100

      target function =                  N/A
              le_mean =     -22.819835034669
             les_mean =     521.237111975747
             stat err =       0.000553350846
             autocorr =       1.287720206133
              std dev =       0.689612017553
             le_variance =       0.475564734753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630820203
                                         uncertainty =       0.002300549121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475630820203
                                         uncertainty =       0.002300549121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487629334
  error estimate for blocks of size 2^( 2) =       0.000508667845
  error estimate for blocks of size 2^( 3) =       0.000527859353
  error estimate for blocks of size 2^( 4) =       0.000542539690
  error estimate for blocks of size 2^( 5) =       0.000550672434
  error estimate for blocks of size 2^( 6) =       0.000557605162
  error estimate for blocks of size 2^( 7) =       0.000562586100

      target function =                  N/A
              le_mean =     -22.819835034669
             les_mean =     521.237111977430
             stat err =       0.000553350846
             autocorr =       1.287720205927
              std dev =       0.689612017804
             le_variance =       0.475564735100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819835034670        initial  <--
     2.3283e+05     2.3283e+06             1.4365e-09       -22.819835034668
     9.3132e+05     9.3132e+06             3.5913e-10       -22.819835034669
     3.7253e+06     3.7253e+07             8.9783e-11       -22.819835034669

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0874
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142777e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704276e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777643e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388508e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142979e-04 3 1  ON 36
ci_38                -2.635245e-04 3 1  ON 37
ci_39                 4.144538e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267735e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455148e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339392e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833802e-04 3 1  ON 61
ci_63                -9.086880e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772647e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7415
    reference variance = 0.59092
====================================================
  Execution time = 2.5547e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9312e-01
  Total weights = 1.963804779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477872749313
                                         uncertainty =       0.002529602443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477872749313
                                         uncertainty =       0.002529602443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488793678
  error estimate for blocks of size 2^( 2) =       0.000509160873
  error estimate for blocks of size 2^( 3) =       0.000528825306
  error estimate for blocks of size 2^( 4) =       0.000543526256
  error estimate for blocks of size 2^( 5) =       0.000556190628
  error estimate for blocks of size 2^( 6) =       0.000562303472
  error estimate for blocks of size 2^( 7) =       0.000566701654

      target function =                  N/A
              le_mean =     -22.820111439319
             les_mean =     521.250607029391
             stat err =       0.000557180503
             autocorr =       1.299393413690
              std dev =       0.691258649024
             le_variance =       0.477838519851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282011143932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820111439268       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820111439271       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820111439272       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820111438057       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 1.432225e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820111439268       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820111439269       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820111439269       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820111439269       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+06 is 3.580563e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820111439268       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820111439268       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820111439268       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820111439268       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+07 is 8.951428e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0085e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704276e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777641e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388509e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142979e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144538e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267745e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900418e-04 3 1  ON 49
ci_51                 6.455148e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339392e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833802e-04 3 1  ON 61
ci_63                -9.086883e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772648e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7638
    reference variance = 0.318025
====================================================
  Execution time = 2.5086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9193e-01
  Total weights = 1.9636e+06
  Execution time = 3.5821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437848
                                         uncertainty =       0.002372384918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437848
                                         uncertainty =       0.002372384918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487125606
  error estimate for blocks of size 2^( 2) =       0.000508573069
  error estimate for blocks of size 2^( 3) =       0.000528404884
  error estimate for blocks of size 2^( 4) =       0.000542874531
  error estimate for blocks of size 2^( 5) =       0.000553160275
  error estimate for blocks of size 2^( 6) =       0.000556181140
  error estimate for blocks of size 2^( 7) =       0.000561459578

      target function =                  N/A
              le_mean =     -22.819915220788
             les_mean =     521.240458533891
             stat err =       0.000553418881
             autocorr =       1.290702126012
              std dev =       0.688899638757
             le_variance =       0.474582712280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437832
                                         uncertainty =       0.002372384925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437832
                                         uncertainty =       0.002372384925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487125606
  error estimate for blocks of size 2^( 2) =       0.000508573069
  error estimate for blocks of size 2^( 3) =       0.000528404884
  error estimate for blocks of size 2^( 4) =       0.000542874531
  error estimate for blocks of size 2^( 5) =       0.000553160275
  error estimate for blocks of size 2^( 6) =       0.000556181140
  error estimate for blocks of size 2^( 7) =       0.000561459578

      target function =                  N/A
              le_mean =     -22.819915220790
             les_mean =     521.240458534961
             stat err =       0.000553418881
             autocorr =       1.290702126056
              std dev =       0.688899638746
             le_variance =       0.474582712264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437840
                                         uncertainty =       0.002372384922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437840
                                         uncertainty =       0.002372384922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487125606
  error estimate for blocks of size 2^( 2) =       0.000508573069
  error estimate for blocks of size 2^( 3) =       0.000528404884
  error estimate for blocks of size 2^( 4) =       0.000542874531
  error estimate for blocks of size 2^( 5) =       0.000553160275
  error estimate for blocks of size 2^( 6) =       0.000556181140
  error estimate for blocks of size 2^( 7) =       0.000561459578

      target function =                  N/A
              le_mean =     -22.819915220789
             les_mean =     521.240458534426
             stat err =       0.000553418881
             autocorr =       1.290702126037
              std dev =       0.688899638752
             le_variance =       0.474582712272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437847
                                         uncertainty =       0.002372384919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474539437847
                                         uncertainty =       0.002372384919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487125606
  error estimate for blocks of size 2^( 2) =       0.000508573069
  error estimate for blocks of size 2^( 3) =       0.000528404884
  error estimate for blocks of size 2^( 4) =       0.000542874531
  error estimate for blocks of size 2^( 5) =       0.000553160275
  error estimate for blocks of size 2^( 6) =       0.000556181140
  error estimate for blocks of size 2^( 7) =       0.000561459578

      target function =                  N/A
              le_mean =     -22.819915220789
             les_mean =     521.240458533957
             stat err =       0.000553418881
             autocorr =       1.290702126024
              std dev =       0.688899638757
             le_variance =       0.474582712279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819915220788        initial
     2.3283e+06     2.3283e+07             1.4322e-10       -22.819915220790  <--
     9.3132e+06     9.3132e+07             3.5806e-11       -22.819915220789
     3.7253e+07     3.7253e+08             8.9514e-12       -22.819915220789

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 4.3121e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704275e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630364e-04 3 1  ON 31
ci_33                 7.777638e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388512e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142980e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144537e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267774e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339392e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754613e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086894e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772648e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7069
    reference variance = 0.406006
====================================================
  Execution time = 2.6523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8481e-01
  Total weights = 1.963656185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5506e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470214819179
                                         uncertainty =       0.002311056029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470214819179
                                         uncertainty =       0.002311056029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484937792
  error estimate for blocks of size 2^( 2) =       0.000505885925
  error estimate for blocks of size 2^( 3) =       0.000525965743
  error estimate for blocks of size 2^( 4) =       0.000541668699
  error estimate for blocks of size 2^( 5) =       0.000551420790
  error estimate for blocks of size 2^( 6) =       0.000557072120
  error estimate for blocks of size 2^( 7) =       0.000560549664

      target function =                  N/A
              le_mean =     -22.818858813013
             les_mean =     521.185127516668
             stat err =       0.000552677818
             autocorr =       1.298888906970
              std dev =       0.685805602150
             le_variance =       0.470329323941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281885881301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818858812923       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818858812936       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818858812935       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818858812615       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 1.158725e-09

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818858812923       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818858812926       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818858812926       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818858812926       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 2.896814e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818858812923       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818858812924       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818858812924       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818858812924       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+06 is 7.242041e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1079e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704275e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777636e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388496e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142981e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144537e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404360e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267795e-06 3 1  ON 44
ci_46                -5.407563e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339393e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754613e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086890e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772648e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7998
    reference variance = 0.936736
====================================================
  Execution time = 2.6970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9403e-01
  Total weights = 1.9636e+06
  Execution time = 3.5921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213845
                                         uncertainty =       0.001801140592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213845
                                         uncertainty =       0.001801140592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488926607
  error estimate for blocks of size 2^( 2) =       0.000509605442
  error estimate for blocks of size 2^( 3) =       0.000529402769
  error estimate for blocks of size 2^( 4) =       0.000543660973
  error estimate for blocks of size 2^( 5) =       0.000552486155
  error estimate for blocks of size 2^( 6) =       0.000556695950
  error estimate for blocks of size 2^( 7) =       0.000559401407

      target function =                  N/A
              le_mean =     -22.820824345733
             les_mean =     521.284057096998
             stat err =       0.000553061121
             autocorr =       1.279554877008
              std dev =       0.691446638040
             le_variance =       0.478098453256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213699
                                         uncertainty =       0.001801140594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213699
                                         uncertainty =       0.001801140594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488926607
  error estimate for blocks of size 2^( 2) =       0.000509605442
  error estimate for blocks of size 2^( 3) =       0.000529402769
  error estimate for blocks of size 2^( 4) =       0.000543660973
  error estimate for blocks of size 2^( 5) =       0.000552486155
  error estimate for blocks of size 2^( 6) =       0.000556695950
  error estimate for blocks of size 2^( 7) =       0.000559401407

      target function =                  N/A
              le_mean =     -22.820824345727
             les_mean =     521.284057096833
             stat err =       0.000553061121
             autocorr =       1.279554877312
              std dev =       0.691446637935
             le_variance =       0.478098453112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213772
                                         uncertainty =       0.001801140593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213772
                                         uncertainty =       0.001801140593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488926607
  error estimate for blocks of size 2^( 2) =       0.000509605442
  error estimate for blocks of size 2^( 3) =       0.000529402769
  error estimate for blocks of size 2^( 4) =       0.000543660973
  error estimate for blocks of size 2^( 5) =       0.000552486155
  error estimate for blocks of size 2^( 6) =       0.000556695950
  error estimate for blocks of size 2^( 7) =       0.000559401407

      target function =                  N/A
              le_mean =     -22.820824345730
             les_mean =     521.284057096916
             stat err =       0.000553061121
             autocorr =       1.279554877164
              std dev =       0.691446637987
             le_variance =       0.478098453184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213836
                                         uncertainty =       0.001801140592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478007213836
                                         uncertainty =       0.001801140592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488926607
  error estimate for blocks of size 2^( 2) =       0.000509605442
  error estimate for blocks of size 2^( 3) =       0.000529402769
  error estimate for blocks of size 2^( 4) =       0.000543660973
  error estimate for blocks of size 2^( 5) =       0.000552486155
  error estimate for blocks of size 2^( 6) =       0.000556695950
  error estimate for blocks of size 2^( 7) =       0.000559401407

      target function =                  N/A
              le_mean =     -22.820824345732
             les_mean =     521.284057096988
             stat err =       0.000553061121
             autocorr =       1.279554877022
              std dev =       0.691446638033
             le_variance =       0.478098453247


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820824345733        initial  <--
     5.8208e+05     5.8208e+06             1.1587e-09       -22.820824345727
     2.3283e+06     2.3283e+07             2.8968e-10       -22.820824345730
     9.3132e+06     9.3132e+07             7.2420e-11       -22.820824345732

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9766
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704275e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630364e-04 3 1  ON 31
ci_33                 7.777638e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388512e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142980e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144537e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267774e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339392e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754613e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086894e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772648e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8115
    reference variance = 0.374547
====================================================
  Execution time = 2.5434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9738e-01
  Total weights = 1.963793703e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481110130402
                                         uncertainty =       0.003173644812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481110130402
                                         uncertainty =       0.003173644812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490465607
  error estimate for blocks of size 2^( 2) =       0.000511133839
  error estimate for blocks of size 2^( 3) =       0.000530209487
  error estimate for blocks of size 2^( 4) =       0.000544708010
  error estimate for blocks of size 2^( 5) =       0.000554405127
  error estimate for blocks of size 2^( 6) =       0.000560044218
  error estimate for blocks of size 2^( 7) =       0.000564110135

      target function =                  N/A
              le_mean =     -22.820051928335
             les_mean =     521.252147933523
             stat err =       0.000555816873
             autocorr =       1.284240421848
              std dev =       0.693623113331
             le_variance =       0.481113023347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282005192834e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820051928239       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820051928241       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820051928241       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820051928098       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 1.180667e-10

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820051928239       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820051928240       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820051928240       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820051928240       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+07 is 2.951670e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820051928239       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820051928240       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820051928240       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820051928240       residual = 1.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+07 is 7.379141e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9987e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704275e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777638e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388510e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142980e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144537e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057160e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267781e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364260e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339393e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754613e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086894e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772648e-04 3 1  ON 64
ci_66                 1.658823e-04 3 1  ON 65
ci_67                -9.729464e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7955
    reference variance = 0.355651
====================================================
  Execution time = 2.5031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9592e-01
  Total weights = 1.9636e+06
  Execution time = 3.5977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625643
                                         uncertainty =       0.003291956691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625643
                                         uncertainty =       0.003291956691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489360858
  error estimate for blocks of size 2^( 2) =       0.000510426505
  error estimate for blocks of size 2^( 3) =       0.000530417874
  error estimate for blocks of size 2^( 4) =       0.000546317888
  error estimate for blocks of size 2^( 5) =       0.000556820296
  error estimate for blocks of size 2^( 6) =       0.000561695210
  error estimate for blocks of size 2^( 7) =       0.000567697626

      target function =                  N/A
              le_mean =     -22.819490788910
             les_mean =     521.225079184768
             stat err =       0.000558132755
             autocorr =       1.300818077466
              std dev =       0.692060761721
             le_variance =       0.478948097914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625637
                                         uncertainty =       0.003291956698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625637
                                         uncertainty =       0.003291956698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489360858
  error estimate for blocks of size 2^( 2) =       0.000510426505
  error estimate for blocks of size 2^( 3) =       0.000530417874
  error estimate for blocks of size 2^( 4) =       0.000546317888
  error estimate for blocks of size 2^( 5) =       0.000556820296
  error estimate for blocks of size 2^( 6) =       0.000561695210
  error estimate for blocks of size 2^( 7) =       0.000567697626

      target function =                  N/A
              le_mean =     -22.819490788911
             les_mean =     521.225079184796
             stat err =       0.000558132755
             autocorr =       1.300818077517
              std dev =       0.692060761717
             le_variance =       0.478948097909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625640
                                         uncertainty =       0.003291956694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625640
                                         uncertainty =       0.003291956694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489360858
  error estimate for blocks of size 2^( 2) =       0.000510426505
  error estimate for blocks of size 2^( 3) =       0.000530417874
  error estimate for blocks of size 2^( 4) =       0.000546317888
  error estimate for blocks of size 2^( 5) =       0.000556820296
  error estimate for blocks of size 2^( 6) =       0.000561695210
  error estimate for blocks of size 2^( 7) =       0.000567697626

      target function =                  N/A
              le_mean =     -22.819490788910
             les_mean =     521.225079184782
             stat err =       0.000558132755
             autocorr =       1.300818077487
              std dev =       0.692060761719
             le_variance =       0.478948097911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625642
                                         uncertainty =       0.003291956691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478934625642
                                         uncertainty =       0.003291956691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489360858
  error estimate for blocks of size 2^( 2) =       0.000510426505
  error estimate for blocks of size 2^( 3) =       0.000530417874
  error estimate for blocks of size 2^( 4) =       0.000546317888
  error estimate for blocks of size 2^( 5) =       0.000556820296
  error estimate for blocks of size 2^( 6) =       0.000561695210
  error estimate for blocks of size 2^( 7) =       0.000567697626

      target function =                  N/A
              le_mean =     -22.819490788910
             les_mean =     521.225079184770
             stat err =       0.000558132755
             autocorr =       1.300818077480
              std dev =       0.692060761721
             le_variance =       0.478948097913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819490788910        initial
     5.8208e+06     5.8208e+07             1.1807e-10       -22.819490788911  <--
     2.3283e+07     2.3283e+08             2.9517e-11       -22.819490788910
     9.3132e+07     9.3132e+08             7.3791e-12       -22.819490788910

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 4.3025e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093875e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704275e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777639e-05 3 1  ON 32
ci_34                 8.967964e-04 3 1  ON 33
ci_35                -2.388506e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142981e-04 3 1  ON 36
ci_38                -2.635246e-04 3 1  ON 37
ci_39                 4.144537e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267802e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339393e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754613e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086894e-05 3 1  ON 62
ci_64                -6.291696e-04 3 1  ON 63
ci_65                -4.772648e-04 3 1  ON 64
ci_66                 1.658822e-04 3 1  ON 65
ci_67                -9.729463e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573419e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8796
    reference variance = 0.463217
====================================================
  Execution time = 2.5609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9580e-01
  Total weights = 1.963686068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478883980705
                                         uncertainty =       0.002377475417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478883980705
                                         uncertainty =       0.002377475417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489354354
  error estimate for blocks of size 2^( 2) =       0.000510520713
  error estimate for blocks of size 2^( 3) =       0.000530155476
  error estimate for blocks of size 2^( 4) =       0.000544472219
  error estimate for blocks of size 2^( 5) =       0.000554992743
  error estimate for blocks of size 2^( 6) =       0.000560854106
  error estimate for blocks of size 2^( 7) =       0.000564276520

      target function =                  N/A
              le_mean =     -22.819947222262
             les_mean =     521.245790163878
             stat err =       0.000556148897
             autocorr =       1.291621444814
              std dev =       0.692051564160
             le_variance =       0.478935367456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281994722226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819947222183       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819947222186       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819947222186       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819947222186       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 2.606747e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819947222183       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819947222184       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819947222184       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819947222184       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 6.516869e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819947222183       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819947222183       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819947222183       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819947222509       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+07 is 1.629218e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0244e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704275e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630363e-04 3 1  ON 31
ci_33                 7.777638e-05 3 1  ON 32
ci_34                 8.967963e-04 3 1  ON 33
ci_35                -2.388506e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142981e-04 3 1  ON 36
ci_38                -2.635247e-04 3 1  ON 37
ci_39                 4.144537e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267792e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900419e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339394e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086897e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772647e-04 3 1  ON 64
ci_66                 1.658822e-04 3 1  ON 65
ci_67                -9.729463e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573419e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8493
    reference variance = 0.283215
====================================================
  Execution time = 2.4934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9900e-01
  Total weights = 1.9636e+06
  Execution time = 3.5727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476081
                                         uncertainty =       0.002292687020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476081
                                         uncertainty =       0.002292687020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489052204
  error estimate for blocks of size 2^( 2) =       0.000509139274
  error estimate for blocks of size 2^( 3) =       0.000528796808
  error estimate for blocks of size 2^( 4) =       0.000542920293
  error estimate for blocks of size 2^( 5) =       0.000552017470
  error estimate for blocks of size 2^( 6) =       0.000555668123
  error estimate for blocks of size 2^( 7) =       0.000557065254

      target function =                  N/A
              le_mean =     -22.819986474496
             les_mean =     521.250778905514
             stat err =       0.000551917785
             autocorr =       1.273615503820
              std dev =       0.691624259747
             le_variance =       0.478344116671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476048
                                         uncertainty =       0.002292687021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476048
                                         uncertainty =       0.002292687021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489052204
  error estimate for blocks of size 2^( 2) =       0.000509139274
  error estimate for blocks of size 2^( 3) =       0.000528796808
  error estimate for blocks of size 2^( 4) =       0.000542920293
  error estimate for blocks of size 2^( 5) =       0.000552017470
  error estimate for blocks of size 2^( 6) =       0.000555668123
  error estimate for blocks of size 2^( 7) =       0.000557065254

      target function =                  N/A
              le_mean =     -22.819986474498
             les_mean =     521.250778905458
             stat err =       0.000551917785
             autocorr =       1.273615503914
              std dev =       0.691624259724
             le_variance =       0.478344116639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476065
                                         uncertainty =       0.002292687021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476065
                                         uncertainty =       0.002292687021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489052204
  error estimate for blocks of size 2^( 2) =       0.000509139274
  error estimate for blocks of size 2^( 3) =       0.000528796808
  error estimate for blocks of size 2^( 4) =       0.000542920293
  error estimate for blocks of size 2^( 5) =       0.000552017470
  error estimate for blocks of size 2^( 6) =       0.000555668123
  error estimate for blocks of size 2^( 7) =       0.000557065254

      target function =                  N/A
              le_mean =     -22.819986474497
             les_mean =     521.250778905486
             stat err =       0.000551917785
             autocorr =       1.273615503870
              std dev =       0.691624259735
             le_variance =       0.478344116655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476079
                                         uncertainty =       0.002292687020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478332476079
                                         uncertainty =       0.002292687020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489052204
  error estimate for blocks of size 2^( 2) =       0.000509139274
  error estimate for blocks of size 2^( 3) =       0.000528796808
  error estimate for blocks of size 2^( 4) =       0.000542920293
  error estimate for blocks of size 2^( 5) =       0.000552017470
  error estimate for blocks of size 2^( 6) =       0.000555668123
  error estimate for blocks of size 2^( 7) =       0.000557065254

      target function =                  N/A
              le_mean =     -22.819986474496
             les_mean =     521.250778905511
             stat err =       0.000551917785
             autocorr =       1.273615503837
              std dev =       0.691624259746
             le_variance =       0.478344116669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819986474496        initial
     1.4552e+06     1.4552e+07             2.6067e-10       -22.819986474498  <--
     5.8208e+06     5.8208e+07             6.5169e-11       -22.819986474497
     2.3283e+07     2.3283e+08             1.6292e-11       -22.819986474496

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 4.2812e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594195e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395778e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558230e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704274e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630361e-04 3 1  ON 31
ci_33                 7.777637e-05 3 1  ON 32
ci_34                 8.967962e-04 3 1  ON 33
ci_35                -2.388503e-05 3 1  ON 34
ci_36                -8.953251e-04 3 1  ON 35
ci_37                -5.142982e-04 3 1  ON 36
ci_38                -2.635248e-04 3 1  ON 37
ci_39                 4.144536e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404361e-04 3 1  ON 40
ci_42                 4.057162e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267764e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364261e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900420e-04 3 1  ON 49
ci_51                 6.455147e-04 3 1  ON 50
ci_52                 2.153046e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339395e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754612e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833800e-04 3 1  ON 61
ci_63                -9.086905e-05 3 1  ON 62
ci_64                -6.291698e-04 3 1  ON 63
ci_65                -4.772647e-04 3 1  ON 64
ci_66                 1.658820e-04 3 1  ON 65
ci_67                -9.729463e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8063
    reference variance = 0.353066
====================================================
  Execution time = 2.5522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -2.2821e+01
  VMC Evar = 4.9339e-01
  Total weights = 1.963423999e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478822383787
                                         uncertainty =       0.003019843782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478822383787
                                         uncertainty =       0.003019843782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489321420
  error estimate for blocks of size 2^( 2) =       0.000510269165
  error estimate for blocks of size 2^( 3) =       0.000530417981
  error estimate for blocks of size 2^( 4) =       0.000545145714
  error estimate for blocks of size 2^( 5) =       0.000554022248
  error estimate for blocks of size 2^( 6) =       0.000560486966
  error estimate for blocks of size 2^( 7) =       0.000565908483

      target function =                  N/A
              le_mean =     -22.821300192195
             les_mean =     521.305128538513
             stat err =       0.000556390853
             autocorr =       1.292919565099
              std dev =       0.692004988735
             le_variance =       0.478870904434


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282130019219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.821300192119       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.821300192135       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.821300192135       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.821300192135       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 1.175502e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.821300192119       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.821300192123       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.821300192123       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.821300192356       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 2.938757e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.821300192119       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.821300192120       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.821300192120       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.821300192120       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 7.346893e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0081e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555474e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112259e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704273e-04 3 1  ON 29
ci_31                 1.054091e-03 3 1  ON 30
ci_32                 2.630360e-04 3 1  ON 31
ci_33                 7.777629e-05 3 1  ON 32
ci_34                 8.967962e-04 3 1  ON 33
ci_35                -2.388481e-05 3 1  ON 34
ci_36                -8.953252e-04 3 1  ON 35
ci_37                -5.142985e-04 3 1  ON 36
ci_38                -2.635249e-04 3 1  ON 37
ci_39                 4.144535e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404364e-04 3 1  ON 40
ci_42                 4.057161e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267797e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364259e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900421e-04 3 1  ON 49
ci_51                 6.455146e-04 3 1  ON 50
ci_52                 2.153047e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128946e-03 3 1  ON 55
ci_57                 7.339396e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050381e-03 3 1  ON 58
ci_60                 4.754613e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833801e-04 3 1  ON 61
ci_63                -9.086897e-05 3 1  ON 62
ci_64                -6.291698e-04 3 1  ON 63
ci_65                -4.772647e-04 3 1  ON 64
ci_66                 1.658820e-04 3 1  ON 65
ci_67                -9.729462e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8341
    reference variance = 0.357103
====================================================
  Execution time = 2.5068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9995e-01
  Total weights = 1.9636e+06
  Execution time = 3.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638653
                                         uncertainty =       0.003023593112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638653
                                         uncertainty =       0.003023593112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491426032
  error estimate for blocks of size 2^( 2) =       0.000511750835
  error estimate for blocks of size 2^( 3) =       0.000531718537
  error estimate for blocks of size 2^( 4) =       0.000547424613
  error estimate for blocks of size 2^( 5) =       0.000556808948
  error estimate for blocks of size 2^( 6) =       0.000562852811
  error estimate for blocks of size 2^( 7) =       0.000564117521

      target function =                  N/A
              le_mean =     -22.819866229052
             les_mean =     521.246246972704
             stat err =       0.000557800973
             autocorr =       1.288374792238
              std dev =       0.694981358940
             le_variance =       0.482999089274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638483
                                         uncertainty =       0.003023593125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638483
                                         uncertainty =       0.003023593125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491426032
  error estimate for blocks of size 2^( 2) =       0.000511750835
  error estimate for blocks of size 2^( 3) =       0.000531718537
  error estimate for blocks of size 2^( 4) =       0.000547424613
  error estimate for blocks of size 2^( 5) =       0.000556808948
  error estimate for blocks of size 2^( 6) =       0.000562852811
  error estimate for blocks of size 2^( 7) =       0.000564117521

      target function =                  N/A
              le_mean =     -22.819866229054
             les_mean =     521.246246972198
             stat err =       0.000557800973
             autocorr =       1.288374792522
              std dev =       0.694981358816
             le_variance =       0.482999089102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638568
                                         uncertainty =       0.003023593118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638568
                                         uncertainty =       0.003023593118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491426032
  error estimate for blocks of size 2^( 2) =       0.000511750835
  error estimate for blocks of size 2^( 3) =       0.000531718537
  error estimate for blocks of size 2^( 4) =       0.000547424613
  error estimate for blocks of size 2^( 5) =       0.000556808948
  error estimate for blocks of size 2^( 6) =       0.000562852811
  error estimate for blocks of size 2^( 7) =       0.000564117521

      target function =                  N/A
              le_mean =     -22.819866229053
             les_mean =     521.246246972451
             stat err =       0.000557800973
             autocorr =       1.288374792378
              std dev =       0.694981358878
             le_variance =       0.482999089188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638642
                                         uncertainty =       0.003023593113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482959638642
                                         uncertainty =       0.003023593113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491426032
  error estimate for blocks of size 2^( 2) =       0.000511750835
  error estimate for blocks of size 2^( 3) =       0.000531718537
  error estimate for blocks of size 2^( 4) =       0.000547424613
  error estimate for blocks of size 2^( 5) =       0.000556808948
  error estimate for blocks of size 2^( 6) =       0.000562852811
  error estimate for blocks of size 2^( 7) =       0.000564117521

      target function =                  N/A
              le_mean =     -22.819866229052
             les_mean =     521.246246972673
             stat err =       0.000557800973
             autocorr =       1.288374792258
              std dev =       0.694981358932
             le_variance =       0.482999089263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819866229052        initial
     3.6380e+05     3.6380e+06             1.1755e-09       -22.819866229054  <--
     1.4552e+06     1.4552e+07             2.9388e-10       -22.819866229053
     5.8208e+06     5.8208e+07             7.3469e-11       -22.819866229052

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 4.2974e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555473e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704271e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630356e-04 3 1  ON 31
ci_33                 7.777605e-05 3 1  ON 32
ci_34                 8.967962e-04 3 1  ON 33
ci_35                -2.388412e-05 3 1  ON 34
ci_36                -8.953256e-04 3 1  ON 35
ci_37                -5.142992e-04 3 1  ON 36
ci_38                -2.635252e-04 3 1  ON 37
ci_39                 4.144533e-04 3 1  ON 38
ci_40                -1.372555e-03 3 1  ON 39
ci_41                 5.404373e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267894e-06 3 1  ON 44
ci_46                -5.407563e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364254e-04 3 1  ON 47
ci_49                -1.402275e-03 3 1  ON 48
ci_50                -4.900423e-04 3 1  ON 49
ci_51                 6.455143e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128945e-03 3 1  ON 55
ci_57                 7.339397e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754618e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833802e-04 3 1  ON 61
ci_63                -9.086875e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772649e-04 3 1  ON 64
ci_66                 1.658818e-04 3 1  ON 65
ci_67                -9.729458e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7537
    reference variance = 0.511301
====================================================
  Execution time = 2.5441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9598e-01
  Total weights = 1.963493541e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479656647458
                                         uncertainty =       0.002499495651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479656647458
                                         uncertainty =       0.002499495651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489680111
  error estimate for blocks of size 2^( 2) =       0.000510684079
  error estimate for blocks of size 2^( 3) =       0.000530617672
  error estimate for blocks of size 2^( 4) =       0.000546398157
  error estimate for blocks of size 2^( 5) =       0.000555488981
  error estimate for blocks of size 2^( 6) =       0.000559656736
  error estimate for blocks of size 2^( 7) =       0.000563934239

      target function =                  N/A
              le_mean =     -22.819773174434
             les_mean =     521.238027975832
             stat err =       0.000556369528
             autocorr =       1.290927175534
              std dev =       0.692512253573
             le_variance =       0.479573221349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281977317443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819773174404       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819773174427       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819773174430       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819773174430       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+04 is 5.496069e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819773174404       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819773174410       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819773174411       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819773174411       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 1.374021e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819773174404       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819773174406       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819773174406       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819773174406       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 3.435054e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9978e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555473e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118813e-02 3 1  ON 8
ci_10                -1.142777e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112261e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440798e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704269e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630351e-04 3 1  ON 31
ci_33                 7.777636e-05 3 1  ON 32
ci_34                 8.967957e-04 3 1  ON 33
ci_35                -2.388416e-05 3 1  ON 34
ci_36                -8.953258e-04 3 1  ON 35
ci_37                -5.142995e-04 3 1  ON 36
ci_38                -2.635259e-04 3 1  ON 37
ci_39                 4.144532e-04 3 1  ON 38
ci_40                -1.372555e-03 3 1  ON 39
ci_41                 5.404368e-04 3 1  ON 40
ci_42                 4.057163e-04 3 1  ON 41
ci_43                -2.414410e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.268319e-06 3 1  ON 44
ci_46                -5.407564e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364251e-04 3 1  ON 47
ci_49                -1.402275e-03 3 1  ON 48
ci_50                -4.900423e-04 3 1  ON 49
ci_51                 6.455137e-04 3 1  ON 50
ci_52                 2.153049e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409372e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128945e-03 3 1  ON 55
ci_57                 7.339409e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754626e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833800e-04 3 1  ON 61
ci_63                -9.087012e-05 3 1  ON 62
ci_64                -6.291694e-04 3 1  ON 63
ci_65                -4.772649e-04 3 1  ON 64
ci_66                 1.658818e-04 3 1  ON 65
ci_67                -9.729458e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8527
    reference variance = 0.535828
====================================================
  Execution time = 2.4966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9591e-01
  Total weights = 1.9638e+06
  Execution time = 4.0855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208831
                                         uncertainty =       0.002537198798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208831
                                         uncertainty =       0.002537198798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488916607
  error estimate for blocks of size 2^( 2) =       0.000509594690
  error estimate for blocks of size 2^( 3) =       0.000528833043
  error estimate for blocks of size 2^( 4) =       0.000544088957
  error estimate for blocks of size 2^( 5) =       0.000553978908
  error estimate for blocks of size 2^( 6) =       0.000559741904
  error estimate for blocks of size 2^( 7) =       0.000565365790

      target function =                  N/A
              le_mean =     -22.819673757623
             les_mean =     521.233419703477
             stat err =       0.000555793890
             autocorr =       1.292283972064
              std dev =       0.691432496137
             le_variance =       0.478078896715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208532
                                         uncertainty =       0.002537198849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208532
                                         uncertainty =       0.002537198849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488916607
  error estimate for blocks of size 2^( 2) =       0.000509594690
  error estimate for blocks of size 2^( 3) =       0.000528833043
  error estimate for blocks of size 2^( 4) =       0.000544088957
  error estimate for blocks of size 2^( 5) =       0.000553978908
  error estimate for blocks of size 2^( 6) =       0.000559741904
  error estimate for blocks of size 2^( 7) =       0.000565365791

      target function =                  N/A
              le_mean =     -22.819673757591
             les_mean =     521.233419711689
             stat err =       0.000555793890
             autocorr =       1.292283973629
              std dev =       0.691432495920
             le_variance =       0.478078896414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208682
                                         uncertainty =       0.002537198823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208682
                                         uncertainty =       0.002537198823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488916607
  error estimate for blocks of size 2^( 2) =       0.000509594690
  error estimate for blocks of size 2^( 3) =       0.000528833043
  error estimate for blocks of size 2^( 4) =       0.000544088957
  error estimate for blocks of size 2^( 5) =       0.000553978908
  error estimate for blocks of size 2^( 6) =       0.000559741904
  error estimate for blocks of size 2^( 7) =       0.000565365791

      target function =                  N/A
              le_mean =     -22.819673757607
             les_mean =     521.233419707583
             stat err =       0.000555793890
             autocorr =       1.292283972839
              std dev =       0.691432496028
             le_variance =       0.478078896564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208812
                                         uncertainty =       0.002537198801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478125208812
                                         uncertainty =       0.002537198801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488916607
  error estimate for blocks of size 2^( 2) =       0.000509594690
  error estimate for blocks of size 2^( 3) =       0.000528833043
  error estimate for blocks of size 2^( 4) =       0.000544088957
  error estimate for blocks of size 2^( 5) =       0.000553978908
  error estimate for blocks of size 2^( 6) =       0.000559741904
  error estimate for blocks of size 2^( 7) =       0.000565365790

      target function =                  N/A
              le_mean =     -22.819673757621
             les_mean =     521.233419703991
             stat err =       0.000555793890
             autocorr =       1.292283972164
              std dev =       0.691432496124
             le_variance =       0.478078896696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819673757623        initial  <--
     9.0949e+04     9.0949e+05             5.4961e-09       -22.819673757591
     3.6380e+05     3.6380e+06             1.3740e-09       -22.819673757607
     1.4552e+06     1.4552e+07             3.4351e-10       -22.819673757621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6246
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555473e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704271e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630356e-04 3 1  ON 31
ci_33                 7.777605e-05 3 1  ON 32
ci_34                 8.967962e-04 3 1  ON 33
ci_35                -2.388412e-05 3 1  ON 34
ci_36                -8.953256e-04 3 1  ON 35
ci_37                -5.142992e-04 3 1  ON 36
ci_38                -2.635252e-04 3 1  ON 37
ci_39                 4.144533e-04 3 1  ON 38
ci_40                -1.372555e-03 3 1  ON 39
ci_41                 5.404373e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267894e-06 3 1  ON 44
ci_46                -5.407563e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364254e-04 3 1  ON 47
ci_49                -1.402275e-03 3 1  ON 48
ci_50                -4.900423e-04 3 1  ON 49
ci_51                 6.455143e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128945e-03 3 1  ON 55
ci_57                 7.339397e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754618e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833802e-04 3 1  ON 61
ci_63                -9.086875e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772649e-04 3 1  ON 64
ci_66                 1.658818e-04 3 1  ON 65
ci_67                -9.729458e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.825
    reference variance = 0.279353
====================================================
  Execution time = 2.5449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9615e-01
  Total weights = 1.963800130e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477334732076
                                         uncertainty =       0.002487112115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477334732076
                                         uncertainty =       0.002487112115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488576562
  error estimate for blocks of size 2^( 2) =       0.000509608177
  error estimate for blocks of size 2^( 3) =       0.000529286972
  error estimate for blocks of size 2^( 4) =       0.000545120254
  error estimate for blocks of size 2^( 5) =       0.000553844163
  error estimate for blocks of size 2^( 6) =       0.000557449863
  error estimate for blocks of size 2^( 7) =       0.000559389967

      target function =                  N/A
              le_mean =     -22.820211329783
             les_mean =     521.258192999445
             stat err =       0.000553951062
             autocorr =       1.285516157357
              std dev =       0.690951600311
             le_variance =       0.477414113973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282021132978e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820211329705       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820211329712       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820211329712       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820211329384       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 5.051025e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820211329705       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820211329706       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820211329706       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820211329706       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 1.262756e-10

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820211329705       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820211329705       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820211329705       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820211329705       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 3.156892e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9982e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555473e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005495e-03 3 1  ON 28
ci_30                 6.704271e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630355e-04 3 1  ON 31
ci_33                 7.777601e-05 3 1  ON 32
ci_34                 8.967962e-04 3 1  ON 33
ci_35                -2.388402e-05 3 1  ON 34
ci_36                -8.953255e-04 3 1  ON 35
ci_37                -5.142993e-04 3 1  ON 36
ci_38                -2.635252e-04 3 1  ON 37
ci_39                 4.144532e-04 3 1  ON 38
ci_40                -1.372556e-03 3 1  ON 39
ci_41                 5.404373e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267935e-06 3 1  ON 44
ci_46                -5.407563e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364253e-04 3 1  ON 47
ci_49                -1.402274e-03 3 1  ON 48
ci_50                -4.900424e-04 3 1  ON 49
ci_51                 6.455142e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128945e-03 3 1  ON 55
ci_57                 7.339397e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754618e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833800e-04 3 1  ON 61
ci_63                -9.086883e-05 3 1  ON 62
ci_64                -6.291698e-04 3 1  ON 63
ci_65                -4.772650e-04 3 1  ON 64
ci_66                 1.658817e-04 3 1  ON 65
ci_67                -9.729457e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8358
    reference variance = 0.435526
====================================================
  Execution time = 2.4735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9951e-01
  Total weights = 1.9636e+06
  Execution time = 3.5862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605693
                                         uncertainty =       0.002734494973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605693
                                         uncertainty =       0.002734494973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490446039
  error estimate for blocks of size 2^( 2) =       0.000511116396
  error estimate for blocks of size 2^( 3) =       0.000530350398
  error estimate for blocks of size 2^( 4) =       0.000545497211
  error estimate for blocks of size 2^( 5) =       0.000554695492
  error estimate for blocks of size 2^( 6) =       0.000562425222
  error estimate for blocks of size 2^( 7) =       0.000564030205

      target function =                  N/A
              le_mean =     -22.818941520571
             les_mean =     521.203601541801
             stat err =       0.000556662032
             autocorr =       1.288251745848
              std dev =       0.693595439485
             le_variance =       0.481074633674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605617
                                         uncertainty =       0.002734494958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605617
                                         uncertainty =       0.002734494958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490446039
  error estimate for blocks of size 2^( 2) =       0.000511116396
  error estimate for blocks of size 2^( 3) =       0.000530350398
  error estimate for blocks of size 2^( 4) =       0.000545497211
  error estimate for blocks of size 2^( 5) =       0.000554695492
  error estimate for blocks of size 2^( 6) =       0.000562425222
  error estimate for blocks of size 2^( 7) =       0.000564030205

      target function =                  N/A
              le_mean =     -22.818941520568
             les_mean =     521.203601541285
             stat err =       0.000556662032
             autocorr =       1.288251745981
              std dev =       0.693595439431
             le_variance =       0.481074633599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605655
                                         uncertainty =       0.002734494965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605655
                                         uncertainty =       0.002734494965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490446039
  error estimate for blocks of size 2^( 2) =       0.000511116396
  error estimate for blocks of size 2^( 3) =       0.000530350398
  error estimate for blocks of size 2^( 4) =       0.000545497211
  error estimate for blocks of size 2^( 5) =       0.000554695492
  error estimate for blocks of size 2^( 6) =       0.000562425222
  error estimate for blocks of size 2^( 7) =       0.000564030205

      target function =                  N/A
              le_mean =     -22.818941520569
             les_mean =     521.203601541543
             stat err =       0.000556662032
             autocorr =       1.288251745914
              std dev =       0.693595439458
             le_variance =       0.481074633637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605688
                                         uncertainty =       0.002734494972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481125605688
                                         uncertainty =       0.002734494972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490446039
  error estimate for blocks of size 2^( 2) =       0.000511116396
  error estimate for blocks of size 2^( 3) =       0.000530350398
  error estimate for blocks of size 2^( 4) =       0.000545497211
  error estimate for blocks of size 2^( 5) =       0.000554695492
  error estimate for blocks of size 2^( 6) =       0.000562425222
  error estimate for blocks of size 2^( 7) =       0.000564030205

      target function =                  N/A
              le_mean =     -22.818941520570
             les_mean =     521.203601541769
             stat err =       0.000556662032
             autocorr =       1.288251745861
              std dev =       0.693595439482
             le_variance =       0.481074633670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818941520571        initial  <--
     9.0949e+05     9.0949e+06             5.0510e-10       -22.818941520568
     3.6380e+06     3.6380e+07             1.2628e-10       -22.818941520569
     1.4552e+07     1.4552e+08             3.1569e-11       -22.818941520570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6710
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.147276e-01 3 1  ON 0
ci_02                -2.589871e-02 3 1  ON 1
ci_03                -2.555473e-02 3 1  ON 2
ci_04                 2.529731e-02 3 1  ON 3
ci_05                -2.314386e-02 3 1  ON 4
ci_06                -2.383361e-02 3 1  ON 5
ci_07                 2.643502e-02 3 1  ON 6
ci_08                -4.259283e-03 3 1  ON 7
ci_09                -1.118814e-02 3 1  ON 8
ci_10                -1.142778e-02 3 1  ON 9
ci_11                 1.612921e-02 3 1  ON 10
ci_12                 1.090292e-02 3 1  ON 11
ci_13                 1.166183e-02 3 1  ON 12
ci_14                 1.661474e-02 3 1  ON 13
ci_15                 7.583386e-03 3 1  ON 14
ci_16                 7.884883e-03 3 1  ON 15
ci_17                -9.594194e-03 3 1  ON 16
ci_18                -9.869906e-03 3 1  ON 17
ci_19                 9.395779e-03 3 1  ON 18
ci_20                 1.116732e-02 3 1  ON 19
ci_21                 7.558231e-03 3 1  ON 20
ci_22                 7.806956e-03 3 1  ON 21
ci_23                 6.665916e-03 3 1  ON 22
ci_24                 6.534171e-03 3 1  ON 23
ci_25                 5.093874e-03 3 1  ON 24
ci_26                 2.112260e-03 3 1  ON 25
ci_27                 2.698847e-03 3 1  ON 26
ci_28                 4.440799e-03 3 1  ON 27
ci_29                 4.005496e-03 3 1  ON 28
ci_30                 6.704271e-04 3 1  ON 29
ci_31                 1.054090e-03 3 1  ON 30
ci_32                 2.630356e-04 3 1  ON 31
ci_33                 7.777605e-05 3 1  ON 32
ci_34                 8.967962e-04 3 1  ON 33
ci_35                -2.388412e-05 3 1  ON 34
ci_36                -8.953256e-04 3 1  ON 35
ci_37                -5.142992e-04 3 1  ON 36
ci_38                -2.635252e-04 3 1  ON 37
ci_39                 4.144533e-04 3 1  ON 38
ci_40                -1.372555e-03 3 1  ON 39
ci_41                 5.404373e-04 3 1  ON 40
ci_42                 4.057158e-04 3 1  ON 41
ci_43                -2.414409e-03 3 1  ON 42
ci_44                -2.690220e-03 3 1  ON 43
ci_45                -1.267894e-06 3 1  ON 44
ci_46                -5.407563e-04 3 1  ON 45
ci_47                -1.411608e-03 3 1  ON 46
ci_48                -6.364254e-04 3 1  ON 47
ci_49                -1.402275e-03 3 1  ON 48
ci_50                -4.900423e-04 3 1  ON 49
ci_51                 6.455143e-04 3 1  ON 50
ci_52                 2.153048e-04 3 1  ON 51
ci_53                -1.120545e-03 3 1  ON 52
ci_54                -1.409373e-03 3 1  ON 53
ci_55                -1.055671e-03 3 1  ON 54
ci_56                 2.128945e-03 3 1  ON 55
ci_57                 7.339397e-04 3 1  ON 56
ci_58                -1.196366e-03 3 1  ON 57
ci_59                -2.050380e-03 3 1  ON 58
ci_60                 4.754618e-04 3 1  ON 59
ci_61                 1.783855e-03 3 1  ON 60
ci_62                -5.833802e-04 3 1  ON 61
ci_63                -9.086875e-05 3 1  ON 62
ci_64                -6.291697e-04 3 1  ON 63
ci_65                -4.772649e-04 3 1  ON 64
ci_66                 1.658818e-04 3 1  ON 65
ci_67                -9.729458e-04 3 1  ON 66
ci_68                -1.357794e-03 3 1  ON 67
ci_69                -9.573418e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2660e+01 secs
  Total Execution time = 2.9426e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
