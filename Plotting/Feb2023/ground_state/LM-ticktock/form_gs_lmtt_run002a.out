Rank =    0  Free Memory = 90662 MB
Rank =    1  Free Memory = 90662 MB
Rank =    2  Free Memory = 90662 MB
Rank =    3  Free Memory = 90662 MB
Rank =    4  Free Memory = 90662 MB
Rank =    5  Free Memory = 90661 MB
Rank =    6  Free Memory = 90661 MB
Rank =    7  Free Memory = 90661 MB
Rank =    8  Free Memory = 90661 MB
Rank =    9  Free Memory = 90660 MB
Rank =   10  Free Memory = 90659 MB
Rank =   11  Free Memory = 90659 MB
Rank =   12  Free Memory = 90659 MB
Rank =   13  Free Memory = 90659 MB
Rank =   14  Free Memory = 90658 MB
Rank =   15  Free Memory = 90644 MB
Rank =   16  Free Memory = 90644 MB
Rank =   17  Free Memory = 90644 MB
Rank =   18  Free Memory = 90644 MB
Rank =   19  Free Memory = 90644 MB
Rank =   20  Free Memory = 90644 MB
Rank =   21  Free Memory = 90644 MB
Rank =   22  Free Memory = 90644 MB
Rank =   23  Free Memory = 90644 MB
Rank =   24  Free Memory = 90644 MB
Rank =   25  Free Memory = 90644 MB
Rank =   26  Free Memory = 90644 MB
Rank =   27  Free Memory = 90644 MB
Rank =   28  Free Memory = 90644 MB
Rank =   29  Free Memory = 90644 MB
Rank =   30  Free Memory = 90644 MB
Rank =   31  Free Memory = 90643 MB
Rank =   32  Free Memory = 90786 MB
Rank =   33  Free Memory = 90786 MB
Rank =   34  Free Memory = 90786 MB
Rank =   35  Free Memory = 90786 MB
Rank =   36  Free Memory = 90786 MB
Rank =   37  Free Memory = 90786 MB
Rank =   38  Free Memory = 90786 MB
Rank =   39  Free Memory = 90786 MB
Rank =   40  Free Memory = 90786 MB
Rank =   41  Free Memory = 90786 MB
Rank =   42  Free Memory = 90786 MB
Rank =   43  Free Memory = 90786 MB
Rank =   44  Free Memory = 90786 MB
Rank =   45  Free Memory = 90786 MB
Rank =   46  Free Memory = 90786 MB
Rank =   47  Free Memory = 90786 MB
Rank =   48  Free Memory = 90786 MB
Rank =   49  Free Memory = 90786 MB
Rank =   50  Free Memory = 90786 MB
Rank =   51  Free Memory = 90786 MB
Rank =   52  Free Memory = 90786 MB
Rank =   53  Free Memory = 90786 MB
Rank =   54  Free Memory = 90786 MB
Rank =   55  Free Memory = 90786 MB
Rank =   56  Free Memory = 90786 MB
Rank =   57  Free Memory = 90786 MB
Rank =   58  Free Memory = 90786 MB
Rank =   59  Free Memory = 90786 MB
Rank =   60  Free Memory = 90786 MB
Rank =   61  Free Memory = 90786 MB
Rank =   62  Free Memory = 90786 MB
Rank =   63  Free Memory = 90786 MB
Rank =   64  Free Memory = 90171 MB
Rank =   65  Free Memory = 90171 MB
Rank =   66  Free Memory = 90170 MB
Rank =   67  Free Memory = 90170 MB
Rank =   68  Free Memory = 90170 MB
Rank =   69  Free Memory = 90170 MB
Rank =   70  Free Memory = 90170 MB
Rank =   71  Free Memory = 90170 MB
Rank =   72  Free Memory = 90170 MB
Rank =   73  Free Memory = 90170 MB
Rank =   74  Free Memory = 90170 MB
Rank =   75  Free Memory = 90170 MB
Rank =   76  Free Memory = 90170 MB
Rank =   77  Free Memory = 90170 MB
Rank =   78  Free Memory = 90170 MB
Rank =   79  Free Memory = 90170 MB
Rank =   80  Free Memory = 90170 MB
Rank =   81  Free Memory = 90170 MB
Rank =   82  Free Memory = 90170 MB
Rank =   83  Free Memory = 90170 MB
Rank =   84  Free Memory = 90170 MB
Rank =   85  Free Memory = 90170 MB
Rank =   86  Free Memory = 90170 MB
Rank =   87  Free Memory = 90170 MB
Rank =   88  Free Memory = 90170 MB
Rank =   89  Free Memory = 90170 MB
Rank =   90  Free Memory = 90170 MB
Rank =   91  Free Memory = 90170 MB
Rank =   92  Free Memory = 90170 MB
Rank =   93  Free Memory = 90170 MB
Rank =   94  Free Memory = 90170 MB
Rank =   95  Free Memory = 90170 MB
Rank =   96  Free Memory = 91173 MB
Rank =   97  Free Memory = 91173 MB
Rank =   98  Free Memory = 91173 MB
Rank =   99  Free Memory = 91173 MB
Rank =  100  Free Memory = 91173 MB
Rank =  101  Free Memory = 91173 MB
Rank =  102  Free Memory = 91173 MB
Rank =  103  Free Memory = 91173 MB
Rank =  104  Free Memory = 91173 MB
Rank =  105  Free Memory = 91173 MB
Rank =  106  Free Memory = 91173 MB
Rank =  107  Free Memory = 91173 MB
Rank =  108  Free Memory = 91173 MB
Rank =  109  Free Memory = 91173 MB
Rank =  110  Free Memory = 91173 MB
Rank =  111  Free Memory = 91173 MB
Rank =  112  Free Memory = 91173 MB
Rank =  113  Free Memory = 91173 MB
Rank =  114  Free Memory = 91173 MB
Rank =  115  Free Memory = 91173 MB
Rank =  116  Free Memory = 91173 MB
Rank =  117  Free Memory = 91173 MB
Rank =  118  Free Memory = 91173 MB
Rank =  119  Free Memory = 91173 MB
Rank =  120  Free Memory = 91173 MB
Rank =  121  Free Memory = 91173 MB
Rank =  122  Free Memory = 91173 MB
Rank =  123  Free Memory = 91173 MB
Rank =  124  Free Memory = 91173 MB
Rank =  125  Free Memory = 91173 MB
Rank =  126  Free Memory = 91173 MB
Rank =  127  Free Memory = 91173 MB
  Input file(s): opt_form_gs_lmtt_run002a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmtt_run002a.xml

  Project = FORM
  date    = 2023-02-16 16:21:14 PST
  host    = n0010.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 122

  Range of prime numbers to use as seeds over processors and threads = 683-1601


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.536032e-01    1         1 OFF
     uu_1                 8.197417e-02    1         1 OFF
     uu_2                -2.279515e-02    1         1 OFF
     uu_3                -7.836857e-02    1         1 OFF
     uu_4                -1.013427e-01    1         1 OFF
     uu_5                -1.044477e-01    1         1 OFF
     uu_6                -9.224414e-02    1         1 OFF
     uu_7                -6.062712e-02    1         1 OFF
     uu_8                -1.023404e-02    1         1 OFF
     uu_9                 4.851606e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.792217e-01    1         1 OFF
     ud_1                 1.041447e-01    1         1 OFF
     ud_2                -2.759756e-02    1         1 OFF
     ud_3                -9.201142e-02    1         1 OFF
     ud_4                -1.207933e-01    1         1 OFF
     ud_5                -1.273508e-01    1         1 OFF
     ud_6                -1.163455e-01    1         1 OFF
     ud_7                -8.399626e-02    1         1 OFF
     ud_8                -3.198393e-02    1         1 OFF
     ud_9                 3.386961e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -3.996214e-01    1         1 OFF
     eC_1                -2.494767e-01    1         1 OFF
     eC_2                 3.700011e-03    1         1 OFF
     eC_3                 1.573024e-01    1         1 OFF
     eC_4                 1.937498e-01    1         1 OFF
     eC_5                 1.904877e-01    1         1 OFF
     eC_6                 7.711846e-02    1         1 OFF
     eC_7                 2.034542e-02    1         1 OFF
     eC_8                 3.700966e-03    1         1 OFF
     eC_9                 1.944711e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.797092e-01    1         1 OFF
     eO_1                -4.355440e-01    1         1 OFF
     eO_2                -2.455303e-02    1         1 OFF
     eO_3                 2.277127e-01    1         1 OFF
     eO_4                 3.261577e-01    1         1 OFF
     eO_5                 3.430617e-01    1         1 OFF
     eO_6                 2.378897e-01    1         1 OFF
     eO_7                 8.612036e-02    1         1 OFF
     eO_8                 2.385595e-03    1         1 OFF
     eO_9                 8.162181e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.737895e-02    1         1 OFF
     eH1_1                -1.599916e-02    1         1 OFF
     eH1_2                 3.445961e-03    1         1 OFF
     eH1_3                -1.247711e-02    1         1 OFF
     eH1_4                 6.338141e-03    1         1 OFF
     eH1_5                 1.464916e-02    1         1 OFF
     eH1_6                 3.536630e-02    1         1 OFF
     eH1_7                 3.910225e-02    1         1 OFF
     eH1_8                 2.028485e-02    1         1 OFF
     eH1_9                 5.094825e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.796051e-02    1         1 OFF
     eH2_1                -1.537428e-02    1         1 OFF
     eH2_2                 4.200477e-03    1         1 OFF
     eH2_3                -1.217164e-02    1         1 OFF
     eH2_4                 6.944154e-03    1         1 OFF
     eH2_5                 1.575404e-02    1         1 OFF
     eH2_6                 3.502549e-02    1         1 OFF
     eH2_7                 3.688055e-02    1         1 OFF
     eH2_8                 2.096512e-02    1         1 OFF
     eH2_9                 4.252178e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999797e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6147e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7428
    reference variance = 0.29553
====================================================
  Execution time = 2.5984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2809e+01
  VMC Evar = 5.1751e-01
  Total weights = 1.962952372e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500853971529
                                         uncertainty =       0.002229409452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500853971529
                                         uncertainty =       0.002229409452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500437098
  error estimate for blocks of size 2^( 2) =       0.000521504189
  error estimate for blocks of size 2^( 3) =       0.000540818821
  error estimate for blocks of size 2^( 4) =       0.000556421681
  error estimate for blocks of size 2^( 5) =       0.000565016856
  error estimate for blocks of size 2^( 6) =       0.000572053337
  error estimate for blocks of size 2^( 7) =       0.000574527469

      target function =                  N/A
              le_mean =     -22.808886851762
             les_mean =     520.762826665954
             stat err =       0.000567004835
             autocorr =       1.283732485806
              std dev =       0.707724930912
             le_variance =       0.500874577835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.280888685176e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.808886851730       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.812997639174       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.813263416425       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.813270556811       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.813270775863       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.813270785937       residual = 2.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.685972e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.808886851730       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.810477837810       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.810540487021       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.810541755003       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.810541744098       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.766919e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.808886851730       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.809347667307       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.809362570361       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.809363003706       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.809363010488       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.994505e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.004190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0545e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.597901e-01                 3 1 ON  0
ci_02 -5.406049e-02                3 1 ON  1
ci_03 -5.417243e-02                3 1 ON  2
ci_04 5.211558e-02                 3 1 ON  3
ci_05 -3.820782e-02                3 1 ON  4
ci_06 -3.808139e-02                3 1 ON  5
ci_07 3.013891e-02                 3 1 ON  6
ci_08 -1.607303e-02                3 1 ON  7
ci_09 -1.684870e-02                3 1 ON  8
ci_10 -1.668342e-02                3 1 ON  9
ci_11 1.619170e-02                 3 1 ON  10
ci_12 1.313535e-02                 3 1 ON  11
ci_13 1.257621e-02                 3 1 ON  12
ci_14 1.270042e-02                 3 1 ON  13
ci_15 1.178651e-02                 3 1 ON  14
ci_16 1.182490e-02                 3 1 ON  15
ci_17 -1.193852e-02                3 1 ON  16
ci_18 -1.213223e-02                3 1 ON  17
ci_19 1.102837e-02                 3 1 ON  18
ci_20 1.045380e-02                 3 1 ON  19
ci_21 9.994344e-03                 3 1 ON  20
ci_22 9.649458e-03                 3 1 ON  21
ci_23 6.748391e-03                 3 1 ON  22
ci_24 5.415285e-03                 3 1 ON  23
ci_25 5.253360e-03                 3 1 ON  24
ci_26 4.598231e-03                 3 1 ON  25
ci_27 4.583242e-03                 3 1 ON  26
ci_28 4.412909e-03                 3 1 ON  27
ci_29 4.570715e-03                 3 1 ON  28
ci_30 -3.550706e-03                3 1 ON  29
ci_31 -3.187735e-03                3 1 ON  30
ci_32 -2.666981e-03                3 1 ON  31
ci_33 -2.461578e-03                3 1 ON  32
ci_34 2.070751e-03                 3 1 ON  33
ci_35 1.963693e-03                 3 1 ON  34
ci_36 -2.236024e-03                3 1 ON  35
ci_37 -2.333691e-03                3 1 ON  36
ci_38 -1.778201e-03                3 1 ON  37
ci_39 -1.950734e-03                3 1 ON  38
ci_40 -1.885092e-03                3 1 ON  39
ci_41 -1.314212e-03                3 1 ON  40
ci_42 -1.174171e-03                3 1 ON  41
ci_43 -2.249703e-03                3 1 ON  42
ci_44 -2.296880e-03                3 1 ON  43
ci_45 -1.603584e-03                3 1 ON  44
ci_46 -1.723495e-03                3 1 ON  45
ci_47 -1.996173e-03                3 1 ON  46
ci_48 -1.962528e-03                3 1 ON  47
ci_49 -1.678063e-03                3 1 ON  48
ci_50 -1.408894e-03                3 1 ON  49
ci_51 1.361568e-03                 3 1 ON  50
ci_52 1.528932e-03                 3 1 ON  51
ci_53 -1.562947e-03                3 1 ON  52
ci_54 -1.369953e-03                3 1 ON  53
ci_55 -1.242207e-03                3 1 ON  54
ci_56 1.353114e-03                 3 1 ON  55
ci_57 1.331539e-03                 3 1 ON  56
ci_58 -1.148679e-03                3 1 ON  57
ci_59 -1.272967e-03                3 1 ON  58
ci_60 1.218998e-03                 3 1 ON  59
ci_61 1.175265e-03                 3 1 ON  60
ci_62 -7.992511e-04                3 1 ON  61
ci_63 -9.063709e-04                3 1 ON  62
ci_64 -1.113159e-03                3 1 ON  63
ci_65 -1.142092e-03                3 1 ON  64
ci_66 -9.052872e-04                3 1 ON  65
ci_67 -9.813912e-04                3 1 ON  66
ci_68 4.679526e-04                 3 1 ON  67
ci_69 6.794492e-04                 3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7263
    reference variance = 0.504644
====================================================
  Execution time = 2.7295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2811e+01
  VMC Evar = 5.1382e-01
  Total weights = 1.9634e+06
  Execution time = 3.5259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.651828449091
                                         uncertainty =       0.139977949994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.651828449091
                                         uncertainty =       0.139977949994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000570647903
  error estimate for blocks of size 2^( 2) =       0.000589209127
  error estimate for blocks of size 2^( 3) =       0.000607222164
  error estimate for blocks of size 2^( 4) =       0.000621155953
  error estimate for blocks of size 2^( 5) =       0.000628687164
  error estimate for blocks of size 2^( 6) =       0.000632252431
  error estimate for blocks of size 2^( 7) =       0.000632967739

      target function =                  N/A
              le_mean =     -22.811530166051
             les_mean =     522.576263793436
             stat err =       0.000628765822
             autocorr =       1.214063497635
              std dev =       0.807018003553
             le_variance =       0.651278058058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569321203757
                                         uncertainty =       0.079478061009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.569321203757
                                         uncertainty =       0.079478061009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000533520555
  error estimate for blocks of size 2^( 2) =       0.000552626125
  error estimate for blocks of size 2^( 3) =       0.000571593478
  error estimate for blocks of size 2^( 4) =       0.000585372759
  error estimate for blocks of size 2^( 5) =       0.000592966913
  error estimate for blocks of size 2^( 6) =       0.000597739066
  error estimate for blocks of size 2^( 7) =       0.000599571144

      target function =                  N/A
              le_mean =     -22.811588879545
             les_mean =     520.996104654597
             stat err =       0.000593912470
             autocorr =       1.239203341428
              std dev =       0.754512004700
             le_variance =       0.569288365237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490919826335
                                         uncertainty =       0.003085895060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490919826335
                                         uncertainty =       0.003085895060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000495406169
  error estimate for blocks of size 2^( 2) =       0.000516012035
  error estimate for blocks of size 2^( 3) =       0.000536192780
  error estimate for blocks of size 2^( 4) =       0.000551316299
  error estimate for blocks of size 2^( 5) =       0.000559542772
  error estimate for blocks of size 2^( 6) =       0.000564156406
  error estimate for blocks of size 2^( 7) =       0.000565433599

      target function =                  N/A
              le_mean =     -22.811272632764
             les_mean =     520.887929701049
             stat err =       0.000560112269
             autocorr =       1.278283994591
              std dev =       0.700610123195
             le_variance =       0.490854544723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506596145623
                                         uncertainty =       0.002670268755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506596145623
                                         uncertainty =       0.002670268755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503251482
  error estimate for blocks of size 2^( 2) =       0.000524287039
  error estimate for blocks of size 2^( 3) =       0.000544694434
  error estimate for blocks of size 2^( 4) =       0.000560030024
  error estimate for blocks of size 2^( 5) =       0.000568485757
  error estimate for blocks of size 2^( 6) =       0.000572831589
  error estimate for blocks of size 2^( 7) =       0.000574083769

      target function =                  N/A
              le_mean =     -22.811075309926
             les_mean =     521.034553301391
             stat err =       0.000568857784
             autocorr =       1.277724689608
              std dev =       0.711705070517
             le_variance =       0.506524107399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.811530166051        initial
     2.5000e-01     2.5000e+00             1.6860e-02       -22.811588879545  <--
     1.0000e+00     1.0000e+01             6.7669e-03       -22.811272632764
     4.0000e+00     4.0000e+01             1.9945e-03       -22.811075309926

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.4975e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.510226e-01 3 1  ON 0
ci_02                -4.527337e-02 3 1  ON 1
ci_03                -4.558594e-02 3 1  ON 2
ci_04                 4.202278e-02 3 1  ON 3
ci_05                -3.307189e-02 3 1  ON 4
ci_06                -3.273886e-02 3 1  ON 5
ci_07                 2.911761e-02 3 1  ON 6
ci_08                -1.148371e-02 3 1  ON 7
ci_09                -1.520303e-02 3 1  ON 8
ci_10                -1.471070e-02 3 1  ON 9
ci_11                 1.589184e-02 3 1  ON 10
ci_12                 1.228998e-02 3 1  ON 11
ci_13                 1.241232e-02 3 1  ON 12
ci_14                 1.289096e-02 3 1  ON 13
ci_15                 1.034774e-02 3 1  ON 14
ci_16                 1.046947e-02 3 1  ON 15
ci_17                -1.133613e-02 3 1  ON 16
ci_18                -1.186737e-02 3 1  ON 17
ci_19                 1.000779e-02 3 1  ON 18
ci_20                 1.021602e-02 3 1  ON 19
ci_21                 1.005464e-02 3 1  ON 20
ci_22                 8.998875e-03 3 1  ON 21
ci_23                 6.713559e-03 3 1  ON 22
ci_24                 5.583299e-03 3 1  ON 23
ci_25                 5.241950e-03 3 1  ON 24
ci_26                 4.123228e-03 3 1  ON 25
ci_27                 4.067404e-03 3 1  ON 26
ci_28                 4.489915e-03 3 1  ON 27
ci_29                 4.918327e-03 3 1  ON 28
ci_30                -3.204630e-03 3 1  ON 29
ci_31                -2.132204e-03 3 1  ON 30
ci_32                -1.745975e-03 3 1  ON 31
ci_33                -1.215647e-03 3 1  ON 32
ci_34                 9.647888e-04 3 1  ON 33
ci_35                 6.941626e-04 3 1  ON 34
ci_36                -1.584663e-03 3 1  ON 35
ci_37                -1.831920e-03 3 1  ON 36
ci_38                -1.187011e-03 3 1  ON 37
ci_39                -1.603873e-03 3 1  ON 38
ci_40                -1.641511e-03 3 1  ON 39
ci_41                -5.884508e-04 3 1  ON 40
ci_42                -2.393152e-04 3 1  ON 41
ci_43                -2.383072e-03 3 1  ON 42
ci_44                -2.510376e-03 3 1  ON 43
ci_45                -1.116831e-03 3 1  ON 44
ci_46                -1.399830e-03 3 1  ON 45
ci_47                -2.043675e-03 3 1  ON 46
ci_48                -2.012864e-03 3 1  ON 47
ci_49                -1.532793e-03 3 1  ON 48
ci_50                -9.968425e-04 3 1  ON 49
ci_51                 8.087506e-04 3 1  ON 50
ci_52                 1.218039e-03 3 1  ON 51
ci_53                -1.581315e-03 3 1  ON 52
ci_54                -1.111816e-03 3 1  ON 53
ci_55                -7.720731e-04 3 1  ON 54
ci_56                 1.438602e-03 3 1  ON 55
ci_57                 1.376638e-03 3 1  ON 56
ci_58                -9.942895e-04 3 1  ON 57
ci_59                -1.328642e-03 3 1  ON 58
ci_60                 1.365135e-03 3 1  ON 59
ci_61                 1.212194e-03 3 1  ON 60
ci_62                -3.084812e-04 3 1  ON 61
ci_63                -5.300780e-04 3 1  ON 62
ci_64                -1.109928e-03 3 1  ON 63
ci_65                -1.182218e-03 3 1  ON 64
ci_66                -6.341404e-04 3 1  ON 65
ci_67                -8.304599e-04 3 1  ON 66
ci_68                -3.591386e-04 3 1  ON 67
ci_69                 1.820935e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2735e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7754
    reference variance = 0.871815
====================================================
  Execution time = 2.6543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9640e-01
  Total weights = 1.963257247e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480599038950
                                         uncertainty =       0.002585485392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480599038950
                                         uncertainty =       0.002585485392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490240708
  error estimate for blocks of size 2^( 2) =       0.000511311913
  error estimate for blocks of size 2^( 3) =       0.000530937634
  error estimate for blocks of size 2^( 4) =       0.000545910452
  error estimate for blocks of size 2^( 5) =       0.000555221920
  error estimate for blocks of size 2^( 6) =       0.000561361161
  error estimate for blocks of size 2^( 7) =       0.000565908848

      target function =                  N/A
              le_mean =     -22.815368863393
             les_mean =     521.037453525249
             stat err =       0.000557100595
             autocorr =       1.291363486912
              std dev =       0.693305058434
             le_variance =       0.480671904050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281536886339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815368863340       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817634417601       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.817929399089       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817957612825       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.817958261783       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.817957974985       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.817957929355       residual = 7.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.030932e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815368863340       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816712334328       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816811831388       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816815574973       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816815475199       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.172248e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815368863340       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.815879968895       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.815903372946       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.815903896386       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.815903852415       residual = 6.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.402407e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1116e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.418504e-01 3 1  ON 0
ci_02                -3.770862e-02 3 1  ON 1
ci_03                -3.769640e-02 3 1  ON 2
ci_04                 3.354836e-02 3 1  ON 3
ci_05                -2.842264e-02 3 1  ON 4
ci_06                -2.829892e-02 3 1  ON 5
ci_07                 2.750976e-02 3 1  ON 6
ci_08                -7.935707e-03 3 1  ON 7
ci_09                -1.382381e-02 3 1  ON 8
ci_10                -1.333228e-02 3 1  ON 9
ci_11                 1.570530e-02 3 1  ON 10
ci_12                 1.180165e-02 3 1  ON 11
ci_13                 1.162113e-02 3 1  ON 12
ci_14                 1.362297e-02 3 1  ON 13
ci_15                 9.769383e-03 3 1  ON 14
ci_16                 9.544913e-03 3 1  ON 15
ci_17                -1.142874e-02 3 1  ON 16
ci_18                -1.156260e-02 3 1  ON 17
ci_19                 9.632455e-03 3 1  ON 18
ci_20                 1.060977e-02 3 1  ON 19
ci_21                 8.566181e-03 3 1  ON 20
ci_22                 8.691624e-03 3 1  ON 21
ci_23                 6.433200e-03 3 1  ON 22
ci_24                 5.579347e-03 3 1  ON 23
ci_25                 4.956443e-03 3 1  ON 24
ci_26                 3.213276e-03 3 1  ON 25
ci_27                 3.130913e-03 3 1  ON 26
ci_28                 4.823967e-03 3 1  ON 27
ci_29                 4.767311e-03 3 1  ON 28
ci_30                -2.172039e-03 3 1  ON 29
ci_31                -1.738986e-03 3 1  ON 30
ci_32                -5.393368e-04 3 1  ON 31
ci_33                -1.562841e-03 3 1  ON 32
ci_34                 1.863922e-04 3 1  ON 33
ci_35                -9.131840e-05 3 1  ON 34
ci_36                -1.400593e-03 3 1  ON 35
ci_37                -1.103409e-03 3 1  ON 36
ci_38                -6.955643e-04 3 1  ON 37
ci_39                -9.329218e-04 3 1  ON 38
ci_40                -1.613281e-03 3 1  ON 39
ci_41                 4.088905e-05 3 1  ON 40
ci_42                 4.071308e-04 3 1  ON 41
ci_43                -2.495845e-03 3 1  ON 42
ci_44                -2.066057e-03 3 1  ON 43
ci_45                -4.241420e-04 3 1  ON 44
ci_46                -4.178760e-04 3 1  ON 45
ci_47                -2.397236e-03 3 1  ON 46
ci_48                -2.010269e-03 3 1  ON 47
ci_49                -1.332703e-03 3 1  ON 48
ci_50                -7.958870e-04 3 1  ON 49
ci_51                 2.485568e-04 3 1  ON 50
ci_52                 5.661154e-04 3 1  ON 51
ci_53                -1.393759e-03 3 1  ON 52
ci_54                -8.926379e-04 3 1  ON 53
ci_55                -6.432638e-04 3 1  ON 54
ci_56                 1.493779e-03 3 1  ON 55
ci_57                 1.833628e-03 3 1  ON 56
ci_58                -8.699865e-04 3 1  ON 57
ci_59                -1.399733e-03 3 1  ON 58
ci_60                 1.766602e-03 3 1  ON 59
ci_61                 1.361724e-03 3 1  ON 60
ci_62                -1.464240e-05 3 1  ON 61
ci_63                -6.857339e-04 3 1  ON 62
ci_64                -5.610441e-04 3 1  ON 63
ci_65                -1.231773e-03 3 1  ON 64
ci_66                -7.841142e-04 3 1  ON 65
ci_67                -8.469822e-04 3 1  ON 66
ci_68                -1.167839e-03 3 1  ON 67
ci_69                -5.616209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.858
    reference variance = 0.423586
====================================================
  Execution time = 2.5071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9442e-01
  Total weights = 1.9634e+06
  Execution time = 3.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.789478196749
                                         uncertainty =       0.210912376320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.789478196749
                                         uncertainty =       0.210912376320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000627902387
  error estimate for blocks of size 2^( 2) =       0.000645163707
  error estimate for blocks of size 2^( 3) =       0.000660631271
  error estimate for blocks of size 2^( 4) =       0.000671895640
  error estimate for blocks of size 2^( 5) =       0.000679853988
  error estimate for blocks of size 2^( 6) =       0.000683974339
  error estimate for blocks of size 2^( 7) =       0.000685248893

      target function =                  N/A
              le_mean =     -22.818640985127
             les_mean =     771.804311991928
             stat err =       0.000680243215
             autocorr =       1.173665042129
              std dev =       0.887988071287
             le_variance =       0.788522814748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485048444839
                                         uncertainty =       0.006799005907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485048444839
                                         uncertainty =       0.006799005907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492420301
  error estimate for blocks of size 2^( 2) =       0.000513569815
  error estimate for blocks of size 2^( 3) =       0.000532856033
  error estimate for blocks of size 2^( 4) =       0.000547519847
  error estimate for blocks of size 2^( 5) =       0.000557509856
  error estimate for blocks of size 2^( 6) =       0.000561894779
  error estimate for blocks of size 2^( 7) =       0.000566018332

      target function =                  N/A
              le_mean =     -22.818855114337
             les_mean =     521.254467529237
             stat err =       0.000558235704
             autocorr =       1.285178113588
              std dev =       0.696387467859
             le_variance =       0.484955505391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543323386859
                                         uncertainty =       0.065395296466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.543323386859
                                         uncertainty =       0.065395296466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000521138242
  error estimate for blocks of size 2^( 2) =       0.000541184241
  error estimate for blocks of size 2^( 3) =       0.000559564674
  error estimate for blocks of size 2^( 4) =       0.000573775981
  error estimate for blocks of size 2^( 5) =       0.000583014983
  error estimate for blocks of size 2^( 6) =       0.000586549416
  error estimate for blocks of size 2^( 7) =       0.000589134380

      target function =                  N/A
              le_mean =     -22.819309754843
             les_mean =     521.462625585896
             stat err =       0.000583118690
             autocorr =       1.252010685273
              std dev =       0.737000770197
             le_variance =       0.543170135271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506587449348
                                         uncertainty =       0.016674097468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506587449348
                                         uncertainty =       0.016674097468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503204065
  error estimate for blocks of size 2^( 2) =       0.000523904304
  error estimate for blocks of size 2^( 3) =       0.000542767760
  error estimate for blocks of size 2^( 4) =       0.000556846932
  error estimate for blocks of size 2^( 5) =       0.000566407192
  error estimate for blocks of size 2^( 6) =       0.000570449350
  error estimate for blocks of size 2^( 7) =       0.000574754869

      target function =                  N/A
              le_mean =     -22.818876196806
             les_mean =     534.939611476727
             stat err =       0.000567114586
             autocorr =       1.270145145572
              std dev =       0.711638013321
             le_variance =       0.506428662003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818640985127        initial
     6.2500e-02     6.2500e-01             2.0309e-02       -22.818855114337
     2.5000e-01     2.5000e+00             9.1722e-03       -22.819309754843  <--
     1.0000e+00     1.0000e+01             3.4024e-03       -22.818876196806

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.2866e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.418504e-01 3 1  ON 0
ci_02                -3.770862e-02 3 1  ON 1
ci_03                -3.769640e-02 3 1  ON 2
ci_04                 3.354836e-02 3 1  ON 3
ci_05                -2.842264e-02 3 1  ON 4
ci_06                -2.829892e-02 3 1  ON 5
ci_07                 2.750976e-02 3 1  ON 6
ci_08                -7.935707e-03 3 1  ON 7
ci_09                -1.382381e-02 3 1  ON 8
ci_10                -1.333228e-02 3 1  ON 9
ci_11                 1.570530e-02 3 1  ON 10
ci_12                 1.180165e-02 3 1  ON 11
ci_13                 1.162113e-02 3 1  ON 12
ci_14                 1.362297e-02 3 1  ON 13
ci_15                 9.769383e-03 3 1  ON 14
ci_16                 9.544913e-03 3 1  ON 15
ci_17                -1.142874e-02 3 1  ON 16
ci_18                -1.156260e-02 3 1  ON 17
ci_19                 9.632455e-03 3 1  ON 18
ci_20                 1.060977e-02 3 1  ON 19
ci_21                 8.566181e-03 3 1  ON 20
ci_22                 8.691624e-03 3 1  ON 21
ci_23                 6.433200e-03 3 1  ON 22
ci_24                 5.579347e-03 3 1  ON 23
ci_25                 4.956443e-03 3 1  ON 24
ci_26                 3.213276e-03 3 1  ON 25
ci_27                 3.130913e-03 3 1  ON 26
ci_28                 4.823967e-03 3 1  ON 27
ci_29                 4.767311e-03 3 1  ON 28
ci_30                -2.172039e-03 3 1  ON 29
ci_31                -1.738986e-03 3 1  ON 30
ci_32                -5.393368e-04 3 1  ON 31
ci_33                -1.562841e-03 3 1  ON 32
ci_34                 1.863922e-04 3 1  ON 33
ci_35                -9.131840e-05 3 1  ON 34
ci_36                -1.400593e-03 3 1  ON 35
ci_37                -1.103409e-03 3 1  ON 36
ci_38                -6.955643e-04 3 1  ON 37
ci_39                -9.329218e-04 3 1  ON 38
ci_40                -1.613281e-03 3 1  ON 39
ci_41                 4.088905e-05 3 1  ON 40
ci_42                 4.071308e-04 3 1  ON 41
ci_43                -2.495845e-03 3 1  ON 42
ci_44                -2.066057e-03 3 1  ON 43
ci_45                -4.241420e-04 3 1  ON 44
ci_46                -4.178760e-04 3 1  ON 45
ci_47                -2.397236e-03 3 1  ON 46
ci_48                -2.010269e-03 3 1  ON 47
ci_49                -1.332703e-03 3 1  ON 48
ci_50                -7.958870e-04 3 1  ON 49
ci_51                 2.485568e-04 3 1  ON 50
ci_52                 5.661154e-04 3 1  ON 51
ci_53                -1.393759e-03 3 1  ON 52
ci_54                -8.926379e-04 3 1  ON 53
ci_55                -6.432638e-04 3 1  ON 54
ci_56                 1.493779e-03 3 1  ON 55
ci_57                 1.833628e-03 3 1  ON 56
ci_58                -8.699865e-04 3 1  ON 57
ci_59                -1.399733e-03 3 1  ON 58
ci_60                 1.766602e-03 3 1  ON 59
ci_61                 1.361724e-03 3 1  ON 60
ci_62                -1.464240e-05 3 1  ON 61
ci_63                -6.857339e-04 3 1  ON 62
ci_64                -5.610441e-04 3 1  ON 63
ci_65                -1.231773e-03 3 1  ON 64
ci_66                -7.841142e-04 3 1  ON 65
ci_67                -8.469822e-04 3 1  ON 66
ci_68                -1.167839e-03 3 1  ON 67
ci_69                -5.616209e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3990e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2776e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.9214
    reference variance = 0.667486
====================================================
  Execution time = 2.5718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9826e-01
  Total weights = 1.963306327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480637435473
                                         uncertainty =       0.003958097670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480637435473
                                         uncertainty =       0.003958097670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490187113
  error estimate for blocks of size 2^( 2) =       0.000511040250
  error estimate for blocks of size 2^( 3) =       0.000530895283
  error estimate for blocks of size 2^( 4) =       0.000545158250
  error estimate for blocks of size 2^( 5) =       0.000554480484
  error estimate for blocks of size 2^( 6) =       0.000557300742
  error estimate for blocks of size 2^( 7) =       0.000557571438

      target function =                  N/A
              le_mean =     -22.817141272654
             les_mean =     521.120192605311
             stat err =       0.000553627728
             autocorr =       1.275592295553
              std dev =       0.693229263720
             le_variance =       0.480566812078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281714127265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.817141272624       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817926288665       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818057140402       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818067853672       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818068694563       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818068636597       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.572398e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.817141272624       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817593533201       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.817633483089       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817634449972       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.817634499822       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.046457e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.817141272624       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817309040873       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.817317411931       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817317722822       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.228902e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0270e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.348039e-01 3 1  ON 0
ci_02                -3.281152e-02 3 1  ON 1
ci_03                -3.329817e-02 3 1  ON 2
ci_04                 2.902878e-02 3 1  ON 3
ci_05                -2.530648e-02 3 1  ON 4
ci_06                -2.570304e-02 3 1  ON 5
ci_07                 2.664353e-02 3 1  ON 6
ci_08                -6.317025e-03 3 1  ON 7
ci_09                -1.333305e-02 3 1  ON 8
ci_10                -1.242579e-02 3 1  ON 9
ci_11                 1.576917e-02 3 1  ON 10
ci_12                 1.072773e-02 3 1  ON 11
ci_13                 1.138649e-02 3 1  ON 12
ci_14                 1.401690e-02 3 1  ON 13
ci_15                 8.835703e-03 3 1  ON 14
ci_16                 8.768086e-03 3 1  ON 15
ci_17                -1.028827e-02 3 1  ON 16
ci_18                -1.128084e-02 3 1  ON 17
ci_19                 9.524306e-03 3 1  ON 18
ci_20                 1.058096e-02 3 1  ON 19
ci_21                 8.326386e-03 3 1  ON 20
ci_22                 8.714424e-03 3 1  ON 21
ci_23                 6.119894e-03 3 1  ON 22
ci_24                 6.657755e-03 3 1  ON 23
ci_25                 5.180568e-03 3 1  ON 24
ci_26                 3.125516e-03 3 1  ON 25
ci_27                 2.636104e-03 3 1  ON 26
ci_28                 4.465172e-03 3 1  ON 27
ci_29                 4.492712e-03 3 1  ON 28
ci_30                -1.174266e-03 3 1  ON 29
ci_31                -1.792931e-03 3 1  ON 30
ci_32                 2.050330e-04 3 1  ON 31
ci_33                -6.106278e-04 3 1  ON 32
ci_34                -6.699499e-04 3 1  ON 33
ci_35                 5.903958e-04 3 1  ON 34
ci_36                -1.040630e-03 3 1  ON 35
ci_37                -1.002053e-03 3 1  ON 36
ci_38                -3.978423e-04 3 1  ON 37
ci_39                -7.610203e-04 3 1  ON 38
ci_40                -1.465746e-03 3 1  ON 39
ci_41                 9.666605e-04 3 1  ON 40
ci_42                 3.196811e-04 3 1  ON 41
ci_43                -2.467583e-03 3 1  ON 42
ci_44                -1.511884e-03 3 1  ON 43
ci_45                -1.193066e-04 3 1  ON 44
ci_46                -1.316113e-04 3 1  ON 45
ci_47                -1.954183e-03 3 1  ON 46
ci_48                -2.228769e-03 3 1  ON 47
ci_49                -1.421278e-03 3 1  ON 48
ci_50                -6.134918e-04 3 1  ON 49
ci_51                 1.540228e-04 3 1  ON 50
ci_52                 1.862246e-04 3 1  ON 51
ci_53                -1.601032e-03 3 1  ON 52
ci_54                -1.254509e-03 3 1  ON 53
ci_55                -8.209066e-04 3 1  ON 54
ci_56                 1.701788e-03 3 1  ON 55
ci_57                 1.428239e-03 3 1  ON 56
ci_58                -1.209978e-03 3 1  ON 57
ci_59                -9.762178e-04 3 1  ON 58
ci_60                 1.834882e-03 3 1  ON 59
ci_61                 1.564655e-03 3 1  ON 60
ci_62                -2.796906e-04 3 1  ON 61
ci_63                -6.431407e-04 3 1  ON 62
ci_64                -5.347141e-05 3 1  ON 63
ci_65                -9.552986e-04 3 1  ON 64
ci_66                -3.929267e-04 3 1  ON 65
ci_67                -1.233901e-03 3 1  ON 66
ci_68                -1.258923e-03 3 1  ON 67
ci_69                -8.965256e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8231
    reference variance = 0.311379
====================================================
  Execution time = 2.5154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9667e-01
  Total weights = 1.9636e+06
  Execution time = 3.5279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0436376
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560751026238
                                         uncertainty =       0.080020658628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.560751026238
                                         uncertainty =       0.080020658628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000529408243
  error estimate for blocks of size 2^( 2) =       0.000548433545
  error estimate for blocks of size 2^( 3) =       0.000567257344
  error estimate for blocks of size 2^( 4) =       0.000580992924
  error estimate for blocks of size 2^( 5) =       0.000589762741
  error estimate for blocks of size 2^( 6) =       0.000595920959
  error estimate for blocks of size 2^( 7) =       0.000596853019

      target function =                  N/A
              le_mean =     -22.819414554117
             les_mean =     525.305355563116
             stat err =       0.000590882411
             autocorr =       1.245720827898
              std dev =       0.748696317617
             le_variance =       0.560546176013

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.189934
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     128.803567068771
                                         uncertainty =     127.686788300911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =     128.803567068771
                                         uncertainty =     127.686788300911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.008032369466
  error estimate for blocks of size 2^( 2) =       0.008033981273
  error estimate for blocks of size 2^( 3) =       0.008034968488
  error estimate for blocks of size 2^( 4) =       0.008037218975
  error estimate for blocks of size 2^( 5) =       0.008040236412
  error estimate for blocks of size 2^( 6) =       0.008038359200
  error estimate for blocks of size 2^( 7) =       0.008039490426

      target function =                  N/A
              le_mean =     -22.827463197172
             les_mean =    1095.956474139180
             stat err =       0.008038826253
             autocorr =       1.001608337951
              std dev =      11.359485837124
             le_variance =     129.037918483819

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0426738
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.611474689972
                                         uncertainty =       0.137487501280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.611474689972
                                         uncertainty =       0.137487501280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000553020551
  error estimate for blocks of size 2^( 2) =       0.000571567920
  error estimate for blocks of size 2^( 3) =       0.000589799455
  error estimate for blocks of size 2^( 4) =       0.000602690299
  error estimate for blocks of size 2^( 5) =       0.000612303874
  error estimate for blocks of size 2^( 6) =       0.000618530578
  error estimate for blocks of size 2^( 7) =       0.000619343538

      target function =                  N/A
              le_mean =     -22.819249712575
             les_mean =     521.838611095445
             stat err =       0.000613217072
             autocorr =       1.229549260244
              std dev =       0.782089164136
             le_variance =       0.611663460660

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.285548
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477205983777
                                         uncertainty =       0.002507557350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477205983777
                                         uncertainty =       0.002507557350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488438166
  error estimate for blocks of size 2^( 2) =       0.000509049133
  error estimate for blocks of size 2^( 3) =       0.000529084876
  error estimate for blocks of size 2^( 4) =       0.000543839116
  error estimate for blocks of size 2^( 5) =       0.000553261690
  error estimate for blocks of size 2^( 6) =       0.000558940528
  error estimate for blocks of size 2^( 7) =       0.000560485218

      target function =                  N/A
              le_mean =     -22.819450266486
             les_mean =     521.265041383931
             stat err =       0.000554131638
             autocorr =       1.287083464368
              std dev =       0.690755878136
             le_variance =       0.477143683180


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819414554117        initial
     6.2500e-02     6.2500e-01             1.5724e-02       -22.827463197172  <--
     2.5000e-01     2.5000e+00             7.0465e-03       -22.819249712575
     1.0000e+00     1.0000e+01             2.2289e-03       -22.819450266486

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.2853e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.261264e-01 3 1  ON 0
ci_02                -2.896175e-02 3 1  ON 1
ci_03                -2.994571e-02 3 1  ON 2
ci_04                 2.639596e-02 3 1  ON 3
ci_05                -2.321616e-02 3 1  ON 4
ci_06                -2.408013e-02 3 1  ON 5
ci_07                 2.596425e-02 3 1  ON 6
ci_08                -5.221688e-03 3 1  ON 7
ci_09                -1.288775e-02 3 1  ON 8
ci_10                -1.154649e-02 3 1  ON 9
ci_11                 1.597800e-02 3 1  ON 10
ci_12                 9.989773e-03 3 1  ON 11
ci_13                 1.127396e-02 3 1  ON 12
ci_14                 1.485783e-02 3 1  ON 13
ci_15                 8.054997e-03 3 1  ON 14
ci_16                 8.193117e-03 3 1  ON 15
ci_17                -9.222927e-03 3 1  ON 16
ci_18                -1.097989e-02 3 1  ON 17
ci_19                 9.548570e-03 3 1  ON 18
ci_20                 1.055260e-02 3 1  ON 19
ci_21                 8.012646e-03 3 1  ON 20
ci_22                 8.649720e-03 3 1  ON 21
ci_23                 5.966486e-03 3 1  ON 22
ci_24                 7.933278e-03 3 1  ON 23
ci_25                 5.338383e-03 3 1  ON 24
ci_26                 3.124977e-03 3 1  ON 25
ci_27                 2.280360e-03 3 1  ON 26
ci_28                 3.981855e-03 3 1  ON 27
ci_29                 4.084646e-03 3 1  ON 28
ci_30                -1.705314e-04 3 1  ON 29
ci_31                -1.724050e-03 3 1  ON 30
ci_32                 4.571768e-04 3 1  ON 31
ci_33                -1.593389e-04 3 1  ON 32
ci_34                -1.083833e-03 3 1  ON 33
ci_35                 1.427870e-03 3 1  ON 34
ci_36                -8.253466e-04 3 1  ON 35
ci_37                -8.886493e-04 3 1  ON 36
ci_38                -2.148207e-04 3 1  ON 37
ci_39                -5.915130e-04 3 1  ON 38
ci_40                -1.341438e-03 3 1  ON 39
ci_41                 1.400203e-03 3 1  ON 40
ci_42                 6.198231e-05 3 1  ON 41
ci_43                -2.274213e-03 3 1  ON 42
ci_44                -9.468057e-04 3 1  ON 43
ci_45                 8.416528e-05 3 1  ON 44
ci_46                 5.311516e-05 3 1  ON 45
ci_47                -1.444252e-03 3 1  ON 46
ci_48                -2.214701e-03 3 1  ON 47
ci_49                -1.446048e-03 3 1  ON 48
ci_50                -5.372545e-04 3 1  ON 49
ci_51                 6.302214e-05 3 1  ON 50
ci_52                -6.586967e-05 3 1  ON 51
ci_53                -1.666737e-03 3 1  ON 52
ci_54                -1.536149e-03 3 1  ON 53
ci_55                -9.803648e-04 3 1  ON 54
ci_56                 1.900192e-03 3 1  ON 55
ci_57                 1.222100e-03 3 1  ON 56
ci_58                -1.498558e-03 3 1  ON 57
ci_59                -6.925533e-04 3 1  ON 58
ci_60                 1.994217e-03 3 1  ON 59
ci_61                 1.870620e-03 3 1  ON 60
ci_62                -3.709023e-04 3 1  ON 61
ci_63                -5.918416e-04 3 1  ON 62
ci_64                 3.118371e-04 3 1  ON 63
ci_65                -7.465161e-04 3 1  ON 64
ci_66                -1.299326e-04 3 1  ON 65
ci_67                -1.420494e-03 3 1  ON 66
ci_68                -1.350760e-03 3 1  ON 67
ci_69                -1.144339e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8426
    reference variance = 0.330452
====================================================
  Execution time = 2.5605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5377e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.0981e-01
  Total weights = 1.963516081e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487062688618
                                         uncertainty =       0.011084482417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487062688618
                                         uncertainty =       0.011084482417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493666156
  error estimate for blocks of size 2^( 2) =       0.000514771112
  error estimate for blocks of size 2^( 3) =       0.000534588226
  error estimate for blocks of size 2^( 4) =       0.000549624778
  error estimate for blocks of size 2^( 5) =       0.000557412810
  error estimate for blocks of size 2^( 6) =       0.000562827726
  error estimate for blocks of size 2^( 7) =       0.000565274850

      target function =                  N/A
              le_mean =     -22.818819198455
             les_mean =     521.208322134296
             stat err =       0.000558785041
             autocorr =       1.281217417689
              std dev =       0.698149372840
             le_variance =       0.487412546797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281881919845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818819198377       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818928389715       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818953816087       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818965560722       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818967929912       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818967898327       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-02 is 7.699245e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818819198377       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818908205208       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818922656630       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818927736212       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818928406513       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818928399421       residual = 8.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 5.191743e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818819198377       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818870368399       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818873581298       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818874247040       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.276128e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009972 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0135e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.209347e-01 3 1  ON 0
ci_02                -2.622887e-02 3 1  ON 1
ci_03                -2.606333e-02 3 1  ON 2
ci_04                 2.623877e-02 3 1  ON 3
ci_05                -2.218727e-02 3 1  ON 4
ci_06                -2.265779e-02 3 1  ON 5
ci_07                 2.631848e-02 3 1  ON 6
ci_08                -4.492275e-03 3 1  ON 7
ci_09                -1.103006e-02 3 1  ON 8
ci_10                -1.164089e-02 3 1  ON 9
ci_11                 1.588570e-02 3 1  ON 10
ci_12                 1.104444e-02 3 1  ON 11
ci_13                 1.214627e-02 3 1  ON 12
ci_14                 1.535269e-02 3 1  ON 13
ci_15                 7.548546e-03 3 1  ON 14
ci_16                 7.226205e-03 3 1  ON 15
ci_17                -9.286437e-03 3 1  ON 16
ci_18                -1.036239e-02 3 1  ON 17
ci_19                 9.452278e-03 3 1  ON 18
ci_20                 1.022345e-02 3 1  ON 19
ci_21                 7.705178e-03 3 1  ON 20
ci_22                 9.444877e-03 3 1  ON 21
ci_23                 5.954668e-03 3 1  ON 22
ci_24                 7.999378e-03 3 1  ON 23
ci_25                 5.158260e-03 3 1  ON 24
ci_26                 3.572771e-03 3 1  ON 25
ci_27                 1.534182e-03 3 1  ON 26
ci_28                 4.008834e-03 3 1  ON 27
ci_29                 4.162077e-03 3 1  ON 28
ci_30                -6.474309e-04 3 1  ON 29
ci_31                -1.136481e-03 3 1  ON 30
ci_32                -6.845067e-04 3 1  ON 31
ci_33                 1.186969e-03 3 1  ON 32
ci_34                -5.220251e-04 3 1  ON 33
ci_35                 1.433839e-03 3 1  ON 34
ci_36                -1.072695e-03 3 1  ON 35
ci_37                -1.031864e-03 3 1  ON 36
ci_38                -1.738786e-04 3 1  ON 37
ci_39                -4.064853e-04 3 1  ON 38
ci_40                -1.635641e-03 3 1  ON 39
ci_41                 4.122746e-04 3 1  ON 40
ci_42                 1.017886e-03 3 1  ON 41
ci_43                -2.652545e-03 3 1  ON 42
ci_44                -1.701942e-03 3 1  ON 43
ci_45                -4.223859e-04 3 1  ON 44
ci_46                 2.226032e-04 3 1  ON 45
ci_47                 2.281181e-04 3 1  ON 46
ci_48                -9.046482e-04 3 1  ON 47
ci_49                -9.326332e-04 3 1  ON 48
ci_50                -4.634499e-05 3 1  ON 49
ci_51                 4.787380e-05 3 1  ON 50
ci_52                 1.256610e-04 3 1  ON 51
ci_53                -1.283807e-03 3 1  ON 52
ci_54                -1.154304e-03 3 1  ON 53
ci_55                -1.610234e-04 3 1  ON 54
ci_56                 1.113645e-03 3 1  ON 55
ci_57                 2.064663e-03 3 1  ON 56
ci_58                -1.567439e-03 3 1  ON 57
ci_59                -1.314399e-03 3 1  ON 58
ci_60                 2.226522e-03 3 1  ON 59
ci_61                 2.347243e-03 3 1  ON 60
ci_62                -1.853552e-04 3 1  ON 61
ci_63                 2.159240e-04 3 1  ON 62
ci_64                -3.328189e-04 3 1  ON 63
ci_65                -5.017738e-04 3 1  ON 64
ci_66                -5.063492e-04 3 1  ON 65
ci_67                -9.710950e-04 3 1  ON 66
ci_68                -1.318041e-03 3 1  ON 67
ci_69                 1.637213e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7928
    reference variance = 0.472668
====================================================
  Execution time = 2.5188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9285e-01
  Total weights = 1.9635e+06
  Execution time = 3.5212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0732968
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477616046540
                                         uncertainty =       0.003401563380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477616046540
                                         uncertainty =       0.003401563380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488788672
  error estimate for blocks of size 2^( 2) =       0.000510136315
  error estimate for blocks of size 2^( 3) =       0.000531087249
  error estimate for blocks of size 2^( 4) =       0.000547634857
  error estimate for blocks of size 2^( 5) =       0.000557656408
  error estimate for blocks of size 2^( 6) =       0.000562573150
  error estimate for blocks of size 2^( 7) =       0.000564496091

      target function =                  N/A
              le_mean =     -22.818769899443
             les_mean =     521.276729613273
             stat err =       0.000558090127
             autocorr =       1.303666223092
              std dev =       0.691251569637
             le_variance =       0.477828732525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474670578365
                                         uncertainty =       0.003174516624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474670578365
                                         uncertainty =       0.003174516624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487265881
  error estimate for blocks of size 2^( 2) =       0.000508794616
  error estimate for blocks of size 2^( 3) =       0.000529943448
  error estimate for blocks of size 2^( 4) =       0.000546811078
  error estimate for blocks of size 2^( 5) =       0.000556817061
  error estimate for blocks of size 2^( 6) =       0.000561694275
  error estimate for blocks of size 2^( 7) =       0.000563599048

      target function =                  N/A
              le_mean =     -22.818684142742
             les_mean =     521.189008950400
             stat err =       0.000557230365
             autocorr =       1.307788590550
              std dev =       0.689098017394
             le_variance =       0.474856077577

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0701871
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475445882188
                                         uncertainty =       0.003277605587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475445882188
                                         uncertainty =       0.003277605587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487653284
  error estimate for blocks of size 2^( 2) =       0.000509253873
  error estimate for blocks of size 2^( 3) =       0.000530489292
  error estimate for blocks of size 2^( 4) =       0.000547466441
  error estimate for blocks of size 2^( 5) =       0.000557468629
  error estimate for blocks of size 2^( 6) =       0.000562376271
  error estimate for blocks of size 2^( 7) =       0.000564269672

      target function =                  N/A
              le_mean =     -22.818778188134
             les_mean =     521.199058686899
             stat err =       0.000557895253
             autocorr =       1.308829352666
              std dev =       0.689645888032
             le_variance =       0.475611450880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476962097731
                                         uncertainty =       0.003670475624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476962097731
                                         uncertainty =       0.003670475624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488445549
  error estimate for blocks of size 2^( 2) =       0.000509825750
  error estimate for blocks of size 2^( 3) =       0.000530884514
  error estimate for blocks of size 2^( 4) =       0.000547627538
  error estimate for blocks of size 2^( 5) =       0.000557622482
  error estimate for blocks of size 2^( 6) =       0.000562478494
  error estimate for blocks of size 2^( 7) =       0.000564550556

      target function =                  N/A
              le_mean =     -22.818735514460
             les_mean =     521.510049854227
             stat err =       0.000558069767
             autocorr =       1.305403216009
              std dev =       0.690766320374
             le_variance =       0.477158109363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818769899443        initial
     1.5625e-02     1.5625e-01             7.6992e-03       -22.818684142742
     6.2500e-02     6.2500e-01             5.1917e-03       -22.818778188134  <--
     2.5000e-01     2.5000e+00             2.2761e-03       -22.818735514460

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.2849e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.209347e-01 3 1  ON 0
ci_02                -2.622887e-02 3 1  ON 1
ci_03                -2.606333e-02 3 1  ON 2
ci_04                 2.623877e-02 3 1  ON 3
ci_05                -2.218727e-02 3 1  ON 4
ci_06                -2.265779e-02 3 1  ON 5
ci_07                 2.631848e-02 3 1  ON 6
ci_08                -4.492275e-03 3 1  ON 7
ci_09                -1.103006e-02 3 1  ON 8
ci_10                -1.164089e-02 3 1  ON 9
ci_11                 1.588570e-02 3 1  ON 10
ci_12                 1.104444e-02 3 1  ON 11
ci_13                 1.214627e-02 3 1  ON 12
ci_14                 1.535269e-02 3 1  ON 13
ci_15                 7.548546e-03 3 1  ON 14
ci_16                 7.226205e-03 3 1  ON 15
ci_17                -9.286437e-03 3 1  ON 16
ci_18                -1.036239e-02 3 1  ON 17
ci_19                 9.452278e-03 3 1  ON 18
ci_20                 1.022345e-02 3 1  ON 19
ci_21                 7.705178e-03 3 1  ON 20
ci_22                 9.444877e-03 3 1  ON 21
ci_23                 5.954668e-03 3 1  ON 22
ci_24                 7.999378e-03 3 1  ON 23
ci_25                 5.158260e-03 3 1  ON 24
ci_26                 3.572771e-03 3 1  ON 25
ci_27                 1.534182e-03 3 1  ON 26
ci_28                 4.008834e-03 3 1  ON 27
ci_29                 4.162077e-03 3 1  ON 28
ci_30                -6.474309e-04 3 1  ON 29
ci_31                -1.136481e-03 3 1  ON 30
ci_32                -6.845067e-04 3 1  ON 31
ci_33                 1.186969e-03 3 1  ON 32
ci_34                -5.220251e-04 3 1  ON 33
ci_35                 1.433839e-03 3 1  ON 34
ci_36                -1.072695e-03 3 1  ON 35
ci_37                -1.031864e-03 3 1  ON 36
ci_38                -1.738786e-04 3 1  ON 37
ci_39                -4.064853e-04 3 1  ON 38
ci_40                -1.635641e-03 3 1  ON 39
ci_41                 4.122746e-04 3 1  ON 40
ci_42                 1.017886e-03 3 1  ON 41
ci_43                -2.652545e-03 3 1  ON 42
ci_44                -1.701942e-03 3 1  ON 43
ci_45                -4.223859e-04 3 1  ON 44
ci_46                 2.226032e-04 3 1  ON 45
ci_47                 2.281181e-04 3 1  ON 46
ci_48                -9.046482e-04 3 1  ON 47
ci_49                -9.326332e-04 3 1  ON 48
ci_50                -4.634499e-05 3 1  ON 49
ci_51                 4.787380e-05 3 1  ON 50
ci_52                 1.256610e-04 3 1  ON 51
ci_53                -1.283807e-03 3 1  ON 52
ci_54                -1.154304e-03 3 1  ON 53
ci_55                -1.610234e-04 3 1  ON 54
ci_56                 1.113645e-03 3 1  ON 55
ci_57                 2.064663e-03 3 1  ON 56
ci_58                -1.567439e-03 3 1  ON 57
ci_59                -1.314399e-03 3 1  ON 58
ci_60                 2.226522e-03 3 1  ON 59
ci_61                 2.347243e-03 3 1  ON 60
ci_62                -1.853552e-04 3 1  ON 61
ci_63                 2.159240e-04 3 1  ON 62
ci_64                -3.328189e-04 3 1  ON 63
ci_65                -5.017738e-04 3 1  ON 64
ci_66                -5.063492e-04 3 1  ON 65
ci_67                -9.710950e-04 3 1  ON 66
ci_68                -1.318041e-03 3 1  ON 67
ci_69                 1.637213e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2997e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8164
    reference variance = 0.359714
====================================================
  Execution time = 2.5710e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8958e-01
  Total weights = 1.963583125e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475397115597
                                         uncertainty =       0.003360157758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475397115597
                                         uncertainty =       0.003360157758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487570951
  error estimate for blocks of size 2^( 2) =       0.000508659705
  error estimate for blocks of size 2^( 3) =       0.000528457120
  error estimate for blocks of size 2^( 4) =       0.000543540262
  error estimate for blocks of size 2^( 5) =       0.000554661450
  error estimate for blocks of size 2^( 6) =       0.000559110508
  error estimate for blocks of size 2^( 7) =       0.000562560729

      target function =                  N/A
              le_mean =     -22.818589934174
             les_mean =     521.177625095623
             stat err =       0.000554968237
             autocorr =       1.295569185039
              std dev =       0.689529451288
             le_variance =       0.475450864194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281858993417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818589934137       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818656220611       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818671084589       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818671813609       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818672114566       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818672344811       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818672270754       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-02 is 5.073523e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818589934137       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818645093170       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818653673209       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818653492572       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818653560017       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818653625335       residual = 9.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 3.312955e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818589934137       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818622934193       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818624900778       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818624773496       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.375741e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0274e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.176217e-01 3 1  ON 0
ci_02                -2.656918e-02 3 1  ON 1
ci_03                -2.610599e-02 3 1  ON 2
ci_04                 2.502324e-02 3 1  ON 3
ci_05                -2.328306e-02 3 1  ON 4
ci_06                -2.345648e-02 3 1  ON 5
ci_07                 2.602855e-02 3 1  ON 6
ci_08                -4.621440e-03 3 1  ON 7
ci_09                -1.081132e-02 3 1  ON 8
ci_10                -1.006008e-02 3 1  ON 9
ci_11                 1.582825e-02 3 1  ON 10
ci_12                 1.164362e-02 3 1  ON 11
ci_13                 1.126685e-02 3 1  ON 12
ci_14                 1.689276e-02 3 1  ON 13
ci_15                 6.845995e-03 3 1  ON 14
ci_16                 7.127783e-03 3 1  ON 15
ci_17                -9.699398e-03 3 1  ON 16
ci_18                -9.360613e-03 3 1  ON 17
ci_19                 8.884892e-03 3 1  ON 18
ci_20                 1.074947e-02 3 1  ON 19
ci_21                 8.834857e-03 3 1  ON 20
ci_22                 9.684210e-03 3 1  ON 21
ci_23                 6.232956e-03 3 1  ON 22
ci_24                 7.857473e-03 3 1  ON 23
ci_25                 4.923660e-03 3 1  ON 24
ci_26                 2.571350e-03 3 1  ON 25
ci_27                 1.399098e-03 3 1  ON 26
ci_28                 4.245915e-03 3 1  ON 27
ci_29                 4.473573e-03 3 1  ON 28
ci_30                 7.776783e-04 3 1  ON 29
ci_31                 3.100746e-04 3 1  ON 30
ci_32                -6.226543e-04 3 1  ON 31
ci_33                -7.474606e-04 3 1  ON 32
ci_34                -3.081129e-04 3 1  ON 33
ci_35                 3.661791e-04 3 1  ON 34
ci_36                -5.035396e-04 3 1  ON 35
ci_37                -1.178401e-03 3 1  ON 36
ci_38                -4.758001e-04 3 1  ON 37
ci_39                -9.344544e-04 3 1  ON 38
ci_40                -2.126713e-03 3 1  ON 39
ci_41                 3.756470e-04 3 1  ON 40
ci_42                 7.271802e-05 3 1  ON 41
ci_43                -1.959416e-03 3 1  ON 42
ci_44                -1.344907e-03 3 1  ON 43
ci_45                -5.543238e-04 3 1  ON 44
ci_46                -8.858807e-05 3 1  ON 45
ci_47                -2.440425e-04 3 1  ON 46
ci_48                -1.184720e-04 3 1  ON 47
ci_49                -1.299938e-03 3 1  ON 48
ci_50                -1.494475e-03 3 1  ON 49
ci_51                 2.066350e-04 3 1  ON 50
ci_52                -8.811113e-04 3 1  ON 51
ci_53                -5.802025e-04 3 1  ON 52
ci_54                -7.543102e-04 3 1  ON 53
ci_55                -5.770684e-04 3 1  ON 54
ci_56                 1.562947e-03 3 1  ON 55
ci_57                 2.102373e-03 3 1  ON 56
ci_58                -9.572084e-04 3 1  ON 57
ci_59                -1.127867e-03 3 1  ON 58
ci_60                 2.960205e-03 3 1  ON 59
ci_61                 1.495125e-03 3 1  ON 60
ci_62                 3.178951e-04 3 1  ON 61
ci_63                 2.113698e-04 3 1  ON 62
ci_64                -1.275676e-03 3 1  ON 63
ci_65                -2.859208e-04 3 1  ON 64
ci_66                -1.085816e-03 3 1  ON 65
ci_67                 1.165177e-04 3 1  ON 66
ci_68                -5.717660e-04 3 1  ON 67
ci_69                -7.898322e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8461
    reference variance = 0.31676
====================================================
  Execution time = 2.6790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8841e-01
  Total weights = 1.9640e+06
  Execution time = 3.5192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0236242
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478911045343
                                         uncertainty =       0.004655526858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478911045343
                                         uncertainty =       0.004655526858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489359341
  error estimate for blocks of size 2^( 2) =       0.000510635629
  error estimate for blocks of size 2^( 3) =       0.000531036329
  error estimate for blocks of size 2^( 4) =       0.000546422284
  error estimate for blocks of size 2^( 5) =       0.000557803526
  error estimate for blocks of size 2^( 6) =       0.000563427362
  error estimate for blocks of size 2^( 7) =       0.000566192642

      target function =                  N/A
              le_mean =     -22.819153731411
             les_mean =     521.329401232335
             stat err =       0.000558461454
             autocorr =       1.302358770578
              std dev =       0.692058617220
             le_variance =       0.478945129668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472260535367
                                         uncertainty =       0.002688256858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472260535367
                                         uncertainty =       0.002688256858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485947636
  error estimate for blocks of size 2^( 2) =       0.000507385257
  error estimate for blocks of size 2^( 3) =       0.000528011437
  error estimate for blocks of size 2^( 4) =       0.000543540563
  error estimate for blocks of size 2^( 5) =       0.000554969029
  error estimate for blocks of size 2^( 6) =       0.000560476774
  error estimate for blocks of size 2^( 7) =       0.000564000377

      target function =                  N/A
              le_mean =     -22.819041800294
             les_mean =     521.204978266636
             stat err =       0.000555746686
             autocorr =       1.307900829056
              std dev =       0.687233737782
             le_variance =       0.472290210345

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0230076
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472629030770
                                         uncertainty =       0.002703675234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472629030770
                                         uncertainty =       0.002703675234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486136490
  error estimate for blocks of size 2^( 2) =       0.000507580120
  error estimate for blocks of size 2^( 3) =       0.000528236532
  error estimate for blocks of size 2^( 4) =       0.000543783485
  error estimate for blocks of size 2^( 5) =       0.000555240947
  error estimate for blocks of size 2^( 6) =       0.000560737266
  error estimate for blocks of size 2^( 7) =       0.000564205238

      target function =                  N/A
              le_mean =     -22.819102336760
             les_mean =     521.240933992927
             stat err =       0.000555991734
             autocorr =       1.308037602213
              std dev =       0.687500816751
             le_variance =       0.472657373033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473424403071
                                         uncertainty =       0.003032499069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473424403071
                                         uncertainty =       0.003032499069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486546176
  error estimate for blocks of size 2^( 2) =       0.000507948555
  error estimate for blocks of size 2^( 3) =       0.000528516514
  error estimate for blocks of size 2^( 4) =       0.000544007213
  error estimate for blocks of size 2^( 5) =       0.000555397966
  error estimate for blocks of size 2^( 6) =       0.000560940592
  error estimate for blocks of size 2^( 7) =       0.000564234347

      target function =                  N/A
              le_mean =     -22.819042548836
             les_mean =     521.207969930627
             stat err =       0.000556145030
             autocorr =       1.306555895341
              std dev =       0.688080200241
             le_variance =       0.473454361964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819153731411        initial  <--
     1.5625e-02     1.5625e-01             5.0735e-03       -22.819041800294
     6.2500e-02     6.2500e-01             3.3130e-03       -22.819102336760
     2.5000e-01     2.5000e+00             1.3757e-03       -22.819042548836

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4630
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.209347e-01 3 1  ON 0
ci_02                -2.622887e-02 3 1  ON 1
ci_03                -2.606333e-02 3 1  ON 2
ci_04                 2.623877e-02 3 1  ON 3
ci_05                -2.218727e-02 3 1  ON 4
ci_06                -2.265779e-02 3 1  ON 5
ci_07                 2.631848e-02 3 1  ON 6
ci_08                -4.492275e-03 3 1  ON 7
ci_09                -1.103006e-02 3 1  ON 8
ci_10                -1.164089e-02 3 1  ON 9
ci_11                 1.588570e-02 3 1  ON 10
ci_12                 1.104444e-02 3 1  ON 11
ci_13                 1.214627e-02 3 1  ON 12
ci_14                 1.535269e-02 3 1  ON 13
ci_15                 7.548546e-03 3 1  ON 14
ci_16                 7.226205e-03 3 1  ON 15
ci_17                -9.286437e-03 3 1  ON 16
ci_18                -1.036239e-02 3 1  ON 17
ci_19                 9.452278e-03 3 1  ON 18
ci_20                 1.022345e-02 3 1  ON 19
ci_21                 7.705178e-03 3 1  ON 20
ci_22                 9.444877e-03 3 1  ON 21
ci_23                 5.954668e-03 3 1  ON 22
ci_24                 7.999378e-03 3 1  ON 23
ci_25                 5.158260e-03 3 1  ON 24
ci_26                 3.572771e-03 3 1  ON 25
ci_27                 1.534182e-03 3 1  ON 26
ci_28                 4.008834e-03 3 1  ON 27
ci_29                 4.162077e-03 3 1  ON 28
ci_30                -6.474309e-04 3 1  ON 29
ci_31                -1.136481e-03 3 1  ON 30
ci_32                -6.845067e-04 3 1  ON 31
ci_33                 1.186969e-03 3 1  ON 32
ci_34                -5.220251e-04 3 1  ON 33
ci_35                 1.433839e-03 3 1  ON 34
ci_36                -1.072695e-03 3 1  ON 35
ci_37                -1.031864e-03 3 1  ON 36
ci_38                -1.738786e-04 3 1  ON 37
ci_39                -4.064853e-04 3 1  ON 38
ci_40                -1.635641e-03 3 1  ON 39
ci_41                 4.122746e-04 3 1  ON 40
ci_42                 1.017886e-03 3 1  ON 41
ci_43                -2.652545e-03 3 1  ON 42
ci_44                -1.701942e-03 3 1  ON 43
ci_45                -4.223859e-04 3 1  ON 44
ci_46                 2.226032e-04 3 1  ON 45
ci_47                 2.281181e-04 3 1  ON 46
ci_48                -9.046482e-04 3 1  ON 47
ci_49                -9.326332e-04 3 1  ON 48
ci_50                -4.634499e-05 3 1  ON 49
ci_51                 4.787380e-05 3 1  ON 50
ci_52                 1.256610e-04 3 1  ON 51
ci_53                -1.283807e-03 3 1  ON 52
ci_54                -1.154304e-03 3 1  ON 53
ci_55                -1.610234e-04 3 1  ON 54
ci_56                 1.113645e-03 3 1  ON 55
ci_57                 2.064663e-03 3 1  ON 56
ci_58                -1.567439e-03 3 1  ON 57
ci_59                -1.314399e-03 3 1  ON 58
ci_60                 2.226522e-03 3 1  ON 59
ci_61                 2.347243e-03 3 1  ON 60
ci_62                -1.853552e-04 3 1  ON 61
ci_63                 2.159240e-04 3 1  ON 62
ci_64                -3.328189e-04 3 1  ON 63
ci_65                -5.017738e-04 3 1  ON 64
ci_66                -5.063492e-04 3 1  ON 65
ci_67                -9.710950e-04 3 1  ON 66
ci_68                -1.318041e-03 3 1  ON 67
ci_69                 1.637213e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.757
    reference variance = 0.368158
====================================================
  Execution time = 2.5696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8598e-01
  Total weights = 1.963642958e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471776736225
                                         uncertainty =       0.002231780337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471776736225
                                         uncertainty =       0.002231780337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485687298
  error estimate for blocks of size 2^( 2) =       0.000506795458
  error estimate for blocks of size 2^( 3) =       0.000527193535
  error estimate for blocks of size 2^( 4) =       0.000543496912
  error estimate for blocks of size 2^( 5) =       0.000554354663
  error estimate for blocks of size 2^( 6) =       0.000559262129
  error estimate for blocks of size 2^( 7) =       0.000561077849

      target function =                  N/A
              le_mean =     -22.818300052655
             les_mean =     521.160793204105
             stat err =       0.000554547888
             autocorr =       1.303660842269
              std dev =       0.686865563308
             le_variance =       0.471784302058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281830005265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818300052584       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818332945575       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818335895613       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818336564635       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818336616561       residual = 8.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.587523e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818300052584       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818314812661       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818315339704       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818315358715       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 6.137828e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818300052584       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818304657789       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818304749756       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818304758130       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.161278e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0231e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.204083e-01 3 1  ON 0
ci_02                -2.628026e-02 3 1  ON 1
ci_03                -2.594099e-02 3 1  ON 2
ci_04                 2.595499e-02 3 1  ON 3
ci_05                -2.240110e-02 3 1  ON 4
ci_06                -2.295971e-02 3 1  ON 5
ci_07                 2.620506e-02 3 1  ON 6
ci_08                -4.448628e-03 3 1  ON 7
ci_09                -1.094073e-02 3 1  ON 8
ci_10                -1.160687e-02 3 1  ON 9
ci_11                 1.563516e-02 3 1  ON 10
ci_12                 1.086059e-02 3 1  ON 11
ci_13                 1.186026e-02 3 1  ON 12
ci_14                 1.550962e-02 3 1  ON 13
ci_15                 7.754385e-03 3 1  ON 14
ci_16                 7.305089e-03 3 1  ON 15
ci_17                -9.224945e-03 3 1  ON 16
ci_18                -1.005660e-02 3 1  ON 17
ci_19                 9.384045e-03 3 1  ON 18
ci_20                 1.018783e-02 3 1  ON 19
ci_21                 7.750960e-03 3 1  ON 20
ci_22                 9.152573e-03 3 1  ON 21
ci_23                 5.922155e-03 3 1  ON 22
ci_24                 7.885330e-03 3 1  ON 23
ci_25                 5.149223e-03 3 1  ON 24
ci_26                 3.178525e-03 3 1  ON 25
ci_27                 1.850738e-03 3 1  ON 26
ci_28                 4.005304e-03 3 1  ON 27
ci_29                 4.047687e-03 3 1  ON 28
ci_30                -4.601254e-04 3 1  ON 29
ci_31                -8.729186e-04 3 1  ON 30
ci_32                -5.806281e-04 3 1  ON 31
ci_33                 6.792617e-04 3 1  ON 32
ci_34                -2.887653e-04 3 1  ON 33
ci_35                 1.322416e-03 3 1  ON 34
ci_36                -9.284465e-04 3 1  ON 35
ci_37                -8.426382e-04 3 1  ON 36
ci_38                 1.081651e-05 3 1  ON 37
ci_39                -2.197648e-04 3 1  ON 38
ci_40                -1.522860e-03 3 1  ON 39
ci_41                 7.374868e-04 3 1  ON 40
ci_42                 9.085620e-04 3 1  ON 41
ci_43                -2.387122e-03 3 1  ON 42
ci_44                -1.950814e-03 3 1  ON 43
ci_45                -3.435120e-04 3 1  ON 44
ci_46                -5.127664e-05 3 1  ON 45
ci_47                 2.393810e-04 3 1  ON 46
ci_48                -9.121861e-04 3 1  ON 47
ci_49                -1.043061e-03 3 1  ON 48
ci_50                -6.601278e-04 3 1  ON 49
ci_51                 6.095618e-05 3 1  ON 50
ci_52                 2.217392e-04 3 1  ON 51
ci_53                -1.029944e-03 3 1  ON 52
ci_54                -1.151891e-03 3 1  ON 53
ci_55                -2.244603e-04 3 1  ON 54
ci_56                 1.497517e-03 3 1  ON 55
ci_57                 1.989773e-03 3 1  ON 56
ci_58                -1.531772e-03 3 1  ON 57
ci_59                -1.378103e-03 3 1  ON 58
ci_60                 2.212832e-03 3 1  ON 59
ci_61                 2.390472e-03 3 1  ON 60
ci_62                -2.774896e-04 3 1  ON 61
ci_63                 4.313360e-05 3 1  ON 62
ci_64                -2.899833e-04 3 1  ON 63
ci_65                -2.258941e-04 3 1  ON 64
ci_66                -4.747429e-04 3 1  ON 65
ci_67                -8.484149e-04 3 1  ON 66
ci_68                -1.368753e-03 3 1  ON 67
ci_69                -2.731317e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.9216
    reference variance = 0.647832
====================================================
  Execution time = 2.5136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8849e-01
  Total weights = 1.9636e+06
  Execution time = 3.5108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474093609287
                                         uncertainty =       0.002442740373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474093609287
                                         uncertainty =       0.002442740373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486928650
  error estimate for blocks of size 2^( 2) =       0.000508376835
  error estimate for blocks of size 2^( 3) =       0.000528487150
  error estimate for blocks of size 2^( 4) =       0.000543690803
  error estimate for blocks of size 2^( 5) =       0.000554610846
  error estimate for blocks of size 2^( 6) =       0.000560042969
  error estimate for blocks of size 2^( 7) =       0.000565344552

      target function =                  N/A
              le_mean =     -22.819250671637
             les_mean =     521.256717000227
             stat err =       0.000555922293
             autocorr =       1.303459442323
              std dev =       0.688621100712
             le_variance =       0.474199020346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473889718726
                                         uncertainty =       0.002467456633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473889718726
                                         uncertainty =       0.002467456633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486825924
  error estimate for blocks of size 2^( 2) =       0.000508287465
  error estimate for blocks of size 2^( 3) =       0.000528422713
  error estimate for blocks of size 2^( 4) =       0.000543673287
  error estimate for blocks of size 2^( 5) =       0.000554654299
  error estimate for blocks of size 2^( 6) =       0.000560105254
  error estimate for blocks of size 2^( 7) =       0.000565425247

      target function =                  N/A
              le_mean =     -22.819271190497
             les_mean =     521.221684047508
             stat err =       0.000555964522
             autocorr =       1.304207709453
              std dev =       0.688475824418
             le_variance =       0.473998960808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473876189751
                                         uncertainty =       0.002455684632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473876189751
                                         uncertainty =       0.002455684632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486818409
  error estimate for blocks of size 2^( 2) =       0.000508277042
  error estimate for blocks of size 2^( 3) =       0.000528403532
  error estimate for blocks of size 2^( 4) =       0.000543661044
  error estimate for blocks of size 2^( 5) =       0.000554621364
  error estimate for blocks of size 2^( 6) =       0.000560072535
  error estimate for blocks of size 2^( 7) =       0.000565411458

      target function =                  N/A
              le_mean =     -22.819263504668
             les_mean =     521.212932596458
             stat err =       0.000555941600
             autocorr =       1.304140436585
              std dev =       0.688465195896
             le_variance =       0.473984325960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474237832947
                                         uncertainty =       0.002463232395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474237832947
                                         uncertainty =       0.002463232395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487002636
  error estimate for blocks of size 2^( 2) =       0.000508455559
  error estimate for blocks of size 2^( 3) =       0.000528564672
  error estimate for blocks of size 2^( 4) =       0.000543836523
  error estimate for blocks of size 2^( 5) =       0.000554760430
  error estimate for blocks of size 2^( 6) =       0.000560165579
  error estimate for blocks of size 2^( 7) =       0.000565483901

      target function =                  N/A
              le_mean =     -22.819260159485
             les_mean =     522.406355353926
             stat err =       0.000556061608
             autocorr =       1.303716609797
              std dev =       0.688725733061
             le_variance =       0.474343135380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819250671637        initial
     1.5625e-01     1.5625e+00             1.5875e-03       -22.819271190497  <--
     6.2500e-01     6.2500e+00             6.1378e-04       -22.819263504668
     2.5000e+00     2.5000e+01             2.1613e-04       -22.819260159485

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.2761e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.193471e-01 3 1  ON 0
ci_02                -2.634456e-02 3 1  ON 1
ci_03                -2.571321e-02 3 1  ON 2
ci_04                 2.560175e-02 3 1  ON 3
ci_05                -2.272080e-02 3 1  ON 4
ci_06                -2.344388e-02 3 1  ON 5
ci_07                 2.603331e-02 3 1  ON 6
ci_08                -4.390430e-03 3 1  ON 7
ci_09                -1.076031e-02 3 1  ON 8
ci_10                -1.155760e-02 3 1  ON 9
ci_11                 1.531467e-02 3 1  ON 10
ci_12                 1.062363e-02 3 1  ON 11
ci_13                 1.143251e-02 3 1  ON 12
ci_14                 1.588356e-02 3 1  ON 13
ci_15                 8.047764e-03 3 1  ON 14
ci_16                 7.444350e-03 3 1  ON 15
ci_17                -9.149468e-03 3 1  ON 16
ci_18                -9.622046e-03 3 1  ON 17
ci_19                 9.302809e-03 3 1  ON 18
ci_20                 1.011878e-02 3 1  ON 19
ci_21                 7.767736e-03 3 1  ON 20
ci_22                 8.639727e-03 3 1  ON 21
ci_23                 5.898336e-03 3 1  ON 22
ci_24                 7.695157e-03 3 1  ON 23
ci_25                 5.140385e-03 3 1  ON 24
ci_26                 2.605227e-03 3 1  ON 25
ci_27                 2.288503e-03 3 1  ON 26
ci_28                 3.971354e-03 3 1  ON 27
ci_29                 3.897756e-03 3 1  ON 28
ci_30                -2.198142e-04 3 1  ON 29
ci_31                -4.566319e-04 3 1  ON 30
ci_32                -4.766311e-04 3 1  ON 31
ci_33                 9.439183e-05 3 1  ON 32
ci_34                 5.903346e-05 3 1  ON 33
ci_35                 1.154582e-03 3 1  ON 34
ci_36                -7.619920e-04 3 1  ON 35
ci_37                -6.350399e-04 3 1  ON 36
ci_38                 2.166231e-04 3 1  ON 37
ci_39                -1.420897e-05 3 1  ON 38
ci_40                -1.406059e-03 3 1  ON 39
ci_41                 1.125460e-03 3 1  ON 40
ci_42                 7.812554e-04 3 1  ON 41
ci_43                -2.015399e-03 3 1  ON 42
ci_44                -2.357508e-03 3 1  ON 43
ci_45                -2.730736e-04 3 1  ON 44
ci_46                -3.773794e-04 3 1  ON 45
ci_47                 3.147213e-04 3 1  ON 46
ci_48                -9.356596e-04 3 1  ON 47
ci_49                -1.183391e-03 3 1  ON 48
ci_50                -1.175300e-03 3 1  ON 49
ci_51                 8.036313e-05 3 1  ON 50
ci_52                 3.192645e-04 3 1  ON 51
ci_53                -7.823842e-04 3 1  ON 52
ci_54                -1.173166e-03 3 1  ON 53
ci_55                -3.365443e-04 3 1  ON 54
ci_56                 1.926919e-03 3 1  ON 55
ci_57                 1.911546e-03 3 1  ON 56
ci_58                -1.482006e-03 3 1  ON 57
ci_59                -1.465258e-03 3 1  ON 58
ci_60                 2.189746e-03 3 1  ON 59
ci_61                 2.492787e-03 3 1  ON 60
ci_62                -3.750679e-04 3 1  ON 61
ci_63                -1.476924e-04 3 1  ON 62
ci_64                -2.325877e-04 3 1  ON 63
ci_65                 1.228552e-04 3 1  ON 64
ci_66                -4.136763e-04 3 1  ON 65
ci_67                -6.816904e-04 3 1  ON 66
ci_68                -1.400088e-03 3 1  ON 67
ci_69                -8.452223e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7815
    reference variance = 0.304468
====================================================
  Execution time = 2.5786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8699e-01
  Total weights = 1.964176076e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471762541976
                                         uncertainty =       0.002465756949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471762541976
                                         uncertainty =       0.002465756949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485676919
  error estimate for blocks of size 2^( 2) =       0.000507489101
  error estimate for blocks of size 2^( 3) =       0.000527574207
  error estimate for blocks of size 2^( 4) =       0.000543396245
  error estimate for blocks of size 2^( 5) =       0.000553276817
  error estimate for blocks of size 2^( 6) =       0.000558684972
  error estimate for blocks of size 2^( 7) =       0.000561771059

      target function =                  N/A
              le_mean =     -22.819532990770
             les_mean =     521.218077027537
             stat err =       0.000554282273
             autocorr =       1.302467959686
              std dev =       0.686850886027
             le_variance =       0.471764139636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281953299077e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819532990732       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819549521251       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819552558120       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819553421422       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819553647941       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819553890090       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 2.130789e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819532990732       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819544094179       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819545551200       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819545764511       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819545823304       residual = 6.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.134706e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819532990732       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819537790710       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819538288141       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819538324267       residual = 6.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.634884e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0341e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.184770e-01 3 1  ON 0
ci_02                -2.642978e-02 3 1  ON 1
ci_03                -2.559562e-02 3 1  ON 2
ci_04                 2.479589e-02 3 1  ON 3
ci_05                -2.299982e-02 3 1  ON 4
ci_06                -2.338457e-02 3 1  ON 5
ci_07                 2.605458e-02 3 1  ON 6
ci_08                -4.289910e-03 3 1  ON 7
ci_09                -1.061900e-02 3 1  ON 8
ci_10                -1.197209e-02 3 1  ON 9
ci_11                 1.534545e-02 3 1  ON 10
ci_12                 1.046934e-02 3 1  ON 11
ci_13                 1.147970e-02 3 1  ON 12
ci_14                 1.605285e-02 3 1  ON 13
ci_15                 7.583986e-03 3 1  ON 14
ci_16                 7.843414e-03 3 1  ON 15
ci_17                -9.133807e-03 3 1  ON 16
ci_18                -1.074265e-02 3 1  ON 17
ci_19                 9.453145e-03 3 1  ON 18
ci_20                 1.001003e-02 3 1  ON 19
ci_21                 8.110461e-03 3 1  ON 20
ci_22                 8.945973e-03 3 1  ON 21
ci_23                 5.929867e-03 3 1  ON 22
ci_24                 7.206964e-03 3 1  ON 23
ci_25                 4.864467e-03 3 1  ON 24
ci_26                 2.785276e-03 3 1  ON 25
ci_27                 2.426172e-03 3 1  ON 26
ci_28                 4.378820e-03 3 1  ON 27
ci_29                 3.836062e-03 3 1  ON 28
ci_30                 3.369507e-04 3 1  ON 29
ci_31                -2.135010e-04 3 1  ON 30
ci_32                -7.536195e-04 3 1  ON 31
ci_33                -1.810460e-04 3 1  ON 32
ci_34                 1.193739e-03 3 1  ON 33
ci_35                 2.969579e-04 3 1  ON 34
ci_36                -1.066598e-03 3 1  ON 35
ci_37                -5.020706e-04 3 1  ON 36
ci_38                -2.297969e-05 3 1  ON 37
ci_39                -9.927065e-04 3 1  ON 38
ci_40                -1.541246e-03 3 1  ON 39
ci_41                 3.233970e-04 3 1  ON 40
ci_42                 1.315307e-03 3 1  ON 41
ci_43                -2.708273e-03 3 1  ON 42
ci_44                -2.278901e-03 3 1  ON 43
ci_45                -2.592901e-04 3 1  ON 44
ci_46                -7.395526e-04 3 1  ON 45
ci_47                 1.581113e-05 3 1  ON 46
ci_48                -1.033999e-03 3 1  ON 47
ci_49                -1.138046e-03 3 1  ON 48
ci_50                -1.082694e-03 3 1  ON 49
ci_51                -4.072854e-04 3 1  ON 50
ci_52                 4.660615e-04 3 1  ON 51
ci_53                -1.233191e-03 3 1  ON 52
ci_54                -1.070082e-03 3 1  ON 53
ci_55                -7.933209e-04 3 1  ON 54
ci_56                 1.858657e-03 3 1  ON 55
ci_57                 2.100515e-03 3 1  ON 56
ci_58                -1.352959e-03 3 1  ON 57
ci_59                -1.606084e-03 3 1  ON 58
ci_60                 1.963265e-03 3 1  ON 59
ci_61                 1.482690e-03 3 1  ON 60
ci_62                -2.713356e-04 3 1  ON 61
ci_63                 8.587638e-05 3 1  ON 62
ci_64                -8.593387e-04 3 1  ON 63
ci_65                -6.460927e-04 3 1  ON 64
ci_66                -4.852798e-04 3 1  ON 65
ci_67                -6.417721e-04 3 1  ON 66
ci_68                -1.694758e-03 3 1  ON 67
ci_69                -7.926096e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.802
    reference variance = 0.568741
====================================================
  Execution time = 2.5127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8701e-01
  Total weights = 1.9637e+06
  Execution time = 3.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471626253326
                                         uncertainty =       0.002209943361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471626253326
                                         uncertainty =       0.002209943361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485697749
  error estimate for blocks of size 2^( 2) =       0.000507356411
  error estimate for blocks of size 2^( 3) =       0.000526853945
  error estimate for blocks of size 2^( 4) =       0.000542178040
  error estimate for blocks of size 2^( 5) =       0.000552345030
  error estimate for blocks of size 2^( 6) =       0.000556552864
  error estimate for blocks of size 2^( 7) =       0.000559475838

      target function =                  N/A
              le_mean =     -22.820265567278
             les_mean =     521.474455000453
             stat err =       0.000552637943
             autocorr =       1.294640586783
              std dev =       0.686880343287
             le_variance =       0.471804605995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471060849705
                                         uncertainty =       0.002196916862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471060849705
                                         uncertainty =       0.002196916862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485409338
  error estimate for blocks of size 2^( 2) =       0.000507102013
  error estimate for blocks of size 2^( 3) =       0.000526634249
  error estimate for blocks of size 2^( 4) =       0.000541975271
  error estimate for blocks of size 2^( 5) =       0.000552147857
  error estimate for blocks of size 2^( 6) =       0.000556355365
  error estimate for blocks of size 2^( 7) =       0.000559322253

      target function =                  N/A
              le_mean =     -22.820241874657
             les_mean =     521.295827181599
             stat err =       0.000552450187
             autocorr =       1.295298896424
              std dev =       0.686472469441
             le_variance =       0.471244451300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471328273226
                                         uncertainty =       0.002196424500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471328273226
                                         uncertainty =       0.002196424500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485546863
  error estimate for blocks of size 2^( 2) =       0.000507237486
  error estimate for blocks of size 2^( 3) =       0.000526773095
  error estimate for blocks of size 2^( 4) =       0.000542121889
  error estimate for blocks of size 2^( 5) =       0.000552295100
  error estimate for blocks of size 2^( 6) =       0.000556485695
  error estimate for blocks of size 2^( 7) =       0.000559415087

      target function =                  N/A
              le_mean =     -22.820257960645
             les_mean =     521.667268606872
             stat err =       0.000552579443
             autocorr =       1.295171095787
              std dev =       0.686666958148
             le_variance =       0.471511511412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471281261842
                                         uncertainty =       0.002205169972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471281261842
                                         uncertainty =       0.002205169972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485520665
  error estimate for blocks of size 2^( 2) =       0.000507192706
  error estimate for blocks of size 2^( 3) =       0.000526703692
  error estimate for blocks of size 2^( 4) =       0.000542040694
  error estimate for blocks of size 2^( 5) =       0.000552216000
  error estimate for blocks of size 2^( 6) =       0.000556423006
  error estimate for blocks of size 2^( 7) =       0.000559395604

      target function =                  N/A
              le_mean =     -22.820245518295
             les_mean =     521.266083819114
             stat err =       0.000552518826
             autocorr =       1.295026697696
              std dev =       0.686629909507
             le_variance =       0.471460632629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820265567278        initial  <--
     3.9062e-02     3.9062e-01             2.1308e-03       -22.820241874657
     1.5625e-01     1.5625e+00             1.1347e-03       -22.820257960645
     6.2500e-01     6.2500e+00             4.6349e-04       -22.820245518295

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7709
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.193471e-01 3 1  ON 0
ci_02                -2.634456e-02 3 1  ON 1
ci_03                -2.571321e-02 3 1  ON 2
ci_04                 2.560175e-02 3 1  ON 3
ci_05                -2.272080e-02 3 1  ON 4
ci_06                -2.344388e-02 3 1  ON 5
ci_07                 2.603331e-02 3 1  ON 6
ci_08                -4.390430e-03 3 1  ON 7
ci_09                -1.076031e-02 3 1  ON 8
ci_10                -1.155760e-02 3 1  ON 9
ci_11                 1.531467e-02 3 1  ON 10
ci_12                 1.062363e-02 3 1  ON 11
ci_13                 1.143251e-02 3 1  ON 12
ci_14                 1.588356e-02 3 1  ON 13
ci_15                 8.047764e-03 3 1  ON 14
ci_16                 7.444350e-03 3 1  ON 15
ci_17                -9.149468e-03 3 1  ON 16
ci_18                -9.622046e-03 3 1  ON 17
ci_19                 9.302809e-03 3 1  ON 18
ci_20                 1.011878e-02 3 1  ON 19
ci_21                 7.767736e-03 3 1  ON 20
ci_22                 8.639727e-03 3 1  ON 21
ci_23                 5.898336e-03 3 1  ON 22
ci_24                 7.695157e-03 3 1  ON 23
ci_25                 5.140385e-03 3 1  ON 24
ci_26                 2.605227e-03 3 1  ON 25
ci_27                 2.288503e-03 3 1  ON 26
ci_28                 3.971354e-03 3 1  ON 27
ci_29                 3.897756e-03 3 1  ON 28
ci_30                -2.198142e-04 3 1  ON 29
ci_31                -4.566319e-04 3 1  ON 30
ci_32                -4.766311e-04 3 1  ON 31
ci_33                 9.439183e-05 3 1  ON 32
ci_34                 5.903346e-05 3 1  ON 33
ci_35                 1.154582e-03 3 1  ON 34
ci_36                -7.619920e-04 3 1  ON 35
ci_37                -6.350399e-04 3 1  ON 36
ci_38                 2.166231e-04 3 1  ON 37
ci_39                -1.420897e-05 3 1  ON 38
ci_40                -1.406059e-03 3 1  ON 39
ci_41                 1.125460e-03 3 1  ON 40
ci_42                 7.812554e-04 3 1  ON 41
ci_43                -2.015399e-03 3 1  ON 42
ci_44                -2.357508e-03 3 1  ON 43
ci_45                -2.730736e-04 3 1  ON 44
ci_46                -3.773794e-04 3 1  ON 45
ci_47                 3.147213e-04 3 1  ON 46
ci_48                -9.356596e-04 3 1  ON 47
ci_49                -1.183391e-03 3 1  ON 48
ci_50                -1.175300e-03 3 1  ON 49
ci_51                 8.036313e-05 3 1  ON 50
ci_52                 3.192645e-04 3 1  ON 51
ci_53                -7.823842e-04 3 1  ON 52
ci_54                -1.173166e-03 3 1  ON 53
ci_55                -3.365443e-04 3 1  ON 54
ci_56                 1.926919e-03 3 1  ON 55
ci_57                 1.911546e-03 3 1  ON 56
ci_58                -1.482006e-03 3 1  ON 57
ci_59                -1.465258e-03 3 1  ON 58
ci_60                 2.189746e-03 3 1  ON 59
ci_61                 2.492787e-03 3 1  ON 60
ci_62                -3.750679e-04 3 1  ON 61
ci_63                -1.476924e-04 3 1  ON 62
ci_64                -2.325877e-04 3 1  ON 63
ci_65                 1.228552e-04 3 1  ON 64
ci_66                -4.136763e-04 3 1  ON 65
ci_67                -6.816904e-04 3 1  ON 66
ci_68                -1.400088e-03 3 1  ON 67
ci_69                -8.452223e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8219
    reference variance = 0.354203
====================================================
  Execution time = 2.5818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9040e-01
  Total weights = 1.963663373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472981317283
                                         uncertainty =       0.002958521762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472981317283
                                         uncertainty =       0.002958521762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486248053
  error estimate for blocks of size 2^( 2) =       0.000507627144
  error estimate for blocks of size 2^( 3) =       0.000527546236
  error estimate for blocks of size 2^( 4) =       0.000541962493
  error estimate for blocks of size 2^( 5) =       0.000551084307
  error estimate for blocks of size 2^( 6) =       0.000555115024
  error estimate for blocks of size 2^( 7) =       0.000557558587

      target function =                  N/A
              le_mean =     -22.820159446811
             les_mean =     521.250072529719
             stat err =       0.000551430103
             autocorr =       1.286071728798
              std dev =       0.687658590768
             le_variance =       0.472874337457


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282015944681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820159446735       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820169219334       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820169510554       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820169712207       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.560281e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820159446735       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820162651815       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820162723501       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820162732493       residual = 2.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.180082e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820159446735       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820160315759       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820160335470       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820160334804       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.673697e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0363e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.191291e-01 3 1  ON 0
ci_02                -2.628073e-02 3 1  ON 1
ci_03                -2.582335e-02 3 1  ON 2
ci_04                 2.559308e-02 3 1  ON 3
ci_05                -2.270801e-02 3 1  ON 4
ci_06                -2.334025e-02 3 1  ON 5
ci_07                 2.602755e-02 3 1  ON 6
ci_08                -4.477454e-03 3 1  ON 7
ci_09                -1.076823e-02 3 1  ON 8
ci_10                -1.174036e-02 3 1  ON 9
ci_11                 1.535574e-02 3 1  ON 10
ci_12                 1.053814e-02 3 1  ON 11
ci_13                 1.157987e-02 3 1  ON 12
ci_14                 1.593779e-02 3 1  ON 13
ci_15                 7.927921e-03 3 1  ON 14
ci_16                 7.490140e-03 3 1  ON 15
ci_17                -9.191941e-03 3 1  ON 16
ci_18                -9.594051e-03 3 1  ON 17
ci_19                 9.370090e-03 3 1  ON 18
ci_20                 1.027318e-02 3 1  ON 19
ci_21                 7.779551e-03 3 1  ON 20
ci_22                 8.599763e-03 3 1  ON 21
ci_23                 5.913834e-03 3 1  ON 22
ci_24                 7.510787e-03 3 1  ON 23
ci_25                 5.128822e-03 3 1  ON 24
ci_26                 2.718036e-03 3 1  ON 25
ci_27                 2.344025e-03 3 1  ON 26
ci_28                 3.847474e-03 3 1  ON 27
ci_29                 3.903630e-03 3 1  ON 28
ci_30                -4.216821e-04 3 1  ON 29
ci_31                -4.848472e-04 3 1  ON 30
ci_32                -3.951994e-04 3 1  ON 31
ci_33                 1.333615e-04 3 1  ON 32
ci_34                 1.674777e-04 3 1  ON 33
ci_35                 1.128654e-03 3 1  ON 34
ci_36                -6.993731e-04 3 1  ON 35
ci_37                -6.310835e-04 3 1  ON 36
ci_38                 1.653710e-04 3 1  ON 37
ci_39                -1.062184e-04 3 1  ON 38
ci_40                -1.332091e-03 3 1  ON 39
ci_41                 9.393524e-04 3 1  ON 40
ci_42                 8.313584e-04 3 1  ON 41
ci_43                -1.966774e-03 3 1  ON 42
ci_44                -2.277990e-03 3 1  ON 43
ci_45                -1.850954e-04 3 1  ON 44
ci_46                -3.849581e-04 3 1  ON 45
ci_47                 3.112400e-04 3 1  ON 46
ci_48                -8.967121e-04 3 1  ON 47
ci_49                -1.186426e-03 3 1  ON 48
ci_50                -1.096842e-03 3 1  ON 49
ci_51                 6.504786e-05 3 1  ON 50
ci_52                 2.849304e-04 3 1  ON 51
ci_53                -7.980885e-04 3 1  ON 52
ci_54                -1.085875e-03 3 1  ON 53
ci_55                -3.439164e-04 3 1  ON 54
ci_56                 1.853614e-03 3 1  ON 55
ci_57                 1.816378e-03 3 1  ON 56
ci_58                -1.460234e-03 3 1  ON 57
ci_59                -1.472007e-03 3 1  ON 58
ci_60                 2.129876e-03 3 1  ON 59
ci_61                 2.373369e-03 3 1  ON 60
ci_62                -3.194370e-04 3 1  ON 61
ci_63                -1.744612e-04 3 1  ON 62
ci_64                -1.733775e-04 3 1  ON 63
ci_65                 1.208107e-04 3 1  ON 64
ci_66                -4.211386e-04 3 1  ON 65
ci_67                -7.100574e-04 3 1  ON 66
ci_68                -1.411834e-03 3 1  ON 67
ci_69                -1.050259e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8291
    reference variance = 0.402397
====================================================
  Execution time = 2.5116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8599e-01
  Total weights = 1.9635e+06
  Execution time = 3.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471549570204
                                         uncertainty =       0.002787752722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471549570204
                                         uncertainty =       0.002787752722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485553359
  error estimate for blocks of size 2^( 2) =       0.000506669638
  error estimate for blocks of size 2^( 3) =       0.000526462973
  error estimate for blocks of size 2^( 4) =       0.000542083205
  error estimate for blocks of size 2^( 5) =       0.000551625916
  error estimate for blocks of size 2^( 6) =       0.000556249399
  error estimate for blocks of size 2^( 7) =       0.000561137269

      target function =                  N/A
              le_mean =     -22.819164489084
             les_mean =     521.200422868524
             stat err =       0.000552773947
             autocorr =       1.296048358240
              std dev =       0.686676145324
             le_variance =       0.471524128556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471438572135
                                         uncertainty =       0.002758264476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471438572135
                                         uncertainty =       0.002758264476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485496262
  error estimate for blocks of size 2^( 2) =       0.000506618979
  error estimate for blocks of size 2^( 3) =       0.000526410445
  error estimate for blocks of size 2^( 4) =       0.000542033421
  error estimate for blocks of size 2^( 5) =       0.000551570690
  error estimate for blocks of size 2^( 6) =       0.000556185417
  error estimate for blocks of size 2^( 7) =       0.000561076660

      target function =                  N/A
              le_mean =     -22.819164581656
             les_mean =     521.214649246230
             stat err =       0.000552716547
             autocorr =       1.296084006816
              std dev =       0.686595398449
             le_variance =       0.471413241172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471468659903
                                         uncertainty =       0.002768575319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471468659903
                                         uncertainty =       0.002768575319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485511732
  error estimate for blocks of size 2^( 2) =       0.000506631796
  error estimate for blocks of size 2^( 3) =       0.000526423064
  error estimate for blocks of size 2^( 4) =       0.000542044888
  error estimate for blocks of size 2^( 5) =       0.000551581425
  error estimate for blocks of size 2^( 6) =       0.000556208032
  error estimate for blocks of size 2^( 7) =       0.000561098820

      target function =                  N/A
              le_mean =     -22.819161378678
             les_mean =     521.439445692595
             stat err =       0.000552733291
             autocorr =       1.296079941615
              std dev =       0.686617275508
             le_variance =       0.471443283026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471535007180
                                         uncertainty =       0.002785056190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471535007180
                                         uncertainty =       0.002785056190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485545867
  error estimate for blocks of size 2^( 2) =       0.000506662658
  error estimate for blocks of size 2^( 3) =       0.000526456089
  error estimate for blocks of size 2^( 4) =       0.000542076446
  error estimate for blocks of size 2^( 5) =       0.000551618237
  error estimate for blocks of size 2^( 6) =       0.000556240718
  error estimate for blocks of size 2^( 7) =       0.000561133103

      target function =                  N/A
              le_mean =     -22.819164116304
             les_mean =     521.203173236801
             stat err =       0.000552767126
             autocorr =       1.296056368683
              std dev =       0.686665550072
             le_variance =       0.471509577656


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819164489084        initial
     3.9062e-01     3.9062e+00             7.5603e-04       -22.819164581656  <--
     1.5625e+00     1.5625e+01             2.1801e-04       -22.819161378678
     6.2500e+00     6.2500e+01             5.6737e-05       -22.819164116304

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.2762e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.185911e-01 3 1  ON 0
ci_02                -2.615926e-02 3 1  ON 1
ci_03                -2.605952e-02 3 1  ON 2
ci_04                 2.557759e-02 3 1  ON 3
ci_05                -2.268324e-02 3 1  ON 4
ci_06                -2.311871e-02 3 1  ON 5
ci_07                 2.601022e-02 3 1  ON 6
ci_08                -4.623690e-03 3 1  ON 7
ci_09                -1.078754e-02 3 1  ON 8
ci_10                -1.213361e-02 3 1  ON 9
ci_11                 1.543462e-02 3 1  ON 10
ci_12                 1.036961e-02 3 1  ON 11
ci_13                 1.189666e-02 3 1  ON 12
ci_14                 1.606132e-02 3 1  ON 13
ci_15                 7.669509e-03 3 1  ON 14
ci_16                 7.561291e-03 3 1  ON 15
ci_17                -9.281934e-03 3 1  ON 16
ci_18                -9.532014e-03 3 1  ON 17
ci_19                 9.496151e-03 3 1  ON 18
ci_20                 1.058876e-02 3 1  ON 19
ci_21                 7.826867e-03 3 1  ON 20
ci_22                 8.524575e-03 3 1  ON 21
ci_23                 5.936838e-03 3 1  ON 22
ci_24                 7.075747e-03 3 1  ON 23
ci_25                 5.110493e-03 3 1  ON 24
ci_26                 2.931890e-03 3 1  ON 25
ci_27                 2.465252e-03 3 1  ON 26
ci_28                 3.581604e-03 3 1  ON 27
ci_29                 3.910732e-03 3 1  ON 28
ci_30                -8.550417e-04 3 1  ON 29
ci_31                -5.253686e-04 3 1  ON 30
ci_32                -2.412711e-04 3 1  ON 31
ci_33                 2.034937e-04 3 1  ON 32
ci_34                 3.820850e-04 3 1  ON 33
ci_35                 1.072885e-03 3 1  ON 34
ci_36                -5.891760e-04 3 1  ON 35
ci_37                -6.287702e-04 3 1  ON 36
ci_38                 6.719116e-05 3 1  ON 37
ci_39                -2.750917e-04 3 1  ON 38
ci_40                -1.215106e-03 3 1  ON 39
ci_41                 5.944156e-04 3 1  ON 40
ci_42                 9.208010e-04 3 1  ON 41
ci_43                -1.850548e-03 3 1  ON 42
ci_44                -2.103541e-03 3 1  ON 43
ci_45                -2.684475e-05 3 1  ON 44
ci_46                -3.981837e-04 3 1  ON 45
ci_47                 3.016667e-04 3 1  ON 46
ci_48                -8.355546e-04 3 1  ON 47
ci_49                -1.195812e-03 3 1  ON 48
ci_50                -9.792986e-04 3 1  ON 49
ci_51                 4.140159e-05 3 1  ON 50
ci_52                 2.230685e-04 3 1  ON 51
ci_53                -8.245784e-04 3 1  ON 52
ci_54                -9.084364e-04 3 1  ON 53
ci_55                -3.644655e-04 3 1  ON 54
ci_56                 1.714103e-03 3 1  ON 55
ci_57                 1.649731e-03 3 1  ON 56
ci_58                -1.411250e-03 3 1  ON 57
ci_59                -1.477798e-03 3 1  ON 58
ci_60                 1.979052e-03 3 1  ON 59
ci_61                 2.073618e-03 3 1  ON 60
ci_62                -2.292146e-04 3 1  ON 61
ci_63                -2.223298e-04 3 1  ON 62
ci_64                -6.543222e-05 3 1  ON 63
ci_65                 1.073257e-04 3 1  ON 64
ci_66                -4.381442e-04 3 1  ON 65
ci_67                -7.652362e-04 3 1  ON 66
ci_68                -1.433138e-03 3 1  ON 67
ci_69                -1.451927e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7858
    reference variance = 0.364947
====================================================
  Execution time = 2.5716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8533e-01
  Total weights = 1.963602563e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470901696564
                                         uncertainty =       0.002421045815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470901696564
                                         uncertainty =       0.002421045815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485201907
  error estimate for blocks of size 2^( 2) =       0.000506318430
  error estimate for blocks of size 2^( 3) =       0.000526863970
  error estimate for blocks of size 2^( 4) =       0.000542233256
  error estimate for blocks of size 2^( 5) =       0.000553636563
  error estimate for blocks of size 2^( 6) =       0.000556804432
  error estimate for blocks of size 2^( 7) =       0.000557484881

      target function =                  N/A
              le_mean =     -22.819112895408
             les_mean =     521.197243215224
             stat err =       0.000552539783
             autocorr =       1.296827190556
              std dev =       0.686179117109
             le_variance =       0.470841780757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281911289541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819112895372       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819129091255       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819136267173       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819137085770       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819137099879       residual = 8.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 2.295402e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819112895372       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819121937910       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819124211193       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819124304584       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819124290743       residual = 2.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 8.748109e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819112895372       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819116163707       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819116675020       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819116674045       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.531900e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0257e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.177163e-01 3 1  ON 0
ci_02                -2.634338e-02 3 1  ON 1
ci_03                -2.591209e-02 3 1  ON 2
ci_04                 2.563728e-02 3 1  ON 3
ci_05                -2.256748e-02 3 1  ON 4
ci_06                -2.315237e-02 3 1  ON 5
ci_07                 2.594332e-02 3 1  ON 6
ci_08                -4.677397e-03 3 1  ON 7
ci_09                -1.126228e-02 3 1  ON 8
ci_10                -1.208682e-02 3 1  ON 9
ci_11                 1.539111e-02 3 1  ON 10
ci_12                 1.027435e-02 3 1  ON 11
ci_13                 1.196009e-02 3 1  ON 12
ci_14                 1.645982e-02 3 1  ON 13
ci_15                 8.293157e-03 3 1  ON 14
ci_16                 7.341260e-03 3 1  ON 15
ci_17                -9.514764e-03 3 1  ON 16
ci_18                -9.564757e-03 3 1  ON 17
ci_19                 9.089008e-03 3 1  ON 18
ci_20                 1.045943e-02 3 1  ON 19
ci_21                 8.062902e-03 3 1  ON 20
ci_22                 8.332680e-03 3 1  ON 21
ci_23                 5.884800e-03 3 1  ON 22
ci_24                 6.765197e-03 3 1  ON 23
ci_25                 4.541375e-03 3 1  ON 24
ci_26                 2.337189e-03 3 1  ON 25
ci_27                 2.089183e-03 3 1  ON 26
ci_28                 3.496029e-03 3 1  ON 27
ci_29                 3.406235e-03 3 1  ON 28
ci_30                -6.745869e-04 3 1  ON 29
ci_31                -4.471060e-04 3 1  ON 30
ci_32                -5.140509e-04 3 1  ON 31
ci_33                 1.888274e-04 3 1  ON 32
ci_34                 4.637035e-04 3 1  ON 33
ci_35                 8.948788e-04 3 1  ON 34
ci_36                -3.235330e-04 3 1  ON 35
ci_37                -8.188583e-04 3 1  ON 36
ci_38                 2.890246e-04 3 1  ON 37
ci_39                -1.549927e-04 3 1  ON 38
ci_40                -1.518294e-03 3 1  ON 39
ci_41                 6.102576e-04 3 1  ON 40
ci_42                 9.971458e-04 3 1  ON 41
ci_43                -1.667685e-03 3 1  ON 42
ci_44                -2.033736e-03 3 1  ON 43
ci_45                 9.463982e-05 3 1  ON 44
ci_46                -1.469932e-04 3 1  ON 45
ci_47                -4.726850e-04 3 1  ON 46
ci_48                -1.077861e-03 3 1  ON 47
ci_49                -1.618162e-03 3 1  ON 48
ci_50                -8.674929e-04 3 1  ON 49
ci_51                 1.730662e-04 3 1  ON 50
ci_52                -1.001748e-05 3 1  ON 51
ci_53                -9.825938e-04 3 1  ON 52
ci_54                -1.068073e-03 3 1  ON 53
ci_55                -5.535679e-04 3 1  ON 54
ci_56                 1.345274e-03 3 1  ON 55
ci_57                 1.062470e-03 3 1  ON 56
ci_58                -1.448928e-03 3 1  ON 57
ci_59                -1.747880e-03 3 1  ON 58
ci_60                 1.468819e-03 3 1  ON 59
ci_61                 2.129431e-03 3 1  ON 60
ci_62                -5.034401e-04 3 1  ON 61
ci_63                -5.170448e-04 3 1  ON 62
ci_64                 3.258202e-04 3 1  ON 63
ci_65                 1.672334e-04 3 1  ON 64
ci_66                -4.756801e-04 3 1  ON 65
ci_67                -5.698531e-04 3 1  ON 66
ci_68                -1.418298e-03 3 1  ON 67
ci_69                -1.332645e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8868
    reference variance = 0.297567
====================================================
  Execution time = 2.5177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9175e-01
  Total weights = 1.9638e+06
  Execution time = 3.8931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469764251086
                                         uncertainty =       0.002479228062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469764251086
                                         uncertainty =       0.002479228062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484694919
  error estimate for blocks of size 2^( 2) =       0.000506197360
  error estimate for blocks of size 2^( 3) =       0.000526809629
  error estimate for blocks of size 2^( 4) =       0.000542298200
  error estimate for blocks of size 2^( 5) =       0.000550960011
  error estimate for blocks of size 2^( 6) =       0.000555817285
  error estimate for blocks of size 2^( 7) =       0.000560802794

      target function =                  N/A
              le_mean =     -22.819447278598
             les_mean =     521.537524212990
             stat err =       0.000552469572
             autocorr =       1.299211310915
              std dev =       0.685462128752
             le_variance =       0.469858329953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474549219077
                                         uncertainty =       0.006257011194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474549219077
                                         uncertainty =       0.006257011194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487156111
  error estimate for blocks of size 2^( 2) =       0.000508556245
  error estimate for blocks of size 2^( 3) =       0.000529120885
  error estimate for blocks of size 2^( 4) =       0.000544599804
  error estimate for blocks of size 2^( 5) =       0.000553127217
  error estimate for blocks of size 2^( 6) =       0.000558190407
  error estimate for blocks of size 2^( 7) =       0.000563181252

      target function =                  N/A
              le_mean =     -22.819483906347
             les_mean =     521.275359676335
             stat err =       0.000554774670
             autocorr =       1.296871473063
              std dev =       0.688942779662
             le_variance =       0.474642153648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473235183929
                                         uncertainty =       0.004920020506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473235183929
                                         uncertainty =       0.004920020506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486481859
  error estimate for blocks of size 2^( 2) =       0.000507916163
  error estimate for blocks of size 2^( 3) =       0.000528506968
  error estimate for blocks of size 2^( 4) =       0.000543977962
  error estimate for blocks of size 2^( 5) =       0.000552557524
  error estimate for blocks of size 2^( 6) =       0.000557557290
  error estimate for blocks of size 2^( 7) =       0.000562519422

      target function =                  N/A
              le_mean =     -22.819482112897
             les_mean =     521.266093342732
             stat err =       0.000554153049
             autocorr =       1.297556132516
              std dev =       0.687989243093
             le_variance =       0.473329198612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469827018253
                                         uncertainty =       0.002555653793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469827018253
                                         uncertainty =       0.002555653793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484727607
  error estimate for blocks of size 2^( 2) =       0.000506227480
  error estimate for blocks of size 2^( 3) =       0.000526845277
  error estimate for blocks of size 2^( 4) =       0.000542339924
  error estimate for blocks of size 2^( 5) =       0.000550996824
  error estimate for blocks of size 2^( 6) =       0.000555876488
  error estimate for blocks of size 2^( 7) =       0.000560830316

      target function =                  N/A
              le_mean =     -22.819444363337
             les_mean =     521.235635619637
             stat err =       0.000552510888
             autocorr =       1.299230395652
              std dev =       0.685508355179
             le_variance =       0.469921705020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819447278598        initial
     9.7656e-02     9.7656e-01             2.2954e-03       -22.819483906347  <--
     3.9062e-01     3.9062e+00             8.7481e-04       -22.819482112897
     1.5625e+00     1.5625e+01             2.5319e-04       -22.819444363337

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.3545e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.162957e-01 3 1  ON 0
ci_02                -2.657065e-02 3 1  ON 1
ci_03                -2.575567e-02 3 1  ON 2
ci_04                 2.568970e-02 3 1  ON 3
ci_05                -2.247873e-02 3 1  ON 4
ci_06                -2.319087e-02 3 1  ON 5
ci_07                 2.593713e-02 3 1  ON 6
ci_08                -4.713318e-03 3 1  ON 7
ci_09                -1.182881e-02 3 1  ON 8
ci_10                -1.208105e-02 3 1  ON 9
ci_11                 1.539771e-02 3 1  ON 10
ci_12                 1.020473e-02 3 1  ON 11
ci_13                 1.210796e-02 3 1  ON 12
ci_14                 1.724102e-02 3 1  ON 13
ci_15                 8.978322e-03 3 1  ON 14
ci_16                 7.104306e-03 3 1  ON 15
ci_17                -9.780738e-03 3 1  ON 16
ci_18                -9.589473e-03 3 1  ON 17
ci_19                 8.863234e-03 3 1  ON 18
ci_20                 1.027835e-02 3 1  ON 19
ci_21                 8.320287e-03 3 1  ON 20
ci_22                 8.075737e-03 3 1  ON 21
ci_23                 5.886407e-03 3 1  ON 22
ci_24                 6.276399e-03 3 1  ON 23
ci_25                 3.993311e-03 3 1  ON 24
ci_26                 1.688353e-03 3 1  ON 25
ci_27                 1.588474e-03 3 1  ON 26
ci_28                 3.398889e-03 3 1  ON 27
ci_29                 2.899436e-03 3 1  ON 28
ci_30                -4.646341e-04 3 1  ON 29
ci_31                -4.029338e-04 3 1  ON 30
ci_32                -7.388487e-04 3 1  ON 31
ci_33                 1.617979e-04 3 1  ON 32
ci_34                 5.460047e-04 3 1  ON 33
ci_35                 6.935658e-04 3 1  ON 34
ci_36                -1.229983e-04 3 1  ON 35
ci_37                -9.702414e-04 3 1  ON 36
ci_38                 4.577014e-04 3 1  ON 37
ci_39                -4.915645e-05 3 1  ON 38
ci_40                -1.673096e-03 3 1  ON 39
ci_41                 6.262723e-04 3 1  ON 40
ci_42                 1.039114e-03 3 1  ON 41
ci_43                -1.492957e-03 3 1  ON 42
ci_44                -1.941763e-03 3 1  ON 43
ci_45                 2.032688e-04 3 1  ON 44
ci_46                 4.029421e-05 3 1  ON 45
ci_47                -1.374067e-03 3 1  ON 46
ci_48                -1.349250e-03 3 1  ON 47
ci_49                -1.990209e-03 3 1  ON 48
ci_50                -8.064766e-04 3 1  ON 49
ci_51                 2.769611e-04 3 1  ON 50
ci_52                -2.030716e-04 3 1  ON 51
ci_53                -1.071482e-03 3 1  ON 52
ci_54                -1.247136e-03 3 1  ON 53
ci_55                -7.624755e-04 3 1  ON 54
ci_56                 1.102812e-03 3 1  ON 55
ci_57                 6.283188e-04 3 1  ON 56
ci_58                -1.485600e-03 3 1  ON 57
ci_59                -2.039180e-03 3 1  ON 58
ci_60                 5.710738e-04 3 1  ON 59
ci_61                 2.263262e-03 3 1  ON 60
ci_62                -6.556375e-04 3 1  ON 61
ci_63                -6.578015e-04 3 1  ON 62
ci_64                 6.826142e-04 3 1  ON 63
ci_65                 2.141276e-04 3 1  ON 64
ci_66                -5.188495e-04 3 1  ON 65
ci_67                -3.912513e-04 3 1  ON 66
ci_68                -1.404735e-03 3 1  ON 67
ci_69                -1.235734e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8292
    reference variance = 0.354099
====================================================
  Execution time = 2.5690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8695e-01
  Total weights = 1.963632932e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469405814197
                                         uncertainty =       0.002129019643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469405814197
                                         uncertainty =       0.002129019643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484407643
  error estimate for blocks of size 2^( 2) =       0.000506155125
  error estimate for blocks of size 2^( 3) =       0.000526301949
  error estimate for blocks of size 2^( 4) =       0.000540992197
  error estimate for blocks of size 2^( 5) =       0.000550667974
  error estimate for blocks of size 2^( 6) =       0.000555921283
  error estimate for blocks of size 2^( 7) =       0.000556617277

      target function =                  N/A
              le_mean =     -22.819483188695
             les_mean =     521.215765767757
             stat err =       0.000551049683
             autocorr =       1.294075276176
              std dev =       0.685055858389
             le_variance =       0.469301529113


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281948318869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819483188608       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819537586349       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819534607460       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819533332674       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819533646903       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819533502183       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 4.141810e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819483188608       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819523802339       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819521891735       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819521315819       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819521392788       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 2.323574e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819483188608       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819503358489       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819503125878       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819503050003       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 8.491476e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0218e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.157382e-01 3 1  ON 0
ci_02                -2.520959e-02 3 1  ON 1
ci_03                -2.619648e-02 3 1  ON 2
ci_04                 2.518361e-02 3 1  ON 3
ci_05                -2.255791e-02 3 1  ON 4
ci_06                -2.312972e-02 3 1  ON 5
ci_07                 2.580772e-02 3 1  ON 6
ci_08                -4.511145e-03 3 1  ON 7
ci_09                -1.162903e-02 3 1  ON 8
ci_10                -1.130064e-02 3 1  ON 9
ci_11                 1.667200e-02 3 1  ON 10
ci_12                 1.098628e-02 3 1  ON 11
ci_13                 1.252702e-02 3 1  ON 12
ci_14                 1.701556e-02 3 1  ON 13
ci_15                 8.945389e-03 3 1  ON 14
ci_16                 8.240954e-03 3 1  ON 15
ci_17                -9.756140e-03 3 1  ON 16
ci_18                -9.952939e-03 3 1  ON 17
ci_19                 8.715773e-03 3 1  ON 18
ci_20                 1.085547e-02 3 1  ON 19
ci_21                 8.769823e-03 3 1  ON 20
ci_22                 8.377211e-03 3 1  ON 21
ci_23                 6.234618e-03 3 1  ON 22
ci_24                 5.428407e-03 3 1  ON 23
ci_25                 4.375953e-03 3 1  ON 24
ci_26                 2.331487e-03 3 1  ON 25
ci_27                 2.358126e-03 3 1  ON 26
ci_28                 3.780344e-03 3 1  ON 27
ci_29                 3.160838e-03 3 1  ON 28
ci_30                 2.676117e-04 3 1  ON 29
ci_31                -3.953146e-04 3 1  ON 30
ci_32                 2.313802e-04 3 1  ON 31
ci_33                 4.532328e-04 3 1  ON 32
ci_34                 2.257903e-04 3 1  ON 33
ci_35                 1.851702e-03 3 1  ON 34
ci_36                -3.972642e-04 3 1  ON 35
ci_37                -9.644175e-05 3 1  ON 36
ci_38                 1.102942e-05 3 1  ON 37
ci_39                -5.650692e-04 3 1  ON 38
ci_40                -1.222089e-03 3 1  ON 39
ci_41                 2.799388e-04 3 1  ON 40
ci_42                 6.558026e-04 3 1  ON 41
ci_43                -1.673582e-03 3 1  ON 42
ci_44                -2.619683e-03 3 1  ON 43
ci_45                -3.857818e-04 3 1  ON 44
ci_46                -5.635773e-05 3 1  ON 45
ci_47                -6.185956e-04 3 1  ON 46
ci_48                -1.363520e-03 3 1  ON 47
ci_49                -1.549664e-03 3 1  ON 48
ci_50                -8.231390e-04 3 1  ON 49
ci_51                -9.723134e-04 3 1  ON 50
ci_52                 3.434324e-05 3 1  ON 51
ci_53                -1.009388e-03 3 1  ON 52
ci_54                -8.329124e-04 3 1  ON 53
ci_55                -9.339438e-04 3 1  ON 54
ci_56                 1.730896e-03 3 1  ON 55
ci_57                 2.061555e-03 3 1  ON 56
ci_58                -1.706741e-03 3 1  ON 57
ci_59                -9.497386e-04 3 1  ON 58
ci_60                 2.894647e-03 3 1  ON 59
ci_61                 3.046560e-03 3 1  ON 60
ci_62                -6.576058e-04 3 1  ON 61
ci_63                -4.793686e-06 3 1  ON 62
ci_64                 1.496632e-04 3 1  ON 63
ci_65                -7.937256e-05 3 1  ON 64
ci_66                -3.686871e-04 3 1  ON 65
ci_67                -2.971300e-04 3 1  ON 66
ci_68                -1.535643e-03 3 1  ON 67
ci_69                -1.261032e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8574
    reference variance = 0.369313
====================================================
  Execution time = 2.5058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8338e-01
  Total weights = 1.9636e+06
  Execution time = 3.5024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472233655663
                                         uncertainty =       0.002799860640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472233655663
                                         uncertainty =       0.002799860640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485868354
  error estimate for blocks of size 2^( 2) =       0.000507728414
  error estimate for blocks of size 2^( 3) =       0.000528255627
  error estimate for blocks of size 2^( 4) =       0.000543882379
  error estimate for blocks of size 2^( 5) =       0.000553357668
  error estimate for blocks of size 2^( 6) =       0.000558424545
  error estimate for blocks of size 2^( 7) =       0.000560442546

      target function =                  N/A
              le_mean =     -22.819357796060
             les_mean =     521.502323345939
             stat err =       0.000554026785
             autocorr =       1.300242318065
              std dev =       0.687121615711
             le_variance =       0.472136114777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474107844693
                                         uncertainty =       0.004588197400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474107844693
                                         uncertainty =       0.004588197400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486835438
  error estimate for blocks of size 2^( 2) =       0.000508693057
  error estimate for blocks of size 2^( 3) =       0.000529238656
  error estimate for blocks of size 2^( 4) =       0.000544940297
  error estimate for blocks of size 2^( 5) =       0.000554434082
  error estimate for blocks of size 2^( 6) =       0.000559394748
  error estimate for blocks of size 2^( 7) =       0.000561345707

      target function =                  N/A
              le_mean =     -22.819334116782
             les_mean =     521.329364197442
             stat err =       0.000555028709
             autocorr =       1.299770052129
              std dev =       0.688489279319
             le_variance =       0.474017487737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470679954598
                                         uncertainty =       0.002614413765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470679954598
                                         uncertainty =       0.002614413765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485070533
  error estimate for blocks of size 2^( 2) =       0.000506991190
  error estimate for blocks of size 2^( 3) =       0.000527612560
  error estimate for blocks of size 2^( 4) =       0.000543264415
  error estimate for blocks of size 2^( 5) =       0.000552822472
  error estimate for blocks of size 2^( 6) =       0.000558045582
  error estimate for blocks of size 2^( 7) =       0.000560210091

      target function =                  N/A
              le_mean =     -22.819412972141
             les_mean =     521.247480959994
             stat err =       0.000553585640
             autocorr =       1.302446358887
              std dev =       0.685993326497
             le_variance =       0.470586843999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470145602533
                                         uncertainty =       0.002598983379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470145602533
                                         uncertainty =       0.002598983379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484794876
  error estimate for blocks of size 2^( 2) =       0.000506697831
  error estimate for blocks of size 2^( 3) =       0.000527264041
  error estimate for blocks of size 2^( 4) =       0.000542913716
  error estimate for blocks of size 2^( 5) =       0.000552434056
  error estimate for blocks of size 2^( 6) =       0.000557571319
  error estimate for blocks of size 2^( 7) =       0.000559685025

      target function =                  N/A
              le_mean =     -22.819377147310
             les_mean =     521.212764339473
             stat err =       0.000553151029
             autocorr =       1.301881354236
              std dev =       0.685603489166
             le_variance =       0.470052144357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819357796060        initial
     2.4414e-02     2.4414e-01             4.1418e-03       -22.819334116782
     9.7656e-02     9.7656e-01             2.3236e-03       -22.819412972141  <--
     3.9062e-01     3.9062e+00             8.4915e-04       -22.819377147310

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.2671e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.157382e-01 3 1  ON 0
ci_02                -2.520959e-02 3 1  ON 1
ci_03                -2.619648e-02 3 1  ON 2
ci_04                 2.518361e-02 3 1  ON 3
ci_05                -2.255791e-02 3 1  ON 4
ci_06                -2.312972e-02 3 1  ON 5
ci_07                 2.580772e-02 3 1  ON 6
ci_08                -4.511145e-03 3 1  ON 7
ci_09                -1.162903e-02 3 1  ON 8
ci_10                -1.130064e-02 3 1  ON 9
ci_11                 1.667200e-02 3 1  ON 10
ci_12                 1.098628e-02 3 1  ON 11
ci_13                 1.252702e-02 3 1  ON 12
ci_14                 1.701556e-02 3 1  ON 13
ci_15                 8.945389e-03 3 1  ON 14
ci_16                 8.240954e-03 3 1  ON 15
ci_17                -9.756140e-03 3 1  ON 16
ci_18                -9.952939e-03 3 1  ON 17
ci_19                 8.715773e-03 3 1  ON 18
ci_20                 1.085547e-02 3 1  ON 19
ci_21                 8.769823e-03 3 1  ON 20
ci_22                 8.377211e-03 3 1  ON 21
ci_23                 6.234618e-03 3 1  ON 22
ci_24                 5.428407e-03 3 1  ON 23
ci_25                 4.375953e-03 3 1  ON 24
ci_26                 2.331487e-03 3 1  ON 25
ci_27                 2.358126e-03 3 1  ON 26
ci_28                 3.780344e-03 3 1  ON 27
ci_29                 3.160838e-03 3 1  ON 28
ci_30                 2.676117e-04 3 1  ON 29
ci_31                -3.953146e-04 3 1  ON 30
ci_32                 2.313802e-04 3 1  ON 31
ci_33                 4.532328e-04 3 1  ON 32
ci_34                 2.257903e-04 3 1  ON 33
ci_35                 1.851702e-03 3 1  ON 34
ci_36                -3.972642e-04 3 1  ON 35
ci_37                -9.644175e-05 3 1  ON 36
ci_38                 1.102942e-05 3 1  ON 37
ci_39                -5.650692e-04 3 1  ON 38
ci_40                -1.222089e-03 3 1  ON 39
ci_41                 2.799388e-04 3 1  ON 40
ci_42                 6.558026e-04 3 1  ON 41
ci_43                -1.673582e-03 3 1  ON 42
ci_44                -2.619683e-03 3 1  ON 43
ci_45                -3.857818e-04 3 1  ON 44
ci_46                -5.635773e-05 3 1  ON 45
ci_47                -6.185956e-04 3 1  ON 46
ci_48                -1.363520e-03 3 1  ON 47
ci_49                -1.549664e-03 3 1  ON 48
ci_50                -8.231390e-04 3 1  ON 49
ci_51                -9.723134e-04 3 1  ON 50
ci_52                 3.434324e-05 3 1  ON 51
ci_53                -1.009388e-03 3 1  ON 52
ci_54                -8.329124e-04 3 1  ON 53
ci_55                -9.339438e-04 3 1  ON 54
ci_56                 1.730896e-03 3 1  ON 55
ci_57                 2.061555e-03 3 1  ON 56
ci_58                -1.706741e-03 3 1  ON 57
ci_59                -9.497386e-04 3 1  ON 58
ci_60                 2.894647e-03 3 1  ON 59
ci_61                 3.046560e-03 3 1  ON 60
ci_62                -6.576058e-04 3 1  ON 61
ci_63                -4.793686e-06 3 1  ON 62
ci_64                 1.496632e-04 3 1  ON 63
ci_65                -7.937256e-05 3 1  ON 64
ci_66                -3.686871e-04 3 1  ON 65
ci_67                -2.971300e-04 3 1  ON 66
ci_68                -1.535643e-03 3 1  ON 67
ci_69                -1.261032e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8154
    reference variance = 0.411112
====================================================
  Execution time = 2.5463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9012e-01
  Total weights = 1.963796822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472465464538
                                         uncertainty =       0.002607310866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472465464538
                                         uncertainty =       0.002607310866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486153667
  error estimate for blocks of size 2^( 2) =       0.000507326592
  error estimate for blocks of size 2^( 3) =       0.000527878459
  error estimate for blocks of size 2^( 4) =       0.000543070677
  error estimate for blocks of size 2^( 5) =       0.000552230724
  error estimate for blocks of size 2^( 6) =       0.000559225768
  error estimate for blocks of size 2^( 7) =       0.000562373758

      target function =                  N/A
              le_mean =     -22.818841117462
             les_mean =     521.189632524291
             stat err =       0.000554225232
             autocorr =       1.299647138843
              std dev =       0.687525109825
             le_variance =       0.472690776639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281884111746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818841117364       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818876461720       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818880910459       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818880420924       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818880225458       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818880215933       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 3.656257e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818841117364       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818867696353       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818869781665       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818869528062       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818869511802       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 2.064919e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818841117364       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818854460211       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818855180049       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818855132907       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.577577e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9995e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548912e-02 3 1  ON 1
ci_03                -2.577487e-02 3 1  ON 2
ci_04                 2.521632e-02 3 1  ON 3
ci_05                -2.312375e-02 3 1  ON 4
ci_06                -2.242890e-02 3 1  ON 5
ci_07                 2.484812e-02 3 1  ON 6
ci_08                -4.582615e-03 3 1  ON 7
ci_09                -1.125886e-02 3 1  ON 8
ci_10                -1.180359e-02 3 1  ON 9
ci_11                 1.629248e-02 3 1  ON 10
ci_12                 1.118562e-02 3 1  ON 11
ci_13                 1.205636e-02 3 1  ON 12
ci_14                 1.764315e-02 3 1  ON 13
ci_15                 8.680594e-03 3 1  ON 14
ci_16                 8.617760e-03 3 1  ON 15
ci_17                -1.052891e-02 3 1  ON 16
ci_18                -9.317148e-03 3 1  ON 17
ci_19                 8.993548e-03 3 1  ON 18
ci_20                 1.026259e-02 3 1  ON 19
ci_21                 8.533095e-03 3 1  ON 20
ci_22                 7.503451e-03 3 1  ON 21
ci_23                 5.759386e-03 3 1  ON 22
ci_24                 6.097622e-03 3 1  ON 23
ci_25                 4.930440e-03 3 1  ON 24
ci_26                 3.258693e-03 3 1  ON 25
ci_27                 2.890504e-03 3 1  ON 26
ci_28                 4.664108e-03 3 1  ON 27
ci_29                 3.579215e-03 3 1  ON 28
ci_30                -7.929783e-04 3 1  ON 29
ci_31                 2.366107e-04 3 1  ON 30
ci_32                 5.001516e-04 3 1  ON 31
ci_33                -3.522402e-04 3 1  ON 32
ci_34                 3.540037e-04 3 1  ON 33
ci_35                 2.195728e-03 3 1  ON 34
ci_36                -1.193266e-03 3 1  ON 35
ci_37                -7.580114e-04 3 1  ON 36
ci_38                -9.970527e-04 3 1  ON 37
ci_39                -3.896373e-04 3 1  ON 38
ci_40                -1.036563e-03 3 1  ON 39
ci_41                 9.202130e-04 3 1  ON 40
ci_42                 5.567817e-04 3 1  ON 41
ci_43                -1.728779e-03 3 1  ON 42
ci_44                -2.018441e-03 3 1  ON 43
ci_45                -3.021976e-04 3 1  ON 44
ci_46                -4.028905e-04 3 1  ON 45
ci_47                -5.145344e-04 3 1  ON 46
ci_48                -8.817022e-04 3 1  ON 47
ci_49                -1.271242e-03 3 1  ON 48
ci_50                -7.604163e-04 3 1  ON 49
ci_51                 3.446730e-05 3 1  ON 50
ci_52                -6.669055e-04 3 1  ON 51
ci_53                -1.487982e-03 3 1  ON 52
ci_54                -1.058697e-03 3 1  ON 53
ci_55                -1.448743e-03 3 1  ON 54
ci_56                 1.645685e-03 3 1  ON 55
ci_57                 1.475921e-03 3 1  ON 56
ci_58                -1.262658e-03 3 1  ON 57
ci_59                -1.217946e-03 3 1  ON 58
ci_60                 8.297284e-04 3 1  ON 59
ci_61                 2.302037e-03 3 1  ON 60
ci_62                -7.289331e-04 3 1  ON 61
ci_63                -8.392719e-04 3 1  ON 62
ci_64                -1.192436e-04 3 1  ON 63
ci_65                -1.810601e-04 3 1  ON 64
ci_66                -2.228659e-04 3 1  ON 65
ci_67                -1.077464e-03 3 1  ON 66
ci_68                -2.563803e-03 3 1  ON 67
ci_69                -1.691485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7655
    reference variance = 0.337062
====================================================
  Execution time = 2.4847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8595e-01
  Total weights = 1.9639e+06
  Execution time = 3.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0137276
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477419422243
                                         uncertainty =       0.006814512602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477419422243
                                         uncertainty =       0.006814512602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488521907
  error estimate for blocks of size 2^( 2) =       0.000509936782
  error estimate for blocks of size 2^( 3) =       0.000530162855
  error estimate for blocks of size 2^( 4) =       0.000545933376
  error estimate for blocks of size 2^( 5) =       0.000556302128
  error estimate for blocks of size 2^( 6) =       0.000561210679
  error estimate for blocks of size 2^( 7) =       0.000565909627

      target function =                  N/A
              le_mean =     -22.819121368720
             les_mean =     535.907811815290
             stat err =       0.000557338953
             autocorr =       1.301579520979
              std dev =       0.690874306418
             le_variance =       0.477307307268

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.291251
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471126613493
                                         uncertainty =       0.002319097273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471126613493
                                         uncertainty =       0.002319097273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485293083
  error estimate for blocks of size 2^( 2) =       0.000506814463
  error estimate for blocks of size 2^( 3) =       0.000527081387
  error estimate for blocks of size 2^( 4) =       0.000542760664
  error estimate for blocks of size 2^( 5) =       0.000553288167
  error estimate for blocks of size 2^( 6) =       0.000558109160
  error estimate for blocks of size 2^( 7) =       0.000562458414

      target function =                  N/A
              le_mean =     -22.819138910716
             les_mean =     521.288974958492
             stat err =       0.000554154101
             autocorr =       1.303925868479
              std dev =       0.686308059499
             le_variance =       0.471018752533

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0140062
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471128115109
                                         uncertainty =       0.002175099090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471128115109
                                         uncertainty =       0.002175099090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485293668
  error estimate for blocks of size 2^( 2) =       0.000506815605
  error estimate for blocks of size 2^( 3) =       0.000527070617
  error estimate for blocks of size 2^( 4) =       0.000542757468
  error estimate for blocks of size 2^( 5) =       0.000553257588
  error estimate for blocks of size 2^( 6) =       0.000558129861
  error estimate for blocks of size 2^( 7) =       0.000562407307

      target function =                  N/A
              le_mean =     -22.819184557773
             les_mean =     521.225058677122
             stat err =       0.000554138056
             autocorr =       1.303847216202
              std dev =       0.686308887032
             le_variance =       0.471019888419

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.147015
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470659568064
                                         uncertainty =       0.002184890407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470659568064
                                         uncertainty =       0.002184890407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485052536
  error estimate for blocks of size 2^( 2) =       0.000506570861
  error estimate for blocks of size 2^( 3) =       0.000526865233
  error estimate for blocks of size 2^( 4) =       0.000542549255
  error estimate for blocks of size 2^( 5) =       0.000553067357
  error estimate for blocks of size 2^( 6) =       0.000557948456
  error estimate for blocks of size 2^( 7) =       0.000562253791

      target function =                  N/A
              le_mean =     -22.819148057072
             les_mean =     521.214105809962
             stat err =       0.000553954715
             autocorr =       1.304280395242
              std dev =       0.685967875209
             le_variance =       0.470551925818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819121368720        initial
     2.4414e-02     2.4414e-01             3.6563e-03       -22.819138910716
     9.7656e-02     9.7656e-01             2.0649e-03       -22.819184557773  <--
     3.9062e-01     3.9062e+00             7.5776e-04       -22.819148057072

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.2456e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548912e-02 3 1  ON 1
ci_03                -2.577487e-02 3 1  ON 2
ci_04                 2.521632e-02 3 1  ON 3
ci_05                -2.312375e-02 3 1  ON 4
ci_06                -2.242890e-02 3 1  ON 5
ci_07                 2.484812e-02 3 1  ON 6
ci_08                -4.582615e-03 3 1  ON 7
ci_09                -1.125886e-02 3 1  ON 8
ci_10                -1.180359e-02 3 1  ON 9
ci_11                 1.629248e-02 3 1  ON 10
ci_12                 1.118562e-02 3 1  ON 11
ci_13                 1.205636e-02 3 1  ON 12
ci_14                 1.764315e-02 3 1  ON 13
ci_15                 8.680594e-03 3 1  ON 14
ci_16                 8.617760e-03 3 1  ON 15
ci_17                -1.052891e-02 3 1  ON 16
ci_18                -9.317148e-03 3 1  ON 17
ci_19                 8.993548e-03 3 1  ON 18
ci_20                 1.026259e-02 3 1  ON 19
ci_21                 8.533095e-03 3 1  ON 20
ci_22                 7.503451e-03 3 1  ON 21
ci_23                 5.759386e-03 3 1  ON 22
ci_24                 6.097622e-03 3 1  ON 23
ci_25                 4.930440e-03 3 1  ON 24
ci_26                 3.258693e-03 3 1  ON 25
ci_27                 2.890504e-03 3 1  ON 26
ci_28                 4.664108e-03 3 1  ON 27
ci_29                 3.579215e-03 3 1  ON 28
ci_30                -7.929783e-04 3 1  ON 29
ci_31                 2.366107e-04 3 1  ON 30
ci_32                 5.001516e-04 3 1  ON 31
ci_33                -3.522402e-04 3 1  ON 32
ci_34                 3.540037e-04 3 1  ON 33
ci_35                 2.195728e-03 3 1  ON 34
ci_36                -1.193266e-03 3 1  ON 35
ci_37                -7.580114e-04 3 1  ON 36
ci_38                -9.970527e-04 3 1  ON 37
ci_39                -3.896373e-04 3 1  ON 38
ci_40                -1.036563e-03 3 1  ON 39
ci_41                 9.202130e-04 3 1  ON 40
ci_42                 5.567817e-04 3 1  ON 41
ci_43                -1.728779e-03 3 1  ON 42
ci_44                -2.018441e-03 3 1  ON 43
ci_45                -3.021976e-04 3 1  ON 44
ci_46                -4.028905e-04 3 1  ON 45
ci_47                -5.145344e-04 3 1  ON 46
ci_48                -8.817022e-04 3 1  ON 47
ci_49                -1.271242e-03 3 1  ON 48
ci_50                -7.604163e-04 3 1  ON 49
ci_51                 3.446730e-05 3 1  ON 50
ci_52                -6.669055e-04 3 1  ON 51
ci_53                -1.487982e-03 3 1  ON 52
ci_54                -1.058697e-03 3 1  ON 53
ci_55                -1.448743e-03 3 1  ON 54
ci_56                 1.645685e-03 3 1  ON 55
ci_57                 1.475921e-03 3 1  ON 56
ci_58                -1.262658e-03 3 1  ON 57
ci_59                -1.217946e-03 3 1  ON 58
ci_60                 8.297284e-04 3 1  ON 59
ci_61                 2.302037e-03 3 1  ON 60
ci_62                -7.289331e-04 3 1  ON 61
ci_63                -8.392719e-04 3 1  ON 62
ci_64                -1.192436e-04 3 1  ON 63
ci_65                -1.810601e-04 3 1  ON 64
ci_66                -2.228659e-04 3 1  ON 65
ci_67                -1.077464e-03 3 1  ON 66
ci_68                -2.563803e-03 3 1  ON 67
ci_69                -1.691485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2462e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8426
    reference variance = 0.598722
====================================================
  Execution time = 2.5431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8329e-01
  Total weights = 1.963912652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469753338189
                                         uncertainty =       0.002176945679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469753338189
                                         uncertainty =       0.002176945679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484681153
  error estimate for blocks of size 2^( 2) =       0.000506374946
  error estimate for blocks of size 2^( 3) =       0.000526856903
  error estimate for blocks of size 2^( 4) =       0.000543108838
  error estimate for blocks of size 2^( 5) =       0.000552650837
  error estimate for blocks of size 2^( 6) =       0.000559105192
  error estimate for blocks of size 2^( 7) =       0.000564201713

      target function =                  N/A
              le_mean =     -22.819029265034
             les_mean =     521.191384266490
             stat err =       0.000554766645
             autocorr =       1.310111980317
              std dev =       0.685442659840
             le_variance =       0.469831639929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281902926503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819029264980       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819043042185       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819041093759       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819041087267       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819041762568       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819041733365       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.671041e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819029264980       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819039863205       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819038722706       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819038760372       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819038927308       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.097704e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819029264980       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819034776363       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819034527391       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819034568242       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.018164e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9978e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.170671e-01 3 1  ON 0
ci_02                -2.577354e-02 3 1  ON 1
ci_03                -2.550769e-02 3 1  ON 2
ci_04                 2.505020e-02 3 1  ON 3
ci_05                -2.291761e-02 3 1  ON 4
ci_06                -2.301524e-02 3 1  ON 5
ci_07                 2.453914e-02 3 1  ON 6
ci_08                -4.045461e-03 3 1  ON 7
ci_09                -1.124286e-02 3 1  ON 8
ci_10                -1.221409e-02 3 1  ON 9
ci_11                 1.683006e-02 3 1  ON 10
ci_12                 1.144381e-02 3 1  ON 11
ci_13                 1.179096e-02 3 1  ON 12
ci_14                 1.729597e-02 3 1  ON 13
ci_15                 8.830782e-03 3 1  ON 14
ci_16                 8.266939e-03 3 1  ON 15
ci_17                -1.062649e-02 3 1  ON 16
ci_18                -9.162101e-03 3 1  ON 17
ci_19                 9.095472e-03 3 1  ON 18
ci_20                 1.026343e-02 3 1  ON 19
ci_21                 7.435391e-03 3 1  ON 20
ci_22                 7.759973e-03 3 1  ON 21
ci_23                 6.818531e-03 3 1  ON 22
ci_24                 6.476879e-03 3 1  ON 23
ci_25                 5.541778e-03 3 1  ON 24
ci_26                 2.722482e-03 3 1  ON 25
ci_27                 2.916482e-03 3 1  ON 26
ci_28                 4.073844e-03 3 1  ON 27
ci_29                 3.422104e-03 3 1  ON 28
ci_30                -3.922029e-04 3 1  ON 29
ci_31                 4.193388e-04 3 1  ON 30
ci_32                 4.065376e-04 3 1  ON 31
ci_33                 1.548206e-04 3 1  ON 32
ci_34                 7.215473e-04 3 1  ON 33
ci_35                 1.783448e-03 3 1  ON 34
ci_36                -1.155756e-03 3 1  ON 35
ci_37                -1.371063e-03 3 1  ON 36
ci_38                 1.605329e-05 3 1  ON 37
ci_39                -7.883420e-04 3 1  ON 38
ci_40                -1.115852e-03 3 1  ON 39
ci_41                 5.546381e-04 3 1  ON 40
ci_42                 5.530417e-04 3 1  ON 41
ci_43                -2.152915e-03 3 1  ON 42
ci_44                -2.045457e-03 3 1  ON 43
ci_45                -4.492520e-04 3 1  ON 44
ci_46                -5.408102e-04 3 1  ON 45
ci_47                -7.635599e-04 3 1  ON 46
ci_48                -1.741743e-03 3 1  ON 47
ci_49                -1.127397e-03 3 1  ON 48
ci_50                -5.659534e-04 3 1  ON 49
ci_51                -2.017915e-04 3 1  ON 50
ci_52                -9.034494e-04 3 1  ON 51
ci_53                -6.751427e-04 3 1  ON 52
ci_54                -9.787019e-04 3 1  ON 53
ci_55                -6.313123e-04 3 1  ON 54
ci_56                 1.692491e-03 3 1  ON 55
ci_57                 1.471539e-03 3 1  ON 56
ci_58                -8.949504e-04 3 1  ON 57
ci_59                -1.746233e-03 3 1  ON 58
ci_60                 1.134393e-03 3 1  ON 59
ci_61                 3.246008e-03 3 1  ON 60
ci_62                -1.163954e-03 3 1  ON 61
ci_63                -6.732703e-04 3 1  ON 62
ci_64                -1.298116e-05 3 1  ON 63
ci_65                 2.447225e-04 3 1  ON 64
ci_66                -4.608222e-04 3 1  ON 65
ci_67                -7.851010e-04 3 1  ON 66
ci_68                -3.228001e-03 3 1  ON 67
ci_69                -1.417180e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.9075
    reference variance = 0.673791
====================================================
  Execution time = 2.4868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9266e-01
  Total weights = 1.9636e+06
  Execution time = 3.5065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475243913244
                                         uncertainty =       0.003372961105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475243913244
                                         uncertainty =       0.003372961105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487423499
  error estimate for blocks of size 2^( 2) =       0.000508283723
  error estimate for blocks of size 2^( 3) =       0.000528509977
  error estimate for blocks of size 2^( 4) =       0.000544721744
  error estimate for blocks of size 2^( 5) =       0.000554440200
  error estimate for blocks of size 2^( 6) =       0.000558942200
  error estimate for blocks of size 2^( 7) =       0.000560358692

      target function =                  N/A
              le_mean =     -22.818486894395
             les_mean =     521.929600354274
             stat err =       0.000554615709
             autocorr =       1.294706733174
              std dev =       0.689320923027
             le_variance =       0.475163334923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473970820502
                                         uncertainty =       0.002908469599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473970820502
                                         uncertainty =       0.002908469599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486771595
  error estimate for blocks of size 2^( 2) =       0.000507653391
  error estimate for blocks of size 2^( 3) =       0.000527875466
  error estimate for blocks of size 2^( 4) =       0.000544070612
  error estimate for blocks of size 2^( 5) =       0.000553858751
  error estimate for blocks of size 2^( 6) =       0.000558200572
  error estimate for blocks of size 2^( 7) =       0.000559629053

      target function =                  N/A
              le_mean =     -22.818461073990
             les_mean =     521.175380237446
             stat err =       0.000553939747
             autocorr =       1.295014413019
              std dev =       0.688398990950
             le_variance =       0.473893170741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474143061930
                                         uncertainty =       0.002871233079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474143061930
                                         uncertainty =       0.002871233079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486859472
  error estimate for blocks of size 2^( 2) =       0.000507727006
  error estimate for blocks of size 2^( 3) =       0.000527941577
  error estimate for blocks of size 2^( 4) =       0.000544130888
  error estimate for blocks of size 2^( 5) =       0.000553917772
  error estimate for blocks of size 2^( 6) =       0.000558278768
  error estimate for blocks of size 2^( 7) =       0.000559736836

      target function =                  N/A
              le_mean =     -22.818485125885
             les_mean =     521.178737589986
             stat err =       0.000554016066
             autocorr =       1.294903695690
              std dev =       0.688523268375
             le_variance =       0.474064291094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477267895953
                                         uncertainty =       0.003916614292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477267895953
                                         uncertainty =       0.003916614292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488458331
  error estimate for blocks of size 2^( 2) =       0.000509261575
  error estimate for blocks of size 2^( 3) =       0.000529436108
  error estimate for blocks of size 2^( 4) =       0.000545638132
  error estimate for blocks of size 2^( 5) =       0.000555275710
  error estimate for blocks of size 2^( 6) =       0.000559732288
  error estimate for blocks of size 2^( 7) =       0.000561258093

      target function =                  N/A
              le_mean =     -22.818393933570
             les_mean =     522.967821315271
             stat err =       0.000555476056
             autocorr =       1.293229621720
              std dev =       0.690784396184
             le_variance =       0.477183082011


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818486894395        initial  <--
     2.4414e-02     2.4414e-01             1.6710e-03       -22.818461073990
     9.7656e-02     9.7656e-01             1.0977e-03       -22.818485125885
     3.9062e-01     3.9062e+00             6.0182e-04       -22.818393933570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6411
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548912e-02 3 1  ON 1
ci_03                -2.577487e-02 3 1  ON 2
ci_04                 2.521632e-02 3 1  ON 3
ci_05                -2.312375e-02 3 1  ON 4
ci_06                -2.242890e-02 3 1  ON 5
ci_07                 2.484812e-02 3 1  ON 6
ci_08                -4.582615e-03 3 1  ON 7
ci_09                -1.125886e-02 3 1  ON 8
ci_10                -1.180359e-02 3 1  ON 9
ci_11                 1.629248e-02 3 1  ON 10
ci_12                 1.118562e-02 3 1  ON 11
ci_13                 1.205636e-02 3 1  ON 12
ci_14                 1.764315e-02 3 1  ON 13
ci_15                 8.680594e-03 3 1  ON 14
ci_16                 8.617760e-03 3 1  ON 15
ci_17                -1.052891e-02 3 1  ON 16
ci_18                -9.317148e-03 3 1  ON 17
ci_19                 8.993548e-03 3 1  ON 18
ci_20                 1.026259e-02 3 1  ON 19
ci_21                 8.533095e-03 3 1  ON 20
ci_22                 7.503451e-03 3 1  ON 21
ci_23                 5.759386e-03 3 1  ON 22
ci_24                 6.097622e-03 3 1  ON 23
ci_25                 4.930440e-03 3 1  ON 24
ci_26                 3.258693e-03 3 1  ON 25
ci_27                 2.890504e-03 3 1  ON 26
ci_28                 4.664108e-03 3 1  ON 27
ci_29                 3.579215e-03 3 1  ON 28
ci_30                -7.929783e-04 3 1  ON 29
ci_31                 2.366107e-04 3 1  ON 30
ci_32                 5.001516e-04 3 1  ON 31
ci_33                -3.522402e-04 3 1  ON 32
ci_34                 3.540037e-04 3 1  ON 33
ci_35                 2.195728e-03 3 1  ON 34
ci_36                -1.193266e-03 3 1  ON 35
ci_37                -7.580114e-04 3 1  ON 36
ci_38                -9.970527e-04 3 1  ON 37
ci_39                -3.896373e-04 3 1  ON 38
ci_40                -1.036563e-03 3 1  ON 39
ci_41                 9.202130e-04 3 1  ON 40
ci_42                 5.567817e-04 3 1  ON 41
ci_43                -1.728779e-03 3 1  ON 42
ci_44                -2.018441e-03 3 1  ON 43
ci_45                -3.021976e-04 3 1  ON 44
ci_46                -4.028905e-04 3 1  ON 45
ci_47                -5.145344e-04 3 1  ON 46
ci_48                -8.817022e-04 3 1  ON 47
ci_49                -1.271242e-03 3 1  ON 48
ci_50                -7.604163e-04 3 1  ON 49
ci_51                 3.446730e-05 3 1  ON 50
ci_52                -6.669055e-04 3 1  ON 51
ci_53                -1.487982e-03 3 1  ON 52
ci_54                -1.058697e-03 3 1  ON 53
ci_55                -1.448743e-03 3 1  ON 54
ci_56                 1.645685e-03 3 1  ON 55
ci_57                 1.475921e-03 3 1  ON 56
ci_58                -1.262658e-03 3 1  ON 57
ci_59                -1.217946e-03 3 1  ON 58
ci_60                 8.297284e-04 3 1  ON 59
ci_61                 2.302037e-03 3 1  ON 60
ci_62                -7.289331e-04 3 1  ON 61
ci_63                -8.392719e-04 3 1  ON 62
ci_64                -1.192436e-04 3 1  ON 63
ci_65                -1.810601e-04 3 1  ON 64
ci_66                -2.228659e-04 3 1  ON 65
ci_67                -1.077464e-03 3 1  ON 66
ci_68                -2.563803e-03 3 1  ON 67
ci_69                -1.691485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2635e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8379
    reference variance = 0.391966
====================================================
  Execution time = 2.5364e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8567e-01
  Total weights = 1.963972852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469375395707
                                         uncertainty =       0.002365782716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469375395707
                                         uncertainty =       0.002365782716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484395653
  error estimate for blocks of size 2^( 2) =       0.000505599480
  error estimate for blocks of size 2^( 3) =       0.000526196228
  error estimate for blocks of size 2^( 4) =       0.000542223556
  error estimate for blocks of size 2^( 5) =       0.000551949036
  error estimate for blocks of size 2^( 6) =       0.000556093309
  error estimate for blocks of size 2^( 7) =       0.000560372810

      target function =                  N/A
              le_mean =     -22.819224587017
             les_mean =     521.202679610390
             stat err =       0.000552659678
             autocorr =       1.301712525403
              std dev =       0.685038902707
             le_variance =       0.469278298222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281922458702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819224586940       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819235973400       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819235513133       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819235565296       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.027687e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819224586940       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819228870732       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819228915297       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819228906445       residual = 4.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.651362e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819224586940       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819225812586       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819225863197       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819225859254       residual = 6.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.021336e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9891e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.164473e-01 3 1  ON 0
ci_02                -2.567707e-02 3 1  ON 1
ci_03                -2.580170e-02 3 1  ON 2
ci_04                 2.507882e-02 3 1  ON 3
ci_05                -2.307933e-02 3 1  ON 4
ci_06                -2.258990e-02 3 1  ON 5
ci_07                 2.498186e-02 3 1  ON 6
ci_08                -4.753966e-03 3 1  ON 7
ci_09                -1.132013e-02 3 1  ON 8
ci_10                -1.176380e-02 3 1  ON 9
ci_11                 1.625017e-02 3 1  ON 10
ci_12                 1.116271e-02 3 1  ON 11
ci_13                 1.206389e-02 3 1  ON 12
ci_14                 1.749506e-02 3 1  ON 13
ci_15                 8.454034e-03 3 1  ON 14
ci_16                 8.347689e-03 3 1  ON 15
ci_17                -1.027943e-02 3 1  ON 16
ci_18                -9.535451e-03 3 1  ON 17
ci_19                 8.970017e-03 3 1  ON 18
ci_20                 1.044695e-02 3 1  ON 19
ci_21                 8.616289e-03 3 1  ON 20
ci_22                 7.585737e-03 3 1  ON 21
ci_23                 5.769674e-03 3 1  ON 22
ci_24                 6.225749e-03 3 1  ON 23
ci_25                 4.835643e-03 3 1  ON 24
ci_26                 3.117910e-03 3 1  ON 25
ci_27                 3.027874e-03 3 1  ON 26
ci_28                 4.685306e-03 3 1  ON 27
ci_29                 3.739748e-03 3 1  ON 28
ci_30                -8.185326e-04 3 1  ON 29
ci_31                 1.651637e-04 3 1  ON 30
ci_32                 2.929371e-04 3 1  ON 31
ci_33                -2.068745e-04 3 1  ON 32
ci_34                 6.257689e-04 3 1  ON 33
ci_35                 1.830592e-03 3 1  ON 34
ci_36                -1.273714e-03 3 1  ON 35
ci_37                -5.374797e-04 3 1  ON 36
ci_38                -8.745114e-04 3 1  ON 37
ci_39                -2.841149e-04 3 1  ON 38
ci_40                -1.029053e-03 3 1  ON 39
ci_41                 9.075414e-04 3 1  ON 40
ci_42                 5.708247e-04 3 1  ON 41
ci_43                -1.742297e-03 3 1  ON 42
ci_44                -2.055092e-03 3 1  ON 43
ci_45                -4.765996e-05 3 1  ON 44
ci_46                -3.648220e-04 3 1  ON 45
ci_47                -6.954926e-04 3 1  ON 46
ci_48                -7.641473e-04 3 1  ON 47
ci_49                -1.328597e-03 3 1  ON 48
ci_50                -6.150777e-04 3 1  ON 49
ci_51                 7.043503e-05 3 1  ON 50
ci_52                -7.092447e-04 3 1  ON 51
ci_53                -1.513728e-03 3 1  ON 52
ci_54                -1.035655e-03 3 1  ON 53
ci_55                -1.300382e-03 3 1  ON 54
ci_56                 1.830226e-03 3 1  ON 55
ci_57                 1.469144e-03 3 1  ON 56
ci_58                -1.395483e-03 3 1  ON 57
ci_59                -1.427042e-03 3 1  ON 58
ci_60                 9.894192e-04 3 1  ON 59
ci_61                 2.367226e-03 3 1  ON 60
ci_62                -6.445418e-04 3 1  ON 61
ci_63                -5.405009e-04 3 1  ON 62
ci_64                -2.043911e-04 3 1  ON 63
ci_65                -3.345603e-04 3 1  ON 64
ci_66                -3.494926e-04 3 1  ON 65
ci_67                -9.622887e-04 3 1  ON 66
ci_68                -2.216005e-03 3 1  ON 67
ci_69                -1.377719e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8379
    reference variance = 0.468379
====================================================
  Execution time = 2.4633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8270e-01
  Total weights = 1.9642e+06
  Execution time = 3.5140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468937144639
                                         uncertainty =       0.002069470865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468937144639
                                         uncertainty =       0.002069470865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484198108
  error estimate for blocks of size 2^( 2) =       0.000505461725
  error estimate for blocks of size 2^( 3) =       0.000526173708
  error estimate for blocks of size 2^( 4) =       0.000540789979
  error estimate for blocks of size 2^( 5) =       0.000549730649
  error estimate for blocks of size 2^( 6) =       0.000552699197
  error estimate for blocks of size 2^( 7) =       0.000556525572

      target function =                  N/A
              le_mean =     -22.819696967026
             les_mean =     521.228108177074
             stat err =       0.000549936349
             autocorr =       1.289967227016
              std dev =       0.684759530676
             le_variance =       0.468895614851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468964327722
                                         uncertainty =       0.002076206328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468964327722
                                         uncertainty =       0.002076206328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484212071
  error estimate for blocks of size 2^( 2) =       0.000505477093
  error estimate for blocks of size 2^( 3) =       0.000526181434
  error estimate for blocks of size 2^( 4) =       0.000540787686
  error estimate for blocks of size 2^( 5) =       0.000549741634
  error estimate for blocks of size 2^( 6) =       0.000552723922
  error estimate for blocks of size 2^( 7) =       0.000556474070

      target function =                  N/A
              le_mean =     -22.819696914820
             les_mean =     521.235974779078
             stat err =       0.000549931828
             autocorr =       1.289871623699
              std dev =       0.684779277389
             le_variance =       0.468922658741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468899792416
                                         uncertainty =       0.002072972480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468899792416
                                         uncertainty =       0.002072972480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484178820
  error estimate for blocks of size 2^( 2) =       0.000505440142
  error estimate for blocks of size 2^( 3) =       0.000526148743
  error estimate for blocks of size 2^( 4) =       0.000540763186
  error estimate for blocks of size 2^( 5) =       0.000549708177
  error estimate for blocks of size 2^( 6) =       0.000552702201
  error estimate for blocks of size 2^( 7) =       0.000556482294

      target function =                  N/A
              le_mean =     -22.819695764208
             les_mean =     521.226104161975
             stat err =       0.000549913964
             autocorr =       1.289964980425
              std dev =       0.684732254106
             le_variance =       0.468858259813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468920831578
                                         uncertainty =       0.002069761481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468920831578
                                         uncertainty =       0.002069761481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484189690
  error estimate for blocks of size 2^( 2) =       0.000505452914
  error estimate for blocks of size 2^( 3) =       0.000526164886
  error estimate for blocks of size 2^( 4) =       0.000540780720
  error estimate for blocks of size 2^( 5) =       0.000549723192
  error estimate for blocks of size 2^( 6) =       0.000552694056
  error estimate for blocks of size 2^( 7) =       0.000556505979

      target function =                  N/A
              le_mean =     -22.819695805375
             les_mean =     521.222975554870
             stat err =       0.000549925987
             autocorr =       1.289963467424
              std dev =       0.684747625983
             le_variance =       0.468879311289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819696967026        initial  <--
     2.4414e-01     2.4414e+00             1.0277e-03       -22.819696914820
     9.7656e-01     9.7656e+00             3.6514e-04       -22.819695764208
     3.9062e+00     3.9062e+01             1.0213e-04       -22.819695805375

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4517
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548912e-02 3 1  ON 1
ci_03                -2.577487e-02 3 1  ON 2
ci_04                 2.521632e-02 3 1  ON 3
ci_05                -2.312375e-02 3 1  ON 4
ci_06                -2.242890e-02 3 1  ON 5
ci_07                 2.484812e-02 3 1  ON 6
ci_08                -4.582615e-03 3 1  ON 7
ci_09                -1.125886e-02 3 1  ON 8
ci_10                -1.180359e-02 3 1  ON 9
ci_11                 1.629248e-02 3 1  ON 10
ci_12                 1.118562e-02 3 1  ON 11
ci_13                 1.205636e-02 3 1  ON 12
ci_14                 1.764315e-02 3 1  ON 13
ci_15                 8.680594e-03 3 1  ON 14
ci_16                 8.617760e-03 3 1  ON 15
ci_17                -1.052891e-02 3 1  ON 16
ci_18                -9.317148e-03 3 1  ON 17
ci_19                 8.993548e-03 3 1  ON 18
ci_20                 1.026259e-02 3 1  ON 19
ci_21                 8.533095e-03 3 1  ON 20
ci_22                 7.503451e-03 3 1  ON 21
ci_23                 5.759386e-03 3 1  ON 22
ci_24                 6.097622e-03 3 1  ON 23
ci_25                 4.930440e-03 3 1  ON 24
ci_26                 3.258693e-03 3 1  ON 25
ci_27                 2.890504e-03 3 1  ON 26
ci_28                 4.664108e-03 3 1  ON 27
ci_29                 3.579215e-03 3 1  ON 28
ci_30                -7.929783e-04 3 1  ON 29
ci_31                 2.366107e-04 3 1  ON 30
ci_32                 5.001516e-04 3 1  ON 31
ci_33                -3.522402e-04 3 1  ON 32
ci_34                 3.540037e-04 3 1  ON 33
ci_35                 2.195728e-03 3 1  ON 34
ci_36                -1.193266e-03 3 1  ON 35
ci_37                -7.580114e-04 3 1  ON 36
ci_38                -9.970527e-04 3 1  ON 37
ci_39                -3.896373e-04 3 1  ON 38
ci_40                -1.036563e-03 3 1  ON 39
ci_41                 9.202130e-04 3 1  ON 40
ci_42                 5.567817e-04 3 1  ON 41
ci_43                -1.728779e-03 3 1  ON 42
ci_44                -2.018441e-03 3 1  ON 43
ci_45                -3.021976e-04 3 1  ON 44
ci_46                -4.028905e-04 3 1  ON 45
ci_47                -5.145344e-04 3 1  ON 46
ci_48                -8.817022e-04 3 1  ON 47
ci_49                -1.271242e-03 3 1  ON 48
ci_50                -7.604163e-04 3 1  ON 49
ci_51                 3.446730e-05 3 1  ON 50
ci_52                -6.669055e-04 3 1  ON 51
ci_53                -1.487982e-03 3 1  ON 52
ci_54                -1.058697e-03 3 1  ON 53
ci_55                -1.448743e-03 3 1  ON 54
ci_56                 1.645685e-03 3 1  ON 55
ci_57                 1.475921e-03 3 1  ON 56
ci_58                -1.262658e-03 3 1  ON 57
ci_59                -1.217946e-03 3 1  ON 58
ci_60                 8.297284e-04 3 1  ON 59
ci_61                 2.302037e-03 3 1  ON 60
ci_62                -7.289331e-04 3 1  ON 61
ci_63                -8.392719e-04 3 1  ON 62
ci_64                -1.192436e-04 3 1  ON 63
ci_65                -1.810601e-04 3 1  ON 64
ci_66                -2.228659e-04 3 1  ON 65
ci_67                -1.077464e-03 3 1  ON 66
ci_68                -2.563803e-03 3 1  ON 67
ci_69                -1.691485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7287
    reference variance = 0.46699
====================================================
  Execution time = 2.5250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9008e-01
  Total weights = 1.963522426e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473652944751
                                         uncertainty =       0.002569648434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473652944751
                                         uncertainty =       0.002569648434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486686789
  error estimate for blocks of size 2^( 2) =       0.000508051172
  error estimate for blocks of size 2^( 3) =       0.000528569154
  error estimate for blocks of size 2^( 4) =       0.000544044318
  error estimate for blocks of size 2^( 5) =       0.000552887809
  error estimate for blocks of size 2^( 6) =       0.000559647939
  error estimate for blocks of size 2^( 7) =       0.000562908035

      target function =                  N/A
              le_mean =     -22.820224267974
             les_mean =     521.252712600116
             stat err =       0.000554872025
             autocorr =       1.299829963523
              std dev =       0.688279058074
             le_variance =       0.473728061783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282022426797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820224267942       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820228276602       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820228365454       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820228345832       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 2.055388e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820224267942       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820225335358       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820225360842       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820225354782       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 5.462992e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820224267942       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820224539211       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820224545853       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820224544252       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 1.387676e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9791e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.163626e-01 3 1  ON 0
ci_02                -2.549453e-02 3 1  ON 1
ci_03                -2.577410e-02 3 1  ON 2
ci_04                 2.520370e-02 3 1  ON 3
ci_05                -2.312489e-02 3 1  ON 4
ci_06                -2.245025e-02 3 1  ON 5
ci_07                 2.485013e-02 3 1  ON 6
ci_08                -4.580082e-03 3 1  ON 7
ci_09                -1.124537e-02 3 1  ON 8
ci_10                -1.180615e-02 3 1  ON 9
ci_11                 1.627071e-02 3 1  ON 10
ci_12                 1.117555e-02 3 1  ON 11
ci_13                 1.206389e-02 3 1  ON 12
ci_14                 1.764324e-02 3 1  ON 13
ci_15                 8.662043e-03 3 1  ON 14
ci_16                 8.604390e-03 3 1  ON 15
ci_17                -1.052293e-02 3 1  ON 16
ci_18                -9.298840e-03 3 1  ON 17
ci_19                 8.992884e-03 3 1  ON 18
ci_20                 1.026911e-02 3 1  ON 19
ci_21                 8.504404e-03 3 1  ON 20
ci_22                 7.528387e-03 3 1  ON 21
ci_23                 5.781073e-03 3 1  ON 22
ci_24                 6.111344e-03 3 1  ON 23
ci_25                 4.932004e-03 3 1  ON 24
ci_26                 3.250168e-03 3 1  ON 25
ci_27                 2.878210e-03 3 1  ON 26
ci_28                 4.642897e-03 3 1  ON 27
ci_29                 3.597212e-03 3 1  ON 28
ci_30                -7.577148e-04 3 1  ON 29
ci_31                 2.576714e-04 3 1  ON 30
ci_32                 4.623627e-04 3 1  ON 31
ci_33                -3.844649e-04 3 1  ON 32
ci_34                 3.514741e-04 3 1  ON 33
ci_35                 2.158026e-03 3 1  ON 34
ci_36                -1.178866e-03 3 1  ON 35
ci_37                -7.593496e-04 3 1  ON 36
ci_38                -9.962821e-04 3 1  ON 37
ci_39                -3.964995e-04 3 1  ON 38
ci_40                -1.025344e-03 3 1  ON 39
ci_41                 8.990762e-04 3 1  ON 40
ci_42                 5.675884e-04 3 1  ON 41
ci_43                -1.752039e-03 3 1  ON 42
ci_44                -2.009981e-03 3 1  ON 43
ci_45                -3.177102e-04 3 1  ON 44
ci_46                -3.916339e-04 3 1  ON 45
ci_47                -5.392118e-04 3 1  ON 46
ci_48                -8.877471e-04 3 1  ON 47
ci_49                -1.259187e-03 3 1  ON 48
ci_50                -7.167665e-04 3 1  ON 49
ci_51                 4.322343e-05 3 1  ON 50
ci_52                -6.369977e-04 3 1  ON 51
ci_53                -1.472083e-03 3 1  ON 52
ci_54                -1.066112e-03 3 1  ON 53
ci_55                -1.430965e-03 3 1  ON 54
ci_56                 1.683900e-03 3 1  ON 55
ci_57                 1.451717e-03 3 1  ON 56
ci_58                -1.264986e-03 3 1  ON 57
ci_59                -1.214483e-03 3 1  ON 58
ci_60                 8.412572e-04 3 1  ON 59
ci_61                 2.303161e-03 3 1  ON 60
ci_62                -7.430671e-04 3 1  ON 61
ci_63                -8.132984e-04 3 1  ON 62
ci_64                -1.248454e-04 3 1  ON 63
ci_65                -2.066006e-04 3 1  ON 64
ci_66                -2.589637e-04 3 1  ON 65
ci_67                -1.064582e-03 3 1  ON 66
ci_68                -2.509174e-03 3 1  ON 67
ci_69                -1.683818e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8658
    reference variance = 0.415587
====================================================
  Execution time = 2.4588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9192e-01
  Total weights = 1.9635e+06
  Execution time = 3.5130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474718670091
                                         uncertainty =       0.003319984906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474718670091
                                         uncertainty =       0.003319984906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487213986
  error estimate for blocks of size 2^( 2) =       0.000508600283
  error estimate for blocks of size 2^( 3) =       0.000528572943
  error estimate for blocks of size 2^( 4) =       0.000543470170
  error estimate for blocks of size 2^( 5) =       0.000552222311
  error estimate for blocks of size 2^( 6) =       0.000557018314
  error estimate for blocks of size 2^( 7) =       0.000560558470

      target function =                  N/A
              le_mean =     -22.819147149137
             les_mean =     521.205637748959
             stat err =       0.000553317316
             autocorr =       1.289760373823
              std dev =       0.689024627393
             le_variance =       0.474754937155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474726099678
                                         uncertainty =       0.003337630018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474726099678
                                         uncertainty =       0.003337630018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487217631
  error estimate for blocks of size 2^( 2) =       0.000508603674
  error estimate for blocks of size 2^( 3) =       0.000528576166
  error estimate for blocks of size 2^( 4) =       0.000543474245
  error estimate for blocks of size 2^( 5) =       0.000552231636
  error estimate for blocks of size 2^( 6) =       0.000557021896
  error estimate for blocks of size 2^( 7) =       0.000560551927

      target function =                  N/A
              le_mean =     -22.819145864254
             les_mean =     521.206745848625
             stat err =       0.000553319926
             autocorr =       1.289753244536
              std dev =       0.689029781063
             le_variance =       0.474762039191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474721349945
                                         uncertainty =       0.003329445248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474721349945
                                         uncertainty =       0.003329445248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487215271
  error estimate for blocks of size 2^( 2) =       0.000508601439
  error estimate for blocks of size 2^( 3) =       0.000528574040
  error estimate for blocks of size 2^( 4) =       0.000543471755
  error estimate for blocks of size 2^( 5) =       0.000552226755
  error estimate for blocks of size 2^( 6) =       0.000557019771
  error estimate for blocks of size 2^( 7) =       0.000560554785

      target function =                  N/A
              le_mean =     -22.819146291537
             les_mean =     521.205329892851
             stat err =       0.000553318267
             autocorr =       1.289758005131
              std dev =       0.689026443422
             le_variance =       0.474757439735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474718837079
                                         uncertainty =       0.003321181251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474718837079
                                         uncertainty =       0.003321181251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487214061
  error estimate for blocks of size 2^( 2) =       0.000508600344
  error estimate for blocks of size 2^( 3) =       0.000528573007
  error estimate for blocks of size 2^( 4) =       0.000543470354
  error estimate for blocks of size 2^( 5) =       0.000552222833
  error estimate for blocks of size 2^( 6) =       0.000557018475
  error estimate for blocks of size 2^( 7) =       0.000560558044

      target function =                  N/A
              le_mean =     -22.819147008264
             les_mean =     521.205754206416
             stat err =       0.000553317426
             autocorr =       1.289760494715
              std dev =       0.689024732185
             le_variance =       0.474755081562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819147149137        initial  <--
     2.4414e+00     2.4414e+01             2.0554e-04       -22.819145864254
     9.7656e+00     9.7656e+01             5.4630e-05       -22.819146291537
     3.9062e+01     3.9062e+02             1.3877e-05       -22.819147008264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2067
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548912e-02 3 1  ON 1
ci_03                -2.577487e-02 3 1  ON 2
ci_04                 2.521632e-02 3 1  ON 3
ci_05                -2.312375e-02 3 1  ON 4
ci_06                -2.242890e-02 3 1  ON 5
ci_07                 2.484812e-02 3 1  ON 6
ci_08                -4.582615e-03 3 1  ON 7
ci_09                -1.125886e-02 3 1  ON 8
ci_10                -1.180359e-02 3 1  ON 9
ci_11                 1.629248e-02 3 1  ON 10
ci_12                 1.118562e-02 3 1  ON 11
ci_13                 1.205636e-02 3 1  ON 12
ci_14                 1.764315e-02 3 1  ON 13
ci_15                 8.680594e-03 3 1  ON 14
ci_16                 8.617760e-03 3 1  ON 15
ci_17                -1.052891e-02 3 1  ON 16
ci_18                -9.317148e-03 3 1  ON 17
ci_19                 8.993548e-03 3 1  ON 18
ci_20                 1.026259e-02 3 1  ON 19
ci_21                 8.533095e-03 3 1  ON 20
ci_22                 7.503451e-03 3 1  ON 21
ci_23                 5.759386e-03 3 1  ON 22
ci_24                 6.097622e-03 3 1  ON 23
ci_25                 4.930440e-03 3 1  ON 24
ci_26                 3.258693e-03 3 1  ON 25
ci_27                 2.890504e-03 3 1  ON 26
ci_28                 4.664108e-03 3 1  ON 27
ci_29                 3.579215e-03 3 1  ON 28
ci_30                -7.929783e-04 3 1  ON 29
ci_31                 2.366107e-04 3 1  ON 30
ci_32                 5.001516e-04 3 1  ON 31
ci_33                -3.522402e-04 3 1  ON 32
ci_34                 3.540037e-04 3 1  ON 33
ci_35                 2.195728e-03 3 1  ON 34
ci_36                -1.193266e-03 3 1  ON 35
ci_37                -7.580114e-04 3 1  ON 36
ci_38                -9.970527e-04 3 1  ON 37
ci_39                -3.896373e-04 3 1  ON 38
ci_40                -1.036563e-03 3 1  ON 39
ci_41                 9.202130e-04 3 1  ON 40
ci_42                 5.567817e-04 3 1  ON 41
ci_43                -1.728779e-03 3 1  ON 42
ci_44                -2.018441e-03 3 1  ON 43
ci_45                -3.021976e-04 3 1  ON 44
ci_46                -4.028905e-04 3 1  ON 45
ci_47                -5.145344e-04 3 1  ON 46
ci_48                -8.817022e-04 3 1  ON 47
ci_49                -1.271242e-03 3 1  ON 48
ci_50                -7.604163e-04 3 1  ON 49
ci_51                 3.446730e-05 3 1  ON 50
ci_52                -6.669055e-04 3 1  ON 51
ci_53                -1.487982e-03 3 1  ON 52
ci_54                -1.058697e-03 3 1  ON 53
ci_55                -1.448743e-03 3 1  ON 54
ci_56                 1.645685e-03 3 1  ON 55
ci_57                 1.475921e-03 3 1  ON 56
ci_58                -1.262658e-03 3 1  ON 57
ci_59                -1.217946e-03 3 1  ON 58
ci_60                 8.297284e-04 3 1  ON 59
ci_61                 2.302037e-03 3 1  ON 60
ci_62                -7.289331e-04 3 1  ON 61
ci_63                -8.392719e-04 3 1  ON 62
ci_64                -1.192436e-04 3 1  ON 63
ci_65                -1.810601e-04 3 1  ON 64
ci_66                -2.228659e-04 3 1  ON 65
ci_67                -1.077464e-03 3 1  ON 66
ci_68                -2.563803e-03 3 1  ON 67
ci_69                -1.691485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7527
    reference variance = 0.419327
====================================================
  Execution time = 2.5320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8504e-01
  Total weights = 1.963739058e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469940836286
                                         uncertainty =       0.002214975352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469940836286
                                         uncertainty =       0.002214975352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484728181
  error estimate for blocks of size 2^( 2) =       0.000506397518
  error estimate for blocks of size 2^( 3) =       0.000526403102
  error estimate for blocks of size 2^( 4) =       0.000542171425
  error estimate for blocks of size 2^( 5) =       0.000553055341
  error estimate for blocks of size 2^( 6) =       0.000557974861
  error estimate for blocks of size 2^( 7) =       0.000560155043

      target function =                  N/A
              le_mean =     -22.818947142932
             les_mean =     521.189385641031
             stat err =       0.000553339168
             autocorr =       1.303125629306
              std dev =       0.685509167499
             le_variance =       0.469922818725


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281894714293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818947142854       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818947482034       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818947546723       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818947548010       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.437927e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818947142854       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818947228120       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818947244484       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818947244833       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 3.625893e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818947142854       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818947164200       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818947168304       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818947168393       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 9.084359e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9834e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.163550e-01 3 1  ON 0
ci_02                -2.548975e-02 3 1  ON 1
ci_03                -2.577639e-02 3 1  ON 2
ci_04                 2.521626e-02 3 1  ON 3
ci_05                -2.312413e-02 3 1  ON 4
ci_06                -2.242767e-02 3 1  ON 5
ci_07                 2.484697e-02 3 1  ON 6
ci_08                -4.582690e-03 3 1  ON 7
ci_09                -1.125610e-02 3 1  ON 8
ci_10                -1.180092e-02 3 1  ON 9
ci_11                 1.628985e-02 3 1  ON 10
ci_12                 1.118531e-02 3 1  ON 11
ci_13                 1.205788e-02 3 1  ON 12
ci_14                 1.764310e-02 3 1  ON 13
ci_15                 8.677596e-03 3 1  ON 14
ci_16                 8.618587e-03 3 1  ON 15
ci_17                -1.052938e-02 3 1  ON 16
ci_18                -9.318912e-03 3 1  ON 17
ci_19                 8.997174e-03 3 1  ON 18
ci_20                 1.026194e-02 3 1  ON 19
ci_21                 8.533874e-03 3 1  ON 20
ci_22                 7.501515e-03 3 1  ON 21
ci_23                 5.761843e-03 3 1  ON 22
ci_24                 6.098630e-03 3 1  ON 23
ci_25                 4.930127e-03 3 1  ON 24
ci_26                 3.256663e-03 3 1  ON 25
ci_27                 2.890792e-03 3 1  ON 26
ci_28                 4.661158e-03 3 1  ON 27
ci_29                 3.580102e-03 3 1  ON 28
ci_30                -7.914630e-04 3 1  ON 29
ci_31                 2.389573e-04 3 1  ON 30
ci_32                 4.971331e-04 3 1  ON 31
ci_33                -3.514712e-04 3 1  ON 32
ci_34                 3.521899e-04 3 1  ON 33
ci_35                 2.193999e-03 3 1  ON 34
ci_36                -1.191578e-03 3 1  ON 35
ci_37                -7.578667e-04 3 1  ON 36
ci_38                -9.946419e-04 3 1  ON 37
ci_39                -3.916577e-04 3 1  ON 38
ci_40                -1.037413e-03 3 1  ON 39
ci_41                 9.190941e-04 3 1  ON 40
ci_42                 5.539773e-04 3 1  ON 41
ci_43                -1.729970e-03 3 1  ON 42
ci_44                -2.016044e-03 3 1  ON 43
ci_45                -2.994875e-04 3 1  ON 44
ci_46                -4.052717e-04 3 1  ON 45
ci_47                -5.142227e-04 3 1  ON 46
ci_48                -8.814838e-04 3 1  ON 47
ci_49                -1.271323e-03 3 1  ON 48
ci_50                -7.605381e-04 3 1  ON 49
ci_51                 3.609676e-05 3 1  ON 50
ci_52                -6.657350e-04 3 1  ON 51
ci_53                -1.488237e-03 3 1  ON 52
ci_54                -1.056726e-03 3 1  ON 53
ci_55                -1.445741e-03 3 1  ON 54
ci_56                 1.644735e-03 3 1  ON 55
ci_57                 1.475700e-03 3 1  ON 56
ci_58                -1.262942e-03 3 1  ON 57
ci_59                -1.218743e-03 3 1  ON 58
ci_60                 8.312295e-04 3 1  ON 59
ci_61                 2.302254e-03 3 1  ON 60
ci_62                -7.286158e-04 3 1  ON 61
ci_63                -8.376325e-04 3 1  ON 62
ci_64                -1.202421e-04 3 1  ON 63
ci_65                -1.823851e-04 3 1  ON 64
ci_66                -2.215510e-04 3 1  ON 65
ci_67                -1.075162e-03 3 1  ON 66
ci_68                -2.562428e-03 3 1  ON 67
ci_69                -1.691141e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7853
    reference variance = 0.266984
====================================================
  Execution time = 2.4628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8526e-01
  Total weights = 1.9638e+06
  Execution time = 3.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471080341478
                                         uncertainty =       0.002679274715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471080341478
                                         uncertainty =       0.002679274715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485296006
  error estimate for blocks of size 2^( 2) =       0.000506909098
  error estimate for blocks of size 2^( 3) =       0.000526972046
  error estimate for blocks of size 2^( 4) =       0.000542775877
  error estimate for blocks of size 2^( 5) =       0.000553261109
  error estimate for blocks of size 2^( 6) =       0.000557920874
  error estimate for blocks of size 2^( 7) =       0.000556642835

      target function =                  N/A
              le_mean =     -22.818494488264
             les_mean =     521.168994788632
             stat err =       0.000552650174
             autocorr =       1.296842362349
              std dev =       0.686312193014
             le_variance =       0.471024426280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471078970940
                                         uncertainty =       0.002679567995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471078970940
                                         uncertainty =       0.002679567995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485295303
  error estimate for blocks of size 2^( 2) =       0.000506908153
  error estimate for blocks of size 2^( 3) =       0.000526970882
  error estimate for blocks of size 2^( 4) =       0.000542774402
  error estimate for blocks of size 2^( 5) =       0.000553259682
  error estimate for blocks of size 2^( 6) =       0.000557919317
  error estimate for blocks of size 2^( 7) =       0.000556642093

      target function =                  N/A
              le_mean =     -22.818494451528
             les_mean =     521.168888468748
             stat err =       0.000552648873
             autocorr =       1.296840011486
              std dev =       0.686311199867
             le_variance =       0.471023063063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471079640474
                                         uncertainty =       0.002679421679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471079640474
                                         uncertainty =       0.002679421679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485295646
  error estimate for blocks of size 2^( 2) =       0.000506908616
  error estimate for blocks of size 2^( 3) =       0.000526971454
  error estimate for blocks of size 2^( 4) =       0.000542775128
  error estimate for blocks of size 2^( 5) =       0.000553260385
  error estimate for blocks of size 2^( 6) =       0.000557920078
  error estimate for blocks of size 2^( 7) =       0.000556642452

      target function =                  N/A
              le_mean =     -22.818494469686
             les_mean =     521.168917741403
             stat err =       0.000552649511
             autocorr =       1.296841168627
              std dev =       0.686311685003
             le_variance =       0.471023728972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471080252557
                                         uncertainty =       0.002679293071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471080252557
                                         uncertainty =       0.002679293071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485295960
  error estimate for blocks of size 2^( 2) =       0.000506909037
  error estimate for blocks of size 2^( 3) =       0.000526971972
  error estimate for blocks of size 2^( 4) =       0.000542775783
  error estimate for blocks of size 2^( 5) =       0.000553261018
  error estimate for blocks of size 2^( 6) =       0.000557920773
  error estimate for blocks of size 2^( 7) =       0.000556642786

      target function =                  N/A
              le_mean =     -22.818494485959
             les_mean =     521.168980391722
             stat err =       0.000552650090
             autocorr =       1.296842211453
              std dev =       0.686312128570
             le_variance =       0.471024337822


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818494488264        initial  <--
     2.4414e+01     2.4414e+02             1.4379e-05       -22.818494451528
     9.7656e+01     9.7656e+02             3.6259e-06       -22.818494469686
     3.9062e+02     3.9062e+03             9.0844e-07       -22.818494485959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2971
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548912e-02 3 1  ON 1
ci_03                -2.577487e-02 3 1  ON 2
ci_04                 2.521632e-02 3 1  ON 3
ci_05                -2.312375e-02 3 1  ON 4
ci_06                -2.242890e-02 3 1  ON 5
ci_07                 2.484812e-02 3 1  ON 6
ci_08                -4.582615e-03 3 1  ON 7
ci_09                -1.125886e-02 3 1  ON 8
ci_10                -1.180359e-02 3 1  ON 9
ci_11                 1.629248e-02 3 1  ON 10
ci_12                 1.118562e-02 3 1  ON 11
ci_13                 1.205636e-02 3 1  ON 12
ci_14                 1.764315e-02 3 1  ON 13
ci_15                 8.680594e-03 3 1  ON 14
ci_16                 8.617760e-03 3 1  ON 15
ci_17                -1.052891e-02 3 1  ON 16
ci_18                -9.317148e-03 3 1  ON 17
ci_19                 8.993548e-03 3 1  ON 18
ci_20                 1.026259e-02 3 1  ON 19
ci_21                 8.533095e-03 3 1  ON 20
ci_22                 7.503451e-03 3 1  ON 21
ci_23                 5.759386e-03 3 1  ON 22
ci_24                 6.097622e-03 3 1  ON 23
ci_25                 4.930440e-03 3 1  ON 24
ci_26                 3.258693e-03 3 1  ON 25
ci_27                 2.890504e-03 3 1  ON 26
ci_28                 4.664108e-03 3 1  ON 27
ci_29                 3.579215e-03 3 1  ON 28
ci_30                -7.929783e-04 3 1  ON 29
ci_31                 2.366107e-04 3 1  ON 30
ci_32                 5.001516e-04 3 1  ON 31
ci_33                -3.522402e-04 3 1  ON 32
ci_34                 3.540037e-04 3 1  ON 33
ci_35                 2.195728e-03 3 1  ON 34
ci_36                -1.193266e-03 3 1  ON 35
ci_37                -7.580114e-04 3 1  ON 36
ci_38                -9.970527e-04 3 1  ON 37
ci_39                -3.896373e-04 3 1  ON 38
ci_40                -1.036563e-03 3 1  ON 39
ci_41                 9.202130e-04 3 1  ON 40
ci_42                 5.567817e-04 3 1  ON 41
ci_43                -1.728779e-03 3 1  ON 42
ci_44                -2.018441e-03 3 1  ON 43
ci_45                -3.021976e-04 3 1  ON 44
ci_46                -4.028905e-04 3 1  ON 45
ci_47                -5.145344e-04 3 1  ON 46
ci_48                -8.817022e-04 3 1  ON 47
ci_49                -1.271242e-03 3 1  ON 48
ci_50                -7.604163e-04 3 1  ON 49
ci_51                 3.446730e-05 3 1  ON 50
ci_52                -6.669055e-04 3 1  ON 51
ci_53                -1.487982e-03 3 1  ON 52
ci_54                -1.058697e-03 3 1  ON 53
ci_55                -1.448743e-03 3 1  ON 54
ci_56                 1.645685e-03 3 1  ON 55
ci_57                 1.475921e-03 3 1  ON 56
ci_58                -1.262658e-03 3 1  ON 57
ci_59                -1.217946e-03 3 1  ON 58
ci_60                 8.297284e-04 3 1  ON 59
ci_61                 2.302037e-03 3 1  ON 60
ci_62                -7.289331e-04 3 1  ON 61
ci_63                -8.392719e-04 3 1  ON 62
ci_64                -1.192436e-04 3 1  ON 63
ci_65                -1.810601e-04 3 1  ON 64
ci_66                -2.228659e-04 3 1  ON 65
ci_67                -1.077464e-03 3 1  ON 66
ci_68                -2.563803e-03 3 1  ON 67
ci_69                -1.691485e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2137e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.747
    reference variance = 0.584116
====================================================
  Execution time = 2.5283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8803e-01
  Total weights = 1.963543674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470664083523
                                         uncertainty =       0.002376800253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470664083523
                                         uncertainty =       0.002376800253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485103944
  error estimate for blocks of size 2^( 2) =       0.000506340938
  error estimate for blocks of size 2^( 3) =       0.000526867496
  error estimate for blocks of size 2^( 4) =       0.000542585214
  error estimate for blocks of size 2^( 5) =       0.000549865182
  error estimate for blocks of size 2^( 6) =       0.000555042179
  error estimate for blocks of size 2^( 7) =       0.000558922694

      target function =                  N/A
              le_mean =     -22.819849451204
             les_mean =     521.233561480093
             stat err =       0.000551603817
             autocorr =       1.292959477216
              std dev =       0.686040577407
             le_variance =       0.470651673850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281984945120e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819849451155       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819849464479       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819849464192       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819849464334       residual = 6.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.819775e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819849451155       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819849454488       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819849454417       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819849454452       residual = 7.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 4.553298e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819849451155       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819849451988       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819849451970       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819849451979       residual = 7.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 1.138566e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9799e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.163557e-01 3 1  ON 0
ci_02                -2.548911e-02 3 1  ON 1
ci_03                -2.577489e-02 3 1  ON 2
ci_04                 2.521600e-02 3 1  ON 3
ci_05                -2.312355e-02 3 1  ON 4
ci_06                -2.242892e-02 3 1  ON 5
ci_07                 2.484825e-02 3 1  ON 6
ci_08                -4.582618e-03 3 1  ON 7
ci_09                -1.125894e-02 3 1  ON 8
ci_10                -1.180354e-02 3 1  ON 9
ci_11                 1.629233e-02 3 1  ON 10
ci_12                 1.118534e-02 3 1  ON 11
ci_13                 1.205638e-02 3 1  ON 12
ci_14                 1.764308e-02 3 1  ON 13
ci_15                 8.680486e-03 3 1  ON 14
ci_16                 8.617779e-03 3 1  ON 15
ci_17                -1.052871e-02 3 1  ON 16
ci_18                -9.317510e-03 3 1  ON 17
ci_19                 8.993722e-03 3 1  ON 18
ci_20                 1.026268e-02 3 1  ON 19
ci_21                 8.533083e-03 3 1  ON 20
ci_22                 7.503485e-03 3 1  ON 21
ci_23                 5.759833e-03 3 1  ON 22
ci_24                 6.097661e-03 3 1  ON 23
ci_25                 4.930684e-03 3 1  ON 24
ci_26                 3.258487e-03 3 1  ON 25
ci_27                 2.890603e-03 3 1  ON 26
ci_28                 4.663801e-03 3 1  ON 27
ci_29                 3.579297e-03 3 1  ON 28
ci_30                -7.928097e-04 3 1  ON 29
ci_31                 2.367870e-04 3 1  ON 30
ci_32                 4.996993e-04 3 1  ON 31
ci_33                -3.523837e-04 3 1  ON 32
ci_34                 3.540150e-04 3 1  ON 33
ci_35                 2.195370e-03 3 1  ON 34
ci_36                -1.193106e-03 3 1  ON 35
ci_37                -7.578781e-04 3 1  ON 36
ci_38                -9.969130e-04 3 1  ON 37
ci_39                -3.895758e-04 3 1  ON 38
ci_40                -1.036687e-03 3 1  ON 39
ci_41                 9.201881e-04 3 1  ON 40
ci_42                 5.567919e-04 3 1  ON 41
ci_43                -1.728568e-03 3 1  ON 42
ci_44                -2.018303e-03 3 1  ON 43
ci_45                -3.021209e-04 3 1  ON 44
ci_46                -4.027611e-04 3 1  ON 45
ci_47                -5.145708e-04 3 1  ON 46
ci_48                -8.816748e-04 3 1  ON 47
ci_49                -1.271216e-03 3 1  ON 48
ci_50                -7.604256e-04 3 1  ON 49
ci_51                 3.475044e-05 3 1  ON 50
ci_52                -6.664501e-04 3 1  ON 51
ci_53                -1.487655e-03 3 1  ON 52
ci_54                -1.058702e-03 3 1  ON 53
ci_55                -1.448446e-03 3 1  ON 54
ci_56                 1.645821e-03 3 1  ON 55
ci_57                 1.475998e-03 3 1  ON 56
ci_58                -1.262706e-03 3 1  ON 57
ci_59                -1.217873e-03 3 1  ON 58
ci_60                 8.298607e-04 3 1  ON 59
ci_61                 2.301960e-03 3 1  ON 60
ci_62                -7.291181e-04 3 1  ON 61
ci_63                -8.388571e-04 3 1  ON 62
ci_64                -1.193958e-04 3 1  ON 63
ci_65                -1.810066e-04 3 1  ON 64
ci_66                -2.227858e-04 3 1  ON 65
ci_67                -1.077524e-03 3 1  ON 66
ci_68                -2.563680e-03 3 1  ON 67
ci_69                -1.691548e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7965
    reference variance = 1.00036
====================================================
  Execution time = 2.4822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9277e-01
  Total weights = 1.9640e+06
  Execution time = 3.4944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559441098
                                         uncertainty =       0.002640480362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559441098
                                         uncertainty =       0.002640480362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486061466
  error estimate for blocks of size 2^( 2) =       0.000507344245
  error estimate for blocks of size 2^( 3) =       0.000528061936
  error estimate for blocks of size 2^( 4) =       0.000543199070
  error estimate for blocks of size 2^( 5) =       0.000553638638
  error estimate for blocks of size 2^( 6) =       0.000558492894
  error estimate for blocks of size 2^( 7) =       0.000565455289

      target function =                  N/A
              le_mean =     -22.818968969354
             les_mean =     521.198118638194
             stat err =       0.000555196473
             autocorr =       1.304701051050
              std dev =       0.687394717084
             le_variance =       0.472511497074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559540202
                                         uncertainty =       0.002640511657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559540202
                                         uncertainty =       0.002640511657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486061513
  error estimate for blocks of size 2^( 2) =       0.000507344315
  error estimate for blocks of size 2^( 3) =       0.000528061999
  error estimate for blocks of size 2^( 4) =       0.000543199147
  error estimate for blocks of size 2^( 5) =       0.000553638684
  error estimate for blocks of size 2^( 6) =       0.000558493000
  error estimate for blocks of size 2^( 7) =       0.000565455380

      target function =                  N/A
              le_mean =     -22.818968972784
             les_mean =     521.198118119701
             stat err =       0.000555196553
             autocorr =       1.304701174107
              std dev =       0.687394783534
             le_variance =       0.472511588430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559490245
                                         uncertainty =       0.002640495983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559490245
                                         uncertainty =       0.002640495983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486061489
  error estimate for blocks of size 2^( 2) =       0.000507344280
  error estimate for blocks of size 2^( 3) =       0.000528061967
  error estimate for blocks of size 2^( 4) =       0.000543199108
  error estimate for blocks of size 2^( 5) =       0.000553638661
  error estimate for blocks of size 2^( 6) =       0.000558492947
  error estimate for blocks of size 2^( 7) =       0.000565455334

      target function =                  N/A
              le_mean =     -22.818968971043
             les_mean =     521.198118347238
             stat err =       0.000555196513
             autocorr =       1.304701112903
              std dev =       0.687394750012
             le_variance =       0.472511542344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559447195
                                         uncertainty =       0.002640482311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472559447195
                                         uncertainty =       0.002640482311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486061469
  error estimate for blocks of size 2^( 2) =       0.000507344249
  error estimate for blocks of size 2^( 3) =       0.000528061940
  error estimate for blocks of size 2^( 4) =       0.000543199075
  error estimate for blocks of size 2^( 5) =       0.000553638641
  error estimate for blocks of size 2^( 6) =       0.000558492901
  error estimate for blocks of size 2^( 7) =       0.000565455294

      target function =                  N/A
              le_mean =     -22.818968969562
             les_mean =     521.198118596682
             stat err =       0.000555196478
             autocorr =       1.304701058806
              std dev =       0.687394721166
             le_variance =       0.472511502687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818968969354        initial
     2.4414e+02     2.4414e+03             1.8198e-06       -22.818968972784  <--
     9.7656e+02     9.7656e+03             4.5533e-07       -22.818968971043
     3.9062e+03     3.9062e+04             1.1386e-07       -22.818968969562

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 4.2473e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548909e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521504e-02 3 1  ON 3
ci_05                -2.312294e-02 3 1  ON 4
ci_06                -2.242896e-02 3 1  ON 5
ci_07                 2.484863e-02 3 1  ON 6
ci_08                -4.582625e-03 3 1  ON 7
ci_09                -1.125916e-02 3 1  ON 8
ci_10                -1.180341e-02 3 1  ON 9
ci_11                 1.629186e-02 3 1  ON 10
ci_12                 1.118451e-02 3 1  ON 11
ci_13                 1.205645e-02 3 1  ON 12
ci_14                 1.764287e-02 3 1  ON 13
ci_15                 8.680162e-03 3 1  ON 14
ci_16                 8.617837e-03 3 1  ON 15
ci_17                -1.052811e-02 3 1  ON 16
ci_18                -9.318595e-03 3 1  ON 17
ci_19                 8.994244e-03 3 1  ON 18
ci_20                 1.026295e-02 3 1  ON 19
ci_21                 8.533046e-03 3 1  ON 20
ci_22                 7.503587e-03 3 1  ON 21
ci_23                 5.761173e-03 3 1  ON 22
ci_24                 6.097778e-03 3 1  ON 23
ci_25                 4.931416e-03 3 1  ON 24
ci_26                 3.257869e-03 3 1  ON 25
ci_27                 2.890898e-03 3 1  ON 26
ci_28                 4.662879e-03 3 1  ON 27
ci_29                 3.579542e-03 3 1  ON 28
ci_30                -7.923042e-04 3 1  ON 29
ci_31                 2.373155e-04 3 1  ON 30
ci_32                 4.983439e-04 3 1  ON 31
ci_33                -3.528137e-04 3 1  ON 32
ci_34                 3.540488e-04 3 1  ON 33
ci_35                 2.194294e-03 3 1  ON 34
ci_36                -1.192625e-03 3 1  ON 35
ci_37                -7.574789e-04 3 1  ON 36
ci_38                -9.964944e-04 3 1  ON 37
ci_39                -3.893915e-04 3 1  ON 38
ci_40                -1.037058e-03 3 1  ON 39
ci_41                 9.201134e-04 3 1  ON 40
ci_42                 5.568227e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017889e-03 3 1  ON 43
ci_45                -3.018909e-04 3 1  ON 44
ci_46                -4.023733e-04 3 1  ON 45
ci_47                -5.146799e-04 3 1  ON 46
ci_48                -8.815929e-04 3 1  ON 47
ci_49                -1.271138e-03 3 1  ON 48
ci_50                -7.604533e-04 3 1  ON 49
ci_51                 3.559889e-05 3 1  ON 50
ci_52                -6.650857e-04 3 1  ON 51
ci_53                -1.486673e-03 3 1  ON 52
ci_54                -1.058716e-03 3 1  ON 53
ci_55                -1.447553e-03 3 1  ON 54
ci_56                 1.646227e-03 3 1  ON 55
ci_57                 1.476229e-03 3 1  ON 56
ci_58                -1.262851e-03 3 1  ON 57
ci_59                -1.217653e-03 3 1  ON 58
ci_60                 8.302574e-04 3 1  ON 59
ci_61                 2.301730e-03 3 1  ON 60
ci_62                -7.296722e-04 3 1  ON 61
ci_63                -8.376145e-04 3 1  ON 62
ci_64                -1.198520e-04 3 1  ON 63
ci_65                -1.808464e-04 3 1  ON 64
ci_66                -2.225458e-04 3 1  ON 65
ci_67                -1.077703e-03 3 1  ON 66
ci_68                -2.563311e-03 3 1  ON 67
ci_69                -1.691736e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7741
    reference variance = 0.24039
====================================================
  Execution time = 2.5315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8595e-01
  Total weights = 1.963710584e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472127106690
                                         uncertainty =       0.002928872958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472127106690
                                         uncertainty =       0.002928872958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485888215
  error estimate for blocks of size 2^( 2) =       0.000507740381
  error estimate for blocks of size 2^( 3) =       0.000528532074
  error estimate for blocks of size 2^( 4) =       0.000544386517
  error estimate for blocks of size 2^( 5) =       0.000555115801
  error estimate for blocks of size 2^( 6) =       0.000560229574
  error estimate for blocks of size 2^( 7) =       0.000565261964

      target function =                  N/A
              le_mean =     -22.818693433048
             les_mean =     521.178722546464
             stat err =       0.000556248464
             autocorr =       1.310584173600
              std dev =       0.687149702898
             le_variance =       0.472174714192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281869343305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818693433006       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818693567771       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818693571279       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818693570736       residual = 8.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 7.115412e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818693433006       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818693466781       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818693467677       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818693467541       residual = 8.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.785820e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818693433006       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818693441455       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818693441680       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818693441646       residual = 8.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 4.468925e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9827e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.163542e-01 3 1  ON 0
ci_02                -2.548918e-02 3 1  ON 1
ci_03                -2.577505e-02 3 1  ON 2
ci_04                 2.521447e-02 3 1  ON 3
ci_05                -2.312291e-02 3 1  ON 4
ci_06                -2.242939e-02 3 1  ON 5
ci_07                 2.484965e-02 3 1  ON 6
ci_08                -4.583003e-03 3 1  ON 7
ci_09                -1.125925e-02 3 1  ON 8
ci_10                -1.180261e-02 3 1  ON 9
ci_11                 1.629171e-02 3 1  ON 10
ci_12                 1.118458e-02 3 1  ON 11
ci_13                 1.205603e-02 3 1  ON 12
ci_14                 1.764276e-02 3 1  ON 13
ci_15                 8.679407e-03 3 1  ON 14
ci_16                 8.617308e-03 3 1  ON 15
ci_17                -1.052697e-02 3 1  ON 16
ci_18                -9.318604e-03 3 1  ON 17
ci_19                 8.993669e-03 3 1  ON 18
ci_20                 1.026231e-02 3 1  ON 19
ci_21                 8.532482e-03 3 1  ON 20
ci_22                 7.504616e-03 3 1  ON 21
ci_23                 5.762186e-03 3 1  ON 22
ci_24                 6.097406e-03 3 1  ON 23
ci_25                 4.930885e-03 3 1  ON 24
ci_26                 3.257059e-03 3 1  ON 25
ci_27                 2.890856e-03 3 1  ON 26
ci_28                 4.662490e-03 3 1  ON 27
ci_29                 3.579369e-03 3 1  ON 28
ci_30                -7.920495e-04 3 1  ON 29
ci_31                 2.371673e-04 3 1  ON 30
ci_32                 4.969961e-04 3 1  ON 31
ci_33                -3.530346e-04 3 1  ON 32
ci_34                 3.545087e-04 3 1  ON 33
ci_35                 2.192546e-03 3 1  ON 34
ci_36                -1.191356e-03 3 1  ON 35
ci_37                -7.571890e-04 3 1  ON 36
ci_38                -9.956023e-04 3 1  ON 37
ci_39                -3.886056e-04 3 1  ON 38
ci_40                -1.037599e-03 3 1  ON 39
ci_41                 9.192472e-04 3 1  ON 40
ci_42                 5.568338e-04 3 1  ON 41
ci_43                -1.727634e-03 3 1  ON 42
ci_44                -2.017498e-03 3 1  ON 43
ci_45                -3.023581e-04 3 1  ON 44
ci_46                -4.021219e-04 3 1  ON 45
ci_47                -5.153433e-04 3 1  ON 46
ci_48                -8.806579e-04 3 1  ON 47
ci_49                -1.270807e-03 3 1  ON 48
ci_50                -7.597835e-04 3 1  ON 49
ci_51                 3.647171e-05 3 1  ON 50
ci_52                -6.638115e-04 3 1  ON 51
ci_53                -1.486878e-03 3 1  ON 52
ci_54                -1.057855e-03 3 1  ON 53
ci_55                -1.446925e-03 3 1  ON 54
ci_56                 1.645797e-03 3 1  ON 55
ci_57                 1.477523e-03 3 1  ON 56
ci_58                -1.262446e-03 3 1  ON 57
ci_59                -1.217744e-03 3 1  ON 58
ci_60                 8.297218e-04 3 1  ON 59
ci_61                 2.301256e-03 3 1  ON 60
ci_62                -7.286591e-04 3 1  ON 61
ci_63                -8.358287e-04 3 1  ON 62
ci_64                -1.197593e-04 3 1  ON 63
ci_65                -1.809435e-04 3 1  ON 64
ci_66                -2.231135e-04 3 1  ON 65
ci_67                -1.077142e-03 3 1  ON 66
ci_68                -2.562647e-03 3 1  ON 67
ci_69                -1.691357e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.849
    reference variance = 0.528422
====================================================
  Execution time = 2.4667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8744e-01
  Total weights = 1.9636e+06
  Execution time = 3.5083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470421689103
                                         uncertainty =       0.002230356835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470421689103
                                         uncertainty =       0.002230356835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484990603
  error estimate for blocks of size 2^( 2) =       0.000506867705
  error estimate for blocks of size 2^( 3) =       0.000528008548
  error estimate for blocks of size 2^( 4) =       0.000544070457
  error estimate for blocks of size 2^( 5) =       0.000553559235
  error estimate for blocks of size 2^( 6) =       0.000558916762
  error estimate for blocks of size 2^( 7) =       0.000562820713

      target function =                  N/A
              le_mean =     -22.818565116590
             les_mean =     521.174289804936
             stat err =       0.000554841792
             autocorr =       1.308795172379
              std dev =       0.685880287778
             le_variance =       0.470431769163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470418957129
                                         uncertainty =       0.002230301792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470418957129
                                         uncertainty =       0.002230301792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484989190
  error estimate for blocks of size 2^( 2) =       0.000506866335
  error estimate for blocks of size 2^( 3) =       0.000528007230
  error estimate for blocks of size 2^( 4) =       0.000544069397
  error estimate for blocks of size 2^( 5) =       0.000553558366
  error estimate for blocks of size 2^( 6) =       0.000558916084
  error estimate for blocks of size 2^( 7) =       0.000562820119

      target function =                  N/A
              le_mean =     -22.818565018557
             les_mean =     521.174275512573
             stat err =       0.000554840991
             autocorr =       1.308799021221
              std dev =       0.685878289640
             le_variance =       0.470429028199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470420316546
                                         uncertainty =       0.002230329162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470420316546
                                         uncertainty =       0.002230329162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484989893
  error estimate for blocks of size 2^( 2) =       0.000506867017
  error estimate for blocks of size 2^( 3) =       0.000528007886
  error estimate for blocks of size 2^( 4) =       0.000544069925
  error estimate for blocks of size 2^( 5) =       0.000553558798
  error estimate for blocks of size 2^( 6) =       0.000558916421
  error estimate for blocks of size 2^( 7) =       0.000562820413

      target function =                  N/A
              le_mean =     -22.818565067555
             les_mean =     521.174545922333
             stat err =       0.000554841389
             autocorr =       1.308797102764
              std dev =       0.685879283913
             le_variance =       0.470430392101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470421517129
                                         uncertainty =       0.002230353366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470421517129
                                         uncertainty =       0.002230353366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484990514
  error estimate for blocks of size 2^( 2) =       0.000506867619
  error estimate for blocks of size 2^( 3) =       0.000528008465
  error estimate for blocks of size 2^( 4) =       0.000544070391
  error estimate for blocks of size 2^( 5) =       0.000553559180
  error estimate for blocks of size 2^( 6) =       0.000558916720
  error estimate for blocks of size 2^( 7) =       0.000562820676

      target function =                  N/A
              le_mean =     -22.818565110359
             les_mean =     521.174294006654
             stat err =       0.000554841742
             autocorr =       1.308795414346
              std dev =       0.685880162001
             le_variance =       0.470431596626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818565116590        initial  <--
     6.1035e+01     6.1035e+02             7.1154e-06       -22.818565018557
     2.4414e+02     2.4414e+03             1.7858e-06       -22.818565067555
     9.7656e+02     9.7656e+03             4.4689e-07       -22.818565110359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3116
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548909e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521504e-02 3 1  ON 3
ci_05                -2.312294e-02 3 1  ON 4
ci_06                -2.242896e-02 3 1  ON 5
ci_07                 2.484863e-02 3 1  ON 6
ci_08                -4.582625e-03 3 1  ON 7
ci_09                -1.125916e-02 3 1  ON 8
ci_10                -1.180341e-02 3 1  ON 9
ci_11                 1.629186e-02 3 1  ON 10
ci_12                 1.118451e-02 3 1  ON 11
ci_13                 1.205645e-02 3 1  ON 12
ci_14                 1.764287e-02 3 1  ON 13
ci_15                 8.680162e-03 3 1  ON 14
ci_16                 8.617837e-03 3 1  ON 15
ci_17                -1.052811e-02 3 1  ON 16
ci_18                -9.318595e-03 3 1  ON 17
ci_19                 8.994244e-03 3 1  ON 18
ci_20                 1.026295e-02 3 1  ON 19
ci_21                 8.533046e-03 3 1  ON 20
ci_22                 7.503587e-03 3 1  ON 21
ci_23                 5.761173e-03 3 1  ON 22
ci_24                 6.097778e-03 3 1  ON 23
ci_25                 4.931416e-03 3 1  ON 24
ci_26                 3.257869e-03 3 1  ON 25
ci_27                 2.890898e-03 3 1  ON 26
ci_28                 4.662879e-03 3 1  ON 27
ci_29                 3.579542e-03 3 1  ON 28
ci_30                -7.923042e-04 3 1  ON 29
ci_31                 2.373155e-04 3 1  ON 30
ci_32                 4.983439e-04 3 1  ON 31
ci_33                -3.528137e-04 3 1  ON 32
ci_34                 3.540488e-04 3 1  ON 33
ci_35                 2.194294e-03 3 1  ON 34
ci_36                -1.192625e-03 3 1  ON 35
ci_37                -7.574789e-04 3 1  ON 36
ci_38                -9.964944e-04 3 1  ON 37
ci_39                -3.893915e-04 3 1  ON 38
ci_40                -1.037058e-03 3 1  ON 39
ci_41                 9.201134e-04 3 1  ON 40
ci_42                 5.568227e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017889e-03 3 1  ON 43
ci_45                -3.018909e-04 3 1  ON 44
ci_46                -4.023733e-04 3 1  ON 45
ci_47                -5.146799e-04 3 1  ON 46
ci_48                -8.815929e-04 3 1  ON 47
ci_49                -1.271138e-03 3 1  ON 48
ci_50                -7.604533e-04 3 1  ON 49
ci_51                 3.559889e-05 3 1  ON 50
ci_52                -6.650857e-04 3 1  ON 51
ci_53                -1.486673e-03 3 1  ON 52
ci_54                -1.058716e-03 3 1  ON 53
ci_55                -1.447553e-03 3 1  ON 54
ci_56                 1.646227e-03 3 1  ON 55
ci_57                 1.476229e-03 3 1  ON 56
ci_58                -1.262851e-03 3 1  ON 57
ci_59                -1.217653e-03 3 1  ON 58
ci_60                 8.302574e-04 3 1  ON 59
ci_61                 2.301730e-03 3 1  ON 60
ci_62                -7.296722e-04 3 1  ON 61
ci_63                -8.376145e-04 3 1  ON 62
ci_64                -1.198520e-04 3 1  ON 63
ci_65                -1.808464e-04 3 1  ON 64
ci_66                -2.225458e-04 3 1  ON 65
ci_67                -1.077703e-03 3 1  ON 66
ci_68                -2.563311e-03 3 1  ON 67
ci_69                -1.691736e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.9974
    reference variance = 0.806599
====================================================
  Execution time = 2.7438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8498e-01
  Total weights = 1.963414848e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469335673074
                                         uncertainty =       0.002210549414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469335673074
                                         uncertainty =       0.002210549414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484588299
  error estimate for blocks of size 2^( 2) =       0.000506475152
  error estimate for blocks of size 2^( 3) =       0.000526816450
  error estimate for blocks of size 2^( 4) =       0.000541930998
  error estimate for blocks of size 2^( 5) =       0.000551496009
  error estimate for blocks of size 2^( 6) =       0.000556805128
  error estimate for blocks of size 2^( 7) =       0.000561639308

      target function =                  N/A
              le_mean =     -22.819873298997
             les_mean =     521.231598344520
             stat err =       0.000552967861
             autocorr =       1.302128767705
              std dev =       0.685311344641
             le_variance =       0.469651639093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281987329900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819873298911       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819873303324       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819873305605       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819873305582       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 1.098955e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819873298911       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819873300015       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819873300585       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819873300580       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 2.748331e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819873298911       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819873299187       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819873299329       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819873299328       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 6.871419e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044272 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2029e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.163556e-01 3 1  ON 0
ci_02                -2.548914e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521489e-02 3 1  ON 3
ci_05                -2.312295e-02 3 1  ON 4
ci_06                -2.242904e-02 3 1  ON 5
ci_07                 2.484873e-02 3 1  ON 6
ci_08                -4.582612e-03 3 1  ON 7
ci_09                -1.125922e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629178e-02 3 1  ON 10
ci_12                 1.118458e-02 3 1  ON 11
ci_13                 1.205639e-02 3 1  ON 12
ci_14                 1.764281e-02 3 1  ON 13
ci_15                 8.680042e-03 3 1  ON 14
ci_16                 8.617816e-03 3 1  ON 15
ci_17                -1.052799e-02 3 1  ON 16
ci_18                -9.318639e-03 3 1  ON 17
ci_19                 8.994119e-03 3 1  ON 18
ci_20                 1.026291e-02 3 1  ON 19
ci_21                 8.533014e-03 3 1  ON 20
ci_22                 7.503636e-03 3 1  ON 21
ci_23                 5.761448e-03 3 1  ON 22
ci_24                 6.097768e-03 3 1  ON 23
ci_25                 4.931428e-03 3 1  ON 24
ci_26                 3.257921e-03 3 1  ON 25
ci_27                 2.890832e-03 3 1  ON 26
ci_28                 4.662798e-03 3 1  ON 27
ci_29                 3.579528e-03 3 1  ON 28
ci_30                -7.922255e-04 3 1  ON 29
ci_31                 2.373381e-04 3 1  ON 30
ci_32                 4.983000e-04 3 1  ON 31
ci_33                -3.528372e-04 3 1  ON 32
ci_34                 3.541311e-04 3 1  ON 33
ci_35                 2.194232e-03 3 1  ON 34
ci_36                -1.192586e-03 3 1  ON 35
ci_37                -7.574705e-04 3 1  ON 36
ci_38                -9.965001e-04 3 1  ON 37
ci_39                -3.893409e-04 3 1  ON 38
ci_40                -1.037040e-03 3 1  ON 39
ci_41                 9.199777e-04 3 1  ON 40
ci_42                 5.568103e-04 3 1  ON 41
ci_43                -1.728014e-03 3 1  ON 42
ci_44                -2.018017e-03 3 1  ON 43
ci_45                -3.018631e-04 3 1  ON 44
ci_46                -4.022322e-04 3 1  ON 45
ci_47                -5.147166e-04 3 1  ON 46
ci_48                -8.815442e-04 3 1  ON 47
ci_49                -1.271110e-03 3 1  ON 48
ci_50                -7.604290e-04 3 1  ON 49
ci_51                 3.568938e-05 3 1  ON 50
ci_52                -6.650078e-04 3 1  ON 51
ci_53                -1.486689e-03 3 1  ON 52
ci_54                -1.058687e-03 3 1  ON 53
ci_55                -1.447559e-03 3 1  ON 54
ci_56                 1.646476e-03 3 1  ON 55
ci_57                 1.476293e-03 3 1  ON 56
ci_58                -1.262783e-03 3 1  ON 57
ci_59                -1.217540e-03 3 1  ON 58
ci_60                 8.303029e-04 3 1  ON 59
ci_61                 2.301694e-03 3 1  ON 60
ci_62                -7.294953e-04 3 1  ON 61
ci_63                -8.377222e-04 3 1  ON 62
ci_64                -1.199168e-04 3 1  ON 63
ci_65                -1.808902e-04 3 1  ON 64
ci_66                -2.225799e-04 3 1  ON 65
ci_67                -1.077604e-03 3 1  ON 66
ci_68                -2.563144e-03 3 1  ON 67
ci_69                -1.691729e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8326
    reference variance = 0.449073
====================================================
  Execution time = 2.4597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8646e-01
  Total weights = 1.9637e+06
  Execution time = 3.5076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902857583
                                         uncertainty =       0.003137102183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902857583
                                         uncertainty =       0.003137102183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485756612
  error estimate for blocks of size 2^( 2) =       0.000507125625
  error estimate for blocks of size 2^( 3) =       0.000527474091
  error estimate for blocks of size 2^( 4) =       0.000543123241
  error estimate for blocks of size 2^( 5) =       0.000553723701
  error estimate for blocks of size 2^( 6) =       0.000560736772
  error estimate for blocks of size 2^( 7) =       0.000566078188

      target function =                  N/A
              le_mean =     -22.819486170142
             les_mean =     521.215407372296
             stat err =       0.000555915475
             autocorr =       1.309724907378
              std dev =       0.686963588168
             le_variance =       0.471918971469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902875491
                                         uncertainty =       0.003137175746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902875491
                                         uncertainty =       0.003137175746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485756620
  error estimate for blocks of size 2^( 2) =       0.000507125640
  error estimate for blocks of size 2^( 3) =       0.000527474107
  error estimate for blocks of size 2^( 4) =       0.000543123259
  error estimate for blocks of size 2^( 5) =       0.000553723715
  error estimate for blocks of size 2^( 6) =       0.000560736810
  error estimate for blocks of size 2^( 7) =       0.000566078225

      target function =                  N/A
              le_mean =     -22.819486167098
             les_mean =     521.215407779363
             stat err =       0.000555915502
             autocorr =       1.309724987874
              std dev =       0.686963600421
             le_variance =       0.471918988304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902866512
                                         uncertainty =       0.003137138978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902866512
                                         uncertainty =       0.003137138978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485756616
  error estimate for blocks of size 2^( 2) =       0.000507125632
  error estimate for blocks of size 2^( 3) =       0.000527474099
  error estimate for blocks of size 2^( 4) =       0.000543123250
  error estimate for blocks of size 2^( 5) =       0.000553723708
  error estimate for blocks of size 2^( 6) =       0.000560736791
  error estimate for blocks of size 2^( 7) =       0.000566078206

      target function =                  N/A
              le_mean =     -22.819486168616
             les_mean =     521.215407570627
             stat err =       0.000555915489
             autocorr =       1.309724947661
              std dev =       0.686963594276
             le_variance =       0.471918979861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902858696
                                         uncertainty =       0.003137106783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471902858696
                                         uncertainty =       0.003137106783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485756612
  error estimate for blocks of size 2^( 2) =       0.000507125626
  error estimate for blocks of size 2^( 3) =       0.000527474092
  error estimate for blocks of size 2^( 4) =       0.000543123242
  error estimate for blocks of size 2^( 5) =       0.000553723702
  error estimate for blocks of size 2^( 6) =       0.000560736774
  error estimate for blocks of size 2^( 7) =       0.000566078190

      target function =                  N/A
              le_mean =     -22.819486169951
             les_mean =     521.215407396513
             stat err =       0.000555915477
             autocorr =       1.309724912409
              std dev =       0.686963588929
             le_variance =       0.471918972514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819486170142        initial  <--
     6.1035e+02     6.1035e+03             1.0990e-06       -22.819486167098
     2.4414e+03     2.4414e+04             2.7483e-07       -22.819486168616
     9.7656e+03     9.7656e+04             6.8714e-08       -22.819486169951

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2624
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548909e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521504e-02 3 1  ON 3
ci_05                -2.312294e-02 3 1  ON 4
ci_06                -2.242896e-02 3 1  ON 5
ci_07                 2.484863e-02 3 1  ON 6
ci_08                -4.582625e-03 3 1  ON 7
ci_09                -1.125916e-02 3 1  ON 8
ci_10                -1.180341e-02 3 1  ON 9
ci_11                 1.629186e-02 3 1  ON 10
ci_12                 1.118451e-02 3 1  ON 11
ci_13                 1.205645e-02 3 1  ON 12
ci_14                 1.764287e-02 3 1  ON 13
ci_15                 8.680162e-03 3 1  ON 14
ci_16                 8.617837e-03 3 1  ON 15
ci_17                -1.052811e-02 3 1  ON 16
ci_18                -9.318595e-03 3 1  ON 17
ci_19                 8.994244e-03 3 1  ON 18
ci_20                 1.026295e-02 3 1  ON 19
ci_21                 8.533046e-03 3 1  ON 20
ci_22                 7.503587e-03 3 1  ON 21
ci_23                 5.761173e-03 3 1  ON 22
ci_24                 6.097778e-03 3 1  ON 23
ci_25                 4.931416e-03 3 1  ON 24
ci_26                 3.257869e-03 3 1  ON 25
ci_27                 2.890898e-03 3 1  ON 26
ci_28                 4.662879e-03 3 1  ON 27
ci_29                 3.579542e-03 3 1  ON 28
ci_30                -7.923042e-04 3 1  ON 29
ci_31                 2.373155e-04 3 1  ON 30
ci_32                 4.983439e-04 3 1  ON 31
ci_33                -3.528137e-04 3 1  ON 32
ci_34                 3.540488e-04 3 1  ON 33
ci_35                 2.194294e-03 3 1  ON 34
ci_36                -1.192625e-03 3 1  ON 35
ci_37                -7.574789e-04 3 1  ON 36
ci_38                -9.964944e-04 3 1  ON 37
ci_39                -3.893915e-04 3 1  ON 38
ci_40                -1.037058e-03 3 1  ON 39
ci_41                 9.201134e-04 3 1  ON 40
ci_42                 5.568227e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017889e-03 3 1  ON 43
ci_45                -3.018909e-04 3 1  ON 44
ci_46                -4.023733e-04 3 1  ON 45
ci_47                -5.146799e-04 3 1  ON 46
ci_48                -8.815929e-04 3 1  ON 47
ci_49                -1.271138e-03 3 1  ON 48
ci_50                -7.604533e-04 3 1  ON 49
ci_51                 3.559889e-05 3 1  ON 50
ci_52                -6.650857e-04 3 1  ON 51
ci_53                -1.486673e-03 3 1  ON 52
ci_54                -1.058716e-03 3 1  ON 53
ci_55                -1.447553e-03 3 1  ON 54
ci_56                 1.646227e-03 3 1  ON 55
ci_57                 1.476229e-03 3 1  ON 56
ci_58                -1.262851e-03 3 1  ON 57
ci_59                -1.217653e-03 3 1  ON 58
ci_60                 8.302574e-04 3 1  ON 59
ci_61                 2.301730e-03 3 1  ON 60
ci_62                -7.296722e-04 3 1  ON 61
ci_63                -8.376145e-04 3 1  ON 62
ci_64                -1.198520e-04 3 1  ON 63
ci_65                -1.808464e-04 3 1  ON 64
ci_66                -2.225458e-04 3 1  ON 65
ci_67                -1.077703e-03 3 1  ON 66
ci_68                -2.563311e-03 3 1  ON 67
ci_69                -1.691736e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6683
    reference variance = 0.426147
====================================================
  Execution time = 2.5379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8708e-01
  Total weights = 1.963990677e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473016358730
                                         uncertainty =       0.002871444821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473016358730
                                         uncertainty =       0.002871444821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486344292
  error estimate for blocks of size 2^( 2) =       0.000508030123
  error estimate for blocks of size 2^( 3) =       0.000528857306
  error estimate for blocks of size 2^( 4) =       0.000544410996
  error estimate for blocks of size 2^( 5) =       0.000554189863
  error estimate for blocks of size 2^( 6) =       0.000562362886
  error estimate for blocks of size 2^( 7) =       0.000564329670

      target function =                  N/A
              le_mean =     -22.820206183834
             les_mean =     521.248892268700
             stat err =       0.000556323354
             autocorr =       1.308479541466
              std dev =       0.687794693521
             le_variance =       0.473061540435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282020618383e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820206183765       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820206185319       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820206185418       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820206185421       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 6.630801e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820206183765       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820206184154       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820206184178       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820206184156       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.657764e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820206183765       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820206183862       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820206183868       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820206183869       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 4.144449e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9898e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548909e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521504e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242896e-02 3 1  ON 5
ci_07                 2.484863e-02 3 1  ON 6
ci_08                -4.582623e-03 3 1  ON 7
ci_09                -1.125915e-02 3 1  ON 8
ci_10                -1.180340e-02 3 1  ON 9
ci_11                 1.629185e-02 3 1  ON 10
ci_12                 1.118450e-02 3 1  ON 11
ci_13                 1.205644e-02 3 1  ON 12
ci_14                 1.764285e-02 3 1  ON 13
ci_15                 8.680150e-03 3 1  ON 14
ci_16                 8.617831e-03 3 1  ON 15
ci_17                -1.052811e-02 3 1  ON 16
ci_18                -9.318596e-03 3 1  ON 17
ci_19                 8.994261e-03 3 1  ON 18
ci_20                 1.026295e-02 3 1  ON 19
ci_21                 8.533043e-03 3 1  ON 20
ci_22                 7.503596e-03 3 1  ON 21
ci_23                 5.761182e-03 3 1  ON 22
ci_24                 6.097782e-03 3 1  ON 23
ci_25                 4.931416e-03 3 1  ON 24
ci_26                 3.257859e-03 3 1  ON 25
ci_27                 2.890892e-03 3 1  ON 26
ci_28                 4.662875e-03 3 1  ON 27
ci_29                 3.579544e-03 3 1  ON 28
ci_30                -7.923001e-04 3 1  ON 29
ci_31                 2.373225e-04 3 1  ON 30
ci_32                 4.983375e-04 3 1  ON 31
ci_33                -3.528091e-04 3 1  ON 32
ci_34                 3.540562e-04 3 1  ON 33
ci_35                 2.194282e-03 3 1  ON 34
ci_36                -1.192617e-03 3 1  ON 35
ci_37                -7.574792e-04 3 1  ON 36
ci_38                -9.964815e-04 3 1  ON 37
ci_39                -3.893981e-04 3 1  ON 38
ci_40                -1.037058e-03 3 1  ON 39
ci_41                 9.201017e-04 3 1  ON 40
ci_42                 5.568174e-04 3 1  ON 41
ci_43                -1.727933e-03 3 1  ON 42
ci_44                -2.017888e-03 3 1  ON 43
ci_45                -3.018901e-04 3 1  ON 44
ci_46                -4.023772e-04 3 1  ON 45
ci_47                -5.146749e-04 3 1  ON 46
ci_48                -8.815868e-04 3 1  ON 47
ci_49                -1.271132e-03 3 1  ON 48
ci_50                -7.604467e-04 3 1  ON 49
ci_51                 3.559854e-05 3 1  ON 50
ci_52                -6.650828e-04 3 1  ON 51
ci_53                -1.486664e-03 3 1  ON 52
ci_54                -1.058721e-03 3 1  ON 53
ci_55                -1.447549e-03 3 1  ON 54
ci_56                 1.646237e-03 3 1  ON 55
ci_57                 1.476244e-03 3 1  ON 56
ci_58                -1.262852e-03 3 1  ON 57
ci_59                -1.217652e-03 3 1  ON 58
ci_60                 8.302535e-04 3 1  ON 59
ci_61                 2.301719e-03 3 1  ON 60
ci_62                -7.296690e-04 3 1  ON 61
ci_63                -8.376050e-04 3 1  ON 62
ci_64                -1.198559e-04 3 1  ON 63
ci_65                -1.808476e-04 3 1  ON 64
ci_66                -2.225537e-04 3 1  ON 65
ci_67                -1.077703e-03 3 1  ON 66
ci_68                -2.563302e-03 3 1  ON 67
ci_69                -1.691726e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7392
    reference variance = 0.462966
====================================================
  Execution time = 2.4653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8158e-01
  Total weights = 1.9638e+06
  Execution time = 3.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379901945
                                         uncertainty =       0.002508122012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379901945
                                         uncertainty =       0.002508122012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483390744
  error estimate for blocks of size 2^( 2) =       0.000504941145
  error estimate for blocks of size 2^( 3) =       0.000525758195
  error estimate for blocks of size 2^( 4) =       0.000542162754
  error estimate for blocks of size 2^( 5) =       0.000550981717
  error estimate for blocks of size 2^( 6) =       0.000556671308
  error estimate for blocks of size 2^( 7) =       0.000557598157

      target function =                  N/A
              le_mean =     -22.819116625907
             les_mean =     521.193665617369
             stat err =       0.000551853484
             autocorr =       1.303319572488
              std dev =       0.683617746050
             le_variance =       0.467333222714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379891811
                                         uncertainty =       0.002508122124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379891811
                                         uncertainty =       0.002508122124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483390739
  error estimate for blocks of size 2^( 2) =       0.000504941141
  error estimate for blocks of size 2^( 3) =       0.000525758191
  error estimate for blocks of size 2^( 4) =       0.000542162751
  error estimate for blocks of size 2^( 5) =       0.000550981715
  error estimate for blocks of size 2^( 6) =       0.000556671307
  error estimate for blocks of size 2^( 7) =       0.000557598155

      target function =                  N/A
              le_mean =     -22.819116626540
             les_mean =     521.193665652874
             stat err =       0.000551853482
             autocorr =       1.303319590254
              std dev =       0.683617738650
             le_variance =       0.467333212597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379896878
                                         uncertainty =       0.002508122068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379896878
                                         uncertainty =       0.002508122068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483390741
  error estimate for blocks of size 2^( 2) =       0.000504941143
  error estimate for blocks of size 2^( 3) =       0.000525758193
  error estimate for blocks of size 2^( 4) =       0.000542162753
  error estimate for blocks of size 2^( 5) =       0.000550981716
  error estimate for blocks of size 2^( 6) =       0.000556671307
  error estimate for blocks of size 2^( 7) =       0.000557598156

      target function =                  N/A
              le_mean =     -22.819116626223
             les_mean =     521.193665635103
             stat err =       0.000551853483
             autocorr =       1.303319581368
              std dev =       0.683617742350
             le_variance =       0.467333217655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379901312
                                         uncertainty =       0.002508122019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467379901312
                                         uncertainty =       0.002508122019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483390744
  error estimate for blocks of size 2^( 2) =       0.000504941145
  error estimate for blocks of size 2^( 3) =       0.000525758195
  error estimate for blocks of size 2^( 4) =       0.000542162754
  error estimate for blocks of size 2^( 5) =       0.000550981717
  error estimate for blocks of size 2^( 6) =       0.000556671308
  error estimate for blocks of size 2^( 7) =       0.000557598157

      target function =                  N/A
              le_mean =     -22.819116625946
             les_mean =     521.193665619584
             stat err =       0.000551853484
             autocorr =       1.303319573604
              std dev =       0.683617745587
             le_variance =       0.467333222082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819116625907        initial
     6.1035e+03     6.1035e+04             6.6308e-08       -22.819116626540  <--
     2.4414e+04     2.4414e+05             1.6578e-08       -22.819116626223
     9.7656e+04     9.7656e+05             4.1444e-09       -22.819116625946

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 4.2272e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548908e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242897e-02 3 1  ON 5
ci_07                 2.484864e-02 3 1  ON 6
ci_08                -4.582617e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629181e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205643e-02 3 1  ON 12
ci_14                 1.764282e-02 3 1  ON 13
ci_15                 8.680115e-03 3 1  ON 14
ci_16                 8.617813e-03 3 1  ON 15
ci_17                -1.052810e-02 3 1  ON 16
ci_18                -9.318601e-03 3 1  ON 17
ci_19                 8.994311e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533035e-03 3 1  ON 20
ci_22                 7.503621e-03 3 1  ON 21
ci_23                 5.761209e-03 3 1  ON 22
ci_24                 6.097792e-03 3 1  ON 23
ci_25                 4.931413e-03 3 1  ON 24
ci_26                 3.257830e-03 3 1  ON 25
ci_27                 2.890874e-03 3 1  ON 26
ci_28                 4.662863e-03 3 1  ON 27
ci_29                 3.579551e-03 3 1  ON 28
ci_30                -7.922878e-04 3 1  ON 29
ci_31                 2.373436e-04 3 1  ON 30
ci_32                 4.983182e-04 3 1  ON 31
ci_33                -3.527952e-04 3 1  ON 32
ci_34                 3.540785e-04 3 1  ON 33
ci_35                 2.194244e-03 3 1  ON 34
ci_36                -1.192595e-03 3 1  ON 35
ci_37                -7.574801e-04 3 1  ON 36
ci_38                -9.964429e-04 3 1  ON 37
ci_39                -3.894180e-04 3 1  ON 38
ci_40                -1.037058e-03 3 1  ON 39
ci_41                 9.200666e-04 3 1  ON 40
ci_42                 5.568015e-04 3 1  ON 41
ci_43                -1.727927e-03 3 1  ON 42
ci_44                -2.017888e-03 3 1  ON 43
ci_45                -3.018878e-04 3 1  ON 44
ci_46                -4.023891e-04 3 1  ON 45
ci_47                -5.146601e-04 3 1  ON 46
ci_48                -8.815687e-04 3 1  ON 47
ci_49                -1.271113e-03 3 1  ON 48
ci_50                -7.604267e-04 3 1  ON 49
ci_51                 3.559750e-05 3 1  ON 50
ci_52                -6.650743e-04 3 1  ON 51
ci_53                -1.486637e-03 3 1  ON 52
ci_54                -1.058737e-03 3 1  ON 53
ci_55                -1.447537e-03 3 1  ON 54
ci_56                 1.646268e-03 3 1  ON 55
ci_57                 1.476290e-03 3 1  ON 56
ci_58                -1.262856e-03 3 1  ON 57
ci_59                -1.217647e-03 3 1  ON 58
ci_60                 8.302417e-04 3 1  ON 59
ci_61                 2.301686e-03 3 1  ON 60
ci_62                -7.296594e-04 3 1  ON 61
ci_63                -8.375766e-04 3 1  ON 62
ci_64                -1.198678e-04 3 1  ON 63
ci_65                -1.808511e-04 3 1  ON 64
ci_66                -2.225774e-04 3 1  ON 65
ci_67                -1.077704e-03 3 1  ON 66
ci_68                -2.563274e-03 3 1  ON 67
ci_69                -1.691694e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7416
    reference variance = 0.439502
====================================================
  Execution time = 2.5294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9388e-01
  Total weights = 1.963421863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477255564401
                                         uncertainty =       0.003555757822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477255564401
                                         uncertainty =       0.003555757822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488436472
  error estimate for blocks of size 2^( 2) =       0.000510007224
  error estimate for blocks of size 2^( 3) =       0.000530487448
  error estimate for blocks of size 2^( 4) =       0.000546679857
  error estimate for blocks of size 2^( 5) =       0.000556612464
  error estimate for blocks of size 2^( 6) =       0.000562153656
  error estimate for blocks of size 2^( 7) =       0.000565849748

      target function =                  N/A
              le_mean =     -22.820126643740
             les_mean =     521.252055184240
             stat err =       0.000557823931
             autocorr =       1.304301859516
              std dev =       0.690753482657
             le_variance =       0.477140373802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282012664374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820126643689       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820126651541       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820126651805       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820126651842       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 2.539899e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820126643689       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820126645652       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820126645718       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820126645727       residual = 7.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 6.350428e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820126643689       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820126644180       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820126644196       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820126644199       residual = 7.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.587650e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9795e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577498e-02 3 1  ON 2
ci_04                 2.521504e-02 3 1  ON 3
ci_05                -2.312292e-02 3 1  ON 4
ci_06                -2.242897e-02 3 1  ON 5
ci_07                 2.484863e-02 3 1  ON 6
ci_08                -4.582571e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180338e-02 3 1  ON 9
ci_11                 1.629177e-02 3 1  ON 10
ci_12                 1.118445e-02 3 1  ON 11
ci_13                 1.205638e-02 3 1  ON 12
ci_14                 1.764279e-02 3 1  ON 13
ci_15                 8.680090e-03 3 1  ON 14
ci_16                 8.617778e-03 3 1  ON 15
ci_17                -1.052809e-02 3 1  ON 16
ci_18                -9.318589e-03 3 1  ON 17
ci_19                 8.994341e-03 3 1  ON 18
ci_20                 1.026298e-02 3 1  ON 19
ci_21                 8.533008e-03 3 1  ON 20
ci_22                 7.503606e-03 3 1  ON 21
ci_23                 5.761261e-03 3 1  ON 22
ci_24                 6.097802e-03 3 1  ON 23
ci_25                 4.931440e-03 3 1  ON 24
ci_26                 3.257832e-03 3 1  ON 25
ci_27                 2.890868e-03 3 1  ON 26
ci_28                 4.662859e-03 3 1  ON 27
ci_29                 3.579556e-03 3 1  ON 28
ci_30                -7.922409e-04 3 1  ON 29
ci_31                 2.373381e-04 3 1  ON 30
ci_32                 4.983053e-04 3 1  ON 31
ci_33                -3.527813e-04 3 1  ON 32
ci_34                 3.541039e-04 3 1  ON 33
ci_35                 2.194198e-03 3 1  ON 34
ci_36                -1.192581e-03 3 1  ON 35
ci_37                -7.574484e-04 3 1  ON 36
ci_38                -9.964328e-04 3 1  ON 37
ci_39                -3.894000e-04 3 1  ON 38
ci_40                -1.037098e-03 3 1  ON 39
ci_41                 9.200327e-04 3 1  ON 40
ci_42                 5.568119e-04 3 1  ON 41
ci_43                -1.727946e-03 3 1  ON 42
ci_44                -2.017896e-03 3 1  ON 43
ci_45                -3.018846e-04 3 1  ON 44
ci_46                -4.023522e-04 3 1  ON 45
ci_47                -5.146792e-04 3 1  ON 46
ci_48                -8.815508e-04 3 1  ON 47
ci_49                -1.271129e-03 3 1  ON 48
ci_50                -7.604331e-04 3 1  ON 49
ci_51                 3.562680e-05 3 1  ON 50
ci_52                -6.650522e-04 3 1  ON 51
ci_53                -1.486620e-03 3 1  ON 52
ci_54                -1.058767e-03 3 1  ON 53
ci_55                -1.447486e-03 3 1  ON 54
ci_56                 1.646252e-03 3 1  ON 55
ci_57                 1.476280e-03 3 1  ON 56
ci_58                -1.262905e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302548e-04 3 1  ON 59
ci_61                 2.301672e-03 3 1  ON 60
ci_62                -7.296609e-04 3 1  ON 61
ci_63                -8.375364e-04 3 1  ON 62
ci_64                -1.199269e-04 3 1  ON 63
ci_65                -1.808344e-04 3 1  ON 64
ci_66                -2.225704e-04 3 1  ON 65
ci_67                -1.077690e-03 3 1  ON 66
ci_68                -2.563215e-03 3 1  ON 67
ci_69                -1.691631e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7383
    reference variance = 0.431834
====================================================
  Execution time = 2.4583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8547e-01
  Total weights = 1.9637e+06
  Execution time = 3.5005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177876684
                                         uncertainty =       0.002572962229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177876684
                                         uncertainty =       0.002572962229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485353525
  error estimate for blocks of size 2^( 2) =       0.000506920584
  error estimate for blocks of size 2^( 3) =       0.000527261778
  error estimate for blocks of size 2^( 4) =       0.000542254222
  error estimate for blocks of size 2^( 5) =       0.000552140929
  error estimate for blocks of size 2^( 6) =       0.000558323057
  error estimate for blocks of size 2^( 7) =       0.000560674656

      target function =                  N/A
              le_mean =     -22.819041096227
             les_mean =     521.194109587600
             stat err =       0.000553348216
             autocorr =       1.299812325546
              std dev =       0.686393538107
             le_variance =       0.471136089155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177875427
                                         uncertainty =       0.002572964657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177875427
                                         uncertainty =       0.002572964657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485353525
  error estimate for blocks of size 2^( 2) =       0.000506920587
  error estimate for blocks of size 2^( 3) =       0.000527261785
  error estimate for blocks of size 2^( 4) =       0.000542254228
  error estimate for blocks of size 2^( 5) =       0.000552140938
  error estimate for blocks of size 2^( 6) =       0.000558323060
  error estimate for blocks of size 2^( 7) =       0.000560674669

      target function =                  N/A
              le_mean =     -22.819041094010
             les_mean =     521.194109044718
             stat err =       0.000553348224
             autocorr =       1.299812367055
              std dev =       0.686393537091
             le_variance =       0.471136087760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177876052
                                         uncertainty =       0.002572963443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177876052
                                         uncertainty =       0.002572963443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485353525
  error estimate for blocks of size 2^( 2) =       0.000506920586
  error estimate for blocks of size 2^( 3) =       0.000527261781
  error estimate for blocks of size 2^( 4) =       0.000542254225
  error estimate for blocks of size 2^( 5) =       0.000552140933
  error estimate for blocks of size 2^( 6) =       0.000558323058
  error estimate for blocks of size 2^( 7) =       0.000560674663

      target function =                  N/A
              le_mean =     -22.819041095118
             les_mean =     521.194109315237
             stat err =       0.000553348220
             autocorr =       1.299812346305
              std dev =       0.686393537596
             le_variance =       0.471136088454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177876605
                                         uncertainty =       0.002572962381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471177876605
                                         uncertainty =       0.002572962381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485353525
  error estimate for blocks of size 2^( 2) =       0.000506920584
  error estimate for blocks of size 2^( 3) =       0.000527261778
  error estimate for blocks of size 2^( 4) =       0.000542254222
  error estimate for blocks of size 2^( 5) =       0.000552140929
  error estimate for blocks of size 2^( 6) =       0.000558323057
  error estimate for blocks of size 2^( 7) =       0.000560674657

      target function =                  N/A
              le_mean =     -22.819041096088
             les_mean =     521.194109553457
             stat err =       0.000553348216
             autocorr =       1.299812328141
              std dev =       0.686393538042
             le_variance =       0.471136089066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819041096227        initial  <--
     1.5259e+03     1.5259e+04             2.5399e-07       -22.819041094010
     6.1035e+03     6.1035e+04             6.3504e-08       -22.819041095118
     2.4414e+04     2.4414e+05             1.5876e-08       -22.819041096088

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1873
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548908e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242897e-02 3 1  ON 5
ci_07                 2.484864e-02 3 1  ON 6
ci_08                -4.582617e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629181e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205643e-02 3 1  ON 12
ci_14                 1.764282e-02 3 1  ON 13
ci_15                 8.680115e-03 3 1  ON 14
ci_16                 8.617813e-03 3 1  ON 15
ci_17                -1.052810e-02 3 1  ON 16
ci_18                -9.318601e-03 3 1  ON 17
ci_19                 8.994311e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533035e-03 3 1  ON 20
ci_22                 7.503621e-03 3 1  ON 21
ci_23                 5.761209e-03 3 1  ON 22
ci_24                 6.097792e-03 3 1  ON 23
ci_25                 4.931413e-03 3 1  ON 24
ci_26                 3.257830e-03 3 1  ON 25
ci_27                 2.890874e-03 3 1  ON 26
ci_28                 4.662863e-03 3 1  ON 27
ci_29                 3.579551e-03 3 1  ON 28
ci_30                -7.922878e-04 3 1  ON 29
ci_31                 2.373436e-04 3 1  ON 30
ci_32                 4.983182e-04 3 1  ON 31
ci_33                -3.527952e-04 3 1  ON 32
ci_34                 3.540785e-04 3 1  ON 33
ci_35                 2.194244e-03 3 1  ON 34
ci_36                -1.192595e-03 3 1  ON 35
ci_37                -7.574801e-04 3 1  ON 36
ci_38                -9.964429e-04 3 1  ON 37
ci_39                -3.894180e-04 3 1  ON 38
ci_40                -1.037058e-03 3 1  ON 39
ci_41                 9.200666e-04 3 1  ON 40
ci_42                 5.568015e-04 3 1  ON 41
ci_43                -1.727927e-03 3 1  ON 42
ci_44                -2.017888e-03 3 1  ON 43
ci_45                -3.018878e-04 3 1  ON 44
ci_46                -4.023891e-04 3 1  ON 45
ci_47                -5.146601e-04 3 1  ON 46
ci_48                -8.815687e-04 3 1  ON 47
ci_49                -1.271113e-03 3 1  ON 48
ci_50                -7.604267e-04 3 1  ON 49
ci_51                 3.559750e-05 3 1  ON 50
ci_52                -6.650743e-04 3 1  ON 51
ci_53                -1.486637e-03 3 1  ON 52
ci_54                -1.058737e-03 3 1  ON 53
ci_55                -1.447537e-03 3 1  ON 54
ci_56                 1.646268e-03 3 1  ON 55
ci_57                 1.476290e-03 3 1  ON 56
ci_58                -1.262856e-03 3 1  ON 57
ci_59                -1.217647e-03 3 1  ON 58
ci_60                 8.302417e-04 3 1  ON 59
ci_61                 2.301686e-03 3 1  ON 60
ci_62                -7.296594e-04 3 1  ON 61
ci_63                -8.375766e-04 3 1  ON 62
ci_64                -1.198678e-04 3 1  ON 63
ci_65                -1.808511e-04 3 1  ON 64
ci_66                -2.225774e-04 3 1  ON 65
ci_67                -1.077704e-03 3 1  ON 66
ci_68                -2.563274e-03 3 1  ON 67
ci_69                -1.691694e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8966
    reference variance = 0.366558
====================================================
  Execution time = 2.5419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8953e-01
  Total weights = 1.963694982e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476218898103
                                         uncertainty =       0.003509743700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476218898103
                                         uncertainty =       0.003509743700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487943406
  error estimate for blocks of size 2^( 2) =       0.000509508319
  error estimate for blocks of size 2^( 3) =       0.000530392383
  error estimate for blocks of size 2^( 4) =       0.000546405635
  error estimate for blocks of size 2^( 5) =       0.000555527568
  error estimate for blocks of size 2^( 6) =       0.000561560122
  error estimate for blocks of size 2^( 7) =       0.000564446442

      target function =                  N/A
              le_mean =     -22.819443125845
             les_mean =     521.216516191486
             stat err =       0.000556984942
             autocorr =       1.303010754202
              std dev =       0.690056183136
             le_variance =       0.476177535884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281944312585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819443125790       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819443126392       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819443126451       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819443126456       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 2.913681e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819443125790       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819443125940       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819443125955       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819443125961       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 7.284263e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819443125790       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819443125828       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819443125831       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819443125832       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 1.821070e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048196 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9944e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577496e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242897e-02 3 1  ON 5
ci_07                 2.484864e-02 3 1  ON 6
ci_08                -4.582618e-03 3 1  ON 7
ci_09                -1.125915e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629180e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205643e-02 3 1  ON 12
ci_14                 1.764282e-02 3 1  ON 13
ci_15                 8.680110e-03 3 1  ON 14
ci_16                 8.617810e-03 3 1  ON 15
ci_17                -1.052810e-02 3 1  ON 16
ci_18                -9.318600e-03 3 1  ON 17
ci_19                 8.994313e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533035e-03 3 1  ON 20
ci_22                 7.503622e-03 3 1  ON 21
ci_23                 5.761215e-03 3 1  ON 22
ci_24                 6.097792e-03 3 1  ON 23
ci_25                 4.931415e-03 3 1  ON 24
ci_26                 3.257831e-03 3 1  ON 25
ci_27                 2.890871e-03 3 1  ON 26
ci_28                 4.662861e-03 3 1  ON 27
ci_29                 3.579552e-03 3 1  ON 28
ci_30                -7.922852e-04 3 1  ON 29
ci_31                 2.373432e-04 3 1  ON 30
ci_32                 4.983122e-04 3 1  ON 31
ci_33                -3.527935e-04 3 1  ON 32
ci_34                 3.540809e-04 3 1  ON 33
ci_35                 2.194237e-03 3 1  ON 34
ci_36                -1.192589e-03 3 1  ON 35
ci_37                -7.574808e-04 3 1  ON 36
ci_38                -9.964367e-04 3 1  ON 37
ci_39                -3.894162e-04 3 1  ON 38
ci_40                -1.037057e-03 3 1  ON 39
ci_41                 9.200647e-04 3 1  ON 40
ci_42                 5.568006e-04 3 1  ON 41
ci_43                -1.727929e-03 3 1  ON 42
ci_44                -2.017887e-03 3 1  ON 43
ci_45                -3.018910e-04 3 1  ON 44
ci_46                -4.023900e-04 3 1  ON 45
ci_47                -5.146622e-04 3 1  ON 46
ci_48                -8.815684e-04 3 1  ON 47
ci_49                -1.271112e-03 3 1  ON 48
ci_50                -7.604245e-04 3 1  ON 49
ci_51                 3.559697e-05 3 1  ON 50
ci_52                -6.650698e-04 3 1  ON 51
ci_53                -1.486635e-03 3 1  ON 52
ci_54                -1.058735e-03 3 1  ON 53
ci_55                -1.447535e-03 3 1  ON 54
ci_56                 1.646268e-03 3 1  ON 55
ci_57                 1.476292e-03 3 1  ON 56
ci_58                -1.262858e-03 3 1  ON 57
ci_59                -1.217649e-03 3 1  ON 58
ci_60                 8.302422e-04 3 1  ON 59
ci_61                 2.301689e-03 3 1  ON 60
ci_62                -7.296559e-04 3 1  ON 61
ci_63                -8.375750e-04 3 1  ON 62
ci_64                -1.198689e-04 3 1  ON 63
ci_65                -1.808518e-04 3 1  ON 64
ci_66                -2.225788e-04 3 1  ON 65
ci_67                -1.077699e-03 3 1  ON 66
ci_68                -2.563268e-03 3 1  ON 67
ci_69                -1.691692e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7699
    reference variance = 0.494845
====================================================
  Execution time = 2.4577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9661e-01
  Total weights = 1.9637e+06
  Execution time = 3.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596279
                                         uncertainty =       0.002482604411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596279
                                         uncertainty =       0.002482604411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487874117
  error estimate for blocks of size 2^( 2) =       0.000508809725
  error estimate for blocks of size 2^( 3) =       0.000529114456
  error estimate for blocks of size 2^( 4) =       0.000544825371
  error estimate for blocks of size 2^( 5) =       0.000556372183
  error estimate for blocks of size 2^( 6) =       0.000561158023
  error estimate for blocks of size 2^( 7) =       0.000564135581

      target function =                  N/A
              le_mean =     -22.818024758727
             les_mean =     521.158859275406
             stat err =       0.000556622790
             autocorr =       1.301686527682
              std dev =       0.689958193458
             le_variance =       0.476042308720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596198
                                         uncertainty =       0.002482604629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596198
                                         uncertainty =       0.002482604629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487874117
  error estimate for blocks of size 2^( 2) =       0.000508809725
  error estimate for blocks of size 2^( 3) =       0.000529114456
  error estimate for blocks of size 2^( 4) =       0.000544825370
  error estimate for blocks of size 2^( 5) =       0.000556372183
  error estimate for blocks of size 2^( 6) =       0.000561158022
  error estimate for blocks of size 2^( 7) =       0.000564135581

      target function =                  N/A
              le_mean =     -22.818024759015
             les_mean =     521.158859282469
             stat err =       0.000556622789
             autocorr =       1.301686524941
              std dev =       0.689958193457
             le_variance =       0.476042308718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596238
                                         uncertainty =       0.002482604520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596238
                                         uncertainty =       0.002482604520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487874117
  error estimate for blocks of size 2^( 2) =       0.000508809725
  error estimate for blocks of size 2^( 3) =       0.000529114456
  error estimate for blocks of size 2^( 4) =       0.000544825371
  error estimate for blocks of size 2^( 5) =       0.000556372183
  error estimate for blocks of size 2^( 6) =       0.000561158023
  error estimate for blocks of size 2^( 7) =       0.000564135581

      target function =                  N/A
              le_mean =     -22.818024758871
             les_mean =     521.158859278923
             stat err =       0.000556622789
             autocorr =       1.301686526316
              std dev =       0.689958193457
             le_variance =       0.476042308719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596274
                                         uncertainty =       0.002482604424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476097596274
                                         uncertainty =       0.002482604424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487874117
  error estimate for blocks of size 2^( 2) =       0.000508809725
  error estimate for blocks of size 2^( 3) =       0.000529114456
  error estimate for blocks of size 2^( 4) =       0.000544825371
  error estimate for blocks of size 2^( 5) =       0.000556372183
  error estimate for blocks of size 2^( 6) =       0.000561158023
  error estimate for blocks of size 2^( 7) =       0.000564135581

      target function =                  N/A
              le_mean =     -22.818024758745
             les_mean =     521.158859275844
             stat err =       0.000556622790
             autocorr =       1.301686527504
              std dev =       0.689958193458
             le_variance =       0.476042308720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818024758727        initial
     1.5259e+04     1.5259e+05             2.9137e-08       -22.818024759015  <--
     6.1035e+04     6.1035e+05             7.2843e-09       -22.818024758871
     2.4414e+05     2.4414e+06             1.8211e-09       -22.818024758745

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 4.2177e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582622e-03 3 1  ON 7
ci_09                -1.125915e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629180e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680098e-03 3 1  ON 14
ci_16                 8.617800e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318599e-03 3 1  ON 17
ci_19                 8.994322e-03 3 1  ON 18
ci_20                 1.026297e-02 3 1  ON 19
ci_21                 8.533036e-03 3 1  ON 20
ci_22                 7.503622e-03 3 1  ON 21
ci_23                 5.761232e-03 3 1  ON 22
ci_24                 6.097792e-03 3 1  ON 23
ci_25                 4.931419e-03 3 1  ON 24
ci_26                 3.257832e-03 3 1  ON 25
ci_27                 2.890863e-03 3 1  ON 26
ci_28                 4.662853e-03 3 1  ON 27
ci_29                 3.579556e-03 3 1  ON 28
ci_30                -7.922772e-04 3 1  ON 29
ci_31                 2.373420e-04 3 1  ON 30
ci_32                 4.982941e-04 3 1  ON 31
ci_33                -3.527885e-04 3 1  ON 32
ci_34                 3.540880e-04 3 1  ON 33
ci_35                 2.194215e-03 3 1  ON 34
ci_36                -1.192572e-03 3 1  ON 35
ci_37                -7.574829e-04 3 1  ON 36
ci_38                -9.964183e-04 3 1  ON 37
ci_39                -3.894108e-04 3 1  ON 38
ci_40                -1.037052e-03 3 1  ON 39
ci_41                 9.200592e-04 3 1  ON 40
ci_42                 5.567978e-04 3 1  ON 41
ci_43                -1.727934e-03 3 1  ON 42
ci_44                -2.017887e-03 3 1  ON 43
ci_45                -3.019005e-04 3 1  ON 44
ci_46                -4.023926e-04 3 1  ON 45
ci_47                -5.146684e-04 3 1  ON 46
ci_48                -8.815674e-04 3 1  ON 47
ci_49                -1.271108e-03 3 1  ON 48
ci_50                -7.604181e-04 3 1  ON 49
ci_51                 3.559540e-05 3 1  ON 50
ci_52                -6.650565e-04 3 1  ON 51
ci_53                -1.486628e-03 3 1  ON 52
ci_54                -1.058731e-03 3 1  ON 53
ci_55                -1.447529e-03 3 1  ON 54
ci_56                 1.646269e-03 3 1  ON 55
ci_57                 1.476300e-03 3 1  ON 56
ci_58                -1.262865e-03 3 1  ON 57
ci_59                -1.217654e-03 3 1  ON 58
ci_60                 8.302439e-04 3 1  ON 59
ci_61                 2.301699e-03 3 1  ON 60
ci_62                -7.296454e-04 3 1  ON 61
ci_63                -8.375702e-04 3 1  ON 62
ci_64                -1.198721e-04 3 1  ON 63
ci_65                -1.808536e-04 3 1  ON 64
ci_66                -2.225832e-04 3 1  ON 65
ci_67                -1.077683e-03 3 1  ON 66
ci_68                -2.563250e-03 3 1  ON 67
ci_69                -1.691685e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.708
    reference variance = 0.404962
====================================================
  Execution time = 2.7157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8760e-01
  Total weights = 1.963555374e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471631286694
                                         uncertainty =       0.002389435501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471631286694
                                         uncertainty =       0.002389435501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485589802
  error estimate for blocks of size 2^( 2) =       0.000507219925
  error estimate for blocks of size 2^( 3) =       0.000527972254
  error estimate for blocks of size 2^( 4) =       0.000543831211
  error estimate for blocks of size 2^( 5) =       0.000555574372
  error estimate for blocks of size 2^( 6) =       0.000561295480
  error estimate for blocks of size 2^( 7) =       0.000564608762

      target function =                  N/A
              le_mean =     -22.818325196078
             les_mean =     521.163568801015
             stat err =       0.000556327456
             autocorr =       1.312568187195
              std dev =       0.686727683146
             le_variance =       0.471594910799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281832519608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818325196051       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818325198596       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818325198656       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818325198650       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 1.010927e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818325196051       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818325196687       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818325196702       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818325196701       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 2.527399e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818325196051       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818325196210       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818325196213       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818325196213       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 6.318550e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049550 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1680e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521506e-02 3 1  ON 3
ci_05                -2.312294e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484867e-02 3 1  ON 6
ci_08                -4.582614e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180335e-02 3 1  ON 9
ci_11                 1.629180e-02 3 1  ON 10
ci_12                 1.118450e-02 3 1  ON 11
ci_13                 1.205643e-02 3 1  ON 12
ci_14                 1.764282e-02 3 1  ON 13
ci_15                 8.680073e-03 3 1  ON 14
ci_16                 8.617780e-03 3 1  ON 15
ci_17                -1.052806e-02 3 1  ON 16
ci_18                -9.318610e-03 3 1  ON 17
ci_19                 8.994342e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533037e-03 3 1  ON 20
ci_22                 7.503633e-03 3 1  ON 21
ci_23                 5.761247e-03 3 1  ON 22
ci_24                 6.097806e-03 3 1  ON 23
ci_25                 4.931436e-03 3 1  ON 24
ci_26                 3.257820e-03 3 1  ON 25
ci_27                 2.890867e-03 3 1  ON 26
ci_28                 4.662839e-03 3 1  ON 27
ci_29                 3.579559e-03 3 1  ON 28
ci_30                -7.922706e-04 3 1  ON 29
ci_31                 2.373362e-04 3 1  ON 30
ci_32                 4.982713e-04 3 1  ON 31
ci_33                -3.527872e-04 3 1  ON 32
ci_34                 3.540865e-04 3 1  ON 33
ci_35                 2.194201e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574969e-04 3 1  ON 36
ci_38                -9.964230e-04 3 1  ON 37
ci_39                -3.894002e-04 3 1  ON 38
ci_40                -1.037064e-03 3 1  ON 39
ci_41                 9.200479e-04 3 1  ON 40
ci_42                 5.567985e-04 3 1  ON 41
ci_43                -1.727948e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.019098e-04 3 1  ON 44
ci_46                -4.023920e-04 3 1  ON 45
ci_47                -5.146757e-04 3 1  ON 46
ci_48                -8.815778e-04 3 1  ON 47
ci_49                -1.271108e-03 3 1  ON 48
ci_50                -7.604051e-04 3 1  ON 49
ci_51                 3.559837e-05 3 1  ON 50
ci_52                -6.650518e-04 3 1  ON 51
ci_53                -1.486614e-03 3 1  ON 52
ci_54                -1.058727e-03 3 1  ON 53
ci_55                -1.447521e-03 3 1  ON 54
ci_56                 1.646283e-03 3 1  ON 55
ci_57                 1.476300e-03 3 1  ON 56
ci_58                -1.262862e-03 3 1  ON 57
ci_59                -1.217667e-03 3 1  ON 58
ci_60                 8.302560e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296552e-04 3 1  ON 61
ci_63                -8.375629e-04 3 1  ON 62
ci_64                -1.198660e-04 3 1  ON 63
ci_65                -1.808621e-04 3 1  ON 64
ci_66                -2.225833e-04 3 1  ON 65
ci_67                -1.077671e-03 3 1  ON 66
ci_68                -2.563232e-03 3 1  ON 67
ci_69                -1.691674e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8413
    reference variance = 0.304522
====================================================
  Execution time = 2.4587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9369e-01
  Total weights = 1.9638e+06
  Execution time = 3.4996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563666060
                                         uncertainty =       0.002167233674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563666060
                                         uncertainty =       0.002167233674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485612248
  error estimate for blocks of size 2^( 2) =       0.000506584584
  error estimate for blocks of size 2^( 3) =       0.000526933224
  error estimate for blocks of size 2^( 4) =       0.000542250756
  error estimate for blocks of size 2^( 5) =       0.000551064548
  error estimate for blocks of size 2^( 6) =       0.000555805677
  error estimate for blocks of size 2^( 7) =       0.000558713016

      target function =                  N/A
              le_mean =     -22.819781870189
             les_mean =     521.236139088004
             stat err =       0.000551958499
             autocorr =       1.291913947340
              std dev =       0.686759426975
             le_variance =       0.471638510539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563656972
                                         uncertainty =       0.002167234069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563656972
                                         uncertainty =       0.002167234069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485612243
  error estimate for blocks of size 2^( 2) =       0.000506584578
  error estimate for blocks of size 2^( 3) =       0.000526933217
  error estimate for blocks of size 2^( 4) =       0.000542250748
  error estimate for blocks of size 2^( 5) =       0.000551064538
  error estimate for blocks of size 2^( 6) =       0.000555805669
  error estimate for blocks of size 2^( 7) =       0.000558713002

      target function =                  N/A
              le_mean =     -22.819781869757
             les_mean =     521.236139523991
             stat err =       0.000551958489
             autocorr =       1.291913925757
              std dev =       0.686759420115
             le_variance =       0.471638501117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563661515
                                         uncertainty =       0.002167233872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563661515
                                         uncertainty =       0.002167233872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485612245
  error estimate for blocks of size 2^( 2) =       0.000506584581
  error estimate for blocks of size 2^( 3) =       0.000526933220
  error estimate for blocks of size 2^( 4) =       0.000542250752
  error estimate for blocks of size 2^( 5) =       0.000551064543
  error estimate for blocks of size 2^( 6) =       0.000555805673
  error estimate for blocks of size 2^( 7) =       0.000558713009

      target function =                  N/A
              le_mean =     -22.819781869973
             les_mean =     521.236139305734
             stat err =       0.000551958494
             autocorr =       1.291913936544
              std dev =       0.686759423544
             le_variance =       0.471638505827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563665492
                                         uncertainty =       0.002167233699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471563665492
                                         uncertainty =       0.002167233699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485612248
  error estimate for blocks of size 2^( 2) =       0.000506584584
  error estimate for blocks of size 2^( 3) =       0.000526933224
  error estimate for blocks of size 2^( 4) =       0.000542250756
  error estimate for blocks of size 2^( 5) =       0.000551064547
  error estimate for blocks of size 2^( 6) =       0.000555805677
  error estimate for blocks of size 2^( 7) =       0.000558713015

      target function =                  N/A
              le_mean =     -22.819781870162
             les_mean =     521.236139115191
             stat err =       0.000551958499
             autocorr =       1.291913946001
              std dev =       0.686759426546
             le_variance =       0.471638509949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819781870189        initial  <--
     3.8147e+03     3.8147e+04             1.0109e-07       -22.819781869757
     1.5259e+04     1.5259e+05             2.5274e-08       -22.819781869973
     6.1035e+04     6.1035e+05             6.3185e-09       -22.819781870162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2316
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582622e-03 3 1  ON 7
ci_09                -1.125915e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629180e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680098e-03 3 1  ON 14
ci_16                 8.617800e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318599e-03 3 1  ON 17
ci_19                 8.994322e-03 3 1  ON 18
ci_20                 1.026297e-02 3 1  ON 19
ci_21                 8.533036e-03 3 1  ON 20
ci_22                 7.503622e-03 3 1  ON 21
ci_23                 5.761232e-03 3 1  ON 22
ci_24                 6.097792e-03 3 1  ON 23
ci_25                 4.931419e-03 3 1  ON 24
ci_26                 3.257832e-03 3 1  ON 25
ci_27                 2.890863e-03 3 1  ON 26
ci_28                 4.662853e-03 3 1  ON 27
ci_29                 3.579556e-03 3 1  ON 28
ci_30                -7.922772e-04 3 1  ON 29
ci_31                 2.373420e-04 3 1  ON 30
ci_32                 4.982941e-04 3 1  ON 31
ci_33                -3.527885e-04 3 1  ON 32
ci_34                 3.540880e-04 3 1  ON 33
ci_35                 2.194215e-03 3 1  ON 34
ci_36                -1.192572e-03 3 1  ON 35
ci_37                -7.574829e-04 3 1  ON 36
ci_38                -9.964183e-04 3 1  ON 37
ci_39                -3.894108e-04 3 1  ON 38
ci_40                -1.037052e-03 3 1  ON 39
ci_41                 9.200592e-04 3 1  ON 40
ci_42                 5.567978e-04 3 1  ON 41
ci_43                -1.727934e-03 3 1  ON 42
ci_44                -2.017887e-03 3 1  ON 43
ci_45                -3.019005e-04 3 1  ON 44
ci_46                -4.023926e-04 3 1  ON 45
ci_47                -5.146684e-04 3 1  ON 46
ci_48                -8.815674e-04 3 1  ON 47
ci_49                -1.271108e-03 3 1  ON 48
ci_50                -7.604181e-04 3 1  ON 49
ci_51                 3.559540e-05 3 1  ON 50
ci_52                -6.650565e-04 3 1  ON 51
ci_53                -1.486628e-03 3 1  ON 52
ci_54                -1.058731e-03 3 1  ON 53
ci_55                -1.447529e-03 3 1  ON 54
ci_56                 1.646269e-03 3 1  ON 55
ci_57                 1.476300e-03 3 1  ON 56
ci_58                -1.262865e-03 3 1  ON 57
ci_59                -1.217654e-03 3 1  ON 58
ci_60                 8.302439e-04 3 1  ON 59
ci_61                 2.301699e-03 3 1  ON 60
ci_62                -7.296454e-04 3 1  ON 61
ci_63                -8.375702e-04 3 1  ON 62
ci_64                -1.198721e-04 3 1  ON 63
ci_65                -1.808536e-04 3 1  ON 64
ci_66                -2.225832e-04 3 1  ON 65
ci_67                -1.077683e-03 3 1  ON 66
ci_68                -2.563250e-03 3 1  ON 67
ci_69                -1.691685e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7783
    reference variance = 0.359406
====================================================
  Execution time = 2.5336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8697e-01
  Total weights = 1.963680867e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472748956324
                                         uncertainty =       0.002717382214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472748956324
                                         uncertainty =       0.002717382214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486236455
  error estimate for blocks of size 2^( 2) =       0.000507632937
  error estimate for blocks of size 2^( 3) =       0.000528624202
  error estimate for blocks of size 2^( 4) =       0.000544959576
  error estimate for blocks of size 2^( 5) =       0.000555778477
  error estimate for blocks of size 2^( 6) =       0.000559477288
  error estimate for blocks of size 2^( 7) =       0.000562927093

      target function =                  N/A
              le_mean =     -22.818926525818
             les_mean =     521.190378757322
             stat err =       0.000555785609
             autocorr =       1.306530526610
              std dev =       0.687642189002
             le_variance =       0.472851780095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281892652582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818926525745       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818926526011       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818926526017       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818926526026       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 1.264542e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818926525745       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818926525812       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818926525813       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818926525813       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 3.161368e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818926525745       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818926525762       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818926525762       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818926525762       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 7.903428e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9850e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582622e-03 3 1  ON 7
ci_09                -1.125915e-02 3 1  ON 8
ci_10                -1.180337e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680097e-03 3 1  ON 14
ci_16                 8.617799e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318599e-03 3 1  ON 17
ci_19                 8.994325e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533034e-03 3 1  ON 20
ci_22                 7.503622e-03 3 1  ON 21
ci_23                 5.761234e-03 3 1  ON 22
ci_24                 6.097793e-03 3 1  ON 23
ci_25                 4.931421e-03 3 1  ON 24
ci_26                 3.257831e-03 3 1  ON 25
ci_27                 2.890860e-03 3 1  ON 26
ci_28                 4.662852e-03 3 1  ON 27
ci_29                 3.579556e-03 3 1  ON 28
ci_30                -7.922752e-04 3 1  ON 29
ci_31                 2.373430e-04 3 1  ON 30
ci_32                 4.982912e-04 3 1  ON 31
ci_33                -3.527889e-04 3 1  ON 32
ci_34                 3.540880e-04 3 1  ON 33
ci_35                 2.194214e-03 3 1  ON 34
ci_36                -1.192570e-03 3 1  ON 35
ci_37                -7.574826e-04 3 1  ON 36
ci_38                -9.964168e-04 3 1  ON 37
ci_39                -3.894099e-04 3 1  ON 38
ci_40                -1.037052e-03 3 1  ON 39
ci_41                 9.200572e-04 3 1  ON 40
ci_42                 5.567973e-04 3 1  ON 41
ci_43                -1.727934e-03 3 1  ON 42
ci_44                -2.017886e-03 3 1  ON 43
ci_45                -3.018999e-04 3 1  ON 44
ci_46                -4.023922e-04 3 1  ON 45
ci_47                -5.146662e-04 3 1  ON 46
ci_48                -8.815683e-04 3 1  ON 47
ci_49                -1.271107e-03 3 1  ON 48
ci_50                -7.604175e-04 3 1  ON 49
ci_51                 3.559637e-05 3 1  ON 50
ci_52                -6.650553e-04 3 1  ON 51
ci_53                -1.486627e-03 3 1  ON 52
ci_54                -1.058732e-03 3 1  ON 53
ci_55                -1.447527e-03 3 1  ON 54
ci_56                 1.646269e-03 3 1  ON 55
ci_57                 1.476302e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217656e-03 3 1  ON 58
ci_60                 8.302436e-04 3 1  ON 59
ci_61                 2.301698e-03 3 1  ON 60
ci_62                -7.296459e-04 3 1  ON 61
ci_63                -8.375694e-04 3 1  ON 62
ci_64                -1.198726e-04 3 1  ON 63
ci_65                -1.808551e-04 3 1  ON 64
ci_66                -2.225824e-04 3 1  ON 65
ci_67                -1.077682e-03 3 1  ON 66
ci_68                -2.563247e-03 3 1  ON 67
ci_69                -1.691683e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7738
    reference variance = 0.381612
====================================================
  Execution time = 2.4813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9047e-01
  Total weights = 1.9637e+06
  Execution time = 3.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948004239
                                         uncertainty =       0.002436028456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948004239
                                         uncertainty =       0.002436028456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487808273
  error estimate for blocks of size 2^( 2) =       0.000508477564
  error estimate for blocks of size 2^( 3) =       0.000528507158
  error estimate for blocks of size 2^( 4) =       0.000544025400
  error estimate for blocks of size 2^( 5) =       0.000552845222
  error estimate for blocks of size 2^( 6) =       0.000557868277
  error estimate for blocks of size 2^( 7) =       0.000563395269

      target function =                  N/A
              le_mean =     -22.818768961059
             les_mean =     521.186684659851
             stat err =       0.000554533542
             autocorr =       1.292282067592
              std dev =       0.689865075608
             le_variance =       0.475913822543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948002336
                                         uncertainty =       0.002436028322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948002336
                                         uncertainty =       0.002436028322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487808272
  error estimate for blocks of size 2^( 2) =       0.000508477563
  error estimate for blocks of size 2^( 3) =       0.000528507157
  error estimate for blocks of size 2^( 4) =       0.000544025399
  error estimate for blocks of size 2^( 5) =       0.000552845221
  error estimate for blocks of size 2^( 6) =       0.000557868277
  error estimate for blocks of size 2^( 7) =       0.000563395269

      target function =                  N/A
              le_mean =     -22.818768961083
             les_mean =     521.186684633601
             stat err =       0.000554533541
             autocorr =       1.292282069687
              std dev =       0.689865074235
             le_variance =       0.475913820649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948003288
                                         uncertainty =       0.002436028389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948003288
                                         uncertainty =       0.002436028389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487808273
  error estimate for blocks of size 2^( 2) =       0.000508477563
  error estimate for blocks of size 2^( 3) =       0.000528507157
  error estimate for blocks of size 2^( 4) =       0.000544025399
  error estimate for blocks of size 2^( 5) =       0.000552845222
  error estimate for blocks of size 2^( 6) =       0.000557868277
  error estimate for blocks of size 2^( 7) =       0.000563395269

      target function =                  N/A
              le_mean =     -22.818768961071
             les_mean =     521.186684646725
             stat err =       0.000554533542
             autocorr =       1.292282068630
              std dev =       0.689865074921
             le_variance =       0.475913821596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948004120
                                         uncertainty =       0.002436028448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475948004120
                                         uncertainty =       0.002436028448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487808273
  error estimate for blocks of size 2^( 2) =       0.000508477564
  error estimate for blocks of size 2^( 3) =       0.000528507158
  error estimate for blocks of size 2^( 4) =       0.000544025400
  error estimate for blocks of size 2^( 5) =       0.000552845222
  error estimate for blocks of size 2^( 6) =       0.000557868277
  error estimate for blocks of size 2^( 7) =       0.000563395269

      target function =                  N/A
              le_mean =     -22.818768961061
             les_mean =     521.186684658210
             stat err =       0.000554533542
             autocorr =       1.292282067724
              std dev =       0.689865075522
             le_variance =       0.475913822425


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818768961059        initial
     3.8147e+04     3.8147e+05             1.2645e-08       -22.818768961083  <--
     1.5259e+05     1.5259e+06             3.1614e-09       -22.818768961071
     6.1035e+05     6.1035e+06             7.9034e-10       -22.818768961061

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 4.2477e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922689e-04 3 1  ON 29
ci_31                 2.373457e-04 3 1  ON 30
ci_32                 4.982824e-04 3 1  ON 31
ci_33                -3.527901e-04 3 1  ON 32
ci_34                 3.540879e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574818e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894073e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200512e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018984e-04 3 1  ON 44
ci_46                -4.023911e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815710e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559927e-05 3 1  ON 50
ci_52                -6.650518e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058733e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302426e-04 3 1  ON 59
ci_61                 2.301696e-03 3 1  ON 60
ci_62                -7.296474e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198740e-04 3 1  ON 63
ci_65                -1.808595e-04 3 1  ON 64
ci_66                -2.225799e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2334e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8098
    reference variance = 0.393244
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5369e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8585e-01
  Total weights = 1.963748914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470626959846
                                         uncertainty =       0.002534165219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470626959846
                                         uncertainty =       0.002534165219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485055047
  error estimate for blocks of size 2^( 2) =       0.000506377515
  error estimate for blocks of size 2^( 3) =       0.000526709099
  error estimate for blocks of size 2^( 4) =       0.000541904028
  error estimate for blocks of size 2^( 5) =       0.000550691173
  error estimate for blocks of size 2^( 6) =       0.000556807739
  error estimate for blocks of size 2^( 7) =       0.000559130910

      target function =                  N/A
              le_mean =     -22.819154358097
             les_mean =     521.199660498970
             stat err =       0.000552133462
             autocorr =       1.295704844341
              std dev =       0.685971425322
             le_variance =       0.470556796359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281915435810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819154358048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819154358706       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819154358743       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819154358743       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 4.512646e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819154358048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819154358212       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819154358221       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819154358250       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 1.128187e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819154358048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819154358089       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819154358091       residual = 9.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819154358091       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 2.820484e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9869e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548908e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242897e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582621e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680092e-03 3 1  ON 14
ci_16                 8.617792e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318601e-03 3 1  ON 17
ci_19                 8.994334e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533021e-03 3 1  ON 20
ci_22                 7.503621e-03 3 1  ON 21
ci_23                 5.761239e-03 3 1  ON 22
ci_24                 6.097799e-03 3 1  ON 23
ci_25                 4.931424e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890859e-03 3 1  ON 26
ci_28                 4.662844e-03 3 1  ON 27
ci_29                 3.579566e-03 3 1  ON 28
ci_30                -7.922681e-04 3 1  ON 29
ci_31                 2.373520e-04 3 1  ON 30
ci_32                 4.982737e-04 3 1  ON 31
ci_33                -3.527885e-04 3 1  ON 32
ci_34                 3.540919e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192560e-03 3 1  ON 35
ci_37                -7.574796e-04 3 1  ON 36
ci_38                -9.964082e-04 3 1  ON 37
ci_39                -3.894071e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200464e-04 3 1  ON 40
ci_42                 5.567949e-04 3 1  ON 41
ci_43                -1.727933e-03 3 1  ON 42
ci_44                -2.017881e-03 3 1  ON 43
ci_45                -3.019007e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146575e-04 3 1  ON 46
ci_48                -8.815753e-04 3 1  ON 47
ci_49                -1.271103e-03 3 1  ON 48
ci_50                -7.604147e-04 3 1  ON 49
ci_51                 3.560237e-05 3 1  ON 50
ci_52                -6.650432e-04 3 1  ON 51
ci_53                -1.486618e-03 3 1  ON 52
ci_54                -1.058739e-03 3 1  ON 53
ci_55                -1.447519e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476321e-03 3 1  ON 56
ci_58                -1.262864e-03 3 1  ON 57
ci_59                -1.217662e-03 3 1  ON 58
ci_60                 8.302448e-04 3 1  ON 59
ci_61                 2.301695e-03 3 1  ON 60
ci_62                -7.296426e-04 3 1  ON 61
ci_63                -8.375644e-04 3 1  ON 62
ci_64                -1.198749e-04 3 1  ON 63
ci_65                -1.808676e-04 3 1  ON 64
ci_66                -2.225801e-04 3 1  ON 65
ci_67                -1.077672e-03 3 1  ON 66
ci_68                -2.563235e-03 3 1  ON 67
ci_69                -1.691675e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8662
    reference variance = 0.558293
====================================================
  Execution time = 2.4696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8619e-01
  Total weights = 1.9639e+06
  Execution time = 3.5060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884503295
                                         uncertainty =       0.003349865074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884503295
                                         uncertainty =       0.003349865074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485862571
  error estimate for blocks of size 2^( 2) =       0.000506336911
  error estimate for blocks of size 2^( 3) =       0.000527133136
  error estimate for blocks of size 2^( 4) =       0.000541666774
  error estimate for blocks of size 2^( 5) =       0.000550378196
  error estimate for blocks of size 2^( 6) =       0.000555854912
  error estimate for blocks of size 2^( 7) =       0.000558984654

      target function =                  N/A
              le_mean =     -22.819060903603
             les_mean =     521.195733351347
             stat err =       0.000551721134
             autocorr =       1.289473296307
              std dev =       0.687113437028
             le_variance =       0.472124875345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884481743
                                         uncertainty =       0.003349863589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884481743
                                         uncertainty =       0.003349863589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485862560
  error estimate for blocks of size 2^( 2) =       0.000506336900
  error estimate for blocks of size 2^( 3) =       0.000527133126
  error estimate for blocks of size 2^( 4) =       0.000541666765
  error estimate for blocks of size 2^( 5) =       0.000550378187
  error estimate for blocks of size 2^( 6) =       0.000555854904
  error estimate for blocks of size 2^( 7) =       0.000558984646

      target function =                  N/A
              le_mean =     -22.819060903011
             les_mean =     521.195733277799
             stat err =       0.000551721126
             autocorr =       1.289473315497
              std dev =       0.687113421456
             le_variance =       0.472124853945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884492519
                                         uncertainty =       0.003349864332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884492519
                                         uncertainty =       0.003349864332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485862565
  error estimate for blocks of size 2^( 2) =       0.000506336906
  error estimate for blocks of size 2^( 3) =       0.000527133131
  error estimate for blocks of size 2^( 4) =       0.000541666769
  error estimate for blocks of size 2^( 5) =       0.000550378192
  error estimate for blocks of size 2^( 6) =       0.000555854908
  error estimate for blocks of size 2^( 7) =       0.000558984650

      target function =                  N/A
              le_mean =     -22.819060903307
             les_mean =     521.195733314567
             stat err =       0.000551721130
             autocorr =       1.289473305903
              std dev =       0.687113429242
             le_variance =       0.472124864645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884501948
                                         uncertainty =       0.003349864982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471884501948
                                         uncertainty =       0.003349864982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485862570
  error estimate for blocks of size 2^( 2) =       0.000506336910
  error estimate for blocks of size 2^( 3) =       0.000527133135
  error estimate for blocks of size 2^( 4) =       0.000541666773
  error estimate for blocks of size 2^( 5) =       0.000550378195
  error estimate for blocks of size 2^( 6) =       0.000555854911
  error estimate for blocks of size 2^( 7) =       0.000558984654

      target function =                  N/A
              le_mean =     -22.819060903566
             les_mean =     521.195733346749
             stat err =       0.000551721133
             autocorr =       1.289473297496
              std dev =       0.687113436055
             le_variance =       0.472124874008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819060903603        initial  <--
     9.5367e+03     9.5367e+04             4.5126e-08       -22.819060903011
     3.8147e+04     3.8147e+05             1.1282e-08       -22.819060903307
     1.5259e+05     1.5259e+06             2.8205e-09       -22.819060903566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3371
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922689e-04 3 1  ON 29
ci_31                 2.373457e-04 3 1  ON 30
ci_32                 4.982824e-04 3 1  ON 31
ci_33                -3.527901e-04 3 1  ON 32
ci_34                 3.540879e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574818e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894073e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200512e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018984e-04 3 1  ON 44
ci_46                -4.023911e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815710e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559927e-05 3 1  ON 50
ci_52                -6.650518e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058733e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302426e-04 3 1  ON 59
ci_61                 2.301696e-03 3 1  ON 60
ci_62                -7.296474e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198740e-04 3 1  ON 63
ci_65                -1.808595e-04 3 1  ON 64
ci_66                -2.225799e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8641
    reference variance = 0.453552
====================================================
  Execution time = 2.5264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9004e-01
  Total weights = 1.963525944e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473080467447
                                         uncertainty =       0.002441528367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473080467447
                                         uncertainty =       0.002441528367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486308384
  error estimate for blocks of size 2^( 2) =       0.000508088819
  error estimate for blocks of size 2^( 3) =       0.000528414076
  error estimate for blocks of size 2^( 4) =       0.000543818628
  error estimate for blocks of size 2^( 5) =       0.000553861145
  error estimate for blocks of size 2^( 6) =       0.000560456646
  error estimate for blocks of size 2^( 7) =       0.000561719292

      target function =                  N/A
              le_mean =     -22.820041230823
             les_mean =     521.244322886268
             stat err =       0.000554963928
             autocorr =       1.302284876386
              std dev =       0.687743911850
             le_variance =       0.472991688287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282004123082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820041230766       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820041230815       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820041230816       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820041230851       residual = 1.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+04 is 6.189493e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820041230766       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820041230779       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820041230779       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820041230778       residual = 1.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 1.547376e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820041230766       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820041230770       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820041230770       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820041230769       residual = 1.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 3.868441e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9783e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318598e-03 3 1  ON 17
ci_19                 8.994333e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097795e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662847e-03 3 1  ON 27
ci_29                 3.579557e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373458e-04 3 1  ON 30
ci_32                 4.982817e-04 3 1  ON 31
ci_33                -3.527904e-04 3 1  ON 32
ci_34                 3.540874e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574820e-04 3 1  ON 36
ci_38                -9.964122e-04 3 1  ON 37
ci_39                -3.894075e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567956e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018991e-04 3 1  ON 44
ci_46                -4.023915e-04 3 1  ON 45
ci_47                -5.146590e-04 3 1  ON 46
ci_48                -8.815704e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604167e-04 3 1  ON 49
ci_51                 3.559922e-05 3 1  ON 50
ci_52                -6.650507e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058733e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476310e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302432e-04 3 1  ON 59
ci_61                 2.301695e-03 3 1  ON 60
ci_62                -7.296473e-04 3 1  ON 61
ci_63                -8.375675e-04 3 1  ON 62
ci_64                -1.198751e-04 3 1  ON 63
ci_65                -1.808593e-04 3 1  ON 64
ci_66                -2.225806e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691676e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7855
    reference variance = 0.465007
====================================================
  Execution time = 2.4627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.0229e-01
  Total weights = 1.9638e+06
  Execution time = 3.5052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976776
                                         uncertainty =       0.002469289582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976776
                                         uncertainty =       0.002469289582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487336434
  error estimate for blocks of size 2^( 2) =       0.000508996284
  error estimate for blocks of size 2^( 3) =       0.000529228202
  error estimate for blocks of size 2^( 4) =       0.000544898704
  error estimate for blocks of size 2^( 5) =       0.000553968407
  error estimate for blocks of size 2^( 6) =       0.000558200507
  error estimate for blocks of size 2^( 7) =       0.000561902386

      target function =                  N/A
              le_mean =     -22.819398582653
             les_mean =     521.227240897619
             stat err =       0.000554742501
             autocorr =       1.295761638600
              std dev =       0.689197794330
             le_variance =       0.474993599709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976296
                                         uncertainty =       0.002469289691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976296
                                         uncertainty =       0.002469289691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487336434
  error estimate for blocks of size 2^( 2) =       0.000508996284
  error estimate for blocks of size 2^( 3) =       0.000529228202
  error estimate for blocks of size 2^( 4) =       0.000544898704
  error estimate for blocks of size 2^( 5) =       0.000553968407
  error estimate for blocks of size 2^( 6) =       0.000558200507
  error estimate for blocks of size 2^( 7) =       0.000561902385

      target function =                  N/A
              le_mean =     -22.819398582630
             les_mean =     521.227240710458
             stat err =       0.000554742501
             autocorr =       1.295761638068
              std dev =       0.689197793980
             le_variance =       0.474993599227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976536
                                         uncertainty =       0.002469289636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976536
                                         uncertainty =       0.002469289636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487336434
  error estimate for blocks of size 2^( 2) =       0.000508996284
  error estimate for blocks of size 2^( 3) =       0.000529228202
  error estimate for blocks of size 2^( 4) =       0.000544898704
  error estimate for blocks of size 2^( 5) =       0.000553968407
  error estimate for blocks of size 2^( 6) =       0.000558200507
  error estimate for blocks of size 2^( 7) =       0.000561902386

      target function =                  N/A
              le_mean =     -22.819398582641
             les_mean =     521.227240804037
             stat err =       0.000554742501
             autocorr =       1.295761638340
              std dev =       0.689197794155
             le_variance =       0.474993599468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976746
                                         uncertainty =       0.002469289589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474991976746
                                         uncertainty =       0.002469289589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487336434
  error estimate for blocks of size 2^( 2) =       0.000508996284
  error estimate for blocks of size 2^( 3) =       0.000529228202
  error estimate for blocks of size 2^( 4) =       0.000544898704
  error estimate for blocks of size 2^( 5) =       0.000553968407
  error estimate for blocks of size 2^( 6) =       0.000558200507
  error estimate for blocks of size 2^( 7) =       0.000561902386

      target function =                  N/A
              le_mean =     -22.819398582651
             les_mean =     521.227240885920
             stat err =       0.000554742501
             autocorr =       1.295761638572
              std dev =       0.689197794308
             le_variance =       0.474993599679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819398582653        initial  <--
     9.5367e+04     9.5367e+05             6.1895e-09       -22.819398582630
     3.8147e+05     3.8147e+06             1.5474e-09       -22.819398582641
     1.5259e+06     1.5259e+07             3.8684e-10       -22.819398582651

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2511
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922689e-04 3 1  ON 29
ci_31                 2.373457e-04 3 1  ON 30
ci_32                 4.982824e-04 3 1  ON 31
ci_33                -3.527901e-04 3 1  ON 32
ci_34                 3.540879e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574818e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894073e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200512e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018984e-04 3 1  ON 44
ci_46                -4.023911e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815710e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559927e-05 3 1  ON 50
ci_52                -6.650518e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058733e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302426e-04 3 1  ON 59
ci_61                 2.301696e-03 3 1  ON 60
ci_62                -7.296474e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198740e-04 3 1  ON 63
ci_65                -1.808595e-04 3 1  ON 64
ci_66                -2.225799e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2041e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8204
    reference variance = 0.340982
====================================================
  Execution time = 2.7213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8848e-01
  Total weights = 1.963807641e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474375133519
                                         uncertainty =       0.002548790264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474375133519
                                         uncertainty =       0.002548790264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487048947
  error estimate for blocks of size 2^( 2) =       0.000508310424
  error estimate for blocks of size 2^( 3) =       0.000528382655
  error estimate for blocks of size 2^( 4) =       0.000543373074
  error estimate for blocks of size 2^( 5) =       0.000553427399
  error estimate for blocks of size 2^( 6) =       0.000558282661
  error estimate for blocks of size 2^( 7) =       0.000561397127

      target function =                  N/A
              le_mean =     -22.818067219686
             les_mean =     521.152674433092
             stat err =       0.000554120065
             autocorr =       1.294382213352
              std dev =       0.688791225776
             le_variance =       0.474433352706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281806721969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818067219616       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818067219625       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818067219624       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818067219624       residual = 4.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 4.028365e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818067219616       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818067219618       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818067219618       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818067219618       residual = 4.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 1.007092e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818067219616       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818067219616       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818067219616       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818067216400       residual = 4.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 2.517726e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1795e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922689e-04 3 1  ON 29
ci_31                 2.373457e-04 3 1  ON 30
ci_32                 4.982823e-04 3 1  ON 31
ci_33                -3.527901e-04 3 1  ON 32
ci_34                 3.540879e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574818e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894073e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200511e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018983e-04 3 1  ON 44
ci_46                -4.023910e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815710e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559922e-05 3 1  ON 50
ci_52                -6.650517e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058733e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302427e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296473e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198740e-04 3 1  ON 63
ci_65                -1.808595e-04 3 1  ON 64
ci_66                -2.225798e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.9067
    reference variance = 0.411445
====================================================
  Execution time = 2.4720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8811e-01
  Total weights = 1.9636e+06
  Execution time = 3.5081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683407
                                         uncertainty =       0.002556043947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683407
                                         uncertainty =       0.002556043947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486135856
  error estimate for blocks of size 2^( 2) =       0.000507503127
  error estimate for blocks of size 2^( 3) =       0.000527591411
  error estimate for blocks of size 2^( 4) =       0.000543837255
  error estimate for blocks of size 2^( 5) =       0.000553443603
  error estimate for blocks of size 2^( 6) =       0.000560907958
  error estimate for blocks of size 2^( 7) =       0.000565706977

      target function =                  N/A
              le_mean =     -22.818870676270
             les_mean =     521.188964638834
             stat err =       0.000555973948
             autocorr =       1.307957326685
              std dev =       0.687499920478
             le_variance =       0.472656140657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683312
                                         uncertainty =       0.002556043929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683312
                                         uncertainty =       0.002556043929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486135856
  error estimate for blocks of size 2^( 2) =       0.000507503127
  error estimate for blocks of size 2^( 3) =       0.000527591411
  error estimate for blocks of size 2^( 4) =       0.000543837255
  error estimate for blocks of size 2^( 5) =       0.000553443603
  error estimate for blocks of size 2^( 6) =       0.000560907958
  error estimate for blocks of size 2^( 7) =       0.000565706977

      target function =                  N/A
              le_mean =     -22.818870676270
             les_mean =     521.188964639277
             stat err =       0.000555973948
             autocorr =       1.307957326690
              std dev =       0.687499920410
             le_variance =       0.472656140563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683360
                                         uncertainty =       0.002556043938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683360
                                         uncertainty =       0.002556043938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486135856
  error estimate for blocks of size 2^( 2) =       0.000507503127
  error estimate for blocks of size 2^( 3) =       0.000527591411
  error estimate for blocks of size 2^( 4) =       0.000543837255
  error estimate for blocks of size 2^( 5) =       0.000553443603
  error estimate for blocks of size 2^( 6) =       0.000560907958
  error estimate for blocks of size 2^( 7) =       0.000565706977

      target function =                  N/A
              le_mean =     -22.818870676270
             les_mean =     521.188964639055
             stat err =       0.000555973948
             autocorr =       1.307957326699
              std dev =       0.687499920444
             le_variance =       0.472656140610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683401
                                         uncertainty =       0.002556043946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472669683401
                                         uncertainty =       0.002556043946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486135856
  error estimate for blocks of size 2^( 2) =       0.000507503127
  error estimate for blocks of size 2^( 3) =       0.000527591411
  error estimate for blocks of size 2^( 4) =       0.000543837255
  error estimate for blocks of size 2^( 5) =       0.000553443603
  error estimate for blocks of size 2^( 6) =       0.000560907958
  error estimate for blocks of size 2^( 7) =       0.000565706977

      target function =                  N/A
              le_mean =     -22.818870676270
             les_mean =     521.188964638861
             stat err =       0.000555973948
             autocorr =       1.307957326688
              std dev =       0.687499920474
             le_variance =       0.472656140651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818870676270        initial
     9.5367e+05     9.5367e+06             4.0284e-10       -22.818870676270  <--
     3.8147e+06     3.8147e+07             1.0071e-10       -22.818870676270
     1.5259e+07     1.5259e+08             2.5177e-11       -22.818870676270

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 4.2390e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8353
    reference variance = 0.435911
====================================================
  Execution time = 2.5410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8448e-01
  Total weights = 1.963634244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468852764921
                                         uncertainty =       0.002016173129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468852764921
                                         uncertainty =       0.002016173129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484184387
  error estimate for blocks of size 2^( 2) =       0.000505945024
  error estimate for blocks of size 2^( 3) =       0.000526190607
  error estimate for blocks of size 2^( 4) =       0.000541251451
  error estimate for blocks of size 2^( 5) =       0.000551852597
  error estimate for blocks of size 2^( 6) =       0.000557931046
  error estimate for blocks of size 2^( 7) =       0.000562069446

      target function =                  N/A
              le_mean =     -22.819159465288
             les_mean =     521.198515713342
             stat err =       0.000553276135
             autocorr =       1.305756850421
              std dev =       0.684740127297
             le_variance =       0.468869041931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281915946529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819159465259       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819159465287       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819159465287       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819159465287       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 1.910837e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819159465259       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819159465266       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819159465266       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819159465266       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 4.777098e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819159465259       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819159465261       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819159465261       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819159464157       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 1.194274e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9939e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318598e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931428e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922688e-04 3 1  ON 29
ci_31                 2.373457e-04 3 1  ON 30
ci_32                 4.982818e-04 3 1  ON 31
ci_33                -3.527899e-04 3 1  ON 32
ci_34                 3.540883e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192566e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964121e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200506e-04 3 1  ON 40
ci_42                 5.567959e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018981e-04 3 1  ON 44
ci_46                -4.023910e-04 3 1  ON 45
ci_47                -5.146596e-04 3 1  ON 46
ci_48                -8.815710e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604158e-04 3 1  ON 49
ci_51                 3.559903e-05 3 1  ON 50
ci_52                -6.650513e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058733e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476310e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302430e-04 3 1  ON 59
ci_61                 2.301696e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375669e-04 3 1  ON 62
ci_64                -1.198740e-04 3 1  ON 63
ci_65                -1.808598e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.9123
    reference variance = 0.323038
====================================================
  Execution time = 2.4604e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8568e-01
  Total weights = 1.9638e+06
  Execution time = 3.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234371
                                         uncertainty =       0.002760404892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234371
                                         uncertainty =       0.002760404892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485544432
  error estimate for blocks of size 2^( 2) =       0.000506881325
  error estimate for blocks of size 2^( 3) =       0.000527027286
  error estimate for blocks of size 2^( 4) =       0.000542978456
  error estimate for blocks of size 2^( 5) =       0.000552778483
  error estimate for blocks of size 2^( 6) =       0.000559063435
  error estimate for blocks of size 2^( 7) =       0.000563480114

      target function =                  N/A
              le_mean =     -22.818892292166
             les_mean =     521.187525868989
             stat err =       0.000554575122
             autocorr =       1.304556253190
              std dev =       0.686663520777
             le_variance =       0.471506790765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234146
                                         uncertainty =       0.002760404965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234146
                                         uncertainty =       0.002760404965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485544432
  error estimate for blocks of size 2^( 2) =       0.000506881325
  error estimate for blocks of size 2^( 3) =       0.000527027286
  error estimate for blocks of size 2^( 4) =       0.000542978456
  error estimate for blocks of size 2^( 5) =       0.000552778483
  error estimate for blocks of size 2^( 6) =       0.000559063435
  error estimate for blocks of size 2^( 7) =       0.000563480114

      target function =                  N/A
              le_mean =     -22.818892292153
             les_mean =     521.187525866738
             stat err =       0.000554575122
             autocorr =       1.304556253535
              std dev =       0.686663520614
             le_variance =       0.471506790541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234259
                                         uncertainty =       0.002760404928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234259
                                         uncertainty =       0.002760404928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485544432
  error estimate for blocks of size 2^( 2) =       0.000506881325
  error estimate for blocks of size 2^( 3) =       0.000527027286
  error estimate for blocks of size 2^( 4) =       0.000542978456
  error estimate for blocks of size 2^( 5) =       0.000552778483
  error estimate for blocks of size 2^( 6) =       0.000559063435
  error estimate for blocks of size 2^( 7) =       0.000563480114

      target function =                  N/A
              le_mean =     -22.818892292160
             les_mean =     521.187525867863
             stat err =       0.000554575122
             autocorr =       1.304556253351
              std dev =       0.686663520695
             le_variance =       0.471506790653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234357
                                         uncertainty =       0.002760404896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471464234357
                                         uncertainty =       0.002760404896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485544432
  error estimate for blocks of size 2^( 2) =       0.000506881325
  error estimate for blocks of size 2^( 3) =       0.000527027286
  error estimate for blocks of size 2^( 4) =       0.000542978456
  error estimate for blocks of size 2^( 5) =       0.000552778483
  error estimate for blocks of size 2^( 6) =       0.000559063435
  error estimate for blocks of size 2^( 7) =       0.000563480114

      target function =                  N/A
              le_mean =     -22.818892292165
             les_mean =     521.187525868848
             stat err =       0.000554575122
             autocorr =       1.304556253205
              std dev =       0.686663520766
             le_variance =       0.471506790751


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818892292166        initial  <--
     2.3842e+05     2.3842e+06             1.9108e-09       -22.818892292153
     9.5367e+05     9.5367e+06             4.7771e-10       -22.818892292160
     3.8147e+06     3.8147e+07             1.1943e-10       -22.818892292165

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1955
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8235
    reference variance = 0.314625
====================================================
  Execution time = 2.5420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8544e-01
  Total weights = 1.963671992e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468247702308
                                         uncertainty =       0.002246217644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468247702308
                                         uncertainty =       0.002246217644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483882705
  error estimate for blocks of size 2^( 2) =       0.000505680601
  error estimate for blocks of size 2^( 3) =       0.000526222032
  error estimate for blocks of size 2^( 4) =       0.000541447793
  error estimate for blocks of size 2^( 5) =       0.000550856442
  error estimate for blocks of size 2^( 6) =       0.000554568764
  error estimate for blocks of size 2^( 7) =       0.000558958106

      target function =                  N/A
              le_mean =     -22.819504924299
             les_mean =     521.215241744629
             stat err =       0.000551457776
             autocorr =       1.298806136060
              std dev =       0.684313483341
             le_variance =       0.468284943483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281950492430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819504924248       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819504924253       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819504924253       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819504924679       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 2.041188e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819504924248       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819504924249       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819504924249       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819504924249       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 5.102969e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819504924248       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819504924249       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819504924249       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819504952468       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+07 is 1.275743e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9966e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192566e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146596e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559906e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375670e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808597e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8001
    reference variance = 0.514276
====================================================
  Execution time = 2.4759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9206e-01
  Total weights = 1.9635e+06
  Execution time = 3.5232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625629
                                         uncertainty =       0.003837000525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625629
                                         uncertainty =       0.003837000525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486059057
  error estimate for blocks of size 2^( 2) =       0.000507896028
  error estimate for blocks of size 2^( 3) =       0.000527962151
  error estimate for blocks of size 2^( 4) =       0.000543049642
  error estimate for blocks of size 2^( 5) =       0.000552914140
  error estimate for blocks of size 2^( 6) =       0.000557440912
  error estimate for blocks of size 2^( 7) =       0.000559256683

      target function =                  N/A
              le_mean =     -22.819449382169
             les_mean =     521.219332544760
             stat err =       0.000553165344
             autocorr =       1.295185122502
              std dev =       0.687391310757
             le_variance =       0.472506814104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625565
                                         uncertainty =       0.003837000505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625565
                                         uncertainty =       0.003837000505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486059057
  error estimate for blocks of size 2^( 2) =       0.000507896028
  error estimate for blocks of size 2^( 3) =       0.000527962151
  error estimate for blocks of size 2^( 4) =       0.000543049642
  error estimate for blocks of size 2^( 5) =       0.000552914140
  error estimate for blocks of size 2^( 6) =       0.000557440912
  error estimate for blocks of size 2^( 7) =       0.000559256683

      target function =                  N/A
              le_mean =     -22.819449382168
             les_mean =     521.219332545009
             stat err =       0.000553165344
             autocorr =       1.295185122535
              std dev =       0.687391310711
             le_variance =       0.472506814040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625597
                                         uncertainty =       0.003837000515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625597
                                         uncertainty =       0.003837000515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486059057
  error estimate for blocks of size 2^( 2) =       0.000507896028
  error estimate for blocks of size 2^( 3) =       0.000527962151
  error estimate for blocks of size 2^( 4) =       0.000543049642
  error estimate for blocks of size 2^( 5) =       0.000552914140
  error estimate for blocks of size 2^( 6) =       0.000557440912
  error estimate for blocks of size 2^( 7) =       0.000559256683

      target function =                  N/A
              le_mean =     -22.819449382168
             les_mean =     521.219332544885
             stat err =       0.000553165344
             autocorr =       1.295185122514
              std dev =       0.687391310734
             le_variance =       0.472506814072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625625
                                         uncertainty =       0.003837000523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472481625625
                                         uncertainty =       0.003837000523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486059057
  error estimate for blocks of size 2^( 2) =       0.000507896028
  error estimate for blocks of size 2^( 3) =       0.000527962151
  error estimate for blocks of size 2^( 4) =       0.000543049642
  error estimate for blocks of size 2^( 5) =       0.000552914140
  error estimate for blocks of size 2^( 6) =       0.000557440912
  error estimate for blocks of size 2^( 7) =       0.000559256683

      target function =                  N/A
              le_mean =     -22.819449382169
             les_mean =     521.219332544776
             stat err =       0.000553165344
             autocorr =       1.295185122496
              std dev =       0.687391310754
             le_variance =       0.472506814100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819449382169        initial  <--
     2.3842e+06     2.3842e+07             2.0412e-10       -22.819449382168
     9.5367e+06     9.5367e+07             5.1030e-11       -22.819449382168
     3.8147e+07     3.8147e+08             1.2757e-11       -22.819449382169

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4579
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7463
    reference variance = 0.512756
====================================================
  Execution time = 2.5241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8652e-01
  Total weights = 1.963787020e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470332658854
                                         uncertainty =       0.002421972762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470332658854
                                         uncertainty =       0.002421972762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484893527
  error estimate for blocks of size 2^( 2) =       0.000506360513
  error estimate for blocks of size 2^( 3) =       0.000526458391
  error estimate for blocks of size 2^( 4) =       0.000541488308
  error estimate for blocks of size 2^( 5) =       0.000551967026
  error estimate for blocks of size 2^( 6) =       0.000557455853
  error estimate for blocks of size 2^( 7) =       0.000561261742

      target function =                  N/A
              le_mean =     -22.818913247254
             les_mean =     521.189319664215
             stat err =       0.000553043232
             autocorr =       1.300844516335
              std dev =       0.685743002515
             le_variance =       0.470243465498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281891324725e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818913247203       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818913247204       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818913247204       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818913247204       residual = 7.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 1.858551e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818913247203       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818913247204       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818913247204       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818913296421       residual = 7.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+07 is 4.646380e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818913247203       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818913247204       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818913247204       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818913416471       residual = 7.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+08 is 1.161611e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9738e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8901
    reference variance = 0.462781
====================================================
  Execution time = 2.4797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8746e-01
  Total weights = 1.9637e+06
  Execution time = 3.5085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221165
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221165
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485994368
  error estimate for blocks of size 2^( 2) =       0.000507258427
  error estimate for blocks of size 2^( 3) =       0.000528072789
  error estimate for blocks of size 2^( 4) =       0.000543505336
  error estimate for blocks of size 2^( 5) =       0.000553251575
  error estimate for blocks of size 2^( 6) =       0.000559343803
  error estimate for blocks of size 2^( 7) =       0.000561944409

      target function =                  N/A
              le_mean =     -22.819548290321
             les_mean =     521.219246062394
             stat err =       0.000554511281
             autocorr =       1.301842062490
              std dev =       0.687299825888
             le_variance =       0.472381050665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221159
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221159
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485994368
  error estimate for blocks of size 2^( 2) =       0.000507258427
  error estimate for blocks of size 2^( 3) =       0.000528072789
  error estimate for blocks of size 2^( 4) =       0.000543505336
  error estimate for blocks of size 2^( 5) =       0.000553251575
  error estimate for blocks of size 2^( 6) =       0.000559343803
  error estimate for blocks of size 2^( 7) =       0.000561944409

      target function =                  N/A
              le_mean =     -22.819548290321
             les_mean =     521.219246062386
             stat err =       0.000554511281
             autocorr =       1.301842062477
              std dev =       0.687299825884
             le_variance =       0.472381050660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221162
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221162
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485994368
  error estimate for blocks of size 2^( 2) =       0.000507258427
  error estimate for blocks of size 2^( 3) =       0.000528072789
  error estimate for blocks of size 2^( 4) =       0.000543505336
  error estimate for blocks of size 2^( 5) =       0.000553251575
  error estimate for blocks of size 2^( 6) =       0.000559343803
  error estimate for blocks of size 2^( 7) =       0.000561944409

      target function =                  N/A
              le_mean =     -22.819548290321
             les_mean =     521.219246062390
             stat err =       0.000554511281
             autocorr =       1.301842062481
              std dev =       0.687299825886
             le_variance =       0.472381050663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221165
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472364221165
                                         uncertainty =       0.002175871209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485994368
  error estimate for blocks of size 2^( 2) =       0.000507258427
  error estimate for blocks of size 2^( 3) =       0.000528072789
  error estimate for blocks of size 2^( 4) =       0.000543505336
  error estimate for blocks of size 2^( 5) =       0.000553251575
  error estimate for blocks of size 2^( 6) =       0.000559343803
  error estimate for blocks of size 2^( 7) =       0.000561944409

      target function =                  N/A
              le_mean =     -22.819548290321
             les_mean =     521.219246062393
             stat err =       0.000554511281
             autocorr =       1.301842062484
              std dev =       0.687299825888
             le_variance =       0.472381050665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819548290321        initial  <--
     2.3842e+07     2.3842e+08             1.8586e-11       -22.819548290321
     9.5367e+07     9.5367e+08             4.6464e-12       -22.819548290321
     3.8147e+08     3.8147e+09             1.1616e-12       -22.819548290321

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4431
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2187e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.9905
    reference variance = 0.406125
====================================================
  Execution time = 2.5345e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7874e-01
  Total weights = 1.963438003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465976667023
                                         uncertainty =       0.002151637238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465976667023
                                         uncertainty =       0.002151637238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482770821
  error estimate for blocks of size 2^( 2) =       0.000504168130
  error estimate for blocks of size 2^( 3) =       0.000524517416
  error estimate for blocks of size 2^( 4) =       0.000540262972
  error estimate for blocks of size 2^( 5) =       0.000549164055
  error estimate for blocks of size 2^( 6) =       0.000555683035
  error estimate for blocks of size 2^( 7) =       0.000558387521

      target function =                  N/A
              le_mean =     -22.819142946784
             les_mean =     521.192024406072
             stat err =       0.000550874396
             autocorr =       1.302036463567
              std dev =       0.682741043200
             le_variance =       0.466135332069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281914294678e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819142946699       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819142946699       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819142946699       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819142946699       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 2.400487e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819142946699       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819142946699       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819142946699       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819142947996       residual = 1.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+08 is 6.001454e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819142946699       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819142946699       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819142946699       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819142946699       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+09 is 1.500550e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9855e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7761
    reference variance = 0.504736
====================================================
  Execution time = 2.6666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9256e-01
  Total weights = 1.9635e+06
  Execution time = 3.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488125488
  error estimate for blocks of size 2^( 2) =       0.000509387790
  error estimate for blocks of size 2^( 3) =       0.000530041639
  error estimate for blocks of size 2^( 4) =       0.000545654446
  error estimate for blocks of size 2^( 5) =       0.000555832036
  error estimate for blocks of size 2^( 6) =       0.000562347472
  error estimate for blocks of size 2^( 7) =       0.000568754443

      target function =                  N/A
              le_mean =     -22.820168177686
             les_mean =     521.252637584907
             stat err =       0.000558147099
             autocorr =       1.307477951215
              std dev =       0.690313684788
             le_variance =       0.476532983406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488125488
  error estimate for blocks of size 2^( 2) =       0.000509387790
  error estimate for blocks of size 2^( 3) =       0.000530041639
  error estimate for blocks of size 2^( 4) =       0.000545654446
  error estimate for blocks of size 2^( 5) =       0.000555832036
  error estimate for blocks of size 2^( 6) =       0.000562347472
  error estimate for blocks of size 2^( 7) =       0.000568754443

      target function =                  N/A
              le_mean =     -22.820168177686
             les_mean =     521.252637584903
             stat err =       0.000558147099
             autocorr =       1.307477951220
              std dev =       0.690313684788
             le_variance =       0.476532983405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488125488
  error estimate for blocks of size 2^( 2) =       0.000509387790
  error estimate for blocks of size 2^( 3) =       0.000530041639
  error estimate for blocks of size 2^( 4) =       0.000545654446
  error estimate for blocks of size 2^( 5) =       0.000555832036
  error estimate for blocks of size 2^( 6) =       0.000562347472
  error estimate for blocks of size 2^( 7) =       0.000568754443

      target function =                  N/A
              le_mean =     -22.820168177686
             les_mean =     521.252637584905
             stat err =       0.000558147099
             autocorr =       1.307477951214
              std dev =       0.690313684788
             le_variance =       0.476532983405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476523466919
                                         uncertainty =       0.002434166933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488125488
  error estimate for blocks of size 2^( 2) =       0.000509387790
  error estimate for blocks of size 2^( 3) =       0.000530041639
  error estimate for blocks of size 2^( 4) =       0.000545654446
  error estimate for blocks of size 2^( 5) =       0.000555832036
  error estimate for blocks of size 2^( 6) =       0.000562347472
  error estimate for blocks of size 2^( 7) =       0.000568754443

      target function =                  N/A
              le_mean =     -22.820168177686
             les_mean =     521.252637584907
             stat err =       0.000558147099
             autocorr =       1.307477951215
              std dev =       0.690313684788
             le_variance =       0.476532983406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820168177686        initial  <--
     2.3842e+08     2.3842e+09             2.4005e-12       -22.820168177686
     9.5367e+08     9.5367e+09             6.0015e-13       -22.820168177686
     3.8147e+09     3.8147e+10             1.5005e-13       -22.820168177686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2558
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8539
    reference variance = 0.422893
====================================================
  Execution time = 2.5486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8634e-01
  Total weights = 1.963650184e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472293986129
                                         uncertainty =       0.002720557427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472293986129
                                         uncertainty =       0.002720557427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485899206
  error estimate for blocks of size 2^( 2) =       0.000507371257
  error estimate for blocks of size 2^( 3) =       0.000527182324
  error estimate for blocks of size 2^( 4) =       0.000543052067
  error estimate for blocks of size 2^( 5) =       0.000552729312
  error estimate for blocks of size 2^( 6) =       0.000557947061
  error estimate for blocks of size 2^( 7) =       0.000562491199

      target function =                  N/A
              le_mean =     -22.819241338267
             les_mean =     521.204114157061
             stat err =       0.000554054910
             autocorr =       1.300209206334
              std dev =       0.687165246804
             le_variance =       0.472196076415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281924133827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819241338172       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819241338172       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819241338172       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819242195684       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+09 is 3.537829e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819241338172       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819241338172       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819241338172       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819241311007       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+09 is 8.846088e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819241338172       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819241338172       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819241338172       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819239833979       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+10 is 2.212591e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9985e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7634
    reference variance = 0.401858
====================================================
  Execution time = 2.4809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8771e-01
  Total weights = 1.9638e+06
  Execution time = 3.5102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486032390
  error estimate for blocks of size 2^( 2) =       0.000507070015
  error estimate for blocks of size 2^( 3) =       0.000527358365
  error estimate for blocks of size 2^( 4) =       0.000543378976
  error estimate for blocks of size 2^( 5) =       0.000553422600
  error estimate for blocks of size 2^( 6) =       0.000559695690
  error estimate for blocks of size 2^( 7) =       0.000564136972

      target function =                  N/A
              le_mean =     -22.819207316796
             les_mean =     521.203927917465
             stat err =       0.000555158559
             autocorr =       1.304678949097
              std dev =       0.687353598102
             le_variance =       0.472454968824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486032390
  error estimate for blocks of size 2^( 2) =       0.000507070015
  error estimate for blocks of size 2^( 3) =       0.000527358365
  error estimate for blocks of size 2^( 4) =       0.000543378976
  error estimate for blocks of size 2^( 5) =       0.000553422600
  error estimate for blocks of size 2^( 6) =       0.000559695690
  error estimate for blocks of size 2^( 7) =       0.000564136972

      target function =                  N/A
              le_mean =     -22.819207316796
             les_mean =     521.203927917468
             stat err =       0.000555158559
             autocorr =       1.304678949095
              std dev =       0.687353598102
             le_variance =       0.472454968824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486032390
  error estimate for blocks of size 2^( 2) =       0.000507070015
  error estimate for blocks of size 2^( 3) =       0.000527358365
  error estimate for blocks of size 2^( 4) =       0.000543378976
  error estimate for blocks of size 2^( 5) =       0.000553422600
  error estimate for blocks of size 2^( 6) =       0.000559695690
  error estimate for blocks of size 2^( 7) =       0.000564136972

      target function =                  N/A
              le_mean =     -22.819207316796
             les_mean =     521.203927917466
             stat err =       0.000555158559
             autocorr =       1.304678949096
              std dev =       0.687353598102
             le_variance =       0.472454968824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472420477062
                                         uncertainty =       0.002206020599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486032390
  error estimate for blocks of size 2^( 2) =       0.000507070015
  error estimate for blocks of size 2^( 3) =       0.000527358365
  error estimate for blocks of size 2^( 4) =       0.000543378976
  error estimate for blocks of size 2^( 5) =       0.000553422600
  error estimate for blocks of size 2^( 6) =       0.000559695690
  error estimate for blocks of size 2^( 7) =       0.000564136972

      target function =                  N/A
              le_mean =     -22.819207316796
             les_mean =     521.203927917465
             stat err =       0.000555158559
             autocorr =       1.304678949097
              std dev =       0.687353598102
             le_variance =       0.472454968824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819207316796        initial  <--
     2.3842e+09     2.3842e+10             3.5378e-13       -22.819207316796
     9.5367e+09     9.5367e+10             8.8461e-14       -22.819207316796
     3.8147e+10     3.8147e+11             2.2126e-14       -22.819207316796

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4547
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8023
    reference variance = 0.605346
====================================================
  Execution time = 2.5376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8722e-01
  Total weights = 1.963507382e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472281714839
                                         uncertainty =       0.002300532096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472281714839
                                         uncertainty =       0.002300532096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485921041
  error estimate for blocks of size 2^( 2) =       0.000507526734
  error estimate for blocks of size 2^( 3) =       0.000528470990
  error estimate for blocks of size 2^( 4) =       0.000542986025
  error estimate for blocks of size 2^( 5) =       0.000552898941
  error estimate for blocks of size 2^( 6) =       0.000556854771
  error estimate for blocks of size 2^( 7) =       0.000559346911

      target function =                  N/A
              le_mean =     -22.818862711803
             les_mean =     521.187717909058
             stat err =       0.000553021662
             autocorr =       1.295247837142
              std dev =       0.687196126880
             le_variance =       0.472238516799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281886271180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818862711708       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818862711708       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818862711708       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818865636803       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+10 is 1.563752e-14

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818862711708       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818862711708       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818862711708       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818848532381       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818858229024       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818905739582       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+10 is 3.897840e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818862711708       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818862711708       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818862711708       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818862955402       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819013589627       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819328732649       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818930173629       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.818864921829       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.818965103905       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.817853214025       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.819172827706       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.818888259882       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.818647127672       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.819163819977       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.819214634257       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.818475030806       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.818981354571       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.818897482997       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.818508191186       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.819616598985       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.818981221582       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.819174339039       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.819542940341       residual = 1.27e-05           smallest_sin_value = 9.99e-01
davidson iteration   23:   krylov dim =  24   energy =     -22.818903130852       residual = 6.87e-05           smallest_sin_value = 9.97e-01
davidson iteration   24 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+11 is 9.709008e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9947e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8135
    reference variance = 0.319517
====================================================
  Execution time = 2.4754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8160e-01
  Total weights = 1.9637e+06
  Execution time = 3.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484344056
  error estimate for blocks of size 2^( 2) =       0.000505850813
  error estimate for blocks of size 2^( 3) =       0.000526224750
  error estimate for blocks of size 2^( 4) =       0.000541420536
  error estimate for blocks of size 2^( 5) =       0.000550950206
  error estimate for blocks of size 2^( 6) =       0.000556114782
  error estimate for blocks of size 2^( 7) =       0.000559153631

      target function =                  N/A
              le_mean =     -22.819213110507
             les_mean =     521.198086703964
             stat err =       0.000551909789
             autocorr =       1.298459013425
              std dev =       0.684965932508
             le_variance =       0.469178328697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484344056
  error estimate for blocks of size 2^( 2) =       0.000505850813
  error estimate for blocks of size 2^( 3) =       0.000526224750
  error estimate for blocks of size 2^( 4) =       0.000541420536
  error estimate for blocks of size 2^( 5) =       0.000550950206
  error estimate for blocks of size 2^( 6) =       0.000556114782
  error estimate for blocks of size 2^( 7) =       0.000559153631

      target function =                  N/A
              le_mean =     -22.819213110507
             les_mean =     521.198086703964
             stat err =       0.000551909789
             autocorr =       1.298459013425
              std dev =       0.684965932508
             le_variance =       0.469178328697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484344056
  error estimate for blocks of size 2^( 2) =       0.000505850813
  error estimate for blocks of size 2^( 3) =       0.000526224750
  error estimate for blocks of size 2^( 4) =       0.000541420536
  error estimate for blocks of size 2^( 5) =       0.000550950206
  error estimate for blocks of size 2^( 6) =       0.000556114782
  error estimate for blocks of size 2^( 7) =       0.000559153631

      target function =                  N/A
              le_mean =     -22.819213110507
             les_mean =     521.198086703964
             stat err =       0.000551909789
             autocorr =       1.298459013424
              std dev =       0.684965932508
             le_variance =       0.469178328697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469172119856
                                         uncertainty =       0.002324340666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484344056
  error estimate for blocks of size 2^( 2) =       0.000505850813
  error estimate for blocks of size 2^( 3) =       0.000526224750
  error estimate for blocks of size 2^( 4) =       0.000541420536
  error estimate for blocks of size 2^( 5) =       0.000550950206
  error estimate for blocks of size 2^( 6) =       0.000556114782
  error estimate for blocks of size 2^( 7) =       0.000559153631

      target function =                  N/A
              le_mean =     -22.819213110507
             les_mean =     521.198086703964
             stat err =       0.000551909789
             autocorr =       1.298459013429
              std dev =       0.684965932508
             le_variance =       0.469178328697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819213110507        initial  <--
     2.3842e+10     2.3842e+11             1.5638e-14       -22.819213110507
     9.5367e+10     9.5367e+11             3.8978e-15       -22.819213110507
     3.8147e+11     3.8147e+12             9.7090e-16       -22.819213110507

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3961
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8715
    reference variance = 0.460141
====================================================
  Execution time = 2.5242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9337e-01
  Total weights = 1.963618416e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473228683337
                                         uncertainty =       0.002306392015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473228683337
                                         uncertainty =       0.002306392015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486434313
  error estimate for blocks of size 2^( 2) =       0.000507675878
  error estimate for blocks of size 2^( 3) =       0.000527811844
  error estimate for blocks of size 2^( 4) =       0.000543048216
  error estimate for blocks of size 2^( 5) =       0.000552792335
  error estimate for blocks of size 2^( 6) =       0.000558174121
  error estimate for blocks of size 2^( 7) =       0.000562878588

      target function =                  N/A
              le_mean =     -22.820042019743
             les_mean =     521.247690453039
             stat err =       0.000554223315
             autocorr =       1.298138941014
              std dev =       0.687922002892
             le_variance =       0.473236682063


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282004201974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820042019679       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820042019679       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820042019679       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820042019679       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820042019679       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.820273098169       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.820042019679       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.820031327936       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.820166684922       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.819659724245       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.820289242753       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.820036514831       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.820315259038       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.819821675615       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.820142201606       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.820307509799       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.820256477538       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.820346342320       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.819497577630       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.820343678845       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.819812766398       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.820198069241       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.819880548747       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.821216360618       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.819871690285       residual = 1.64e-05           smallest_sin_value = 9.99e-01
davidson iteration   25:   krylov dim =  26   energy =     -22.819286461947       residual = 4.65e-06           smallest_sin_value = 9.96e-01
davidson iteration   26 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+11 is 2.782560e-15

solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820042019679       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820042019679       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820042019679       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820042019679       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820068272355       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.820891085853       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.819693693457       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.819647186819       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.819769656144       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.819041220445       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.820607725771       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.819323750922       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.820660818209       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.823323081167       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.815430284663       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.820651544937       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.818849667088       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.821968420343       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.818678780987       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.822992859716       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.819953312504       residual = 1.81e-04           smallest_sin_value = 9.99e-01
davidson iteration   21:   krylov dim =  22   energy =     -22.818978758739       residual = 1.61e-04           smallest_sin_value = 9.99e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+11 is 7.112658e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820042019679       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820042019679       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820042019679       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819953339254       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820042019679       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.820656908196       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824672412280       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.829603309945       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.832233244499       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.817306226629       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.822679206737       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.814634827808       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.823594121508       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825849641861       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.826846495451       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.818964210489       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.815479169670       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.808370662924       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.816781488785       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.802763567946       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.818369190230       residual = 1.53e-03           smallest_sin_value = 9.99e-01
davidson iteration   21:   krylov dim =  22   energy =     -22.824848458677       residual = 1.99e-03           smallest_sin_value = 9.95e-01
davidson iteration   22:   krylov dim =  23   energy =     -22.814841384534       residual = 3.19e-03           smallest_sin_value = 9.92e-01
davidson iteration   23 stopping due to small subspace S singular value of 9.28e-01
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+12 is 1.620620e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9797e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7853
    reference variance = 0.380358
====================================================
  Execution time = 2.4619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8726e-01
  Total weights = 1.9638e+06
  Execution time = 3.5310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484368915
  error estimate for blocks of size 2^( 2) =       0.000505922251
  error estimate for blocks of size 2^( 3) =       0.000526072782
  error estimate for blocks of size 2^( 4) =       0.000540954857
  error estimate for blocks of size 2^( 5) =       0.000550771740
  error estimate for blocks of size 2^( 6) =       0.000557531325
  error estimate for blocks of size 2^( 7) =       0.000560290734

      target function =                  N/A
              le_mean =     -22.819253514347
             les_mean =     521.205591479761
             stat err =       0.000552387164
             autocorr =       1.300572685730
              std dev =       0.685001088468
             le_variance =       0.469226491202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484368915
  error estimate for blocks of size 2^( 2) =       0.000505922251
  error estimate for blocks of size 2^( 3) =       0.000526072782
  error estimate for blocks of size 2^( 4) =       0.000540954857
  error estimate for blocks of size 2^( 5) =       0.000550771740
  error estimate for blocks of size 2^( 6) =       0.000557531325
  error estimate for blocks of size 2^( 7) =       0.000560290734

      target function =                  N/A
              le_mean =     -22.819253514347
             les_mean =     521.205591479761
             stat err =       0.000552387164
             autocorr =       1.300572685735
              std dev =       0.685001088468
             le_variance =       0.469226491202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484368915
  error estimate for blocks of size 2^( 2) =       0.000505922251
  error estimate for blocks of size 2^( 3) =       0.000526072782
  error estimate for blocks of size 2^( 4) =       0.000540954857
  error estimate for blocks of size 2^( 5) =       0.000550771740
  error estimate for blocks of size 2^( 6) =       0.000557531325
  error estimate for blocks of size 2^( 7) =       0.000560290734

      target function =                  N/A
              le_mean =     -22.819253514347
             les_mean =     521.205591479761
             stat err =       0.000552387164
             autocorr =       1.300572685742
              std dev =       0.685001088467
             le_variance =       0.469226491202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469285371496
                                         uncertainty =       0.003160896431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484368915
  error estimate for blocks of size 2^( 2) =       0.000505922251
  error estimate for blocks of size 2^( 3) =       0.000526072782
  error estimate for blocks of size 2^( 4) =       0.000540954857
  error estimate for blocks of size 2^( 5) =       0.000550771740
  error estimate for blocks of size 2^( 6) =       0.000557531325
  error estimate for blocks of size 2^( 7) =       0.000560290734

      target function =                  N/A
              le_mean =     -22.819253514347
             les_mean =     521.205591479761
             stat err =       0.000552387164
             autocorr =       1.300572685741
              std dev =       0.685001088467
             le_variance =       0.469226491202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819253514347        initial  <--
     2.3842e+11     2.3842e+12             2.7826e-15       -22.819253514347
     9.5367e+11     9.5367e+12             7.1127e-16       -22.819253514347
     3.8147e+12     3.8147e+13             1.6206e-16       -22.819253514347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4103
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2224e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8325
    reference variance = 0.321005
====================================================
  Execution time = 2.5431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8473e-01
  Total weights = 1.963725284e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470338056159
                                         uncertainty =       0.002527391241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470338056159
                                         uncertainty =       0.002527391241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484993125
  error estimate for blocks of size 2^( 2) =       0.000506092105
  error estimate for blocks of size 2^( 3) =       0.000526628290
  error estimate for blocks of size 2^( 4) =       0.000541212610
  error estimate for blocks of size 2^( 5) =       0.000551147169
  error estimate for blocks of size 2^( 6) =       0.000558162163
  error estimate for blocks of size 2^( 7) =       0.000560757042

      target function =                  N/A
              le_mean =     -22.819500474485
             les_mean =     521.214328786078
             stat err =       0.000552819746
             autocorr =       1.299259588518
              std dev =       0.685883854597
             le_variance =       0.470436661997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281950047448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819500474435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819500474435       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819500474435       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817167751465       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819500474435       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818590087855       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818977375832       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.820929551672       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.817741459030       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.820726882111       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.820282809088       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.821063355886       residual = 8.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.819300659701       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.817343103887       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.822411709222       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.816427430716       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.821943345583       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.820634070252       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.826631095929       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -22.822327719605       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -22.821020810367       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -22.825905343130       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -22.814870152638       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -22.818780147311       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -22.818471462576       residual = 6.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -22.818023384683       residual = 6.29e-04           smallest_sin_value = 9.99e-01
davidson iteration   26:   krylov dim =  27   energy =     -22.819629900729       residual = 4.26e-04           smallest_sin_value = 9.98e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+12 is 1.948338e-16

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819500474435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819500474435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.53e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819500474435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819500474435       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.53e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0026e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8337
    reference variance = 0.67906
====================================================
  Execution time = 2.6576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8935e-01
  Total weights = 1.9638e+06
  Execution time = 3.5067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486661874
  error estimate for blocks of size 2^( 2) =       0.000508090710
  error estimate for blocks of size 2^( 3) =       0.000528529588
  error estimate for blocks of size 2^( 4) =       0.000544404799
  error estimate for blocks of size 2^( 5) =       0.000554832567
  error estimate for blocks of size 2^( 6) =       0.000561267758
  error estimate for blocks of size 2^( 7) =       0.000563820784

      target function =                  N/A
              le_mean =     -22.818461112234
             les_mean =     521.171522435041
             stat err =       0.000556081477
             autocorr =       1.305636282402
              std dev =       0.688243822146
             le_variance =       0.473679558722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486661874
  error estimate for blocks of size 2^( 2) =       0.000508090710
  error estimate for blocks of size 2^( 3) =       0.000528529588
  error estimate for blocks of size 2^( 4) =       0.000544404799
  error estimate for blocks of size 2^( 5) =       0.000554832567
  error estimate for blocks of size 2^( 6) =       0.000561267758
  error estimate for blocks of size 2^( 7) =       0.000563820784

      target function =                  N/A
              le_mean =     -22.818461112234
             les_mean =     521.171522435041
             stat err =       0.000556081477
             autocorr =       1.305636282408
              std dev =       0.688243822146
             le_variance =       0.473679558722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486661874
  error estimate for blocks of size 2^( 2) =       0.000508090710
  error estimate for blocks of size 2^( 3) =       0.000528529588
  error estimate for blocks of size 2^( 4) =       0.000544404799
  error estimate for blocks of size 2^( 5) =       0.000554832567
  error estimate for blocks of size 2^( 6) =       0.000561267758
  error estimate for blocks of size 2^( 7) =       0.000563820784

      target function =                  N/A
              le_mean =     -22.818461112234
             les_mean =     521.171522435041
             stat err =       0.000556081477
             autocorr =       1.305636282402
              std dev =       0.688243822146
             le_variance =       0.473679558722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473688362516
                                         uncertainty =       0.002720525968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486661874
  error estimate for blocks of size 2^( 2) =       0.000508090710
  error estimate for blocks of size 2^( 3) =       0.000528529588
  error estimate for blocks of size 2^( 4) =       0.000544404799
  error estimate for blocks of size 2^( 5) =       0.000554832567
  error estimate for blocks of size 2^( 6) =       0.000561267758
  error estimate for blocks of size 2^( 7) =       0.000563820784

      target function =                  N/A
              le_mean =     -22.818461112234
             les_mean =     521.171522435041
             stat err =       0.000556081477
             autocorr =       1.305636282402
              std dev =       0.688243822146
             le_variance =       0.473679558722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818461112234        initial  <--
     2.3842e+12     2.3842e+13             1.9483e-16       -22.818461112234
     9.5367e+12     9.5367e+13             0.0000e+00       -22.818461112234
     3.8147e+13     3.8147e+14             0.0000e+00       -22.818461112234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2166
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8571
    reference variance = 0.380823
====================================================
  Execution time = 2.5293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9499e-01
  Total weights = 1.963367767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472523034556
                                         uncertainty =       0.002622987695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472523034556
                                         uncertainty =       0.002622987695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486175646
  error estimate for blocks of size 2^( 2) =       0.000507918234
  error estimate for blocks of size 2^( 3) =       0.000529046961
  error estimate for blocks of size 2^( 4) =       0.000544805166
  error estimate for blocks of size 2^( 5) =       0.000555556925
  error estimate for blocks of size 2^( 6) =       0.000560359500
  error estimate for blocks of size 2^( 7) =       0.000562623343

      target function =                  N/A
              le_mean =     -22.818680442652
             les_mean =     521.187163893840
             stat err =       0.000555836234
             autocorr =       1.307095466417
              std dev =       0.687556192140
             le_variance =       0.472733517349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281868044265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818680442586       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818680442586       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818680442586       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818680442586       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818680442586       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818680442586       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.45e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9814e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8461
    reference variance = 0.31685
====================================================
  Execution time = 2.4929e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8939e-01
  Total weights = 1.9636e+06
  Execution time = 3.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486224836
  error estimate for blocks of size 2^( 2) =       0.000507335286
  error estimate for blocks of size 2^( 3) =       0.000527894822
  error estimate for blocks of size 2^( 4) =       0.000543876473
  error estimate for blocks of size 2^( 5) =       0.000553380154
  error estimate for blocks of size 2^( 6) =       0.000559649616
  error estimate for blocks of size 2^( 7) =       0.000565829242

      target function =                  N/A
              le_mean =     -22.819080885859
             les_mean =     521.199844183043
             stat err =       0.000555683871
             autocorr =       1.306114666193
              std dev =       0.687625757305
             le_variance =       0.472829182109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486224836
  error estimate for blocks of size 2^( 2) =       0.000507335286
  error estimate for blocks of size 2^( 3) =       0.000527894822
  error estimate for blocks of size 2^( 4) =       0.000543876473
  error estimate for blocks of size 2^( 5) =       0.000553380154
  error estimate for blocks of size 2^( 6) =       0.000559649616
  error estimate for blocks of size 2^( 7) =       0.000565829242

      target function =                  N/A
              le_mean =     -22.819080885859
             les_mean =     521.199844183043
             stat err =       0.000555683871
             autocorr =       1.306114666193
              std dev =       0.687625757305
             le_variance =       0.472829182109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486224836
  error estimate for blocks of size 2^( 2) =       0.000507335286
  error estimate for blocks of size 2^( 3) =       0.000527894822
  error estimate for blocks of size 2^( 4) =       0.000543876473
  error estimate for blocks of size 2^( 5) =       0.000553380154
  error estimate for blocks of size 2^( 6) =       0.000559649616
  error estimate for blocks of size 2^( 7) =       0.000565829242

      target function =                  N/A
              le_mean =     -22.819080885859
             les_mean =     521.199844183043
             stat err =       0.000555683871
             autocorr =       1.306114666193
              std dev =       0.687625757305
             le_variance =       0.472829182109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472952544452
                                         uncertainty =       0.002455787765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486224836
  error estimate for blocks of size 2^( 2) =       0.000507335286
  error estimate for blocks of size 2^( 3) =       0.000527894822
  error estimate for blocks of size 2^( 4) =       0.000543876473
  error estimate for blocks of size 2^( 5) =       0.000553380154
  error estimate for blocks of size 2^( 6) =       0.000559649616
  error estimate for blocks of size 2^( 7) =       0.000565829242

      target function =                  N/A
              le_mean =     -22.819080885859
             les_mean =     521.199844183043
             stat err =       0.000555683871
             autocorr =       1.306114666193
              std dev =       0.687625757305
             le_variance =       0.472829182109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819080885859        initial  <--
     2.3842e+13     2.3842e+14             0.0000e+00       -22.819080885859
     9.5367e+13     9.5367e+14             0.0000e+00       -22.819080885859
     3.8147e+14     3.8147e+15             0.0000e+00       -22.819080885859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5869
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8173
    reference variance = 0.384309
====================================================
  Execution time = 2.5594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8635e-01
  Total weights = 1.963615987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470296975400
                                         uncertainty =       0.002104987832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470296975400
                                         uncertainty =       0.002104987832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484953087
  error estimate for blocks of size 2^( 2) =       0.000506654168
  error estimate for blocks of size 2^( 3) =       0.000527502540
  error estimate for blocks of size 2^( 4) =       0.000543187373
  error estimate for blocks of size 2^( 5) =       0.000553245571
  error estimate for blocks of size 2^( 6) =       0.000559495806
  error estimate for blocks of size 2^( 7) =       0.000565237560

      target function =                  N/A
              le_mean =     -22.819299852687
             les_mean =     521.206799665539
             stat err =       0.000555291578
             autocorr =       1.311120825751
              std dev =       0.685827233164
             le_variance =       0.470358993750


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281929985269e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819299852625       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819299852625       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.05e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819299852625       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819299852625       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.05e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819299852625       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819299852625       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.05e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0131e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8304
    reference variance = 0.305244
====================================================
  Execution time = 2.4715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8803e-01
  Total weights = 1.9640e+06
  Execution time = 3.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484748586
  error estimate for blocks of size 2^( 2) =       0.000506156846
  error estimate for blocks of size 2^( 3) =       0.000526815970
  error estimate for blocks of size 2^( 4) =       0.000542216312
  error estimate for blocks of size 2^( 5) =       0.000552221559
  error estimate for blocks of size 2^( 6) =       0.000555497670
  error estimate for blocks of size 2^( 7) =       0.000558962777

      target function =                  N/A
              le_mean =     -22.819056186300
             les_mean =     521.197359197738
             stat err =       0.000552224580
             autocorr =       1.297771896760
              std dev =       0.685538024042
             le_variance =       0.469962382408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484748586
  error estimate for blocks of size 2^( 2) =       0.000506156846
  error estimate for blocks of size 2^( 3) =       0.000526815970
  error estimate for blocks of size 2^( 4) =       0.000542216312
  error estimate for blocks of size 2^( 5) =       0.000552221559
  error estimate for blocks of size 2^( 6) =       0.000555497670
  error estimate for blocks of size 2^( 7) =       0.000558962777

      target function =                  N/A
              le_mean =     -22.819056186300
             les_mean =     521.197359197738
             stat err =       0.000552224580
             autocorr =       1.297771896760
              std dev =       0.685538024042
             le_variance =       0.469962382408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484748586
  error estimate for blocks of size 2^( 2) =       0.000506156846
  error estimate for blocks of size 2^( 3) =       0.000526815970
  error estimate for blocks of size 2^( 4) =       0.000542216312
  error estimate for blocks of size 2^( 5) =       0.000552221559
  error estimate for blocks of size 2^( 6) =       0.000555497670
  error estimate for blocks of size 2^( 7) =       0.000558962777

      target function =                  N/A
              le_mean =     -22.819056186300
             les_mean =     521.197359197738
             stat err =       0.000552224580
             autocorr =       1.297771896760
              std dev =       0.685538024042
             le_variance =       0.469962382408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469963544922
                                         uncertainty =       0.001856822230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484748586
  error estimate for blocks of size 2^( 2) =       0.000506156846
  error estimate for blocks of size 2^( 3) =       0.000526815970
  error estimate for blocks of size 2^( 4) =       0.000542216312
  error estimate for blocks of size 2^( 5) =       0.000552221559
  error estimate for blocks of size 2^( 6) =       0.000555497670
  error estimate for blocks of size 2^( 7) =       0.000558962777

      target function =                  N/A
              le_mean =     -22.819056186300
             les_mean =     521.197359197738
             stat err =       0.000552224580
             autocorr =       1.297771896760
              std dev =       0.685538024042
             le_variance =       0.469962382408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819056186300        initial  <--
     2.3842e+14     2.3842e+15             0.0000e+00       -22.819056186300
     9.5367e+14     9.5367e+15             0.0000e+00       -22.819056186300
     3.8147e+15     3.8147e+16             0.0000e+00       -22.819056186300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4252
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8556
    reference variance = 1.17047
====================================================
  Execution time = 2.5355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8850e-01
  Total weights = 1.963694781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473624856498
                                         uncertainty =       0.002591498076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473624856498
                                         uncertainty =       0.002591498076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486600193
  error estimate for blocks of size 2^( 2) =       0.000508011612
  error estimate for blocks of size 2^( 3) =       0.000528701557
  error estimate for blocks of size 2^( 4) =       0.000544471540
  error estimate for blocks of size 2^( 5) =       0.000554532999
  error estimate for blocks of size 2^( 6) =       0.000561367904
  error estimate for blocks of size 2^( 7) =       0.000564665969

      target function =                  N/A
              le_mean =     -22.819942290908
             les_mean =     521.238263080413
             stat err =       0.000556259603
             autocorr =       1.306804102019
              std dev =       0.688156592624
             le_variance =       0.473559495972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281994229091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819942290860       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819942290860       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819942290860       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819942290860       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819942290860       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819942290860       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9872e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8319
    reference variance = 0.410969
====================================================
  Execution time = 2.4881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9174e-01
  Total weights = 1.9637e+06
  Execution time = 3.5136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486791562
  error estimate for blocks of size 2^( 2) =       0.000508080340
  error estimate for blocks of size 2^( 3) =       0.000528349775
  error estimate for blocks of size 2^( 4) =       0.000544387726
  error estimate for blocks of size 2^( 5) =       0.000554149422
  error estimate for blocks of size 2^( 6) =       0.000559886080
  error estimate for blocks of size 2^( 7) =       0.000559917489

      target function =                  N/A
              le_mean =     -22.819591652762
             les_mean =     521.225506550642
             stat err =       0.000554585179
             autocorr =       1.297927504847
              std dev =       0.688427228584
             le_variance =       0.473932049056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486791562
  error estimate for blocks of size 2^( 2) =       0.000508080340
  error estimate for blocks of size 2^( 3) =       0.000528349775
  error estimate for blocks of size 2^( 4) =       0.000544387726
  error estimate for blocks of size 2^( 5) =       0.000554149422
  error estimate for blocks of size 2^( 6) =       0.000559886080
  error estimate for blocks of size 2^( 7) =       0.000559917489

      target function =                  N/A
              le_mean =     -22.819591652762
             les_mean =     521.225506550642
             stat err =       0.000554585179
             autocorr =       1.297927504847
              std dev =       0.688427228584
             le_variance =       0.473932049056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486791562
  error estimate for blocks of size 2^( 2) =       0.000508080340
  error estimate for blocks of size 2^( 3) =       0.000528349775
  error estimate for blocks of size 2^( 4) =       0.000544387726
  error estimate for blocks of size 2^( 5) =       0.000554149422
  error estimate for blocks of size 2^( 6) =       0.000559886080
  error estimate for blocks of size 2^( 7) =       0.000559917489

      target function =                  N/A
              le_mean =     -22.819591652762
             les_mean =     521.225506550642
             stat err =       0.000554585179
             autocorr =       1.297927504847
              std dev =       0.688427228584
             le_variance =       0.473932049056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473879449736
                                         uncertainty =       0.002608499311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486791562
  error estimate for blocks of size 2^( 2) =       0.000508080340
  error estimate for blocks of size 2^( 3) =       0.000528349775
  error estimate for blocks of size 2^( 4) =       0.000544387726
  error estimate for blocks of size 2^( 5) =       0.000554149422
  error estimate for blocks of size 2^( 6) =       0.000559886080
  error estimate for blocks of size 2^( 7) =       0.000559917489

      target function =                  N/A
              le_mean =     -22.819591652762
             les_mean =     521.225506550642
             stat err =       0.000554585179
             autocorr =       1.297927504847
              std dev =       0.688427228584
             le_variance =       0.473932049056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819591652762        initial  <--
     2.3842e+15     2.3842e+16             0.0000e+00       -22.819591652762
     9.5367e+15     9.5367e+16             0.0000e+00       -22.819591652762
     3.8147e+16     3.8147e+17             0.0000e+00       -22.819591652762

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5540
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8048
    reference variance = 0.768882
====================================================
  Execution time = 2.5407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8560e-01
  Total weights = 1.963494006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471096192270
                                         uncertainty =       0.003291748440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471096192270
                                         uncertainty =       0.003291748440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485455808
  error estimate for blocks of size 2^( 2) =       0.000506789083
  error estimate for blocks of size 2^( 3) =       0.000527770067
  error estimate for blocks of size 2^( 4) =       0.000543431604
  error estimate for blocks of size 2^( 5) =       0.000553136878
  error estimate for blocks of size 2^( 6) =       0.000559160835
  error estimate for blocks of size 2^( 7) =       0.000562388962

      target function =                  N/A
              le_mean =     -22.819622044539
             les_mean =     521.220745913098
             stat err =       0.000554529570
             autocorr =       1.304818229443
              std dev =       0.686538188112
             le_variance =       0.471334683737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281962204454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819622044474       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819622044474       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819622044474       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819622044474       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819622044474       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819622044474       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9928e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8721
    reference variance = 0.418075
====================================================
  Execution time = 2.6978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9150e-01
  Total weights = 1.9633e+06
  Execution time = 3.4736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485449848
  error estimate for blocks of size 2^( 2) =       0.000506999186
  error estimate for blocks of size 2^( 3) =       0.000527566977
  error estimate for blocks of size 2^( 4) =       0.000543475722
  error estimate for blocks of size 2^( 5) =       0.000552965464
  error estimate for blocks of size 2^( 6) =       0.000558830542
  error estimate for blocks of size 2^( 7) =       0.000560381679

      target function =                  N/A
              le_mean =     -22.819259255491
             les_mean =     521.210095862621
             stat err =       0.000553913352
             autocorr =       1.301951863766
              std dev =       0.686529759362
             le_variance =       0.471323110490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485449848
  error estimate for blocks of size 2^( 2) =       0.000506999186
  error estimate for blocks of size 2^( 3) =       0.000527566977
  error estimate for blocks of size 2^( 4) =       0.000543475722
  error estimate for blocks of size 2^( 5) =       0.000552965464
  error estimate for blocks of size 2^( 6) =       0.000558830542
  error estimate for blocks of size 2^( 7) =       0.000560381679

      target function =                  N/A
              le_mean =     -22.819259255491
             les_mean =     521.210095862621
             stat err =       0.000553913352
             autocorr =       1.301951863766
              std dev =       0.686529759362
             le_variance =       0.471323110490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485449848
  error estimate for blocks of size 2^( 2) =       0.000506999186
  error estimate for blocks of size 2^( 3) =       0.000527566977
  error estimate for blocks of size 2^( 4) =       0.000543475722
  error estimate for blocks of size 2^( 5) =       0.000552965464
  error estimate for blocks of size 2^( 6) =       0.000558830542
  error estimate for blocks of size 2^( 7) =       0.000560381679

      target function =                  N/A
              le_mean =     -22.819259255491
             les_mean =     521.210095862621
             stat err =       0.000553913352
             autocorr =       1.301951863766
              std dev =       0.686529759362
             le_variance =       0.471323110490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471352627922
                                         uncertainty =       0.003707319743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485449848
  error estimate for blocks of size 2^( 2) =       0.000506999186
  error estimate for blocks of size 2^( 3) =       0.000527566977
  error estimate for blocks of size 2^( 4) =       0.000543475722
  error estimate for blocks of size 2^( 5) =       0.000552965464
  error estimate for blocks of size 2^( 6) =       0.000558830542
  error estimate for blocks of size 2^( 7) =       0.000560381679

      target function =                  N/A
              le_mean =     -22.819259255491
             les_mean =     521.210095862621
             stat err =       0.000553913352
             autocorr =       1.301951863766
              std dev =       0.686529759362
             le_variance =       0.471323110490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819259255491        initial  <--
     2.3842e+16     2.3842e+17             0.0000e+00       -22.819259255491
     9.5367e+16     9.5367e+17             0.0000e+00       -22.819259255491
     3.8147e+17     3.8147e+18             0.0000e+00       -22.819259255491

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.5616
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7394
    reference variance = 0.415593
====================================================
  Execution time = 2.5391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9036e-01
  Total weights = 1.963242994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475856485152
                                         uncertainty =       0.002589117414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475856485152
                                         uncertainty =       0.002589117414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487764781
  error estimate for blocks of size 2^( 2) =       0.000508956488
  error estimate for blocks of size 2^( 3) =       0.000529834964
  error estimate for blocks of size 2^( 4) =       0.000545405476
  error estimate for blocks of size 2^( 5) =       0.000554266657
  error estimate for blocks of size 2^( 6) =       0.000559041926
  error estimate for blocks of size 2^( 7) =       0.000560376018

      target function =                  N/A
              le_mean =     -22.820144099932
             les_mean =     521.249337480826
             stat err =       0.000554772519
             autocorr =       1.293626793803
              std dev =       0.689803568683
             le_variance =       0.475828963368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282014409993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820144099895       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820144099895       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820144099895       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820144099895       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820144099895       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820144099895       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.11e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9916e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8109
    reference variance = 0.40832
====================================================
  Execution time = 2.4923e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8637e-01
  Total weights = 1.9637e+06
  Execution time = 3.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485052844
  error estimate for blocks of size 2^( 2) =       0.000506917315
  error estimate for blocks of size 2^( 3) =       0.000527351782
  error estimate for blocks of size 2^( 4) =       0.000543485269
  error estimate for blocks of size 2^( 5) =       0.000554628711
  error estimate for blocks of size 2^( 6) =       0.000558937179
  error estimate for blocks of size 2^( 7) =       0.000563636862

      target function =                  N/A
              le_mean =     -22.817985129792
             les_mean =     521.146816130070
             stat err =       0.000555172005
             autocorr =       1.310017224265
              std dev =       0.685968310789
             le_variance =       0.470552523407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485052844
  error estimate for blocks of size 2^( 2) =       0.000506917315
  error estimate for blocks of size 2^( 3) =       0.000527351782
  error estimate for blocks of size 2^( 4) =       0.000543485269
  error estimate for blocks of size 2^( 5) =       0.000554628711
  error estimate for blocks of size 2^( 6) =       0.000558937179
  error estimate for blocks of size 2^( 7) =       0.000563636862

      target function =                  N/A
              le_mean =     -22.817985129792
             les_mean =     521.146816130070
             stat err =       0.000555172005
             autocorr =       1.310017224265
              std dev =       0.685968310789
             le_variance =       0.470552523407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485052844
  error estimate for blocks of size 2^( 2) =       0.000506917315
  error estimate for blocks of size 2^( 3) =       0.000527351782
  error estimate for blocks of size 2^( 4) =       0.000543485269
  error estimate for blocks of size 2^( 5) =       0.000554628711
  error estimate for blocks of size 2^( 6) =       0.000558937179
  error estimate for blocks of size 2^( 7) =       0.000563636862

      target function =                  N/A
              le_mean =     -22.817985129792
             les_mean =     521.146816130070
             stat err =       0.000555172005
             autocorr =       1.310017224265
              std dev =       0.685968310789
             le_variance =       0.470552523407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470592763012
                                         uncertainty =       0.002890397361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485052844
  error estimate for blocks of size 2^( 2) =       0.000506917315
  error estimate for blocks of size 2^( 3) =       0.000527351782
  error estimate for blocks of size 2^( 4) =       0.000543485269
  error estimate for blocks of size 2^( 5) =       0.000554628711
  error estimate for blocks of size 2^( 6) =       0.000558937179
  error estimate for blocks of size 2^( 7) =       0.000563636862

      target function =                  N/A
              le_mean =     -22.817985129792
             les_mean =     521.146816130070
             stat err =       0.000555172005
             autocorr =       1.310017224265
              std dev =       0.685968310789
             le_variance =       0.470552523407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.817985129792        initial  <--
     2.3842e+17     2.3842e+18             0.0000e+00       -22.817985129792
     9.5367e+17     9.5367e+18             0.0000e+00       -22.817985129792
     3.8147e+18     3.8147e+19             0.0000e+00       -22.817985129792

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5357
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8159
    reference variance = 0.583389
====================================================
  Execution time = 2.5472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8908e-01
  Total weights = 1.963641901e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473155531370
                                         uncertainty =       0.002709201217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473155531370
                                         uncertainty =       0.002709201217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486398845
  error estimate for blocks of size 2^( 2) =       0.000507655000
  error estimate for blocks of size 2^( 3) =       0.000527597994
  error estimate for blocks of size 2^( 4) =       0.000541663025
  error estimate for blocks of size 2^( 5) =       0.000551684692
  error estimate for blocks of size 2^( 6) =       0.000556691181
  error estimate for blocks of size 2^( 7) =       0.000559092777

      target function =                  N/A
              le_mean =     -22.819021901432
             les_mean =     521.196838564220
             stat err =       0.000552282919
             autocorr =       1.289253008074
              std dev =       0.687871842891
             le_variance =       0.473167672243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281902190143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819021901420       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819021901420       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819021901420       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819021901420       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819021901420       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819021901420       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9978e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.81
    reference variance = 0.619494
====================================================
  Execution time = 2.4801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8846e-01
  Total weights = 1.9636e+06
  Execution time = 3.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485807023
  error estimate for blocks of size 2^( 2) =       0.000506975141
  error estimate for blocks of size 2^( 3) =       0.000526473938
  error estimate for blocks of size 2^( 4) =       0.000542911022
  error estimate for blocks of size 2^( 5) =       0.000553756585
  error estimate for blocks of size 2^( 6) =       0.000559250792
  error estimate for blocks of size 2^( 7) =       0.000560634300

      target function =                  N/A
              le_mean =     -22.819984602799
             les_mean =     521.240158294338
             stat err =       0.000554138175
             autocorr =       1.301093662309
              std dev =       0.687034880918
             le_variance =       0.472016927598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485807023
  error estimate for blocks of size 2^( 2) =       0.000506975141
  error estimate for blocks of size 2^( 3) =       0.000526473938
  error estimate for blocks of size 2^( 4) =       0.000542911022
  error estimate for blocks of size 2^( 5) =       0.000553756585
  error estimate for blocks of size 2^( 6) =       0.000559250792
  error estimate for blocks of size 2^( 7) =       0.000560634300

      target function =                  N/A
              le_mean =     -22.819984602799
             les_mean =     521.240158294338
             stat err =       0.000554138175
             autocorr =       1.301093662309
              std dev =       0.687034880918
             le_variance =       0.472016927598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485807023
  error estimate for blocks of size 2^( 2) =       0.000506975141
  error estimate for blocks of size 2^( 3) =       0.000526473938
  error estimate for blocks of size 2^( 4) =       0.000542911022
  error estimate for blocks of size 2^( 5) =       0.000553756585
  error estimate for blocks of size 2^( 6) =       0.000559250792
  error estimate for blocks of size 2^( 7) =       0.000560634300

      target function =                  N/A
              le_mean =     -22.819984602799
             les_mean =     521.240158294338
             stat err =       0.000554138175
             autocorr =       1.301093662309
              std dev =       0.687034880918
             le_variance =       0.472016927598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472034266969
                                         uncertainty =       0.002542600165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485807023
  error estimate for blocks of size 2^( 2) =       0.000506975141
  error estimate for blocks of size 2^( 3) =       0.000526473938
  error estimate for blocks of size 2^( 4) =       0.000542911022
  error estimate for blocks of size 2^( 5) =       0.000553756585
  error estimate for blocks of size 2^( 6) =       0.000559250792
  error estimate for blocks of size 2^( 7) =       0.000560634300

      target function =                  N/A
              le_mean =     -22.819984602799
             les_mean =     521.240158294338
             stat err =       0.000554138175
             autocorr =       1.301093662309
              std dev =       0.687034880918
             le_variance =       0.472016927598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819984602799        initial  <--
     2.3842e+18     2.3842e+19             0.0000e+00       -22.819984602799
     9.5367e+18     9.5367e+19             0.0000e+00       -22.819984602799
     3.8147e+19     3.8147e+20             0.0000e+00       -22.819984602799

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4752
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7911
    reference variance = 0.399683
====================================================
  Execution time = 2.5494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8578e-01
  Total weights = 1.963534829e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469877287647
                                         uncertainty =       0.002494249682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469877287647
                                         uncertainty =       0.002494249682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484643684
  error estimate for blocks of size 2^( 2) =       0.000506067960
  error estimate for blocks of size 2^( 3) =       0.000527037462
  error estimate for blocks of size 2^( 4) =       0.000542951646
  error estimate for blocks of size 2^( 5) =       0.000552123426
  error estimate for blocks of size 2^( 6) =       0.000559245298
  error estimate for blocks of size 2^( 7) =       0.000563276570

      target function =                  N/A
              le_mean =     -22.819049966046
             les_mean =     521.194824095522
             stat err =       0.000554399235
             autocorr =       1.308579553347
              std dev =       0.685389670708
             le_variance =       0.469759000714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281904996605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819049965989       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819049965989       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819049965989       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819049965989       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819049965989       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819049965989       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0010e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7283
    reference variance = 0.476196
====================================================
  Execution time = 2.4705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8730e-01
  Total weights = 1.9636e+06
  Execution time = 3.4846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483936376
  error estimate for blocks of size 2^( 2) =       0.000505116586
  error estimate for blocks of size 2^( 3) =       0.000525385162
  error estimate for blocks of size 2^( 4) =       0.000540218724
  error estimate for blocks of size 2^( 5) =       0.000550848404
  error estimate for blocks of size 2^( 6) =       0.000557215694
  error estimate for blocks of size 2^( 7) =       0.000561719696

      target function =                  N/A
              le_mean =     -22.818361918887
             les_mean =     521.164936903322
             stat err =       0.000552500629
             autocorr =       1.303433917501
              std dev =       0.684389386494
             le_variance =       0.468388832345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483936376
  error estimate for blocks of size 2^( 2) =       0.000505116586
  error estimate for blocks of size 2^( 3) =       0.000525385162
  error estimate for blocks of size 2^( 4) =       0.000540218724
  error estimate for blocks of size 2^( 5) =       0.000550848404
  error estimate for blocks of size 2^( 6) =       0.000557215694
  error estimate for blocks of size 2^( 7) =       0.000561719696

      target function =                  N/A
              le_mean =     -22.818361918887
             les_mean =     521.164936903322
             stat err =       0.000552500629
             autocorr =       1.303433917501
              std dev =       0.684389386494
             le_variance =       0.468388832345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483936376
  error estimate for blocks of size 2^( 2) =       0.000505116586
  error estimate for blocks of size 2^( 3) =       0.000525385162
  error estimate for blocks of size 2^( 4) =       0.000540218724
  error estimate for blocks of size 2^( 5) =       0.000550848404
  error estimate for blocks of size 2^( 6) =       0.000557215694
  error estimate for blocks of size 2^( 7) =       0.000561719696

      target function =                  N/A
              le_mean =     -22.818361918887
             les_mean =     521.164936903322
             stat err =       0.000552500629
             autocorr =       1.303433917501
              std dev =       0.684389386494
             le_variance =       0.468388832345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468432980040
                                         uncertainty =       0.002218346241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483936376
  error estimate for blocks of size 2^( 2) =       0.000505116586
  error estimate for blocks of size 2^( 3) =       0.000525385162
  error estimate for blocks of size 2^( 4) =       0.000540218724
  error estimate for blocks of size 2^( 5) =       0.000550848404
  error estimate for blocks of size 2^( 6) =       0.000557215694
  error estimate for blocks of size 2^( 7) =       0.000561719696

      target function =                  N/A
              le_mean =     -22.818361918887
             les_mean =     521.164936903322
             stat err =       0.000552500629
             autocorr =       1.303433917501
              std dev =       0.684389386494
             le_variance =       0.468388832345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818361918887        initial  <--
     2.3842e+19     2.3842e+20             0.0000e+00       -22.818361918887
     9.5367e+19     9.5367e+20             0.0000e+00       -22.818361918887
     3.8147e+20     3.8147e+21             0.0000e+00       -22.818361918887

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2962
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7597
    reference variance = 0.548461
====================================================
  Execution time = 2.5516e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8930e-01
  Total weights = 1.963770549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475347289995
                                         uncertainty =       0.002642813974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475347289995
                                         uncertainty =       0.002642813974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487527786
  error estimate for blocks of size 2^( 2) =       0.000509026921
  error estimate for blocks of size 2^( 3) =       0.000529595115
  error estimate for blocks of size 2^( 4) =       0.000545544729
  error estimate for blocks of size 2^( 5) =       0.000555689815
  error estimate for blocks of size 2^( 6) =       0.000563121818
  error estimate for blocks of size 2^( 7) =       0.000567256197

      target function =                  N/A
              le_mean =     -22.820253255381
             les_mean =     521.253256426438
             stat err =       0.000557903140
             autocorr =       1.309540296100
              std dev =       0.689468406356
             le_variance =       0.475366683364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282025325538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820253255311       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820253255311       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820253255311       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820253255311       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820253255311       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820253255311       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0036e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8001
    reference variance = 0.28656
====================================================
  Execution time = 2.4651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9082e-01
  Total weights = 1.9633e+06
  Execution time = 3.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486703890
  error estimate for blocks of size 2^( 2) =       0.000508241851
  error estimate for blocks of size 2^( 3) =       0.000528628338
  error estimate for blocks of size 2^( 4) =       0.000543080764
  error estimate for blocks of size 2^( 5) =       0.000552376603
  error estimate for blocks of size 2^( 6) =       0.000558881558
  error estimate for blocks of size 2^( 7) =       0.000561206201

      target function =                  N/A
              le_mean =     -22.818492288088
             les_mean =     521.174406212212
             stat err =       0.000553886281
             autocorr =       1.295124689757
              std dev =       0.688303242146
             le_variance =       0.473761353149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486703890
  error estimate for blocks of size 2^( 2) =       0.000508241851
  error estimate for blocks of size 2^( 3) =       0.000528628338
  error estimate for blocks of size 2^( 4) =       0.000543080764
  error estimate for blocks of size 2^( 5) =       0.000552376603
  error estimate for blocks of size 2^( 6) =       0.000558881558
  error estimate for blocks of size 2^( 7) =       0.000561206201

      target function =                  N/A
              le_mean =     -22.818492288088
             les_mean =     521.174406212212
             stat err =       0.000553886281
             autocorr =       1.295124689757
              std dev =       0.688303242146
             le_variance =       0.473761353149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486703890
  error estimate for blocks of size 2^( 2) =       0.000508241851
  error estimate for blocks of size 2^( 3) =       0.000528628338
  error estimate for blocks of size 2^( 4) =       0.000543080764
  error estimate for blocks of size 2^( 5) =       0.000552376603
  error estimate for blocks of size 2^( 6) =       0.000558881558
  error estimate for blocks of size 2^( 7) =       0.000561206201

      target function =                  N/A
              le_mean =     -22.818492288088
             les_mean =     521.174406212212
             stat err =       0.000553886281
             autocorr =       1.295124689757
              std dev =       0.688303242146
             le_variance =       0.473761353149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473763602515
                                         uncertainty =       0.003658068875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486703890
  error estimate for blocks of size 2^( 2) =       0.000508241851
  error estimate for blocks of size 2^( 3) =       0.000528628338
  error estimate for blocks of size 2^( 4) =       0.000543080764
  error estimate for blocks of size 2^( 5) =       0.000552376603
  error estimate for blocks of size 2^( 6) =       0.000558881558
  error estimate for blocks of size 2^( 7) =       0.000561206201

      target function =                  N/A
              le_mean =     -22.818492288088
             les_mean =     521.174406212212
             stat err =       0.000553886281
             autocorr =       1.295124689757
              std dev =       0.688303242146
             le_variance =       0.473761353149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818492288088        initial  <--
     2.3842e+20     2.3842e+21             0.0000e+00       -22.818492288088
     9.5367e+20     9.5367e+21             0.0000e+00       -22.818492288088
     3.8147e+21     3.8147e+22             0.0000e+00       -22.818492288088

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.9277
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2969e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8567
    reference variance = 0.337801
====================================================
  Execution time = 2.5233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8138e-01
  Total weights = 1.963613460e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468227665631
                                         uncertainty =       0.002149080819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468227665631
                                         uncertainty =       0.002149080819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483860495
  error estimate for blocks of size 2^( 2) =       0.000505419884
  error estimate for blocks of size 2^( 3) =       0.000526501728
  error estimate for blocks of size 2^( 4) =       0.000542810697
  error estimate for blocks of size 2^( 5) =       0.000553281211
  error estimate for blocks of size 2^( 6) =       0.000560136951
  error estimate for blocks of size 2^( 7) =       0.000562316111

      target function =                  N/A
              le_mean =     -22.819060066489
             les_mean =     521.190881115137
             stat err =       0.000554636243
             autocorr =       1.313941892069
              std dev =       0.684282074444
             le_variance =       0.468241957406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281906006649e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819060066434       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819060066434       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819060066434       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819060066434       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819060066434       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819060066434       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9761e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.8629
    reference variance = 0.347878
====================================================
  Execution time = 2.4854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8829e-01
  Total weights = 1.9636e+06
  Execution time = 3.4827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483737708
  error estimate for blocks of size 2^( 2) =       0.000505544589
  error estimate for blocks of size 2^( 3) =       0.000525411004
  error estimate for blocks of size 2^( 4) =       0.000541101818
  error estimate for blocks of size 2^( 5) =       0.000550573559
  error estimate for blocks of size 2^( 6) =       0.000555365067
  error estimate for blocks of size 2^( 7) =       0.000557653724

      target function =                  N/A
              le_mean =     -22.819235941979
             les_mean =     521.205823572836
             stat err =       0.000551173542
             autocorr =       1.298245540709
              std dev =       0.684108426847
             le_variance =       0.468004339683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483737708
  error estimate for blocks of size 2^( 2) =       0.000505544589
  error estimate for blocks of size 2^( 3) =       0.000525411004
  error estimate for blocks of size 2^( 4) =       0.000541101818
  error estimate for blocks of size 2^( 5) =       0.000550573559
  error estimate for blocks of size 2^( 6) =       0.000555365067
  error estimate for blocks of size 2^( 7) =       0.000557653724

      target function =                  N/A
              le_mean =     -22.819235941979
             les_mean =     521.205823572836
             stat err =       0.000551173542
             autocorr =       1.298245540709
              std dev =       0.684108426847
             le_variance =       0.468004339683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483737708
  error estimate for blocks of size 2^( 2) =       0.000505544589
  error estimate for blocks of size 2^( 3) =       0.000525411004
  error estimate for blocks of size 2^( 4) =       0.000541101818
  error estimate for blocks of size 2^( 5) =       0.000550573559
  error estimate for blocks of size 2^( 6) =       0.000555365067
  error estimate for blocks of size 2^( 7) =       0.000557653724

      target function =                  N/A
              le_mean =     -22.819235941979
             les_mean =     521.205823572836
             stat err =       0.000551173542
             autocorr =       1.298245540709
              std dev =       0.684108426847
             le_variance =       0.468004339683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467971547548
                                         uncertainty =       0.002029650599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483737708
  error estimate for blocks of size 2^( 2) =       0.000505544589
  error estimate for blocks of size 2^( 3) =       0.000525411004
  error estimate for blocks of size 2^( 4) =       0.000541101818
  error estimate for blocks of size 2^( 5) =       0.000550573559
  error estimate for blocks of size 2^( 6) =       0.000555365067
  error estimate for blocks of size 2^( 7) =       0.000557653724

      target function =                  N/A
              le_mean =     -22.819235941979
             les_mean =     521.205823572836
             stat err =       0.000551173542
             autocorr =       1.298245540709
              std dev =       0.684108426847
             le_variance =       0.468004339683


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819235941979        initial  <--
     2.3842e+21     2.3842e+22             0.0000e+00       -22.819235941979
     9.5367e+21     9.5367e+22             0.0000e+00       -22.819235941979
     3.8147e+22     3.8147e+23             0.0000e+00       -22.819235941979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3577
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2125e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8467
    reference variance = 0.323052
====================================================
  Execution time = 2.5219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8354e-01
  Total weights = 1.963641803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466297014714
                                         uncertainty =       0.001717858049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466297014714
                                         uncertainty =       0.001717858049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482808340
  error estimate for blocks of size 2^( 2) =       0.000503723362
  error estimate for blocks of size 2^( 3) =       0.000523225484
  error estimate for blocks of size 2^( 4) =       0.000537289555
  error estimate for blocks of size 2^( 5) =       0.000547262923
  error estimate for blocks of size 2^( 6) =       0.000551889442
  error estimate for blocks of size 2^( 7) =       0.000554572673

      target function =                  N/A
              le_mean =     -22.819658640149
             les_mean =     521.220357527181
             stat err =       0.000547753648
             autocorr =       1.287125903978
              std dev =       0.682794102457
             le_variance =       0.466207786350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281965864015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819658640068       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819658640068       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819658640068       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+22 is 1.355875e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819658640068       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819658640068       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819658640068       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+22 is 3.389688e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819658640068       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819658640068       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819658640068       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+23 is 8.474221e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9709e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8587
    reference variance = 0.844261
====================================================
  Execution time = 2.4584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8282e-01
  Total weights = 1.9638e+06
  Execution time = 3.4882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484169744
  error estimate for blocks of size 2^( 2) =       0.000505385988
  error estimate for blocks of size 2^( 3) =       0.000526286737
  error estimate for blocks of size 2^( 4) =       0.000541893969
  error estimate for blocks of size 2^( 5) =       0.000552072417
  error estimate for blocks of size 2^( 6) =       0.000558548841
  error estimate for blocks of size 2^( 7) =       0.000562590036

      target function =                  N/A
              le_mean =     -22.819288002569
             les_mean =     521.202723912560
             stat err =       0.000553776316
             autocorr =       1.308197945165
              std dev =       0.684719418036
             le_variance =       0.468840681436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484169744
  error estimate for blocks of size 2^( 2) =       0.000505385988
  error estimate for blocks of size 2^( 3) =       0.000526286737
  error estimate for blocks of size 2^( 4) =       0.000541893969
  error estimate for blocks of size 2^( 5) =       0.000552072417
  error estimate for blocks of size 2^( 6) =       0.000558548841
  error estimate for blocks of size 2^( 7) =       0.000562590036

      target function =                  N/A
              le_mean =     -22.819288002569
             les_mean =     521.202723912560
             stat err =       0.000553776316
             autocorr =       1.308197945165
              std dev =       0.684719418036
             le_variance =       0.468840681436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484169744
  error estimate for blocks of size 2^( 2) =       0.000505385988
  error estimate for blocks of size 2^( 3) =       0.000526286737
  error estimate for blocks of size 2^( 4) =       0.000541893969
  error estimate for blocks of size 2^( 5) =       0.000552072417
  error estimate for blocks of size 2^( 6) =       0.000558548841
  error estimate for blocks of size 2^( 7) =       0.000562590036

      target function =                  N/A
              le_mean =     -22.819288002569
             les_mean =     521.202723912560
             stat err =       0.000553776316
             autocorr =       1.308197945165
              std dev =       0.684719418036
             le_variance =       0.468840681436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468821676631
                                         uncertainty =       0.002149318023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484169744
  error estimate for blocks of size 2^( 2) =       0.000505385988
  error estimate for blocks of size 2^( 3) =       0.000526286737
  error estimate for blocks of size 2^( 4) =       0.000541893969
  error estimate for blocks of size 2^( 5) =       0.000552072417
  error estimate for blocks of size 2^( 6) =       0.000558548841
  error estimate for blocks of size 2^( 7) =       0.000562590036

      target function =                  N/A
              le_mean =     -22.819288002569
             les_mean =     521.202723912560
             stat err =       0.000553776316
             autocorr =       1.308197945165
              std dev =       0.684719418036
             le_variance =       0.468840681436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819288002569        initial  <--
     2.3842e+22     2.3842e+23             1.3559e-26       -22.819288002569
     9.5367e+22     9.5367e+23             3.3897e-27       -22.819288002569
     3.8147e+23     3.8147e+24             8.4742e-28       -22.819288002569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1413
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8078
    reference variance = 0.489342
====================================================
  Execution time = 2.5212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8634e-01
  Total weights = 1.963736040e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471518969973
                                         uncertainty =       0.002633285262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471518969973
                                         uncertainty =       0.002633285262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485563381
  error estimate for blocks of size 2^( 2) =       0.000507344217
  error estimate for blocks of size 2^( 3) =       0.000528059771
  error estimate for blocks of size 2^( 4) =       0.000544703924
  error estimate for blocks of size 2^( 5) =       0.000555282815
  error estimate for blocks of size 2^( 6) =       0.000561774710
  error estimate for blocks of size 2^( 7) =       0.000567157039

      target function =                  N/A
              le_mean =     -22.818273129202
             les_mean =     521.159930928979
             stat err =       0.000557229622
             autocorr =       1.316971984705
              std dev =       0.686690318789
             le_variance =       0.471543593919


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281827312920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818273129095       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818273129095       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818273129095       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818273129095       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818273129095       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818273129095       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9709e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.9203
    reference variance = 0.586282
====================================================
  Execution time = 2.4546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8153e-01
  Total weights = 1.9636e+06
  Execution time = 3.4779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483704149
  error estimate for blocks of size 2^( 2) =       0.000504540435
  error estimate for blocks of size 2^( 3) =       0.000525204641
  error estimate for blocks of size 2^( 4) =       0.000540184491
  error estimate for blocks of size 2^( 5) =       0.000550470633
  error estimate for blocks of size 2^( 6) =       0.000554400495
  error estimate for blocks of size 2^( 7) =       0.000557145115

      target function =                  N/A
              le_mean =     -22.818669674585
             les_mean =     521.173213191239
             stat err =       0.000550550184
             autocorr =       1.295490397599
              std dev =       0.684060967909
             le_variance =       0.467939407816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483704149
  error estimate for blocks of size 2^( 2) =       0.000504540435
  error estimate for blocks of size 2^( 3) =       0.000525204641
  error estimate for blocks of size 2^( 4) =       0.000540184491
  error estimate for blocks of size 2^( 5) =       0.000550470633
  error estimate for blocks of size 2^( 6) =       0.000554400495
  error estimate for blocks of size 2^( 7) =       0.000557145115

      target function =                  N/A
              le_mean =     -22.818669674585
             les_mean =     521.173213191239
             stat err =       0.000550550184
             autocorr =       1.295490397599
              std dev =       0.684060967909
             le_variance =       0.467939407816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483704149
  error estimate for blocks of size 2^( 2) =       0.000504540435
  error estimate for blocks of size 2^( 3) =       0.000525204641
  error estimate for blocks of size 2^( 4) =       0.000540184491
  error estimate for blocks of size 2^( 5) =       0.000550470633
  error estimate for blocks of size 2^( 6) =       0.000554400495
  error estimate for blocks of size 2^( 7) =       0.000557145115

      target function =                  N/A
              le_mean =     -22.818669674585
             les_mean =     521.173213191239
             stat err =       0.000550550184
             autocorr =       1.295490397599
              std dev =       0.684060967909
             le_variance =       0.467939407816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467990071081
                                         uncertainty =       0.002231010493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483704149
  error estimate for blocks of size 2^( 2) =       0.000504540435
  error estimate for blocks of size 2^( 3) =       0.000525204641
  error estimate for blocks of size 2^( 4) =       0.000540184491
  error estimate for blocks of size 2^( 5) =       0.000550470633
  error estimate for blocks of size 2^( 6) =       0.000554400495
  error estimate for blocks of size 2^( 7) =       0.000557145115

      target function =                  N/A
              le_mean =     -22.818669674585
             les_mean =     521.173213191239
             stat err =       0.000550550184
             autocorr =       1.295490397599
              std dev =       0.684060967909
             le_variance =       0.467939407816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818669674585        initial  <--
     2.3842e+23     2.3842e+24             0.0000e+00       -22.818669674585
     9.5367e+23     9.5367e+24             0.0000e+00       -22.818669674585
     3.8147e+24     3.8147e+25             0.0000e+00       -22.818669674585

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1674
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1882e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8693
    reference variance = 0.335016
====================================================
  Execution time = 2.5310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9173e-01
  Total weights = 1.963705716e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474701329481
                                         uncertainty =       0.003821205882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474701329481
                                         uncertainty =       0.003821205882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487240141
  error estimate for blocks of size 2^( 2) =       0.000508444516
  error estimate for blocks of size 2^( 3) =       0.000528695642
  error estimate for blocks of size 2^( 4) =       0.000544132530
  error estimate for blocks of size 2^( 5) =       0.000554073799
  error estimate for blocks of size 2^( 6) =       0.000557766322
  error estimate for blocks of size 2^( 7) =       0.000560406714

      target function =                  N/A
              le_mean =     -22.818702189084
             les_mean =     521.184894865881
             stat err =       0.000554094841
             autocorr =       1.293248827643
              std dev =       0.689061615299
             le_variance =       0.474805909678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281870218908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818702189028       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818702189028       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818702189028       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818702189028       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818702189028       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818702189028       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9801e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8051
    reference variance = 0.308933
====================================================
  Execution time = 2.4559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8506e-01
  Total weights = 1.9641e+06
  Execution time = 3.4774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484847110
  error estimate for blocks of size 2^( 2) =       0.000505744419
  error estimate for blocks of size 2^( 3) =       0.000525645498
  error estimate for blocks of size 2^( 4) =       0.000541001514
  error estimate for blocks of size 2^( 5) =       0.000550525175
  error estimate for blocks of size 2^( 6) =       0.000554947860
  error estimate for blocks of size 2^( 7) =       0.000557295430

      target function =                  N/A
              le_mean =     -22.819686227801
             les_mean =     521.223139315214
             stat err =       0.000550942495
             autocorr =       1.291227953987
              std dev =       0.685677358702
             le_variance =       0.470153440236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484847110
  error estimate for blocks of size 2^( 2) =       0.000505744419
  error estimate for blocks of size 2^( 3) =       0.000525645498
  error estimate for blocks of size 2^( 4) =       0.000541001514
  error estimate for blocks of size 2^( 5) =       0.000550525175
  error estimate for blocks of size 2^( 6) =       0.000554947860
  error estimate for blocks of size 2^( 7) =       0.000557295430

      target function =                  N/A
              le_mean =     -22.819686227801
             les_mean =     521.223139315214
             stat err =       0.000550942495
             autocorr =       1.291227953987
              std dev =       0.685677358702
             le_variance =       0.470153440236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484847110
  error estimate for blocks of size 2^( 2) =       0.000505744419
  error estimate for blocks of size 2^( 3) =       0.000525645498
  error estimate for blocks of size 2^( 4) =       0.000541001514
  error estimate for blocks of size 2^( 5) =       0.000550525175
  error estimate for blocks of size 2^( 6) =       0.000554947860
  error estimate for blocks of size 2^( 7) =       0.000557295430

      target function =                  N/A
              le_mean =     -22.819686227801
             les_mean =     521.223139315214
             stat err =       0.000550942495
             autocorr =       1.291227953987
              std dev =       0.685677358702
             le_variance =       0.470153440236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470143649551
                                         uncertainty =       0.002381978028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484847110
  error estimate for blocks of size 2^( 2) =       0.000505744419
  error estimate for blocks of size 2^( 3) =       0.000525645498
  error estimate for blocks of size 2^( 4) =       0.000541001514
  error estimate for blocks of size 2^( 5) =       0.000550525175
  error estimate for blocks of size 2^( 6) =       0.000554947860
  error estimate for blocks of size 2^( 7) =       0.000557295430

      target function =                  N/A
              le_mean =     -22.819686227801
             les_mean =     521.223139315214
             stat err =       0.000550942495
             autocorr =       1.291227953987
              std dev =       0.685677358702
             le_variance =       0.470153440236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819686227801        initial  <--
     2.3842e+24     2.3842e+25             0.0000e+00       -22.819686227801
     9.5367e+24     9.5367e+25             0.0000e+00       -22.819686227801
     3.8147e+25     3.8147e+26             0.0000e+00       -22.819686227801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3772
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7763
    reference variance = 0.411019
====================================================
  Execution time = 2.5526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8527e-01
  Total weights = 1.963722399e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473027726696
                                         uncertainty =       0.003314178728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473027726696
                                         uncertainty =       0.003314178728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486308809
  error estimate for blocks of size 2^( 2) =       0.000507920368
  error estimate for blocks of size 2^( 3) =       0.000527913050
  error estimate for blocks of size 2^( 4) =       0.000543168708
  error estimate for blocks of size 2^( 5) =       0.000554269933
  error estimate for blocks of size 2^( 6) =       0.000559782884
  error estimate for blocks of size 2^( 7) =       0.000560932322

      target function =                  N/A
              le_mean =     -22.819850423910
             les_mean =     521.230844692316
             stat err =       0.000554538462
             autocorr =       1.300286561757
              std dev =       0.687744512839
             le_variance =       0.472992514940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281985042391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819850423828       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819850423828       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819850423828       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819850423828       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819850423828       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819850423828       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0031e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7953
    reference variance = 0.389882
====================================================
  Execution time = 2.4720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8468e-01
  Total weights = 1.9636e+06
  Execution time = 3.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485508046
  error estimate for blocks of size 2^( 2) =       0.000506974508
  error estimate for blocks of size 2^( 3) =       0.000528095855
  error estimate for blocks of size 2^( 4) =       0.000543731550
  error estimate for blocks of size 2^( 5) =       0.000553819124
  error estimate for blocks of size 2^( 6) =       0.000558783887
  error estimate for blocks of size 2^( 7) =       0.000562409928

      target function =                  N/A
              le_mean =     -22.818663634336
             les_mean =     521.176091051247
             stat err =       0.000554686122
             autocorr =       1.305274150409
              std dev =       0.686612063320
             le_variance =       0.471436125496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485508046
  error estimate for blocks of size 2^( 2) =       0.000506974508
  error estimate for blocks of size 2^( 3) =       0.000528095855
  error estimate for blocks of size 2^( 4) =       0.000543731550
  error estimate for blocks of size 2^( 5) =       0.000553819124
  error estimate for blocks of size 2^( 6) =       0.000558783887
  error estimate for blocks of size 2^( 7) =       0.000562409928

      target function =                  N/A
              le_mean =     -22.818663634336
             les_mean =     521.176091051247
             stat err =       0.000554686122
             autocorr =       1.305274150409
              std dev =       0.686612063320
             le_variance =       0.471436125496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485508046
  error estimate for blocks of size 2^( 2) =       0.000506974508
  error estimate for blocks of size 2^( 3) =       0.000528095855
  error estimate for blocks of size 2^( 4) =       0.000543731550
  error estimate for blocks of size 2^( 5) =       0.000553819124
  error estimate for blocks of size 2^( 6) =       0.000558783887
  error estimate for blocks of size 2^( 7) =       0.000562409928

      target function =                  N/A
              le_mean =     -22.818663634336
             les_mean =     521.176091051247
             stat err =       0.000554686122
             autocorr =       1.305274150409
              std dev =       0.686612063320
             le_variance =       0.471436125496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471520027931
                                         uncertainty =       0.002690970333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485508046
  error estimate for blocks of size 2^( 2) =       0.000506974508
  error estimate for blocks of size 2^( 3) =       0.000528095855
  error estimate for blocks of size 2^( 4) =       0.000543731550
  error estimate for blocks of size 2^( 5) =       0.000553819124
  error estimate for blocks of size 2^( 6) =       0.000558783887
  error estimate for blocks of size 2^( 7) =       0.000562409928

      target function =                  N/A
              le_mean =     -22.818663634336
             les_mean =     521.176091051247
             stat err =       0.000554686122
             autocorr =       1.305274150409
              std dev =       0.686612063320
             le_variance =       0.471436125496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818663634336        initial  <--
     2.3842e+25     2.3842e+26             0.0000e+00       -22.818663634336
     9.5367e+25     9.5367e+26             0.0000e+00       -22.818663634336
     3.8147e+26     3.8147e+27             0.0000e+00       -22.818663634336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2624
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2299e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.9682
    reference variance = 0.687874
====================================================
  Execution time = 2.5424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8441e-01
  Total weights = 1.963674129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470841770644
                                         uncertainty =       0.002717663165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470841770644
                                         uncertainty =       0.002717663165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485173881
  error estimate for blocks of size 2^( 2) =       0.000506435195
  error estimate for blocks of size 2^( 3) =       0.000526253766
  error estimate for blocks of size 2^( 4) =       0.000541203618
  error estimate for blocks of size 2^( 5) =       0.000551851568
  error estimate for blocks of size 2^( 6) =       0.000557753571
  error estimate for blocks of size 2^( 7) =       0.000560960493

      target function =                  N/A
              le_mean =     -22.820393241139
             les_mean =     521.254757623506
             stat err =       0.000552942313
             autocorr =       1.298867421859
              std dev =       0.686139482302
             le_variance =       0.470787389173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282039324114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820393241056       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820393241056       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820393241056       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820393241056       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820393241056       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820393241056       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9920e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8026
    reference variance = 0.222281
====================================================
  Execution time = 2.4719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8198e-01
  Total weights = 1.9638e+06
  Execution time = 3.4761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484589242
  error estimate for blocks of size 2^( 2) =       0.000506017463
  error estimate for blocks of size 2^( 3) =       0.000526531258
  error estimate for blocks of size 2^( 4) =       0.000541322508
  error estimate for blocks of size 2^( 5) =       0.000550281251
  error estimate for blocks of size 2^( 6) =       0.000556449921
  error estimate for blocks of size 2^( 7) =       0.000558841135

      target function =                  N/A
              le_mean =     -22.819341873138
             les_mean =     521.204346653573
             stat err =       0.000551723704
             autocorr =       1.296270832894
              std dev =       0.685312678107
             le_variance =       0.469653466775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484589242
  error estimate for blocks of size 2^( 2) =       0.000506017463
  error estimate for blocks of size 2^( 3) =       0.000526531258
  error estimate for blocks of size 2^( 4) =       0.000541322508
  error estimate for blocks of size 2^( 5) =       0.000550281251
  error estimate for blocks of size 2^( 6) =       0.000556449921
  error estimate for blocks of size 2^( 7) =       0.000558841135

      target function =                  N/A
              le_mean =     -22.819341873138
             les_mean =     521.204346653573
             stat err =       0.000551723704
             autocorr =       1.296270832894
              std dev =       0.685312678107
             le_variance =       0.469653466775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484589242
  error estimate for blocks of size 2^( 2) =       0.000506017463
  error estimate for blocks of size 2^( 3) =       0.000526531258
  error estimate for blocks of size 2^( 4) =       0.000541322508
  error estimate for blocks of size 2^( 5) =       0.000550281251
  error estimate for blocks of size 2^( 6) =       0.000556449921
  error estimate for blocks of size 2^( 7) =       0.000558841135

      target function =                  N/A
              le_mean =     -22.819341873138
             les_mean =     521.204346653573
             stat err =       0.000551723704
             autocorr =       1.296270832894
              std dev =       0.685312678107
             le_variance =       0.469653466775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469694764591
                                         uncertainty =       0.002274358548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484589242
  error estimate for blocks of size 2^( 2) =       0.000506017463
  error estimate for blocks of size 2^( 3) =       0.000526531258
  error estimate for blocks of size 2^( 4) =       0.000541322508
  error estimate for blocks of size 2^( 5) =       0.000550281251
  error estimate for blocks of size 2^( 6) =       0.000556449921
  error estimate for blocks of size 2^( 7) =       0.000558841135

      target function =                  N/A
              le_mean =     -22.819341873138
             les_mean =     521.204346653573
             stat err =       0.000551723704
             autocorr =       1.296270832894
              std dev =       0.685312678107
             le_variance =       0.469653466775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819341873138        initial  <--
     2.3842e+26     2.3842e+27             0.0000e+00       -22.819341873138
     9.5367e+26     9.5367e+27             0.0000e+00       -22.819341873138
     3.8147e+27     3.8147e+28             0.0000e+00       -22.819341873138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2315
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8431
    reference variance = 0.244802
====================================================
  Execution time = 2.5465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9651e-01
  Total weights = 1.963943621e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478076905503
                                         uncertainty =       0.003715636096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478076905503
                                         uncertainty =       0.003715636096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488908042
  error estimate for blocks of size 2^( 2) =       0.000510207827
  error estimate for blocks of size 2^( 3) =       0.000530043740
  error estimate for blocks of size 2^( 4) =       0.000544814527
  error estimate for blocks of size 2^( 5) =       0.000554513674
  error estimate for blocks of size 2^( 6) =       0.000560416690
  error estimate for blocks of size 2^( 7) =       0.000563864556

      target function =                  N/A
              le_mean =     -22.819825541430
             les_mean =     521.240952087232
             stat err =       0.000555902362
             autocorr =       1.292833733041
              std dev =       0.691420384241
             le_variance =       0.478062147744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281982554143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819825541375       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819825541375       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819825541375       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819825541375       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819825541375       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819825541375       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9955e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7262
    reference variance = 0.363856
====================================================
  Execution time = 2.4706e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8560e-01
  Total weights = 1.9636e+06
  Execution time = 3.4728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484814152
  error estimate for blocks of size 2^( 2) =       0.000506050102
  error estimate for blocks of size 2^( 3) =       0.000525716553
  error estimate for blocks of size 2^( 4) =       0.000540967688
  error estimate for blocks of size 2^( 5) =       0.000549907121
  error estimate for blocks of size 2^( 6) =       0.000554700904
  error estimate for blocks of size 2^( 7) =       0.000555306770

      target function =                  N/A
              le_mean =     -22.819578013898
             les_mean =     521.218737413278
             stat err =       0.000550220621
             autocorr =       1.288021602763
              std dev =       0.685630749605
             le_variance =       0.470089524804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484814152
  error estimate for blocks of size 2^( 2) =       0.000506050102
  error estimate for blocks of size 2^( 3) =       0.000525716553
  error estimate for blocks of size 2^( 4) =       0.000540967688
  error estimate for blocks of size 2^( 5) =       0.000549907121
  error estimate for blocks of size 2^( 6) =       0.000554700904
  error estimate for blocks of size 2^( 7) =       0.000555306770

      target function =                  N/A
              le_mean =     -22.819578013898
             les_mean =     521.218737413278
             stat err =       0.000550220621
             autocorr =       1.288021602763
              std dev =       0.685630749605
             le_variance =       0.470089524804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484814152
  error estimate for blocks of size 2^( 2) =       0.000506050102
  error estimate for blocks of size 2^( 3) =       0.000525716553
  error estimate for blocks of size 2^( 4) =       0.000540967688
  error estimate for blocks of size 2^( 5) =       0.000549907121
  error estimate for blocks of size 2^( 6) =       0.000554700904
  error estimate for blocks of size 2^( 7) =       0.000555306770

      target function =                  N/A
              le_mean =     -22.819578013898
             les_mean =     521.218737413278
             stat err =       0.000550220621
             autocorr =       1.288021602763
              std dev =       0.685630749605
             le_variance =       0.470089524804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470110819629
                                         uncertainty =       0.002038067656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484814152
  error estimate for blocks of size 2^( 2) =       0.000506050102
  error estimate for blocks of size 2^( 3) =       0.000525716553
  error estimate for blocks of size 2^( 4) =       0.000540967688
  error estimate for blocks of size 2^( 5) =       0.000549907121
  error estimate for blocks of size 2^( 6) =       0.000554700904
  error estimate for blocks of size 2^( 7) =       0.000555306770

      target function =                  N/A
              le_mean =     -22.819578013898
             les_mean =     521.218737413278
             stat err =       0.000550220621
             autocorr =       1.288021602763
              std dev =       0.685630749605
             le_variance =       0.470089524804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819578013898        initial  <--
     2.3842e+27     2.3842e+28             0.0000e+00       -22.819578013898
     9.5367e+27     9.5367e+28             0.0000e+00       -22.819578013898
     3.8147e+28     3.8147e+29             0.0000e+00       -22.819578013898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2868
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8201
    reference variance = 0.473742
====================================================
  Execution time = 2.5350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8366e-01
  Total weights = 1.963607085e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468636521655
                                         uncertainty =       0.002139520129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468636521655
                                         uncertainty =       0.002139520129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484058094
  error estimate for blocks of size 2^( 2) =       0.000505178463
  error estimate for blocks of size 2^( 3) =       0.000525411773
  error estimate for blocks of size 2^( 4) =       0.000540234923
  error estimate for blocks of size 2^( 5) =       0.000548887917
  error estimate for blocks of size 2^( 6) =       0.000554422707
  error estimate for blocks of size 2^( 7) =       0.000558888407

      target function =                  N/A
              le_mean =     -22.819228959322
             les_mean =     521.200868233015
             stat err =       0.000550608488
             autocorr =       1.293870559912
              std dev =       0.684561521970
             le_variance =       0.468624477362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281922895932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819228959274       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819228959274       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819228959274       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819228959274       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819228959274       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819228959274       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9837e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.7702
    reference variance = 0.446065
====================================================
  Execution time = 2.4704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8533e-01
  Total weights = 1.9637e+06
  Execution time = 3.4798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483673233
  error estimate for blocks of size 2^( 2) =       0.000504799148
  error estimate for blocks of size 2^( 3) =       0.000525228213
  error estimate for blocks of size 2^( 4) =       0.000540374426
  error estimate for blocks of size 2^( 5) =       0.000548522197
  error estimate for blocks of size 2^( 6) =       0.000554118245
  error estimate for blocks of size 2^( 7) =       0.000555575352

      target function =                  N/A
              le_mean =     -22.818453670330
             les_mean =     521.167159234547
             stat err =       0.000549647555
             autocorr =       1.291411036422
              std dev =       0.684017245561
             le_variance =       0.467879592225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483673233
  error estimate for blocks of size 2^( 2) =       0.000504799148
  error estimate for blocks of size 2^( 3) =       0.000525228213
  error estimate for blocks of size 2^( 4) =       0.000540374426
  error estimate for blocks of size 2^( 5) =       0.000548522197
  error estimate for blocks of size 2^( 6) =       0.000554118245
  error estimate for blocks of size 2^( 7) =       0.000555575352

      target function =                  N/A
              le_mean =     -22.818453670330
             les_mean =     521.167159234547
             stat err =       0.000549647555
             autocorr =       1.291411036422
              std dev =       0.684017245561
             le_variance =       0.467879592225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483673233
  error estimate for blocks of size 2^( 2) =       0.000504799148
  error estimate for blocks of size 2^( 3) =       0.000525228213
  error estimate for blocks of size 2^( 4) =       0.000540374426
  error estimate for blocks of size 2^( 5) =       0.000548522197
  error estimate for blocks of size 2^( 6) =       0.000554118245
  error estimate for blocks of size 2^( 7) =       0.000555575352

      target function =                  N/A
              le_mean =     -22.818453670330
             les_mean =     521.167159234547
             stat err =       0.000549647555
             autocorr =       1.291411036422
              std dev =       0.684017245561
             le_variance =       0.467879592225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467871806074
                                         uncertainty =       0.002132126986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483673233
  error estimate for blocks of size 2^( 2) =       0.000504799148
  error estimate for blocks of size 2^( 3) =       0.000525228213
  error estimate for blocks of size 2^( 4) =       0.000540374426
  error estimate for blocks of size 2^( 5) =       0.000548522197
  error estimate for blocks of size 2^( 6) =       0.000554118245
  error estimate for blocks of size 2^( 7) =       0.000555575352

      target function =                  N/A
              le_mean =     -22.818453670330
             les_mean =     521.167159234547
             stat err =       0.000549647555
             autocorr =       1.291411036422
              std dev =       0.684017245561
             le_variance =       0.467879592225


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818453670330        initial  <--
     2.3842e+28     2.3842e+29             0.0000e+00       -22.818453670330
     9.5367e+28     9.5367e+29             0.0000e+00       -22.818453670330
     3.8147e+29     3.8147e+30             0.0000e+00       -22.818453670330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1751
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8333
    reference variance = 0.443983
====================================================
  Execution time = 2.7213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9040e-01
  Total weights = 1.963568491e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474220071243
                                         uncertainty =       0.003950483833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474220071243
                                         uncertainty =       0.003950483833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486898501
  error estimate for blocks of size 2^( 2) =       0.000507935724
  error estimate for blocks of size 2^( 3) =       0.000528218116
  error estimate for blocks of size 2^( 4) =       0.000543925107
  error estimate for blocks of size 2^( 5) =       0.000553313410
  error estimate for blocks of size 2^( 6) =       0.000560172693
  error estimate for blocks of size 2^( 7) =       0.000562038918

      target function =                  N/A
              le_mean =     -22.819620264309
             les_mean =     521.225469283113
             stat err =       0.000554862532
             autocorr =       1.298655393341
              std dev =       0.688578463546
             le_variance =       0.474140300459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281962026431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+29, overlap shift 2.3842e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819620264289       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819620264289       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819620264287       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+29 is 1.845487e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819620264289       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819620264289       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819620264345       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+29 is 4.613716e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819620264289       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819620264289       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819620264228       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+30 is 1.153429e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1710e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8147
    reference variance = 0.382771
====================================================
  Execution time = 2.4808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8790e-01
  Total weights = 1.9634e+06
  Execution time = 3.4792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486039308
  error estimate for blocks of size 2^( 2) =       0.000507200402
  error estimate for blocks of size 2^( 3) =       0.000527556399
  error estimate for blocks of size 2^( 4) =       0.000542025754
  error estimate for blocks of size 2^( 5) =       0.000551950353
  error estimate for blocks of size 2^( 6) =       0.000557235731
  error estimate for blocks of size 2^( 7) =       0.000560756827

      target function =                  N/A
              le_mean =     -22.819958587757
             les_mean =     521.238414861521
             stat err =       0.000552992166
             autocorr =       1.294479483155
              std dev =       0.687363380566
             le_variance =       0.472468416943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486039308
  error estimate for blocks of size 2^( 2) =       0.000507200402
  error estimate for blocks of size 2^( 3) =       0.000527556399
  error estimate for blocks of size 2^( 4) =       0.000542025754
  error estimate for blocks of size 2^( 5) =       0.000551950353
  error estimate for blocks of size 2^( 6) =       0.000557235731
  error estimate for blocks of size 2^( 7) =       0.000560756827

      target function =                  N/A
              le_mean =     -22.819958587757
             les_mean =     521.238414861521
             stat err =       0.000552992166
             autocorr =       1.294479483155
              std dev =       0.687363380566
             le_variance =       0.472468416943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486039308
  error estimate for blocks of size 2^( 2) =       0.000507200402
  error estimate for blocks of size 2^( 3) =       0.000527556399
  error estimate for blocks of size 2^( 4) =       0.000542025754
  error estimate for blocks of size 2^( 5) =       0.000551950353
  error estimate for blocks of size 2^( 6) =       0.000557235731
  error estimate for blocks of size 2^( 7) =       0.000560756827

      target function =                  N/A
              le_mean =     -22.819958587757
             les_mean =     521.238414861521
             stat err =       0.000552992166
             autocorr =       1.294479483155
              std dev =       0.687363380566
             le_variance =       0.472468416943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472505269914
                                         uncertainty =       0.002309351263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486039308
  error estimate for blocks of size 2^( 2) =       0.000507200402
  error estimate for blocks of size 2^( 3) =       0.000527556399
  error estimate for blocks of size 2^( 4) =       0.000542025754
  error estimate for blocks of size 2^( 5) =       0.000551950353
  error estimate for blocks of size 2^( 6) =       0.000557235731
  error estimate for blocks of size 2^( 7) =       0.000560756827

      target function =                  N/A
              le_mean =     -22.819958587757
             les_mean =     521.238414861521
             stat err =       0.000552992166
             autocorr =       1.294479483155
              std dev =       0.687363380566
             le_variance =       0.472468416943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819958587757        initial  <--
     2.3842e+29     2.3842e+30             1.8455e-33       -22.819958587757
     9.5367e+29     9.5367e+30             4.6137e-34       -22.819958587757
     3.8147e+30     3.8147e+31             1.1534e-34       -22.819958587757

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4051
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.802
    reference variance = 0.807514
====================================================
  Execution time = 2.5342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5391e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8885e-01
  Total weights = 1.963781299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471878968670
                                         uncertainty =       0.002391039744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471878968670
                                         uncertainty =       0.002391039744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485709475
  error estimate for blocks of size 2^( 2) =       0.000507067089
  error estimate for blocks of size 2^( 3) =       0.000527692565
  error estimate for blocks of size 2^( 4) =       0.000542954461
  error estimate for blocks of size 2^( 5) =       0.000552614281
  error estimate for blocks of size 2^( 6) =       0.000554857111
  error estimate for blocks of size 2^( 7) =       0.000557695104

      target function =                  N/A
              le_mean =     -22.819222937081
             les_mean =     521.205782858792
             stat err =       0.000552030239
             autocorr =       1.291732496342
              std dev =       0.686896926957
             le_variance =       0.471827388263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281922293708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+30, overlap shift 2.3842e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819222937029       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819222937029       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819222937029       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819222937029       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819222937029       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819222937029       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9840e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8158
    reference variance = 0.467746
====================================================
  Execution time = 2.4845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9011e-01
  Total weights = 1.9633e+06
  Execution time = 3.4828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486197547
  error estimate for blocks of size 2^( 2) =       0.000507671448
  error estimate for blocks of size 2^( 3) =       0.000528275662
  error estimate for blocks of size 2^( 4) =       0.000544917083
  error estimate for blocks of size 2^( 5) =       0.000554909987
  error estimate for blocks of size 2^( 6) =       0.000559845729
  error estimate for blocks of size 2^( 7) =       0.000564004527

      target function =                  N/A
              le_mean =     -22.818863304209
             les_mean =     521.190629273232
             stat err =       0.000555919332
             autocorr =       1.307368527346
              std dev =       0.687587165238
             le_variance =       0.472776109800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486197547
  error estimate for blocks of size 2^( 2) =       0.000507671448
  error estimate for blocks of size 2^( 3) =       0.000528275662
  error estimate for blocks of size 2^( 4) =       0.000544917083
  error estimate for blocks of size 2^( 5) =       0.000554909987
  error estimate for blocks of size 2^( 6) =       0.000559845729
  error estimate for blocks of size 2^( 7) =       0.000564004527

      target function =                  N/A
              le_mean =     -22.818863304209
             les_mean =     521.190629273232
             stat err =       0.000555919332
             autocorr =       1.307368527346
              std dev =       0.687587165238
             le_variance =       0.472776109800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486197547
  error estimate for blocks of size 2^( 2) =       0.000507671448
  error estimate for blocks of size 2^( 3) =       0.000528275662
  error estimate for blocks of size 2^( 4) =       0.000544917083
  error estimate for blocks of size 2^( 5) =       0.000554909987
  error estimate for blocks of size 2^( 6) =       0.000559845729
  error estimate for blocks of size 2^( 7) =       0.000564004527

      target function =                  N/A
              le_mean =     -22.818863304209
             les_mean =     521.190629273232
             stat err =       0.000555919332
             autocorr =       1.307368527346
              std dev =       0.687587165238
             le_variance =       0.472776109800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472860984700
                                         uncertainty =       0.002709703461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486197547
  error estimate for blocks of size 2^( 2) =       0.000507671448
  error estimate for blocks of size 2^( 3) =       0.000528275662
  error estimate for blocks of size 2^( 4) =       0.000544917083
  error estimate for blocks of size 2^( 5) =       0.000554909987
  error estimate for blocks of size 2^( 6) =       0.000559845729
  error estimate for blocks of size 2^( 7) =       0.000564004527

      target function =                  N/A
              le_mean =     -22.818863304209
             les_mean =     521.190629273232
             stat err =       0.000555919332
             autocorr =       1.307368527346
              std dev =       0.687587165238
             le_variance =       0.472776109800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818863304209        initial  <--
     2.3842e+30     2.3842e+31             0.0000e+00       -22.818863304209
     9.5367e+30     9.5367e+31             0.0000e+00       -22.818863304209
     3.8147e+31     3.8147e+32             0.0000e+00       -22.818863304209

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3921
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8154
    reference variance = 0.65105
====================================================
  Execution time = 2.5459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8883e-01
  Total weights = 1.963750477e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473478101491
                                         uncertainty =       0.002621454173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473478101491
                                         uncertainty =       0.002621454173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486529819
  error estimate for blocks of size 2^( 2) =       0.000507721726
  error estimate for blocks of size 2^( 3) =       0.000527623558
  error estimate for blocks of size 2^( 4) =       0.000542661806
  error estimate for blocks of size 2^( 5) =       0.000551914604
  error estimate for blocks of size 2^( 6) =       0.000556968069
  error estimate for blocks of size 2^( 7) =       0.000560696922

      target function =                  N/A
              le_mean =     -22.819885459590
             les_mean =     521.236005432635
             stat err =       0.000553060350
             autocorr =       1.292189244927
              std dev =       0.688057069085
             le_variance =       0.473422530318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281988545959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+31, overlap shift 2.3842e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819885459542       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819885459542       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819885459542       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819885459542       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819885459542       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819885459542       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9945e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.8763
    reference variance = 0.393569
====================================================
  Execution time = 2.4652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8891e-01
  Total weights = 1.9635e+06
  Execution time = 3.5294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486211759
  error estimate for blocks of size 2^( 2) =       0.000507550188
  error estimate for blocks of size 2^( 3) =       0.000528085664
  error estimate for blocks of size 2^( 4) =       0.000543899394
  error estimate for blocks of size 2^( 5) =       0.000553340069
  error estimate for blocks of size 2^( 6) =       0.000558703951
  error estimate for blocks of size 2^( 7) =       0.000563381603

      target function =                  N/A
              le_mean =     -22.818356640410
             les_mean =     521.166311818073
             stat err =       0.000554831254
             autocorr =       1.302179693499
              std dev =       0.687607263956
             le_variance =       0.472803749445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486211759
  error estimate for blocks of size 2^( 2) =       0.000507550188
  error estimate for blocks of size 2^( 3) =       0.000528085664
  error estimate for blocks of size 2^( 4) =       0.000543899394
  error estimate for blocks of size 2^( 5) =       0.000553340069
  error estimate for blocks of size 2^( 6) =       0.000558703951
  error estimate for blocks of size 2^( 7) =       0.000563381603

      target function =                  N/A
              le_mean =     -22.818356640410
             les_mean =     521.166311818073
             stat err =       0.000554831254
             autocorr =       1.302179693499
              std dev =       0.687607263956
             le_variance =       0.472803749445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486211759
  error estimate for blocks of size 2^( 2) =       0.000507550188
  error estimate for blocks of size 2^( 3) =       0.000528085664
  error estimate for blocks of size 2^( 4) =       0.000543899394
  error estimate for blocks of size 2^( 5) =       0.000553340069
  error estimate for blocks of size 2^( 6) =       0.000558703951
  error estimate for blocks of size 2^( 7) =       0.000563381603

      target function =                  N/A
              le_mean =     -22.818356640410
             les_mean =     521.166311818073
             stat err =       0.000554831254
             autocorr =       1.302179693499
              std dev =       0.687607263956
             le_variance =       0.472803749445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472884362704
                                         uncertainty =       0.002671712527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486211759
  error estimate for blocks of size 2^( 2) =       0.000507550188
  error estimate for blocks of size 2^( 3) =       0.000528085664
  error estimate for blocks of size 2^( 4) =       0.000543899394
  error estimate for blocks of size 2^( 5) =       0.000553340069
  error estimate for blocks of size 2^( 6) =       0.000558703951
  error estimate for blocks of size 2^( 7) =       0.000563381603

      target function =                  N/A
              le_mean =     -22.818356640410
             les_mean =     521.166311818073
             stat err =       0.000554831254
             autocorr =       1.302179693499
              std dev =       0.687607263956
             le_variance =       0.472803749445


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818356640410        initial  <--
     2.3842e+31     2.3842e+32             0.0000e+00       -22.818356640410
     9.5367e+31     9.5367e+32             0.0000e+00       -22.818356640410
     3.8147e+32     3.8147e+33             0.0000e+00       -22.818356640410

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2441
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7977
    reference variance = 0.337438
====================================================
  Execution time = 2.5359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5352e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8285e-01
  Total weights = 1.963587657e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468923418711
                                         uncertainty =       0.002244551740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468923418711
                                         uncertainty =       0.002244551740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484196025
  error estimate for blocks of size 2^( 2) =       0.000505434820
  error estimate for blocks of size 2^( 3) =       0.000526041747
  error estimate for blocks of size 2^( 4) =       0.000541010061
  error estimate for blocks of size 2^( 5) =       0.000550565234
  error estimate for blocks of size 2^( 6) =       0.000556406409
  error estimate for blocks of size 2^( 7) =       0.000559403617

      target function =                  N/A
              le_mean =     -22.819269834969
             les_mean =     521.201928296699
             stat err =       0.000551846330
             autocorr =       1.298954317619
              std dev =       0.684756585438
             le_variance =       0.468891581301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281926983497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+32, overlap shift 2.3842e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819269834896       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819269834896       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819269834896       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819269834896       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819269834896       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819269834896       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9865e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8877
    reference variance = 0.366188
====================================================
  Execution time = 2.4867e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9043e-01
  Total weights = 1.9636e+06
  Execution time = 3.4840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485713870
  error estimate for blocks of size 2^( 2) =       0.000507682557
  error estimate for blocks of size 2^( 3) =       0.000528378494
  error estimate for blocks of size 2^( 4) =       0.000544416949
  error estimate for blocks of size 2^( 5) =       0.000554300881
  error estimate for blocks of size 2^( 6) =       0.000559413126
  error estimate for blocks of size 2^( 7) =       0.000560424671

      target function =                  N/A
              le_mean =     -22.819852509563
             les_mean =     521.236093570971
             stat err =       0.000554638907
             autocorr =       1.303946132985
              std dev =       0.686903143020
             le_variance =       0.471835927891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485713870
  error estimate for blocks of size 2^( 2) =       0.000507682557
  error estimate for blocks of size 2^( 3) =       0.000528378494
  error estimate for blocks of size 2^( 4) =       0.000544416949
  error estimate for blocks of size 2^( 5) =       0.000554300881
  error estimate for blocks of size 2^( 6) =       0.000559413126
  error estimate for blocks of size 2^( 7) =       0.000560424671

      target function =                  N/A
              le_mean =     -22.819852509563
             les_mean =     521.236093570971
             stat err =       0.000554638907
             autocorr =       1.303946132985
              std dev =       0.686903143020
             le_variance =       0.471835927891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485713870
  error estimate for blocks of size 2^( 2) =       0.000507682557
  error estimate for blocks of size 2^( 3) =       0.000528378494
  error estimate for blocks of size 2^( 4) =       0.000544416949
  error estimate for blocks of size 2^( 5) =       0.000554300881
  error estimate for blocks of size 2^( 6) =       0.000559413126
  error estimate for blocks of size 2^( 7) =       0.000560424671

      target function =                  N/A
              le_mean =     -22.819852509563
             les_mean =     521.236093570971
             stat err =       0.000554638907
             autocorr =       1.303946132985
              std dev =       0.686903143020
             le_variance =       0.471835927891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471825642950
                                         uncertainty =       0.002589914127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485713870
  error estimate for blocks of size 2^( 2) =       0.000507682557
  error estimate for blocks of size 2^( 3) =       0.000528378494
  error estimate for blocks of size 2^( 4) =       0.000544416949
  error estimate for blocks of size 2^( 5) =       0.000554300881
  error estimate for blocks of size 2^( 6) =       0.000559413126
  error estimate for blocks of size 2^( 7) =       0.000560424671

      target function =                  N/A
              le_mean =     -22.819852509563
             les_mean =     521.236093570971
             stat err =       0.000554638907
             autocorr =       1.303946132985
              std dev =       0.686903143020
             le_variance =       0.471835927891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819852509563        initial  <--
     2.3842e+32     2.3842e+33             0.0000e+00       -22.819852509563
     9.5367e+32     9.5367e+33             0.0000e+00       -22.819852509563
     3.8147e+33     3.8147e+34             0.0000e+00       -22.819852509563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3443
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7365
    reference variance = 0.405168
====================================================
  Execution time = 2.7314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8424e-01
  Total weights = 1.963889540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468366022691
                                         uncertainty =       0.002539548395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468366022691
                                         uncertainty =       0.002539548395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483887314
  error estimate for blocks of size 2^( 2) =       0.000505694169
  error estimate for blocks of size 2^( 3) =       0.000526150466
  error estimate for blocks of size 2^( 4) =       0.000542128458
  error estimate for blocks of size 2^( 5) =       0.000551235297
  error estimate for blocks of size 2^( 6) =       0.000556107863
  error estimate for blocks of size 2^( 7) =       0.000562148816

      target function =                  N/A
              le_mean =     -22.818755933708
             les_mean =     521.179864427226
             stat err =       0.000552905109
             autocorr =       1.305607788140
              std dev =       0.684320002324
             le_variance =       0.468293865581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281875593371e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+33, overlap shift 2.3842e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818755933625       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818755933625       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818755933625       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818755933625       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818755933625       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818755933625       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141376 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1841e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.8325
    reference variance = 0.223612
====================================================
  Execution time = 2.4712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8853e-01
  Total weights = 1.9633e+06
  Execution time = 3.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485658928
  error estimate for blocks of size 2^( 2) =       0.000507086997
  error estimate for blocks of size 2^( 3) =       0.000528113034
  error estimate for blocks of size 2^( 4) =       0.000543987106
  error estimate for blocks of size 2^( 5) =       0.000554220936
  error estimate for blocks of size 2^( 6) =       0.000559920040
  error estimate for blocks of size 2^( 7) =       0.000562862574

      target function =                  N/A
              le_mean =     -22.819787031643
             les_mean =     521.231214777099
             stat err =       0.000555247664
             autocorr =       1.307105756040
              std dev =       0.686825442026
             le_variance =       0.471729187815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485658928
  error estimate for blocks of size 2^( 2) =       0.000507086997
  error estimate for blocks of size 2^( 3) =       0.000528113034
  error estimate for blocks of size 2^( 4) =       0.000543987106
  error estimate for blocks of size 2^( 5) =       0.000554220936
  error estimate for blocks of size 2^( 6) =       0.000559920040
  error estimate for blocks of size 2^( 7) =       0.000562862574

      target function =                  N/A
              le_mean =     -22.819787031643
             les_mean =     521.231214777099
             stat err =       0.000555247664
             autocorr =       1.307105756040
              std dev =       0.686825442026
             le_variance =       0.471729187815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485658928
  error estimate for blocks of size 2^( 2) =       0.000507086997
  error estimate for blocks of size 2^( 3) =       0.000528113034
  error estimate for blocks of size 2^( 4) =       0.000543987106
  error estimate for blocks of size 2^( 5) =       0.000554220936
  error estimate for blocks of size 2^( 6) =       0.000559920040
  error estimate for blocks of size 2^( 7) =       0.000562862574

      target function =                  N/A
              le_mean =     -22.819787031643
             les_mean =     521.231214777099
             stat err =       0.000555247664
             autocorr =       1.307105756040
              std dev =       0.686825442026
             le_variance =       0.471729187815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471684462607
                                         uncertainty =       0.002673184948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485658928
  error estimate for blocks of size 2^( 2) =       0.000507086997
  error estimate for blocks of size 2^( 3) =       0.000528113034
  error estimate for blocks of size 2^( 4) =       0.000543987106
  error estimate for blocks of size 2^( 5) =       0.000554220936
  error estimate for blocks of size 2^( 6) =       0.000559920040
  error estimate for blocks of size 2^( 7) =       0.000562862574

      target function =                  N/A
              le_mean =     -22.819787031643
             les_mean =     521.231214777099
             stat err =       0.000555247664
             autocorr =       1.307105756040
              std dev =       0.686825442026
             le_variance =       0.471729187815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819787031643        initial  <--
     2.3842e+33     2.3842e+34             0.0000e+00       -22.819787031643
     9.5367e+33     9.5367e+34             0.0000e+00       -22.819787031643
     3.8147e+34     3.8147e+35             0.0000e+00       -22.819787031643

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3063
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7921
    reference variance = 0.497925
====================================================
  Execution time = 2.5214e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8798e-01
  Total weights = 1.963724766e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470976950807
                                         uncertainty =       0.002285075807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470976950807
                                         uncertainty =       0.002285075807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485332759
  error estimate for blocks of size 2^( 2) =       0.000506843838
  error estimate for blocks of size 2^( 3) =       0.000527003498
  error estimate for blocks of size 2^( 4) =       0.000542680260
  error estimate for blocks of size 2^( 5) =       0.000552084224
  error estimate for blocks of size 2^( 6) =       0.000557705840
  error estimate for blocks of size 2^( 7) =       0.000560299789

      target function =                  N/A
              le_mean =     -22.819096555016
             les_mean =     521.199150452027
             stat err =       0.000553192528
             autocorr =       1.299192180785
              std dev =       0.686364170383
             le_variance =       0.471095774386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281909655502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+34, overlap shift 2.3842e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819096554955       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819096554955       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819096554955       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819096554955       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819096554955       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819096554955       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9706e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8012
    reference variance = 0.410844
====================================================
  Execution time = 2.4679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.0334e-01
  Total weights = 1.9633e+06
  Execution time = 3.4736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487753719
  error estimate for blocks of size 2^( 2) =       0.000509132173
  error estimate for blocks of size 2^( 3) =       0.000530127209
  error estimate for blocks of size 2^( 4) =       0.000546034202
  error estimate for blocks of size 2^( 5) =       0.000554136430
  error estimate for blocks of size 2^( 6) =       0.000560462425
  error estimate for blocks of size 2^( 7) =       0.000562997829

      target function =                  N/A
              le_mean =     -22.819230392718
             les_mean =     521.220615578448
             stat err =       0.000555907721
             autocorr =       1.298985292315
              std dev =       0.689787924442
             le_variance =       0.475807380707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487753719
  error estimate for blocks of size 2^( 2) =       0.000509132173
  error estimate for blocks of size 2^( 3) =       0.000530127209
  error estimate for blocks of size 2^( 4) =       0.000546034202
  error estimate for blocks of size 2^( 5) =       0.000554136430
  error estimate for blocks of size 2^( 6) =       0.000560462425
  error estimate for blocks of size 2^( 7) =       0.000562997829

      target function =                  N/A
              le_mean =     -22.819230392718
             les_mean =     521.220615578448
             stat err =       0.000555907721
             autocorr =       1.298985292315
              std dev =       0.689787924442
             le_variance =       0.475807380707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487753719
  error estimate for blocks of size 2^( 2) =       0.000509132173
  error estimate for blocks of size 2^( 3) =       0.000530127209
  error estimate for blocks of size 2^( 4) =       0.000546034202
  error estimate for blocks of size 2^( 5) =       0.000554136430
  error estimate for blocks of size 2^( 6) =       0.000560462425
  error estimate for blocks of size 2^( 7) =       0.000562997829

      target function =                  N/A
              le_mean =     -22.819230392718
             les_mean =     521.220615578448
             stat err =       0.000555907721
             autocorr =       1.298985292315
              std dev =       0.689787924442
             le_variance =       0.475807380707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475826497127
                                         uncertainty =       0.003460052375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487753719
  error estimate for blocks of size 2^( 2) =       0.000509132173
  error estimate for blocks of size 2^( 3) =       0.000530127209
  error estimate for blocks of size 2^( 4) =       0.000546034202
  error estimate for blocks of size 2^( 5) =       0.000554136430
  error estimate for blocks of size 2^( 6) =       0.000560462425
  error estimate for blocks of size 2^( 7) =       0.000562997829

      target function =                  N/A
              le_mean =     -22.819230392718
             les_mean =     521.220615578448
             stat err =       0.000555907721
             autocorr =       1.298985292315
              std dev =       0.689787924442
             le_variance =       0.475807380707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819230392718        initial  <--
     2.3842e+34     2.3842e+35             0.0000e+00       -22.819230392718
     9.5367e+34     9.5367e+35             0.0000e+00       -22.819230392718
     3.8147e+35     3.8147e+36             0.0000e+00       -22.819230392718

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2629
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8109
    reference variance = 0.535339
====================================================
  Execution time = 2.5209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.7982e-01
  Total weights = 1.963460990e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467464347606
                                         uncertainty =       0.001991369489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467464347606
                                         uncertainty =       0.001991369489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483551302
  error estimate for blocks of size 2^( 2) =       0.000504995810
  error estimate for blocks of size 2^( 3) =       0.000525912034
  error estimate for blocks of size 2^( 4) =       0.000540611563
  error estimate for blocks of size 2^( 5) =       0.000549936250
  error estimate for blocks of size 2^( 6) =       0.000553806103
  error estimate for blocks of size 2^( 7) =       0.000554717184

      target function =                  N/A
              le_mean =     -22.819253516427
             les_mean =     521.198153075657
             stat err =       0.000549767775
             autocorr =       1.292627658860
              std dev =       0.683844809759
             le_variance =       0.467643723835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281925351643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+35, overlap shift 2.3842e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819253516347       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819253516347       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819253516347       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819253516347       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+36, overlap shift 3.8147e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819253516347       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819253516347       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9726e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8674
    reference variance = 0.389847
====================================================
  Execution time = 2.4696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8799e-01
  Total weights = 1.9637e+06
  Execution time = 3.4807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484880203
  error estimate for blocks of size 2^( 2) =       0.000506061523
  error estimate for blocks of size 2^( 3) =       0.000526578905
  error estimate for blocks of size 2^( 4) =       0.000541399794
  error estimate for blocks of size 2^( 5) =       0.000550936321
  error estimate for blocks of size 2^( 6) =       0.000555384031
  error estimate for blocks of size 2^( 7) =       0.000558827928

      target function =                  N/A
              le_mean =     -22.820056475091
             les_mean =     521.242967916869
             stat err =       0.000551637019
             autocorr =       1.294308787010
              std dev =       0.685724159184
             le_variance =       0.470217622489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484880203
  error estimate for blocks of size 2^( 2) =       0.000506061523
  error estimate for blocks of size 2^( 3) =       0.000526578905
  error estimate for blocks of size 2^( 4) =       0.000541399794
  error estimate for blocks of size 2^( 5) =       0.000550936321
  error estimate for blocks of size 2^( 6) =       0.000555384031
  error estimate for blocks of size 2^( 7) =       0.000558827928

      target function =                  N/A
              le_mean =     -22.820056475091
             les_mean =     521.242967916869
             stat err =       0.000551637019
             autocorr =       1.294308787010
              std dev =       0.685724159184
             le_variance =       0.470217622489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484880203
  error estimate for blocks of size 2^( 2) =       0.000506061523
  error estimate for blocks of size 2^( 3) =       0.000526578905
  error estimate for blocks of size 2^( 4) =       0.000541399794
  error estimate for blocks of size 2^( 5) =       0.000550936321
  error estimate for blocks of size 2^( 6) =       0.000555384031
  error estimate for blocks of size 2^( 7) =       0.000558827928

      target function =                  N/A
              le_mean =     -22.820056475091
             les_mean =     521.242967916869
             stat err =       0.000551637019
             autocorr =       1.294308787010
              std dev =       0.685724159184
             le_variance =       0.470217622489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470173133065
                                         uncertainty =       0.002751233394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484880203
  error estimate for blocks of size 2^( 2) =       0.000506061523
  error estimate for blocks of size 2^( 3) =       0.000526578905
  error estimate for blocks of size 2^( 4) =       0.000541399794
  error estimate for blocks of size 2^( 5) =       0.000550936321
  error estimate for blocks of size 2^( 6) =       0.000555384031
  error estimate for blocks of size 2^( 7) =       0.000558827928

      target function =                  N/A
              le_mean =     -22.820056475091
             les_mean =     521.242967916869
             stat err =       0.000551637019
             autocorr =       1.294308787010
              std dev =       0.685724159184
             le_variance =       0.470217622489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820056475091        initial  <--
     2.3842e+35     2.3842e+36             0.0000e+00       -22.820056475091
     9.5367e+35     9.5367e+36             0.0000e+00       -22.820056475091
     3.8147e+36     3.8147e+37             0.0000e+00       -22.820056475091

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3300
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.8144
    reference variance = 0.399759
====================================================
  Execution time = 2.5380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8409e-01
  Total weights = 1.963691844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469480412111
                                         uncertainty =       0.003240070900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469480412111
                                         uncertainty =       0.003240070900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484470533
  error estimate for blocks of size 2^( 2) =       0.000505509141
  error estimate for blocks of size 2^( 3) =       0.000526470716
  error estimate for blocks of size 2^( 4) =       0.000541529306
  error estimate for blocks of size 2^( 5) =       0.000552071506
  error estimate for blocks of size 2^( 6) =       0.000557821683
  error estimate for blocks of size 2^( 7) =       0.000562173542

      target function =                  N/A
              le_mean =     -22.819778965586
             les_mean =     521.226406440711
             stat err =       0.000553399009
             autocorr =       1.304794209183
              std dev =       0.685144798128
             le_variance =       0.469423394401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281977896559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+36, overlap shift 2.3842e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819778965497       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819778965497       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819778965497       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819778965497       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+37, overlap shift 3.8147e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819778965497       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819778965497       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9889e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7161
    reference variance = 0.421894
====================================================
  Execution time = 2.5025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8828e-01
  Total weights = 1.9635e+06
  Execution time = 3.4659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486400394
  error estimate for blocks of size 2^( 2) =       0.000507548222
  error estimate for blocks of size 2^( 3) =       0.000527915584
  error estimate for blocks of size 2^( 4) =       0.000543124520
  error estimate for blocks of size 2^( 5) =       0.000553383238
  error estimate for blocks of size 2^( 6) =       0.000560645632
  error estimate for blocks of size 2^( 7) =       0.000563049639

      target function =                  N/A
              le_mean =     -22.819305459383
             les_mean =     521.208977534768
             stat err =       0.000555050757
             autocorr =       1.302199617705
              std dev =       0.687874033387
             le_variance =       0.473170685809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486400394
  error estimate for blocks of size 2^( 2) =       0.000507548222
  error estimate for blocks of size 2^( 3) =       0.000527915584
  error estimate for blocks of size 2^( 4) =       0.000543124520
  error estimate for blocks of size 2^( 5) =       0.000553383238
  error estimate for blocks of size 2^( 6) =       0.000560645632
  error estimate for blocks of size 2^( 7) =       0.000563049639

      target function =                  N/A
              le_mean =     -22.819305459383
             les_mean =     521.208977534768
             stat err =       0.000555050757
             autocorr =       1.302199617705
              std dev =       0.687874033387
             le_variance =       0.473170685809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486400394
  error estimate for blocks of size 2^( 2) =       0.000507548222
  error estimate for blocks of size 2^( 3) =       0.000527915584
  error estimate for blocks of size 2^( 4) =       0.000543124520
  error estimate for blocks of size 2^( 5) =       0.000553383238
  error estimate for blocks of size 2^( 6) =       0.000560645632
  error estimate for blocks of size 2^( 7) =       0.000563049639

      target function =                  N/A
              le_mean =     -22.819305459383
             les_mean =     521.208977534768
             stat err =       0.000555050757
             autocorr =       1.302199617705
              std dev =       0.687874033387
             le_variance =       0.473170685809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473184116817
                                         uncertainty =       0.002379619917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486400394
  error estimate for blocks of size 2^( 2) =       0.000507548222
  error estimate for blocks of size 2^( 3) =       0.000527915584
  error estimate for blocks of size 2^( 4) =       0.000543124520
  error estimate for blocks of size 2^( 5) =       0.000553383238
  error estimate for blocks of size 2^( 6) =       0.000560645632
  error estimate for blocks of size 2^( 7) =       0.000563049639

      target function =                  N/A
              le_mean =     -22.819305459383
             les_mean =     521.208977534768
             stat err =       0.000555050757
             autocorr =       1.302199617705
              std dev =       0.687874033387
             le_variance =       0.473170685809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819305459383        initial  <--
     2.3842e+36     2.3842e+37             0.0000e+00       -22.819305459383
     9.5367e+36     9.5367e+37             0.0000e+00       -22.819305459383
     3.8147e+37     3.8147e+38             0.0000e+00       -22.819305459383

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5569
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7377
    reference variance = 0.378832
====================================================
  Execution time = 2.7349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9046e-01
  Total weights = 1.963775656e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473215131683
                                         uncertainty =       0.002337898765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473215131683
                                         uncertainty =       0.002337898765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486404912
  error estimate for blocks of size 2^( 2) =       0.000507672024
  error estimate for blocks of size 2^( 3) =       0.000528046586
  error estimate for blocks of size 2^( 4) =       0.000543092352
  error estimate for blocks of size 2^( 5) =       0.000552586064
  error estimate for blocks of size 2^( 6) =       0.000558701658
  error estimate for blocks of size 2^( 7) =       0.000562111091

      target function =                  N/A
              le_mean =     -22.819134593102
             les_mean =     521.203368173182
             stat err =       0.000554122791
             autocorr =       1.297824957347
              std dev =       0.687880424055
             le_variance =       0.473179477798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281913459310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+37, overlap shift 2.3842e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819134593019       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819134593019       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819134593019       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819134593019       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+38, overlap shift 3.8147e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819134593019       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819134593019       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1840e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6796
    reference variance = 0.323918
====================================================
  Execution time = 2.4772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9454e-01
  Total weights = 1.9636e+06
  Execution time = 3.5468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489202207
  error estimate for blocks of size 2^( 2) =       0.000510232325
  error estimate for blocks of size 2^( 3) =       0.000530705614
  error estimate for blocks of size 2^( 4) =       0.000546622022
  error estimate for blocks of size 2^( 5) =       0.000558210318
  error estimate for blocks of size 2^( 6) =       0.000563100954
  error estimate for blocks of size 2^( 7) =       0.000567767853

      target function =                  N/A
              le_mean =     -22.819644934129
             les_mean =     521.230732051882
             stat err =       0.000558925287
             autocorr =       1.305361205325
              std dev =       0.691836395503
             le_variance =       0.478637598143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489202207
  error estimate for blocks of size 2^( 2) =       0.000510232325
  error estimate for blocks of size 2^( 3) =       0.000530705614
  error estimate for blocks of size 2^( 4) =       0.000546622022
  error estimate for blocks of size 2^( 5) =       0.000558210318
  error estimate for blocks of size 2^( 6) =       0.000563100954
  error estimate for blocks of size 2^( 7) =       0.000567767853

      target function =                  N/A
              le_mean =     -22.819644934129
             les_mean =     521.230732051882
             stat err =       0.000558925287
             autocorr =       1.305361205325
              std dev =       0.691836395503
             le_variance =       0.478637598143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489202207
  error estimate for blocks of size 2^( 2) =       0.000510232325
  error estimate for blocks of size 2^( 3) =       0.000530705614
  error estimate for blocks of size 2^( 4) =       0.000546622022
  error estimate for blocks of size 2^( 5) =       0.000558210318
  error estimate for blocks of size 2^( 6) =       0.000563100954
  error estimate for blocks of size 2^( 7) =       0.000567767853

      target function =                  N/A
              le_mean =     -22.819644934129
             les_mean =     521.230732051882
             stat err =       0.000558925287
             autocorr =       1.305361205325
              std dev =       0.691836395503
             le_variance =       0.478637598143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478562422103
                                         uncertainty =       0.003822639512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489202207
  error estimate for blocks of size 2^( 2) =       0.000510232325
  error estimate for blocks of size 2^( 3) =       0.000530705614
  error estimate for blocks of size 2^( 4) =       0.000546622022
  error estimate for blocks of size 2^( 5) =       0.000558210318
  error estimate for blocks of size 2^( 6) =       0.000563100954
  error estimate for blocks of size 2^( 7) =       0.000567767853

      target function =                  N/A
              le_mean =     -22.819644934129
             les_mean =     521.230732051882
             stat err =       0.000558925287
             autocorr =       1.305361205325
              std dev =       0.691836395503
             le_variance =       0.478637598143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819644934129        initial  <--
     2.3842e+37     2.3842e+38             0.0000e+00       -22.819644934129
     9.5367e+37     9.5367e+38             0.0000e+00       -22.819644934129
     3.8147e+38     3.8147e+39             0.0000e+00       -22.819644934129

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4275
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4273e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.785
    reference variance = 0.534295
====================================================
  Execution time = 2.5312e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9128e-01
  Total weights = 1.963615480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473161809118
                                         uncertainty =       0.003235005330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473161809118
                                         uncertainty =       0.003235005330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486422744
  error estimate for blocks of size 2^( 2) =       0.000508141898
  error estimate for blocks of size 2^( 3) =       0.000528909553
  error estimate for blocks of size 2^( 4) =       0.000544564024
  error estimate for blocks of size 2^( 5) =       0.000554730688
  error estimate for blocks of size 2^( 6) =       0.000559721456
  error estimate for blocks of size 2^( 7) =       0.000564255006

      target function =                  N/A
              le_mean =     -22.819298052625
             les_mean =     521.211643895206
             stat err =       0.000555817794
             autocorr =       1.305681184259
              std dev =       0.687905641102
             le_variance =       0.473214171060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281929805263e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+38, overlap shift 2.3842e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819298052567       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819298052567       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819298052567       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819298052567       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+39, overlap shift 3.8147e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819298052567       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819298052567       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9798e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8022
    reference variance = 0.436224
====================================================
  Execution time = 2.4754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8665e-01
  Total weights = 1.9636e+06
  Execution time = 3.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485938693
  error estimate for blocks of size 2^( 2) =       0.000507637961
  error estimate for blocks of size 2^( 3) =       0.000528602347
  error estimate for blocks of size 2^( 4) =       0.000544911642
  error estimate for blocks of size 2^( 5) =       0.000555242075
  error estimate for blocks of size 2^( 6) =       0.000561736643
  error estimate for blocks of size 2^( 7) =       0.000565552013

      target function =                  N/A
              le_mean =     -22.819049740246
             les_mean =     521.195683608027
             stat err =       0.000556860593
             autocorr =       1.313197385038
              std dev =       0.687221089915
             le_variance =       0.472272826424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485938693
  error estimate for blocks of size 2^( 2) =       0.000507637961
  error estimate for blocks of size 2^( 3) =       0.000528602347
  error estimate for blocks of size 2^( 4) =       0.000544911642
  error estimate for blocks of size 2^( 5) =       0.000555242075
  error estimate for blocks of size 2^( 6) =       0.000561736643
  error estimate for blocks of size 2^( 7) =       0.000565552013

      target function =                  N/A
              le_mean =     -22.819049740246
             les_mean =     521.195683608027
             stat err =       0.000556860593
             autocorr =       1.313197385038
              std dev =       0.687221089915
             le_variance =       0.472272826424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485938693
  error estimate for blocks of size 2^( 2) =       0.000507637961
  error estimate for blocks of size 2^( 3) =       0.000528602347
  error estimate for blocks of size 2^( 4) =       0.000544911642
  error estimate for blocks of size 2^( 5) =       0.000555242075
  error estimate for blocks of size 2^( 6) =       0.000561736643
  error estimate for blocks of size 2^( 7) =       0.000565552013

      target function =                  N/A
              le_mean =     -22.819049740246
             les_mean =     521.195683608027
             stat err =       0.000556860593
             autocorr =       1.313197385038
              std dev =       0.687221089915
             le_variance =       0.472272826424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472277861785
                                         uncertainty =       0.002374966094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485938693
  error estimate for blocks of size 2^( 2) =       0.000507637961
  error estimate for blocks of size 2^( 3) =       0.000528602347
  error estimate for blocks of size 2^( 4) =       0.000544911642
  error estimate for blocks of size 2^( 5) =       0.000555242075
  error estimate for blocks of size 2^( 6) =       0.000561736643
  error estimate for blocks of size 2^( 7) =       0.000565552013

      target function =                  N/A
              le_mean =     -22.819049740246
             les_mean =     521.195683608027
             stat err =       0.000556860593
             autocorr =       1.313197385038
              std dev =       0.687221089915
             le_variance =       0.472272826424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819049740246        initial  <--
     2.3842e+38     2.3842e+39             0.0000e+00       -22.819049740246
     9.5367e+38     9.5367e+39             0.0000e+00       -22.819049740246
     3.8147e+39     3.8147e+40             0.0000e+00       -22.819049740246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3202
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.163555e-01 3 1  ON 0
ci_02                -2.548907e-02 3 1  ON 1
ci_03                -2.577497e-02 3 1  ON 2
ci_04                 2.521505e-02 3 1  ON 3
ci_05                -2.312293e-02 3 1  ON 4
ci_06                -2.242898e-02 3 1  ON 5
ci_07                 2.484866e-02 3 1  ON 6
ci_08                -4.582624e-03 3 1  ON 7
ci_09                -1.125914e-02 3 1  ON 8
ci_10                -1.180336e-02 3 1  ON 9
ci_11                 1.629179e-02 3 1  ON 10
ci_12                 1.118448e-02 3 1  ON 11
ci_13                 1.205642e-02 3 1  ON 12
ci_14                 1.764283e-02 3 1  ON 13
ci_15                 8.680094e-03 3 1  ON 14
ci_16                 8.617796e-03 3 1  ON 15
ci_17                -1.052808e-02 3 1  ON 16
ci_18                -9.318597e-03 3 1  ON 17
ci_19                 8.994332e-03 3 1  ON 18
ci_20                 1.026296e-02 3 1  ON 19
ci_21                 8.533028e-03 3 1  ON 20
ci_22                 7.503620e-03 3 1  ON 21
ci_23                 5.761241e-03 3 1  ON 22
ci_24                 6.097796e-03 3 1  ON 23
ci_25                 4.931427e-03 3 1  ON 24
ci_26                 3.257828e-03 3 1  ON 25
ci_27                 2.890854e-03 3 1  ON 26
ci_28                 4.662848e-03 3 1  ON 27
ci_29                 3.579558e-03 3 1  ON 28
ci_30                -7.922690e-04 3 1  ON 29
ci_31                 2.373455e-04 3 1  ON 30
ci_32                 4.982820e-04 3 1  ON 31
ci_33                -3.527900e-04 3 1  ON 32
ci_34                 3.540881e-04 3 1  ON 33
ci_35                 2.194210e-03 3 1  ON 34
ci_36                -1.192567e-03 3 1  ON 35
ci_37                -7.574816e-04 3 1  ON 36
ci_38                -9.964123e-04 3 1  ON 37
ci_39                -3.894074e-04 3 1  ON 38
ci_40                -1.037054e-03 3 1  ON 39
ci_41                 9.200509e-04 3 1  ON 40
ci_42                 5.567957e-04 3 1  ON 41
ci_43                -1.727935e-03 3 1  ON 42
ci_44                -2.017883e-03 3 1  ON 43
ci_45                -3.018982e-04 3 1  ON 44
ci_46                -4.023909e-04 3 1  ON 45
ci_47                -5.146595e-04 3 1  ON 46
ci_48                -8.815711e-04 3 1  ON 47
ci_49                -1.271106e-03 3 1  ON 48
ci_50                -7.604160e-04 3 1  ON 49
ci_51                 3.559908e-05 3 1  ON 50
ci_52                -6.650516e-04 3 1  ON 51
ci_53                -1.486624e-03 3 1  ON 52
ci_54                -1.058734e-03 3 1  ON 53
ci_55                -1.447523e-03 3 1  ON 54
ci_56                 1.646270e-03 3 1  ON 55
ci_57                 1.476309e-03 3 1  ON 56
ci_58                -1.262866e-03 3 1  ON 57
ci_59                -1.217661e-03 3 1  ON 58
ci_60                 8.302429e-04 3 1  ON 59
ci_61                 2.301697e-03 3 1  ON 60
ci_62                -7.296472e-04 3 1  ON 61
ci_63                -8.375671e-04 3 1  ON 62
ci_64                -1.198739e-04 3 1  ON 63
ci_65                -1.808596e-04 3 1  ON 64
ci_66                -2.225797e-04 3 1  ON 65
ci_67                -1.077680e-03 3 1  ON 66
ci_68                -2.563237e-03 3 1  ON 67
ci_69                -1.691677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2123e+01 secs
  Total Execution time = 4.3711e+03 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
