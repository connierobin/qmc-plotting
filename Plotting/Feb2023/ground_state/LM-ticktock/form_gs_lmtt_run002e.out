Rank =    0  Free Memory = 86663 MB
Rank =    1  Free Memory = 86663 MB
Rank =    2  Free Memory = 86663 MB
Rank =    3  Free Memory = 86663 MB
Rank =    4  Free Memory = 86663 MB
Rank =    5  Free Memory = 86663 MB
Rank =    6  Free Memory = 86663 MB
Rank =    7  Free Memory = 86663 MB
Rank =    8  Free Memory = 86663 MB
Rank =    9  Free Memory = 86663 MB
Rank =   10  Free Memory = 86663 MB
Rank =   11  Free Memory = 86663 MB
Rank =   12  Free Memory = 86663 MB
Rank =   13  Free Memory = 86663 MB
Rank =   14  Free Memory = 86662 MB
Rank =   15  Free Memory = 86647 MB
Rank =   16  Free Memory = 86647 MB
Rank =   17  Free Memory = 86647 MB
Rank =   18  Free Memory = 86647 MB
Rank =   19  Free Memory = 86647 MB
Rank =   20  Free Memory = 86647 MB
Rank =   21  Free Memory = 86647 MB
Rank =   22  Free Memory = 86647 MB
Rank =   23  Free Memory = 86647 MB
Rank =   24  Free Memory = 86647 MB
Rank =   25  Free Memory = 86647 MB
Rank =   26  Free Memory = 86647 MB
Rank =   27  Free Memory = 86647 MB
Rank =   28  Free Memory = 86647 MB
Rank =   29  Free Memory = 86647 MB
Rank =   30  Free Memory = 86647 MB
Rank =   31  Free Memory = 86647 MB
Rank =   32  Free Memory = 33158 MB
Rank =   33  Free Memory = 33158 MB
Rank =   34  Free Memory = 33158 MB
Rank =   35  Free Memory = 33158 MB
Rank =   36  Free Memory = 33158 MB
Rank =   37  Free Memory = 33158 MB
Rank =   38  Free Memory = 33158 MB
Rank =   39  Free Memory = 33158 MB
Rank =   40  Free Memory = 33158 MB
Rank =   41  Free Memory = 33158 MB
Rank =   42  Free Memory = 33158 MB
Rank =   43  Free Memory = 33157 MB
Rank =   44  Free Memory = 33157 MB
Rank =   45  Free Memory = 33157 MB
Rank =   46  Free Memory = 33157 MB
Rank =   47  Free Memory = 33157 MB
Rank =   48  Free Memory = 33157 MB
Rank =   49  Free Memory = 33156 MB
Rank =   50  Free Memory = 33156 MB
Rank =   51  Free Memory = 33156 MB
Rank =   52  Free Memory = 33156 MB
Rank =   53  Free Memory = 33156 MB
Rank =   54  Free Memory = 33156 MB
Rank =   55  Free Memory = 33156 MB
Rank =   56  Free Memory = 33156 MB
Rank =   57  Free Memory = 33156 MB
Rank =   58  Free Memory = 33156 MB
Rank =   59  Free Memory = 33156 MB
Rank =   60  Free Memory = 33156 MB
Rank =   61  Free Memory = 33156 MB
Rank =   62  Free Memory = 33156 MB
Rank =   63  Free Memory = 33156 MB
Rank =   64  Free Memory = 87925 MB
Rank =   65  Free Memory = 87925 MB
Rank =   66  Free Memory = 87925 MB
Rank =   67  Free Memory = 87925 MB
Rank =   68  Free Memory = 87925 MB
Rank =   69  Free Memory = 87925 MB
Rank =   70  Free Memory = 87925 MB
Rank =   71  Free Memory = 87925 MB
Rank =   72  Free Memory = 87925 MB
Rank =   73  Free Memory = 87925 MB
Rank =   74  Free Memory = 87925 MB
Rank =   75  Free Memory = 87925 MB
Rank =   76  Free Memory = 87925 MB
Rank =   77  Free Memory = 87925 MB
Rank =   78  Free Memory = 87925 MB
Rank =   79  Free Memory = 87925 MB
Rank =   80  Free Memory = 87925 MB
Rank =   81  Free Memory = 87925 MB
Rank =   82  Free Memory = 87925 MB
Rank =   83  Free Memory = 87925 MB
Rank =   84  Free Memory = 87925 MB
Rank =   85  Free Memory = 87925 MB
Rank =   86  Free Memory = 87925 MB
Rank =   87  Free Memory = 87925 MB
Rank =   88  Free Memory = 87925 MB
Rank =   89  Free Memory = 87925 MB
Rank =   90  Free Memory = 87925 MB
Rank =   91  Free Memory = 87925 MB
Rank =   92  Free Memory = 87925 MB
Rank =   93  Free Memory = 87925 MB
Rank =   94  Free Memory = 87925 MB
Rank =   95  Free Memory = 87925 MB
Rank =   96  Free Memory = 87100 MB
Rank =   97  Free Memory = 87100 MB
Rank =   98  Free Memory = 87100 MB
Rank =   99  Free Memory = 87100 MB
Rank =  100  Free Memory = 87100 MB
Rank =  101  Free Memory = 87100 MB
Rank =  102  Free Memory = 87100 MB
Rank =  103  Free Memory = 87100 MB
Rank =  104  Free Memory = 87099 MB
Rank =  105  Free Memory = 87099 MB
Rank =  106  Free Memory = 87099 MB
Rank =  107  Free Memory = 87099 MB
Rank =  108  Free Memory = 87099 MB
Rank =  109  Free Memory = 87099 MB
Rank =  110  Free Memory = 87099 MB
Rank =  111  Free Memory = 87099 MB
Rank =  112  Free Memory = 87099 MB
Rank =  113  Free Memory = 87099 MB
Rank =  114  Free Memory = 87099 MB
Rank =  115  Free Memory = 87099 MB
Rank =  116  Free Memory = 87099 MB
Rank =  117  Free Memory = 87099 MB
Rank =  118  Free Memory = 87099 MB
Rank =  119  Free Memory = 87099 MB
Rank =  120  Free Memory = 87099 MB
Rank =  121  Free Memory = 87099 MB
Rank =  122  Free Memory = 87099 MB
Rank =  123  Free Memory = 87099 MB
Rank =  124  Free Memory = 87099 MB
Rank =  125  Free Memory = 87099 MB
Rank =  126  Free Memory = 87099 MB
Rank =  127  Free Memory = 87099 MB
  Input file(s): opt_form_gs_lmtt_run002e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmtt_run002e.xml

  Project = FORM
  date    = 2023-03-23 22:51:16 PDT
  host    = n0066.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 596

  Range of prime numbers to use as seeds over processors and threads = 4391-5501


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.691701e-01    1         1 OFF
     uu_1                 9.565831e-02    1         1 OFF
     uu_2                -1.418005e-02    1         1 OFF
     uu_3                -7.764470e-02    1         1 OFF
     uu_4                -1.122978e-01    1         1 OFF
     uu_5                -1.309390e-01    1         1 OFF
     uu_6                -1.381735e-01    1         1 OFF
     uu_7                -1.310713e-01    1         1 OFF
     uu_8                -1.030320e-01    1         1 OFF
     uu_9                -3.136492e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.218753e-01    1         1 OFF
     ud_1                 1.401105e-01    1         1 OFF
     ud_2                -4.343178e-03    1         1 OFF
     ud_3                -8.207730e-02    1         1 OFF
     ud_4                -1.261630e-01    1         1 OFF
     ud_5                -1.512757e-01    1         1 OFF
     ud_6                -1.626958e-01    1         1 OFF
     ud_7                -1.577914e-01    1         1 OFF
     ud_8                -1.305340e-01    1         1 OFF
     ud_9                -6.091297e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.261929e-01    1         1 OFF
     eC_1                -3.687284e-01    1         1 OFF
     eC_2                -1.098175e-01    1         1 OFF
     eC_3                 5.179627e-02    1         1 OFF
     eC_4                 1.179949e-01    1         1 OFF
     eC_5                 2.170026e-01    1         1 OFF
     eC_6                 2.919073e-01    1         1 OFF
     eC_7                 2.436876e-01    1         1 OFF
     eC_8                 6.902728e-02    1         1 OFF
     eC_9                 1.149765e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.081594e+00    1         1 OFF
     eO_1                -7.083994e-01    1         1 OFF
     eO_2                -2.419979e-01    1         1 OFF
     eO_3                 8.209732e-02    1         1 OFF
     eO_4                 2.793665e-01    1         1 OFF
     eO_5                 4.216892e-01    1         1 OFF
     eO_6                 4.535474e-01    1         1 OFF
     eO_7                 4.364514e-01    1         1 OFF
     eO_8                 2.285750e-01    1         1 OFF
     eO_9                 8.592472e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.517653e-01    1         1 OFF
     eH1_1                -6.607088e-02    1         1 OFF
     eH1_2                -3.800285e-02    1         1 OFF
     eH1_3                -3.263336e-02    1         1 OFF
     eH1_4                 1.432769e-02    1         1 OFF
     eH1_5                 5.246272e-02    1         1 OFF
     eH1_6                 8.862957e-02    1         1 OFF
     eH1_7                 4.580408e-02    1         1 OFF
     eH1_8                 1.666288e-02    1         1 OFF
     eH1_9                 4.973596e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.533314e-01    1         1 OFF
     eH2_1                -6.833887e-02    1         1 OFF
     eH2_2                -4.073405e-02    1         1 OFF
     eH2_3                -3.487668e-02    1         1 OFF
     eH2_4                 1.209009e-02    1         1 OFF
     eH2_5                 5.062574e-02    1         1 OFF
     eH2_6                 8.667539e-02    1         1 OFF
     eH2_7                 4.476922e-02    1         1 OFF
     eH2_8                 1.805501e-02    1         1 OFF
     eH2_9                 5.823866e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.721580e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.5301e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500000000e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8041
    reference variance = 0.720416
====================================================
  Execution time = 1.0102e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1399e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0439e-01
  Total weights = 7.857341380e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8834e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487245047900
                                         uncertainty =       0.001810824259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487245047900
                                         uncertainty =       0.001810824259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246790825
  error estimate for blocks of size 2^( 2) =       0.000255911616
  error estimate for blocks of size 2^( 3) =       0.000264127149
  error estimate for blocks of size 2^( 4) =       0.000270094363
  error estimate for blocks of size 2^( 5) =       0.000273791431
  error estimate for blocks of size 2^( 6) =       0.000275733023
  error estimate for blocks of size 2^( 7) =       0.000276526969
  error estimate for blocks of size 2^( 8) =       0.000277516640
  error estimate for blocks of size 2^( 9) =       0.000277858589

      target function =                  N/A
              le_mean =     -22.824414050246
             les_mean =     521.458262544075
             stat err =       0.000276908805
             autocorr =       1.258970376053
              std dev =       0.698029864638
             le_variance =       0.487245691927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.282441405025e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824414050239       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824418166540       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824418062640       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824418026554       residual = 9.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.946399e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824414050239       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824415564279       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824415511461       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824415512665       residual = 3.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.807331e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824414050239       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824414479298       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824414466613       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824414470177       residual = 7.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.371409e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1987e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.100173e-01                 3 1 ON  0
ci_02 -2.206184e-02                3 1 ON  1
ci_03 -2.229921e-02                3 1 ON  2
ci_04 2.210192e-02                 3 1 ON  3
ci_05 -2.134045e-02                3 1 ON  4
ci_06 -2.160163e-02                3 1 ON  5
ci_07 2.520879e-02                 3 1 ON  6
ci_08 -3.678463e-03                3 1 ON  7
ci_09 -1.103192e-02                3 1 ON  8
ci_10 -1.112593e-02                3 1 ON  9
ci_11 1.642174e-02                 3 1 ON  10
ci_12 1.086937e-02                 3 1 ON  11
ci_13 1.191998e-02                 3 1 ON  12
ci_14 1.721071e-02                 3 1 ON  13
ci_15 7.241433e-03                 3 1 ON  14
ci_16 7.689977e-03                 3 1 ON  15
ci_17 -8.937166e-03                3 1 ON  16
ci_18 -9.016765e-03                3 1 ON  17
ci_19 9.541177e-03                 3 1 ON  18
ci_20 1.056261e-02                 3 1 ON  19
ci_21 8.433331e-03                 3 1 ON  20
ci_22 8.380752e-03                 3 1 ON  21
ci_23 6.470307e-03                 3 1 ON  22
ci_24 7.682256e-03                 3 1 ON  23
ci_25 4.974215e-03                 3 1 ON  24
ci_26 2.507506e-03                 3 1 ON  25
ci_27 2.875228e-03                 3 1 ON  26
ci_28 3.004232e-03                 3 1 ON  27
ci_29 2.676963e-03                 3 1 ON  28
ci_30 5.387162e-04                 3 1 ON  29
ci_31 7.038096e-04                 3 1 ON  30
ci_32 1.015942e-04                 3 1 ON  31
ci_33 -3.644935e-05                3 1 ON  32
ci_34 -2.925753e-04                3 1 ON  33
ci_35 -2.499755e-04                3 1 ON  34
ci_36 -2.363532e-04                3 1 ON  35
ci_37 -4.989395e-04                3 1 ON  36
ci_38 -6.655247e-05                3 1 ON  37
ci_39 -4.018655e-05                3 1 ON  38
ci_40 -1.236642e-03                3 1 ON  39
ci_41 1.240274e-04                 3 1 ON  40
ci_42 2.205831e-04                 3 1 ON  41
ci_43 -2.366016e-03                3 1 ON  42
ci_44 -2.235732e-03                3 1 ON  43
ci_45 -1.963302e-04                3 1 ON  44
ci_46 -7.344075e-05                3 1 ON  45
ci_47 -9.753043e-05                3 1 ON  46
ci_48 -3.350174e-05                3 1 ON  47
ci_49 -1.300481e-03                3 1 ON  48
ci_50 -5.169955e-04                3 1 ON  49
ci_51 1.580421e-04                 3 1 ON  50
ci_52 -9.079381e-05                3 1 ON  51
ci_53 -8.267234e-04                3 1 ON  52
ci_54 -7.489626e-04                3 1 ON  53
ci_55 -7.190393e-04                3 1 ON  54
ci_56 1.681225e-03                 3 1 ON  55
ci_57 1.805704e-03                 3 1 ON  56
ci_58 -1.108875e-03                3 1 ON  57
ci_59 -1.456535e-03                3 1 ON  58
ci_60 7.722784e-04                 3 1 ON  59
ci_61 2.289279e-03                 3 1 ON  60
ci_62 -2.372693e-04                3 1 ON  61
ci_63 -1.671742e-04                3 1 ON  62
ci_64 -2.598288e-04                3 1 ON  63
ci_65 -6.041401e-04                3 1 ON  64
ci_66 -4.520113e-04                3 1 ON  65
ci_67 -3.806422e-04                3 1 ON  66
ci_68 -1.931370e-03                3 1 ON  67
ci_69 -1.640436e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.877
    reference variance = 0.413795
====================================================
  Execution time = 1.0420e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0907e-01
  Total weights = 7.8568e+06
  Execution time = 1.4542e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490726537478
                                         uncertainty =       0.005423425425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490726537478
                                         uncertainty =       0.005423425425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247670063
  error estimate for blocks of size 2^( 2) =       0.000256754480
  error estimate for blocks of size 2^( 3) =       0.000264900570
  error estimate for blocks of size 2^( 4) =       0.000270667710
  error estimate for blocks of size 2^( 5) =       0.000274102938
  error estimate for blocks of size 2^( 6) =       0.000275746207
  error estimate for blocks of size 2^( 7) =       0.000277196940
  error estimate for blocks of size 2^( 8) =       0.000278285239
  error estimate for blocks of size 2^( 9) =       0.000279339304

      target function =                  N/A
              le_mean =     -22.824329826939
             les_mean =     521.461922388831
             stat err =       0.000277641923
             autocorr =       1.256675238040
              std dev =       0.700516723718
             le_variance =       0.490723680208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490720988786
                                         uncertainty =       0.005450968614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490720988786
                                         uncertainty =       0.005450968614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247668657
  error estimate for blocks of size 2^( 2) =       0.000256754858
  error estimate for blocks of size 2^( 3) =       0.000264902871
  error estimate for blocks of size 2^( 4) =       0.000270673120
  error estimate for blocks of size 2^( 5) =       0.000274111121
  error estimate for blocks of size 2^( 6) =       0.000275751073
  error estimate for blocks of size 2^( 7) =       0.000277206608
  error estimate for blocks of size 2^( 8) =       0.000278291549
  error estimate for blocks of size 2^( 9) =       0.000279340805

      target function =                  N/A
              le_mean =     -22.824331713756
             les_mean =     521.467169607994
             stat err =       0.000277647509
             autocorr =       1.256740075106
              std dev =       0.700512747393
             le_variance =       0.490718109260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490707074045
                                         uncertainty =       0.005436859417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490707074045
                                         uncertainty =       0.005436859417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247665149
  error estimate for blocks of size 2^( 2) =       0.000256750648
  error estimate for blocks of size 2^( 3) =       0.000264898046
  error estimate for blocks of size 2^( 4) =       0.000270667421
  error estimate for blocks of size 2^( 5) =       0.000274105022
  error estimate for blocks of size 2^( 6) =       0.000275746107
  error estimate for blocks of size 2^( 7) =       0.000277200893
  error estimate for blocks of size 2^( 8) =       0.000278288756
  error estimate for blocks of size 2^( 9) =       0.000279338892

      target function =                  N/A
              le_mean =     -22.824330992901
             les_mean =     521.461641681630
             stat err =       0.000277643662
             autocorr =       1.256740848984
              std dev =       0.700502825993
             le_variance =       0.490704209225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490727214053
                                         uncertainty =       0.005424832975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490727214053
                                         uncertainty =       0.005424832975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247670236
  error estimate for blocks of size 2^( 2) =       0.000256754833
  error estimate for blocks of size 2^( 3) =       0.000264900973
  error estimate for blocks of size 2^( 4) =       0.000270668310
  error estimate for blocks of size 2^( 5) =       0.000274103057
  error estimate for blocks of size 2^( 6) =       0.000275748067
  error estimate for blocks of size 2^( 7) =       0.000277197920
  error estimate for blocks of size 2^( 8) =       0.000278286136
  error estimate for blocks of size 2^( 9) =       0.000279342549

      target function =                  N/A
              le_mean =     -22.824328903955
             les_mean =     521.490415307500
             stat err =       0.000277643668
             autocorr =       1.256689275609
              std dev =       0.700517214743
             le_variance =       0.490724368151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824329826939        initial
     2.5000e-01     2.5000e+00             4.9464e-04       -22.824331713756  <--
     1.0000e+00     1.0000e+01             1.8073e-04       -22.824330992901
     4.0000e+00     4.0000e+01             5.3714e-05       -22.824328903955

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 1.7691e+02
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.096743e-01 3 1  ON 0
ci_02                -2.202429e-02 3 1  ON 1
ci_03                -2.211280e-02 3 1  ON 2
ci_04                 2.213976e-02 3 1  ON 3
ci_05                -2.125666e-02 3 1  ON 4
ci_06                -2.161887e-02 3 1  ON 5
ci_07                 2.522686e-02 3 1  ON 6
ci_08                -3.699775e-03 3 1  ON 7
ci_09                -1.107686e-02 3 1  ON 8
ci_10                -1.116405e-02 3 1  ON 9
ci_11                 1.645343e-02 3 1  ON 10
ci_12                 1.089090e-02 3 1  ON 11
ci_13                 1.210155e-02 3 1  ON 12
ci_14                 1.745095e-02 3 1  ON 13
ci_15                 6.923875e-03 3 1  ON 14
ci_16                 7.630297e-03 3 1  ON 15
ci_17                -8.928666e-03 3 1  ON 16
ci_18                -9.000464e-03 3 1  ON 17
ci_19                 9.580123e-03 3 1  ON 18
ci_20                 1.068808e-02 3 1  ON 19
ci_21                 8.614576e-03 3 1  ON 20
ci_22                 8.327954e-03 3 1  ON 21
ci_23                 6.275205e-03 3 1  ON 22
ci_24                 7.642397e-03 3 1  ON 23
ci_25                 4.857933e-03 3 1  ON 24
ci_26                 2.496119e-03 3 1  ON 25
ci_27                 2.953738e-03 3 1  ON 26
ci_28                 3.186804e-03 3 1  ON 27
ci_29                 2.658202e-03 3 1  ON 28
ci_30                 3.857755e-04 3 1  ON 29
ci_31                 6.370407e-04 3 1  ON 30
ci_32                 1.681714e-05 3 1  ON 31
ci_33                 5.437684e-05 3 1  ON 32
ci_34                -2.185383e-04 3 1  ON 33
ci_35                -4.458238e-04 3 1  ON 34
ci_36                -2.328020e-04 3 1  ON 35
ci_37                -3.668720e-04 3 1  ON 36
ci_38                -2.450292e-05 3 1  ON 37
ci_39                 1.234638e-07 3 1  ON 38
ci_40                -1.251463e-03 3 1  ON 39
ci_41                 7.395363e-05 3 1  ON 40
ci_42                 1.267569e-04 3 1  ON 41
ci_43                -2.274309e-03 3 1  ON 42
ci_44                -2.024455e-03 3 1  ON 43
ci_45                -1.304844e-04 3 1  ON 44
ci_46                 7.032023e-05 3 1  ON 45
ci_47                -7.257306e-05 3 1  ON 46
ci_48                -1.069311e-04 3 1  ON 47
ci_49                -1.307797e-03 3 1  ON 48
ci_50                -5.022294e-04 3 1  ON 49
ci_51                 1.633312e-04 3 1  ON 50
ci_52                -2.321783e-04 3 1  ON 51
ci_53                -7.189070e-04 3 1  ON 52
ci_54                -7.460427e-04 3 1  ON 53
ci_55                -6.806252e-04 3 1  ON 54
ci_56                 1.944436e-03 3 1  ON 55
ci_57                 1.969680e-03 3 1  ON 56
ci_58                -1.148988e-03 3 1  ON 57
ci_59                -1.484624e-03 3 1  ON 58
ci_60                 1.013709e-03 3 1  ON 59
ci_61                 2.168229e-03 3 1  ON 60
ci_62                -1.701443e-04 3 1  ON 61
ci_63                -2.598105e-04 3 1  ON 62
ci_64                -3.170799e-04 3 1  ON 63
ci_65                -6.391897e-04 3 1  ON 64
ci_66                -3.368150e-04 3 1  ON 65
ci_67                -4.715249e-04 3 1  ON 66
ci_68                -1.944828e-03 3 1  ON 67
ci_69                -1.455313e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9679e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8108
    reference variance = 0.495397
====================================================
  Execution time = 1.0128e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1418e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0495e-01
  Total weights = 7.856601928e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8569e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484319943218
                                         uncertainty =       0.001304712576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484319943218
                                         uncertainty =       0.001304712576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246049030
  error estimate for blocks of size 2^( 2) =       0.000255242982
  error estimate for blocks of size 2^( 3) =       0.000263515718
  error estimate for blocks of size 2^( 4) =       0.000269520322
  error estimate for blocks of size 2^( 5) =       0.000272979285
  error estimate for blocks of size 2^( 6) =       0.000275090888
  error estimate for blocks of size 2^( 7) =       0.000276461305
  error estimate for blocks of size 2^( 8) =       0.000277580451
  error estimate for blocks of size 2^( 9) =       0.000278844684

      target function =                  N/A
              le_mean =     -22.824952643016
             les_mean =     521.483408780659
             stat err =       0.000276994332
             autocorr =       1.267355490647
              std dev =       0.695931749925
             le_variance =       0.484321000554


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282495264302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824952643013       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824960407295       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824961766961       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824962109130       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824962068461       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.120992e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824952643013       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824957246854       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824957551792       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824957613788       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.288601e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824952643013       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824954394724       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824954378364       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824954391167       residual = 2.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 5.017895e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1987e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.092925e-01 3 1  ON 0
ci_02                -2.217316e-02 3 1  ON 1
ci_03                -2.221480e-02 3 1  ON 2
ci_04                 2.163562e-02 3 1  ON 3
ci_05                -2.163086e-02 3 1  ON 4
ci_06                -2.150849e-02 3 1  ON 5
ci_07                 2.553481e-02 3 1  ON 6
ci_08                -3.560330e-03 3 1  ON 7
ci_09                -1.077243e-02 3 1  ON 8
ci_10                -1.111867e-02 3 1  ON 9
ci_11                 1.630921e-02 3 1  ON 10
ci_12                 1.083686e-02 3 1  ON 11
ci_13                 1.196491e-02 3 1  ON 12
ci_14                 1.749850e-02 3 1  ON 13
ci_15                 7.330591e-03 3 1  ON 14
ci_16                 7.510194e-03 3 1  ON 15
ci_17                -9.154934e-03 3 1  ON 16
ci_18                -8.984515e-03 3 1  ON 17
ci_19                 9.463023e-03 3 1  ON 18
ci_20                 9.942880e-03 3 1  ON 19
ci_21                 8.531647e-03 3 1  ON 20
ci_22                 8.379933e-03 3 1  ON 21
ci_23                 6.345447e-03 3 1  ON 22
ci_24                 7.953321e-03 3 1  ON 23
ci_25                 4.939267e-03 3 1  ON 24
ci_26                 2.727213e-03 3 1  ON 25
ci_27                 2.688928e-03 3 1  ON 26
ci_28                 3.354580e-03 3 1  ON 27
ci_29                 2.926462e-03 3 1  ON 28
ci_30                 2.582068e-04 3 1  ON 29
ci_31                 7.662121e-04 3 1  ON 30
ci_32                 4.995177e-05 3 1  ON 31
ci_33                 3.192343e-04 3 1  ON 32
ci_34                 2.158113e-06 3 1  ON 33
ci_35                -6.907242e-05 3 1  ON 34
ci_36                -3.284168e-04 3 1  ON 35
ci_37                -4.841384e-04 3 1  ON 36
ci_38                -2.013808e-04 3 1  ON 37
ci_39                -1.613525e-04 3 1  ON 38
ci_40                -1.172778e-03 3 1  ON 39
ci_41                 3.405481e-05 3 1  ON 40
ci_42                 2.827825e-04 3 1  ON 41
ci_43                -2.531896e-03 3 1  ON 42
ci_44                -2.588583e-03 3 1  ON 43
ci_45                -1.848568e-05 3 1  ON 44
ci_46                -1.036823e-04 3 1  ON 45
ci_47                -7.446855e-08 3 1  ON 46
ci_48                -1.657008e-04 3 1  ON 47
ci_49                -3.184857e-04 3 1  ON 48
ci_50                -5.103979e-04 3 1  ON 49
ci_51                -6.112299e-06 3 1  ON 50
ci_52                -2.824998e-04 3 1  ON 51
ci_53                -9.947826e-04 3 1  ON 52
ci_54                -7.258282e-04 3 1  ON 53
ci_55                -8.428203e-04 3 1  ON 54
ci_56                 1.785325e-03 3 1  ON 55
ci_57                 1.696328e-03 3 1  ON 56
ci_58                -1.000791e-03 3 1  ON 57
ci_59                -1.374138e-03 3 1  ON 58
ci_60                 1.198832e-03 3 1  ON 59
ci_61                 1.907726e-03 3 1  ON 60
ci_62                -1.301048e-04 3 1  ON 61
ci_63                -1.245547e-04 3 1  ON 62
ci_64                 9.715207e-04 3 1  ON 63
ci_65                -1.195524e-03 3 1  ON 64
ci_66                -2.364780e-04 3 1  ON 65
ci_67                -7.234853e-04 3 1  ON 66
ci_68                -1.762559e-03 3 1  ON 67
ci_69                -1.300202e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8738
    reference variance = 0.471758
====================================================
  Execution time = 1.0425e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0254e-01
  Total weights = 7.8573e+06
  Execution time = 1.4598e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0302831
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491504315608
                                         uncertainty =       0.004209156348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491504315608
                                         uncertainty =       0.004209156348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247868154
  error estimate for blocks of size 2^( 2) =       0.000256924780
  error estimate for blocks of size 2^( 3) =       0.000265065099
  error estimate for blocks of size 2^( 4) =       0.000270798390
  error estimate for blocks of size 2^( 5) =       0.000273982620
  error estimate for blocks of size 2^( 6) =       0.000275725163
  error estimate for blocks of size 2^( 7) =       0.000275751887
  error estimate for blocks of size 2^( 8) =       0.000275927439
  error estimate for blocks of size 2^( 9) =       0.000275880952

      target function =                  N/A
              le_mean =     -22.824666348190
             les_mean =     522.398377842793
             stat err =       0.000275821360
             autocorr =       1.238267081672
              std dev =       0.701077009316
             le_variance =       0.491508972991

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.177564
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487243918086
                                         uncertainty =       0.001378525821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487243918086
                                         uncertainty =       0.001378525821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246790401
  error estimate for blocks of size 2^( 2) =       0.000255889473
  error estimate for blocks of size 2^( 3) =       0.000264056447
  error estimate for blocks of size 2^( 4) =       0.000269845874
  error estimate for blocks of size 2^( 5) =       0.000273058061
  error estimate for blocks of size 2^( 6) =       0.000274822110
  error estimate for blocks of size 2^( 7) =       0.000274869656
  error estimate for blocks of size 2^( 8) =       0.000275114761
  error estimate for blocks of size 2^( 9) =       0.000274999296

      target function =                  N/A
              le_mean =     -22.824686657353
             les_mean =     521.522073500429
             stat err =       0.000274951456
             autocorr =       1.241239308329
              std dev =       0.698028663816
             le_variance =       0.487244015508

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0303054
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487399267858
                                         uncertainty =       0.001381235632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487399267858
                                         uncertainty =       0.001381235632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246829754
  error estimate for blocks of size 2^( 2) =       0.000255925263
  error estimate for blocks of size 2^( 3) =       0.000264091984
  error estimate for blocks of size 2^( 4) =       0.000269881593
  error estimate for blocks of size 2^( 5) =       0.000273089724
  error estimate for blocks of size 2^( 6) =       0.000274851285
  error estimate for blocks of size 2^( 7) =       0.000274908596
  error estimate for blocks of size 2^( 8) =       0.000275144156
  error estimate for blocks of size 2^( 9) =       0.000274972308

      target function =                  N/A
              le_mean =     -22.824684211336
             les_mean =     521.665451829146
             stat err =       0.000274969086
             autocorr =       1.241002684905
              std dev =       0.698139970528
             le_variance =       0.487399418449

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.216652
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487207292913
                                         uncertainty =       0.001378259444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487207292913
                                         uncertainty =       0.001378259444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246781116
  error estimate for blocks of size 2^( 2) =       0.000255873513
  error estimate for blocks of size 2^( 3) =       0.000264038840
  error estimate for blocks of size 2^( 4) =       0.000269830214
  error estimate for blocks of size 2^( 5) =       0.000273039095
  error estimate for blocks of size 2^( 6) =       0.000274806807
  error estimate for blocks of size 2^( 7) =       0.000274847799
  error estimate for blocks of size 2^( 8) =       0.000275070084
  error estimate for blocks of size 2^( 9) =       0.000274949135

      target function =                  N/A
              le_mean =     -22.824683052638
             les_mean =     521.581023912323
             stat err =       0.000274918456
             autocorr =       1.241034761050
              std dev =       0.698002401100
             le_variance =       0.487207351942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824666348190        initial
     6.2500e-02     6.2500e-01             2.1210e-03       -22.824686657353  <--
     2.5000e-01     2.5000e+00             1.2886e-03       -22.824684211336
     1.0000e+00     1.0000e+01             5.0179e-04       -22.824683052638

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 1.7712e+02
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.087348e-01 3 1  ON 0
ci_02                -2.228922e-02 3 1  ON 1
ci_03                -2.230327e-02 3 1  ON 2
ci_04                 2.132284e-02 3 1  ON 3
ci_05                -2.200018e-02 3 1  ON 4
ci_06                -2.147068e-02 3 1  ON 5
ci_07                 2.582175e-02 3 1  ON 6
ci_08                -3.483728e-03 3 1  ON 7
ci_09                -1.045155e-02 3 1  ON 8
ci_10                -1.106142e-02 3 1  ON 9
ci_11                 1.616010e-02 3 1  ON 10
ci_12                 1.082532e-02 3 1  ON 11
ci_13                 1.182207e-02 3 1  ON 12
ci_14                 1.756097e-02 3 1  ON 13
ci_15                 7.717793e-03 3 1  ON 14
ci_16                 7.394533e-03 3 1  ON 15
ci_17                -9.364958e-03 3 1  ON 16
ci_18                -8.930912e-03 3 1  ON 17
ci_19                 9.424345e-03 3 1  ON 18
ci_20                 9.348278e-03 3 1  ON 19
ci_21                 8.468797e-03 3 1  ON 20
ci_22                 8.433654e-03 3 1  ON 21
ci_23                 6.402762e-03 3 1  ON 22
ci_24                 8.318166e-03 3 1  ON 23
ci_25                 4.993714e-03 3 1  ON 24
ci_26                 2.901083e-03 3 1  ON 25
ci_27                 2.445518e-03 3 1  ON 26
ci_28                 3.486162e-03 3 1  ON 27
ci_29                 3.130706e-03 3 1  ON 28
ci_30                 8.388414e-05 3 1  ON 29
ci_31                 8.668823e-04 3 1  ON 30
ci_32                 4.189286e-05 3 1  ON 31
ci_33                 4.449808e-04 3 1  ON 32
ci_34                 1.935904e-04 3 1  ON 33
ci_35                 2.293509e-04 3 1  ON 34
ci_36                -3.726399e-04 3 1  ON 35
ci_37                -5.505407e-04 3 1  ON 36
ci_38                -3.087775e-04 3 1  ON 37
ci_39                -2.524918e-04 3 1  ON 38
ci_40                -1.141722e-03 3 1  ON 39
ci_41                -2.281443e-05 3 1  ON 40
ci_42                 3.472292e-04 3 1  ON 41
ci_43                -2.776917e-03 3 1  ON 42
ci_44                -3.044853e-03 3 1  ON 43
ci_45                 5.673092e-05 3 1  ON 44
ci_46                -1.981947e-04 3 1  ON 45
ci_47                 6.285831e-05 3 1  ON 46
ci_48                -2.407413e-04 3 1  ON 47
ci_49                 2.400711e-04 3 1  ON 48
ci_50                -5.154334e-04 3 1  ON 49
ci_51                -1.003525e-04 3 1  ON 50
ci_52                -3.014539e-04 3 1  ON 51
ci_53                -1.130566e-03 3 1  ON 52
ci_54                -7.059469e-04 3 1  ON 53
ci_55                -9.746703e-04 3 1  ON 54
ci_56                 1.711422e-03 3 1  ON 55
ci_57                 1.551722e-03 3 1  ON 56
ci_58                -9.173147e-04 3 1  ON 57
ci_59                -1.312463e-03 3 1  ON 58
ci_60                 1.479926e-03 3 1  ON 59
ci_61                 1.536963e-03 3 1  ON 60
ci_62                -1.306971e-04 3 1  ON 61
ci_63                -4.810345e-05 3 1  ON 62
ci_64                 1.803912e-03 3 1  ON 63
ci_65                -1.594255e-03 3 1  ON 64
ci_66                -1.766910e-04 3 1  ON 65
ci_67                -8.811171e-04 3 1  ON 66
ci_68                -1.613594e-03 3 1  ON 67
ci_69                -1.172565e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9699e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2841e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.9063
    reference variance = 0.88004
====================================================
  Execution time = 1.0141e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1363e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0413e-01
  Total weights = 7.857094675e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8588e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487742306525
                                         uncertainty =       0.001427928546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487742306525
                                         uncertainty =       0.001427928546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246916610
  error estimate for blocks of size 2^( 2) =       0.000255911534
  error estimate for blocks of size 2^( 3) =       0.000264177433
  error estimate for blocks of size 2^( 4) =       0.000270220265
  error estimate for blocks of size 2^( 5) =       0.000273996895
  error estimate for blocks of size 2^( 6) =       0.000275503027
  error estimate for blocks of size 2^( 7) =       0.000276860056
  error estimate for blocks of size 2^( 8) =       0.000277055452
  error estimate for blocks of size 2^( 9) =       0.000277255779

      target function =                  N/A
              le_mean =     -22.824629604613
             les_mean =     521.467849467071
             stat err =       0.000276668579
             autocorr =       1.255506789932
              std dev =       0.698385637500
             le_variance =       0.487742498666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282462960461e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824629604610       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824660674577       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824659969392       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824659665353       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824659974243       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824660026486       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-02 is 2.157953e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824629604610       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824655353441       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824654832769       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824654673682       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824654796129       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.799028e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824629604610       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824644885311       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824644764708       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824644735766       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.092349e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2002e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.092761e-01 3 1  ON 0
ci_02                -2.227152e-02 3 1  ON 1
ci_03                -2.204226e-02 3 1  ON 2
ci_04                 2.174399e-02 3 1  ON 3
ci_05                -2.142705e-02 3 1  ON 4
ci_06                -2.172992e-02 3 1  ON 5
ci_07                 2.609636e-02 3 1  ON 6
ci_08                -3.595818e-03 3 1  ON 7
ci_09                -1.048134e-02 3 1  ON 8
ci_10                -1.108498e-02 3 1  ON 9
ci_11                 1.616313e-02 3 1  ON 10
ci_12                 1.073315e-02 3 1  ON 11
ci_13                 1.278289e-02 3 1  ON 12
ci_14                 1.706515e-02 3 1  ON 13
ci_15                 7.850565e-03 3 1  ON 14
ci_16                 7.417588e-03 3 1  ON 15
ci_17                -8.754340e-03 3 1  ON 16
ci_18                -8.415806e-03 3 1  ON 17
ci_19                 9.385640e-03 3 1  ON 18
ci_20                 9.669853e-03 3 1  ON 19
ci_21                 8.678023e-03 3 1  ON 20
ci_22                 8.110590e-03 3 1  ON 21
ci_23                 6.456629e-03 3 1  ON 22
ci_24                 7.774845e-03 3 1  ON 23
ci_25                 4.831909e-03 3 1  ON 24
ci_26                 2.413989e-03 3 1  ON 25
ci_27                 3.084585e-03 3 1  ON 26
ci_28                 3.107672e-03 3 1  ON 27
ci_29                 3.395368e-03 3 1  ON 28
ci_30                 3.363051e-04 3 1  ON 29
ci_31                 1.194043e-03 3 1  ON 30
ci_32                 3.742933e-05 3 1  ON 31
ci_33                -9.961685e-05 3 1  ON 32
ci_34                 2.914405e-04 3 1  ON 33
ci_35                -3.680454e-04 3 1  ON 34
ci_36                -5.360253e-04 3 1  ON 35
ci_37                -7.625455e-04 3 1  ON 36
ci_38                -2.392892e-04 3 1  ON 37
ci_39                -1.539354e-04 3 1  ON 38
ci_40                -1.209705e-03 3 1  ON 39
ci_41                -3.239741e-04 3 1  ON 40
ci_42                 4.361266e-04 3 1  ON 41
ci_43                -2.454170e-03 3 1  ON 42
ci_44                -2.934141e-03 3 1  ON 43
ci_45                -1.019650e-04 3 1  ON 44
ci_46                -1.985272e-04 3 1  ON 45
ci_47                -2.369805e-05 3 1  ON 46
ci_48                -6.885374e-05 3 1  ON 47
ci_49                -1.471195e-03 3 1  ON 48
ci_50                -5.882634e-04 3 1  ON 49
ci_51                -5.811001e-05 3 1  ON 50
ci_52                -1.768552e-04 3 1  ON 51
ci_53                -1.205011e-03 3 1  ON 52
ci_54                -8.191784e-04 3 1  ON 53
ci_55                -1.444278e-03 3 1  ON 54
ci_56                 1.673064e-03 3 1  ON 55
ci_57                 1.636754e-03 3 1  ON 56
ci_58                -1.260446e-03 3 1  ON 57
ci_59                -1.473861e-03 3 1  ON 58
ci_60                 1.238884e-03 3 1  ON 59
ci_61                 1.518672e-03 3 1  ON 60
ci_62                -2.306789e-04 3 1  ON 61
ci_63                -1.959664e-04 3 1  ON 62
ci_64                 4.883787e-06 3 1  ON 63
ci_65                -4.387705e-04 3 1  ON 64
ci_66                -3.429177e-04 3 1  ON 65
ci_67                -7.296334e-04 3 1  ON 66
ci_68                -1.226715e-03 3 1  ON 67
ci_69                -1.549827e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8796
    reference variance = 0.569722
====================================================
  Execution time = 1.0378e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0267e-01
  Total weights = 7.8568e+06
  Execution time = 1.4608e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491824150126
                                         uncertainty =       0.004641387071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491824150126
                                         uncertainty =       0.004641387071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247947177
  error estimate for blocks of size 2^( 2) =       0.000257110519
  error estimate for blocks of size 2^( 3) =       0.000265430605
  error estimate for blocks of size 2^( 4) =       0.000271308704
  error estimate for blocks of size 2^( 5) =       0.000274850887
  error estimate for blocks of size 2^( 6) =       0.000276836206
  error estimate for blocks of size 2^( 7) =       0.000278602584
  error estimate for blocks of size 2^( 8) =       0.000279142344
  error estimate for blocks of size 2^( 9) =       0.000279778109

      target function =                  N/A
              le_mean =     -22.824758807072
             les_mean =     524.224675037120
             stat err =       0.000278589811
             autocorr =       1.262443994966
              std dev =       0.701300521391
             le_variance =       0.491822421303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486971361504
                                         uncertainty =       0.001238472957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486971361504
                                         uncertainty =       0.001238472957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246721210
  error estimate for blocks of size 2^( 2) =       0.000255912425
  error estimate for blocks of size 2^( 3) =       0.000264255290
  error estimate for blocks of size 2^( 4) =       0.000270145954
  error estimate for blocks of size 2^( 5) =       0.000273711295
  error estimate for blocks of size 2^( 6) =       0.000275668056
  error estimate for blocks of size 2^( 7) =       0.000277403814
  error estimate for blocks of size 2^( 8) =       0.000277974312
  error estimate for blocks of size 2^( 9) =       0.000278606539

      target function =                  N/A
              le_mean =     -22.824768086600
             les_mean =     521.863659994866
             stat err =       0.000277413180
             autocorr =       1.264274006000
              std dev =       0.697832962787
             le_variance =       0.486970843951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487135445838
                                         uncertainty =       0.001217349882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487135445838
                                         uncertainty =       0.001217349882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246762836
  error estimate for blocks of size 2^( 2) =       0.000255951232
  error estimate for blocks of size 2^( 3) =       0.000264291331
  error estimate for blocks of size 2^( 4) =       0.000270183497
  error estimate for blocks of size 2^( 5) =       0.000273745978
  error estimate for blocks of size 2^( 6) =       0.000275690206
  error estimate for blocks of size 2^( 7) =       0.000277411589
  error estimate for blocks of size 2^( 8) =       0.000277991812
  error estimate for blocks of size 2^( 9) =       0.000278649588

      target function =                  N/A
              le_mean =     -22.824776992865
             les_mean =     521.566434042181
             stat err =       0.000277435799
             autocorr =       1.264053611575
              std dev =       0.697950698012
             le_variance =       0.487135176855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486805852578
                                         uncertainty =       0.001213692365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486805852578
                                         uncertainty =       0.001213692365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246679332
  error estimate for blocks of size 2^( 2) =       0.000255875817
  error estimate for blocks of size 2^( 3) =       0.000264222314
  error estimate for blocks of size 2^( 4) =       0.000270118722
  error estimate for blocks of size 2^( 5) =       0.000273683542
  error estimate for blocks of size 2^( 6) =       0.000275638993
  error estimate for blocks of size 2^( 7) =       0.000277377238
  error estimate for blocks of size 2^( 8) =       0.000277878003
  error estimate for blocks of size 2^( 9) =       0.000278548026

      target function =                  N/A
              le_mean =     -22.824768281800
             les_mean =     521.483394233509
             stat err =       0.000277360565
             autocorr =       1.264223616213
              std dev =       0.697714514580
             le_variance =       0.486805543856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824758807072        initial
     1.5625e-02     1.5625e-01             2.1580e-03       -22.824768086600
     6.2500e-02     6.2500e-01             1.7990e-03       -22.824776992865  <--
     2.5000e-01     2.5000e+00             1.0923e-03       -22.824768281800

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 1.7673e+02
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.092761e-01 3 1  ON 0
ci_02                -2.227152e-02 3 1  ON 1
ci_03                -2.204226e-02 3 1  ON 2
ci_04                 2.174399e-02 3 1  ON 3
ci_05                -2.142705e-02 3 1  ON 4
ci_06                -2.172992e-02 3 1  ON 5
ci_07                 2.609636e-02 3 1  ON 6
ci_08                -3.595818e-03 3 1  ON 7
ci_09                -1.048134e-02 3 1  ON 8
ci_10                -1.108498e-02 3 1  ON 9
ci_11                 1.616313e-02 3 1  ON 10
ci_12                 1.073315e-02 3 1  ON 11
ci_13                 1.278289e-02 3 1  ON 12
ci_14                 1.706515e-02 3 1  ON 13
ci_15                 7.850565e-03 3 1  ON 14
ci_16                 7.417588e-03 3 1  ON 15
ci_17                -8.754340e-03 3 1  ON 16
ci_18                -8.415806e-03 3 1  ON 17
ci_19                 9.385640e-03 3 1  ON 18
ci_20                 9.669853e-03 3 1  ON 19
ci_21                 8.678023e-03 3 1  ON 20
ci_22                 8.110590e-03 3 1  ON 21
ci_23                 6.456629e-03 3 1  ON 22
ci_24                 7.774845e-03 3 1  ON 23
ci_25                 4.831909e-03 3 1  ON 24
ci_26                 2.413989e-03 3 1  ON 25
ci_27                 3.084585e-03 3 1  ON 26
ci_28                 3.107672e-03 3 1  ON 27
ci_29                 3.395368e-03 3 1  ON 28
ci_30                 3.363051e-04 3 1  ON 29
ci_31                 1.194043e-03 3 1  ON 30
ci_32                 3.742933e-05 3 1  ON 31
ci_33                -9.961685e-05 3 1  ON 32
ci_34                 2.914405e-04 3 1  ON 33
ci_35                -3.680454e-04 3 1  ON 34
ci_36                -5.360253e-04 3 1  ON 35
ci_37                -7.625455e-04 3 1  ON 36
ci_38                -2.392892e-04 3 1  ON 37
ci_39                -1.539354e-04 3 1  ON 38
ci_40                -1.209705e-03 3 1  ON 39
ci_41                -3.239741e-04 3 1  ON 40
ci_42                 4.361266e-04 3 1  ON 41
ci_43                -2.454170e-03 3 1  ON 42
ci_44                -2.934141e-03 3 1  ON 43
ci_45                -1.019650e-04 3 1  ON 44
ci_46                -1.985272e-04 3 1  ON 45
ci_47                -2.369805e-05 3 1  ON 46
ci_48                -6.885374e-05 3 1  ON 47
ci_49                -1.471195e-03 3 1  ON 48
ci_50                -5.882634e-04 3 1  ON 49
ci_51                -5.811001e-05 3 1  ON 50
ci_52                -1.768552e-04 3 1  ON 51
ci_53                -1.205011e-03 3 1  ON 52
ci_54                -8.191784e-04 3 1  ON 53
ci_55                -1.444278e-03 3 1  ON 54
ci_56                 1.673064e-03 3 1  ON 55
ci_57                 1.636754e-03 3 1  ON 56
ci_58                -1.260446e-03 3 1  ON 57
ci_59                -1.473861e-03 3 1  ON 58
ci_60                 1.238884e-03 3 1  ON 59
ci_61                 1.518672e-03 3 1  ON 60
ci_62                -2.306789e-04 3 1  ON 61
ci_63                -1.959664e-04 3 1  ON 62
ci_64                 4.883787e-06 3 1  ON 63
ci_65                -4.387705e-04 3 1  ON 64
ci_66                -3.429177e-04 3 1  ON 65
ci_67                -7.296334e-04 3 1  ON 66
ci_68                -1.226715e-03 3 1  ON 67
ci_69                -1.549827e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9676e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2859e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8338
    reference variance = 0.421792
====================================================
  Execution time = 1.0138e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1382e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0126e-01
  Total weights = 7.856739366e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8783e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486335102516
                                         uncertainty =       0.001291637919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486335102516
                                         uncertainty =       0.001291637919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246560848
  error estimate for blocks of size 2^( 2) =       0.000255742855
  error estimate for blocks of size 2^( 3) =       0.000263954382
  error estimate for blocks of size 2^( 4) =       0.000269852599
  error estimate for blocks of size 2^( 5) =       0.000273172535
  error estimate for blocks of size 2^( 6) =       0.000275354685
  error estimate for blocks of size 2^( 7) =       0.000276673344
  error estimate for blocks of size 2^( 8) =       0.000277050754
  error estimate for blocks of size 2^( 9) =       0.000276830092

      target function =                  N/A
              le_mean =     -22.824924709892
             les_mean =     521.478450097982
             stat err =       0.000276477219
             autocorr =       1.257391370258
              std dev =       0.697379389288
             le_variance =       0.486338012604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282492470989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824924709887       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824937935011       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824939584109       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824939048661       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824939096801       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824939078832       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-02 is 1.479528e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824924709887       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824935431504       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824936305780       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824936014861       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824936038290       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.083626e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824924709887       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824930811425       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824931017079       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824930962883       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.331750e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2018e+02
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.084223e-01 3 1  ON 0
ci_02                -2.269629e-02 3 1  ON 1
ci_03                -2.179822e-02 3 1  ON 2
ci_04                 2.169727e-02 3 1  ON 3
ci_05                -2.172308e-02 3 1  ON 4
ci_06                -2.215199e-02 3 1  ON 5
ci_07                 2.621092e-02 3 1  ON 6
ci_08                -3.518161e-03 3 1  ON 7
ci_09                -1.108994e-02 3 1  ON 8
ci_10                -1.085552e-02 3 1  ON 9
ci_11                 1.702626e-02 3 1  ON 10
ci_12                 1.101091e-02 3 1  ON 11
ci_13                 1.237486e-02 3 1  ON 12
ci_14                 1.688636e-02 3 1  ON 13
ci_15                 7.807594e-03 3 1  ON 14
ci_16                 7.383162e-03 3 1  ON 15
ci_17                -9.208318e-03 3 1  ON 16
ci_18                -9.068337e-03 3 1  ON 17
ci_19                 9.860203e-03 3 1  ON 18
ci_20                 1.051464e-02 3 1  ON 19
ci_21                 8.078121e-03 3 1  ON 20
ci_22                 8.475635e-03 3 1  ON 21
ci_23                 6.724061e-03 3 1  ON 22
ci_24                 7.658471e-03 3 1  ON 23
ci_25                 5.530414e-03 3 1  ON 24
ci_26                 2.763588e-03 3 1  ON 25
ci_27                 2.639785e-03 3 1  ON 26
ci_28                 3.244213e-03 3 1  ON 27
ci_29                 3.061123e-03 3 1  ON 28
ci_30                 8.297903e-04 3 1  ON 29
ci_31                 1.104171e-04 3 1  ON 30
ci_32                -7.612709e-05 3 1  ON 31
ci_33                -1.426181e-04 3 1  ON 32
ci_34                 1.427295e-04 3 1  ON 33
ci_35                -2.803180e-04 3 1  ON 34
ci_36                -6.096054e-04 3 1  ON 35
ci_37                -4.791615e-04 3 1  ON 36
ci_38                -4.239752e-04 3 1  ON 37
ci_39                 8.727057e-05 3 1  ON 38
ci_40                -1.313608e-03 3 1  ON 39
ci_41                -7.858350e-06 3 1  ON 40
ci_42                -2.960953e-05 3 1  ON 41
ci_43                -2.555845e-03 3 1  ON 42
ci_44                -2.837332e-03 3 1  ON 43
ci_45                -1.426106e-06 3 1  ON 44
ci_46                -1.861953e-04 3 1  ON 45
ci_47                -1.276372e-04 3 1  ON 46
ci_48                -7.364731e-05 3 1  ON 47
ci_49                -9.305655e-04 3 1  ON 48
ci_50                -6.773876e-04 3 1  ON 49
ci_51                -4.124189e-05 3 1  ON 50
ci_52                -7.174883e-05 3 1  ON 51
ci_53                -8.767845e-04 3 1  ON 52
ci_54                -7.551324e-04 3 1  ON 53
ci_55                -6.303798e-04 3 1  ON 54
ci_56                 1.930589e-03 3 1  ON 55
ci_57                 1.846471e-03 3 1  ON 56
ci_58                -1.255460e-03 3 1  ON 57
ci_59                -1.452183e-03 3 1  ON 58
ci_60                 2.087252e-03 3 1  ON 59
ci_61                 1.857418e-03 3 1  ON 60
ci_62                -5.911501e-04 3 1  ON 61
ci_63                -1.229884e-04 3 1  ON 62
ci_64                -2.067537e-04 3 1  ON 63
ci_65                -7.058758e-04 3 1  ON 64
ci_66                -2.911490e-04 3 1  ON 65
ci_67                -9.915099e-04 3 1  ON 66
ci_68                -1.272577e-03 3 1  ON 67
ci_69                -1.699938e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.847
    reference variance = 0.3044
====================================================
  Execution time = 1.0370e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0375e-01
  Total weights = 7.8568e+06
  Execution time = 1.4575e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486711262878
                                         uncertainty =       0.001401550633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486711262878
                                         uncertainty =       0.001401550633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246655587
  error estimate for blocks of size 2^( 2) =       0.000255880488
  error estimate for blocks of size 2^( 3) =       0.000264073949
  error estimate for blocks of size 2^( 4) =       0.000269937637
  error estimate for blocks of size 2^( 5) =       0.000273540323
  error estimate for blocks of size 2^( 6) =       0.000275596889
  error estimate for blocks of size 2^( 7) =       0.000276874253
  error estimate for blocks of size 2^( 8) =       0.000277371215
  error estimate for blocks of size 2^( 9) =       0.000278172461

      target function =                  N/A
              le_mean =     -22.824794809719
             les_mean =     521.520754170980
             stat err =       0.000277003705
             autocorr =       1.261215332276
              std dev =       0.697647351412
             le_variance =       0.486711826932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486676998929
                                         uncertainty =       0.001416545706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486676998929
                                         uncertainty =       0.001416545706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246646898
  error estimate for blocks of size 2^( 2) =       0.000255862335
  error estimate for blocks of size 2^( 3) =       0.000264054373
  error estimate for blocks of size 2^( 4) =       0.000269922281
  error estimate for blocks of size 2^( 5) =       0.000273521140
  error estimate for blocks of size 2^( 6) =       0.000275590031
  error estimate for blocks of size 2^( 7) =       0.000276874498
  error estimate for blocks of size 2^( 8) =       0.000277369895
  error estimate for blocks of size 2^( 9) =       0.000278166017

      target function =                  N/A
              le_mean =     -22.824776568885
             les_mean =     521.619413997993
             stat err =       0.000277000110
             autocorr =       1.261271456540
              std dev =       0.697622776947
             le_variance =       0.486677538915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487028469688
                                         uncertainty =       0.001443185253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487028469688
                                         uncertainty =       0.001443185253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246735905
  error estimate for blocks of size 2^( 2) =       0.000255945532
  error estimate for blocks of size 2^( 3) =       0.000264134278
  error estimate for blocks of size 2^( 4) =       0.000269998306
  error estimate for blocks of size 2^( 5) =       0.000273590062
  error estimate for blocks of size 2^( 6) =       0.000275664108
  error estimate for blocks of size 2^( 7) =       0.000276944452
  error estimate for blocks of size 2^( 8) =       0.000277456411
  error estimate for blocks of size 2^( 9) =       0.000278244732

      target function =                  N/A
              le_mean =     -22.824794391926
             les_mean =     521.625363179299
             stat err =       0.000277077426
             autocorr =       1.261065321681
              std dev =       0.697874525786
             le_variance =       0.487028853740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486584780613
                                         uncertainty =       0.001408224795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486584780613
                                         uncertainty =       0.001408224795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246623526
  error estimate for blocks of size 2^( 2) =       0.000255844136
  error estimate for blocks of size 2^( 3) =       0.000264036514
  error estimate for blocks of size 2^( 4) =       0.000269903791
  error estimate for blocks of size 2^( 5) =       0.000273506357
  error estimate for blocks of size 2^( 6) =       0.000275570693
  error estimate for blocks of size 2^( 7) =       0.000276852468
  error estimate for blocks of size 2^( 8) =       0.000277354359
  error estimate for blocks of size 2^( 9) =       0.000278138333

      target function =                  N/A
              le_mean =     -22.824778488502
             les_mean =     521.480031255739
             stat err =       0.000276978963
             autocorr =       1.261317923733
              std dev =       0.697556669599
             le_variance =       0.486585307302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824794809719        initial  <--
     1.5625e-02     1.5625e-01             1.4795e-03       -22.824776568885
     6.2500e-02     6.2500e-01             1.0836e-03       -22.824794391926
     2.5000e-01     2.5000e+00             5.3317e-04       -22.824778488502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 176.4772
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.092761e-01 3 1  ON 0
ci_02                -2.227152e-02 3 1  ON 1
ci_03                -2.204226e-02 3 1  ON 2
ci_04                 2.174399e-02 3 1  ON 3
ci_05                -2.142705e-02 3 1  ON 4
ci_06                -2.172992e-02 3 1  ON 5
ci_07                 2.609636e-02 3 1  ON 6
ci_08                -3.595818e-03 3 1  ON 7
ci_09                -1.048134e-02 3 1  ON 8
ci_10                -1.108498e-02 3 1  ON 9
ci_11                 1.616313e-02 3 1  ON 10
ci_12                 1.073315e-02 3 1  ON 11
ci_13                 1.278289e-02 3 1  ON 12
ci_14                 1.706515e-02 3 1  ON 13
ci_15                 7.850565e-03 3 1  ON 14
ci_16                 7.417588e-03 3 1  ON 15
ci_17                -8.754340e-03 3 1  ON 16
ci_18                -8.415806e-03 3 1  ON 17
ci_19                 9.385640e-03 3 1  ON 18
ci_20                 9.669853e-03 3 1  ON 19
ci_21                 8.678023e-03 3 1  ON 20
ci_22                 8.110590e-03 3 1  ON 21
ci_23                 6.456629e-03 3 1  ON 22
ci_24                 7.774845e-03 3 1  ON 23
ci_25                 4.831909e-03 3 1  ON 24
ci_26                 2.413989e-03 3 1  ON 25
ci_27                 3.084585e-03 3 1  ON 26
ci_28                 3.107672e-03 3 1  ON 27
ci_29                 3.395368e-03 3 1  ON 28
ci_30                 3.363051e-04 3 1  ON 29
ci_31                 1.194043e-03 3 1  ON 30
ci_32                 3.742933e-05 3 1  ON 31
ci_33                -9.961685e-05 3 1  ON 32
ci_34                 2.914405e-04 3 1  ON 33
ci_35                -3.680454e-04 3 1  ON 34
ci_36                -5.360253e-04 3 1  ON 35
ci_37                -7.625455e-04 3 1  ON 36
ci_38                -2.392892e-04 3 1  ON 37
ci_39                -1.539354e-04 3 1  ON 38
ci_40                -1.209705e-03 3 1  ON 39
ci_41                -3.239741e-04 3 1  ON 40
ci_42                 4.361266e-04 3 1  ON 41
ci_43                -2.454170e-03 3 1  ON 42
ci_44                -2.934141e-03 3 1  ON 43
ci_45                -1.019650e-04 3 1  ON 44
ci_46                -1.985272e-04 3 1  ON 45
ci_47                -2.369805e-05 3 1  ON 46
ci_48                -6.885374e-05 3 1  ON 47
ci_49                -1.471195e-03 3 1  ON 48
ci_50                -5.882634e-04 3 1  ON 49
ci_51                -5.811001e-05 3 1  ON 50
ci_52                -1.768552e-04 3 1  ON 51
ci_53                -1.205011e-03 3 1  ON 52
ci_54                -8.191784e-04 3 1  ON 53
ci_55                -1.444278e-03 3 1  ON 54
ci_56                 1.673064e-03 3 1  ON 55
ci_57                 1.636754e-03 3 1  ON 56
ci_58                -1.260446e-03 3 1  ON 57
ci_59                -1.473861e-03 3 1  ON 58
ci_60                 1.238884e-03 3 1  ON 59
ci_61                 1.518672e-03 3 1  ON 60
ci_62                -2.306789e-04 3 1  ON 61
ci_63                -1.959664e-04 3 1  ON 62
ci_64                 4.883787e-06 3 1  ON 63
ci_65                -4.387705e-04 3 1  ON 64
ci_66                -3.429177e-04 3 1  ON 65
ci_67                -7.296334e-04 3 1  ON 66
ci_68                -1.226715e-03 3 1  ON 67
ci_69                -1.549827e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9669e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2854e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8185
    reference variance = 0.318772
====================================================
  Execution time = 1.0089e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1391e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0250e-01
  Total weights = 7.857051272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8809e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485944728892
                                         uncertainty =       0.001131996196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485944728892
                                         uncertainty =       0.001131996196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246461724
  error estimate for blocks of size 2^( 2) =       0.000255754383
  error estimate for blocks of size 2^( 3) =       0.000263998458
  error estimate for blocks of size 2^( 4) =       0.000269739396
  error estimate for blocks of size 2^( 5) =       0.000273378037
  error estimate for blocks of size 2^( 6) =       0.000275292855
  error estimate for blocks of size 2^( 7) =       0.000276748359
  error estimate for blocks of size 2^( 8) =       0.000278064703
  error estimate for blocks of size 2^( 9) =       0.000278254271

      target function =                  N/A
              le_mean =     -22.824880778604
             les_mean =     521.477686962806
             stat err =       0.000277090047
             autocorr =       1.263987815250
              std dev =       0.697099025775
             le_variance =       0.485947051736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282488077860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824880778600       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824886066783       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824886309793       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824886278026       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 9.243415e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824880778600       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824883015377       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824883126947       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824883131060       residual = 4.47e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.643932e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824880778600       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824881454752       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824881497645       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824881506953       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.073590e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013576 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1971e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.092111e-01 3 1  ON 0
ci_02                -2.230461e-02 3 1  ON 1
ci_03                -2.190381e-02 3 1  ON 2
ci_04                 2.191516e-02 3 1  ON 3
ci_05                -2.158420e-02 3 1  ON 4
ci_06                -2.159000e-02 3 1  ON 5
ci_07                 2.599641e-02 3 1  ON 6
ci_08                -3.461076e-03 3 1  ON 7
ci_09                -1.051032e-02 3 1  ON 8
ci_10                -1.144937e-02 3 1  ON 9
ci_11                 1.616363e-02 3 1  ON 10
ci_12                 1.084848e-02 3 1  ON 11
ci_13                 1.256091e-02 3 1  ON 12
ci_14                 1.701882e-02 3 1  ON 13
ci_15                 7.893366e-03 3 1  ON 14
ci_16                 7.541598e-03 3 1  ON 15
ci_17                -8.823260e-03 3 1  ON 16
ci_18                -8.386494e-03 3 1  ON 17
ci_19                 9.552068e-03 3 1  ON 18
ci_20                 1.002450e-02 3 1  ON 19
ci_21                 8.613993e-03 3 1  ON 20
ci_22                 8.089637e-03 3 1  ON 21
ci_23                 6.472652e-03 3 1  ON 22
ci_24                 7.868118e-03 3 1  ON 23
ci_25                 4.976573e-03 3 1  ON 24
ci_26                 2.337178e-03 3 1  ON 25
ci_27                 3.155938e-03 3 1  ON 26
ci_28                 3.082612e-03 3 1  ON 27
ci_29                 3.299395e-03 3 1  ON 28
ci_30                 5.237515e-04 3 1  ON 29
ci_31                 9.828949e-04 3 1  ON 30
ci_32                 3.089253e-04 3 1  ON 31
ci_33                 8.046132e-05 3 1  ON 32
ci_34                 1.863463e-04 3 1  ON 33
ci_35                -2.974605e-04 3 1  ON 34
ci_36                -5.478003e-04 3 1  ON 35
ci_37                -5.972674e-04 3 1  ON 36
ci_38                -1.468929e-04 3 1  ON 37
ci_39                -7.111239e-05 3 1  ON 38
ci_40                -1.396885e-03 3 1  ON 39
ci_41                -1.984054e-04 3 1  ON 40
ci_42                 3.501252e-04 3 1  ON 41
ci_43                -2.513516e-03 3 1  ON 42
ci_44                -2.934039e-03 3 1  ON 43
ci_45                -3.742759e-05 3 1  ON 44
ci_46                -1.583862e-04 3 1  ON 45
ci_47                -5.076999e-05 3 1  ON 46
ci_48                -1.355148e-05 3 1  ON 47
ci_49                -1.504485e-03 3 1  ON 48
ci_50                -4.505339e-04 3 1  ON 49
ci_51                -1.337091e-04 3 1  ON 50
ci_52                -5.051228e-05 3 1  ON 51
ci_53                -1.082448e-03 3 1  ON 52
ci_54                -7.569593e-04 3 1  ON 53
ci_55                -1.184238e-03 3 1  ON 54
ci_56                 1.758276e-03 3 1  ON 55
ci_57                 1.803929e-03 3 1  ON 56
ci_58                -1.335596e-03 3 1  ON 57
ci_59                -1.605803e-03 3 1  ON 58
ci_60                 1.411526e-03 3 1  ON 59
ci_61                 1.445868e-03 3 1  ON 60
ci_62                -1.610980e-04 3 1  ON 61
ci_63                -1.870518e-05 3 1  ON 62
ci_64                -1.208076e-04 3 1  ON 63
ci_65                -4.621679e-04 3 1  ON 64
ci_66                -3.860857e-04 3 1  ON 65
ci_67                -7.647097e-04 3 1  ON 66
ci_68                -1.364917e-03 3 1  ON 67
ci_69                -1.517073e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7668
    reference variance = 0.39499
====================================================
  Execution time = 1.0352e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0481e-01
  Total weights = 7.8567e+06
  Execution time = 1.4627e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.104721
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487096718849
                                         uncertainty =       0.001372260349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487096718849
                                         uncertainty =       0.001372260349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246753812
  error estimate for blocks of size 2^( 2) =       0.000256020420
  error estimate for blocks of size 2^( 3) =       0.000264217686
  error estimate for blocks of size 2^( 4) =       0.000270183970
  error estimate for blocks of size 2^( 5) =       0.000273585857
  error estimate for blocks of size 2^( 6) =       0.000275417850
  error estimate for blocks of size 2^( 7) =       0.000275922572
  error estimate for blocks of size 2^( 8) =       0.000275821961
  error estimate for blocks of size 2^( 9) =       0.000276387524

      target function =                  N/A
              le_mean =     -22.824654227555
             les_mean =     521.491570447546
             stat err =       0.000275887477
             autocorr =       1.250075472074
              std dev =       0.697925174340
             le_variance =       0.487099548977

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0189214
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487125308541
                                         uncertainty =       0.001352227708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487125308541
                                         uncertainty =       0.001352227708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246761044
  error estimate for blocks of size 2^( 2) =       0.000256024755
  error estimate for blocks of size 2^( 3) =       0.000264224833
  error estimate for blocks of size 2^( 4) =       0.000270190697
  error estimate for blocks of size 2^( 5) =       0.000273586533
  error estimate for blocks of size 2^( 6) =       0.000275432534
  error estimate for blocks of size 2^( 7) =       0.000275955210
  error estimate for blocks of size 2^( 8) =       0.000275851645
  error estimate for blocks of size 2^( 9) =       0.000276390876

      target function =                  N/A
              le_mean =     -22.824653376479
             les_mean =     521.527467618460
             stat err =       0.000275907566
             autocorr =       1.250184250076
              std dev =       0.697945630269
             le_variance =       0.487128102812

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.107372
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487059021293
                                         uncertainty =       0.001353391139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487059021293
                                         uncertainty =       0.001353391139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246744263
  error estimate for blocks of size 2^( 2) =       0.000256008263
  error estimate for blocks of size 2^( 3) =       0.000264208097
  error estimate for blocks of size 2^( 4) =       0.000270174929
  error estimate for blocks of size 2^( 5) =       0.000273569772
  error estimate for blocks of size 2^( 6) =       0.000275409451
  error estimate for blocks of size 2^( 7) =       0.000275928804
  error estimate for blocks of size 2^( 8) =       0.000275823510
  error estimate for blocks of size 2^( 9) =       0.000276372327

      target function =                  N/A
              le_mean =     -22.824652077439
             les_mean =     521.480507174062
             stat err =       0.000275883523
             autocorr =       1.250136398239
              std dev =       0.697898165611
             le_variance =       0.487061849563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487814686140
                                         uncertainty =       0.001566756426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487814686140
                                         uncertainty =       0.001566756426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246935461
  error estimate for blocks of size 2^( 2) =       0.000256195175
  error estimate for blocks of size 2^( 3) =       0.000264382013
  error estimate for blocks of size 2^( 4) =       0.000270334986
  error estimate for blocks of size 2^( 5) =       0.000273733815
  error estimate for blocks of size 2^( 6) =       0.000275560241
  error estimate for blocks of size 2^( 7) =       0.000276065531
  error estimate for blocks of size 2^( 8) =       0.000275965472
  error estimate for blocks of size 2^( 9) =       0.000276540229

      target function =                  N/A
              le_mean =     -22.824660327794
             les_mean =     534.302105882619
             stat err =       0.000276032868
             autocorr =       1.249552983942
              std dev =       0.698438954732
             le_variance =       0.487816973487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824654227555        initial
     1.5625e-01     1.5625e+00             9.2434e-04       -22.824653376479
     6.2500e-01     6.2500e+00             3.6439e-04       -22.824652077439
     2.5000e+00     2.5000e+01             1.0736e-04       -22.824660327794  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 1.7659e+02
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.092578e-01 3 1  ON 0
ci_02                -2.228301e-02 3 1  ON 1
ci_03                -2.200250e-02 3 1  ON 2
ci_04                 2.179703e-02 3 1  ON 3
ci_05                -2.147289e-02 3 1  ON 4
ci_06                -2.168990e-02 3 1  ON 5
ci_07                 2.606785e-02 3 1  ON 6
ci_08                -3.551250e-03 3 1  ON 7
ci_09                -1.048996e-02 3 1  ON 8
ci_10                -1.119176e-02 3 1  ON 9
ci_11                 1.616359e-02 3 1  ON 10
ci_12                 1.076818e-02 3 1  ON 11
ci_13                 1.271959e-02 3 1  ON 12
ci_14                 1.705388e-02 3 1  ON 13
ci_15                 7.864158e-03 3 1  ON 14
ci_16                 7.455514e-03 3 1  ON 15
ci_17                -8.774562e-03 3 1  ON 16
ci_18                -8.408180e-03 3 1  ON 17
ci_19                 9.440471e-03 3 1  ON 18
ci_20                 9.777212e-03 3 1  ON 19
ci_21                 8.662535e-03 3 1  ON 20
ci_22                 8.105289e-03 3 1  ON 21
ci_23                 6.462951e-03 3 1  ON 22
ci_24                 7.800912e-03 3 1  ON 23
ci_25                 4.877134e-03 3 1  ON 24
ci_26                 2.393029e-03 3 1  ON 25
ci_27                 3.106445e-03 3 1  ON 26
ci_28                 3.099178e-03 3 1  ON 27
ci_29                 3.367370e-03 3 1  ON 28
ci_30                 3.903324e-04 3 1  ON 29
ci_31                 1.135500e-03 3 1  ON 30
ci_32                 1.231320e-04 3 1  ON 31
ci_33                -4.315273e-05 3 1  ON 32
ci_34                 2.590168e-04 3 1  ON 33
ci_35                -3.472750e-04 3 1  ON 34
ci_36                -5.381652e-04 3 1  ON 35
ci_37                -7.069217e-04 3 1  ON 36
ci_38                -2.093032e-04 3 1  ON 37
ci_39                -1.261357e-04 3 1  ON 38
ci_40                -1.273345e-03 3 1  ON 39
ci_41                -2.837905e-04 3 1  ON 40
ci_42                 4.081952e-04 3 1  ON 41
ci_43                -2.472128e-03 3 1  ON 42
ci_44                -2.936016e-03 3 1  ON 43
ci_45                -7.958393e-05 3 1  ON 44
ci_46                -1.854858e-04 3 1  ON 45
ci_47                -3.047891e-05 3 1  ON 46
ci_48                -5.466641e-05 3 1  ON 47
ci_49                -1.482108e-03 3 1  ON 48
ci_50                -5.397559e-04 3 1  ON 49
ci_51                -8.164040e-05 3 1  ON 50
ci_52                -1.358677e-04 3 1  ON 51
ci_53                -1.163571e-03 3 1  ON 52
ci_54                -7.996712e-04 3 1  ON 53
ci_55                -1.365305e-03 3 1  ON 54
ci_56                 1.701159e-03 3 1  ON 55
ci_57                 1.691343e-03 3 1  ON 56
ci_58                -1.284105e-03 3 1  ON 57
ci_59                -1.514579e-03 3 1  ON 58
ci_60                 1.285041e-03 3 1  ON 59
ci_61                 1.499346e-03 3 1  ON 60
ci_62                -2.076650e-04 3 1  ON 61
ci_63                -1.372781e-04 3 1  ON 62
ci_64                -3.293815e-05 3 1  ON 63
ci_65                -4.452828e-04 3 1  ON 64
ci_66                -3.574535e-04 3 1  ON 65
ci_67                -7.416460e-04 3 1  ON 66
ci_68                -1.268849e-03 3 1  ON 67
ci_69                -1.540326e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9631e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2842e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7761
    reference variance = 0.365872
====================================================
  Execution time = 1.0118e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1294e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0155e-01
  Total weights = 7.856451191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8854e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486479896603
                                         uncertainty =       0.001693403815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486479896603
                                         uncertainty =       0.001693403815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246596644
  error estimate for blocks of size 2^( 2) =       0.000255740301
  error estimate for blocks of size 2^( 3) =       0.000264125523
  error estimate for blocks of size 2^( 4) =       0.000270092222
  error estimate for blocks of size 2^( 5) =       0.000273731794
  error estimate for blocks of size 2^( 6) =       0.000275603020
  error estimate for blocks of size 2^( 7) =       0.000276189262
  error estimate for blocks of size 2^( 8) =       0.000276134338
  error estimate for blocks of size 2^( 9) =       0.000275915158

      target function =                  N/A
              le_mean =     -22.824397474774
             les_mean =     521.454666817573
             stat err =       0.000275960444
             autocorr =       1.252331627702
              std dev =       0.697480635521
             le_variance =       0.486479236927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282439747477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824397474768       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824399589356       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824399814158       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824399816773       residual = 4.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.130567e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824397474768       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824398112168       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824398209507       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824398209903       residual = 5.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 9.356331e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824397474768       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824397642758       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824397671165       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824397671480       residual = 6.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.459479e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2005e+02
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.092405e-01 3 1  ON 0
ci_02                -2.225643e-02 3 1  ON 1
ci_03                -2.203136e-02 3 1  ON 2
ci_04                 2.184511e-02 3 1  ON 3
ci_05                -2.148876e-02 3 1  ON 4
ci_06                -2.167661e-02 3 1  ON 5
ci_07                 2.601799e-02 3 1  ON 6
ci_08                -3.556640e-03 3 1  ON 7
ci_09                -1.050423e-02 3 1  ON 8
ci_10                -1.114378e-02 3 1  ON 9
ci_11                 1.616943e-02 3 1  ON 10
ci_12                 1.073220e-02 3 1  ON 11
ci_13                 1.272894e-02 3 1  ON 12
ci_14                 1.710644e-02 3 1  ON 13
ci_15                 7.857538e-03 3 1  ON 14
ci_16                 7.484716e-03 3 1  ON 15
ci_17                -8.826323e-03 3 1  ON 16
ci_18                -8.449478e-03 3 1  ON 17
ci_19                 9.463965e-03 3 1  ON 18
ci_20                 9.867183e-03 3 1  ON 19
ci_21                 8.698175e-03 3 1  ON 20
ci_22                 8.096957e-03 3 1  ON 21
ci_23                 6.456477e-03 3 1  ON 22
ci_24                 7.771203e-03 3 1  ON 23
ci_25                 4.893758e-03 3 1  ON 24
ci_26                 2.368090e-03 3 1  ON 25
ci_27                 3.095835e-03 3 1  ON 26
ci_28                 3.060360e-03 3 1  ON 27
ci_29                 3.324024e-03 3 1  ON 28
ci_30                 4.118893e-04 3 1  ON 29
ci_31                 1.119609e-03 3 1  ON 30
ci_32                 1.075731e-04 3 1  ON 31
ci_33                -4.667888e-05 3 1  ON 32
ci_34                 2.325626e-04 3 1  ON 33
ci_35                -3.261496e-04 3 1  ON 34
ci_36                -5.280969e-04 3 1  ON 35
ci_37                -6.636205e-04 3 1  ON 36
ci_38                -1.715731e-04 3 1  ON 37
ci_39                -1.220359e-04 3 1  ON 38
ci_40                -1.240295e-03 3 1  ON 39
ci_41                -2.656253e-04 3 1  ON 40
ci_42                 3.986761e-04 3 1  ON 41
ci_43                -2.470109e-03 3 1  ON 42
ci_44                -2.930350e-03 3 1  ON 43
ci_45                -1.173615e-04 3 1  ON 44
ci_46                -1.628361e-04 3 1  ON 45
ci_47                 3.635893e-07 3 1  ON 46
ci_48                -4.040009e-05 3 1  ON 47
ci_49                -1.501686e-03 3 1  ON 48
ci_50                -5.081567e-04 3 1  ON 49
ci_51                -6.929190e-05 3 1  ON 50
ci_52                -1.069157e-04 3 1  ON 51
ci_53                -1.179350e-03 3 1  ON 52
ci_54                -8.932345e-04 3 1  ON 53
ci_55                -1.281681e-03 3 1  ON 54
ci_56                 1.729987e-03 3 1  ON 55
ci_57                 1.723180e-03 3 1  ON 56
ci_58                -1.332697e-03 3 1  ON 57
ci_59                -1.531335e-03 3 1  ON 58
ci_60                 1.281943e-03 3 1  ON 59
ci_61                 1.486292e-03 3 1  ON 60
ci_62                -1.911937e-04 3 1  ON 61
ci_63                -1.536784e-04 3 1  ON 62
ci_64                -6.448731e-05 3 1  ON 63
ci_65                -3.889158e-04 3 1  ON 64
ci_66                -3.676838e-04 3 1  ON 65
ci_67                -6.787205e-04 3 1  ON 66
ci_68                -1.274228e-03 3 1  ON 67
ci_69                -1.530834e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8328
    reference variance = 0.38249
====================================================
  Execution time = 1.0341e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0290e-01
  Total weights = 7.8566e+06
  Execution time = 1.4571e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484030391016
                                         uncertainty =       0.001403202983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484030391016
                                         uncertainty =       0.001403202983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245975544
  error estimate for blocks of size 2^( 2) =       0.000255159785
  error estimate for blocks of size 2^( 3) =       0.000263428901
  error estimate for blocks of size 2^( 4) =       0.000269168779
  error estimate for blocks of size 2^( 5) =       0.000272428710
  error estimate for blocks of size 2^( 6) =       0.000273959853
  error estimate for blocks of size 2^( 7) =       0.000275051485
  error estimate for blocks of size 2^( 8) =       0.000276182505
  error estimate for blocks of size 2^( 9) =       0.000277962747

      target function =                  N/A
              le_mean =     -22.824750339543
             les_mean =     521.472062117113
             stat err =       0.000275789147
             autocorr =       1.257101905966
              std dev =       0.695723900957
             le_variance =       0.484031746363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484066933634
                                         uncertainty =       0.001403201179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484066933634
                                         uncertainty =       0.001403201179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245984826
  error estimate for blocks of size 2^( 2) =       0.000255167450
  error estimate for blocks of size 2^( 3) =       0.000263435826
  error estimate for blocks of size 2^( 4) =       0.000269175529
  error estimate for blocks of size 2^( 5) =       0.000272432642
  error estimate for blocks of size 2^( 6) =       0.000273963170
  error estimate for blocks of size 2^( 7) =       0.000275053462
  error estimate for blocks of size 2^( 8) =       0.000276188017
  error estimate for blocks of size 2^( 9) =       0.000277961930

      target function =                  N/A
              le_mean =     -22.824749569450
             les_mean =     521.492673681577
             stat err =       0.000275791645
             autocorr =       1.257029802552
              std dev =       0.695750153726
             le_variance =       0.484068276410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484041346852
                                         uncertainty =       0.001403210324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484041346852
                                         uncertainty =       0.001403210324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245978330
  error estimate for blocks of size 2^( 2) =       0.000255161663
  error estimate for blocks of size 2^( 3) =       0.000263429802
  error estimate for blocks of size 2^( 4) =       0.000269169490
  error estimate for blocks of size 2^( 5) =       0.000272428691
  error estimate for blocks of size 2^( 6) =       0.000273960724
  error estimate for blocks of size 2^( 7) =       0.000275051844
  error estimate for blocks of size 2^( 8) =       0.000276182845
  error estimate for blocks of size 2^( 9) =       0.000277961135

      target function =                  N/A
              le_mean =     -22.824750261096
             les_mean =     521.472386819459
             stat err =       0.000275789137
             autocorr =       1.257073337282
              std dev =       0.695731780213
             le_variance =       0.484042709999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484031114246
                                         uncertainty =       0.001403202778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484031114246
                                         uncertainty =       0.001403202778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245975728
  error estimate for blocks of size 2^( 2) =       0.000255159849
  error estimate for blocks of size 2^( 3) =       0.000263428831
  error estimate for blocks of size 2^( 4) =       0.000269168689
  error estimate for blocks of size 2^( 5) =       0.000272428527
  error estimate for blocks of size 2^( 6) =       0.000273959791
  error estimate for blocks of size 2^( 7) =       0.000275051367
  error estimate for blocks of size 2^( 8) =       0.000276182394
  error estimate for blocks of size 2^( 9) =       0.000277962355

      target function =                  N/A
              le_mean =     -22.824750259903
             les_mean =     521.472053206434
             stat err =       0.000275788977
             autocorr =       1.257098469932
              std dev =       0.695724421432
             le_variance =       0.484032470577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824750339543        initial  <--
     6.2500e-01     6.2500e+00             3.1306e-04       -22.824749569450
     2.5000e+00     2.5000e+01             9.3563e-05       -22.824750261096
     1.0000e+01     1.0000e+02             2.4595e-05       -22.824750259903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 176.1851
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.092578e-01 3 1  ON 0
ci_02                -2.228301e-02 3 1  ON 1
ci_03                -2.200250e-02 3 1  ON 2
ci_04                 2.179703e-02 3 1  ON 3
ci_05                -2.147289e-02 3 1  ON 4
ci_06                -2.168990e-02 3 1  ON 5
ci_07                 2.606785e-02 3 1  ON 6
ci_08                -3.551250e-03 3 1  ON 7
ci_09                -1.048996e-02 3 1  ON 8
ci_10                -1.119176e-02 3 1  ON 9
ci_11                 1.616359e-02 3 1  ON 10
ci_12                 1.076818e-02 3 1  ON 11
ci_13                 1.271959e-02 3 1  ON 12
ci_14                 1.705388e-02 3 1  ON 13
ci_15                 7.864158e-03 3 1  ON 14
ci_16                 7.455514e-03 3 1  ON 15
ci_17                -8.774562e-03 3 1  ON 16
ci_18                -8.408180e-03 3 1  ON 17
ci_19                 9.440471e-03 3 1  ON 18
ci_20                 9.777212e-03 3 1  ON 19
ci_21                 8.662535e-03 3 1  ON 20
ci_22                 8.105289e-03 3 1  ON 21
ci_23                 6.462951e-03 3 1  ON 22
ci_24                 7.800912e-03 3 1  ON 23
ci_25                 4.877134e-03 3 1  ON 24
ci_26                 2.393029e-03 3 1  ON 25
ci_27                 3.106445e-03 3 1  ON 26
ci_28                 3.099178e-03 3 1  ON 27
ci_29                 3.367370e-03 3 1  ON 28
ci_30                 3.903324e-04 3 1  ON 29
ci_31                 1.135500e-03 3 1  ON 30
ci_32                 1.231320e-04 3 1  ON 31
ci_33                -4.315273e-05 3 1  ON 32
ci_34                 2.590168e-04 3 1  ON 33
ci_35                -3.472750e-04 3 1  ON 34
ci_36                -5.381652e-04 3 1  ON 35
ci_37                -7.069217e-04 3 1  ON 36
ci_38                -2.093032e-04 3 1  ON 37
ci_39                -1.261357e-04 3 1  ON 38
ci_40                -1.273345e-03 3 1  ON 39
ci_41                -2.837905e-04 3 1  ON 40
ci_42                 4.081952e-04 3 1  ON 41
ci_43                -2.472128e-03 3 1  ON 42
ci_44                -2.936016e-03 3 1  ON 43
ci_45                -7.958393e-05 3 1  ON 44
ci_46                -1.854858e-04 3 1  ON 45
ci_47                -3.047891e-05 3 1  ON 46
ci_48                -5.466641e-05 3 1  ON 47
ci_49                -1.482108e-03 3 1  ON 48
ci_50                -5.397559e-04 3 1  ON 49
ci_51                -8.164040e-05 3 1  ON 50
ci_52                -1.358677e-04 3 1  ON 51
ci_53                -1.163571e-03 3 1  ON 52
ci_54                -7.996712e-04 3 1  ON 53
ci_55                -1.365305e-03 3 1  ON 54
ci_56                 1.701159e-03 3 1  ON 55
ci_57                 1.691343e-03 3 1  ON 56
ci_58                -1.284105e-03 3 1  ON 57
ci_59                -1.514579e-03 3 1  ON 58
ci_60                 1.285041e-03 3 1  ON 59
ci_61                 1.499346e-03 3 1  ON 60
ci_62                -2.076650e-04 3 1  ON 61
ci_63                -1.372781e-04 3 1  ON 62
ci_64                -3.293815e-05 3 1  ON 63
ci_65                -4.452828e-04 3 1  ON 64
ci_66                -3.574535e-04 3 1  ON 65
ci_67                -7.416460e-04 3 1  ON 66
ci_68                -1.268849e-03 3 1  ON 67
ci_69                -1.540326e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9625e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2836e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7344
    reference variance = 0.34755
====================================================
  Execution time = 1.0110e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1375e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9688e-01
  Total weights = 7.856963465e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8805e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482436718856
                                         uncertainty =       0.001137396075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482436718856
                                         uncertainty =       0.001137396075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245570176
  error estimate for blocks of size 2^( 2) =       0.000254794882
  error estimate for blocks of size 2^( 3) =       0.000262906459
  error estimate for blocks of size 2^( 4) =       0.000268973048
  error estimate for blocks of size 2^( 5) =       0.000272227582
  error estimate for blocks of size 2^( 6) =       0.000274181845
  error estimate for blocks of size 2^( 7) =       0.000275597222
  error estimate for blocks of size 2^( 8) =       0.000275405095
  error estimate for blocks of size 2^( 9) =       0.000275156252

      target function =                  N/A
              le_mean =     -22.825145511747
             les_mean =     521.484143291999
             stat err =       0.000275085103
             autocorr =       1.254824251042
              std dev =       0.694577346102
             le_variance =       0.482437689718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282514551175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825145511738       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825145698540       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825145689785       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825145689803       residual = 4.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.155080e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825145511738       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825145559544       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825145557319       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825145557328       residual = 4.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 8.014212e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825145511738       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825145523761       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825145523202       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825145523205       residual = 4.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 2.011608e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1992e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.092563e-01 3 1  ON 0
ci_02                -2.228264e-02 3 1  ON 1
ci_03                -2.200290e-02 3 1  ON 2
ci_04                 2.179656e-02 3 1  ON 3
ci_05                -2.147240e-02 3 1  ON 4
ci_06                -2.168747e-02 3 1  ON 5
ci_07                 2.605983e-02 3 1  ON 6
ci_08                -3.551924e-03 3 1  ON 7
ci_09                -1.049475e-02 3 1  ON 8
ci_10                -1.119376e-02 3 1  ON 9
ci_11                 1.616180e-02 3 1  ON 10
ci_12                 1.076270e-02 3 1  ON 11
ci_13                 1.271796e-02 3 1  ON 12
ci_14                 1.705711e-02 3 1  ON 13
ci_15                 7.866917e-03 3 1  ON 14
ci_16                 7.458958e-03 3 1  ON 15
ci_17                -8.772967e-03 3 1  ON 16
ci_18                -8.407269e-03 3 1  ON 17
ci_19                 9.435266e-03 3 1  ON 18
ci_20                 9.782247e-03 3 1  ON 19
ci_21                 8.658906e-03 3 1  ON 20
ci_22                 8.105083e-03 3 1  ON 21
ci_23                 6.459851e-03 3 1  ON 22
ci_24                 7.797576e-03 3 1  ON 23
ci_25                 4.876953e-03 3 1  ON 24
ci_26                 2.395020e-03 3 1  ON 25
ci_27                 3.100871e-03 3 1  ON 26
ci_28                 3.100272e-03 3 1  ON 27
ci_29                 3.363549e-03 3 1  ON 28
ci_30                 3.887662e-04 3 1  ON 29
ci_31                 1.137965e-03 3 1  ON 30
ci_32                 1.249806e-04 3 1  ON 31
ci_33                -4.223403e-05 3 1  ON 32
ci_34                 2.588029e-04 3 1  ON 33
ci_35                -3.444349e-04 3 1  ON 34
ci_36                -5.387305e-04 3 1  ON 35
ci_37                -7.010396e-04 3 1  ON 36
ci_38                -2.053466e-04 3 1  ON 37
ci_39                -1.228741e-04 3 1  ON 38
ci_40                -1.268465e-03 3 1  ON 39
ci_41                -2.822939e-04 3 1  ON 40
ci_42                 4.035256e-04 3 1  ON 41
ci_43                -2.473047e-03 3 1  ON 42
ci_44                -2.931076e-03 3 1  ON 43
ci_45                -8.009797e-05 3 1  ON 44
ci_46                -1.844409e-04 3 1  ON 45
ci_47                -2.609990e-05 3 1  ON 46
ci_48                -5.655975e-05 3 1  ON 47
ci_49                -1.477594e-03 3 1  ON 48
ci_50                -5.354505e-04 3 1  ON 49
ci_51                -7.525509e-05 3 1  ON 50
ci_52                -1.377046e-04 3 1  ON 51
ci_53                -1.158207e-03 3 1  ON 52
ci_54                -7.992751e-04 3 1  ON 53
ci_55                -1.360728e-03 3 1  ON 54
ci_56                 1.700015e-03 3 1  ON 55
ci_57                 1.690791e-03 3 1  ON 56
ci_58                -1.282839e-03 3 1  ON 57
ci_59                -1.512861e-03 3 1  ON 58
ci_60                 1.286074e-03 3 1  ON 59
ci_61                 1.500239e-03 3 1  ON 60
ci_62                -2.104505e-04 3 1  ON 61
ci_63                -1.377723e-04 3 1  ON 62
ci_64                -3.375286e-05 3 1  ON 63
ci_65                -4.423721e-04 3 1  ON 64
ci_66                -3.588694e-04 3 1  ON 65
ci_67                -7.377113e-04 3 1  ON 66
ci_68                -1.272299e-03 3 1  ON 67
ci_69                -1.543218e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.9082
    reference variance = 0.704992
====================================================
  Execution time = 1.0347e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0338e-01
  Total weights = 7.8567e+06
  Execution time = 1.4588e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487736911427
                                         uncertainty =       0.001381094988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487736911427
                                         uncertainty =       0.001381094988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246915264
  error estimate for blocks of size 2^( 2) =       0.000256179285
  error estimate for blocks of size 2^( 3) =       0.000264493170
  error estimate for blocks of size 2^( 4) =       0.000270475051
  error estimate for blocks of size 2^( 5) =       0.000273940410
  error estimate for blocks of size 2^( 6) =       0.000276110941
  error estimate for blocks of size 2^( 7) =       0.000277245744
  error estimate for blocks of size 2^( 8) =       0.000278287713
  error estimate for blocks of size 2^( 9) =       0.000277873154

      target function =                  N/A
              le_mean =     -22.824959147651
             les_mean =     521.482280861743
             stat err =       0.000277379388
             autocorr =       1.261980066303
              std dev =       0.698381829429
             le_variance =       0.487737179677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487737374209
                                         uncertainty =       0.001381092368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487737374209
                                         uncertainty =       0.001381092368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246915381
  error estimate for blocks of size 2^( 2) =       0.000256179440
  error estimate for blocks of size 2^( 3) =       0.000264493411
  error estimate for blocks of size 2^( 4) =       0.000270475313
  error estimate for blocks of size 2^( 5) =       0.000273940706
  error estimate for blocks of size 2^( 6) =       0.000276111006
  error estimate for blocks of size 2^( 7) =       0.000277245815
  error estimate for blocks of size 2^( 8) =       0.000278287557
  error estimate for blocks of size 2^( 9) =       0.000277873287

      target function =                  N/A
              le_mean =     -22.824959359808
             les_mean =     521.482176947042
             stat err =       0.000277379416
             autocorr =       1.261979119892
              std dev =       0.698382162316
             le_variance =       0.487737644642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487737112251
                                         uncertainty =       0.001381093810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487737112251
                                         uncertainty =       0.001381093810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246915315
  error estimate for blocks of size 2^( 2) =       0.000256179355
  error estimate for blocks of size 2^( 3) =       0.000264493281
  error estimate for blocks of size 2^( 4) =       0.000270475173
  error estimate for blocks of size 2^( 5) =       0.000273940547
  error estimate for blocks of size 2^( 6) =       0.000276110962
  error estimate for blocks of size 2^( 7) =       0.000277245761
  error estimate for blocks of size 2^( 8) =       0.000278287617
  error estimate for blocks of size 2^( 9) =       0.000277873205

      target function =                  N/A
              le_mean =     -22.824959251433
             les_mean =     521.482149229572
             stat err =       0.000277379386
             autocorr =       1.261979530121
              std dev =       0.698381974008
             le_variance =       0.487737381620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487736932087
                                         uncertainty =       0.001381094795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487736932087
                                         uncertainty =       0.001381094795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246915269
  error estimate for blocks of size 2^( 2) =       0.000256179292
  error estimate for blocks of size 2^( 3) =       0.000264493180
  error estimate for blocks of size 2^( 4) =       0.000270475064
  error estimate for blocks of size 2^( 5) =       0.000273940423
  error estimate for blocks of size 2^( 6) =       0.000276110940
  error estimate for blocks of size 2^( 7) =       0.000277245738
  error estimate for blocks of size 2^( 8) =       0.000278287690
  error estimate for blocks of size 2^( 9) =       0.000277873159

      target function =                  N/A
              le_mean =     -22.824959163165
             les_mean =     521.482162090804
             stat err =       0.000277379382
             autocorr =       1.261979958326
              std dev =       0.698381844321
             le_variance =       0.487737200477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824959147651        initial
     6.2500e+00     6.2500e+01             3.1551e-05       -22.824959359808  <--
     2.5000e+01     2.5000e+02             8.0142e-06       -22.824959251433
     1.0000e+02     1.0000e+03             2.0116e-06       -22.824959163165

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 1.7636e+02
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.092519e-01 3 1  ON 0
ci_02                -2.228154e-02 3 1  ON 1
ci_03                -2.200406e-02 3 1  ON 2
ci_04                 2.179527e-02 3 1  ON 3
ci_05                -2.147093e-02 3 1  ON 4
ci_06                -2.168035e-02 3 1  ON 5
ci_07                 2.603630e-02 3 1  ON 6
ci_08                -3.553881e-03 3 1  ON 7
ci_09                -1.050884e-02 3 1  ON 8
ci_10                -1.119957e-02 3 1  ON 9
ci_11                 1.615665e-02 3 1  ON 10
ci_12                 1.074674e-02 3 1  ON 11
ci_13                 1.271320e-02 3 1  ON 12
ci_14                 1.706672e-02 3 1  ON 13
ci_15                 7.874961e-03 3 1  ON 14
ci_16                 7.468988e-03 3 1  ON 15
ci_17                -8.768260e-03 3 1  ON 16
ci_18                -8.404624e-03 3 1  ON 17
ci_19                 9.420363e-03 3 1  ON 18
ci_20                 9.796942e-03 3 1  ON 19
ci_21                 8.648240e-03 3 1  ON 20
ci_22                 8.104337e-03 3 1  ON 21
ci_23                 6.450922e-03 3 1  ON 22
ci_24                 7.787761e-03 3 1  ON 23
ci_25                 4.876460e-03 3 1  ON 24
ci_26                 2.400775e-03 3 1  ON 25
ci_27                 3.084511e-03 3 1  ON 26
ci_28                 3.103479e-03 3 1  ON 27
ci_29                 3.352395e-03 3 1  ON 28
ci_30                 3.841469e-04 3 1  ON 29
ci_31                 1.145227e-03 3 1  ON 30
ci_32                 1.302899e-04 3 1  ON 31
ci_33                -3.957444e-05 3 1  ON 32
ci_34                 2.581697e-04 3 1  ON 33
ci_35                -3.361668e-04 3 1  ON 34
ci_36                -5.403978e-04 3 1  ON 35
ci_37                -6.841710e-04 3 1  ON 36
ci_38                -1.939148e-04 3 1  ON 37
ci_39                -1.135401e-04 3 1  ON 38
ci_40                -1.254586e-03 3 1  ON 39
ci_41                -2.780009e-04 3 1  ON 40
ci_42                 3.899937e-04 3 1  ON 41
ci_43                -2.475709e-03 3 1  ON 42
ci_44                -2.916644e-03 3 1  ON 43
ci_45                -8.164111e-05 3 1  ON 44
ci_46                -1.814855e-04 3 1  ON 45
ci_47                -1.322406e-05 3 1  ON 46
ci_48                -6.207623e-05 3 1  ON 47
ci_49                -1.464642e-03 3 1  ON 48
ci_50                -5.232722e-04 3 1  ON 49
ci_51                -5.687406e-05 3 1  ON 50
ci_52                -1.430572e-04 3 1  ON 51
ci_53                -1.142923e-03 3 1  ON 52
ci_54                -7.981571e-04 3 1  ON 53
ci_55                -1.347432e-03 3 1  ON 54
ci_56                 1.696794e-03 3 1  ON 55
ci_57                 1.689240e-03 3 1  ON 56
ci_58                -1.279138e-03 3 1  ON 57
ci_59                -1.507835e-03 3 1  ON 58
ci_60                 1.289146e-03 3 1  ON 59
ci_61                 1.502887e-03 3 1  ON 60
ci_62                -2.183967e-04 3 1  ON 61
ci_63                -1.391829e-04 3 1  ON 62
ci_64                -3.618030e-05 3 1  ON 63
ci_65                -4.340032e-04 3 1  ON 64
ci_66                -3.628832e-04 3 1  ON 65
ci_67                -7.263452e-04 3 1  ON 66
ci_68                -1.282365e-03 3 1  ON 67
ci_69                -1.551573e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9628e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7881
    reference variance = 0.362734
====================================================
  Execution time = 1.0085e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1387e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0102e-01
  Total weights = 7.857360990e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8623e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484971218590
                                         uncertainty =       0.001169413982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484971218590
                                         uncertainty =       0.001169413982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246214225
  error estimate for blocks of size 2^( 2) =       0.000255403350
  error estimate for blocks of size 2^( 3) =       0.000263777698
  error estimate for blocks of size 2^( 4) =       0.000269735573
  error estimate for blocks of size 2^( 5) =       0.000273207671
  error estimate for blocks of size 2^( 6) =       0.000275380663
  error estimate for blocks of size 2^( 7) =       0.000275796848
  error estimate for blocks of size 2^( 8) =       0.000275767940
  error estimate for blocks of size 2^( 9) =       0.000276487858

      target function =                  N/A
              le_mean =     -22.824933330880
             les_mean =     521.478605386743
             stat err =       0.000275858327
             autocorr =       1.255295334471
              std dev =       0.696398992570
             le_variance =       0.484971556852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282493333088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824933330880       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824934446645       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824934490043       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824934498256       residual = 3.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.360579e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824933330880       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824933633590       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824933645422       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824933648926       residual = 5.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.676319e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824933330880       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824933408204       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824933411242       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824933412242       residual = 7.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 9.380155e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1948e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.092493e-01 3 1  ON 0
ci_02                -2.228826e-02 3 1  ON 1
ci_03                -2.200258e-02 3 1  ON 2
ci_04                 2.179481e-02 3 1  ON 3
ci_05                -2.147126e-02 3 1  ON 4
ci_06                -2.167495e-02 3 1  ON 5
ci_07                 2.603606e-02 3 1  ON 6
ci_08                -3.549431e-03 3 1  ON 7
ci_09                -1.053062e-02 3 1  ON 8
ci_10                -1.118238e-02 3 1  ON 9
ci_11                 1.616008e-02 3 1  ON 10
ci_12                 1.076960e-02 3 1  ON 11
ci_13                 1.271747e-02 3 1  ON 12
ci_14                 1.705753e-02 3 1  ON 13
ci_15                 7.876382e-03 3 1  ON 14
ci_16                 7.459507e-03 3 1  ON 15
ci_17                -8.792700e-03 3 1  ON 16
ci_18                -8.391235e-03 3 1  ON 17
ci_19                 9.431733e-03 3 1  ON 18
ci_20                 9.809971e-03 3 1  ON 19
ci_21                 8.637321e-03 3 1  ON 20
ci_22                 8.115702e-03 3 1  ON 21
ci_23                 6.441188e-03 3 1  ON 22
ci_24                 7.780033e-03 3 1  ON 23
ci_25                 4.875919e-03 3 1  ON 24
ci_26                 2.380500e-03 3 1  ON 25
ci_27                 3.072975e-03 3 1  ON 26
ci_28                 3.084026e-03 3 1  ON 27
ci_29                 3.352221e-03 3 1  ON 28
ci_30                 3.942571e-04 3 1  ON 29
ci_31                 1.127777e-03 3 1  ON 30
ci_32                 1.237810e-04 3 1  ON 31
ci_33                -1.884125e-05 3 1  ON 32
ci_34                 2.497670e-04 3 1  ON 33
ci_35                -3.180447e-04 3 1  ON 34
ci_36                -5.506769e-04 3 1  ON 35
ci_37                -6.824939e-04 3 1  ON 36
ci_38                -1.920822e-04 3 1  ON 37
ci_39                -1.151792e-04 3 1  ON 38
ci_40                -1.244687e-03 3 1  ON 39
ci_41                -2.700639e-04 3 1  ON 40
ci_42                 3.807364e-04 3 1  ON 41
ci_43                -2.454315e-03 3 1  ON 42
ci_44                -2.879881e-03 3 1  ON 43
ci_45                -7.080471e-05 3 1  ON 44
ci_46                -1.627542e-04 3 1  ON 45
ci_47                -1.412497e-05 3 1  ON 46
ci_48                -5.368421e-05 3 1  ON 47
ci_49                -1.458517e-03 3 1  ON 48
ci_50                -5.129363e-04 3 1  ON 49
ci_51                -4.417858e-05 3 1  ON 50
ci_52                -1.551878e-04 3 1  ON 51
ci_53                -1.137153e-03 3 1  ON 52
ci_54                -7.923765e-04 3 1  ON 53
ci_55                -1.328935e-03 3 1  ON 54
ci_56                 1.725943e-03 3 1  ON 55
ci_57                 1.718989e-03 3 1  ON 56
ci_58                -1.266894e-03 3 1  ON 57
ci_59                -1.510699e-03 3 1  ON 58
ci_60                 1.300760e-03 3 1  ON 59
ci_61                 1.515108e-03 3 1  ON 60
ci_62                -2.057804e-04 3 1  ON 61
ci_63                -1.441187e-04 3 1  ON 62
ci_64                -4.803766e-05 3 1  ON 63
ci_65                -4.356743e-04 3 1  ON 64
ci_66                -3.668240e-04 3 1  ON 65
ci_67                -7.362783e-04 3 1  ON 66
ci_68                -1.294614e-03 3 1  ON 67
ci_69                -1.549426e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8346
    reference variance = 0.511779
====================================================
  Execution time = 1.0402e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0433e-01
  Total weights = 7.8572e+06
  Execution time = 1.4626e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486585361000
                                         uncertainty =       0.001492536326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486585361000
                                         uncertainty =       0.001492536326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246623744
  error estimate for blocks of size 2^( 2) =       0.000255924447
  error estimate for blocks of size 2^( 3) =       0.000264093245
  error estimate for blocks of size 2^( 4) =       0.000269982144
  error estimate for blocks of size 2^( 5) =       0.000273820225
  error estimate for blocks of size 2^( 6) =       0.000275581641
  error estimate for blocks of size 2^( 7) =       0.000276739941
  error estimate for blocks of size 2^( 8) =       0.000278309554
  error estimate for blocks of size 2^( 9) =       0.000280040582

      target function =                  N/A
              le_mean =     -22.824607601892
             les_mean =     521.467082700347
             stat err =       0.000277667930
             autocorr =       1.267598370569
              std dev =       0.697557286284
             le_variance =       0.486586167647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486566243665
                                         uncertainty =       0.001491038384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486566243665
                                         uncertainty =       0.001491038384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246618900
  error estimate for blocks of size 2^( 2) =       0.000255919521
  error estimate for blocks of size 2^( 3) =       0.000264088388
  error estimate for blocks of size 2^( 4) =       0.000269976380
  error estimate for blocks of size 2^( 5) =       0.000273813548
  error estimate for blocks of size 2^( 6) =       0.000275573095
  error estimate for blocks of size 2^( 7) =       0.000276730050
  error estimate for blocks of size 2^( 8) =       0.000278301659
  error estimate for blocks of size 2^( 9) =       0.000280032498

      target function =                  N/A
              le_mean =     -22.824608457768
             les_mean =     521.467102521175
             stat err =       0.000277659325
             autocorr =       1.267569600467
              std dev =       0.697543586334
             le_variance =       0.486567054836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486573194674
                                         uncertainty =       0.001491746608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486573194674
                                         uncertainty =       0.001491746608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246620661
  error estimate for blocks of size 2^( 2) =       0.000255921303
  error estimate for blocks of size 2^( 3) =       0.000264090125
  error estimate for blocks of size 2^( 4) =       0.000269978528
  error estimate for blocks of size 2^( 5) =       0.000273816074
  error estimate for blocks of size 2^( 6) =       0.000275576379
  error estimate for blocks of size 2^( 7) =       0.000276733807
  error estimate for blocks of size 2^( 8) =       0.000278304541
  error estimate for blocks of size 2^( 9) =       0.000280035624

      target function =                  N/A
              le_mean =     -22.824608074777
             les_mean =     521.475627971552
             stat err =       0.000277662588
             autocorr =       1.267581287025
              std dev =       0.697548567198
             le_variance =       0.486574003599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486583513505
                                         uncertainty =       0.001492438766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486583513505
                                         uncertainty =       0.001492438766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246623276
  error estimate for blocks of size 2^( 2) =       0.000255923971
  error estimate for blocks of size 2^( 3) =       0.000264092773
  error estimate for blocks of size 2^( 4) =       0.000269981603
  error estimate for blocks of size 2^( 5) =       0.000273819607
  error estimate for blocks of size 2^( 6) =       0.000275580869
  error estimate for blocks of size 2^( 7) =       0.000276739057
  error estimate for blocks of size 2^( 8) =       0.000278308828
  error estimate for blocks of size 2^( 9) =       0.000280039872

      target function =                  N/A
              le_mean =     -22.824607646458
             les_mean =     521.467121586386
             stat err =       0.000277667157
             autocorr =       1.267596124832
              std dev =       0.697555962204
             le_variance =       0.486584320406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824607601892        initial
     1.5625e+00     1.5625e+01             1.3606e-04       -22.824608457768  <--
     6.2500e+00     6.2500e+01             3.6763e-05       -22.824608074777
     2.5000e+01     2.5000e+02             9.3802e-06       -22.824607646458

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 1.7703e+02
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.092410e-01 3 1  ON 0
ci_02                -2.230610e-02 3 1  ON 1
ci_03                -2.199855e-02 3 1  ON 2
ci_04                 2.179331e-02 3 1  ON 3
ci_05                -2.147199e-02 3 1  ON 4
ci_06                -2.165893e-02 3 1  ON 5
ci_07                 2.603505e-02 3 1  ON 6
ci_08                -3.538659e-03 3 1  ON 7
ci_09                -1.059089e-02 3 1  ON 8
ci_10                -1.113567e-02 3 1  ON 9
ci_11                 1.616885e-02 3 1  ON 10
ci_12                 1.083050e-02 3 1  ON 11
ci_13                 1.272940e-02 3 1  ON 12
ci_14                 1.703059e-02 3 1  ON 13
ci_15                 7.879651e-03 3 1  ON 14
ci_16                 7.434681e-03 3 1  ON 15
ci_17                -8.859581e-03 3 1  ON 16
ci_18                -8.355315e-03 3 1  ON 17
ci_19                 9.459232e-03 3 1  ON 18
ci_20                 9.844843e-03 3 1  ON 19
ci_21                 8.607097e-03 3 1  ON 20
ci_22                 8.147728e-03 3 1  ON 21
ci_23                 6.415597e-03 3 1  ON 22
ci_24                 7.758492e-03 3 1  ON 23
ci_25                 4.874977e-03 3 1  ON 24
ci_26                 2.326327e-03 3 1  ON 25
ci_27                 3.041654e-03 3 1  ON 26
ci_28                 3.032039e-03 3 1  ON 27
ci_29                 3.351582e-03 3 1  ON 28
ci_30                 4.231615e-04 3 1  ON 29
ci_31                 1.079264e-03 3 1  ON 30
ci_32                 1.074353e-04 3 1  ON 31
ci_33                 3.607789e-05 3 1  ON 32
ci_34                 2.269247e-04 3 1  ON 33
ci_35                -2.693595e-04 3 1  ON 34
ci_36                -5.778121e-04 3 1  ON 35
ci_37                -6.786619e-04 3 1  ON 36
ci_38                -1.880218e-04 3 1  ON 37
ci_39                -1.198786e-04 3 1  ON 38
ci_40                -1.220684e-03 3 1  ON 39
ci_41                -2.490936e-04 3 1  ON 40
ci_42                 3.569661e-04 3 1  ON 41
ci_43                -2.396291e-03 3 1  ON 42
ci_44                -2.780586e-03 3 1  ON 43
ci_45                -4.302358e-05 3 1  ON 44
ci_46                -1.144878e-04 3 1  ON 45
ci_47                -1.782139e-05 3 1  ON 46
ci_48                -2.979376e-05 3 1  ON 47
ci_49                -1.442713e-03 3 1  ON 48
ci_50                -4.881977e-04 3 1  ON 49
ci_51                -1.163303e-05 3 1  ON 50
ci_52                -1.867705e-04 3 1  ON 51
ci_53                -1.123094e-03 3 1  ON 52
ci_54                -7.771036e-04 3 1  ON 53
ci_55                -1.279258e-03 3 1  ON 54
ci_56                 1.800812e-03 3 1  ON 55
ci_57                 1.794204e-03 3 1  ON 56
ci_58                -1.233756e-03 3 1  ON 57
ci_59                -1.518132e-03 3 1  ON 58
ci_60                 1.334076e-03 3 1  ON 59
ci_61                 1.549934e-03 3 1  ON 60
ci_62                -1.742996e-04 3 1  ON 61
ci_63                -1.566557e-04 3 1  ON 62
ci_64                -7.980195e-05 3 1  ON 63
ci_65                -4.402658e-04 3 1  ON 64
ci_66                -3.770370e-04 3 1  ON 65
ci_67                -7.622845e-04 3 1  ON 66
ci_68                -1.328002e-03 3 1  ON 67
ci_69                -1.544568e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9652e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7612
    reference variance = 0.551998
====================================================
  Execution time = 1.0118e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1365e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0417e-01
  Total weights = 7.856936635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8737e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486552787024
                                         uncertainty =       0.001238642829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486552787024
                                         uncertainty =       0.001238642829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246615535
  error estimate for blocks of size 2^( 2) =       0.000255933487
  error estimate for blocks of size 2^( 3) =       0.000264172928
  error estimate for blocks of size 2^( 4) =       0.000269871896
  error estimate for blocks of size 2^( 5) =       0.000273177483
  error estimate for blocks of size 2^( 6) =       0.000275127201
  error estimate for blocks of size 2^( 7) =       0.000275797703
  error estimate for blocks of size 2^( 8) =       0.000275745340
  error estimate for blocks of size 2^( 9) =       0.000276139386

      target function =                  N/A
              le_mean =     -22.824407920665
             les_mean =     521.457771551355
             stat err =       0.000275702407
             autocorr =       1.249799234925
              std dev =       0.697534069659
             le_variance =       0.486553778335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282440792066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824407920656       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824408282671       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824408269731       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.392968e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824407920656       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824408040849       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824408033602       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.099093e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824407920656       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824407953388       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824407951199       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.971357e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1993e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.091952e-01 3 1  ON 0
ci_02                -2.224901e-02 3 1  ON 1
ci_03                -2.198748e-02 3 1  ON 2
ci_04                 2.185475e-02 3 1  ON 3
ci_05                -2.148839e-02 3 1  ON 4
ci_06                -2.160721e-02 3 1  ON 5
ci_07                 2.600764e-02 3 1  ON 6
ci_08                -3.521697e-03 3 1  ON 7
ci_09                -1.063963e-02 3 1  ON 8
ci_10                -1.110164e-02 3 1  ON 9
ci_11                 1.616279e-02 3 1  ON 10
ci_12                 1.083298e-02 3 1  ON 11
ci_13                 1.273106e-02 3 1  ON 12
ci_14                 1.705093e-02 3 1  ON 13
ci_15                 7.860446e-03 3 1  ON 14
ci_16                 7.448361e-03 3 1  ON 15
ci_17                -8.930673e-03 3 1  ON 16
ci_18                -8.419137e-03 3 1  ON 17
ci_19                 9.447964e-03 3 1  ON 18
ci_20                 9.950887e-03 3 1  ON 19
ci_21                 8.578344e-03 3 1  ON 20
ci_22                 8.166676e-03 3 1  ON 21
ci_23                 6.381713e-03 3 1  ON 22
ci_24                 7.756062e-03 3 1  ON 23
ci_25                 4.897627e-03 3 1  ON 24
ci_26                 2.429862e-03 3 1  ON 25
ci_27                 3.086931e-03 3 1  ON 26
ci_28                 2.961894e-03 3 1  ON 27
ci_29                 3.241672e-03 3 1  ON 28
ci_30                 4.102815e-04 3 1  ON 29
ci_31                 1.059665e-03 3 1  ON 30
ci_32                 6.195378e-05 3 1  ON 31
ci_33                 1.090382e-04 3 1  ON 32
ci_34                 1.401028e-04 3 1  ON 33
ci_35                -2.457059e-04 3 1  ON 34
ci_36                -5.558649e-04 3 1  ON 35
ci_37                -6.553832e-04 3 1  ON 36
ci_38                -1.646304e-04 3 1  ON 37
ci_39                -8.776485e-05 3 1  ON 38
ci_40                -1.209790e-03 3 1  ON 39
ci_41                -2.046020e-04 3 1  ON 40
ci_42                 2.917766e-04 3 1  ON 41
ci_43                -2.491114e-03 3 1  ON 42
ci_44                -2.769362e-03 3 1  ON 43
ci_45                -5.749175e-05 3 1  ON 44
ci_46                -1.189849e-04 3 1  ON 45
ci_47                 2.920502e-05 3 1  ON 46
ci_48                -2.674396e-05 3 1  ON 47
ci_49                -1.418722e-03 3 1  ON 48
ci_50                -5.316334e-04 3 1  ON 49
ci_51                -7.646525e-05 3 1  ON 50
ci_52                -9.851524e-05 3 1  ON 51
ci_53                -1.071682e-03 3 1  ON 52
ci_54                -7.684798e-04 3 1  ON 53
ci_55                -1.252798e-03 3 1  ON 54
ci_56                 1.803252e-03 3 1  ON 55
ci_57                 1.773835e-03 3 1  ON 56
ci_58                -1.300865e-03 3 1  ON 57
ci_59                -1.449333e-03 3 1  ON 58
ci_60                 1.377159e-03 3 1  ON 59
ci_61                 1.488220e-03 3 1  ON 60
ci_62                -1.657040e-04 3 1  ON 61
ci_63                -1.835016e-04 3 1  ON 62
ci_64                -1.042665e-04 3 1  ON 63
ci_65                -4.482559e-04 3 1  ON 64
ci_66                -4.013143e-04 3 1  ON 65
ci_67                -6.734417e-04 3 1  ON 66
ci_68                -1.410675e-03 3 1  ON 67
ci_69                -1.599709e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8296
    reference variance = 0.485831
====================================================
  Execution time = 1.0438e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0382e-01
  Total weights = 7.8568e+06
  Execution time = 1.4881e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486522887225
                                         uncertainty =       0.001067137679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486522887225
                                         uncertainty =       0.001067137679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246608431
  error estimate for blocks of size 2^( 2) =       0.000255758423
  error estimate for blocks of size 2^( 3) =       0.000263918732
  error estimate for blocks of size 2^( 4) =       0.000269816620
  error estimate for blocks of size 2^( 5) =       0.000273199453
  error estimate for blocks of size 2^( 6) =       0.000275084322
  error estimate for blocks of size 2^( 7) =       0.000276060383
  error estimate for blocks of size 2^( 8) =       0.000276086313
  error estimate for blocks of size 2^( 9) =       0.000277599878

      target function =                  N/A
              le_mean =     -22.824521427248
             les_mean =     521.470078198278
             stat err =       0.000276207724
             autocorr =       1.254457056764
              std dev =       0.697513974551
             le_variance =       0.486525744694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486546645418
                                         uncertainty =       0.001068932114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486546645418
                                         uncertainty =       0.001068932114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246614451
  error estimate for blocks of size 2^( 2) =       0.000255765543
  error estimate for blocks of size 2^( 3) =       0.000263926225
  error estimate for blocks of size 2^( 4) =       0.000269825036
  error estimate for blocks of size 2^( 5) =       0.000273207606
  error estimate for blocks of size 2^( 6) =       0.000275092815
  error estimate for blocks of size 2^( 7) =       0.000276063373
  error estimate for blocks of size 2^( 8) =       0.000276084317
  error estimate for blocks of size 2^( 9) =       0.000277590356

      target function =                  N/A
              le_mean =     -22.824521626099
             les_mean =     521.463114703425
             stat err =       0.000276207715
             autocorr =       1.254395738197
              std dev =       0.697531001452
             le_variance =       0.486549497987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486534217868
                                         uncertainty =       0.001068334332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486534217868
                                         uncertainty =       0.001068334332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246611302
  error estimate for blocks of size 2^( 2) =       0.000255761994
  error estimate for blocks of size 2^( 3) =       0.000263922472
  error estimate for blocks of size 2^( 4) =       0.000269820887
  error estimate for blocks of size 2^( 5) =       0.000273203838
  error estimate for blocks of size 2^( 6) =       0.000275088763
  error estimate for blocks of size 2^( 7) =       0.000276061454
  error estimate for blocks of size 2^( 8) =       0.000276084059
  error estimate for blocks of size 2^( 9) =       0.000277593244

      target function =                  N/A
              le_mean =     -22.824520932446
             les_mean =     521.463797793535
             stat err =       0.000276206880
             autocorr =       1.254420182071
              std dev =       0.697522095009
             le_variance =       0.486537073026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486523193015
                                         uncertainty =       0.001067292374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486523193015
                                         uncertainty =       0.001067292374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246608508
  error estimate for blocks of size 2^( 2) =       0.000255758510
  error estimate for blocks of size 2^( 3) =       0.000263918846
  error estimate for blocks of size 2^( 4) =       0.000269816754
  error estimate for blocks of size 2^( 5) =       0.000273199592
  error estimate for blocks of size 2^( 6) =       0.000275084288
  error estimate for blocks of size 2^( 7) =       0.000276059885
  error estimate for blocks of size 2^( 8) =       0.000276084446
  error estimate for blocks of size 2^( 9) =       0.000277596185

      target function =                  N/A
              le_mean =     -22.824521278729
             les_mean =     521.464050302288
             stat err =       0.000276206201
             autocorr =       1.254442433600
              std dev =       0.697514193742
             le_variance =       0.486526050472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824521427248        initial
     3.9062e-01     3.9062e+00             3.3930e-04       -22.824521626099  <--
     1.5625e+00     1.5625e+01             1.0991e-04       -22.824520932446
     6.2500e+00     6.2500e+01             2.9714e-05       -22.824521278729

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.7867e+02
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.090920e-01 3 1  ON 0
ci_02                -2.212281e-02 3 1  ON 1
ci_03                -2.196760e-02 3 1  ON 2
ci_04                 2.197213e-02 3 1  ON 3
ci_05                -2.153392e-02 3 1  ON 4
ci_06                -2.149686e-02 3 1  ON 5
ci_07                 2.594733e-02 3 1  ON 6
ci_08                -3.495400e-03 3 1  ON 7
ci_09                -1.075103e-02 3 1  ON 8
ci_10                -1.102191e-02 3 1  ON 9
ci_11                 1.615116e-02 3 1  ON 10
ci_12                 1.083570e-02 3 1  ON 11
ci_13                 1.272880e-02 3 1  ON 12
ci_14                 1.709433e-02 3 1  ON 13
ci_15                 7.807898e-03 3 1  ON 14
ci_16                 7.472250e-03 3 1  ON 15
ci_17                -9.075130e-03 3 1  ON 16
ci_18                -8.549297e-03 3 1  ON 17
ci_19                 9.428072e-03 3 1  ON 18
ci_20                 1.016968e-02 3 1  ON 19
ci_21                 8.520632e-03 3 1  ON 20
ci_22                 8.202230e-03 3 1  ON 21
ci_23                 6.318565e-03 3 1  ON 22
ci_24                 7.752399e-03 3 1  ON 23
ci_25                 4.940509e-03 3 1  ON 24
ci_26                 2.645452e-03 3 1  ON 25
ci_27                 3.180060e-03 3 1  ON 26
ci_28                 2.825252e-03 3 1  ON 27
ci_29                 3.012285e-03 3 1  ON 28
ci_30                 3.879359e-04 3 1  ON 29
ci_31                 1.016316e-03 3 1  ON 30
ci_32                -2.299855e-05 3 1  ON 31
ci_33                 2.508602e-04 3 1  ON 32
ci_34                -3.833238e-05 3 1  ON 33
ci_35                -1.930299e-04 3 1  ON 34
ci_36                -5.105677e-04 3 1  ON 35
ci_37                -6.207582e-04 3 1  ON 36
ci_38                -1.147868e-04 3 1  ON 37
ci_39                -3.399503e-05 3 1  ON 38
ci_40                -1.192678e-03 3 1  ON 39
ci_41                -1.166033e-04 3 1  ON 40
ci_42                 1.682090e-04 3 1  ON 41
ci_43                -2.677971e-03 3 1  ON 42
ci_44                -2.731195e-03 3 1  ON 43
ci_45                -8.914678e-05 3 1  ON 44
ci_46                -1.273439e-04 3 1  ON 45
ci_47                 1.294558e-04 3 1  ON 46
ci_48                -2.096484e-05 3 1  ON 47
ci_49                -1.376004e-03 3 1  ON 48
ci_50                -5.923353e-04 3 1  ON 49
ci_51                -1.971951e-04 3 1  ON 50
ci_52                 6.187023e-05 3 1  ON 51
ci_53                -9.855137e-04 3 1  ON 52
ci_54                -7.523923e-04 3 1  ON 53
ci_55                -1.201043e-03 3 1  ON 54
ci_56                 1.815323e-03 3 1  ON 55
ci_57                 1.730967e-03 3 1  ON 56
ci_58                -1.436655e-03 3 1  ON 57
ci_59                -1.304158e-03 3 1  ON 58
ci_60                 1.489524e-03 3 1  ON 59
ci_61                 1.332102e-03 3 1  ON 60
ci_62                -1.509793e-04 3 1  ON 61
ci_63                -2.272664e-04 3 1  ON 62
ci_64                -1.558224e-04 3 1  ON 63
ci_65                -4.659863e-04 3 1  ON 64
ci_66                -4.404877e-04 3 1  ON 65
ci_67                -5.089232e-04 3 1  ON 66
ci_68                -1.579529e-03 3 1  ON 67
ci_69                -1.701322e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9860e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7958
    reference variance = 0.368119
====================================================
  Execution time = 1.0153e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1377e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0521e-01
  Total weights = 7.856535829e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.9111e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487777827731
                                         uncertainty =       0.001368670021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487777827731
                                         uncertainty =       0.001368670021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246926063
  error estimate for blocks of size 2^( 2) =       0.000256153293
  error estimate for blocks of size 2^( 3) =       0.000264379155
  error estimate for blocks of size 2^( 4) =       0.000270353971
  error estimate for blocks of size 2^( 5) =       0.000273686084
  error estimate for blocks of size 2^( 6) =       0.000275334051
  error estimate for blocks of size 2^( 7) =       0.000277147189
  error estimate for blocks of size 2^( 8) =       0.000277706161
  error estimate for blocks of size 2^( 9) =       0.000278573806

      target function =                  N/A
              le_mean =     -22.824486817654
             les_mean =     521.462407694552
             stat err =       0.000277190302
             autocorr =       1.260149872215
              std dev =       0.698412373615
             le_variance =       0.487779843619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282448681765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824486817650       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824491012355       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824491086309       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824491129701       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 6.983547e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824486817650       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824488921377       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824488827040       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824488796176       residual = 3.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.759663e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824486817650       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824487520316       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824487465457       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824487452973       residual = 2.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 9.103652e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023090 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2066e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.088160e-01 3 1  ON 0
ci_02                -2.210761e-02 3 1  ON 1
ci_03                -2.207658e-02 3 1  ON 2
ci_04                 2.199028e-02 3 1  ON 3
ci_05                -2.146871e-02 3 1  ON 4
ci_06                -2.142278e-02 3 1  ON 5
ci_07                 2.583003e-02 3 1  ON 6
ci_08                -3.599215e-03 3 1  ON 7
ci_09                -1.086968e-02 3 1  ON 8
ci_10                -1.093866e-02 3 1  ON 9
ci_11                 1.604532e-02 3 1  ON 10
ci_12                 1.101525e-02 3 1  ON 11
ci_13                 1.250355e-02 3 1  ON 12
ci_14                 1.717535e-02 3 1  ON 13
ci_15                 7.596259e-03 3 1  ON 14
ci_16                 7.468829e-03 3 1  ON 15
ci_17                -8.916125e-03 3 1  ON 16
ci_18                -8.417387e-03 3 1  ON 17
ci_19                 9.468827e-03 3 1  ON 18
ci_20                 1.035248e-02 3 1  ON 19
ci_21                 8.540915e-03 3 1  ON 20
ci_22                 8.389979e-03 3 1  ON 21
ci_23                 6.492665e-03 3 1  ON 22
ci_24                 7.777269e-03 3 1  ON 23
ci_25                 5.071044e-03 3 1  ON 24
ci_26                 2.878726e-03 3 1  ON 25
ci_27                 2.942144e-03 3 1  ON 26
ci_28                 2.787106e-03 3 1  ON 27
ci_29                 3.036964e-03 3 1  ON 28
ci_30                 5.000971e-04 3 1  ON 29
ci_31                 9.597545e-04 3 1  ON 30
ci_32                -5.942354e-05 3 1  ON 31
ci_33                 1.388653e-04 3 1  ON 32
ci_34                -1.930008e-04 3 1  ON 33
ci_35                -1.432108e-04 3 1  ON 34
ci_36                -5.938079e-04 3 1  ON 35
ci_37                -5.652722e-04 3 1  ON 36
ci_38                -2.110796e-04 3 1  ON 37
ci_39                 1.090140e-04 3 1  ON 38
ci_40                -1.301058e-03 3 1  ON 39
ci_41                -1.887400e-05 3 1  ON 40
ci_42                -8.926800e-05 3 1  ON 41
ci_43                -2.726621e-03 3 1  ON 42
ci_44                -2.696118e-03 3 1  ON 43
ci_45                -1.757632e-04 3 1  ON 44
ci_46                -1.059245e-04 3 1  ON 45
ci_47                -1.240548e-04 3 1  ON 46
ci_48                 1.388243e-06 3 1  ON 47
ci_49                -1.339348e-03 3 1  ON 48
ci_50                -5.832907e-04 3 1  ON 49
ci_51                -1.670447e-04 3 1  ON 50
ci_52                 1.492675e-04 3 1  ON 51
ci_53                -8.684614e-04 3 1  ON 52
ci_54                -6.202949e-04 3 1  ON 53
ci_55                -1.189561e-03 3 1  ON 54
ci_56                 1.568553e-03 3 1  ON 55
ci_57                 1.594730e-03 3 1  ON 56
ci_58                -1.474806e-03 3 1  ON 57
ci_59                -1.427030e-03 3 1  ON 58
ci_60                 1.517315e-03 3 1  ON 59
ci_61                 1.464132e-03 3 1  ON 60
ci_62                -3.671281e-04 3 1  ON 61
ci_63                -1.722633e-04 3 1  ON 62
ci_64                -2.828051e-04 3 1  ON 63
ci_65                -4.439022e-04 3 1  ON 64
ci_66                -2.729651e-04 3 1  ON 65
ci_67                -5.211961e-04 3 1  ON 66
ci_68                -1.565550e-03 3 1  ON 67
ci_69                -1.840967e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8314
    reference variance = 0.480928
====================================================
  Execution time = 1.0397e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0227e-01
  Total weights = 7.8565e+06
  Execution time = 1.4685e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486137825116
                                         uncertainty =       0.001282910421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486137825116
                                         uncertainty =       0.001282910421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246510152
  error estimate for blocks of size 2^( 2) =       0.000255742679
  error estimate for blocks of size 2^( 3) =       0.000264017942
  error estimate for blocks of size 2^( 4) =       0.000270049643
  error estimate for blocks of size 2^( 5) =       0.000273244251
  error estimate for blocks of size 2^( 6) =       0.000275129347
  error estimate for blocks of size 2^( 7) =       0.000276714479
  error estimate for blocks of size 2^( 8) =       0.000277057444
  error estimate for blocks of size 2^( 9) =       0.000278948672

      target function =                  N/A
              le_mean =     -22.824474676894
             les_mean =     521.462364239697
             stat err =       0.000276962485
             autocorr =       1.262328181884
              std dev =       0.697235999449
             le_variance =       0.486138038927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486103992528
                                         uncertainty =       0.001288433046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486103992528
                                         uncertainty =       0.001288433046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246501574
  error estimate for blocks of size 2^( 2) =       0.000255734215
  error estimate for blocks of size 2^( 3) =       0.000264010479
  error estimate for blocks of size 2^( 4) =       0.000270043426
  error estimate for blocks of size 2^( 5) =       0.000273239512
  error estimate for blocks of size 2^( 6) =       0.000275125667
  error estimate for blocks of size 2^( 7) =       0.000276711705
  error estimate for blocks of size 2^( 8) =       0.000277061011
  error estimate for blocks of size 2^( 9) =       0.000278951619

      target function =                  N/A
              le_mean =     -22.824472877736
             les_mean =     521.484714570290
             stat err =       0.000276962500
             autocorr =       1.262416176604
              std dev =       0.697211736995
             le_variance =       0.486104206203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486116398346
                                         uncertainty =       0.001288525864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486116398346
                                         uncertainty =       0.001288525864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246504721
  error estimate for blocks of size 2^( 2) =       0.000255737437
  error estimate for blocks of size 2^( 3) =       0.000264012494
  error estimate for blocks of size 2^( 4) =       0.000270044480
  error estimate for blocks of size 2^( 5) =       0.000273240046
  error estimate for blocks of size 2^( 6) =       0.000275125773
  error estimate for blocks of size 2^( 7) =       0.000276711381
  error estimate for blocks of size 2^( 8) =       0.000277061519
  error estimate for blocks of size 2^( 9) =       0.000278948263

      target function =                  N/A
              le_mean =     -22.824475576579
             les_mean =     521.488966335549
             stat err =       0.000276961734
             autocorr =       1.262376956033
              std dev =       0.697220638329
             le_variance =       0.486116618512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486129050606
                                         uncertainty =       0.001285219945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486129050606
                                         uncertainty =       0.001285219945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246507926
  error estimate for blocks of size 2^( 2) =       0.000255740615
  error estimate for blocks of size 2^( 3) =       0.000264014993
  error estimate for blocks of size 2^( 4) =       0.000270047132
  error estimate for blocks of size 2^( 5) =       0.000273241657
  error estimate for blocks of size 2^( 6) =       0.000275127071
  error estimate for blocks of size 2^( 7) =       0.000276709964
  error estimate for blocks of size 2^( 8) =       0.000277050822
  error estimate for blocks of size 2^( 9) =       0.000278947656

      target function =                  N/A
              le_mean =     -22.824472742287
             les_mean =     521.474695394774
             stat err =       0.000276958878
             autocorr =       1.262318094839
              std dev =       0.697229704057
             le_variance =       0.486129260219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824474676894        initial
     9.7656e-02     9.7656e-01             6.9835e-04       -22.824472877736
     3.9062e-01     3.9062e+00             2.7597e-04       -22.824475576579  <--
     1.5625e+00     1.5625e+01             9.1037e-05       -22.824472742287

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.7633e+02
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.088160e-01 3 1  ON 0
ci_02                -2.210761e-02 3 1  ON 1
ci_03                -2.207658e-02 3 1  ON 2
ci_04                 2.199028e-02 3 1  ON 3
ci_05                -2.146871e-02 3 1  ON 4
ci_06                -2.142278e-02 3 1  ON 5
ci_07                 2.583003e-02 3 1  ON 6
ci_08                -3.599215e-03 3 1  ON 7
ci_09                -1.086968e-02 3 1  ON 8
ci_10                -1.093866e-02 3 1  ON 9
ci_11                 1.604532e-02 3 1  ON 10
ci_12                 1.101525e-02 3 1  ON 11
ci_13                 1.250355e-02 3 1  ON 12
ci_14                 1.717535e-02 3 1  ON 13
ci_15                 7.596259e-03 3 1  ON 14
ci_16                 7.468829e-03 3 1  ON 15
ci_17                -8.916125e-03 3 1  ON 16
ci_18                -8.417387e-03 3 1  ON 17
ci_19                 9.468827e-03 3 1  ON 18
ci_20                 1.035248e-02 3 1  ON 19
ci_21                 8.540915e-03 3 1  ON 20
ci_22                 8.389979e-03 3 1  ON 21
ci_23                 6.492665e-03 3 1  ON 22
ci_24                 7.777269e-03 3 1  ON 23
ci_25                 5.071044e-03 3 1  ON 24
ci_26                 2.878726e-03 3 1  ON 25
ci_27                 2.942144e-03 3 1  ON 26
ci_28                 2.787106e-03 3 1  ON 27
ci_29                 3.036964e-03 3 1  ON 28
ci_30                 5.000971e-04 3 1  ON 29
ci_31                 9.597545e-04 3 1  ON 30
ci_32                -5.942354e-05 3 1  ON 31
ci_33                 1.388653e-04 3 1  ON 32
ci_34                -1.930008e-04 3 1  ON 33
ci_35                -1.432108e-04 3 1  ON 34
ci_36                -5.938079e-04 3 1  ON 35
ci_37                -5.652722e-04 3 1  ON 36
ci_38                -2.110796e-04 3 1  ON 37
ci_39                 1.090140e-04 3 1  ON 38
ci_40                -1.301058e-03 3 1  ON 39
ci_41                -1.887400e-05 3 1  ON 40
ci_42                -8.926800e-05 3 1  ON 41
ci_43                -2.726621e-03 3 1  ON 42
ci_44                -2.696118e-03 3 1  ON 43
ci_45                -1.757632e-04 3 1  ON 44
ci_46                -1.059245e-04 3 1  ON 45
ci_47                -1.240548e-04 3 1  ON 46
ci_48                 1.388243e-06 3 1  ON 47
ci_49                -1.339348e-03 3 1  ON 48
ci_50                -5.832907e-04 3 1  ON 49
ci_51                -1.670447e-04 3 1  ON 50
ci_52                 1.492675e-04 3 1  ON 51
ci_53                -8.684614e-04 3 1  ON 52
ci_54                -6.202949e-04 3 1  ON 53
ci_55                -1.189561e-03 3 1  ON 54
ci_56                 1.568553e-03 3 1  ON 55
ci_57                 1.594730e-03 3 1  ON 56
ci_58                -1.474806e-03 3 1  ON 57
ci_59                -1.427030e-03 3 1  ON 58
ci_60                 1.517315e-03 3 1  ON 59
ci_61                 1.464132e-03 3 1  ON 60
ci_62                -3.671281e-04 3 1  ON 61
ci_63                -1.722633e-04 3 1  ON 62
ci_64                -2.828051e-04 3 1  ON 63
ci_65                -4.439022e-04 3 1  ON 64
ci_66                -2.729651e-04 3 1  ON 65
ci_67                -5.211961e-04 3 1  ON 66
ci_68                -1.565550e-03 3 1  ON 67
ci_69                -1.840967e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9700e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8374
    reference variance = 0.378468
====================================================
  Execution time = 1.0049e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1292e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0469e-01
  Total weights = 7.856443814e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8535e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487760606249
                                         uncertainty =       0.001709582313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487760606249
                                         uncertainty =       0.001709582313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246921451
  error estimate for blocks of size 2^( 2) =       0.000256158247
  error estimate for blocks of size 2^( 3) =       0.000264319500
  error estimate for blocks of size 2^( 4) =       0.000270323609
  error estimate for blocks of size 2^( 5) =       0.000273908726
  error estimate for blocks of size 2^( 6) =       0.000275952652
  error estimate for blocks of size 2^( 7) =       0.000277020922
  error estimate for blocks of size 2^( 8) =       0.000278427044
  error estimate for blocks of size 2^( 9) =       0.000279435630

      target function =                  N/A
              le_mean =     -22.824873394099
             les_mean =     521.479531807381
             stat err =       0.000277709062
             autocorr =       1.264918256813
              std dev =       0.698399330682
             le_variance =       0.487761625097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282487339410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824873394091       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824877761097       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824878059521       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824878227324       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 7.524204e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824873394091       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824875598178       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824875513995       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824875537740       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.178771e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824873394091       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824874133433       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824874059134       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824874063270       residual = 2.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.508633e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024488 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1904e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.086228e-01 3 1  ON 0
ci_02                -2.208434e-02 3 1  ON 1
ci_03                -2.205628e-02 3 1  ON 2
ci_04                 2.193457e-02 3 1  ON 3
ci_05                -2.151623e-02 3 1  ON 4
ci_06                -2.155079e-02 3 1  ON 5
ci_07                 2.561905e-02 3 1  ON 6
ci_08                -3.647399e-03 3 1  ON 7
ci_09                -1.089408e-02 3 1  ON 8
ci_10                -1.091367e-02 3 1  ON 9
ci_11                 1.609449e-02 3 1  ON 10
ci_12                 1.104279e-02 3 1  ON 11
ci_13                 1.248963e-02 3 1  ON 12
ci_14                 1.703556e-02 3 1  ON 13
ci_15                 7.437934e-03 3 1  ON 14
ci_16                 7.576839e-03 3 1  ON 15
ci_17                -8.738517e-03 3 1  ON 16
ci_18                -8.541625e-03 3 1  ON 17
ci_19                 9.629176e-03 3 1  ON 18
ci_20                 1.032816e-02 3 1  ON 19
ci_21                 8.538846e-03 3 1  ON 20
ci_22                 8.332272e-03 3 1  ON 21
ci_23                 6.299665e-03 3 1  ON 22
ci_24                 7.607635e-03 3 1  ON 23
ci_25                 5.233727e-03 3 1  ON 24
ci_26                 2.656397e-03 3 1  ON 25
ci_27                 2.952490e-03 3 1  ON 26
ci_28                 2.774830e-03 3 1  ON 27
ci_29                 3.024474e-03 3 1  ON 28
ci_30                 3.591871e-04 3 1  ON 29
ci_31                 9.062122e-04 3 1  ON 30
ci_32                 2.227572e-05 3 1  ON 31
ci_33                 3.114255e-04 3 1  ON 32
ci_34                -1.740241e-04 3 1  ON 33
ci_35                 1.329081e-04 3 1  ON 34
ci_36                -5.682024e-04 3 1  ON 35
ci_37                -5.255163e-04 3 1  ON 36
ci_38                -1.417751e-04 3 1  ON 37
ci_39                -9.952506e-06 3 1  ON 38
ci_40                -1.238747e-03 3 1  ON 39
ci_41                -1.449760e-05 3 1  ON 40
ci_42                -1.115618e-04 3 1  ON 41
ci_43                -2.586171e-03 3 1  ON 42
ci_44                -2.804218e-03 3 1  ON 43
ci_45                -2.085268e-04 3 1  ON 44
ci_46                -4.379897e-05 3 1  ON 45
ci_47                -1.548723e-04 3 1  ON 46
ci_48                 1.177851e-04 3 1  ON 47
ci_49                -1.328357e-03 3 1  ON 48
ci_50                -5.903676e-04 3 1  ON 49
ci_51                -2.082442e-04 3 1  ON 50
ci_52                 3.972273e-05 3 1  ON 51
ci_53                -8.539787e-04 3 1  ON 52
ci_54                -6.644531e-04 3 1  ON 53
ci_55                -1.085025e-03 3 1  ON 54
ci_56                 1.887935e-03 3 1  ON 55
ci_57                 2.012607e-03 3 1  ON 56
ci_58                -1.595022e-03 3 1  ON 57
ci_59                -1.368410e-03 3 1  ON 58
ci_60                 1.397462e-03 3 1  ON 59
ci_61                 1.495436e-03 3 1  ON 60
ci_62                -1.982309e-04 3 1  ON 61
ci_63                -2.067379e-05 3 1  ON 62
ci_64                -2.830876e-04 3 1  ON 63
ci_65                -5.775014e-04 3 1  ON 64
ci_66                -4.241446e-04 3 1  ON 65
ci_67                -5.274843e-04 3 1  ON 66
ci_68                -1.568527e-03 3 1  ON 67
ci_69                -1.823120e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7815
    reference variance = 0.289913
====================================================
  Execution time = 1.0193e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1204e-01
  Total weights = 7.8569e+06
  Execution time = 1.4334e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488684697280
                                         uncertainty =       0.001422711162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488684697280
                                         uncertainty =       0.001422711162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247155620
  error estimate for blocks of size 2^( 2) =       0.000256354846
  error estimate for blocks of size 2^( 3) =       0.000264542815
  error estimate for blocks of size 2^( 4) =       0.000270517612
  error estimate for blocks of size 2^( 5) =       0.000274096629
  error estimate for blocks of size 2^( 6) =       0.000276184745
  error estimate for blocks of size 2^( 7) =       0.000277300231
  error estimate for blocks of size 2^( 8) =       0.000277660662
  error estimate for blocks of size 2^( 9) =       0.000277497178

      target function =                  N/A
              le_mean =     -22.824865567840
             les_mean =     521.501563306198
             stat err =       0.000277160704
             autocorr =       1.257541521722
              std dev =       0.699061658299
             le_variance =       0.488687202104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488762878970
                                         uncertainty =       0.001409562954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488762878970
                                         uncertainty =       0.001409562954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247175368
  error estimate for blocks of size 2^( 2) =       0.000256373814
  error estimate for blocks of size 2^( 3) =       0.000264564177
  error estimate for blocks of size 2^( 4) =       0.000270540681
  error estimate for blocks of size 2^( 5) =       0.000274121006
  error estimate for blocks of size 2^( 6) =       0.000276201326
  error estimate for blocks of size 2^( 7) =       0.000277316915
  error estimate for blocks of size 2^( 8) =       0.000277673837
  error estimate for blocks of size 2^( 9) =       0.000277512599

      target function =                  N/A
              le_mean =     -22.824870114882
             les_mean =     521.523455585214
             stat err =       0.000277176169
             autocorr =       1.257480897997
              std dev =       0.699117516611
             le_variance =       0.488765302032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488772592711
                                         uncertainty =       0.001409197404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488772592711
                                         uncertainty =       0.001409197404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247177823
  error estimate for blocks of size 2^( 2) =       0.000256375984
  error estimate for blocks of size 2^( 3) =       0.000264565661
  error estimate for blocks of size 2^( 4) =       0.000270542768
  error estimate for blocks of size 2^( 5) =       0.000274121938
  error estimate for blocks of size 2^( 6) =       0.000276198719
  error estimate for blocks of size 2^( 7) =       0.000277314125
  error estimate for blocks of size 2^( 8) =       0.000277669754
  error estimate for blocks of size 2^( 9) =       0.000277501764

      target function =                  N/A
              le_mean =     -22.824870830161
             les_mean =     521.520263628337
             stat err =       0.000277171090
             autocorr =       1.257409836040
              std dev =       0.699124460555
             le_variance =       0.488775011347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488675026518
                                         uncertainty =       0.001421637821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488675026518
                                         uncertainty =       0.001421637821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247153172
  error estimate for blocks of size 2^( 2) =       0.000256352202
  error estimate for blocks of size 2^( 3) =       0.000264540894
  error estimate for blocks of size 2^( 4) =       0.000270515805
  error estimate for blocks of size 2^( 5) =       0.000274096148
  error estimate for blocks of size 2^( 6) =       0.000276180257
  error estimate for blocks of size 2^( 7) =       0.000277298275
  error estimate for blocks of size 2^( 8) =       0.000277662620
  error estimate for blocks of size 2^( 9) =       0.000277500081

      target function =                  N/A
              le_mean =     -22.824864295583
             les_mean =     521.530894518980
             stat err =       0.000277160308
             autocorr =       1.257562832355
              std dev =       0.699054735791
             le_variance =       0.488677523632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824865567840        initial
     9.7656e-02     9.7656e-01             7.5242e-04       -22.824870114882
     3.9062e-01     3.9062e+00             4.1788e-04       -22.824870830161  <--
     1.5625e+00     1.5625e+01             1.5086e-04       -22.824864295583

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 1.7396e+02
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.086228e-01 3 1  ON 0
ci_02                -2.208434e-02 3 1  ON 1
ci_03                -2.205628e-02 3 1  ON 2
ci_04                 2.193457e-02 3 1  ON 3
ci_05                -2.151623e-02 3 1  ON 4
ci_06                -2.155079e-02 3 1  ON 5
ci_07                 2.561905e-02 3 1  ON 6
ci_08                -3.647399e-03 3 1  ON 7
ci_09                -1.089408e-02 3 1  ON 8
ci_10                -1.091367e-02 3 1  ON 9
ci_11                 1.609449e-02 3 1  ON 10
ci_12                 1.104279e-02 3 1  ON 11
ci_13                 1.248963e-02 3 1  ON 12
ci_14                 1.703556e-02 3 1  ON 13
ci_15                 7.437934e-03 3 1  ON 14
ci_16                 7.576839e-03 3 1  ON 15
ci_17                -8.738517e-03 3 1  ON 16
ci_18                -8.541625e-03 3 1  ON 17
ci_19                 9.629176e-03 3 1  ON 18
ci_20                 1.032816e-02 3 1  ON 19
ci_21                 8.538846e-03 3 1  ON 20
ci_22                 8.332272e-03 3 1  ON 21
ci_23                 6.299665e-03 3 1  ON 22
ci_24                 7.607635e-03 3 1  ON 23
ci_25                 5.233727e-03 3 1  ON 24
ci_26                 2.656397e-03 3 1  ON 25
ci_27                 2.952490e-03 3 1  ON 26
ci_28                 2.774830e-03 3 1  ON 27
ci_29                 3.024474e-03 3 1  ON 28
ci_30                 3.591871e-04 3 1  ON 29
ci_31                 9.062122e-04 3 1  ON 30
ci_32                 2.227572e-05 3 1  ON 31
ci_33                 3.114255e-04 3 1  ON 32
ci_34                -1.740241e-04 3 1  ON 33
ci_35                 1.329081e-04 3 1  ON 34
ci_36                -5.682024e-04 3 1  ON 35
ci_37                -5.255163e-04 3 1  ON 36
ci_38                -1.417751e-04 3 1  ON 37
ci_39                -9.952506e-06 3 1  ON 38
ci_40                -1.238747e-03 3 1  ON 39
ci_41                -1.449760e-05 3 1  ON 40
ci_42                -1.115618e-04 3 1  ON 41
ci_43                -2.586171e-03 3 1  ON 42
ci_44                -2.804218e-03 3 1  ON 43
ci_45                -2.085268e-04 3 1  ON 44
ci_46                -4.379897e-05 3 1  ON 45
ci_47                -1.548723e-04 3 1  ON 46
ci_48                 1.177851e-04 3 1  ON 47
ci_49                -1.328357e-03 3 1  ON 48
ci_50                -5.903676e-04 3 1  ON 49
ci_51                -2.082442e-04 3 1  ON 50
ci_52                 3.972273e-05 3 1  ON 51
ci_53                -8.539787e-04 3 1  ON 52
ci_54                -6.644531e-04 3 1  ON 53
ci_55                -1.085025e-03 3 1  ON 54
ci_56                 1.887935e-03 3 1  ON 55
ci_57                 2.012607e-03 3 1  ON 56
ci_58                -1.595022e-03 3 1  ON 57
ci_59                -1.368410e-03 3 1  ON 58
ci_60                 1.397462e-03 3 1  ON 59
ci_61                 1.495436e-03 3 1  ON 60
ci_62                -1.982309e-04 3 1  ON 61
ci_63                -2.067379e-05 3 1  ON 62
ci_64                -2.830876e-04 3 1  ON 63
ci_65                -5.775014e-04 3 1  ON 64
ci_66                -4.241446e-04 3 1  ON 65
ci_67                -5.274843e-04 3 1  ON 66
ci_68                -1.568527e-03 3 1  ON 67
ci_69                -1.823120e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9300e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8641
    reference variance = 0.343729
====================================================
  Execution time = 1.0024e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1396e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0312e-01
  Total weights = 7.857133520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8460e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486029691295
                                         uncertainty =       0.001292101479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486029691295
                                         uncertainty =       0.001292101479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246482581
  error estimate for blocks of size 2^( 2) =       0.000255778784
  error estimate for blocks of size 2^( 3) =       0.000263968668
  error estimate for blocks of size 2^( 4) =       0.000269910219
  error estimate for blocks of size 2^( 5) =       0.000273495206
  error estimate for blocks of size 2^( 6) =       0.000275284801
  error estimate for blocks of size 2^( 7) =       0.000276712899
  error estimate for blocks of size 2^( 8) =       0.000276961148
  error estimate for blocks of size 2^( 9) =       0.000277356105

      target function =                  N/A
              le_mean =     -22.825107383254
             les_mean =     521.488647511318
             stat err =       0.000276578738
             autocorr =       1.259114183426
              std dev =       0.697158018215
             le_variance =       0.486029302362


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282510738325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825107383248       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825115197657       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825115165599       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825115020754       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 8.356938e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825107383248       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825111215965       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825111226832       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825111198963       residual = 6.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.826329e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825107383248       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825108644786       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825108679442       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825108674971       residual = 3.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.262323e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1872e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.086672e-01 3 1  ON 0
ci_02                -2.214889e-02 3 1  ON 1
ci_03                -2.211225e-02 3 1  ON 2
ci_04                 2.180196e-02 3 1  ON 3
ci_05                -2.168052e-02 3 1  ON 4
ci_06                -2.156214e-02 3 1  ON 5
ci_07                 2.577178e-02 3 1  ON 6
ci_08                -3.581633e-03 3 1  ON 7
ci_09                -1.065331e-02 3 1  ON 8
ci_10                -1.079985e-02 3 1  ON 9
ci_11                 1.618216e-02 3 1  ON 10
ci_12                 1.142542e-02 3 1  ON 11
ci_13                 1.247955e-02 3 1  ON 12
ci_14                 1.687044e-02 3 1  ON 13
ci_15                 7.403395e-03 3 1  ON 14
ci_16                 7.337758e-03 3 1  ON 15
ci_17                -9.022365e-03 3 1  ON 16
ci_18                -8.575593e-03 3 1  ON 17
ci_19                 9.496334e-03 3 1  ON 18
ci_20                 1.039522e-02 3 1  ON 19
ci_21                 8.446754e-03 3 1  ON 20
ci_22                 8.080170e-03 3 1  ON 21
ci_23                 6.438139e-03 3 1  ON 22
ci_24                 7.538032e-03 3 1  ON 23
ci_25                 5.190456e-03 3 1  ON 24
ci_26                 2.808248e-03 3 1  ON 25
ci_27                 2.938867e-03 3 1  ON 26
ci_28                 2.935497e-03 3 1  ON 27
ci_29                 2.881868e-03 3 1  ON 28
ci_30                 3.234577e-04 3 1  ON 29
ci_31                 9.130919e-04 3 1  ON 30
ci_32                -2.739666e-05 3 1  ON 31
ci_33                 1.776861e-04 3 1  ON 32
ci_34                -2.782574e-04 3 1  ON 33
ci_35                 2.256268e-04 3 1  ON 34
ci_36                -6.210765e-04 3 1  ON 35
ci_37                -5.688988e-04 3 1  ON 36
ci_38                -5.651973e-05 3 1  ON 37
ci_39                -1.756903e-05 3 1  ON 38
ci_40                -1.169795e-03 3 1  ON 39
ci_41                -1.220678e-04 3 1  ON 40
ci_42                -2.380646e-05 3 1  ON 41
ci_43                -2.518445e-03 3 1  ON 42
ci_44                -2.789299e-03 3 1  ON 43
ci_45                -1.135407e-04 3 1  ON 44
ci_46                -1.300580e-04 3 1  ON 45
ci_47                -2.255425e-04 3 1  ON 46
ci_48                 7.085738e-05 3 1  ON 47
ci_49                -1.407419e-03 3 1  ON 48
ci_50                -4.958416e-04 3 1  ON 49
ci_51                -1.036914e-04 3 1  ON 50
ci_52                 7.504922e-05 3 1  ON 51
ci_53                -1.048226e-03 3 1  ON 52
ci_54                -6.092481e-04 3 1  ON 53
ci_55                -9.512221e-04 3 1  ON 54
ci_56                 1.619202e-03 3 1  ON 55
ci_57                 1.775732e-03 3 1  ON 56
ci_58                -1.349206e-03 3 1  ON 57
ci_59                -1.358964e-03 3 1  ON 58
ci_60                 1.446112e-03 3 1  ON 59
ci_61                 1.808038e-03 3 1  ON 60
ci_62                -2.353775e-04 3 1  ON 61
ci_63                -2.155883e-04 3 1  ON 62
ci_64                -3.825622e-04 3 1  ON 63
ci_65                -7.455238e-04 3 1  ON 64
ci_66                -4.823003e-04 3 1  ON 65
ci_67                -3.677961e-04 3 1  ON 66
ci_68                -1.551894e-03 3 1  ON 67
ci_69                -1.769311e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8414
    reference variance = 0.462471
====================================================
  Execution time = 1.0098e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0497e-01
  Total weights = 7.8576e+06
  Execution time = 1.4561e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488021545047
                                         uncertainty =       0.002732120712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488021545047
                                         uncertainty =       0.002732120712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246987510
  error estimate for blocks of size 2^( 2) =       0.000256204215
  error estimate for blocks of size 2^( 3) =       0.000264312762
  error estimate for blocks of size 2^( 4) =       0.000270085034
  error estimate for blocks of size 2^( 5) =       0.000273507842
  error estimate for blocks of size 2^( 6) =       0.000275470564
  error estimate for blocks of size 2^( 7) =       0.000276507823
  error estimate for blocks of size 2^( 8) =       0.000277132590
  error estimate for blocks of size 2^( 9) =       0.000277302897

      target function =                  N/A
              le_mean =     -22.824646127990
             les_mean =     521.714542557267
             stat err =       0.000276603468
             autocorr =       1.254195559593
              std dev =       0.698586173328
             le_variance =       0.488022641565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488026104580
                                         uncertainty =       0.002714094821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488026104580
                                         uncertainty =       0.002714094821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246988659
  error estimate for blocks of size 2^( 2) =       0.000256205834
  error estimate for blocks of size 2^( 3) =       0.000264313488
  error estimate for blocks of size 2^( 4) =       0.000270083172
  error estimate for blocks of size 2^( 5) =       0.000273505058
  error estimate for blocks of size 2^( 6) =       0.000275469318
  error estimate for blocks of size 2^( 7) =       0.000276510291
  error estimate for blocks of size 2^( 8) =       0.000277131912
  error estimate for blocks of size 2^( 9) =       0.000277303641

      target function =                  N/A
              le_mean =     -22.824647869761
             les_mean =     521.477344811694
             stat err =       0.000276603791
             autocorr =       1.254186818468
              std dev =       0.698589421534
             le_variance =       0.488027179879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488070537512
                                         uncertainty =       0.002719274364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488070537512
                                         uncertainty =       0.002719274364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246999912
  error estimate for blocks of size 2^( 2) =       0.000256217861
  error estimate for blocks of size 2^( 3) =       0.000264324578
  error estimate for blocks of size 2^( 4) =       0.000270096320
  error estimate for blocks of size 2^( 5) =       0.000273521700
  error estimate for blocks of size 2^( 6) =       0.000275485216
  error estimate for blocks of size 2^( 7) =       0.000276531174
  error estimate for blocks of size 2^( 8) =       0.000277149813
  error estimate for blocks of size 2^( 9) =       0.000277321686

      target function =                  N/A
              le_mean =     -22.824644819651
             les_mean =     521.604468259177
             stat err =       0.000276621972
             autocorr =       1.254237405025
              std dev =       0.698621251665
             le_variance =       0.488071653278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488016825867
                                         uncertainty =       0.002730384655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488016825867
                                         uncertainty =       0.002730384655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246986315
  error estimate for blocks of size 2^( 2) =       0.000256202861
  error estimate for blocks of size 2^( 3) =       0.000264311700
  error estimate for blocks of size 2^( 4) =       0.000270083119
  error estimate for blocks of size 2^( 5) =       0.000273504534
  error estimate for blocks of size 2^( 6) =       0.000275467237
  error estimate for blocks of size 2^( 7) =       0.000276505757
  error estimate for blocks of size 2^( 8) =       0.000277131874
  error estimate for blocks of size 2^( 9) =       0.000277293496

      target function =                  N/A
              le_mean =     -22.824646452878
             les_mean =     521.484003680193
             stat err =       0.000276599591
             autocorr =       1.254172531710
              std dev =       0.698582793504
             le_variance =       0.488017919380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824646127990        initial
     9.7656e-02     9.7656e-01             8.3569e-04       -22.824647869761  <--
     3.9062e-01     3.9062e+00             3.8263e-04       -22.824644819651
     1.5625e+00     1.5625e+01             1.2623e-04       -22.824646452878

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7328e+02
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.086868e-01 3 1  ON 0
ci_02                -2.221939e-02 3 1  ON 1
ci_03                -2.219908e-02 3 1  ON 2
ci_04                 2.166482e-02 3 1  ON 3
ci_05                -2.189442e-02 3 1  ON 4
ci_06                -2.157467e-02 3 1  ON 5
ci_07                 2.594136e-02 3 1  ON 6
ci_08                -3.534795e-03 3 1  ON 7
ci_09                -1.035128e-02 3 1  ON 8
ci_10                -1.066447e-02 3 1  ON 9
ci_11                 1.628485e-02 3 1  ON 10
ci_12                 1.181953e-02 3 1  ON 11
ci_13                 1.242575e-02 3 1  ON 12
ci_14                 1.657660e-02 3 1  ON 13
ci_15                 7.383046e-03 3 1  ON 14
ci_16                 7.059893e-03 3 1  ON 15
ci_17                -9.367706e-03 3 1  ON 16
ci_18                -8.616827e-03 3 1  ON 17
ci_19                 9.397226e-03 3 1  ON 18
ci_20                 1.050091e-02 3 1  ON 19
ci_21                 8.349415e-03 3 1  ON 20
ci_22                 7.760203e-03 3 1  ON 21
ci_23                 6.561976e-03 3 1  ON 22
ci_24                 7.434666e-03 3 1  ON 23
ci_25                 5.149758e-03 3 1  ON 24
ci_26                 3.005037e-03 3 1  ON 25
ci_27                 2.951797e-03 3 1  ON 26
ci_28                 3.118419e-03 3 1  ON 27
ci_29                 2.737359e-03 3 1  ON 28
ci_30                 2.818532e-04 3 1  ON 29
ci_31                 9.320088e-04 3 1  ON 30
ci_32                -7.778589e-05 3 1  ON 31
ci_33                 5.345384e-05 3 1  ON 32
ci_34                -3.994199e-04 3 1  ON 33
ci_35                 3.244728e-04 3 1  ON 34
ci_36                -6.602471e-04 3 1  ON 35
ci_37                -6.116959e-04 3 1  ON 36
ci_38                 1.225971e-05 3 1  ON 37
ci_39                -2.819945e-05 3 1  ON 38
ci_40                -1.126846e-03 3 1  ON 39
ci_41                -2.247238e-04 3 1  ON 40
ci_42                 4.814405e-05 3 1  ON 41
ci_43                -2.434247e-03 3 1  ON 42
ci_44                -2.766929e-03 3 1  ON 43
ci_45                -4.468683e-05 3 1  ON 44
ci_46                -2.024398e-04 3 1  ON 45
ci_47                -3.197813e-04 3 1  ON 46
ci_48                -1.454800e-05 3 1  ON 47
ci_49                -1.469334e-03 3 1  ON 48
ci_50                -4.297954e-04 3 1  ON 49
ci_51                -1.955824e-05 3 1  ON 50
ci_52                 1.006084e-04 3 1  ON 51
ci_53                -1.178682e-03 3 1  ON 52
ci_54                -5.404952e-04 3 1  ON 53
ci_55                -7.934965e-04 3 1  ON 54
ci_56                 1.396913e-03 3 1  ON 55
ci_57                 1.588386e-03 3 1  ON 56
ci_58                -1.092786e-03 3 1  ON 57
ci_59                -1.355147e-03 3 1  ON 58
ci_60                 1.502436e-03 3 1  ON 59
ci_61                 2.331130e-03 3 1  ON 60
ci_62                -2.605974e-04 3 1  ON 61
ci_63                -3.449669e-04 3 1  ON 62
ci_64                -4.709748e-04 3 1  ON 63
ci_65                -8.923062e-04 3 1  ON 64
ci_66                -5.323900e-04 3 1  ON 65
ci_67                -2.307076e-04 3 1  ON 66
ci_68                -1.548838e-03 3 1  ON 67
ci_69                -1.703684e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7532
    reference variance = 0.268824
====================================================
  Execution time = 1.0003e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1329e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0967e-01
  Total weights = 7.857142660e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8533e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486947617196
                                         uncertainty =       0.001409897099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486947617196
                                         uncertainty =       0.001409897099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246715579
  error estimate for blocks of size 2^( 2) =       0.000255838636
  error estimate for blocks of size 2^( 3) =       0.000263978225
  error estimate for blocks of size 2^( 4) =       0.000270096115
  error estimate for blocks of size 2^( 5) =       0.000273856076
  error estimate for blocks of size 2^( 6) =       0.000275518879
  error estimate for blocks of size 2^( 7) =       0.000276802193
  error estimate for blocks of size 2^( 8) =       0.000277096552
  error estimate for blocks of size 2^( 9) =       0.000278668585

      target function =                  N/A
              le_mean =     -22.824459124730
             les_mean =     521.465607334013
             stat err =       0.000277021552
             autocorr =       1.260764490476
              std dev =       0.697817036118
             le_variance =       0.486948615896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282445912473e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824459124724       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824466672829       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824469670044       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824468967377       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824468827968       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824468804410       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.429742e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824459124724       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824464781296       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824466241875       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824465972365       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824465949338       residual = 8.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 9.967146e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824459124724       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824461949634       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824462203837       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824462201012       residual = 5.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.732459e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1858e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.084345e-01 3 1  ON 0
ci_02                -2.180002e-02 3 1  ON 1
ci_03                -2.218941e-02 3 1  ON 2
ci_04                 2.219978e-02 3 1  ON 3
ci_05                -2.175036e-02 3 1  ON 4
ci_06                -2.131335e-02 3 1  ON 5
ci_07                 2.624111e-02 3 1  ON 6
ci_08                -3.558389e-03 3 1  ON 7
ci_09                -1.044415e-02 3 1  ON 8
ci_10                -1.137522e-02 3 1  ON 9
ci_11                 1.667595e-02 3 1  ON 10
ci_12                 1.106756e-02 3 1  ON 11
ci_13                 1.209989e-02 3 1  ON 12
ci_14                 1.652325e-02 3 1  ON 13
ci_15                 7.693426e-03 3 1  ON 14
ci_16                 7.206446e-03 3 1  ON 15
ci_17                -8.897844e-03 3 1  ON 16
ci_18                -9.062864e-03 3 1  ON 17
ci_19                 1.021591e-02 3 1  ON 18
ci_20                 1.095424e-02 3 1  ON 19
ci_21                 8.043458e-03 3 1  ON 20
ci_22                 8.690298e-03 3 1  ON 21
ci_23                 6.448961e-03 3 1  ON 22
ci_24                 7.770236e-03 3 1  ON 23
ci_25                 5.095449e-03 3 1  ON 24
ci_26                 2.645525e-03 3 1  ON 25
ci_27                 3.948512e-03 3 1  ON 26
ci_28                 3.094924e-03 3 1  ON 27
ci_29                 2.621908e-03 3 1  ON 28
ci_30                 1.189671e-03 3 1  ON 29
ci_31                 7.663326e-04 3 1  ON 30
ci_32                 7.607659e-04 3 1  ON 31
ci_33                 9.287320e-05 3 1  ON 32
ci_34                -3.101410e-04 3 1  ON 33
ci_35                -9.681738e-05 3 1  ON 34
ci_36                -1.763683e-04 3 1  ON 35
ci_37                -7.915729e-04 3 1  ON 36
ci_38                -5.017917e-04 3 1  ON 37
ci_39                -9.148703e-06 3 1  ON 38
ci_40                -1.493058e-03 3 1  ON 39
ci_41                -7.613686e-05 3 1  ON 40
ci_42                 4.749975e-05 3 1  ON 41
ci_43                -2.755539e-03 3 1  ON 42
ci_44                -2.027351e-03 3 1  ON 43
ci_45                -2.158961e-04 3 1  ON 44
ci_46                -4.846225e-04 3 1  ON 45
ci_47                -3.905629e-04 3 1  ON 46
ci_48                 7.710022e-04 3 1  ON 47
ci_49                -1.204885e-03 3 1  ON 48
ci_50                -6.992788e-04 3 1  ON 49
ci_51                -4.446787e-04 3 1  ON 50
ci_52                 2.229209e-05 3 1  ON 51
ci_53                -1.119914e-03 3 1  ON 52
ci_54                -8.188325e-04 3 1  ON 53
ci_55                -7.137453e-04 3 1  ON 54
ci_56                 1.890710e-03 3 1  ON 55
ci_57                 1.359631e-03 3 1  ON 56
ci_58                -1.713870e-03 3 1  ON 57
ci_59                -1.494778e-03 3 1  ON 58
ci_60                 1.211129e-03 3 1  ON 59
ci_61                 3.021462e-03 3 1  ON 60
ci_62                -4.035453e-04 3 1  ON 61
ci_63                -5.361302e-04 3 1  ON 62
ci_64                -6.629704e-04 3 1  ON 63
ci_65                -1.024656e-03 3 1  ON 64
ci_66                -5.403160e-04 3 1  ON 65
ci_67                -5.247113e-04 3 1  ON 66
ci_68                -1.299418e-03 3 1  ON 67
ci_69                -1.380371e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8172
    reference variance = 0.441065
====================================================
  Execution time = 1.0128e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0216e-01
  Total weights = 7.8567e+06
  Execution time = 1.4378e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00246167
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487444678586
                                         uncertainty =       0.002207116873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487444678586
                                         uncertainty =       0.002207116873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246841729
  error estimate for blocks of size 2^( 2) =       0.000255995001
  error estimate for blocks of size 2^( 3) =       0.000264158274
  error estimate for blocks of size 2^( 4) =       0.000270078645
  error estimate for blocks of size 2^( 5) =       0.000273556527
  error estimate for blocks of size 2^( 6) =       0.000275412831
  error estimate for blocks of size 2^( 7) =       0.000276097370
  error estimate for blocks of size 2^( 8) =       0.000277400557
  error estimate for blocks of size 2^( 9) =       0.000278008625

      target function =                  N/A
              le_mean =     -22.824988245736
             les_mean =     521.517517887560
             stat err =       0.000276729846
             autocorr =       1.256825093736
              std dev =       0.698173841560
             le_variance =       0.487446713039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485902354529
                                         uncertainty =       0.001380072741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485902354529
                                         uncertainty =       0.001380072741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246450562
  error estimate for blocks of size 2^( 2) =       0.000255618661
  error estimate for blocks of size 2^( 3) =       0.000263790645
  error estimate for blocks of size 2^( 4) =       0.000269718206
  error estimate for blocks of size 2^( 5) =       0.000273199413
  error estimate for blocks of size 2^( 6) =       0.000275065487
  error estimate for blocks of size 2^( 7) =       0.000275747077
  error estimate for blocks of size 2^( 8) =       0.000277197384
  error estimate for blocks of size 2^( 9) =       0.000277648225

      target function =                  N/A
              le_mean =     -22.824976013524
             les_mean =     521.500850944010
             stat err =       0.000276414543
             autocorr =       1.257946452269
              std dev =       0.697067453313
             le_variance =       0.485903034468

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00243955
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486468832976
                                         uncertainty =       0.001404370158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486468832976
                                         uncertainty =       0.001404370158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246594108
  error estimate for blocks of size 2^( 2) =       0.000255760018
  error estimate for blocks of size 2^( 3) =       0.000263932622
  error estimate for blocks of size 2^( 4) =       0.000269865393
  error estimate for blocks of size 2^( 5) =       0.000273352875
  error estimate for blocks of size 2^( 6) =       0.000275214196
  error estimate for blocks of size 2^( 7) =       0.000275875005
  error estimate for blocks of size 2^( 8) =       0.000277350895
  error estimate for blocks of size 2^( 9) =       0.000277741652

      target function =                  N/A
              le_mean =     -22.824997338435
             les_mean =     521.857973555114
             stat err =       0.000276545437
             autocorr =       1.257672607996
              std dev =       0.697473464900
             le_variance =       0.486469234239

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.118974
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486373327645
                                         uncertainty =       0.001494332141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486373327645
                                         uncertainty =       0.001494332141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246570098
  error estimate for blocks of size 2^( 2) =       0.000255732910
  error estimate for blocks of size 2^( 3) =       0.000263901132
  error estimate for blocks of size 2^( 4) =       0.000269829188
  error estimate for blocks of size 2^( 5) =       0.000273309109
  error estimate for blocks of size 2^( 6) =       0.000275173914
  error estimate for blocks of size 2^( 7) =       0.000275859946
  error estimate for blocks of size 2^( 8) =       0.000277277328
  error estimate for blocks of size 2^( 9) =       0.000277809213

      target function =                  N/A
              le_mean =     -22.824978111341
             les_mean =     521.590746120465
             stat err =       0.000276530100
             autocorr =       1.257778032949
              std dev =       0.697405554663
             le_variance =       0.486374507675


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824988245736        initial
     2.4414e-02     2.4414e-01             1.4297e-03       -22.824976013524
     9.7656e-02     9.7656e-01             9.9671e-04       -22.824997338435  <--
     3.9062e-01     3.9062e+00             4.7325e-04       -22.824978111341

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 1.7333e+02
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.084345e-01 3 1  ON 0
ci_02                -2.180002e-02 3 1  ON 1
ci_03                -2.218941e-02 3 1  ON 2
ci_04                 2.219978e-02 3 1  ON 3
ci_05                -2.175036e-02 3 1  ON 4
ci_06                -2.131335e-02 3 1  ON 5
ci_07                 2.624111e-02 3 1  ON 6
ci_08                -3.558389e-03 3 1  ON 7
ci_09                -1.044415e-02 3 1  ON 8
ci_10                -1.137522e-02 3 1  ON 9
ci_11                 1.667595e-02 3 1  ON 10
ci_12                 1.106756e-02 3 1  ON 11
ci_13                 1.209989e-02 3 1  ON 12
ci_14                 1.652325e-02 3 1  ON 13
ci_15                 7.693426e-03 3 1  ON 14
ci_16                 7.206446e-03 3 1  ON 15
ci_17                -8.897844e-03 3 1  ON 16
ci_18                -9.062864e-03 3 1  ON 17
ci_19                 1.021591e-02 3 1  ON 18
ci_20                 1.095424e-02 3 1  ON 19
ci_21                 8.043458e-03 3 1  ON 20
ci_22                 8.690298e-03 3 1  ON 21
ci_23                 6.448961e-03 3 1  ON 22
ci_24                 7.770236e-03 3 1  ON 23
ci_25                 5.095449e-03 3 1  ON 24
ci_26                 2.645525e-03 3 1  ON 25
ci_27                 3.948512e-03 3 1  ON 26
ci_28                 3.094924e-03 3 1  ON 27
ci_29                 2.621908e-03 3 1  ON 28
ci_30                 1.189671e-03 3 1  ON 29
ci_31                 7.663326e-04 3 1  ON 30
ci_32                 7.607659e-04 3 1  ON 31
ci_33                 9.287320e-05 3 1  ON 32
ci_34                -3.101410e-04 3 1  ON 33
ci_35                -9.681738e-05 3 1  ON 34
ci_36                -1.763683e-04 3 1  ON 35
ci_37                -7.915729e-04 3 1  ON 36
ci_38                -5.017917e-04 3 1  ON 37
ci_39                -9.148703e-06 3 1  ON 38
ci_40                -1.493058e-03 3 1  ON 39
ci_41                -7.613686e-05 3 1  ON 40
ci_42                 4.749975e-05 3 1  ON 41
ci_43                -2.755539e-03 3 1  ON 42
ci_44                -2.027351e-03 3 1  ON 43
ci_45                -2.158961e-04 3 1  ON 44
ci_46                -4.846225e-04 3 1  ON 45
ci_47                -3.905629e-04 3 1  ON 46
ci_48                 7.710022e-04 3 1  ON 47
ci_49                -1.204885e-03 3 1  ON 48
ci_50                -6.992788e-04 3 1  ON 49
ci_51                -4.446787e-04 3 1  ON 50
ci_52                 2.229209e-05 3 1  ON 51
ci_53                -1.119914e-03 3 1  ON 52
ci_54                -8.188325e-04 3 1  ON 53
ci_55                -7.137453e-04 3 1  ON 54
ci_56                 1.890710e-03 3 1  ON 55
ci_57                 1.359631e-03 3 1  ON 56
ci_58                -1.713870e-03 3 1  ON 57
ci_59                -1.494778e-03 3 1  ON 58
ci_60                 1.211129e-03 3 1  ON 59
ci_61                 3.021462e-03 3 1  ON 60
ci_62                -4.035453e-04 3 1  ON 61
ci_63                -5.361302e-04 3 1  ON 62
ci_64                -6.629704e-04 3 1  ON 63
ci_65                -1.024656e-03 3 1  ON 64
ci_66                -5.403160e-04 3 1  ON 65
ci_67                -5.247113e-04 3 1  ON 66
ci_68                -1.299418e-03 3 1  ON 67
ci_69                -1.380371e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9193e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8993
    reference variance = 0.464509
====================================================
  Execution time = 1.0005e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1337e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0450e-01
  Total weights = 7.855749870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8448e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487224684237
                                         uncertainty =       0.001996419659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487224684237
                                         uncertainty =       0.001996419659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246785499
  error estimate for blocks of size 2^( 2) =       0.000255933654
  error estimate for blocks of size 2^( 3) =       0.000264328414
  error estimate for blocks of size 2^( 4) =       0.000270225244
  error estimate for blocks of size 2^( 5) =       0.000273321339
  error estimate for blocks of size 2^( 6) =       0.000275329703
  error estimate for blocks of size 2^( 7) =       0.000276120840
  error estimate for blocks of size 2^( 8) =       0.000275739070
  error estimate for blocks of size 2^( 9) =       0.000275856142

      target function =                  N/A
              le_mean =     -22.824105728351
             les_mean =     521.444300633183
             stat err =       0.000275761439
             autocorr =       1.248612846831
              std dev =       0.698014798991
             le_variance =       0.487224659610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282410572835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824105728343       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824114550011       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824115578317       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824115752385       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824115823009       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.088380e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824105728343       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824112496955       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824113131894       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824113208944       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824113229420       residual = 4.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 7.767600e-04

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824105728343       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824109233731       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824109518765       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824109547652       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.654884e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1851e+02
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.087916e-01 3 1  ON 0
ci_02                -2.174416e-02 3 1  ON 1
ci_03                -2.199182e-02 3 1  ON 2
ci_04                 2.238022e-02 3 1  ON 3
ci_05                -2.150228e-02 3 1  ON 4
ci_06                -2.120571e-02 3 1  ON 5
ci_07                 2.549568e-02 3 1  ON 6
ci_08                -3.410535e-03 3 1  ON 7
ci_09                -1.057982e-02 3 1  ON 8
ci_10                -1.100802e-02 3 1  ON 9
ci_11                 1.589919e-02 3 1  ON 10
ci_12                 1.107967e-02 3 1  ON 11
ci_13                 1.210354e-02 3 1  ON 12
ci_14                 1.694267e-02 3 1  ON 13
ci_15                 7.548580e-03 3 1  ON 14
ci_16                 6.988189e-03 3 1  ON 15
ci_17                -8.794300e-03 3 1  ON 16
ci_18                -8.731862e-03 3 1  ON 17
ci_19                 9.637933e-03 3 1  ON 18
ci_20                 1.047972e-02 3 1  ON 19
ci_21                 8.149609e-03 3 1  ON 20
ci_22                 8.801686e-03 3 1  ON 21
ci_23                 6.141709e-03 3 1  ON 22
ci_24                 7.686881e-03 3 1  ON 23
ci_25                 5.004811e-03 3 1  ON 24
ci_26                 2.596659e-03 3 1  ON 25
ci_27                 3.690136e-03 3 1  ON 26
ci_28                 2.718300e-03 3 1  ON 27
ci_29                 2.761463e-03 3 1  ON 28
ci_30                 1.525983e-03 3 1  ON 29
ci_31                 8.166914e-04 3 1  ON 30
ci_32                 2.537100e-04 3 1  ON 31
ci_33                 1.905485e-04 3 1  ON 32
ci_34                -2.809648e-04 3 1  ON 33
ci_35                -2.051705e-04 3 1  ON 34
ci_36                -5.285639e-04 3 1  ON 35
ci_37                -1.050740e-03 3 1  ON 36
ci_38                -2.396782e-04 3 1  ON 37
ci_39                -5.654829e-05 3 1  ON 38
ci_40                -1.119904e-03 3 1  ON 39
ci_41                 2.831570e-04 3 1  ON 40
ci_42                -4.744363e-05 3 1  ON 41
ci_43                -2.817147e-03 3 1  ON 42
ci_44                -2.203313e-03 3 1  ON 43
ci_45                -2.687165e-04 3 1  ON 44
ci_46                -1.450764e-04 3 1  ON 45
ci_47                -1.230099e-04 3 1  ON 46
ci_48                 9.923852e-04 3 1  ON 47
ci_49                -1.250101e-03 3 1  ON 48
ci_50                -6.287809e-04 3 1  ON 49
ci_51                -3.751469e-04 3 1  ON 50
ci_52                 1.061442e-04 3 1  ON 51
ci_53                -1.277793e-03 3 1  ON 52
ci_54                -5.344468e-04 3 1  ON 53
ci_55                -6.395500e-04 3 1  ON 54
ci_56                 1.908979e-03 3 1  ON 55
ci_57                 1.463838e-03 3 1  ON 56
ci_58                -1.537537e-03 3 1  ON 57
ci_59                -1.310514e-03 3 1  ON 58
ci_60                 1.018925e-03 3 1  ON 59
ci_61                 2.832612e-03 3 1  ON 60
ci_62                -2.248759e-04 3 1  ON 61
ci_63                -7.664223e-04 3 1  ON 62
ci_64                -5.400990e-05 3 1  ON 63
ci_65                -5.908669e-04 3 1  ON 64
ci_66                -7.416027e-04 3 1  ON 65
ci_67                -5.219406e-04 3 1  ON 66
ci_68                -1.183081e-03 3 1  ON 67
ci_69                -1.745459e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.822
    reference variance = 0.367346
====================================================
  Execution time = 1.0140e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0140e-01
  Total weights = 7.8565e+06
  Execution time = 1.4366e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00198787
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518430842765
                                         uncertainty =       0.033116506484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518430842765
                                         uncertainty =       0.033116506484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000254559549
  error estimate for blocks of size 2^( 2) =       0.000263515906
  error estimate for blocks of size 2^( 3) =       0.000271450924
  error estimate for blocks of size 2^( 4) =       0.000276954689
  error estimate for blocks of size 2^( 5) =       0.000280441005
  error estimate for blocks of size 2^( 6) =       0.000281791112
  error estimate for blocks of size 2^( 7) =       0.000282164632
  error estimate for blocks of size 2^( 8) =       0.000283107274
  error estimate for blocks of size 2^( 9) =       0.000283489799

      target function =                  N/A
              le_mean =     -22.824536970221
             les_mean =     624.035408360492
             stat err =       0.000282638204
             autocorr =       1.232772517719
              std dev =       0.720003134143
             le_variance =       0.518404513176

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.152602
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484970295088
                                         uncertainty =       0.001318256477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484970295088
                                         uncertainty =       0.001318256477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246215000
  error estimate for blocks of size 2^( 2) =       0.000255468170
  error estimate for blocks of size 2^( 3) =       0.000263626203
  error estimate for blocks of size 2^( 4) =       0.000269328015
  error estimate for blocks of size 2^( 5) =       0.000272864543
  error estimate for blocks of size 2^( 6) =       0.000274137469
  error estimate for blocks of size 2^( 7) =       0.000274558572
  error estimate for blocks of size 2^( 8) =       0.000275475769
  error estimate for blocks of size 2^( 9) =       0.000275627726

      target function =                  N/A
              le_mean =     -22.824465048226
             les_mean =     521.463262044495
             stat err =       0.000274949884
             autocorr =       1.247033347182
              std dev =       0.696401183230
             le_variance =       0.484974608004

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00200366
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485071546912
                                         uncertainty =       0.001319044972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485071546912
                                         uncertainty =       0.001319044972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246240699
  error estimate for blocks of size 2^( 2) =       0.000255495526
  error estimate for blocks of size 2^( 3) =       0.000263654196
  error estimate for blocks of size 2^( 4) =       0.000269355986
  error estimate for blocks of size 2^( 5) =       0.000272890039
  error estimate for blocks of size 2^( 6) =       0.000274160218
  error estimate for blocks of size 2^( 7) =       0.000274575701
  error estimate for blocks of size 2^( 8) =       0.000275502430
  error estimate for blocks of size 2^( 9) =       0.000275656594

      target function =                  N/A
              le_mean =     -22.824470047813
             les_mean =     521.465435508775
             stat err =       0.000274973736
             autocorr =       1.246989390726
              std dev =       0.696473871332
             le_variance =       0.485075853449

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0282382
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484991664498
                                         uncertainty =       0.001319500333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484991664498
                                         uncertainty =       0.001319500333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246220430
  error estimate for blocks of size 2^( 2) =       0.000255471756
  error estimate for blocks of size 2^( 3) =       0.000263629118
  error estimate for blocks of size 2^( 4) =       0.000269331754
  error estimate for blocks of size 2^( 5) =       0.000272870021
  error estimate for blocks of size 2^( 6) =       0.000274146474
  error estimate for blocks of size 2^( 7) =       0.000274567256
  error estimate for blocks of size 2^( 8) =       0.000275465383
  error estimate for blocks of size 2^( 9) =       0.000275606100

      target function =                  N/A
              le_mean =     -22.824465485591
             les_mean =     521.477687029290
             stat err =       0.000274946303
             autocorr =       1.246945864601
              std dev =       0.696416542688
             le_variance =       0.484996000930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824536970221        initial  <--
     2.4414e-02     2.4414e-01             1.0884e-03       -22.824465048226
     9.7656e-02     9.7656e-01             7.7676e-04       -22.824470047813
     3.9062e-01     3.9062e+00             3.6549e-04       -22.824465485591

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.5742
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.084345e-01 3 1  ON 0
ci_02                -2.180002e-02 3 1  ON 1
ci_03                -2.218941e-02 3 1  ON 2
ci_04                 2.219978e-02 3 1  ON 3
ci_05                -2.175036e-02 3 1  ON 4
ci_06                -2.131335e-02 3 1  ON 5
ci_07                 2.624111e-02 3 1  ON 6
ci_08                -3.558389e-03 3 1  ON 7
ci_09                -1.044415e-02 3 1  ON 8
ci_10                -1.137522e-02 3 1  ON 9
ci_11                 1.667595e-02 3 1  ON 10
ci_12                 1.106756e-02 3 1  ON 11
ci_13                 1.209989e-02 3 1  ON 12
ci_14                 1.652325e-02 3 1  ON 13
ci_15                 7.693426e-03 3 1  ON 14
ci_16                 7.206446e-03 3 1  ON 15
ci_17                -8.897844e-03 3 1  ON 16
ci_18                -9.062864e-03 3 1  ON 17
ci_19                 1.021591e-02 3 1  ON 18
ci_20                 1.095424e-02 3 1  ON 19
ci_21                 8.043458e-03 3 1  ON 20
ci_22                 8.690298e-03 3 1  ON 21
ci_23                 6.448961e-03 3 1  ON 22
ci_24                 7.770236e-03 3 1  ON 23
ci_25                 5.095449e-03 3 1  ON 24
ci_26                 2.645525e-03 3 1  ON 25
ci_27                 3.948512e-03 3 1  ON 26
ci_28                 3.094924e-03 3 1  ON 27
ci_29                 2.621908e-03 3 1  ON 28
ci_30                 1.189671e-03 3 1  ON 29
ci_31                 7.663326e-04 3 1  ON 30
ci_32                 7.607659e-04 3 1  ON 31
ci_33                 9.287320e-05 3 1  ON 32
ci_34                -3.101410e-04 3 1  ON 33
ci_35                -9.681738e-05 3 1  ON 34
ci_36                -1.763683e-04 3 1  ON 35
ci_37                -7.915729e-04 3 1  ON 36
ci_38                -5.017917e-04 3 1  ON 37
ci_39                -9.148703e-06 3 1  ON 38
ci_40                -1.493058e-03 3 1  ON 39
ci_41                -7.613686e-05 3 1  ON 40
ci_42                 4.749975e-05 3 1  ON 41
ci_43                -2.755539e-03 3 1  ON 42
ci_44                -2.027351e-03 3 1  ON 43
ci_45                -2.158961e-04 3 1  ON 44
ci_46                -4.846225e-04 3 1  ON 45
ci_47                -3.905629e-04 3 1  ON 46
ci_48                 7.710022e-04 3 1  ON 47
ci_49                -1.204885e-03 3 1  ON 48
ci_50                -6.992788e-04 3 1  ON 49
ci_51                -4.446787e-04 3 1  ON 50
ci_52                 2.229209e-05 3 1  ON 51
ci_53                -1.119914e-03 3 1  ON 52
ci_54                -8.188325e-04 3 1  ON 53
ci_55                -7.137453e-04 3 1  ON 54
ci_56                 1.890710e-03 3 1  ON 55
ci_57                 1.359631e-03 3 1  ON 56
ci_58                -1.713870e-03 3 1  ON 57
ci_59                -1.494778e-03 3 1  ON 58
ci_60                 1.211129e-03 3 1  ON 59
ci_61                 3.021462e-03 3 1  ON 60
ci_62                -4.035453e-04 3 1  ON 61
ci_63                -5.361302e-04 3 1  ON 62
ci_64                -6.629704e-04 3 1  ON 63
ci_65                -1.024656e-03 3 1  ON 64
ci_66                -5.403160e-04 3 1  ON 65
ci_67                -5.247113e-04 3 1  ON 66
ci_68                -1.299418e-03 3 1  ON 67
ci_69                -1.380371e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9209e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8534
    reference variance = 0.449031
====================================================
  Execution time = 1.0003e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1390e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0253e-01
  Total weights = 7.857020515e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8542e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486304753842
                                         uncertainty =       0.001391469125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486304753842
                                         uncertainty =       0.001391469125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246552866
  error estimate for blocks of size 2^( 2) =       0.000255650012
  error estimate for blocks of size 2^( 3) =       0.000263868402
  error estimate for blocks of size 2^( 4) =       0.000269683785
  error estimate for blocks of size 2^( 5) =       0.000273037999
  error estimate for blocks of size 2^( 6) =       0.000274720320
  error estimate for blocks of size 2^( 7) =       0.000275249144
  error estimate for blocks of size 2^( 8) =       0.000275916977
  error estimate for blocks of size 2^( 9) =       0.000276368148

      target function =                  N/A
              le_mean =     -22.824948339123
             les_mean =     521.480792968073
             stat err =       0.000275563647
             autocorr =       1.249176308742
              std dev =       0.697356813567
             le_variance =       0.486306525428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282494833912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824948339120       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824952975554       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824953728173       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824953695487       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 4.701763e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824948339120       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824950116306       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824950319642       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824950304037       residual = 6.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.835437e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824948339120       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824948851755       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824948901712       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824948897291       residual = 6.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 5.496791e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1859e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.084164e-01 3 1  ON 0
ci_02                -2.186377e-02 3 1  ON 1
ci_03                -2.227900e-02 3 1  ON 2
ci_04                 2.201907e-02 3 1  ON 3
ci_05                -2.172025e-02 3 1  ON 4
ci_06                -2.136427e-02 3 1  ON 5
ci_07                 2.613051e-02 3 1  ON 6
ci_08                -3.510304e-03 3 1  ON 7
ci_09                -1.041602e-02 3 1  ON 8
ci_10                -1.122073e-02 3 1  ON 9
ci_11                 1.664670e-02 3 1  ON 10
ci_12                 1.103773e-02 3 1  ON 11
ci_13                 1.219246e-02 3 1  ON 12
ci_14                 1.650817e-02 3 1  ON 13
ci_15                 7.638268e-03 3 1  ON 14
ci_16                 7.197914e-03 3 1  ON 15
ci_17                -8.853568e-03 3 1  ON 16
ci_18                -8.979692e-03 3 1  ON 17
ci_19                 1.003237e-02 3 1  ON 18
ci_20                 1.101896e-02 3 1  ON 19
ci_21                 7.954733e-03 3 1  ON 20
ci_22                 8.569082e-03 3 1  ON 21
ci_23                 6.500488e-03 3 1  ON 22
ci_24                 7.722414e-03 3 1  ON 23
ci_25                 5.137665e-03 3 1  ON 24
ci_26                 2.633315e-03 3 1  ON 25
ci_27                 3.896578e-03 3 1  ON 26
ci_28                 3.038102e-03 3 1  ON 27
ci_29                 2.702194e-03 3 1  ON 28
ci_30                 1.040765e-03 3 1  ON 29
ci_31                 6.921080e-04 3 1  ON 30
ci_32                 7.424781e-04 3 1  ON 31
ci_33                 5.662038e-05 3 1  ON 32
ci_34                -2.030797e-04 3 1  ON 33
ci_35                -1.113183e-04 3 1  ON 34
ci_36                -2.605101e-04 3 1  ON 35
ci_37                -8.172688e-04 3 1  ON 36
ci_38                -4.567307e-04 3 1  ON 37
ci_39                -4.777196e-05 3 1  ON 38
ci_40                -1.415743e-03 3 1  ON 39
ci_41                 1.630703e-05 3 1  ON 40
ci_42                -7.363914e-05 3 1  ON 41
ci_43                -2.746253e-03 3 1  ON 42
ci_44                -2.037803e-03 3 1  ON 43
ci_45                -1.607680e-04 3 1  ON 44
ci_46                -4.698937e-04 3 1  ON 45
ci_47                -2.881690e-04 3 1  ON 46
ci_48                 8.098538e-04 3 1  ON 47
ci_49                -1.171983e-03 3 1  ON 48
ci_50                -5.963092e-04 3 1  ON 49
ci_51                -4.391733e-04 3 1  ON 50
ci_52                 4.548522e-05 3 1  ON 51
ci_53                -1.111907e-03 3 1  ON 52
ci_54                -7.362450e-04 3 1  ON 53
ci_55                -7.865344e-04 3 1  ON 54
ci_56                 1.857536e-03 3 1  ON 55
ci_57                 1.318941e-03 3 1  ON 56
ci_58                -1.632599e-03 3 1  ON 57
ci_59                -1.388143e-03 3 1  ON 58
ci_60                 1.252015e-03 3 1  ON 59
ci_61                 2.981441e-03 3 1  ON 60
ci_62                -3.578358e-04 3 1  ON 61
ci_63                -3.870409e-04 3 1  ON 62
ci_64                -6.140570e-04 3 1  ON 63
ci_65                -9.856412e-04 3 1  ON 64
ci_66                -4.270693e-04 3 1  ON 65
ci_67                -3.509233e-04 3 1  ON 66
ci_68                -1.318381e-03 3 1  ON 67
ci_69                -1.426423e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.733
    reference variance = 0.503213
====================================================
  Execution time = 1.0086e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0609e-01
  Total weights = 7.8567e+06
  Execution time = 1.4378e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00475205
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487625931922
                                         uncertainty =       0.001368539914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487625931922
                                         uncertainty =       0.001368539914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246886905
  error estimate for blocks of size 2^( 2) =       0.000255991404
  error estimate for blocks of size 2^( 3) =       0.000264245103
  error estimate for blocks of size 2^( 4) =       0.000270017920
  error estimate for blocks of size 2^( 5) =       0.000273450276
  error estimate for blocks of size 2^( 6) =       0.000275296284
  error estimate for blocks of size 2^( 7) =       0.000276480252
  error estimate for blocks of size 2^( 8) =       0.000276087673
  error estimate for blocks of size 2^( 9) =       0.000276552903

      target function =                  N/A
              le_mean =     -22.824884378724
             les_mean =     521.519720334036
             stat err =       0.000276104278
             autocorr =       1.250691387489
              std dev =       0.698301620217
             le_variance =       0.487625152798

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000796816
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487485865176
                                         uncertainty =       0.001348664193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487485865176
                                         uncertainty =       0.001348664193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246851467
  error estimate for blocks of size 2^( 2) =       0.000255957926
  error estimate for blocks of size 2^( 3) =       0.000264214735
  error estimate for blocks of size 2^( 4) =       0.000269987432
  error estimate for blocks of size 2^( 5) =       0.000273421063
  error estimate for blocks of size 2^( 6) =       0.000275263247
  error estimate for blocks of size 2^( 7) =       0.000276452284
  error estimate for blocks of size 2^( 8) =       0.000276065646
  error estimate for blocks of size 2^( 9) =       0.000276534457

      target function =                  N/A
              le_mean =     -22.824884407766
             les_mean =     521.489997059130
             stat err =       0.000276078908
             autocorr =       1.250820626146
              std dev =       0.698201384173
             le_variance =       0.487485172861

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00469734
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487493228732
                                         uncertainty =       0.001351253239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487493228732
                                         uncertainty =       0.001351253239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246853326
  error estimate for blocks of size 2^( 2) =       0.000255959885
  error estimate for blocks of size 2^( 3) =       0.000264216147
  error estimate for blocks of size 2^( 4) =       0.000269988421
  error estimate for blocks of size 2^( 5) =       0.000273422055
  error estimate for blocks of size 2^( 6) =       0.000275265064
  error estimate for blocks of size 2^( 7) =       0.000276452163
  error estimate for blocks of size 2^( 8) =       0.000276066636
  error estimate for blocks of size 2^( 9) =       0.000276536977

      target function =                  N/A
              le_mean =     -22.824883361592
             les_mean =     521.482437125398
             stat err =       0.000276080210
             autocorr =       1.250813572201
              std dev =       0.698206643880
             le_variance =       0.487492517559

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0171491
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487596866799
                                         uncertainty =       0.001364688840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487596866799
                                         uncertainty =       0.001364688840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246879551
  error estimate for blocks of size 2^( 2) =       0.000255984464
  error estimate for blocks of size 2^( 3) =       0.000264238900
  error estimate for blocks of size 2^( 4) =       0.000270011561
  error estimate for blocks of size 2^( 5) =       0.000273444400
  error estimate for blocks of size 2^( 6) =       0.000275289830
  error estimate for blocks of size 2^( 7) =       0.000276474707
  error estimate for blocks of size 2^( 8) =       0.000276082495
  error estimate for blocks of size 2^( 9) =       0.000276550721

      target function =                  N/A
              le_mean =     -22.824883390588
             les_mean =     521.482450655899
             stat err =       0.000276099438
             autocorr =       1.250722059893
              std dev =       0.698280817892
             le_variance =       0.487596100636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824884378724        initial
     2.4414e-01     2.4414e+00             4.7018e-04       -22.824884407766  <--
     9.7656e-01     9.7656e+00             1.8354e-04       -22.824883361592
     3.9062e+00     3.9062e+01             5.4968e-05       -22.824883390588

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7333e+02
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.083577e-01 3 1  ON 0
ci_02                -2.199386e-02 3 1  ON 1
ci_03                -2.244085e-02 3 1  ON 2
ci_04                 2.172961e-02 3 1  ON 3
ci_05                -2.165618e-02 3 1  ON 4
ci_06                -2.145212e-02 3 1  ON 5
ci_07                 2.591041e-02 3 1  ON 6
ci_08                -3.446743e-03 3 1  ON 7
ci_09                -1.036905e-02 3 1  ON 8
ci_10                -1.091749e-02 3 1  ON 9
ci_11                 1.657758e-02 3 1  ON 10
ci_12                 1.099879e-02 3 1  ON 11
ci_13                 1.232698e-02 3 1  ON 12
ci_14                 1.647285e-02 3 1  ON 13
ci_15                 7.544879e-03 3 1  ON 14
ci_16                 7.200736e-03 3 1  ON 15
ci_17                -8.766700e-03 3 1  ON 16
ci_18                -8.837870e-03 3 1  ON 17
ci_19                 9.772534e-03 3 1  ON 18
ci_20                 1.114077e-02 3 1  ON 19
ci_21                 7.809962e-03 3 1  ON 20
ci_22                 8.344437e-03 3 1  ON 21
ci_23                 6.576410e-03 3 1  ON 22
ci_24                 7.629815e-03 3 1  ON 23
ci_25                 5.208478e-03 3 1  ON 24
ci_26                 2.621886e-03 3 1  ON 25
ci_27                 3.804187e-03 3 1  ON 26
ci_28                 2.935309e-03 3 1  ON 27
ci_29                 2.841326e-03 3 1  ON 28
ci_30                 7.611265e-04 3 1  ON 29
ci_31                 5.774211e-04 3 1  ON 30
ci_32                 6.980702e-04 3 1  ON 31
ci_33                -5.770099e-06 3 1  ON 32
ci_34                -1.861962e-05 3 1  ON 33
ci_35                -1.414558e-04 3 1  ON 34
ci_36                -3.769818e-04 3 1  ON 35
ci_37                -8.484214e-04 3 1  ON 36
ci_38                -3.772176e-04 3 1  ON 37
ci_39                -9.648609e-05 3 1  ON 38
ci_40                -1.322268e-03 3 1  ON 39
ci_41                 1.511961e-04 3 1  ON 40
ci_42                -2.630298e-04 3 1  ON 41
ci_43                -2.729637e-03 3 1  ON 42
ci_44                -2.065164e-03 3 1  ON 43
ci_45                -8.421048e-05 3 1  ON 44
ci_46                -4.490457e-04 3 1  ON 45
ci_47                -9.537135e-05 3 1  ON 46
ci_48                 8.658014e-04 3 1  ON 47
ci_49                -1.129171e-03 3 1  ON 48
ci_50                -4.721982e-04 3 1  ON 49
ci_51                -4.331919e-04 3 1  ON 50
ci_52                 7.653870e-05 3 1  ON 51
ci_53                -1.100214e-03 3 1  ON 52
ci_54                -5.870678e-04 3 1  ON 53
ci_55                -9.145509e-04 3 1  ON 54
ci_56                 1.817871e-03 3 1  ON 55
ci_57                 1.259315e-03 3 1  ON 56
ci_58                -1.492360e-03 3 1  ON 57
ci_59                -1.202670e-03 3 1  ON 58
ci_60                 1.351118e-03 3 1  ON 59
ci_61                 2.887925e-03 3 1  ON 60
ci_62                -2.994507e-04 3 1  ON 61
ci_63                -1.939898e-04 3 1  ON 62
ci_64                -5.418130e-04 3 1  ON 63
ci_65                -9.341796e-04 3 1  ON 64
ci_66                -2.661729e-04 3 1  ON 65
ci_67                -9.786642e-05 3 1  ON 66
ci_68                -1.345909e-03 3 1  ON 67
ci_69                -1.508254e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9193e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8087
    reference variance = 0.477943
====================================================
  Execution time = 1.0031e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1401e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0132e-01
  Total weights = 7.856770762e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8510e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485863283796
                                         uncertainty =       0.001380725052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485863283796
                                         uncertainty =       0.001380725052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246441379
  error estimate for blocks of size 2^( 2) =       0.000255617830
  error estimate for blocks of size 2^( 3) =       0.000263772189
  error estimate for blocks of size 2^( 4) =       0.000269607530
  error estimate for blocks of size 2^( 5) =       0.000273239673
  error estimate for blocks of size 2^( 6) =       0.000274867627
  error estimate for blocks of size 2^( 7) =       0.000276086395
  error estimate for blocks of size 2^( 8) =       0.000277649640
  error estimate for blocks of size 2^( 9) =       0.000277321690

      target function =                  N/A
              le_mean =     -22.824456335508
             les_mean =     521.457127487453
             stat err =       0.000276481338
             autocorr =       1.258648268382
              std dev =       0.697041482239
             le_variance =       0.485866827963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282445633551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824456335502       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824459719865       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824460214762       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824460328506       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824460325257       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 1.090612e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824456335502       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824458331771       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824458442345       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824458439818       residual = 7.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 6.017116e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824456335502       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824457091493       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824457092433       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824457081855       residual = 3.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 2.155214e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1884e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.085118e-01 3 1  ON 0
ci_02                -2.198377e-02 3 1  ON 1
ci_03                -2.244898e-02 3 1  ON 2
ci_04                 2.168298e-02 3 1  ON 3
ci_05                -2.160437e-02 3 1  ON 4
ci_06                -2.145645e-02 3 1  ON 5
ci_07                 2.594857e-02 3 1  ON 6
ci_08                -3.433184e-03 3 1  ON 7
ci_09                -1.038922e-02 3 1  ON 8
ci_10                -1.110496e-02 3 1  ON 9
ci_11                 1.636284e-02 3 1  ON 10
ci_12                 1.112894e-02 3 1  ON 11
ci_13                 1.218543e-02 3 1  ON 12
ci_14                 1.642729e-02 3 1  ON 13
ci_15                 7.498224e-03 3 1  ON 14
ci_16                 7.329897e-03 3 1  ON 15
ci_17                -8.668675e-03 3 1  ON 16
ci_18                -8.824923e-03 3 1  ON 17
ci_19                 9.587720e-03 3 1  ON 18
ci_20                 1.091961e-02 3 1  ON 19
ci_21                 8.051337e-03 3 1  ON 20
ci_22                 8.447795e-03 3 1  ON 21
ci_23                 6.611887e-03 3 1  ON 22
ci_24                 7.753821e-03 3 1  ON 23
ci_25                 5.159260e-03 3 1  ON 24
ci_26                 2.718608e-03 3 1  ON 25
ci_27                 3.202475e-03 3 1  ON 26
ci_28                 2.748313e-03 3 1  ON 27
ci_29                 2.682150e-03 3 1  ON 28
ci_30                 7.027301e-04 3 1  ON 29
ci_31                 9.525200e-04 3 1  ON 30
ci_32                 5.504490e-04 3 1  ON 31
ci_33                -1.608712e-04 3 1  ON 32
ci_34                -1.072950e-04 3 1  ON 33
ci_35                 6.109551e-05 3 1  ON 34
ci_36                -5.524200e-04 3 1  ON 35
ci_37                -4.591152e-04 3 1  ON 36
ci_38                -5.698888e-05 3 1  ON 37
ci_39                -2.200068e-05 3 1  ON 38
ci_40                -1.392630e-03 3 1  ON 39
ci_41                 3.356783e-05 3 1  ON 40
ci_42                -3.102201e-04 3 1  ON 41
ci_43                -2.611497e-03 3 1  ON 42
ci_44                -2.303301e-03 3 1  ON 43
ci_45                -7.419913e-05 3 1  ON 44
ci_46                -4.127137e-04 3 1  ON 45
ci_47                 2.133952e-04 3 1  ON 46
ci_48                 7.041303e-04 3 1  ON 47
ci_49                -1.310305e-03 3 1  ON 48
ci_50                -3.816836e-04 3 1  ON 49
ci_51                -2.603727e-04 3 1  ON 50
ci_52                -6.537396e-05 3 1  ON 51
ci_53                -9.882628e-04 3 1  ON 52
ci_54                -4.258493e-04 3 1  ON 53
ci_55                -7.613968e-04 3 1  ON 54
ci_56                 1.423661e-03 3 1  ON 55
ci_57                 1.386418e-03 3 1  ON 56
ci_58                -1.552552e-03 3 1  ON 57
ci_59                -1.240601e-03 3 1  ON 58
ci_60                 1.434889e-03 3 1  ON 59
ci_61                 2.626319e-03 3 1  ON 60
ci_62                -2.742345e-04 3 1  ON 61
ci_63                -2.128429e-04 3 1  ON 62
ci_64                -6.331987e-04 3 1  ON 63
ci_65                -7.005609e-04 3 1  ON 64
ci_66                -2.515652e-04 3 1  ON 65
ci_67                -3.910074e-04 3 1  ON 66
ci_68                -1.411558e-03 3 1  ON 67
ci_69                -1.765421e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8028
    reference variance = 1.00698
====================================================
  Execution time = 1.0062e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0425e-01
  Total weights = 7.8566e+06
  Execution time = 1.4381e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00150817
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487382471937
                                         uncertainty =       0.001272208339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487382471937
                                         uncertainty =       0.001272208339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246825924
  error estimate for blocks of size 2^( 2) =       0.000255976343
  error estimate for blocks of size 2^( 3) =       0.000264310456
  error estimate for blocks of size 2^( 4) =       0.000270033377
  error estimate for blocks of size 2^( 5) =       0.000273425247
  error estimate for blocks of size 2^( 6) =       0.000275594241
  error estimate for blocks of size 2^( 7) =       0.000276411637
  error estimate for blocks of size 2^( 8) =       0.000276977714
  error estimate for blocks of size 2^( 9) =       0.000276509489

      target function =                  N/A
              le_mean =     -22.824470938788
             les_mean =     521.482138167610
             stat err =       0.000276373270
             autocorr =       1.253748802969
              std dev =       0.698129139501
             le_variance =       0.487384295420

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00626551
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487370308546
                                         uncertainty =       0.001271334085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487370308546
                                         uncertainty =       0.001271334085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246822823
  error estimate for blocks of size 2^( 2) =       0.000255973457
  error estimate for blocks of size 2^( 3) =       0.000264307620
  error estimate for blocks of size 2^( 4) =       0.000270025250
  error estimate for blocks of size 2^( 5) =       0.000273414591
  error estimate for blocks of size 2^( 6) =       0.000275584934
  error estimate for blocks of size 2^( 7) =       0.000276401422
  error estimate for blocks of size 2^( 8) =       0.000276953094
  error estimate for blocks of size 2^( 9) =       0.000276493796

      target function =                  N/A
              le_mean =     -22.824469658661
             les_mean =     521.461671194776
             stat err =       0.000276358312
             autocorr =       1.253644590435
              std dev =       0.698120367458
             le_variance =       0.487372047460

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00149715
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487389628007
                                         uncertainty =       0.001270968244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487389628007
                                         uncertainty =       0.001270968244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246827714
  error estimate for blocks of size 2^( 2) =       0.000255978419
  error estimate for blocks of size 2^( 3) =       0.000264312820
  error estimate for blocks of size 2^( 4) =       0.000270029972
  error estimate for blocks of size 2^( 5) =       0.000273419581
  error estimate for blocks of size 2^( 6) =       0.000275590019
  error estimate for blocks of size 2^( 7) =       0.000276406926
  error estimate for blocks of size 2^( 8) =       0.000276959248
  error estimate for blocks of size 2^( 9) =       0.000276499393

      target function =                  N/A
              le_mean =     -22.824472619099
             les_mean =     521.464015528768
             stat err =       0.000276363896
             autocorr =       1.253645571696
              std dev =       0.698134202476
             le_variance =       0.487391364667

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00949047
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487341456996
                                         uncertainty =       0.001272285321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487341456996
                                         uncertainty =       0.001272285321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246815525
  error estimate for blocks of size 2^( 2) =       0.000255966361
  error estimate for blocks of size 2^( 3) =       0.000264301278
  error estimate for blocks of size 2^( 4) =       0.000270023596
  error estimate for blocks of size 2^( 5) =       0.000273413563
  error estimate for blocks of size 2^( 6) =       0.000275585023
  error estimate for blocks of size 2^( 7) =       0.000276402515
  error estimate for blocks of size 2^( 8) =       0.000276958607
  error estimate for blocks of size 2^( 9) =       0.000276488496

      target function =                  N/A
              le_mean =     -22.824466487919
             les_mean =     521.465215646635
             stat err =       0.000276358660
             autocorr =       1.253721894329
              std dev =       0.698099724887
             le_variance =       0.487343225887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824470938788        initial
     6.1035e-02     6.1035e-01             1.0906e-03       -22.824469658661
     2.4414e-01     2.4414e+00             6.0171e-04       -22.824472619099  <--
     9.7656e-01     9.7656e+00             2.1552e-04       -22.824466487919

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7282e+02
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.085118e-01 3 1  ON 0
ci_02                -2.198377e-02 3 1  ON 1
ci_03                -2.244898e-02 3 1  ON 2
ci_04                 2.168298e-02 3 1  ON 3
ci_05                -2.160437e-02 3 1  ON 4
ci_06                -2.145645e-02 3 1  ON 5
ci_07                 2.594857e-02 3 1  ON 6
ci_08                -3.433184e-03 3 1  ON 7
ci_09                -1.038922e-02 3 1  ON 8
ci_10                -1.110496e-02 3 1  ON 9
ci_11                 1.636284e-02 3 1  ON 10
ci_12                 1.112894e-02 3 1  ON 11
ci_13                 1.218543e-02 3 1  ON 12
ci_14                 1.642729e-02 3 1  ON 13
ci_15                 7.498224e-03 3 1  ON 14
ci_16                 7.329897e-03 3 1  ON 15
ci_17                -8.668675e-03 3 1  ON 16
ci_18                -8.824923e-03 3 1  ON 17
ci_19                 9.587720e-03 3 1  ON 18
ci_20                 1.091961e-02 3 1  ON 19
ci_21                 8.051337e-03 3 1  ON 20
ci_22                 8.447795e-03 3 1  ON 21
ci_23                 6.611887e-03 3 1  ON 22
ci_24                 7.753821e-03 3 1  ON 23
ci_25                 5.159260e-03 3 1  ON 24
ci_26                 2.718608e-03 3 1  ON 25
ci_27                 3.202475e-03 3 1  ON 26
ci_28                 2.748313e-03 3 1  ON 27
ci_29                 2.682150e-03 3 1  ON 28
ci_30                 7.027301e-04 3 1  ON 29
ci_31                 9.525200e-04 3 1  ON 30
ci_32                 5.504490e-04 3 1  ON 31
ci_33                -1.608712e-04 3 1  ON 32
ci_34                -1.072950e-04 3 1  ON 33
ci_35                 6.109551e-05 3 1  ON 34
ci_36                -5.524200e-04 3 1  ON 35
ci_37                -4.591152e-04 3 1  ON 36
ci_38                -5.698888e-05 3 1  ON 37
ci_39                -2.200068e-05 3 1  ON 38
ci_40                -1.392630e-03 3 1  ON 39
ci_41                 3.356783e-05 3 1  ON 40
ci_42                -3.102201e-04 3 1  ON 41
ci_43                -2.611497e-03 3 1  ON 42
ci_44                -2.303301e-03 3 1  ON 43
ci_45                -7.419913e-05 3 1  ON 44
ci_46                -4.127137e-04 3 1  ON 45
ci_47                 2.133952e-04 3 1  ON 46
ci_48                 7.041303e-04 3 1  ON 47
ci_49                -1.310305e-03 3 1  ON 48
ci_50                -3.816836e-04 3 1  ON 49
ci_51                -2.603727e-04 3 1  ON 50
ci_52                -6.537396e-05 3 1  ON 51
ci_53                -9.882628e-04 3 1  ON 52
ci_54                -4.258493e-04 3 1  ON 53
ci_55                -7.613968e-04 3 1  ON 54
ci_56                 1.423661e-03 3 1  ON 55
ci_57                 1.386418e-03 3 1  ON 56
ci_58                -1.552552e-03 3 1  ON 57
ci_59                -1.240601e-03 3 1  ON 58
ci_60                 1.434889e-03 3 1  ON 59
ci_61                 2.626319e-03 3 1  ON 60
ci_62                -2.742345e-04 3 1  ON 61
ci_63                -2.128429e-04 3 1  ON 62
ci_64                -6.331987e-04 3 1  ON 63
ci_65                -7.005609e-04 3 1  ON 64
ci_66                -2.515652e-04 3 1  ON 65
ci_67                -3.910074e-04 3 1  ON 66
ci_68                -1.411558e-03 3 1  ON 67
ci_69                -1.765421e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9168e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8632
    reference variance = 0.314993
====================================================
  Execution time = 1.0015e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1306e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0291e-01
  Total weights = 7.857065844e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8473e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486383437041
                                         uncertainty =       0.001296475173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486383437041
                                         uncertainty =       0.001296475173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246572381
  error estimate for blocks of size 2^( 2) =       0.000255780111
  error estimate for blocks of size 2^( 3) =       0.000264059728
  error estimate for blocks of size 2^( 4) =       0.000269902098
  error estimate for blocks of size 2^( 5) =       0.000273590070
  error estimate for blocks of size 2^( 6) =       0.000275083612
  error estimate for blocks of size 2^( 7) =       0.000275675631
  error estimate for blocks of size 2^( 8) =       0.000276586250
  error estimate for blocks of size 2^( 9) =       0.000277510728

      target function =                  N/A
              le_mean =     -22.825373077037
             les_mean =     521.500565542293
             stat err =       0.000276214055
             autocorr =       1.254881424581
              std dev =       0.697412009789
             le_variance =       0.486383511397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282537307704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825373077033       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825378406932       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825378295486       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825378294041       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825378351667       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 8.864559e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825373077033       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825376110667       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825376098159       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825376073919       residual = 7.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 4.525454e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825373077033       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825374190984       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825374225963       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825374215857       residual = 3.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.564023e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1865e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.082463e-01 3 1  ON 0
ci_02                -2.207722e-02 3 1  ON 1
ci_03                -2.245766e-02 3 1  ON 2
ci_04                 2.181024e-02 3 1  ON 3
ci_05                -2.137009e-02 3 1  ON 4
ci_06                -2.144872e-02 3 1  ON 5
ci_07                 2.640111e-02 3 1  ON 6
ci_08                -3.477420e-03 3 1  ON 7
ci_09                -1.062657e-02 3 1  ON 8
ci_10                -1.086170e-02 3 1  ON 9
ci_11                 1.625452e-02 3 1  ON 10
ci_12                 1.076729e-02 3 1  ON 11
ci_13                 1.230311e-02 3 1  ON 12
ci_14                 1.651374e-02 3 1  ON 13
ci_15                 7.806898e-03 3 1  ON 14
ci_16                 7.335677e-03 3 1  ON 15
ci_17                -9.000677e-03 3 1  ON 16
ci_18                -8.832795e-03 3 1  ON 17
ci_19                 9.664580e-03 3 1  ON 18
ci_20                 1.083949e-02 3 1  ON 19
ci_21                 8.401753e-03 3 1  ON 20
ci_22                 8.412940e-03 3 1  ON 21
ci_23                 6.555560e-03 3 1  ON 22
ci_24                 7.637041e-03 3 1  ON 23
ci_25                 5.320257e-03 3 1  ON 24
ci_26                 2.515521e-03 3 1  ON 25
ci_27                 3.071941e-03 3 1  ON 26
ci_28                 2.875694e-03 3 1  ON 27
ci_29                 2.756155e-03 3 1  ON 28
ci_30                 7.048243e-04 3 1  ON 29
ci_31                 5.861731e-04 3 1  ON 30
ci_32                 5.645106e-04 3 1  ON 31
ci_33                -1.702273e-04 3 1  ON 32
ci_34                -4.297498e-04 3 1  ON 33
ci_35                -9.546406e-05 3 1  ON 34
ci_36                -2.249240e-04 3 1  ON 35
ci_37                -5.173092e-04 3 1  ON 36
ci_38                 1.575016e-05 3 1  ON 37
ci_39                -2.486112e-04 3 1  ON 38
ci_40                -1.308089e-03 3 1  ON 39
ci_41                -1.352765e-04 3 1  ON 40
ci_42                -1.979613e-04 3 1  ON 41
ci_43                -2.301998e-03 3 1  ON 42
ci_44                -2.002653e-03 3 1  ON 43
ci_45                -6.137739e-05 3 1  ON 44
ci_46                -1.425643e-04 3 1  ON 45
ci_47                 1.424930e-04 3 1  ON 46
ci_48                 3.266250e-04 3 1  ON 47
ci_49                -1.049507e-03 3 1  ON 48
ci_50                -3.012745e-04 3 1  ON 49
ci_51                -4.661071e-04 3 1  ON 50
ci_52                 5.125195e-05 3 1  ON 51
ci_53                -9.839658e-04 3 1  ON 52
ci_54                -6.853689e-04 3 1  ON 53
ci_55                -7.101926e-04 3 1  ON 54
ci_56                 1.395395e-03 3 1  ON 55
ci_57                 1.372401e-03 3 1  ON 56
ci_58                -1.402650e-03 3 1  ON 57
ci_59                -1.243717e-03 3 1  ON 58
ci_60                 1.484659e-03 3 1  ON 59
ci_61                 2.272084e-03 3 1  ON 60
ci_62                -3.880550e-04 3 1  ON 61
ci_63                -4.295276e-04 3 1  ON 62
ci_64                -7.431115e-04 3 1  ON 63
ci_65                -7.802299e-04 3 1  ON 64
ci_66                -1.343540e-04 3 1  ON 65
ci_67                -4.939451e-04 3 1  ON 66
ci_68                -1.526369e-03 3 1  ON 67
ci_69                -2.006117e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7862
    reference variance = 0.261744
====================================================
  Execution time = 1.0010e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0076e-01
  Total weights = 7.8571e+06
  Execution time = 1.4361e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486250491606
                                         uncertainty =       0.001520976734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486250491606
                                         uncertainty =       0.001520976734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246538830
  error estimate for blocks of size 2^( 2) =       0.000255770018
  error estimate for blocks of size 2^( 3) =       0.000264134742
  error estimate for blocks of size 2^( 4) =       0.000270090679
  error estimate for blocks of size 2^( 5) =       0.000273200462
  error estimate for blocks of size 2^( 6) =       0.000274911171
  error estimate for blocks of size 2^( 7) =       0.000275921506
  error estimate for blocks of size 2^( 8) =       0.000276271723
  error estimate for blocks of size 2^( 9) =       0.000277156501

      target function =                  N/A
              le_mean =     -22.824251738329
             les_mean =     522.035418783199
             stat err =       0.000276065225
             autocorr =       1.253870674584
              std dev =       0.697317114605
             le_variance =       0.486251158322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485476878810
                                         uncertainty =       0.001348500393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485476878810
                                         uncertainty =       0.001348500393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246342717
  error estimate for blocks of size 2^( 2) =       0.000255582923
  error estimate for blocks of size 2^( 3) =       0.000263958287
  error estimate for blocks of size 2^( 4) =       0.000269915940
  error estimate for blocks of size 2^( 5) =       0.000273048326
  error estimate for blocks of size 2^( 6) =       0.000274757007
  error estimate for blocks of size 2^( 7) =       0.000275740666
  error estimate for blocks of size 2^( 8) =       0.000276067735
  error estimate for blocks of size 2^( 9) =       0.000277017868

      target function =                  N/A
              le_mean =     -22.824259758809
             les_mean =     521.496209173326
             stat err =       0.000275895819
             autocorr =       1.254327037864
              std dev =       0.696762422652
             le_variance =       0.485477873620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485441975766
                                         uncertainty =       0.001353740732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485441975766
                                         uncertainty =       0.001353740732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246333876
  error estimate for blocks of size 2^( 2) =       0.000255575111
  error estimate for blocks of size 2^( 3) =       0.000263950287
  error estimate for blocks of size 2^( 4) =       0.000269910104
  error estimate for blocks of size 2^( 5) =       0.000273035118
  error estimate for blocks of size 2^( 6) =       0.000274746693
  error estimate for blocks of size 2^( 7) =       0.000275728594
  error estimate for blocks of size 2^( 8) =       0.000276062382
  error estimate for blocks of size 2^( 9) =       0.000276996487

      target function =                  N/A
              le_mean =     -22.824263051318
             les_mean =     521.481029004750
             stat err =       0.000275883539
             autocorr =       1.254305413106
              std dev =       0.696737415976
             le_variance =       0.485443026821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485430395320
                                         uncertainty =       0.001353352240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485430395320
                                         uncertainty =       0.001353352240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246330938
  error estimate for blocks of size 2^( 2) =       0.000255571545
  error estimate for blocks of size 2^( 3) =       0.000263947158
  error estimate for blocks of size 2^( 4) =       0.000269905825
  error estimate for blocks of size 2^( 5) =       0.000273030538
  error estimate for blocks of size 2^( 6) =       0.000274740154
  error estimate for blocks of size 2^( 7) =       0.000275732583
  error estimate for blocks of size 2^( 8) =       0.000276069562
  error estimate for blocks of size 2^( 9) =       0.000276991075

      target function =                  N/A
              le_mean =     -22.824260896727
             les_mean =     521.527897007802
             stat err =       0.000275883344
             autocorr =       1.254333558890
              std dev =       0.696729105707
             le_variance =       0.485431446739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824251738329        initial
     6.1035e-02     6.1035e-01             8.8646e-04       -22.824259758809
     2.4414e-01     2.4414e+00             4.5255e-04       -22.824263051318  <--
     9.7656e-01     9.7656e+00             1.5640e-04       -22.824260896727

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7237e+02
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.082463e-01 3 1  ON 0
ci_02                -2.207722e-02 3 1  ON 1
ci_03                -2.245766e-02 3 1  ON 2
ci_04                 2.181024e-02 3 1  ON 3
ci_05                -2.137009e-02 3 1  ON 4
ci_06                -2.144872e-02 3 1  ON 5
ci_07                 2.640111e-02 3 1  ON 6
ci_08                -3.477420e-03 3 1  ON 7
ci_09                -1.062657e-02 3 1  ON 8
ci_10                -1.086170e-02 3 1  ON 9
ci_11                 1.625452e-02 3 1  ON 10
ci_12                 1.076729e-02 3 1  ON 11
ci_13                 1.230311e-02 3 1  ON 12
ci_14                 1.651374e-02 3 1  ON 13
ci_15                 7.806898e-03 3 1  ON 14
ci_16                 7.335677e-03 3 1  ON 15
ci_17                -9.000677e-03 3 1  ON 16
ci_18                -8.832795e-03 3 1  ON 17
ci_19                 9.664580e-03 3 1  ON 18
ci_20                 1.083949e-02 3 1  ON 19
ci_21                 8.401753e-03 3 1  ON 20
ci_22                 8.412940e-03 3 1  ON 21
ci_23                 6.555560e-03 3 1  ON 22
ci_24                 7.637041e-03 3 1  ON 23
ci_25                 5.320257e-03 3 1  ON 24
ci_26                 2.515521e-03 3 1  ON 25
ci_27                 3.071941e-03 3 1  ON 26
ci_28                 2.875694e-03 3 1  ON 27
ci_29                 2.756155e-03 3 1  ON 28
ci_30                 7.048243e-04 3 1  ON 29
ci_31                 5.861731e-04 3 1  ON 30
ci_32                 5.645106e-04 3 1  ON 31
ci_33                -1.702273e-04 3 1  ON 32
ci_34                -4.297498e-04 3 1  ON 33
ci_35                -9.546406e-05 3 1  ON 34
ci_36                -2.249240e-04 3 1  ON 35
ci_37                -5.173092e-04 3 1  ON 36
ci_38                 1.575016e-05 3 1  ON 37
ci_39                -2.486112e-04 3 1  ON 38
ci_40                -1.308089e-03 3 1  ON 39
ci_41                -1.352765e-04 3 1  ON 40
ci_42                -1.979613e-04 3 1  ON 41
ci_43                -2.301998e-03 3 1  ON 42
ci_44                -2.002653e-03 3 1  ON 43
ci_45                -6.137739e-05 3 1  ON 44
ci_46                -1.425643e-04 3 1  ON 45
ci_47                 1.424930e-04 3 1  ON 46
ci_48                 3.266250e-04 3 1  ON 47
ci_49                -1.049507e-03 3 1  ON 48
ci_50                -3.012745e-04 3 1  ON 49
ci_51                -4.661071e-04 3 1  ON 50
ci_52                 5.125195e-05 3 1  ON 51
ci_53                -9.839658e-04 3 1  ON 52
ci_54                -6.853689e-04 3 1  ON 53
ci_55                -7.101926e-04 3 1  ON 54
ci_56                 1.395395e-03 3 1  ON 55
ci_57                 1.372401e-03 3 1  ON 56
ci_58                -1.402650e-03 3 1  ON 57
ci_59                -1.243717e-03 3 1  ON 58
ci_60                 1.484659e-03 3 1  ON 59
ci_61                 2.272084e-03 3 1  ON 60
ci_62                -3.880550e-04 3 1  ON 61
ci_63                -4.295276e-04 3 1  ON 62
ci_64                -7.431115e-04 3 1  ON 63
ci_65                -7.802299e-04 3 1  ON 64
ci_66                -1.343540e-04 3 1  ON 65
ci_67                -4.939451e-04 3 1  ON 66
ci_68                -1.526369e-03 3 1  ON 67
ci_69                -2.006117e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9103e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7865
    reference variance = 0.351224
====================================================
  Execution time = 1.0088e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1327e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0261e-01
  Total weights = 7.856912646e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8519e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485950021731
                                         uncertainty =       0.001236017802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485950021731
                                         uncertainty =       0.001236017802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246462666
  error estimate for blocks of size 2^( 2) =       0.000255718177
  error estimate for blocks of size 2^( 3) =       0.000263968710
  error estimate for blocks of size 2^( 4) =       0.000269960142
  error estimate for blocks of size 2^( 5) =       0.000273092760
  error estimate for blocks of size 2^( 6) =       0.000274791014
  error estimate for blocks of size 2^( 7) =       0.000275438314
  error estimate for blocks of size 2^( 8) =       0.000276099774
  error estimate for blocks of size 2^( 9) =       0.000275178103

      target function =                  N/A
              le_mean =     -22.824594752339
             les_mean =     521.464737766238
             stat err =       0.000275376801
             autocorr =       1.248396140693
              std dev =       0.697101690389
             le_variance =       0.485950766744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282459475234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824594752335       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824601080385       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824601969566       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824602261235       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824602331576       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 8.228974e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824594752335       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824598496814       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824598730670       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824598788736       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 4.446789e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824594752335       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596174419       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824596194258       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824596217688       residual = 3.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.607013e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1942e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.080699e-01 3 1  ON 0
ci_02                -2.200205e-02 3 1  ON 1
ci_03                -2.265004e-02 3 1  ON 2
ci_04                 2.174095e-02 3 1  ON 3
ci_05                -2.169723e-02 3 1  ON 4
ci_06                -2.148586e-02 3 1  ON 5
ci_07                 2.630667e-02 3 1  ON 6
ci_08                -3.472615e-03 3 1  ON 7
ci_09                -1.065067e-02 3 1  ON 8
ci_10                -1.106592e-02 3 1  ON 9
ci_11                 1.586276e-02 3 1  ON 10
ci_12                 1.050745e-02 3 1  ON 11
ci_13                 1.236467e-02 3 1  ON 12
ci_14                 1.683660e-02 3 1  ON 13
ci_15                 7.746366e-03 3 1  ON 14
ci_16                 7.381932e-03 3 1  ON 15
ci_17                -9.017134e-03 3 1  ON 16
ci_18                -8.740927e-03 3 1  ON 17
ci_19                 9.418346e-03 3 1  ON 18
ci_20                 1.073403e-02 3 1  ON 19
ci_21                 8.130787e-03 3 1  ON 20
ci_22                 8.385431e-03 3 1  ON 21
ci_23                 6.457852e-03 3 1  ON 22
ci_24                 7.582626e-03 3 1  ON 23
ci_25                 5.552016e-03 3 1  ON 24
ci_26                 2.719975e-03 3 1  ON 25
ci_27                 2.913583e-03 3 1  ON 26
ci_28                 3.079893e-03 3 1  ON 27
ci_29                 2.909549e-03 3 1  ON 28
ci_30                 6.593428e-04 3 1  ON 29
ci_31                 6.029598e-04 3 1  ON 30
ci_32                 3.851837e-04 3 1  ON 31
ci_33                 9.385200e-05 3 1  ON 32
ci_34                 7.830194e-06 3 1  ON 33
ci_35                 5.811639e-05 3 1  ON 34
ci_36                -3.388152e-04 3 1  ON 35
ci_37                -6.300963e-04 3 1  ON 36
ci_38                 2.301020e-04 3 1  ON 37
ci_39                -9.895022e-05 3 1  ON 38
ci_40                -1.234809e-03 3 1  ON 39
ci_41                -6.171318e-05 3 1  ON 40
ci_42                 1.918827e-05 3 1  ON 41
ci_43                -2.320875e-03 3 1  ON 42
ci_44                -2.447332e-03 3 1  ON 43
ci_45                -9.628480e-05 3 1  ON 44
ci_46                 1.089894e-04 3 1  ON 45
ci_47                 5.092465e-05 3 1  ON 46
ci_48                 2.085127e-04 3 1  ON 47
ci_49                -1.181013e-03 3 1  ON 48
ci_50                -5.828276e-04 3 1  ON 49
ci_51                -1.987340e-04 3 1  ON 50
ci_52                 9.961110e-05 3 1  ON 51
ci_53                -1.135459e-03 3 1  ON 52
ci_54                -7.642374e-04 3 1  ON 53
ci_55                -8.513423e-04 3 1  ON 54
ci_56                 1.637554e-03 3 1  ON 55
ci_57                 1.540631e-03 3 1  ON 56
ci_58                -1.497265e-03 3 1  ON 57
ci_59                -1.303891e-03 3 1  ON 58
ci_60                 1.449192e-03 3 1  ON 59
ci_61                 2.003922e-03 3 1  ON 60
ci_62                -4.065354e-04 3 1  ON 61
ci_63                -2.592443e-04 3 1  ON 62
ci_64                -5.716973e-04 3 1  ON 63
ci_65                -4.920965e-04 3 1  ON 64
ci_66                -2.165743e-04 3 1  ON 65
ci_67                -4.665470e-04 3 1  ON 66
ci_68                -1.356437e-03 3 1  ON 67
ci_69                -1.798146e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8787
    reference variance = 0.33751
====================================================
  Execution time = 1.0027e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0490e-01
  Total weights = 7.8573e+06
  Execution time = 1.4547e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0670746
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488271372684
                                         uncertainty =       0.002499059113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488271372684
                                         uncertainty =       0.002499059113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247051555
  error estimate for blocks of size 2^( 2) =       0.000256200549
  error estimate for blocks of size 2^( 3) =       0.000264464796
  error estimate for blocks of size 2^( 4) =       0.000270103039
  error estimate for blocks of size 2^( 5) =       0.000273750502
  error estimate for blocks of size 2^( 6) =       0.000274835551
  error estimate for blocks of size 2^( 7) =       0.000276313847
  error estimate for blocks of size 2^( 8) =       0.000276506974
  error estimate for blocks of size 2^( 9) =       0.000277373678

      target function =                  N/A
              le_mean =     -22.824907302950
             les_mean =     521.486102186877
             stat err =       0.000276257512
             autocorr =       1.250411642171
              std dev =       0.698767320614
             le_variance =       0.488275768358

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.17941
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488336103667
                                         uncertainty =       0.002530712303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488336103667
                                         uncertainty =       0.002530712303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247067900
  error estimate for blocks of size 2^( 2) =       0.000256216224
  error estimate for blocks of size 2^( 3) =       0.000264480359
  error estimate for blocks of size 2^( 4) =       0.000270120452
  error estimate for blocks of size 2^( 5) =       0.000273773454
  error estimate for blocks of size 2^( 6) =       0.000274862698
  error estimate for blocks of size 2^( 7) =       0.000276340417
  error estimate for blocks of size 2^( 8) =       0.000276544137
  error estimate for blocks of size 2^( 9) =       0.000277416921

      target function =                  N/A
              le_mean =     -22.824909448116
             les_mean =     521.541795150820
             stat err =       0.000276291044
             autocorr =       1.250549724073
              std dev =       0.698813550872
             le_variance =       0.488340378883

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0657863
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488350614786
                                         uncertainty =       0.002533230317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488350614786
                                         uncertainty =       0.002533230317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247071572
  error estimate for blocks of size 2^( 2) =       0.000256220402
  error estimate for blocks of size 2^( 3) =       0.000264483137
  error estimate for blocks of size 2^( 4) =       0.000270121584
  error estimate for blocks of size 2^( 5) =       0.000273775944
  error estimate for blocks of size 2^( 6) =       0.000274864497
  error estimate for blocks of size 2^( 7) =       0.000276338563
  error estimate for blocks of size 2^( 8) =       0.000276547873
  error estimate for blocks of size 2^( 9) =       0.000277435224

      target function =                  N/A
              le_mean =     -22.824911119509
             les_mean =     521.488943971755
             stat err =       0.000276296539
             autocorr =       1.250562302270
              std dev =       0.698823935813
             le_variance =       0.488354893265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488252882634
                                         uncertainty =       0.002505391763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488252882634
                                         uncertainty =       0.002505391763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247046876
  error estimate for blocks of size 2^( 2) =       0.000256196020
  error estimate for blocks of size 2^( 3) =       0.000264460292
  error estimate for blocks of size 2^( 4) =       0.000270098482
  error estimate for blocks of size 2^( 5) =       0.000273746627
  error estimate for blocks of size 2^( 6) =       0.000274831565
  error estimate for blocks of size 2^( 7) =       0.000276310425
  error estimate for blocks of size 2^( 8) =       0.000276505310
  error estimate for blocks of size 2^( 9) =       0.000277372655

      target function =                  N/A
              le_mean =     -22.824904975988
             les_mean =     521.483955489388
             stat err =       0.000276254989
             autocorr =       1.250436164580
              std dev =       0.698754085393
             le_variance =       0.488257271853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824907302950        initial
     6.1035e-02     6.1035e-01             8.2290e-04       -22.824909448116
     2.4414e-01     2.4414e+00             4.4468e-04       -22.824911119509  <--
     9.7656e-01     9.7656e+00             1.6070e-04       -22.824904975988

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 1.7465e+02
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.080699e-01 3 1  ON 0
ci_02                -2.200205e-02 3 1  ON 1
ci_03                -2.265004e-02 3 1  ON 2
ci_04                 2.174095e-02 3 1  ON 3
ci_05                -2.169723e-02 3 1  ON 4
ci_06                -2.148586e-02 3 1  ON 5
ci_07                 2.630667e-02 3 1  ON 6
ci_08                -3.472615e-03 3 1  ON 7
ci_09                -1.065067e-02 3 1  ON 8
ci_10                -1.106592e-02 3 1  ON 9
ci_11                 1.586276e-02 3 1  ON 10
ci_12                 1.050745e-02 3 1  ON 11
ci_13                 1.236467e-02 3 1  ON 12
ci_14                 1.683660e-02 3 1  ON 13
ci_15                 7.746366e-03 3 1  ON 14
ci_16                 7.381932e-03 3 1  ON 15
ci_17                -9.017134e-03 3 1  ON 16
ci_18                -8.740927e-03 3 1  ON 17
ci_19                 9.418346e-03 3 1  ON 18
ci_20                 1.073403e-02 3 1  ON 19
ci_21                 8.130787e-03 3 1  ON 20
ci_22                 8.385431e-03 3 1  ON 21
ci_23                 6.457852e-03 3 1  ON 22
ci_24                 7.582626e-03 3 1  ON 23
ci_25                 5.552016e-03 3 1  ON 24
ci_26                 2.719975e-03 3 1  ON 25
ci_27                 2.913583e-03 3 1  ON 26
ci_28                 3.079893e-03 3 1  ON 27
ci_29                 2.909549e-03 3 1  ON 28
ci_30                 6.593428e-04 3 1  ON 29
ci_31                 6.029598e-04 3 1  ON 30
ci_32                 3.851837e-04 3 1  ON 31
ci_33                 9.385200e-05 3 1  ON 32
ci_34                 7.830194e-06 3 1  ON 33
ci_35                 5.811639e-05 3 1  ON 34
ci_36                -3.388152e-04 3 1  ON 35
ci_37                -6.300963e-04 3 1  ON 36
ci_38                 2.301020e-04 3 1  ON 37
ci_39                -9.895022e-05 3 1  ON 38
ci_40                -1.234809e-03 3 1  ON 39
ci_41                -6.171318e-05 3 1  ON 40
ci_42                 1.918827e-05 3 1  ON 41
ci_43                -2.320875e-03 3 1  ON 42
ci_44                -2.447332e-03 3 1  ON 43
ci_45                -9.628480e-05 3 1  ON 44
ci_46                 1.089894e-04 3 1  ON 45
ci_47                 5.092465e-05 3 1  ON 46
ci_48                 2.085127e-04 3 1  ON 47
ci_49                -1.181013e-03 3 1  ON 48
ci_50                -5.828276e-04 3 1  ON 49
ci_51                -1.987340e-04 3 1  ON 50
ci_52                 9.961110e-05 3 1  ON 51
ci_53                -1.135459e-03 3 1  ON 52
ci_54                -7.642374e-04 3 1  ON 53
ci_55                -8.513423e-04 3 1  ON 54
ci_56                 1.637554e-03 3 1  ON 55
ci_57                 1.540631e-03 3 1  ON 56
ci_58                -1.497265e-03 3 1  ON 57
ci_59                -1.303891e-03 3 1  ON 58
ci_60                 1.449192e-03 3 1  ON 59
ci_61                 2.003922e-03 3 1  ON 60
ci_62                -4.065354e-04 3 1  ON 61
ci_63                -2.592443e-04 3 1  ON 62
ci_64                -5.716973e-04 3 1  ON 63
ci_65                -4.920965e-04 3 1  ON 64
ci_66                -2.165743e-04 3 1  ON 65
ci_67                -4.665470e-04 3 1  ON 66
ci_68                -1.356437e-03 3 1  ON 67
ci_69                -1.798146e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9407e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7889
    reference variance = 0.443318
====================================================
  Execution time = 1.0110e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1433e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0158e-01
  Total weights = 7.857016047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8481e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485855382242
                                         uncertainty =       0.001768233757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485855382242
                                         uncertainty =       0.001768233757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246437630
  error estimate for blocks of size 2^( 2) =       0.000255551002
  error estimate for blocks of size 2^( 3) =       0.000263706571
  error estimate for blocks of size 2^( 4) =       0.000269636579
  error estimate for blocks of size 2^( 5) =       0.000273014532
  error estimate for blocks of size 2^( 6) =       0.000274555096
  error estimate for blocks of size 2^( 7) =       0.000275854626
  error estimate for blocks of size 2^( 8) =       0.000276307921
  error estimate for blocks of size 2^( 9) =       0.000275924286

      target function =                  N/A
              le_mean =     -22.824479474340
             les_mean =     521.458442770145
             stat err =       0.000275660482
             autocorr =       1.251223742532
              std dev =       0.697030876799
             le_variance =       0.485852043211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282447947434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824479474338       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824481320813       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824481020003       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824481086028       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824481087009       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 6.767953e-04

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824479474338       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824480593523       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824480451433       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824480445442       residual = 4.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 4.111018e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824479474338       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824479908885       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824479875745       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824479860345       residual = 2.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.673113e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1959e+02
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.079958e-01 3 1  ON 0
ci_02                -2.203238e-02 3 1  ON 1
ci_03                -2.261271e-02 3 1  ON 2
ci_04                 2.157517e-02 3 1  ON 3
ci_05                -2.164584e-02 3 1  ON 4
ci_06                -2.157361e-02 3 1  ON 5
ci_07                 2.616256e-02 3 1  ON 6
ci_08                -3.388773e-03 3 1  ON 7
ci_09                -1.089058e-02 3 1  ON 8
ci_10                -1.088441e-02 3 1  ON 9
ci_11                 1.599597e-02 3 1  ON 10
ci_12                 1.070205e-02 3 1  ON 11
ci_13                 1.221036e-02 3 1  ON 12
ci_14                 1.693218e-02 3 1  ON 13
ci_15                 7.389198e-03 3 1  ON 14
ci_16                 7.583896e-03 3 1  ON 15
ci_17                -9.047903e-03 3 1  ON 16
ci_18                -8.759216e-03 3 1  ON 17
ci_19                 9.398540e-03 3 1  ON 18
ci_20                 1.059316e-02 3 1  ON 19
ci_21                 8.238644e-03 3 1  ON 20
ci_22                 8.295288e-03 3 1  ON 21
ci_23                 6.670793e-03 3 1  ON 22
ci_24                 7.513915e-03 3 1  ON 23
ci_25                 5.214186e-03 3 1  ON 24
ci_26                 2.361298e-03 3 1  ON 25
ci_27                 2.869342e-03 3 1  ON 26
ci_28                 2.820158e-03 3 1  ON 27
ci_29                 2.969683e-03 3 1  ON 28
ci_30                 8.580038e-04 3 1  ON 29
ci_31                 5.229360e-04 3 1  ON 30
ci_32                 3.078287e-04 3 1  ON 31
ci_33                -7.370355e-06 3 1  ON 32
ci_34                -1.222442e-04 3 1  ON 33
ci_35                 1.630972e-04 3 1  ON 34
ci_36                -3.549706e-04 3 1  ON 35
ci_37                -6.970199e-04 3 1  ON 36
ci_38                 9.125014e-06 3 1  ON 37
ci_39                -5.100520e-04 3 1  ON 38
ci_40                -1.121196e-03 3 1  ON 39
ci_41                -1.099311e-04 3 1  ON 40
ci_42                 1.883303e-04 3 1  ON 41
ci_43                -2.437862e-03 3 1  ON 42
ci_44                -2.507141e-03 3 1  ON 43
ci_45                -1.372028e-04 3 1  ON 44
ci_46                 4.801231e-05 3 1  ON 45
ci_47                 1.157237e-04 3 1  ON 46
ci_48                 3.567110e-04 3 1  ON 47
ci_49                -1.065231e-03 3 1  ON 48
ci_50                -2.645243e-04 3 1  ON 49
ci_51                -3.436675e-04 3 1  ON 50
ci_52                -1.776897e-04 3 1  ON 51
ci_53                -9.629032e-04 3 1  ON 52
ci_54                -3.913956e-04 3 1  ON 53
ci_55                -9.844322e-04 3 1  ON 54
ci_56                 1.287376e-03 3 1  ON 55
ci_57                 1.273001e-03 3 1  ON 56
ci_58                -1.258123e-03 3 1  ON 57
ci_59                -1.357322e-03 3 1  ON 58
ci_60                 1.346690e-03 3 1  ON 59
ci_61                 2.128863e-03 3 1  ON 60
ci_62                -5.322059e-04 3 1  ON 61
ci_63                -3.570606e-04 3 1  ON 62
ci_64                -4.769300e-04 3 1  ON 63
ci_65                -4.084005e-04 3 1  ON 64
ci_66                -4.190182e-04 3 1  ON 65
ci_67                -3.781130e-04 3 1  ON 66
ci_68                -1.290757e-03 3 1  ON 67
ci_69                -1.928922e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8288
    reference variance = 0.618433
====================================================
  Execution time = 1.0038e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0282e-01
  Total weights = 7.8567e+06
  Execution time = 1.4340e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484927911389
                                         uncertainty =       0.001353369988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484927911389
                                         uncertainty =       0.001353369988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246202872
  error estimate for blocks of size 2^( 2) =       0.000255407803
  error estimate for blocks of size 2^( 3) =       0.000263502642
  error estimate for blocks of size 2^( 4) =       0.000269562117
  error estimate for blocks of size 2^( 5) =       0.000273146156
  error estimate for blocks of size 2^( 6) =       0.000274997158
  error estimate for blocks of size 2^( 7) =       0.000276492290
  error estimate for blocks of size 2^( 8) =       0.000276776318
  error estimate for blocks of size 2^( 9) =       0.000276489314

      target function =                  N/A
              le_mean =     -22.824873651056
             les_mean =     521.480583757341
             stat err =       0.000276188770
             autocorr =       1.258420554820
              std dev =       0.696366879956
             le_variance =       0.484926831499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484871658141
                                         uncertainty =       0.001340512613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484871658141
                                         uncertainty =       0.001340512613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246188608
  error estimate for blocks of size 2^( 2) =       0.000255396619
  error estimate for blocks of size 2^( 3) =       0.000263492190
  error estimate for blocks of size 2^( 4) =       0.000269553138
  error estimate for blocks of size 2^( 5) =       0.000273136178
  error estimate for blocks of size 2^( 6) =       0.000274988441
  error estimate for blocks of size 2^( 7) =       0.000276488455
  error estimate for blocks of size 2^( 8) =       0.000276770845
  error estimate for blocks of size 2^( 9) =       0.000276473905

      target function =                  N/A
              le_mean =     -22.824869220615
             les_mean =     521.487938640801
             stat err =       0.000276180411
             autocorr =       1.258490198801
              std dev =       0.696326537716
             le_variance =       0.484870647127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484900607928
                                         uncertainty =       0.001334856045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484900607928
                                         uncertainty =       0.001334856045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246195960
  error estimate for blocks of size 2^( 2) =       0.000255405282
  error estimate for blocks of size 2^( 3) =       0.000263502348
  error estimate for blocks of size 2^( 4) =       0.000269560355
  error estimate for blocks of size 2^( 5) =       0.000273141109
  error estimate for blocks of size 2^( 6) =       0.000274990935
  error estimate for blocks of size 2^( 7) =       0.000276490665
  error estimate for blocks of size 2^( 8) =       0.000276765239
  error estimate for blocks of size 2^( 9) =       0.000276469130

      target function =                  N/A
              le_mean =     -22.824872023271
             les_mean =     521.559104357697
             stat err =       0.000276178992
             autocorr =       1.258402105245
              std dev =       0.696347332100
             le_variance =       0.484899606923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484897851101
                                         uncertainty =       0.001349884383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484897851101
                                         uncertainty =       0.001349884383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246195245
  error estimate for blocks of size 2^( 2) =       0.000255401427
  error estimate for blocks of size 2^( 3) =       0.000263496252
  error estimate for blocks of size 2^( 4) =       0.000269556122
  error estimate for blocks of size 2^( 5) =       0.000273140096
  error estimate for blocks of size 2^( 6) =       0.000274989997
  error estimate for blocks of size 2^( 7) =       0.000276485584
  error estimate for blocks of size 2^( 8) =       0.000276768679
  error estimate for blocks of size 2^( 9) =       0.000276477975

      target function =                  N/A
              le_mean =     -22.824870558743
             les_mean =     521.493525526063
             stat err =       0.000276180559
             autocorr =       1.258423694596
              std dev =       0.696345308895
             le_variance =       0.484896789220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824873651056        initial  <--
     6.1035e-02     6.1035e-01             6.7680e-04       -22.824869220615
     2.4414e-01     2.4414e+00             4.1110e-04       -22.824872023271
     9.7656e-01     9.7656e+00             1.6731e-04       -22.824870558743

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.2039
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.080699e-01 3 1  ON 0
ci_02                -2.200205e-02 3 1  ON 1
ci_03                -2.265004e-02 3 1  ON 2
ci_04                 2.174095e-02 3 1  ON 3
ci_05                -2.169723e-02 3 1  ON 4
ci_06                -2.148586e-02 3 1  ON 5
ci_07                 2.630667e-02 3 1  ON 6
ci_08                -3.472615e-03 3 1  ON 7
ci_09                -1.065067e-02 3 1  ON 8
ci_10                -1.106592e-02 3 1  ON 9
ci_11                 1.586276e-02 3 1  ON 10
ci_12                 1.050745e-02 3 1  ON 11
ci_13                 1.236467e-02 3 1  ON 12
ci_14                 1.683660e-02 3 1  ON 13
ci_15                 7.746366e-03 3 1  ON 14
ci_16                 7.381932e-03 3 1  ON 15
ci_17                -9.017134e-03 3 1  ON 16
ci_18                -8.740927e-03 3 1  ON 17
ci_19                 9.418346e-03 3 1  ON 18
ci_20                 1.073403e-02 3 1  ON 19
ci_21                 8.130787e-03 3 1  ON 20
ci_22                 8.385431e-03 3 1  ON 21
ci_23                 6.457852e-03 3 1  ON 22
ci_24                 7.582626e-03 3 1  ON 23
ci_25                 5.552016e-03 3 1  ON 24
ci_26                 2.719975e-03 3 1  ON 25
ci_27                 2.913583e-03 3 1  ON 26
ci_28                 3.079893e-03 3 1  ON 27
ci_29                 2.909549e-03 3 1  ON 28
ci_30                 6.593428e-04 3 1  ON 29
ci_31                 6.029598e-04 3 1  ON 30
ci_32                 3.851837e-04 3 1  ON 31
ci_33                 9.385200e-05 3 1  ON 32
ci_34                 7.830194e-06 3 1  ON 33
ci_35                 5.811639e-05 3 1  ON 34
ci_36                -3.388152e-04 3 1  ON 35
ci_37                -6.300963e-04 3 1  ON 36
ci_38                 2.301020e-04 3 1  ON 37
ci_39                -9.895022e-05 3 1  ON 38
ci_40                -1.234809e-03 3 1  ON 39
ci_41                -6.171318e-05 3 1  ON 40
ci_42                 1.918827e-05 3 1  ON 41
ci_43                -2.320875e-03 3 1  ON 42
ci_44                -2.447332e-03 3 1  ON 43
ci_45                -9.628480e-05 3 1  ON 44
ci_46                 1.089894e-04 3 1  ON 45
ci_47                 5.092465e-05 3 1  ON 46
ci_48                 2.085127e-04 3 1  ON 47
ci_49                -1.181013e-03 3 1  ON 48
ci_50                -5.828276e-04 3 1  ON 49
ci_51                -1.987340e-04 3 1  ON 50
ci_52                 9.961110e-05 3 1  ON 51
ci_53                -1.135459e-03 3 1  ON 52
ci_54                -7.642374e-04 3 1  ON 53
ci_55                -8.513423e-04 3 1  ON 54
ci_56                 1.637554e-03 3 1  ON 55
ci_57                 1.540631e-03 3 1  ON 56
ci_58                -1.497265e-03 3 1  ON 57
ci_59                -1.303891e-03 3 1  ON 58
ci_60                 1.449192e-03 3 1  ON 59
ci_61                 2.003922e-03 3 1  ON 60
ci_62                -4.065354e-04 3 1  ON 61
ci_63                -2.592443e-04 3 1  ON 62
ci_64                -5.716973e-04 3 1  ON 63
ci_65                -4.920965e-04 3 1  ON 64
ci_66                -2.165743e-04 3 1  ON 65
ci_67                -4.665470e-04 3 1  ON 66
ci_68                -1.356437e-03 3 1  ON 67
ci_69                -1.798146e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9180e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8183
    reference variance = 0.345599
====================================================
  Execution time = 1.0135e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1420e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0215e-01
  Total weights = 7.856892938e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8431e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486777075144
                                         uncertainty =       0.001233609050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486777075144
                                         uncertainty =       0.001233609050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246672607
  error estimate for blocks of size 2^( 2) =       0.000255860621
  error estimate for blocks of size 2^( 3) =       0.000263985801
  error estimate for blocks of size 2^( 4) =       0.000270108859
  error estimate for blocks of size 2^( 5) =       0.000273418831
  error estimate for blocks of size 2^( 6) =       0.000275639936
  error estimate for blocks of size 2^( 7) =       0.000277217951
  error estimate for blocks of size 2^( 8) =       0.000277638530
  error estimate for blocks of size 2^( 9) =       0.000276822023

      target function =                  N/A
              le_mean =     -22.824843799242
             les_mean =     521.475640449290
             stat err =       0.000276829610
             autocorr =       1.259456681231
              std dev =       0.697695491952
             le_variance =       0.486778999490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282484379924e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824843799234       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824845624429       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824845682264       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 2.496080e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824843799234       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824844368714       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824844413351       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 8.253123e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824843799234       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824843951016       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824843965425       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824843965106       residual = 4.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.269523e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046372 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1980e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.080825e-01 3 1  ON 0
ci_02                -2.205869e-02 3 1  ON 1
ci_03                -2.260960e-02 3 1  ON 2
ci_04                 2.175913e-02 3 1  ON 3
ci_05                -2.168683e-02 3 1  ON 4
ci_06                -2.147855e-02 3 1  ON 5
ci_07                 2.630129e-02 3 1  ON 6
ci_08                -3.463251e-03 3 1  ON 7
ci_09                -1.069629e-02 3 1  ON 8
ci_10                -1.104338e-02 3 1  ON 9
ci_11                 1.585709e-02 3 1  ON 10
ci_12                 1.055992e-02 3 1  ON 11
ci_13                 1.239625e-02 3 1  ON 12
ci_14                 1.685224e-02 3 1  ON 13
ci_15                 7.749174e-03 3 1  ON 14
ci_16                 7.371609e-03 3 1  ON 15
ci_17                -9.002000e-03 3 1  ON 16
ci_18                -8.753301e-03 3 1  ON 17
ci_19                 9.500877e-03 3 1  ON 18
ci_20                 1.070817e-02 3 1  ON 19
ci_21                 8.140913e-03 3 1  ON 20
ci_22                 8.384613e-03 3 1  ON 21
ci_23                 6.481001e-03 3 1  ON 22
ci_24                 7.621121e-03 3 1  ON 23
ci_25                 5.540618e-03 3 1  ON 24
ci_26                 2.741957e-03 3 1  ON 25
ci_27                 2.925297e-03 3 1  ON 26
ci_28                 3.069714e-03 3 1  ON 27
ci_29                 2.945234e-03 3 1  ON 28
ci_30                 6.762686e-04 3 1  ON 29
ci_31                 5.847923e-04 3 1  ON 30
ci_32                 4.000844e-04 3 1  ON 31
ci_33                 8.018696e-05 3 1  ON 32
ci_34                -2.172255e-05 3 1  ON 33
ci_35                 7.840542e-05 3 1  ON 34
ci_36                -3.436821e-04 3 1  ON 35
ci_37                -5.976361e-04 3 1  ON 36
ci_38                 2.311665e-04 3 1  ON 37
ci_39                -1.108015e-04 3 1  ON 38
ci_40                -1.262860e-03 3 1  ON 39
ci_41                -3.499767e-05 3 1  ON 40
ci_42                 9.805793e-06 3 1  ON 41
ci_43                -2.294596e-03 3 1  ON 42
ci_44                -2.463975e-03 3 1  ON 43
ci_45                -1.237548e-04 3 1  ON 44
ci_46                 4.187509e-05 3 1  ON 45
ci_47                 5.484216e-05 3 1  ON 46
ci_48                 2.258155e-04 3 1  ON 47
ci_49                -1.251407e-03 3 1  ON 48
ci_50                -5.979796e-04 3 1  ON 49
ci_51                -2.392845e-04 3 1  ON 50
ci_52                 1.283464e-04 3 1  ON 51
ci_53                -1.054043e-03 3 1  ON 52
ci_54                -7.774991e-04 3 1  ON 53
ci_55                -8.415886e-04 3 1  ON 54
ci_56                 1.681470e-03 3 1  ON 55
ci_57                 1.603313e-03 3 1  ON 56
ci_58                -1.493558e-03 3 1  ON 57
ci_59                -1.313381e-03 3 1  ON 58
ci_60                 1.459499e-03 3 1  ON 59
ci_61                 1.968648e-03 3 1  ON 60
ci_62                -4.236981e-04 3 1  ON 61
ci_63                -2.733968e-04 3 1  ON 62
ci_64                -5.438866e-04 3 1  ON 63
ci_65                -4.797645e-04 3 1  ON 64
ci_66                -2.025575e-04 3 1  ON 65
ci_67                -4.403557e-04 3 1  ON 66
ci_68                -1.376591e-03 3 1  ON 67
ci_69                -1.795682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8469
    reference variance = 0.314435
====================================================
  Execution time = 1.0059e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0593e-01
  Total weights = 7.8569e+06
  Execution time = 1.4313e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487503380155
                                         uncertainty =       0.001312706554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487503380155
                                         uncertainty =       0.001312706554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246856218
  error estimate for blocks of size 2^( 2) =       0.000256052511
  error estimate for blocks of size 2^( 3) =       0.000264301926
  error estimate for blocks of size 2^( 4) =       0.000270129069
  error estimate for blocks of size 2^( 5) =       0.000273672349
  error estimate for blocks of size 2^( 6) =       0.000275985757
  error estimate for blocks of size 2^( 7) =       0.000277890055
  error estimate for blocks of size 2^( 8) =       0.000278343099
  error estimate for blocks of size 2^( 9) =       0.000278909543

      target function =                  N/A
              le_mean =     -22.824433416329
             les_mean =     521.473174352149
             stat err =       0.000277782113
             autocorr =       1.266252783748
              std dev =       0.698214823259
             le_variance =       0.487503939419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487486948029
                                         uncertainty =       0.001311470834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487486948029
                                         uncertainty =       0.001311470834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246852062
  error estimate for blocks of size 2^( 2) =       0.000256048259
  error estimate for blocks of size 2^( 3) =       0.000264297261
  error estimate for blocks of size 2^( 4) =       0.000270123448
  error estimate for blocks of size 2^( 5) =       0.000273666801
  error estimate for blocks of size 2^( 6) =       0.000275981233
  error estimate for blocks of size 2^( 7) =       0.000277885068
  error estimate for blocks of size 2^( 8) =       0.000278340076
  error estimate for blocks of size 2^( 9) =       0.000278901406

      target function =                  N/A
              le_mean =     -22.824433364959
             les_mean =     521.461129487274
             stat err =       0.000277776946
             autocorr =       1.266248311015
              std dev =       0.698203067794
             le_variance =       0.487487523877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487490084587
                                         uncertainty =       0.001312006144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487490084587
                                         uncertainty =       0.001312006144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246852855
  error estimate for blocks of size 2^( 2) =       0.000256049046
  error estimate for blocks of size 2^( 3) =       0.000264298233
  error estimate for blocks of size 2^( 4) =       0.000270124722
  error estimate for blocks of size 2^( 5) =       0.000273668050
  error estimate for blocks of size 2^( 6) =       0.000275982164
  error estimate for blocks of size 2^( 7) =       0.000277885881
  error estimate for blocks of size 2^( 8) =       0.000278340432
  error estimate for blocks of size 2^( 9) =       0.000278904060

      target function =                  N/A
              le_mean =     -22.824433176354
             les_mean =     521.460895137695
             stat err =       0.000277778134
             autocorr =       1.266251010575
              std dev =       0.698205309937
             le_variance =       0.487490654825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487501106335
                                         uncertainty =       0.001312617431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487501106335
                                         uncertainty =       0.001312617431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246855643
  error estimate for blocks of size 2^( 2) =       0.000256051946
  error estimate for blocks of size 2^( 3) =       0.000264301335
  error estimate for blocks of size 2^( 4) =       0.000270128485
  error estimate for blocks of size 2^( 5) =       0.000273671825
  error estimate for blocks of size 2^( 6) =       0.000275985417
  error estimate for blocks of size 2^( 7) =       0.000277889568
  error estimate for blocks of size 2^( 8) =       0.000278342559
  error estimate for blocks of size 2^( 9) =       0.000278909465

      target function =                  N/A
              le_mean =     -22.824433577911
             les_mean =     521.484451917725
             stat err =       0.000277781752
             autocorr =       1.266255394496
              std dev =       0.698213195934
             le_variance =       0.487501666977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824433416329        initial
     6.1035e-01     6.1035e+00             2.4961e-04       -22.824433364959
     2.4414e+00     2.4414e+01             8.2531e-05       -22.824433176354
     9.7656e+00     9.7656e+01             2.2695e-05       -22.824433577911  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 1.7373e+02
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.080732e-01 3 1  ON 0
ci_02                -2.201686e-02 3 1  ON 1
ci_03                -2.263960e-02 3 1  ON 2
ci_04                 2.174606e-02 3 1  ON 3
ci_05                -2.169452e-02 3 1  ON 4
ci_06                -2.148387e-02 3 1  ON 5
ci_07                 2.630520e-02 3 1  ON 6
ci_08                -3.470020e-03 3 1  ON 7
ci_09                -1.066260e-02 3 1  ON 8
ci_10                -1.106003e-02 3 1  ON 9
ci_11                 1.586120e-02 3 1  ON 10
ci_12                 1.052126e-02 3 1  ON 11
ci_13                 1.237285e-02 3 1  ON 12
ci_14                 1.684070e-02 3 1  ON 13
ci_15                 7.747179e-03 3 1  ON 14
ci_16                 7.379237e-03 3 1  ON 15
ci_17                -9.013180e-03 3 1  ON 16
ci_18                -8.744303e-03 3 1  ON 17
ci_19                 9.441041e-03 3 1  ON 18
ci_20                 1.072730e-02 3 1  ON 19
ci_21                 8.133454e-03 3 1  ON 20
ci_22                 8.385182e-03 3 1  ON 21
ci_23                 6.464456e-03 3 1  ON 22
ci_24                 7.592649e-03 3 1  ON 23
ci_25                 5.548922e-03 3 1  ON 24
ci_26                 2.725569e-03 3 1  ON 25
ci_27                 2.916680e-03 3 1  ON 26
ci_28                 3.077194e-03 3 1  ON 27
ci_29                 2.919085e-03 3 1  ON 28
ci_30                 6.636761e-04 3 1  ON 29
ci_31                 5.983353e-04 3 1  ON 30
ci_32                 3.891803e-04 3 1  ON 31
ci_33                 9.019619e-05 3 1  ON 32
ci_34                -2.611663e-08 3 1  ON 33
ci_35                 6.338353e-05 3 1  ON 34
ci_36                -3.402497e-04 3 1  ON 35
ci_37                -6.215342e-04 3 1  ON 36
ci_38                 2.302685e-04 3 1  ON 37
ci_39                -1.020664e-04 3 1  ON 38
ci_40                -1.242202e-03 3 1  ON 39
ci_41                -5.456350e-05 3 1  ON 40
ci_42                 1.656435e-05 3 1  ON 41
ci_43                -2.314070e-03 3 1  ON 42
ci_44                -2.451868e-03 3 1  ON 43
ci_45                -1.037560e-04 3 1  ON 44
ci_46                 9.080830e-05 3 1  ON 45
ci_47                 5.219795e-05 3 1  ON 46
ci_48                 2.130365e-04 3 1  ON 47
ci_49                -1.199880e-03 3 1  ON 48
ci_50                -5.870233e-04 3 1  ON 49
ci_51                -2.094092e-04 3 1  ON 50
ci_52                 1.075309e-04 3 1  ON 51
ci_53                -1.112996e-03 3 1  ON 52
ci_54                -7.677877e-04 3 1  ON 53
ci_55                -8.489029e-04 3 1  ON 54
ci_56                 1.649621e-03 3 1  ON 55
ci_57                 1.557703e-03 3 1  ON 56
ci_58                -1.496254e-03 3 1  ON 57
ci_59                -1.306212e-03 3 1  ON 58
ci_60                 1.451750e-03 3 1  ON 59
ci_61                 1.994655e-03 3 1  ON 60
ci_62                -4.108927e-04 3 1  ON 61
ci_63                -2.628534e-04 3 1  ON 62
ci_64                -5.645533e-04 3 1  ON 63
ci_65                -4.889824e-04 3 1  ON 64
ci_66                -2.129028e-04 3 1  ON 65
ci_67                -4.596044e-04 3 1  ON 66
ci_68                -1.361739e-03 3 1  ON 67
ci_69                -1.797480e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9354e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8359
    reference variance = 0.414837
====================================================
  Execution time = 1.0003e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1356e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9954e-01
  Total weights = 7.857023318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8571e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483590408305
                                         uncertainty =       0.001104777756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483590408305
                                         uncertainty =       0.001104777756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245863740
  error estimate for blocks of size 2^( 2) =       0.000255186854
  error estimate for blocks of size 2^( 3) =       0.000263486862
  error estimate for blocks of size 2^( 4) =       0.000269326855
  error estimate for blocks of size 2^( 5) =       0.000272931618
  error estimate for blocks of size 2^( 6) =       0.000274842048
  error estimate for blocks of size 2^( 7) =       0.000275651379
  error estimate for blocks of size 2^( 8) =       0.000276127613
  error estimate for blocks of size 2^( 9) =       0.000275593660

      target function =                  N/A
              le_mean =     -22.824213712707
             les_mean =     521.444269086510
             stat err =       0.000275553675
             autocorr =       1.256097777326
              std dev =       0.695407671728
             le_variance =       0.483591829898


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282421371271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824213712699       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824213907148       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824213975805       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824213978107       residual = 4.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 8.258929e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824213712699       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824213764392       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824213783105       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824213784309       residual = 6.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.274645e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824213712699       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824213725830       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824213730612       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824213730971       residual = 7.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 5.835251e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1861e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.080725e-01 3 1  ON 0
ci_02                -2.200019e-02 3 1  ON 1
ci_03                -2.263093e-02 3 1  ON 2
ci_04                 2.173554e-02 3 1  ON 3
ci_05                -2.168848e-02 3 1  ON 4
ci_06                -2.148288e-02 3 1  ON 5
ci_07                 2.629069e-02 3 1  ON 6
ci_08                -3.479846e-03 3 1  ON 7
ci_09                -1.065905e-02 3 1  ON 8
ci_10                -1.106498e-02 3 1  ON 9
ci_11                 1.586379e-02 3 1  ON 10
ci_12                 1.053648e-02 3 1  ON 11
ci_13                 1.237649e-02 3 1  ON 12
ci_14                 1.685453e-02 3 1  ON 13
ci_15                 7.730647e-03 3 1  ON 14
ci_16                 7.380722e-03 3 1  ON 15
ci_17                -9.023529e-03 3 1  ON 16
ci_18                -8.741794e-03 3 1  ON 17
ci_19                 9.447796e-03 3 1  ON 18
ci_20                 1.073350e-02 3 1  ON 19
ci_21                 8.130817e-03 3 1  ON 20
ci_22                 8.373732e-03 3 1  ON 21
ci_23                 6.461420e-03 3 1  ON 22
ci_24                 7.592980e-03 3 1  ON 23
ci_25                 5.540101e-03 3 1  ON 24
ci_26                 2.723812e-03 3 1  ON 25
ci_27                 2.906249e-03 3 1  ON 26
ci_28                 3.077814e-03 3 1  ON 27
ci_29                 2.922292e-03 3 1  ON 28
ci_30                 6.713484e-04 3 1  ON 29
ci_31                 5.935889e-04 3 1  ON 30
ci_32                 3.877455e-04 3 1  ON 31
ci_33                 1.046332e-04 3 1  ON 32
ci_34                -4.914193e-06 3 1  ON 33
ci_35                 6.862013e-05 3 1  ON 34
ci_36                -3.404477e-04 3 1  ON 35
ci_37                -6.134043e-04 3 1  ON 36
ci_38                 2.169138e-04 3 1  ON 37
ci_39                -1.113415e-04 3 1  ON 38
ci_40                -1.264948e-03 3 1  ON 39
ci_41                -6.677434e-05 3 1  ON 40
ci_42                 2.488232e-05 3 1  ON 41
ci_43                -2.317364e-03 3 1  ON 42
ci_44                -2.447872e-03 3 1  ON 43
ci_45                -1.063191e-04 3 1  ON 44
ci_46                 9.229690e-05 3 1  ON 45
ci_47                 5.112584e-05 3 1  ON 46
ci_48                 2.147813e-04 3 1  ON 47
ci_49                -1.199126e-03 3 1  ON 48
ci_50                -5.942903e-04 3 1  ON 49
ci_51                -2.042861e-04 3 1  ON 50
ci_52                 1.099802e-04 3 1  ON 51
ci_53                -1.105937e-03 3 1  ON 52
ci_54                -7.712707e-04 3 1  ON 53
ci_55                -8.385373e-04 3 1  ON 54
ci_56                 1.660529e-03 3 1  ON 55
ci_57                 1.550834e-03 3 1  ON 56
ci_58                -1.509339e-03 3 1  ON 57
ci_59                -1.309820e-03 3 1  ON 58
ci_60                 1.449458e-03 3 1  ON 59
ci_61                 2.002054e-03 3 1  ON 60
ci_62                -3.919281e-04 3 1  ON 61
ci_63                -2.547076e-04 3 1  ON 62
ci_64                -5.581213e-04 3 1  ON 63
ci_65                -4.954556e-04 3 1  ON 64
ci_66                -2.175630e-04 3 1  ON 65
ci_67                -4.518319e-04 3 1  ON 66
ci_68                -1.367235e-03 3 1  ON 67
ci_69                -1.801902e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8353
    reference variance = 0.461312
====================================================
  Execution time = 1.0034e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0083e-01
  Total weights = 7.8569e+06
  Execution time = 1.4329e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484715888689
                                         uncertainty =       0.001243523601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484715888689
                                         uncertainty =       0.001243523601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246149331
  error estimate for blocks of size 2^( 2) =       0.000255344382
  error estimate for blocks of size 2^( 3) =       0.000263586960
  error estimate for blocks of size 2^( 4) =       0.000269618038
  error estimate for blocks of size 2^( 5) =       0.000273559482
  error estimate for blocks of size 2^( 6) =       0.000275682025
  error estimate for blocks of size 2^( 7) =       0.000277208846
  error estimate for blocks of size 2^( 8) =       0.000277623471
  error estimate for blocks of size 2^( 9) =       0.000278971605

      target function =                  N/A
              le_mean =     -22.824374652899
             les_mean =     521.513632543042
             stat err =       0.000277371487
             autocorr =       1.269773644247
              std dev =       0.696215445181
             le_variance =       0.484715946109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484710803404
                                         uncertainty =       0.001242795520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484710803404
                                         uncertainty =       0.001242795520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246148042
  error estimate for blocks of size 2^( 2) =       0.000255343738
  error estimate for blocks of size 2^( 3) =       0.000263587309
  error estimate for blocks of size 2^( 4) =       0.000269618601
  error estimate for blocks of size 2^( 5) =       0.000273560021
  error estimate for blocks of size 2^( 6) =       0.000275682840
  error estimate for blocks of size 2^( 7) =       0.000277209794
  error estimate for blocks of size 2^( 8) =       0.000277624442
  error estimate for blocks of size 2^( 9) =       0.000278969777

      target function =                  N/A
              le_mean =     -22.824374933565
             les_mean =     521.454277028313
             stat err =       0.000277371713
             autocorr =       1.269789016399
              std dev =       0.696211799198
             le_variance =       0.484710869343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484712722740
                                         uncertainty =       0.001243142453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484712722740
                                         uncertainty =       0.001243142453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246148529
  error estimate for blocks of size 2^( 2) =       0.000255343921
  error estimate for blocks of size 2^( 3) =       0.000263587048
  error estimate for blocks of size 2^( 4) =       0.000269618162
  error estimate for blocks of size 2^( 5) =       0.000273559541
  error estimate for blocks of size 2^( 6) =       0.000275682180
  error estimate for blocks of size 2^( 7) =       0.000277208885
  error estimate for blocks of size 2^( 8) =       0.000277623446
  error estimate for blocks of size 2^( 9) =       0.000278970037

      target function =                  N/A
              le_mean =     -22.824374715819
             les_mean =     521.453037745861
             stat err =       0.000277371137
             autocorr =       1.269778725483
              std dev =       0.696213174756
             le_variance =       0.484712784704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484715270999
                                         uncertainty =       0.001243488577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484715270999
                                         uncertainty =       0.001243488577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246149175
  error estimate for blocks of size 2^( 2) =       0.000255344262
  error estimate for blocks of size 2^( 3) =       0.000263586988
  error estimate for blocks of size 2^( 4) =       0.000269617925
  error estimate for blocks of size 2^( 5) =       0.000273559219
  error estimate for blocks of size 2^( 6) =       0.000275681768
  error estimate for blocks of size 2^( 7) =       0.000277208482
  error estimate for blocks of size 2^( 8) =       0.000277622917
  error estimate for blocks of size 2^( 9) =       0.000278970370

      target function =                  N/A
              le_mean =     -22.824374527360
             les_mean =     521.453024447645
             stat err =       0.000277370884
             autocorr =       1.269769745696
              std dev =       0.696215001970
             le_variance =       0.484715328969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824374652899        initial
     2.4414e+00     2.4414e+01             8.2589e-05       -22.824374933565  <--
     9.7656e+00     9.7656e+01             2.2746e-05       -22.824374715819
     3.9062e+01     3.9062e+02             5.8353e-06       -22.824374527360

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 1.7453e+02
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.080709e-01 3 1  ON 0
ci_02                -2.195356e-02 3 1  ON 1
ci_03                -2.260687e-02 3 1  ON 2
ci_04                 2.170708e-02 3 1  ON 3
ci_05                -2.167205e-02 3 1  ON 4
ci_06                -2.148048e-02 3 1  ON 5
ci_07                 2.624974e-02 3 1  ON 6
ci_08                -3.505651e-03 3 1  ON 7
ci_09                -1.064944e-02 3 1  ON 8
ci_10                -1.107911e-02 3 1  ON 9
ci_11                 1.587134e-02 3 1  ON 10
ci_12                 1.057910e-02 3 1  ON 11
ci_13                 1.238664e-02 3 1  ON 12
ci_14                 1.689496e-02 3 1  ON 13
ci_15                 7.684295e-03 3 1  ON 14
ci_16                 7.384778e-03 3 1  ON 15
ci_17                -9.052589e-03 3 1  ON 16
ci_18                -8.734714e-03 3 1  ON 17
ci_19                 9.466191e-03 3 1  ON 18
ci_20                 1.075057e-02 3 1  ON 19
ci_21                 8.123273e-03 3 1  ON 20
ci_22                 8.341010e-03 3 1  ON 21
ci_23                 6.452978e-03 3 1  ON 22
ci_24                 7.593935e-03 3 1  ON 23
ci_25                 5.515785e-03 3 1  ON 24
ci_26                 2.718715e-03 3 1  ON 25
ci_27                 2.877268e-03 3 1  ON 26
ci_28                 3.079214e-03 3 1  ON 27
ci_29                 2.930738e-03 3 1  ON 28
ci_30                 6.937954e-04 3 1  ON 29
ci_31                 5.803456e-04 3 1  ON 30
ci_32                 3.836253e-04 3 1  ON 31
ci_33                 1.439342e-04 3 1  ON 32
ci_34                -1.833151e-05 3 1  ON 33
ci_35                 8.393321e-05 3 1  ON 34
ci_36                -3.405795e-04 3 1  ON 35
ci_37                -5.913288e-04 3 1  ON 36
ci_38                 1.809258e-04 3 1  ON 37
ci_39                -1.367890e-04 3 1  ON 38
ci_40                -1.324791e-03 3 1  ON 39
ci_41                -1.001985e-04 3 1  ON 40
ci_42                 4.717227e-05 3 1  ON 41
ci_43                -2.326249e-03 3 1  ON 42
ci_44                -2.436522e-03 3 1  ON 43
ci_45                -1.131431e-04 3 1  ON 44
ci_46                 9.657659e-05 3 1  ON 45
ci_47                 4.801267e-05 3 1  ON 46
ci_48                 2.196809e-04 3 1  ON 47
ci_49                -1.196889e-03 3 1  ON 48
ci_50                -6.129530e-04 3 1  ON 49
ci_51                -1.902993e-04 3 1  ON 50
ci_52                 1.166856e-04 3 1  ON 51
ci_53                -1.087188e-03 3 1  ON 52
ci_54                -7.811265e-04 3 1  ON 53
ci_55                -8.096718e-04 3 1  ON 54
ci_56                 1.689745e-03 3 1  ON 55
ci_57                 1.531959e-03 3 1  ON 56
ci_58                -1.545732e-03 3 1  ON 57
ci_59                -1.319888e-03 3 1  ON 58
ci_60                 1.442999e-03 3 1  ON 59
ci_61                 2.023786e-03 3 1  ON 60
ci_62                -3.413369e-04 3 1  ON 61
ci_63                -2.329707e-04 3 1  ON 62
ci_64                -5.406368e-04 3 1  ON 63
ci_65                -5.135379e-04 3 1  ON 64
ci_66                -2.302909e-04 3 1  ON 65
ci_67                -4.307798e-04 3 1  ON 66
ci_68                -1.382789e-03 3 1  ON 67
ci_69                -1.814080e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9316e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8859
    reference variance = 0.443021
====================================================
  Execution time = 1.0142e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1376e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0466e-01
  Total weights = 7.857448265e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8449e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486688556827
                                         uncertainty =       0.001553520461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486688556827
                                         uncertainty =       0.001553520461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246650050
  error estimate for blocks of size 2^( 2) =       0.000255810373
  error estimate for blocks of size 2^( 3) =       0.000264116659
  error estimate for blocks of size 2^( 4) =       0.000270131328
  error estimate for blocks of size 2^( 5) =       0.000273855817
  error estimate for blocks of size 2^( 6) =       0.000275391032
  error estimate for blocks of size 2^( 7) =       0.000276309732
  error estimate for blocks of size 2^( 8) =       0.000277790674
  error estimate for blocks of size 2^( 9) =       0.000277461537

      target function =                  N/A
              le_mean =     -22.824045028355
             les_mean =     521.441688903166
             stat err =       0.000276738244
             autocorr =       1.258855687874
              std dev =       0.697631690333
             le_variance =       0.486689975357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282404502835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824045028350       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824045957935       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824045817702       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824045810840       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 2.221738e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824045028350       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824045318321       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824045261565       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824045256480       residual = 5.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 7.091663e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824045028350       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824045105629       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824045089517       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824045087589       residual = 6.18e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 1.904987e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1988e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.080927e-01 3 1  ON 0
ci_02                -2.196117e-02 3 1  ON 1
ci_03                -2.263530e-02 3 1  ON 2
ci_04                 2.170952e-02 3 1  ON 3
ci_05                -2.168390e-02 3 1  ON 4
ci_06                -2.152475e-02 3 1  ON 5
ci_07                 2.625468e-02 3 1  ON 6
ci_08                -3.488554e-03 3 1  ON 7
ci_09                -1.064105e-02 3 1  ON 8
ci_10                -1.108256e-02 3 1  ON 9
ci_11                 1.591689e-02 3 1  ON 10
ci_12                 1.055161e-02 3 1  ON 11
ci_13                 1.235043e-02 3 1  ON 12
ci_14                 1.691165e-02 3 1  ON 13
ci_15                 7.679300e-03 3 1  ON 14
ci_16                 7.413114e-03 3 1  ON 15
ci_17                -9.028282e-03 3 1  ON 16
ci_18                -8.752057e-03 3 1  ON 17
ci_19                 9.471430e-03 3 1  ON 18
ci_20                 1.074839e-02 3 1  ON 19
ci_21                 8.140565e-03 3 1  ON 20
ci_22                 8.342132e-03 3 1  ON 21
ci_23                 6.399513e-03 3 1  ON 22
ci_24                 7.601262e-03 3 1  ON 23
ci_25                 5.462850e-03 3 1  ON 24
ci_26                 2.679021e-03 3 1  ON 25
ci_27                 2.874067e-03 3 1  ON 26
ci_28                 3.095173e-03 3 1  ON 27
ci_29                 2.942763e-03 3 1  ON 28
ci_30                 7.084304e-04 3 1  ON 29
ci_31                 5.674868e-04 3 1  ON 30
ci_32                 3.626025e-04 3 1  ON 31
ci_33                 1.071307e-04 3 1  ON 32
ci_34                -4.190107e-05 3 1  ON 33
ci_35                 7.099359e-05 3 1  ON 34
ci_36                -3.014934e-04 3 1  ON 35
ci_37                -6.185522e-04 3 1  ON 36
ci_38                 1.100092e-04 3 1  ON 37
ci_39                -1.158811e-04 3 1  ON 38
ci_40                -1.255959e-03 3 1  ON 39
ci_41                -1.112756e-04 3 1  ON 40
ci_42                 3.652498e-05 3 1  ON 41
ci_43                -2.350944e-03 3 1  ON 42
ci_44                -2.472140e-03 3 1  ON 43
ci_45                -1.082526e-04 3 1  ON 44
ci_46                 9.577979e-05 3 1  ON 45
ci_47                 4.312736e-05 3 1  ON 46
ci_48                 1.939685e-04 3 1  ON 47
ci_49                -1.250602e-03 3 1  ON 48
ci_50                -5.970221e-04 3 1  ON 49
ci_51                -2.153388e-04 3 1  ON 50
ci_52                 1.058742e-04 3 1  ON 51
ci_53                -1.022839e-03 3 1  ON 52
ci_54                -8.068195e-04 3 1  ON 53
ci_55                -7.766506e-04 3 1  ON 54
ci_56                 1.658228e-03 3 1  ON 55
ci_57                 1.534115e-03 3 1  ON 56
ci_58                -1.550957e-03 3 1  ON 57
ci_59                -1.320705e-03 3 1  ON 58
ci_60                 1.452294e-03 3 1  ON 59
ci_61                 1.984274e-03 3 1  ON 60
ci_62                -3.005906e-04 3 1  ON 61
ci_63                -2.008177e-04 3 1  ON 62
ci_64                -5.553559e-04 3 1  ON 63
ci_65                -5.328947e-04 3 1  ON 64
ci_66                -2.620283e-04 3 1  ON 65
ci_67                -4.143251e-04 3 1  ON 66
ci_68                -1.424467e-03 3 1  ON 67
ci_69                -1.837590e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6926
    reference variance = 0.539107
====================================================
  Execution time = 9.8822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0257e-01
  Total weights = 7.8558e+06
  Execution time = 1.4305e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485782785995
                                         uncertainty =       0.001854948605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485782785995
                                         uncertainty =       0.001854948605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419720
  error estimate for blocks of size 2^( 2) =       0.000255538620
  error estimate for blocks of size 2^( 3) =       0.000263749080
  error estimate for blocks of size 2^( 4) =       0.000269629827
  error estimate for blocks of size 2^( 5) =       0.000273046701
  error estimate for blocks of size 2^( 6) =       0.000275012690
  error estimate for blocks of size 2^( 7) =       0.000275705891
  error estimate for blocks of size 2^( 8) =       0.000276398832
  error estimate for blocks of size 2^( 9) =       0.000275229953

      target function =                  N/A
              le_mean =     -22.824614539497
             les_mean =     521.465913742521
             stat err =       0.000275586842
             autocorr =       1.250737108395
              std dev =       0.696980220774
             le_variance =       0.485781428151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485778573831
                                         uncertainty =       0.001859578184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485778573831
                                         uncertainty =       0.001859578184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246418654
  error estimate for blocks of size 2^( 2) =       0.000255536586
  error estimate for blocks of size 2^( 3) =       0.000263746428
  error estimate for blocks of size 2^( 4) =       0.000269626288
  error estimate for blocks of size 2^( 5) =       0.000273041235
  error estimate for blocks of size 2^( 6) =       0.000275006364
  error estimate for blocks of size 2^( 7) =       0.000275699747
  error estimate for blocks of size 2^( 8) =       0.000276391498
  error estimate for blocks of size 2^( 9) =       0.000275223270

      target function =                  N/A
              le_mean =     -22.824615743122
             les_mean =     521.465920851617
             stat err =       0.000275580220
             autocorr =       1.250687829240
              std dev =       0.696977203816
             le_variance =       0.485777222640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776056159
                                         uncertainty =       0.001856684152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485776056159
                                         uncertainty =       0.001856684152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246418014
  error estimate for blocks of size 2^( 2) =       0.000255536357
  error estimate for blocks of size 2^( 3) =       0.000263746552
  error estimate for blocks of size 2^( 4) =       0.000269626709
  error estimate for blocks of size 2^( 5) =       0.000273042451
  error estimate for blocks of size 2^( 6) =       0.000275008075
  error estimate for blocks of size 2^( 7) =       0.000275701084
  error estimate for blocks of size 2^( 8) =       0.000276393413
  error estimate for blocks of size 2^( 9) =       0.000275224931

      target function =                  N/A
              le_mean =     -22.824614975652
             les_mean =     521.467941156565
             stat err =       0.000275581876
             autocorr =       1.250709349810
              std dev =       0.696975395711
             le_variance =       0.485774702226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485781362232
                                         uncertainty =       0.001855134288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485781362232
                                         uncertainty =       0.001855134288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419359
  error estimate for blocks of size 2^( 2) =       0.000255538192
  error estimate for blocks of size 2^( 3) =       0.000263748622
  error estimate for blocks of size 2^( 4) =       0.000269629300
  error estimate for blocks of size 2^( 5) =       0.000273046058
  error estimate for blocks of size 2^( 6) =       0.000275011992
  error estimate for blocks of size 2^( 7) =       0.000275705140
  error estimate for blocks of size 2^( 8) =       0.000276398019
  error estimate for blocks of size 2^( 9) =       0.000275229210

      target function =                  N/A
              le_mean =     -22.824614549041
             les_mean =     521.465845694744
             stat err =       0.000275586090
             autocorr =       1.250733952950
              std dev =       0.696979199761
             le_variance =       0.485780004900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824614539497        initial
     6.1035e-01     6.1035e+00             2.2217e-04       -22.824615743122  <--
     2.4414e+00     2.4414e+01             7.0917e-05       -22.824614975652
     9.7656e+00     9.7656e+01             1.9050e-05       -22.824614549041

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 1.7051e+02
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.081474e-01 3 1  ON 0
ci_02                -2.197634e-02 3 1  ON 1
ci_03                -2.270152e-02 3 1  ON 2
ci_04                 2.171087e-02 3 1  ON 3
ci_05                -2.170945e-02 3 1  ON 4
ci_06                -2.163078e-02 3 1  ON 5
ci_07                 2.626608e-02 3 1  ON 6
ci_08                -3.456239e-03 3 1  ON 7
ci_09                -1.062108e-02 3 1  ON 8
ci_10                -1.109137e-02 3 1  ON 9
ci_11                 1.602571e-02 3 1  ON 10
ci_12                 1.048824e-02 3 1  ON 11
ci_13                 1.226073e-02 3 1  ON 12
ci_14                 1.695619e-02 3 1  ON 13
ci_15                 7.667378e-03 3 1  ON 14
ci_16                 7.481923e-03 3 1  ON 15
ci_17                -8.969398e-03 3 1  ON 16
ci_18                -8.792617e-03 3 1  ON 17
ci_19                 9.480586e-03 3 1  ON 18
ci_20                 1.074732e-02 3 1  ON 19
ci_21                 8.181710e-03 3 1  ON 20
ci_22                 8.341516e-03 3 1  ON 21
ci_23                 6.287443e-03 3 1  ON 22
ci_24                 7.617577e-03 3 1  ON 23
ci_25                 5.346601e-03 3 1  ON 24
ci_26                 2.582879e-03 3 1  ON 25
ci_27                 2.866070e-03 3 1  ON 26
ci_28                 3.131596e-03 3 1  ON 27
ci_29                 2.969749e-03 3 1  ON 28
ci_30                 7.430939e-04 3 1  ON 29
ci_31                 5.334272e-04 3 1  ON 30
ci_32                 3.183336e-04 3 1  ON 31
ci_33                 2.827745e-05 3 1  ON 32
ci_34                -9.767862e-05 3 1  ON 33
ci_35                 4.216492e-05 3 1  ON 34
ci_36                -2.161787e-04 3 1  ON 35
ci_37                -6.792047e-04 3 1  ON 36
ci_38                -4.124791e-05 3 1  ON 37
ci_39                -7.236227e-05 3 1  ON 38
ci_40                -1.126526e-03 3 1  ON 39
ci_41                -1.364496e-04 3 1  ON 40
ci_42                 1.305101e-05 3 1  ON 41
ci_43                -2.410140e-03 3 1  ON 42
ci_44                -2.556021e-03 3 1  ON 43
ci_45                -9.533900e-05 3 1  ON 44
ci_46                 9.272024e-05 3 1  ON 45
ci_47                 3.190553e-05 3 1  ON 46
ci_48                 1.317446e-04 3 1  ON 47
ci_49                -1.363697e-03 3 1  ON 48
ci_50                -5.683143e-04 3 1  ON 49
ci_51                -2.664415e-04 3 1  ON 50
ci_52                 8.384177e-05 3 1  ON 51
ci_53                -8.984279e-04 3 1  ON 52
ci_54                -8.683434e-04 3 1  ON 53
ci_55                -6.998018e-04 3 1  ON 54
ci_56                 1.591061e-03 3 1  ON 55
ci_57                 1.538241e-03 3 1  ON 56
ci_58                -1.563340e-03 3 1  ON 57
ci_59                -1.322320e-03 3 1  ON 58
ci_60                 1.478113e-03 3 1  ON 59
ci_61                 1.876636e-03 3 1  ON 60
ci_62                -2.217934e-04 3 1  ON 61
ci_63                -1.391443e-04 3 1  ON 62
ci_64                -5.857785e-04 3 1  ON 63
ci_65                -5.737941e-04 3 1  ON 64
ci_66                -3.294008e-04 3 1  ON 65
ci_67                -3.798599e-04 3 1  ON 66
ci_68                -1.514646e-03 3 1  ON 67
ci_69                -1.887111e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7507
    reference variance = 0.821828
====================================================
  Execution time = 1.0160e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1411e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1009e-01
  Total weights = 7.856674772e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8442e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489608514859
                                         uncertainty =       0.002414256113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489608514859
                                         uncertainty =       0.002414256113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247388697
  error estimate for blocks of size 2^( 2) =       0.000256596131
  error estimate for blocks of size 2^( 3) =       0.000264769330
  error estimate for blocks of size 2^( 4) =       0.000270508790
  error estimate for blocks of size 2^( 5) =       0.000273920532
  error estimate for blocks of size 2^( 6) =       0.000275607443
  error estimate for blocks of size 2^( 7) =       0.000277080388
  error estimate for blocks of size 2^( 8) =       0.000278400442
  error estimate for blocks of size 2^( 9) =       0.000277585482

      target function =                  N/A
              le_mean =     -22.824906033772
             les_mean =     521.486422030138
             stat err =       0.000277168439
             autocorr =       1.255243106175
              std dev =       0.699720900782
             le_variance =       0.489609338992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282490603377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824906033762       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824911461928       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824911502979       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824911589368       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 5.897558e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824906033762       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824908424544       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824908451520       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.021237e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824906033762       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824906772059       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824906789341       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.015782e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2006e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.082444e-01 3 1  ON 0
ci_02                -2.185876e-02 3 1  ON 1
ci_03                -2.245982e-02 3 1  ON 2
ci_04                 2.187664e-02 3 1  ON 3
ci_05                -2.153819e-02 3 1  ON 4
ci_06                -2.153217e-02 3 1  ON 5
ci_07                 2.612429e-02 3 1  ON 6
ci_08                -3.506384e-03 3 1  ON 7
ci_09                -1.054134e-02 3 1  ON 8
ci_10                -1.109446e-02 3 1  ON 9
ci_11                 1.601738e-02 3 1  ON 10
ci_12                 1.065831e-02 3 1  ON 11
ci_13                 1.222324e-02 3 1  ON 12
ci_14                 1.688022e-02 3 1  ON 13
ci_15                 7.639206e-03 3 1  ON 14
ci_16                 7.546375e-03 3 1  ON 15
ci_17                -8.883415e-03 3 1  ON 16
ci_18                -8.925432e-03 3 1  ON 17
ci_19                 9.564045e-03 3 1  ON 18
ci_20                 1.066689e-02 3 1  ON 19
ci_21                 8.098232e-03 3 1  ON 20
ci_22                 8.371980e-03 3 1  ON 21
ci_23                 6.387191e-03 3 1  ON 22
ci_24                 7.580256e-03 3 1  ON 23
ci_25                 5.232672e-03 3 1  ON 24
ci_26                 2.618153e-03 3 1  ON 25
ci_27                 2.762729e-03 3 1  ON 26
ci_28                 3.174874e-03 3 1  ON 27
ci_29                 2.918794e-03 3 1  ON 28
ci_30                 7.462053e-04 3 1  ON 29
ci_31                 6.807122e-04 3 1  ON 30
ci_32                 4.882934e-04 3 1  ON 31
ci_33                 5.226599e-06 3 1  ON 32
ci_34                -1.773314e-04 3 1  ON 33
ci_35                 1.863655e-04 3 1  ON 34
ci_36                -2.415483e-04 3 1  ON 35
ci_37                -6.621746e-04 3 1  ON 36
ci_38                -3.833769e-05 3 1  ON 37
ci_39                -1.282916e-04 3 1  ON 38
ci_40                -1.053421e-03 3 1  ON 39
ci_41                -2.204425e-05 3 1  ON 40
ci_42                 3.476582e-05 3 1  ON 41
ci_43                -2.608453e-03 3 1  ON 42
ci_44                -2.513762e-03 3 1  ON 43
ci_45                -9.156852e-07 3 1  ON 44
ci_46                -2.567929e-05 3 1  ON 45
ci_47                 1.288184e-05 3 1  ON 46
ci_48                 2.854511e-04 3 1  ON 47
ci_49                -1.121553e-03 3 1  ON 48
ci_50                -4.850397e-04 3 1  ON 49
ci_51                -3.367636e-04 3 1  ON 50
ci_52                 1.307444e-04 3 1  ON 51
ci_53                -9.771914e-04 3 1  ON 52
ci_54                -8.064666e-04 3 1  ON 53
ci_55                -8.684225e-04 3 1  ON 54
ci_56                 1.639634e-03 3 1  ON 55
ci_57                 1.670374e-03 3 1  ON 56
ci_58                -1.478204e-03 3 1  ON 57
ci_59                -1.444644e-03 3 1  ON 58
ci_60                 1.433321e-03 3 1  ON 59
ci_61                 1.800217e-03 3 1  ON 60
ci_62                -5.239171e-04 3 1  ON 61
ci_63                -1.531965e-04 3 1  ON 62
ci_64                -6.855336e-04 3 1  ON 63
ci_65                -5.429524e-04 3 1  ON 64
ci_66                -3.002976e-04 3 1  ON 65
ci_67                -3.029417e-04 3 1  ON 66
ci_68                -1.504472e-03 3 1  ON 67
ci_69                -1.896983e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8634
    reference variance = 0.464332
====================================================
  Execution time = 9.8995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0877e-01
  Total weights = 7.8571e+06
  Execution time = 1.4320e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487238650332
                                         uncertainty =       0.001591212362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487238650332
                                         uncertainty =       0.001591212362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246788826
  error estimate for blocks of size 2^( 2) =       0.000255932843
  error estimate for blocks of size 2^( 3) =       0.000264222182
  error estimate for blocks of size 2^( 4) =       0.000270145678
  error estimate for blocks of size 2^( 5) =       0.000273483968
  error estimate for blocks of size 2^( 6) =       0.000275461547
  error estimate for blocks of size 2^( 7) =       0.000276663402
  error estimate for blocks of size 2^( 8) =       0.000277143544
  error estimate for blocks of size 2^( 9) =       0.000277586904

      target function =                  N/A
              le_mean =     -22.824673282704
             les_mean =     521.478891942517
             stat err =       0.000276713849
             autocorr =       1.257218631430
              std dev =       0.698024209008
             le_variance =       0.487237796362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487150536036
                                         uncertainty =       0.001551728559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487150536036
                                         uncertainty =       0.001551728559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246766542
  error estimate for blocks of size 2^( 2) =       0.000255913198
  error estimate for blocks of size 2^( 3) =       0.000264205502
  error estimate for blocks of size 2^( 4) =       0.000270134674
  error estimate for blocks of size 2^( 5) =       0.000273477461
  error estimate for blocks of size 2^( 6) =       0.000275462056
  error estimate for blocks of size 2^( 7) =       0.000276667417
  error estimate for blocks of size 2^( 8) =       0.000277153413
  error estimate for blocks of size 2^( 9) =       0.000277585152

      target function =                  N/A
              le_mean =     -22.824673670594
             les_mean =     521.487278373325
             stat err =       0.000276717009
             autocorr =       1.257474428090
              std dev =       0.697961179564
             le_variance =       0.487149808178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487147830131
                                         uncertainty =       0.001555656206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487147830131
                                         uncertainty =       0.001555656206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246765853
  error estimate for blocks of size 2^( 2) =       0.000255912532
  error estimate for blocks of size 2^( 3) =       0.000264204620
  error estimate for blocks of size 2^( 4) =       0.000270132441
  error estimate for blocks of size 2^( 5) =       0.000273475072
  error estimate for blocks of size 2^( 6) =       0.000275457606
  error estimate for blocks of size 2^( 7) =       0.000276661930
  error estimate for blocks of size 2^( 8) =       0.000277152223
  error estimate for blocks of size 2^( 9) =       0.000277587602

      target function =                  N/A
              le_mean =     -22.824674164351
             les_mean =     521.475979740650
             stat err =       0.000276714840
             autocorr =       1.257461733921
              std dev =       0.697959231599
             le_variance =       0.487147088974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487216343889
                                         uncertainty =       0.001585130549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487216343889
                                         uncertainty =       0.001585130549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246783181
  error estimate for blocks of size 2^( 2) =       0.000255927598
  error estimate for blocks of size 2^( 3) =       0.000264217501
  error estimate for blocks of size 2^( 4) =       0.000270141551
  error estimate for blocks of size 2^( 5) =       0.000273480484
  error estimate for blocks of size 2^( 6) =       0.000275458867
  error estimate for blocks of size 2^( 7) =       0.000276660743
  error estimate for blocks of size 2^( 8) =       0.000277143603
  error estimate for blocks of size 2^( 9) =       0.000277584113

      target function =                  N/A
              le_mean =     -22.824672962275
             les_mean =     521.476361918942
             stat err =       0.000276711831
             autocorr =       1.257257809765
              std dev =       0.698008242924
             le_variance =       0.487215507190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824673282704        initial
     1.5259e-01     1.5259e+00             5.8976e-04       -22.824673670594
     6.1035e-01     6.1035e+00             3.0212e-04       -22.824674164351  <--
     2.4414e+00     2.4414e+01             1.0158e-04       -22.824672962275

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 1.7094e+02
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.082444e-01 3 1  ON 0
ci_02                -2.185876e-02 3 1  ON 1
ci_03                -2.245982e-02 3 1  ON 2
ci_04                 2.187664e-02 3 1  ON 3
ci_05                -2.153819e-02 3 1  ON 4
ci_06                -2.153217e-02 3 1  ON 5
ci_07                 2.612429e-02 3 1  ON 6
ci_08                -3.506384e-03 3 1  ON 7
ci_09                -1.054134e-02 3 1  ON 8
ci_10                -1.109446e-02 3 1  ON 9
ci_11                 1.601738e-02 3 1  ON 10
ci_12                 1.065831e-02 3 1  ON 11
ci_13                 1.222324e-02 3 1  ON 12
ci_14                 1.688022e-02 3 1  ON 13
ci_15                 7.639206e-03 3 1  ON 14
ci_16                 7.546375e-03 3 1  ON 15
ci_17                -8.883415e-03 3 1  ON 16
ci_18                -8.925432e-03 3 1  ON 17
ci_19                 9.564045e-03 3 1  ON 18
ci_20                 1.066689e-02 3 1  ON 19
ci_21                 8.098232e-03 3 1  ON 20
ci_22                 8.371980e-03 3 1  ON 21
ci_23                 6.387191e-03 3 1  ON 22
ci_24                 7.580256e-03 3 1  ON 23
ci_25                 5.232672e-03 3 1  ON 24
ci_26                 2.618153e-03 3 1  ON 25
ci_27                 2.762729e-03 3 1  ON 26
ci_28                 3.174874e-03 3 1  ON 27
ci_29                 2.918794e-03 3 1  ON 28
ci_30                 7.462053e-04 3 1  ON 29
ci_31                 6.807122e-04 3 1  ON 30
ci_32                 4.882934e-04 3 1  ON 31
ci_33                 5.226599e-06 3 1  ON 32
ci_34                -1.773314e-04 3 1  ON 33
ci_35                 1.863655e-04 3 1  ON 34
ci_36                -2.415483e-04 3 1  ON 35
ci_37                -6.621746e-04 3 1  ON 36
ci_38                -3.833769e-05 3 1  ON 37
ci_39                -1.282916e-04 3 1  ON 38
ci_40                -1.053421e-03 3 1  ON 39
ci_41                -2.204425e-05 3 1  ON 40
ci_42                 3.476582e-05 3 1  ON 41
ci_43                -2.608453e-03 3 1  ON 42
ci_44                -2.513762e-03 3 1  ON 43
ci_45                -9.156852e-07 3 1  ON 44
ci_46                -2.567929e-05 3 1  ON 45
ci_47                 1.288184e-05 3 1  ON 46
ci_48                 2.854511e-04 3 1  ON 47
ci_49                -1.121553e-03 3 1  ON 48
ci_50                -4.850397e-04 3 1  ON 49
ci_51                -3.367636e-04 3 1  ON 50
ci_52                 1.307444e-04 3 1  ON 51
ci_53                -9.771914e-04 3 1  ON 52
ci_54                -8.064666e-04 3 1  ON 53
ci_55                -8.684225e-04 3 1  ON 54
ci_56                 1.639634e-03 3 1  ON 55
ci_57                 1.670374e-03 3 1  ON 56
ci_58                -1.478204e-03 3 1  ON 57
ci_59                -1.444644e-03 3 1  ON 58
ci_60                 1.433321e-03 3 1  ON 59
ci_61                 1.800217e-03 3 1  ON 60
ci_62                -5.239171e-04 3 1  ON 61
ci_63                -1.531965e-04 3 1  ON 62
ci_64                -6.855336e-04 3 1  ON 63
ci_65                -5.429524e-04 3 1  ON 64
ci_66                -3.002976e-04 3 1  ON 65
ci_67                -3.029417e-04 3 1  ON 66
ci_68                -1.504472e-03 3 1  ON 67
ci_69                -1.896983e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9101e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8115
    reference variance = 0.315929
====================================================
  Execution time = 1.0145e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1359e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0364e-01
  Total weights = 7.857409106e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8459e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486196590108
                                         uncertainty =       0.001239987862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486196590108
                                         uncertainty =       0.001239987862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246524775
  error estimate for blocks of size 2^( 2) =       0.000255745082
  error estimate for blocks of size 2^( 3) =       0.000264042058
  error estimate for blocks of size 2^( 4) =       0.000269952051
  error estimate for blocks of size 2^( 5) =       0.000273559350
  error estimate for blocks of size 2^( 6) =       0.000275705473
  error estimate for blocks of size 2^( 7) =       0.000276812909
  error estimate for blocks of size 2^( 8) =       0.000277194291
  error estimate for blocks of size 2^( 9) =       0.000277587702

      target function =                  N/A
              le_mean =     -22.824734670138
             les_mean =     521.472152060036
             stat err =       0.000276825094
             autocorr =       1.260926495311
              std dev =       0.697277359743
             le_variance =       0.486195716410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282473467014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824734670127       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824740050080       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824740058706       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824740138823       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 6.137302e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824734670127       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824737048002       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824737061882       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824737070886       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 2.893126e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824734670127       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824735405844       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824735418088       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824735416527       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 9.278910e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1992e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.083702e-01 3 1  ON 0
ci_02                -2.193981e-02 3 1  ON 1
ci_03                -2.229814e-02 3 1  ON 2
ci_04                 2.195085e-02 3 1  ON 3
ci_05                -2.157460e-02 3 1  ON 4
ci_06                -2.157473e-02 3 1  ON 5
ci_07                 2.611021e-02 3 1  ON 6
ci_08                -3.559418e-03 3 1  ON 7
ci_09                -1.053550e-02 3 1  ON 8
ci_10                -1.097412e-02 3 1  ON 9
ci_11                 1.617213e-02 3 1  ON 10
ci_12                 1.070012e-02 3 1  ON 11
ci_13                 1.210576e-02 3 1  ON 12
ci_14                 1.692292e-02 3 1  ON 13
ci_15                 7.621178e-03 3 1  ON 14
ci_16                 7.518786e-03 3 1  ON 15
ci_17                -8.995075e-03 3 1  ON 16
ci_18                -9.007628e-03 3 1  ON 17
ci_19                 9.507546e-03 3 1  ON 18
ci_20                 1.070815e-02 3 1  ON 19
ci_21                 8.313187e-03 3 1  ON 20
ci_22                 8.284857e-03 3 1  ON 21
ci_23                 6.632503e-03 3 1  ON 22
ci_24                 7.669231e-03 3 1  ON 23
ci_25                 5.240004e-03 3 1  ON 24
ci_26                 2.584448e-03 3 1  ON 25
ci_27                 2.880661e-03 3 1  ON 26
ci_28                 3.120102e-03 3 1  ON 27
ci_29                 2.733755e-03 3 1  ON 28
ci_30                 7.131265e-04 3 1  ON 29
ci_31                 6.221135e-04 3 1  ON 30
ci_32                 3.009789e-04 3 1  ON 31
ci_33                 8.130673e-05 3 1  ON 32
ci_34                -1.366908e-04 3 1  ON 33
ci_35                 1.295831e-04 3 1  ON 34
ci_36                -3.885269e-04 3 1  ON 35
ci_37                -6.349061e-04 3 1  ON 36
ci_38                 1.189561e-04 3 1  ON 37
ci_39                 7.422012e-06 3 1  ON 38
ci_40                -1.099662e-03 3 1  ON 39
ci_41                -9.812356e-05 3 1  ON 40
ci_42                 3.870269e-05 3 1  ON 41
ci_43                -2.623353e-03 3 1  ON 42
ci_44                -2.463005e-03 3 1  ON 43
ci_45                -8.909543e-06 3 1  ON 44
ci_46                -1.329725e-04 3 1  ON 45
ci_47                -1.786798e-04 3 1  ON 46
ci_48                 3.639503e-04 3 1  ON 47
ci_49                -1.304677e-03 3 1  ON 48
ci_50                -4.942908e-04 3 1  ON 49
ci_51                -3.442688e-04 3 1  ON 50
ci_52                 1.968160e-05 3 1  ON 51
ci_53                -8.275120e-04 3 1  ON 52
ci_54                -7.855053e-04 3 1  ON 53
ci_55                -6.726830e-04 3 1  ON 54
ci_56                 1.626989e-03 3 1  ON 55
ci_57                 1.381062e-03 3 1  ON 56
ci_58                -1.384957e-03 3 1  ON 57
ci_59                -1.447043e-03 3 1  ON 58
ci_60                 1.550038e-03 3 1  ON 59
ci_61                 1.804221e-03 3 1  ON 60
ci_62                -5.970527e-04 3 1  ON 61
ci_63                -8.842791e-05 3 1  ON 62
ci_64                -6.652615e-04 3 1  ON 63
ci_65                -4.812774e-04 3 1  ON 64
ci_66                -3.972202e-04 3 1  ON 65
ci_67                -4.242621e-04 3 1  ON 66
ci_68                -1.561072e-03 3 1  ON 67
ci_69                -1.721169e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.75
    reference variance = 0.41508
====================================================
  Execution time = 9.8546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0144e-01
  Total weights = 7.8565e+06
  Execution time = 1.4244e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486247200303
                                         uncertainty =       0.001152075726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486247200303
                                         uncertainty =       0.001152075726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246538197
  error estimate for blocks of size 2^( 2) =       0.000255729975
  error estimate for blocks of size 2^( 3) =       0.000263981671
  error estimate for blocks of size 2^( 4) =       0.000269756240
  error estimate for blocks of size 2^( 5) =       0.000272978610
  error estimate for blocks of size 2^( 6) =       0.000274899382
  error estimate for blocks of size 2^( 7) =       0.000276213047
  error estimate for blocks of size 2^( 8) =       0.000276772355
  error estimate for blocks of size 2^( 9) =       0.000276377473

      target function =                  N/A
              le_mean =     -22.824896892558
             les_mean =     521.478446692264
             stat err =       0.000276065564
             autocorr =       1.253880198429
              std dev =       0.697315322836
             le_variance =       0.486248659461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486301589546
                                         uncertainty =       0.001153757888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486301589546
                                         uncertainty =       0.001153757888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246551982
  error estimate for blocks of size 2^( 2) =       0.000255739950
  error estimate for blocks of size 2^( 3) =       0.000263987769
  error estimate for blocks of size 2^( 4) =       0.000269759118
  error estimate for blocks of size 2^( 5) =       0.000272979141
  error estimate for blocks of size 2^( 6) =       0.000274898780
  error estimate for blocks of size 2^( 7) =       0.000276217510
  error estimate for blocks of size 2^( 8) =       0.000276790580
  error estimate for blocks of size 2^( 9) =       0.000276401895

      target function =                  N/A
              le_mean =     -22.824898180012
             les_mean =     521.522658872774
             stat err =       0.000276077191
             autocorr =       1.253845603920
              std dev =       0.697354312381
             le_variance =       0.486303036996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486272290115
                                         uncertainty =       0.001152423062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486272290115
                                         uncertainty =       0.001152423062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246544554
  error estimate for blocks of size 2^( 2) =       0.000255732925
  error estimate for blocks of size 2^( 3) =       0.000263980819
  error estimate for blocks of size 2^( 4) =       0.000269752685
  error estimate for blocks of size 2^( 5) =       0.000272973378
  error estimate for blocks of size 2^( 6) =       0.000274893937
  error estimate for blocks of size 2^( 7) =       0.000276209919
  error estimate for blocks of size 2^( 8) =       0.000276775524
  error estimate for blocks of size 2^( 9) =       0.000276384565

      target function =                  N/A
              le_mean =     -22.824898812409
             les_mean =     521.483033663209
             stat err =       0.000276065986
             autocorr =       1.253819369014
              std dev =       0.697333303805
             le_variance =       0.486273736595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486244934684
                                         uncertainty =       0.001152076788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486244934684
                                         uncertainty =       0.001152076788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246537622
  error estimate for blocks of size 2^( 2) =       0.000255728834
  error estimate for blocks of size 2^( 3) =       0.000263979990
  error estimate for blocks of size 2^( 4) =       0.000269754180
  error estimate for blocks of size 2^( 5) =       0.000272976393
  error estimate for blocks of size 2^( 6) =       0.000274897469
  error estimate for blocks of size 2^( 7) =       0.000276211146
  error estimate for blocks of size 2^( 8) =       0.000276771898
  error estimate for blocks of size 2^( 9) =       0.000276375278

      target function =                  N/A
              le_mean =     -22.824896314000
             les_mean =     521.479010396154
             stat err =       0.000276063948
             autocorr =       1.253871364534
              std dev =       0.697313696806
             le_variance =       0.486246391753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824896892558        initial
     1.5259e-01     1.5259e+00             6.1373e-04       -22.824898180012
     6.1035e-01     6.1035e+00             2.8931e-04       -22.824898812409  <--
     2.4414e+00     2.4414e+01             9.2789e-05       -22.824896314000

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 1.7082e+02
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.083702e-01 3 1  ON 0
ci_02                -2.193981e-02 3 1  ON 1
ci_03                -2.229814e-02 3 1  ON 2
ci_04                 2.195085e-02 3 1  ON 3
ci_05                -2.157460e-02 3 1  ON 4
ci_06                -2.157473e-02 3 1  ON 5
ci_07                 2.611021e-02 3 1  ON 6
ci_08                -3.559418e-03 3 1  ON 7
ci_09                -1.053550e-02 3 1  ON 8
ci_10                -1.097412e-02 3 1  ON 9
ci_11                 1.617213e-02 3 1  ON 10
ci_12                 1.070012e-02 3 1  ON 11
ci_13                 1.210576e-02 3 1  ON 12
ci_14                 1.692292e-02 3 1  ON 13
ci_15                 7.621178e-03 3 1  ON 14
ci_16                 7.518786e-03 3 1  ON 15
ci_17                -8.995075e-03 3 1  ON 16
ci_18                -9.007628e-03 3 1  ON 17
ci_19                 9.507546e-03 3 1  ON 18
ci_20                 1.070815e-02 3 1  ON 19
ci_21                 8.313187e-03 3 1  ON 20
ci_22                 8.284857e-03 3 1  ON 21
ci_23                 6.632503e-03 3 1  ON 22
ci_24                 7.669231e-03 3 1  ON 23
ci_25                 5.240004e-03 3 1  ON 24
ci_26                 2.584448e-03 3 1  ON 25
ci_27                 2.880661e-03 3 1  ON 26
ci_28                 3.120102e-03 3 1  ON 27
ci_29                 2.733755e-03 3 1  ON 28
ci_30                 7.131265e-04 3 1  ON 29
ci_31                 6.221135e-04 3 1  ON 30
ci_32                 3.009789e-04 3 1  ON 31
ci_33                 8.130673e-05 3 1  ON 32
ci_34                -1.366908e-04 3 1  ON 33
ci_35                 1.295831e-04 3 1  ON 34
ci_36                -3.885269e-04 3 1  ON 35
ci_37                -6.349061e-04 3 1  ON 36
ci_38                 1.189561e-04 3 1  ON 37
ci_39                 7.422012e-06 3 1  ON 38
ci_40                -1.099662e-03 3 1  ON 39
ci_41                -9.812356e-05 3 1  ON 40
ci_42                 3.870269e-05 3 1  ON 41
ci_43                -2.623353e-03 3 1  ON 42
ci_44                -2.463005e-03 3 1  ON 43
ci_45                -8.909543e-06 3 1  ON 44
ci_46                -1.329725e-04 3 1  ON 45
ci_47                -1.786798e-04 3 1  ON 46
ci_48                 3.639503e-04 3 1  ON 47
ci_49                -1.304677e-03 3 1  ON 48
ci_50                -4.942908e-04 3 1  ON 49
ci_51                -3.442688e-04 3 1  ON 50
ci_52                 1.968160e-05 3 1  ON 51
ci_53                -8.275120e-04 3 1  ON 52
ci_54                -7.855053e-04 3 1  ON 53
ci_55                -6.726830e-04 3 1  ON 54
ci_56                 1.626989e-03 3 1  ON 55
ci_57                 1.381062e-03 3 1  ON 56
ci_58                -1.384957e-03 3 1  ON 57
ci_59                -1.447043e-03 3 1  ON 58
ci_60                 1.550038e-03 3 1  ON 59
ci_61                 1.804221e-03 3 1  ON 60
ci_62                -5.970527e-04 3 1  ON 61
ci_63                -8.842791e-05 3 1  ON 62
ci_64                -6.652615e-04 3 1  ON 63
ci_65                -4.812774e-04 3 1  ON 64
ci_66                -3.972202e-04 3 1  ON 65
ci_67                -4.242621e-04 3 1  ON 66
ci_68                -1.561072e-03 3 1  ON 67
ci_69                -1.721169e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9075e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 0.365286
====================================================
  Execution time = 1.0132e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1387e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0166e-01
  Total weights = 7.857205209e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8403e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487207226484
                                         uncertainty =       0.001550655206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487207226484
                                         uncertainty =       0.001550655206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246780743
  error estimate for blocks of size 2^( 2) =       0.000255913223
  error estimate for blocks of size 2^( 3) =       0.000264078170
  error estimate for blocks of size 2^( 4) =       0.000270010379
  error estimate for blocks of size 2^( 5) =       0.000273388562
  error estimate for blocks of size 2^( 6) =       0.000275200536
  error estimate for blocks of size 2^( 7) =       0.000276659048
  error estimate for blocks of size 2^( 8) =       0.000277929039
  error estimate for blocks of size 2^( 9) =       0.000277316745

      target function =                  N/A
              le_mean =     -22.824853640308
             les_mean =     521.475606126603
             stat err =       0.000276776342
             autocorr =       1.257868953700
              std dev =       0.698001345956
             le_variance =       0.487205878956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282485364031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824853640300       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824854602173       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824854715511       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824854627992       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 5.880406e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824853640300       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824854065245       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824854059050       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824854074998       residual = 3.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 2.488096e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824853640300       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824853771746       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824853759799       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824853770771       residual = 4.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 7.537405e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052957 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1973e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.084880e-01 3 1  ON 0
ci_02                -2.193052e-02 3 1  ON 1
ci_03                -2.215639e-02 3 1  ON 2
ci_04                 2.180352e-02 3 1  ON 3
ci_05                -2.153532e-02 3 1  ON 4
ci_06                -2.154623e-02 3 1  ON 5
ci_07                 2.613651e-02 3 1  ON 6
ci_08                -3.517248e-03 3 1  ON 7
ci_09                -1.071640e-02 3 1  ON 8
ci_10                -1.097582e-02 3 1  ON 9
ci_11                 1.606637e-02 3 1  ON 10
ci_12                 1.087371e-02 3 1  ON 11
ci_13                 1.199252e-02 3 1  ON 12
ci_14                 1.691646e-02 3 1  ON 13
ci_15                 7.485971e-03 3 1  ON 14
ci_16                 7.476356e-03 3 1  ON 15
ci_17                -8.980407e-03 3 1  ON 16
ci_18                -8.981363e-03 3 1  ON 17
ci_19                 9.389427e-03 3 1  ON 18
ci_20                 1.061967e-02 3 1  ON 19
ci_21                 8.325309e-03 3 1  ON 20
ci_22                 8.319533e-03 3 1  ON 21
ci_23                 6.643837e-03 3 1  ON 22
ci_24                 7.746679e-03 3 1  ON 23
ci_25                 5.264800e-03 3 1  ON 24
ci_26                 2.761467e-03 3 1  ON 25
ci_27                 2.707863e-03 3 1  ON 26
ci_28                 3.078257e-03 3 1  ON 27
ci_29                 2.824230e-03 3 1  ON 28
ci_30                 7.664149e-04 3 1  ON 29
ci_31                 6.287297e-04 3 1  ON 30
ci_32                 2.791705e-04 3 1  ON 31
ci_33                -6.978731e-05 3 1  ON 32
ci_34                -3.226878e-05 3 1  ON 33
ci_35                 1.331452e-04 3 1  ON 34
ci_36                -4.958655e-04 3 1  ON 35
ci_37                -7.248457e-04 3 1  ON 36
ci_38                -1.876886e-05 3 1  ON 37
ci_39                -2.028430e-04 3 1  ON 38
ci_40                -1.126432e-03 3 1  ON 39
ci_41                 3.236436e-05 3 1  ON 40
ci_42                -4.899703e-05 3 1  ON 41
ci_43                -2.740322e-03 3 1  ON 42
ci_44                -2.317056e-03 3 1  ON 43
ci_45                -1.328698e-04 3 1  ON 44
ci_46                -1.733175e-04 3 1  ON 45
ci_47                -2.139195e-04 3 1  ON 46
ci_48                 3.643865e-04 3 1  ON 47
ci_49                -1.326479e-03 3 1  ON 48
ci_50                -3.016992e-04 3 1  ON 49
ci_51                -3.720678e-04 3 1  ON 50
ci_52                 1.367271e-04 3 1  ON 51
ci_53                -7.170571e-04 3 1  ON 52
ci_54                -8.082504e-04 3 1  ON 53
ci_55                -8.451500e-04 3 1  ON 54
ci_56                 1.652326e-03 3 1  ON 55
ci_57                 1.489360e-03 3 1  ON 56
ci_58                -1.514940e-03 3 1  ON 57
ci_59                -1.198233e-03 3 1  ON 58
ci_60                 1.496200e-03 3 1  ON 59
ci_61                 1.762456e-03 3 1  ON 60
ci_62                -6.046963e-04 3 1  ON 61
ci_63                -1.639180e-04 3 1  ON 62
ci_64                -5.143158e-04 3 1  ON 63
ci_65                -4.508345e-04 3 1  ON 64
ci_66                -3.525833e-04 3 1  ON 65
ci_67                -5.123655e-04 3 1  ON 66
ci_68                -1.354952e-03 3 1  ON 67
ci_69                -1.660442e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8367
    reference variance = 0.403703
====================================================
  Execution time = 9.8804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0147e-01
  Total weights = 7.8567e+06
  Execution time = 1.4338e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.227249
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485972270624
                                         uncertainty =       0.001690260263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485972270624
                                         uncertainty =       0.001690260263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246469118
  error estimate for blocks of size 2^( 2) =       0.000255607389
  error estimate for blocks of size 2^( 3) =       0.000263775545
  error estimate for blocks of size 2^( 4) =       0.000269902751
  error estimate for blocks of size 2^( 5) =       0.000273657119
  error estimate for blocks of size 2^( 6) =       0.000275628644
  error estimate for blocks of size 2^( 7) =       0.000276865522
  error estimate for blocks of size 2^( 8) =       0.000277017916
  error estimate for blocks of size 2^( 9) =       0.000277627474

      target function =                  N/A
              le_mean =     -22.824402379835
             les_mean =     521.456810801615
             stat err =       0.000276784889
             autocorr =       1.261129633177
              std dev =       0.697119938724
             le_variance =       0.485976208966

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0826742
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485990382528
                                         uncertainty =       0.001685849254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485990382528
                                         uncertainty =       0.001685849254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246473708
  error estimate for blocks of size 2^( 2) =       0.000255616022
  error estimate for blocks of size 2^( 3) =       0.000263786250
  error estimate for blocks of size 2^( 4) =       0.000269912660
  error estimate for blocks of size 2^( 5) =       0.000273666869
  error estimate for blocks of size 2^( 6) =       0.000275637736
  error estimate for blocks of size 2^( 7) =       0.000276877585
  error estimate for blocks of size 2^( 8) =       0.000277023187
  error estimate for blocks of size 2^( 9) =       0.000277622001

      target function =                  N/A
              le_mean =     -22.824402659123
             les_mean =     521.456982830416
             stat err =       0.000276790127
             autocorr =       1.261130391205
              std dev =       0.697132922220
             le_variance =       0.485994311243

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.235017
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485993635160
                                         uncertainty =       0.001688294777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485993635160
                                         uncertainty =       0.001688294777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246474535
  error estimate for blocks of size 2^( 2) =       0.000255616702
  error estimate for blocks of size 2^( 3) =       0.000263786964
  error estimate for blocks of size 2^( 4) =       0.000269912682
  error estimate for blocks of size 2^( 5) =       0.000273666005
  error estimate for blocks of size 2^( 6) =       0.000275637126
  error estimate for blocks of size 2^( 7) =       0.000276874579
  error estimate for blocks of size 2^( 8) =       0.000277025582
  error estimate for blocks of size 2^( 9) =       0.000277629188

      target function =                  N/A
              le_mean =     -22.824400256966
             les_mean =     521.495337363416
             stat err =       0.000276791619
             autocorr =       1.261135524757
              std dev =       0.697135259952
             le_variance =       0.485997570668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485967650726
                                         uncertainty =       0.001689871343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485967650726
                                         uncertainty =       0.001689871343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246467946
  error estimate for blocks of size 2^( 2) =       0.000255606752
  error estimate for blocks of size 2^( 3) =       0.000263775414
  error estimate for blocks of size 2^( 4) =       0.000269902401
  error estimate for blocks of size 2^( 5) =       0.000273656893
  error estimate for blocks of size 2^( 6) =       0.000275628498
  error estimate for blocks of size 2^( 7) =       0.000276865553
  error estimate for blocks of size 2^( 8) =       0.000277018427
  error estimate for blocks of size 2^( 9) =       0.000277626277

      target function =                  N/A
              le_mean =     -22.824401555997
             les_mean =     521.455811982601
             stat err =       0.000276784688
             autocorr =       1.261139797941
              std dev =       0.697116624306
             le_variance =       0.485971587884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824402379835        initial
     1.5259e-01     1.5259e+00             5.8804e-04       -22.824402659123  <--
     6.1035e-01     6.1035e+00             2.4881e-04       -22.824400256966
     2.4414e+00     2.4414e+01             7.5374e-05       -22.824401555997

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 1.7068e+02
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.087182e-01 3 1  ON 0
ci_02                -2.192499e-02 3 1  ON 1
ci_03                -2.193736e-02 3 1  ON 2
ci_04                 2.162847e-02 3 1  ON 3
ci_05                -2.149612e-02 3 1  ON 4
ci_06                -2.151052e-02 3 1  ON 5
ci_07                 2.620315e-02 3 1  ON 6
ci_08                -3.478304e-03 3 1  ON 7
ci_09                -1.103498e-02 3 1  ON 8
ci_10                -1.096927e-02 3 1  ON 9
ci_11                 1.592448e-02 3 1  ON 10
ci_12                 1.110547e-02 3 1  ON 11
ci_13                 1.180007e-02 3 1  ON 12
ci_14                 1.692206e-02 3 1  ON 13
ci_15                 7.281667e-03 3 1  ON 14
ci_16                 7.404663e-03 3 1  ON 15
ci_17                -8.951176e-03 3 1  ON 16
ci_18                -8.961204e-03 3 1  ON 17
ci_19                 9.251565e-03 3 1  ON 18
ci_20                 1.049407e-02 3 1  ON 19
ci_21                 8.327788e-03 3 1  ON 20
ci_22                 8.375344e-03 3 1  ON 21
ci_23                 6.653898e-03 3 1  ON 22
ci_24                 7.881054e-03 3 1  ON 23
ci_25                 5.299717e-03 3 1  ON 24
ci_26                 3.021700e-03 3 1  ON 25
ci_27                 2.456642e-03 3 1  ON 26
ci_28                 3.018478e-03 3 1  ON 27
ci_29                 2.957548e-03 3 1  ON 28
ci_30                 8.304797e-04 3 1  ON 29
ci_31                 6.205766e-04 3 1  ON 30
ci_32                 2.456389e-04 3 1  ON 31
ci_33                -2.500703e-04 3 1  ON 32
ci_34                 1.325451e-04 3 1  ON 33
ci_35                 1.277017e-04 3 1  ON 34
ci_36                -6.117374e-04 3 1  ON 35
ci_37                -8.042220e-04 3 1  ON 36
ci_38                -1.688761e-04 3 1  ON 37
ci_39                -4.296478e-04 3 1  ON 38
ci_40                -1.155506e-03 3 1  ON 39
ci_41                 1.794285e-04 3 1  ON 40
ci_42                -1.465535e-04 3 1  ON 41
ci_43                -2.912487e-03 3 1  ON 42
ci_44                -2.127909e-03 3 1  ON 43
ci_45                -2.668724e-04 3 1  ON 44
ci_46                -2.102013e-04 3 1  ON 45
ci_47                -2.712826e-04 3 1  ON 46
ci_48                 3.748893e-04 3 1  ON 47
ci_49                -1.359147e-03 3 1  ON 48
ci_50                -1.315564e-04 3 1  ON 49
ci_51                -4.013161e-04 3 1  ON 50
ci_52                 2.764852e-04 3 1  ON 51
ci_53                -6.140266e-04 3 1  ON 52
ci_54                -8.296512e-04 3 1  ON 53
ci_55                -1.079529e-03 3 1  ON 54
ci_56                 1.685200e-03 3 1  ON 55
ci_57                 1.607535e-03 3 1  ON 56
ci_58                -1.698898e-03 3 1  ON 57
ci_59                -8.590023e-04 3 1  ON 58
ci_60                 1.385686e-03 3 1  ON 59
ci_61                 1.667227e-03 3 1  ON 60
ci_62                -6.093431e-04 3 1  ON 61
ci_63                -2.312233e-04 3 1  ON 62
ci_64                -3.216856e-04 3 1  ON 63
ci_65                -4.084930e-04 3 1  ON 64
ci_66                -3.107210e-04 3 1  ON 65
ci_67                -6.227467e-04 3 1  ON 66
ci_68                -1.097994e-03 3 1  ON 67
ci_69                -1.588574e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8653
    reference variance = 0.401248
====================================================
  Execution time = 1.0175e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1398e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0518e-01
  Total weights = 7.856678235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8471e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487608153305
                                         uncertainty =       0.001777621570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487608153305
                                         uncertainty =       0.001777621570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246882265
  error estimate for blocks of size 2^( 2) =       0.000256076769
  error estimate for blocks of size 2^( 3) =       0.000264215412
  error estimate for blocks of size 2^( 4) =       0.000270138486
  error estimate for blocks of size 2^( 5) =       0.000273820696
  error estimate for blocks of size 2^( 6) =       0.000275598198
  error estimate for blocks of size 2^( 7) =       0.000276598269
  error estimate for blocks of size 2^( 8) =       0.000277344543
  error estimate for blocks of size 2^( 9) =       0.000276822794

      target function =                  N/A
              le_mean =     -22.824448282137
             les_mean =     521.460615606662
             stat err =       0.000276590951
             autocorr =       1.255151501672
              std dev =       0.698288494080
             le_variance =       0.487606820964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282444828214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824448282128       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824457684502       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824457517636       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824457508777       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824457412310       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824457438945       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.664194e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824448282128       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824454758616       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824454605912       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824454607422       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 7.634711e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824448282128       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824451167305       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824451170061       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.321426e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2023e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.087649e-01 3 1  ON 0
ci_02                -2.215742e-02 3 1  ON 1
ci_03                -2.172275e-02 3 1  ON 2
ci_04                 2.174788e-02 3 1  ON 3
ci_05                -2.134405e-02 3 1  ON 4
ci_06                -2.157524e-02 3 1  ON 5
ci_07                 2.591597e-02 3 1  ON 6
ci_08                -3.412204e-03 3 1  ON 7
ci_09                -1.100914e-02 3 1  ON 8
ci_10                -1.097661e-02 3 1  ON 9
ci_11                 1.576402e-02 3 1  ON 10
ci_12                 1.125459e-02 3 1  ON 11
ci_13                 1.183031e-02 3 1  ON 12
ci_14                 1.727921e-02 3 1  ON 13
ci_15                 7.705698e-03 3 1  ON 14
ci_16                 7.378413e-03 3 1  ON 15
ci_17                -8.446707e-03 3 1  ON 16
ci_18                -8.691574e-03 3 1  ON 17
ci_19                 9.864111e-03 3 1  ON 18
ci_20                 1.014756e-02 3 1  ON 19
ci_21                 8.144129e-03 3 1  ON 20
ci_22                 8.668226e-03 3 1  ON 21
ci_23                 6.636628e-03 3 1  ON 22
ci_24                 7.598769e-03 3 1  ON 23
ci_25                 5.441463e-03 3 1  ON 24
ci_26                 2.763689e-03 3 1  ON 25
ci_27                 2.585477e-03 3 1  ON 26
ci_28                 3.109167e-03 3 1  ON 27
ci_29                 2.766178e-03 3 1  ON 28
ci_30                 8.695393e-04 3 1  ON 29
ci_31                 4.234608e-04 3 1  ON 30
ci_32                 4.193940e-04 3 1  ON 31
ci_33                -3.947450e-04 3 1  ON 32
ci_34                -3.922563e-05 3 1  ON 33
ci_35                 1.579689e-05 3 1  ON 34
ci_36                -4.145264e-04 3 1  ON 35
ci_37                -3.581639e-04 3 1  ON 36
ci_38                -6.236978e-05 3 1  ON 37
ci_39                -2.085267e-04 3 1  ON 38
ci_40                -1.353038e-03 3 1  ON 39
ci_41                 4.518160e-05 3 1  ON 40
ci_42                 2.737937e-06 3 1  ON 41
ci_43                -2.803475e-03 3 1  ON 42
ci_44                -2.086088e-03 3 1  ON 43
ci_45                -1.941681e-04 3 1  ON 44
ci_46                -2.700827e-04 3 1  ON 45
ci_47                -3.051355e-04 3 1  ON 46
ci_48                 1.819354e-04 3 1  ON 47
ci_49                -1.344806e-03 3 1  ON 48
ci_50                -4.843853e-04 3 1  ON 49
ci_51                -1.978468e-04 3 1  ON 50
ci_52                 1.439491e-04 3 1  ON 51
ci_53                -1.101576e-03 3 1  ON 52
ci_54                -1.129473e-03 3 1  ON 53
ci_55                -1.038046e-03 3 1  ON 54
ci_56                 1.468875e-03 3 1  ON 55
ci_57                 1.892738e-03 3 1  ON 56
ci_58                -1.507996e-03 3 1  ON 57
ci_59                -1.095420e-03 3 1  ON 58
ci_60                 1.715404e-03 3 1  ON 59
ci_61                 2.430698e-03 3 1  ON 60
ci_62                -5.201232e-04 3 1  ON 61
ci_63                -2.779598e-05 3 1  ON 62
ci_64                -2.778555e-04 3 1  ON 63
ci_65                -2.237189e-04 3 1  ON 64
ci_66                -5.247864e-04 3 1  ON 65
ci_67                -5.315262e-04 3 1  ON 66
ci_68                -1.855700e-03 3 1  ON 67
ci_69                -1.467252e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.819
    reference variance = 0.32818
====================================================
  Execution time = 9.9028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0315e-01
  Total weights = 7.8561e+06
  Execution time = 1.4286e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00160142
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487569666571
                                         uncertainty =       0.001538394950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487569666571
                                         uncertainty =       0.001538394950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246872590
  error estimate for blocks of size 2^( 2) =       0.000255988180
  error estimate for blocks of size 2^( 3) =       0.000264072278
  error estimate for blocks of size 2^( 4) =       0.000269952061
  error estimate for blocks of size 2^( 5) =       0.000273668413
  error estimate for blocks of size 2^( 6) =       0.000275542254
  error estimate for blocks of size 2^( 7) =       0.000276607503
  error estimate for blocks of size 2^( 8) =       0.000276504173
  error estimate for blocks of size 2^( 9) =       0.000277208552

      target function =                  N/A
              le_mean =     -22.824655624523
             les_mean =     521.472139226047
             stat err =       0.000276465621
             autocorr =       1.254112562915
              std dev =       0.698261130725
             le_variance =       0.487568606681

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000762499
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487772181118
                                         uncertainty =       0.001573007341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487772181118
                                         uncertainty =       0.001573007341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246923897
  error estimate for blocks of size 2^( 2) =       0.000256035981
  error estimate for blocks of size 2^( 3) =       0.000264120216
  error estimate for blocks of size 2^( 4) =       0.000270002098
  error estimate for blocks of size 2^( 5) =       0.000273709733
  error estimate for blocks of size 2^( 6) =       0.000275573004
  error estimate for blocks of size 2^( 7) =       0.000276628844
  error estimate for blocks of size 2^( 8) =       0.000276538356
  error estimate for blocks of size 2^( 9) =       0.000277230993

      target function =                  N/A
              le_mean =     -22.824650675776
             les_mean =     521.834939342784
             stat err =       0.000276492800
             autocorr =       1.253837937502
              std dev =       0.698406248511
             le_variance =       0.487771287960

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00159596
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487873444412
                                         uncertainty =       0.001555151749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487873444412
                                         uncertainty =       0.001555151749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246949465
  error estimate for blocks of size 2^( 2) =       0.000256055668
  error estimate for blocks of size 2^( 3) =       0.000264141795
  error estimate for blocks of size 2^( 4) =       0.000270013960
  error estimate for blocks of size 2^( 5) =       0.000273723573
  error estimate for blocks of size 2^( 6) =       0.000275590503
  error estimate for blocks of size 2^( 7) =       0.000276656589
  error estimate for blocks of size 2^( 8) =       0.000276532997
  error estimate for blocks of size 2^( 9) =       0.000277224712

      target function =                  N/A
              le_mean =     -22.824659595525
             les_mean =     521.637050885338
             stat err =       0.000276501200
             autocorr =       1.253654491433
              std dev =       0.698478566378
             le_variance =       0.487872307689

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00657945
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487526480565
                                         uncertainty =       0.001539919413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487526480565
                                         uncertainty =       0.001539919413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246861653
  error estimate for blocks of size 2^( 2) =       0.000255976496
  error estimate for blocks of size 2^( 3) =       0.000264060405
  error estimate for blocks of size 2^( 4) =       0.000269939433
  error estimate for blocks of size 2^( 5) =       0.000273653955
  error estimate for blocks of size 2^( 6) =       0.000275528555
  error estimate for blocks of size 2^( 7) =       0.000276594206
  error estimate for blocks of size 2^( 8) =       0.000276487891
  error estimate for blocks of size 2^( 9) =       0.000277182994

      target function =                  N/A
              le_mean =     -22.824648604800
             les_mean =     521.473827224036
             stat err =       0.000276448412
             autocorr =       1.254067557785
              std dev =       0.698230194784
             le_variance =       0.487525404908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824655624523        initial
     3.8147e-02     3.8147e-01             1.6642e-03       -22.824650675776
     1.5259e-01     1.5259e+00             7.6347e-04       -22.824659595525  <--
     6.1035e-01     6.1035e+00             3.3214e-04       -22.824648604800

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 1.7427e+02
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.087649e-01 3 1  ON 0
ci_02                -2.215742e-02 3 1  ON 1
ci_03                -2.172275e-02 3 1  ON 2
ci_04                 2.174788e-02 3 1  ON 3
ci_05                -2.134405e-02 3 1  ON 4
ci_06                -2.157524e-02 3 1  ON 5
ci_07                 2.591597e-02 3 1  ON 6
ci_08                -3.412204e-03 3 1  ON 7
ci_09                -1.100914e-02 3 1  ON 8
ci_10                -1.097661e-02 3 1  ON 9
ci_11                 1.576402e-02 3 1  ON 10
ci_12                 1.125459e-02 3 1  ON 11
ci_13                 1.183031e-02 3 1  ON 12
ci_14                 1.727921e-02 3 1  ON 13
ci_15                 7.705698e-03 3 1  ON 14
ci_16                 7.378413e-03 3 1  ON 15
ci_17                -8.446707e-03 3 1  ON 16
ci_18                -8.691574e-03 3 1  ON 17
ci_19                 9.864111e-03 3 1  ON 18
ci_20                 1.014756e-02 3 1  ON 19
ci_21                 8.144129e-03 3 1  ON 20
ci_22                 8.668226e-03 3 1  ON 21
ci_23                 6.636628e-03 3 1  ON 22
ci_24                 7.598769e-03 3 1  ON 23
ci_25                 5.441463e-03 3 1  ON 24
ci_26                 2.763689e-03 3 1  ON 25
ci_27                 2.585477e-03 3 1  ON 26
ci_28                 3.109167e-03 3 1  ON 27
ci_29                 2.766178e-03 3 1  ON 28
ci_30                 8.695393e-04 3 1  ON 29
ci_31                 4.234608e-04 3 1  ON 30
ci_32                 4.193940e-04 3 1  ON 31
ci_33                -3.947450e-04 3 1  ON 32
ci_34                -3.922563e-05 3 1  ON 33
ci_35                 1.579689e-05 3 1  ON 34
ci_36                -4.145264e-04 3 1  ON 35
ci_37                -3.581639e-04 3 1  ON 36
ci_38                -6.236978e-05 3 1  ON 37
ci_39                -2.085267e-04 3 1  ON 38
ci_40                -1.353038e-03 3 1  ON 39
ci_41                 4.518160e-05 3 1  ON 40
ci_42                 2.737937e-06 3 1  ON 41
ci_43                -2.803475e-03 3 1  ON 42
ci_44                -2.086088e-03 3 1  ON 43
ci_45                -1.941681e-04 3 1  ON 44
ci_46                -2.700827e-04 3 1  ON 45
ci_47                -3.051355e-04 3 1  ON 46
ci_48                 1.819354e-04 3 1  ON 47
ci_49                -1.344806e-03 3 1  ON 48
ci_50                -4.843853e-04 3 1  ON 49
ci_51                -1.978468e-04 3 1  ON 50
ci_52                 1.439491e-04 3 1  ON 51
ci_53                -1.101576e-03 3 1  ON 52
ci_54                -1.129473e-03 3 1  ON 53
ci_55                -1.038046e-03 3 1  ON 54
ci_56                 1.468875e-03 3 1  ON 55
ci_57                 1.892738e-03 3 1  ON 56
ci_58                -1.507996e-03 3 1  ON 57
ci_59                -1.095420e-03 3 1  ON 58
ci_60                 1.715404e-03 3 1  ON 59
ci_61                 2.430698e-03 3 1  ON 60
ci_62                -5.201232e-04 3 1  ON 61
ci_63                -2.779598e-05 3 1  ON 62
ci_64                -2.778555e-04 3 1  ON 63
ci_65                -2.237189e-04 3 1  ON 64
ci_66                -5.247864e-04 3 1  ON 65
ci_67                -5.315262e-04 3 1  ON 66
ci_68                -1.855700e-03 3 1  ON 67
ci_69                -1.467252e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9459e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7024
    reference variance = 0.458803
====================================================
  Execution time = 1.0160e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1389e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0363e-01
  Total weights = 7.856770868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8556e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485620865857
                                         uncertainty =       0.001317026435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485620865857
                                         uncertainty =       0.001317026435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246379535
  error estimate for blocks of size 2^( 2) =       0.000255577480
  error estimate for blocks of size 2^( 3) =       0.000263765830
  error estimate for blocks of size 2^( 4) =       0.000269563066
  error estimate for blocks of size 2^( 5) =       0.000273338547
  error estimate for blocks of size 2^( 6) =       0.000275252459
  error estimate for blocks of size 2^( 7) =       0.000276290428
  error estimate for blocks of size 2^( 8) =       0.000277161992
  error estimate for blocks of size 2^( 9) =       0.000278270355

      target function =                  N/A
              le_mean =     -22.824785571253
             les_mean =     521.474467157523
             stat err =       0.000276743808
             autocorr =       1.261672286519
              std dev =       0.696866559779
             le_variance =       0.485623002138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282478557125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824785571246       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824791446124       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824790971020       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824791126153       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824790961328       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.172200e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824785571246       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824789570894       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824789354674       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824789395980       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 7.462639e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824785571246       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824787327959       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824787325977       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824787337004       residual = 5.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.042224e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2017e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.089654e-01 3 1  ON 0
ci_02                -2.206248e-02 3 1  ON 1
ci_03                -2.176617e-02 3 1  ON 2
ci_04                 2.166076e-02 3 1  ON 3
ci_05                -2.144697e-02 3 1  ON 4
ci_06                -2.156561e-02 3 1  ON 5
ci_07                 2.611355e-02 3 1  ON 6
ci_08                -3.587710e-03 3 1  ON 7
ci_09                -1.078078e-02 3 1  ON 8
ci_10                -1.113755e-02 3 1  ON 9
ci_11                 1.605600e-02 3 1  ON 10
ci_12                 1.149355e-02 3 1  ON 11
ci_13                 1.195887e-02 3 1  ON 12
ci_14                 1.707334e-02 3 1  ON 13
ci_15                 7.596310e-03 3 1  ON 14
ci_16                 7.740543e-03 3 1  ON 15
ci_17                -9.115533e-03 3 1  ON 16
ci_18                -9.437838e-03 3 1  ON 17
ci_19                 1.015419e-02 3 1  ON 18
ci_20                 1.043573e-02 3 1  ON 19
ci_21                 7.730517e-03 3 1  ON 20
ci_22                 8.329373e-03 3 1  ON 21
ci_23                 6.670909e-03 3 1  ON 22
ci_24                 8.048694e-03 3 1  ON 23
ci_25                 5.337753e-03 3 1  ON 24
ci_26                 3.094966e-03 3 1  ON 25
ci_27                 2.718463e-03 3 1  ON 26
ci_28                 3.025322e-03 3 1  ON 27
ci_29                 2.638911e-03 3 1  ON 28
ci_30                 1.055939e-03 3 1  ON 29
ci_31                 6.595691e-04 3 1  ON 30
ci_32                 4.069563e-04 3 1  ON 31
ci_33                -2.576871e-04 3 1  ON 32
ci_34                -3.752917e-04 3 1  ON 33
ci_35                 1.134370e-04 3 1  ON 34
ci_36                -2.526874e-04 3 1  ON 35
ci_37                -7.055655e-04 3 1  ON 36
ci_38                -1.018772e-04 3 1  ON 37
ci_39                -1.715997e-04 3 1  ON 38
ci_40                -1.154840e-03 3 1  ON 39
ci_41                -1.040194e-04 3 1  ON 40
ci_42                 1.955239e-04 3 1  ON 41
ci_43                -2.506980e-03 3 1  ON 42
ci_44                -2.172005e-03 3 1  ON 43
ci_45                -8.715021e-05 3 1  ON 44
ci_46                 1.155192e-04 3 1  ON 45
ci_47                -2.051278e-04 3 1  ON 46
ci_48                 2.439371e-06 3 1  ON 47
ci_49                -1.106652e-03 3 1  ON 48
ci_50                -3.558564e-04 3 1  ON 49
ci_51                 1.046874e-04 3 1  ON 50
ci_52                 5.878830e-05 3 1  ON 51
ci_53                -8.147464e-04 3 1  ON 52
ci_54                -8.383181e-04 3 1  ON 53
ci_55                -1.103286e-03 3 1  ON 54
ci_56                 1.792255e-03 3 1  ON 55
ci_57                 1.733547e-03 3 1  ON 56
ci_58                -1.413156e-03 3 1  ON 57
ci_59                -1.547892e-03 3 1  ON 58
ci_60                 2.195856e-03 3 1  ON 59
ci_61                 2.427834e-03 3 1  ON 60
ci_62                -5.919456e-04 3 1  ON 61
ci_63                -4.665923e-04 3 1  ON 62
ci_64                -5.122468e-04 3 1  ON 63
ci_65                 2.981208e-05 3 1  ON 64
ci_66                -3.224263e-04 3 1  ON 65
ci_67                -6.370870e-04 3 1  ON 66
ci_68                -1.447911e-03 3 1  ON 67
ci_69                -1.582534e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8691
    reference variance = 0.446561
====================================================
  Execution time = 9.9309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0538e-01
  Total weights = 7.8566e+06
  Execution time = 1.4363e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00170195
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488376996153
                                         uncertainty =       0.001892268950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488376996153
                                         uncertainty =       0.001892268950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247078807
  error estimate for blocks of size 2^( 2) =       0.000256227512
  error estimate for blocks of size 2^( 3) =       0.000264462381
  error estimate for blocks of size 2^( 4) =       0.000270369853
  error estimate for blocks of size 2^( 5) =       0.000273755364
  error estimate for blocks of size 2^( 6) =       0.000275698117
  error estimate for blocks of size 2^( 7) =       0.000277294448
  error estimate for blocks of size 2^( 8) =       0.000278406453
  error estimate for blocks of size 2^( 9) =       0.000278963836

      target function =                  N/A
              le_mean =     -22.824560771604
             les_mean =     521.580664327189
             stat err =       0.000277590714
             autocorr =       1.262231093662
              std dev =       0.698844400392
             le_variance =       0.488383495960

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0200458
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488332961155
                                         uncertainty =       0.001906829783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488332961155
                                         uncertainty =       0.001906829783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247067643
  error estimate for blocks of size 2^( 2) =       0.000256216685
  error estimate for blocks of size 2^( 3) =       0.000264453333
  error estimate for blocks of size 2^( 4) =       0.000270355883
  error estimate for blocks of size 2^( 5) =       0.000273735641
  error estimate for blocks of size 2^( 6) =       0.000275675010
  error estimate for blocks of size 2^( 7) =       0.000277263566
  error estimate for blocks of size 2^( 8) =       0.000278370015
  error estimate for blocks of size 2^( 9) =       0.000278938728

      target function =                  N/A
              le_mean =     -22.824558331572
             les_mean =     521.469039743831
             stat err =       0.000277561830
             autocorr =       1.262082481333
              std dev =       0.698812823429
             le_variance =       0.488339362189

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00168962
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488981604653
                                         uncertainty =       0.001962531502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488981604653
                                         uncertainty =       0.001962531502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247231637
  error estimate for blocks of size 2^( 2) =       0.000256375359
  error estimate for blocks of size 2^( 3) =       0.000264606487
  error estimate for blocks of size 2^( 4) =       0.000270498618
  error estimate for blocks of size 2^( 5) =       0.000273897561
  error estimate for blocks of size 2^( 6) =       0.000275822291
  error estimate for blocks of size 2^( 7) =       0.000277432531
  error estimate for blocks of size 2^( 8) =       0.000278521956
  error estimate for blocks of size 2^( 9) =       0.000279132131

      target function =                  N/A
              le_mean =     -22.824573025597
             les_mean =     521.903189322060
             stat err =       0.000277727227
             autocorr =       1.261911296710
              std dev =       0.699276668242
             le_variance =       0.488987858748

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0133527
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488247086915
                                         uncertainty =       0.001896037108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488247086915
                                         uncertainty =       0.001896037108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247045936
  error estimate for blocks of size 2^( 2) =       0.000256195514
  error estimate for blocks of size 2^( 3) =       0.000264434743
  error estimate for blocks of size 2^( 4) =       0.000270341422
  error estimate for blocks of size 2^( 5) =       0.000273724736
  error estimate for blocks of size 2^( 6) =       0.000275666490
  error estimate for blocks of size 2^( 7) =       0.000277256588
  error estimate for blocks of size 2^( 8) =       0.000278366634
  error estimate for blocks of size 2^( 9) =       0.000278928621

      target function =                  N/A
              le_mean =     -22.824557700409
             les_mean =     521.472673859865
             stat err =       0.000277554583
             autocorr =       1.262238370454
              std dev =       0.698751426826
             le_variance =       0.488253556492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824560771604        initial
     3.8147e-02     3.8147e-01             1.1722e-03       -22.824558331572
     1.5259e-01     1.5259e+00             7.4626e-04       -22.824573025597  <--
     6.1035e-01     6.1035e+00             3.0422e-04       -22.824557700409

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 1.7144e+02
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.089654e-01 3 1  ON 0
ci_02                -2.206248e-02 3 1  ON 1
ci_03                -2.176617e-02 3 1  ON 2
ci_04                 2.166076e-02 3 1  ON 3
ci_05                -2.144697e-02 3 1  ON 4
ci_06                -2.156561e-02 3 1  ON 5
ci_07                 2.611355e-02 3 1  ON 6
ci_08                -3.587710e-03 3 1  ON 7
ci_09                -1.078078e-02 3 1  ON 8
ci_10                -1.113755e-02 3 1  ON 9
ci_11                 1.605600e-02 3 1  ON 10
ci_12                 1.149355e-02 3 1  ON 11
ci_13                 1.195887e-02 3 1  ON 12
ci_14                 1.707334e-02 3 1  ON 13
ci_15                 7.596310e-03 3 1  ON 14
ci_16                 7.740543e-03 3 1  ON 15
ci_17                -9.115533e-03 3 1  ON 16
ci_18                -9.437838e-03 3 1  ON 17
ci_19                 1.015419e-02 3 1  ON 18
ci_20                 1.043573e-02 3 1  ON 19
ci_21                 7.730517e-03 3 1  ON 20
ci_22                 8.329373e-03 3 1  ON 21
ci_23                 6.670909e-03 3 1  ON 22
ci_24                 8.048694e-03 3 1  ON 23
ci_25                 5.337753e-03 3 1  ON 24
ci_26                 3.094966e-03 3 1  ON 25
ci_27                 2.718463e-03 3 1  ON 26
ci_28                 3.025322e-03 3 1  ON 27
ci_29                 2.638911e-03 3 1  ON 28
ci_30                 1.055939e-03 3 1  ON 29
ci_31                 6.595691e-04 3 1  ON 30
ci_32                 4.069563e-04 3 1  ON 31
ci_33                -2.576871e-04 3 1  ON 32
ci_34                -3.752917e-04 3 1  ON 33
ci_35                 1.134370e-04 3 1  ON 34
ci_36                -2.526874e-04 3 1  ON 35
ci_37                -7.055655e-04 3 1  ON 36
ci_38                -1.018772e-04 3 1  ON 37
ci_39                -1.715997e-04 3 1  ON 38
ci_40                -1.154840e-03 3 1  ON 39
ci_41                -1.040194e-04 3 1  ON 40
ci_42                 1.955239e-04 3 1  ON 41
ci_43                -2.506980e-03 3 1  ON 42
ci_44                -2.172005e-03 3 1  ON 43
ci_45                -8.715021e-05 3 1  ON 44
ci_46                 1.155192e-04 3 1  ON 45
ci_47                -2.051278e-04 3 1  ON 46
ci_48                 2.439371e-06 3 1  ON 47
ci_49                -1.106652e-03 3 1  ON 48
ci_50                -3.558564e-04 3 1  ON 49
ci_51                 1.046874e-04 3 1  ON 50
ci_52                 5.878830e-05 3 1  ON 51
ci_53                -8.147464e-04 3 1  ON 52
ci_54                -8.383181e-04 3 1  ON 53
ci_55                -1.103286e-03 3 1  ON 54
ci_56                 1.792255e-03 3 1  ON 55
ci_57                 1.733547e-03 3 1  ON 56
ci_58                -1.413156e-03 3 1  ON 57
ci_59                -1.547892e-03 3 1  ON 58
ci_60                 2.195856e-03 3 1  ON 59
ci_61                 2.427834e-03 3 1  ON 60
ci_62                -5.919456e-04 3 1  ON 61
ci_63                -4.665923e-04 3 1  ON 62
ci_64                -5.122468e-04 3 1  ON 63
ci_65                 2.981208e-05 3 1  ON 64
ci_66                -3.224263e-04 3 1  ON 65
ci_67                -6.370870e-04 3 1  ON 66
ci_68                -1.447911e-03 3 1  ON 67
ci_69                -1.582534e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9164e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7347
    reference variance = 0.386952
====================================================
  Execution time = 1.0315e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1313e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9883e-01
  Total weights = 7.856180738e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8567e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483108852122
                                         uncertainty =       0.001100847105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.483108852122
                                         uncertainty =       0.001100847105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245741218
  error estimate for blocks of size 2^( 2) =       0.000255031987
  error estimate for blocks of size 2^( 3) =       0.000263261621
  error estimate for blocks of size 2^( 4) =       0.000269128855
  error estimate for blocks of size 2^( 5) =       0.000272815577
  error estimate for blocks of size 2^( 6) =       0.000274926121
  error estimate for blocks of size 2^( 7) =       0.000276124807
  error estimate for blocks of size 2^( 8) =       0.000276727731
  error estimate for blocks of size 2^( 9) =       0.000277209458

      target function =                  N/A
              le_mean =     -22.824875118984
             les_mean =     521.473751098139
             stat err =       0.000276247029
             autocorr =       1.263686127421
              std dev =       0.695061128011
             le_variance =       0.483109971671


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282487511898e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824875118976       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824877201739       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824877627620       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824877536588       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824877346227       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-02 is 1.452358e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824875118976       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824876535429       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824876772724       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824876751457       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 6.609225e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824875118976       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824875740318       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824875845904       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824875853366       residual = 2.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 3.201038e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2174e+02
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.087328e-01 3 1  ON 0
ci_02                -2.211999e-02 3 1  ON 1
ci_03                -2.142532e-02 3 1  ON 2
ci_04                 2.198260e-02 3 1  ON 3
ci_05                -2.155228e-02 3 1  ON 4
ci_06                -2.142994e-02 3 1  ON 5
ci_07                 2.576762e-02 3 1  ON 6
ci_08                -3.551129e-03 3 1  ON 7
ci_09                -1.088129e-02 3 1  ON 8
ci_10                -1.084668e-02 3 1  ON 9
ci_11                 1.605068e-02 3 1  ON 10
ci_12                 1.137801e-02 3 1  ON 11
ci_13                 1.244042e-02 3 1  ON 12
ci_14                 1.773426e-02 3 1  ON 13
ci_15                 7.863936e-03 3 1  ON 14
ci_16                 7.913121e-03 3 1  ON 15
ci_17                -9.174643e-03 3 1  ON 16
ci_18                -8.959885e-03 3 1  ON 17
ci_19                 9.500858e-03 3 1  ON 18
ci_20                 1.011064e-02 3 1  ON 19
ci_21                 8.180254e-03 3 1  ON 20
ci_22                 8.478349e-03 3 1  ON 21
ci_23                 6.477508e-03 3 1  ON 22
ci_24                 7.490924e-03 3 1  ON 23
ci_25                 5.484709e-03 3 1  ON 24
ci_26                 3.184099e-03 3 1  ON 25
ci_27                 2.600048e-03 3 1  ON 26
ci_28                 3.138194e-03 3 1  ON 27
ci_29                 2.811867e-03 3 1  ON 28
ci_30                 1.713771e-03 3 1  ON 29
ci_31                 6.223069e-04 3 1  ON 30
ci_32                 6.560507e-04 3 1  ON 31
ci_33                 3.954440e-05 3 1  ON 32
ci_34                -1.103498e-04 3 1  ON 33
ci_35                 1.612320e-04 3 1  ON 34
ci_36                -2.926408e-04 3 1  ON 35
ci_37                -6.059129e-04 3 1  ON 36
ci_38                 4.328395e-05 3 1  ON 37
ci_39                -2.536557e-04 3 1  ON 38
ci_40                -1.307830e-03 3 1  ON 39
ci_41                 2.067296e-04 3 1  ON 40
ci_42                 4.056914e-05 3 1  ON 41
ci_43                -2.483515e-03 3 1  ON 42
ci_44                -2.237856e-03 3 1  ON 43
ci_45                 5.370182e-05 3 1  ON 44
ci_46                -3.040631e-05 3 1  ON 45
ci_47                -6.872506e-05 3 1  ON 46
ci_48                -2.677047e-04 3 1  ON 47
ci_49                -1.434290e-03 3 1  ON 48
ci_50                -6.121819e-04 3 1  ON 49
ci_51                -1.464367e-04 3 1  ON 50
ci_52                 2.178882e-04 3 1  ON 51
ci_53                -7.691359e-04 3 1  ON 52
ci_54                -1.152782e-03 3 1  ON 53
ci_55                -1.065806e-03 3 1  ON 54
ci_56                 1.892980e-03 3 1  ON 55
ci_57                 1.723553e-03 3 1  ON 56
ci_58                -1.092596e-03 3 1  ON 57
ci_59                -1.650557e-03 3 1  ON 58
ci_60                 2.132730e-03 3 1  ON 59
ci_61                 2.573133e-03 3 1  ON 60
ci_62                -1.403734e-04 3 1  ON 61
ci_63                -1.630294e-04 3 1  ON 62
ci_64                -3.155133e-04 3 1  ON 63
ci_65                -3.805710e-04 3 1  ON 64
ci_66                -1.967771e-04 3 1  ON 65
ci_67                -4.026252e-04 3 1  ON 66
ci_68                -1.742452e-03 3 1  ON 67
ci_69                -1.506149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7988
    reference variance = 0.465935
====================================================
  Execution time = 9.9341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0111e-01
  Total weights = 7.8567e+06
  Execution time = 1.4349e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484765582600
                                         uncertainty =       0.001183095958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484765582600
                                         uncertainty =       0.001183095958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246162177
  error estimate for blocks of size 2^( 2) =       0.000255494792
  error estimate for blocks of size 2^( 3) =       0.000263763994
  error estimate for blocks of size 2^( 4) =       0.000269535510
  error estimate for blocks of size 2^( 5) =       0.000272673731
  error estimate for blocks of size 2^( 6) =       0.000274725802
  error estimate for blocks of size 2^( 7) =       0.000275821682
  error estimate for blocks of size 2^( 8) =       0.000276572632
  error estimate for blocks of size 2^( 9) =       0.000277063086

      target function =                  N/A
              le_mean =     -22.824791418178
             les_mean =     521.524577226856
             stat err =       0.000276045800
             autocorr =       1.257533723956
              std dev =       0.696251778860
             le_variance =       0.484766539565

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0701875
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484650081816
                                         uncertainty =       0.001182849146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484650081816
                                         uncertainty =       0.001182849146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246132865
  error estimate for blocks of size 2^( 2) =       0.000255467827
  error estimate for blocks of size 2^( 3) =       0.000263745294
  error estimate for blocks of size 2^( 4) =       0.000269514648
  error estimate for blocks of size 2^( 5) =       0.000272665039
  error estimate for blocks of size 2^( 6) =       0.000274720187
  error estimate for blocks of size 2^( 7) =       0.000275807410
  error estimate for blocks of size 2^( 8) =       0.000276572534
  error estimate for blocks of size 2^( 9) =       0.000277051442

      target function =                  N/A
              le_mean =     -22.824787115832
             les_mean =     521.476948286094
             stat err =       0.000276037893
             autocorr =       1.257761199907
              std dev =       0.696168872705
             le_variance =       0.484651099323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484732603556
                                         uncertainty =       0.001184259547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484732603556
                                         uncertainty =       0.001184259547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246153815
  error estimate for blocks of size 2^( 2) =       0.000255489336
  error estimate for blocks of size 2^( 3) =       0.000263767817
  error estimate for blocks of size 2^( 4) =       0.000269535103
  error estimate for blocks of size 2^( 5) =       0.000272689529
  error estimate for blocks of size 2^( 6) =       0.000274739665
  error estimate for blocks of size 2^( 7) =       0.000275826678
  error estimate for blocks of size 2^( 8) =       0.000276608637
  error estimate for blocks of size 2^( 9) =       0.000277092343

      target function =                  N/A
              le_mean =     -22.824790562422
             les_mean =     521.478795171268
             stat err =       0.000276066831
             autocorr =       1.257810790239
              std dev =       0.696228128224
             le_variance =       0.484733606531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484630711121
                                         uncertainty =       0.001177353751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484630711121
                                         uncertainty =       0.001177353751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246127955
  error estimate for blocks of size 2^( 2) =       0.000255462049
  error estimate for blocks of size 2^( 3) =       0.000263735260
  error estimate for blocks of size 2^( 4) =       0.000269504823
  error estimate for blocks of size 2^( 5) =       0.000272650962
  error estimate for blocks of size 2^( 6) =       0.000274708765
  error estimate for blocks of size 2^( 7) =       0.000275804553
  error estimate for blocks of size 2^( 8) =       0.000276556502
  error estimate for blocks of size 2^( 9) =       0.000277027871

      target function =                  N/A
              le_mean =     -22.824787492621
             les_mean =     521.478736376643
             stat err =       0.000276024423
             autocorr =       1.257688624864
              std dev =       0.696154984720
             le_variance =       0.484631762750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824791418178        initial  <--
     3.8147e-02     3.8147e-01             1.4524e-03       -22.824787115832
     1.5259e-01     1.5259e+00             6.6092e-04       -22.824790562422
     6.1035e-01     6.1035e+00             3.2010e-04       -22.824787492621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.3375
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.089654e-01 3 1  ON 0
ci_02                -2.206248e-02 3 1  ON 1
ci_03                -2.176617e-02 3 1  ON 2
ci_04                 2.166076e-02 3 1  ON 3
ci_05                -2.144697e-02 3 1  ON 4
ci_06                -2.156561e-02 3 1  ON 5
ci_07                 2.611355e-02 3 1  ON 6
ci_08                -3.587710e-03 3 1  ON 7
ci_09                -1.078078e-02 3 1  ON 8
ci_10                -1.113755e-02 3 1  ON 9
ci_11                 1.605600e-02 3 1  ON 10
ci_12                 1.149355e-02 3 1  ON 11
ci_13                 1.195887e-02 3 1  ON 12
ci_14                 1.707334e-02 3 1  ON 13
ci_15                 7.596310e-03 3 1  ON 14
ci_16                 7.740543e-03 3 1  ON 15
ci_17                -9.115533e-03 3 1  ON 16
ci_18                -9.437838e-03 3 1  ON 17
ci_19                 1.015419e-02 3 1  ON 18
ci_20                 1.043573e-02 3 1  ON 19
ci_21                 7.730517e-03 3 1  ON 20
ci_22                 8.329373e-03 3 1  ON 21
ci_23                 6.670909e-03 3 1  ON 22
ci_24                 8.048694e-03 3 1  ON 23
ci_25                 5.337753e-03 3 1  ON 24
ci_26                 3.094966e-03 3 1  ON 25
ci_27                 2.718463e-03 3 1  ON 26
ci_28                 3.025322e-03 3 1  ON 27
ci_29                 2.638911e-03 3 1  ON 28
ci_30                 1.055939e-03 3 1  ON 29
ci_31                 6.595691e-04 3 1  ON 30
ci_32                 4.069563e-04 3 1  ON 31
ci_33                -2.576871e-04 3 1  ON 32
ci_34                -3.752917e-04 3 1  ON 33
ci_35                 1.134370e-04 3 1  ON 34
ci_36                -2.526874e-04 3 1  ON 35
ci_37                -7.055655e-04 3 1  ON 36
ci_38                -1.018772e-04 3 1  ON 37
ci_39                -1.715997e-04 3 1  ON 38
ci_40                -1.154840e-03 3 1  ON 39
ci_41                -1.040194e-04 3 1  ON 40
ci_42                 1.955239e-04 3 1  ON 41
ci_43                -2.506980e-03 3 1  ON 42
ci_44                -2.172005e-03 3 1  ON 43
ci_45                -8.715021e-05 3 1  ON 44
ci_46                 1.155192e-04 3 1  ON 45
ci_47                -2.051278e-04 3 1  ON 46
ci_48                 2.439371e-06 3 1  ON 47
ci_49                -1.106652e-03 3 1  ON 48
ci_50                -3.558564e-04 3 1  ON 49
ci_51                 1.046874e-04 3 1  ON 50
ci_52                 5.878830e-05 3 1  ON 51
ci_53                -8.147464e-04 3 1  ON 52
ci_54                -8.383181e-04 3 1  ON 53
ci_55                -1.103286e-03 3 1  ON 54
ci_56                 1.792255e-03 3 1  ON 55
ci_57                 1.733547e-03 3 1  ON 56
ci_58                -1.413156e-03 3 1  ON 57
ci_59                -1.547892e-03 3 1  ON 58
ci_60                 2.195856e-03 3 1  ON 59
ci_61                 2.427834e-03 3 1  ON 60
ci_62                -5.919456e-04 3 1  ON 61
ci_63                -4.665923e-04 3 1  ON 62
ci_64                -5.122468e-04 3 1  ON 63
ci_65                 2.981208e-05 3 1  ON 64
ci_66                -3.224263e-04 3 1  ON 65
ci_67                -6.370870e-04 3 1  ON 66
ci_68                -1.447911e-03 3 1  ON 67
ci_69                -1.582534e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9308e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7641
    reference variance = 0.503978
====================================================
  Execution time = 1.0334e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1402e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0577e-01
  Total weights = 7.857221409e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8571e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487362838437
                                         uncertainty =       0.002323302437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487362838437
                                         uncertainty =       0.002323302437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246821228
  error estimate for blocks of size 2^( 2) =       0.000255978456
  error estimate for blocks of size 2^( 3) =       0.000264032004
  error estimate for blocks of size 2^( 4) =       0.000269837864
  error estimate for blocks of size 2^( 5) =       0.000273297819
  error estimate for blocks of size 2^( 6) =       0.000274581949
  error estimate for blocks of size 2^( 7) =       0.000275135377
  error estimate for blocks of size 2^( 8) =       0.000276228482
  error estimate for blocks of size 2^( 9) =       0.000275825296

      target function =                  N/A
              le_mean =     -22.824329255878
             les_mean =     521.455775863577
             stat err =       0.000275442776
             autocorr =       1.245368156489
              std dev =       0.698115856325
             le_variance =       0.487365748852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282432925588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824329255876       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824332358342       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824332626613       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824332633206       residual = 5.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 3.002442e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824329255876       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824330286090       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824330399546       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824330387588       residual = 3.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 9.080893e-05

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824329255876       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824329536455       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824329570876       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824329566157       residual = 6.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 2.497250e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2193e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.089719e-01 3 1  ON 0
ci_02                -2.214643e-02 3 1  ON 1
ci_03                -2.176232e-02 3 1  ON 2
ci_04                 2.170078e-02 3 1  ON 3
ci_05                -2.141255e-02 3 1  ON 4
ci_06                -2.155552e-02 3 1  ON 5
ci_07                 2.602825e-02 3 1  ON 6
ci_08                -3.555008e-03 3 1  ON 7
ci_09                -1.081756e-02 3 1  ON 8
ci_10                -1.106861e-02 3 1  ON 9
ci_11                 1.607502e-02 3 1  ON 10
ci_12                 1.143309e-02 3 1  ON 11
ci_13                 1.198412e-02 3 1  ON 12
ci_14                 1.709205e-02 3 1  ON 13
ci_15                 7.570895e-03 3 1  ON 14
ci_16                 7.757499e-03 3 1  ON 15
ci_17                -9.181472e-03 3 1  ON 16
ci_18                -9.423553e-03 3 1  ON 17
ci_19                 1.008058e-02 3 1  ON 18
ci_20                 1.034492e-02 3 1  ON 19
ci_21                 7.810437e-03 3 1  ON 20
ci_22                 8.299197e-03 3 1  ON 21
ci_23                 6.672830e-03 3 1  ON 22
ci_24                 7.995565e-03 3 1  ON 23
ci_25                 5.285716e-03 3 1  ON 24
ci_26                 3.020684e-03 3 1  ON 25
ci_27                 2.708407e-03 3 1  ON 26
ci_28                 2.976770e-03 3 1  ON 27
ci_29                 2.681771e-03 3 1  ON 28
ci_30                 9.779272e-04 3 1  ON 29
ci_31                 6.503025e-04 3 1  ON 30
ci_32                 3.866774e-04 3 1  ON 31
ci_33                -2.579270e-04 3 1  ON 32
ci_34                -3.664282e-04 3 1  ON 33
ci_35                 9.547338e-05 3 1  ON 34
ci_36                -2.935696e-04 3 1  ON 35
ci_37                -6.870913e-04 3 1  ON 36
ci_38                -5.231633e-05 3 1  ON 37
ci_39                -1.371443e-04 3 1  ON 38
ci_40                -1.230871e-03 3 1  ON 39
ci_41                -1.409531e-04 3 1  ON 40
ci_42                 1.658755e-04 3 1  ON 41
ci_43                -2.447139e-03 3 1  ON 42
ci_44                -2.140925e-03 3 1  ON 43
ci_45                -1.069042e-04 3 1  ON 44
ci_46                 8.296887e-05 3 1  ON 45
ci_47                -1.978420e-04 3 1  ON 46
ci_48                 3.820672e-05 3 1  ON 47
ci_49                -1.150408e-03 3 1  ON 48
ci_50                -3.542764e-04 3 1  ON 49
ci_51                 1.008328e-04 3 1  ON 50
ci_52                 8.328612e-05 3 1  ON 51
ci_53                -8.642686e-04 3 1  ON 52
ci_54                -8.393728e-04 3 1  ON 53
ci_55                -1.075729e-03 3 1  ON 54
ci_56                 1.870106e-03 3 1  ON 55
ci_57                 1.668359e-03 3 1  ON 56
ci_58                -1.437207e-03 3 1  ON 57
ci_59                -1.588575e-03 3 1  ON 58
ci_60                 2.168252e-03 3 1  ON 59
ci_61                 2.342683e-03 3 1  ON 60
ci_62                -6.226931e-04 3 1  ON 61
ci_63                -5.237720e-04 3 1  ON 62
ci_64                -5.145172e-04 3 1  ON 63
ci_65                -5.988977e-05 3 1  ON 64
ci_66                -3.155926e-04 3 1  ON 65
ci_67                -5.741060e-04 3 1  ON 66
ci_68                -1.476095e-03 3 1  ON 67
ci_69                -1.622390e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7424
    reference variance = 0.24648
====================================================
  Execution time = 9.9348e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0783e-01
  Total weights = 7.8569e+06
  Execution time = 1.4357e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760680413
                                         uncertainty =       0.004869441973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490760680413
                                         uncertainty =       0.004869441973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247677934
  error estimate for blocks of size 2^( 2) =       0.000256626251
  error estimate for blocks of size 2^( 3) =       0.000264808977
  error estimate for blocks of size 2^( 4) =       0.000270578355
  error estimate for blocks of size 2^( 5) =       0.000273755306
  error estimate for blocks of size 2^( 6) =       0.000275464143
  error estimate for blocks of size 2^( 7) =       0.000275977068
  error estimate for blocks of size 2^( 8) =       0.000277193308
  error estimate for blocks of size 2^( 9) =       0.000278967332

      target function =                  N/A
              le_mean =     -22.824272055107
             les_mean =     521.460054131470
             stat err =       0.000276900463
             autocorr =       1.249892698234
              std dev =       0.700538985985
             le_variance =       0.490754870885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490740244547
                                         uncertainty =       0.004861403600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490740244547
                                         uncertainty =       0.004861403600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247672783
  error estimate for blocks of size 2^( 2) =       0.000256620413
  error estimate for blocks of size 2^( 3) =       0.000264801765
  error estimate for blocks of size 2^( 4) =       0.000270569553
  error estimate for blocks of size 2^( 5) =       0.000273744769
  error estimate for blocks of size 2^( 6) =       0.000275452342
  error estimate for blocks of size 2^( 7) =       0.000275961000
  error estimate for blocks of size 2^( 8) =       0.000277177489
  error estimate for blocks of size 2^( 9) =       0.000278948718

      target function =                  N/A
              le_mean =     -22.824273325338
             les_mean =     521.457296983839
             stat err =       0.000276884887
             autocorr =       1.249804075656
              std dev =       0.700524417040
             le_variance =       0.490734458869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490741140740
                                         uncertainty =       0.004860674249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490741140740
                                         uncertainty =       0.004860674249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247673007
  error estimate for blocks of size 2^( 2) =       0.000256620789
  error estimate for blocks of size 2^( 3) =       0.000264802599
  error estimate for blocks of size 2^( 4) =       0.000270571031
  error estimate for blocks of size 2^( 5) =       0.000273746831
  error estimate for blocks of size 2^( 6) =       0.000275454812
  error estimate for blocks of size 2^( 7) =       0.000275964866
  error estimate for blocks of size 2^( 8) =       0.000277180861
  error estimate for blocks of size 2^( 9) =       0.000278953373

      target function =                  N/A
              le_mean =     -22.824272636692
             les_mean =     521.455745331126
             stat err =       0.000276888478
             autocorr =       1.249834225436
              std dev =       0.700525051783
             le_variance =       0.490735348175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490756621329
                                         uncertainty =       0.004868071250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490756621329
                                         uncertainty =       0.004868071250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247676910
  error estimate for blocks of size 2^( 2) =       0.000256625186
  error estimate for blocks of size 2^( 3) =       0.000264807779
  error estimate for blocks of size 2^( 4) =       0.000270576922
  error estimate for blocks of size 2^( 5) =       0.000273753571
  error estimate for blocks of size 2^( 6) =       0.000275462269
  error estimate for blocks of size 2^( 7) =       0.000275974700
  error estimate for blocks of size 2^( 8) =       0.000277190495
  error estimate for blocks of size 2^( 9) =       0.000278964189

      target function =                  N/A
              le_mean =     -22.824271969544
             les_mean =     521.457723908605
             stat err =       0.000276897913
             autocorr =       1.249880013513
              std dev =       0.700536090657
             le_variance =       0.490750814312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824272055107        initial
     3.8147e-01     3.8147e+00             3.0024e-04       -22.824273325338  <--
     1.5259e+00     1.5259e+01             9.0809e-05       -22.824272636692
     6.1035e+00     6.1035e+01             2.4972e-05       -22.824271969544

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 1.7132e+02
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.089875e-01 3 1  ON 0
ci_02                -2.232930e-02 3 1  ON 1
ci_03                -2.175173e-02 3 1  ON 2
ci_04                 2.176947e-02 3 1  ON 3
ci_05                -2.133200e-02 3 1  ON 4
ci_06                -2.152763e-02 3 1  ON 5
ci_07                 2.584753e-02 3 1  ON 6
ci_08                -3.501223e-03 3 1  ON 7
ci_09                -1.090113e-02 3 1  ON 8
ci_10                -1.091689e-02 3 1  ON 9
ci_11                 1.611501e-02 3 1  ON 10
ci_12                 1.131368e-02 3 1  ON 11
ci_13                 1.203620e-02 3 1  ON 12
ci_14                 1.713697e-02 3 1  ON 13
ci_15                 7.514868e-03 3 1  ON 14
ci_16                 7.802865e-03 3 1  ON 15
ci_17                -9.321812e-03 3 1  ON 16
ci_18                -9.393702e-03 3 1  ON 17
ci_19                 9.957641e-03 3 1  ON 18
ci_20                 1.016495e-02 3 1  ON 19
ci_21                 7.993190e-03 3 1  ON 20
ci_22                 8.230488e-03 3 1  ON 21
ci_23                 6.676148e-03 3 1  ON 22
ci_24                 7.871862e-03 3 1  ON 23
ci_25                 5.187371e-03 3 1  ON 24
ci_26                 2.870692e-03 3 1  ON 25
ci_27                 2.686352e-03 3 1  ON 26
ci_28                 2.875295e-03 3 1  ON 27
ci_29                 2.767647e-03 3 1  ON 28
ci_30                 8.051064e-04 3 1  ON 29
ci_31                 6.381796e-04 3 1  ON 30
ci_32                 3.498590e-04 3 1  ON 31
ci_33                -2.525049e-04 3 1  ON 32
ci_34                -3.499516e-04 3 1  ON 33
ci_35                 5.165279e-05 3 1  ON 34
ci_36                -3.614920e-04 3 1  ON 35
ci_37                -6.528334e-04 3 1  ON 36
ci_38                 4.476422e-05 3 1  ON 37
ci_39                -7.527469e-05 3 1  ON 38
ci_40                -1.344837e-03 3 1  ON 39
ci_41                -2.029752e-04 3 1  ON 40
ci_42                 1.112170e-04 3 1  ON 41
ci_43                -2.318561e-03 3 1  ON 42
ci_44                -2.076255e-03 3 1  ON 43
ci_45                -1.469110e-04 3 1  ON 44
ci_46                 2.449796e-05 3 1  ON 45
ci_47                -1.715157e-04 3 1  ON 46
ci_48                 1.075421e-04 3 1  ON 47
ci_49                -1.221663e-03 3 1  ON 48
ci_50                -3.510446e-04 3 1  ON 49
ci_51                 9.440170e-05 3 1  ON 50
ci_52                 1.255295e-04 3 1  ON 51
ci_53                -9.443153e-04 3 1  ON 52
ci_54                -8.423027e-04 3 1  ON 53
ci_55                -1.021712e-03 3 1  ON 54
ci_56                 2.010049e-03 3 1  ON 55
ci_57                 1.553362e-03 3 1  ON 56
ci_58                -1.487735e-03 3 1  ON 57
ci_59                -1.670883e-03 3 1  ON 58
ci_60                 2.100181e-03 3 1  ON 59
ci_61                 2.127590e-03 3 1  ON 60
ci_62                -6.688899e-04 3 1  ON 61
ci_63                -6.147212e-04 3 1  ON 62
ci_64                -5.118977e-04 3 1  ON 63
ci_65                -2.255032e-04 3 1  ON 64
ci_66                -3.030770e-04 3 1  ON 65
ci_67                -4.592972e-04 3 1  ON 66
ci_68                -1.529185e-03 3 1  ON 67
ci_69                -1.703503e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9325e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8858
    reference variance = 0.808281
====================================================
  Execution time = 1.0346e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1343e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0449e-01
  Total weights = 7.857107622e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8547e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488189319997
                                         uncertainty =       0.001500043776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488189319997
                                         uncertainty =       0.001500043776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247030320
  error estimate for blocks of size 2^( 2) =       0.000256200532
  error estimate for blocks of size 2^( 3) =       0.000264484338
  error estimate for blocks of size 2^( 4) =       0.000270441971
  error estimate for blocks of size 2^( 5) =       0.000273648191
  error estimate for blocks of size 2^( 6) =       0.000274936928
  error estimate for blocks of size 2^( 7) =       0.000275584908
  error estimate for blocks of size 2^( 8) =       0.000275836466
  error estimate for blocks of size 2^( 9) =       0.000276217651

      target function =                  N/A
              le_mean =     -22.824754088606
             les_mean =     521.473894038600
             stat err =       0.000275643988
             autocorr =       1.245077913467
              std dev =       0.698707256736
             le_variance =       0.488191830615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282475408861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824754088599       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824764531509       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824766877719       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824767518167       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824767647680       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824767594755       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 2.366863e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824754088599       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824759692716       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824760888591       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824760945779       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824760977801       residual = 5.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 1.019040e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824754088599       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824756052593       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824756492858       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824756469860       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 3.677279e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060933 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2208e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.088925e-01 3 1  ON 0
ci_02                -2.235973e-02 3 1  ON 1
ci_03                -2.186575e-02 3 1  ON 2
ci_04                 2.177537e-02 3 1  ON 3
ci_05                -2.139352e-02 3 1  ON 4
ci_06                -2.158896e-02 3 1  ON 5
ci_07                 2.608290e-02 3 1  ON 6
ci_08                -3.458161e-03 3 1  ON 7
ci_09                -1.069719e-02 3 1  ON 8
ci_10                -1.116864e-02 3 1  ON 9
ci_11                 1.538837e-02 3 1  ON 10
ci_12                 1.121107e-02 3 1  ON 11
ci_13                 1.200059e-02 3 1  ON 12
ci_14                 1.688716e-02 3 1  ON 13
ci_15                 7.403182e-03 3 1  ON 14
ci_16                 7.731727e-03 3 1  ON 15
ci_17                -9.329962e-03 3 1  ON 16
ci_18                -9.354410e-03 3 1  ON 17
ci_19                 9.940095e-03 3 1  ON 18
ci_20                 1.042733e-02 3 1  ON 19
ci_21                 7.989218e-03 3 1  ON 20
ci_22                 8.654871e-03 3 1  ON 21
ci_23                 7.695187e-03 3 1  ON 22
ci_24                 6.895545e-03 3 1  ON 23
ci_25                 5.721262e-03 3 1  ON 24
ci_26                 3.000954e-03 3 1  ON 25
ci_27                 2.829919e-03 3 1  ON 26
ci_28                 3.028468e-03 3 1  ON 27
ci_29                 2.851652e-03 3 1  ON 28
ci_30                 6.281367e-04 3 1  ON 29
ci_31                 8.888016e-04 3 1  ON 30
ci_32                 5.370767e-05 3 1  ON 31
ci_33                -4.760595e-05 3 1  ON 32
ci_34                -2.643985e-04 3 1  ON 33
ci_35                -3.070075e-04 3 1  ON 34
ci_36                -5.227246e-04 3 1  ON 35
ci_37                -5.940568e-04 3 1  ON 36
ci_38                -3.404754e-04 3 1  ON 37
ci_39                 1.283514e-04 3 1  ON 38
ci_40                -1.572369e-03 3 1  ON 39
ci_41                 3.356587e-04 3 1  ON 40
ci_42                 4.361130e-04 3 1  ON 41
ci_43                -2.321052e-03 3 1  ON 42
ci_44                -2.466652e-03 3 1  ON 43
ci_45                -1.391807e-04 3 1  ON 44
ci_46                 5.436219e-06 3 1  ON 45
ci_47                -5.123495e-06 3 1  ON 46
ci_48                 5.575154e-04 3 1  ON 47
ci_49                -1.541870e-03 3 1  ON 48
ci_50                -5.192718e-04 3 1  ON 49
ci_51                 2.487512e-04 3 1  ON 50
ci_52                 5.134705e-06 3 1  ON 51
ci_53                -1.389743e-03 3 1  ON 52
ci_54                -7.867267e-04 3 1  ON 53
ci_55                -8.337284e-04 3 1  ON 54
ci_56                 1.331389e-03 3 1  ON 55
ci_57                 1.882073e-03 3 1  ON 56
ci_58                -9.698097e-04 3 1  ON 57
ci_59                -1.425468e-03 3 1  ON 58
ci_60                 1.856638e-03 3 1  ON 59
ci_61                 1.825546e-03 3 1  ON 60
ci_62                -5.874724e-04 3 1  ON 61
ci_63                -6.998724e-04 3 1  ON 62
ci_64                -4.397139e-04 3 1  ON 63
ci_65                -2.283743e-04 3 1  ON 64
ci_66                -3.930879e-04 3 1  ON 65
ci_67                -6.214103e-04 3 1  ON 66
ci_68                -1.451674e-03 3 1  ON 67
ci_69                -1.609688e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8358
    reference variance = 0.801755
====================================================
  Execution time = 9.9265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0196e-01
  Total weights = 7.8564e+06
  Execution time = 1.4373e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486127427258
                                         uncertainty =       0.001348882596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486127427258
                                         uncertainty =       0.001348882596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246507945
  error estimate for blocks of size 2^( 2) =       0.000255716437
  error estimate for blocks of size 2^( 3) =       0.000264054037
  error estimate for blocks of size 2^( 4) =       0.000270076459
  error estimate for blocks of size 2^( 5) =       0.000273514770
  error estimate for blocks of size 2^( 6) =       0.000275462396
  error estimate for blocks of size 2^( 7) =       0.000276549535
  error estimate for blocks of size 2^( 8) =       0.000276667139
  error estimate for blocks of size 2^( 9) =       0.000276894684

      target function =                  N/A
              le_mean =     -22.824561176123
             les_mean =     521.543775012284
             stat err =       0.000276393439
             autocorr =       1.257168857411
              std dev =       0.697229759016
             le_variance =       0.486129336858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486081900047
                                         uncertainty =       0.001343472043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486081900047
                                         uncertainty =       0.001343472043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246496357
  error estimate for blocks of size 2^( 2) =       0.000255712042
  error estimate for blocks of size 2^( 3) =       0.000264049384
  error estimate for blocks of size 2^( 4) =       0.000270077339
  error estimate for blocks of size 2^( 5) =       0.000273501456
  error estimate for blocks of size 2^( 6) =       0.000275451154
  error estimate for blocks of size 2^( 7) =       0.000276540053
  error estimate for blocks of size 2^( 8) =       0.000276673644
  error estimate for blocks of size 2^( 9) =       0.000276892311

      target function =                  N/A
              le_mean =     -22.824561300752
             les_mean =     521.546716807827
             stat err =       0.000276389291
             autocorr =       1.257249328554
              std dev =       0.697196981831
             le_variance =       0.486083631474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486056991058
                                         uncertainty =       0.001343087658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486056991058
                                         uncertainty =       0.001343087658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246490079
  error estimate for blocks of size 2^( 2) =       0.000255705275
  error estimate for blocks of size 2^( 3) =       0.000264044090
  error estimate for blocks of size 2^( 4) =       0.000270072374
  error estimate for blocks of size 2^( 5) =       0.000273498362
  error estimate for blocks of size 2^( 6) =       0.000275450810
  error estimate for blocks of size 2^( 7) =       0.000276547289
  error estimate for blocks of size 2^( 8) =       0.000276697522
  error estimate for blocks of size 2^( 9) =       0.000276917430

      target function =                  N/A
              le_mean =     -22.824565383510
             les_mean =     521.485838390982
             stat err =       0.000276403263
             autocorr =       1.257440497769
              std dev =       0.697179225182
             le_variance =       0.486058872026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485908547068
                                         uncertainty =       0.001339666707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485908547068
                                         uncertainty =       0.001339666707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246452437
  error estimate for blocks of size 2^( 2) =       0.000255665888
  error estimate for blocks of size 2^( 3) =       0.000264004959
  error estimate for blocks of size 2^( 4) =       0.000270031058
  error estimate for blocks of size 2^( 5) =       0.000273468428
  error estimate for blocks of size 2^( 6) =       0.000275417172
  error estimate for blocks of size 2^( 7) =       0.000276520170
  error estimate for blocks of size 2^( 8) =       0.000276642778
  error estimate for blocks of size 2^( 9) =       0.000276870306

      target function =                  N/A
              le_mean =     -22.824561528261
             les_mean =     521.465913683411
             stat err =       0.000276362606
             autocorr =       1.257454630666
              std dev =       0.697072758567
             le_variance =       0.485910430736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824561176123        initial
     9.5367e-02     9.5367e-01             2.3669e-03       -22.824561300752
     3.8147e-01     3.8147e+00             1.0190e-03       -22.824565383510  <--
     1.5259e+00     1.5259e+01             3.6773e-04       -22.824561528261

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 1.7139e+02
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.088925e-01 3 1  ON 0
ci_02                -2.235973e-02 3 1  ON 1
ci_03                -2.186575e-02 3 1  ON 2
ci_04                 2.177537e-02 3 1  ON 3
ci_05                -2.139352e-02 3 1  ON 4
ci_06                -2.158896e-02 3 1  ON 5
ci_07                 2.608290e-02 3 1  ON 6
ci_08                -3.458161e-03 3 1  ON 7
ci_09                -1.069719e-02 3 1  ON 8
ci_10                -1.116864e-02 3 1  ON 9
ci_11                 1.538837e-02 3 1  ON 10
ci_12                 1.121107e-02 3 1  ON 11
ci_13                 1.200059e-02 3 1  ON 12
ci_14                 1.688716e-02 3 1  ON 13
ci_15                 7.403182e-03 3 1  ON 14
ci_16                 7.731727e-03 3 1  ON 15
ci_17                -9.329962e-03 3 1  ON 16
ci_18                -9.354410e-03 3 1  ON 17
ci_19                 9.940095e-03 3 1  ON 18
ci_20                 1.042733e-02 3 1  ON 19
ci_21                 7.989218e-03 3 1  ON 20
ci_22                 8.654871e-03 3 1  ON 21
ci_23                 7.695187e-03 3 1  ON 22
ci_24                 6.895545e-03 3 1  ON 23
ci_25                 5.721262e-03 3 1  ON 24
ci_26                 3.000954e-03 3 1  ON 25
ci_27                 2.829919e-03 3 1  ON 26
ci_28                 3.028468e-03 3 1  ON 27
ci_29                 2.851652e-03 3 1  ON 28
ci_30                 6.281367e-04 3 1  ON 29
ci_31                 8.888016e-04 3 1  ON 30
ci_32                 5.370767e-05 3 1  ON 31
ci_33                -4.760595e-05 3 1  ON 32
ci_34                -2.643985e-04 3 1  ON 33
ci_35                -3.070075e-04 3 1  ON 34
ci_36                -5.227246e-04 3 1  ON 35
ci_37                -5.940568e-04 3 1  ON 36
ci_38                -3.404754e-04 3 1  ON 37
ci_39                 1.283514e-04 3 1  ON 38
ci_40                -1.572369e-03 3 1  ON 39
ci_41                 3.356587e-04 3 1  ON 40
ci_42                 4.361130e-04 3 1  ON 41
ci_43                -2.321052e-03 3 1  ON 42
ci_44                -2.466652e-03 3 1  ON 43
ci_45                -1.391807e-04 3 1  ON 44
ci_46                 5.436219e-06 3 1  ON 45
ci_47                -5.123495e-06 3 1  ON 46
ci_48                 5.575154e-04 3 1  ON 47
ci_49                -1.541870e-03 3 1  ON 48
ci_50                -5.192718e-04 3 1  ON 49
ci_51                 2.487512e-04 3 1  ON 50
ci_52                 5.134705e-06 3 1  ON 51
ci_53                -1.389743e-03 3 1  ON 52
ci_54                -7.867267e-04 3 1  ON 53
ci_55                -8.337284e-04 3 1  ON 54
ci_56                 1.331389e-03 3 1  ON 55
ci_57                 1.882073e-03 3 1  ON 56
ci_58                -9.698097e-04 3 1  ON 57
ci_59                -1.425468e-03 3 1  ON 58
ci_60                 1.856638e-03 3 1  ON 59
ci_61                 1.825546e-03 3 1  ON 60
ci_62                -5.874724e-04 3 1  ON 61
ci_63                -6.998724e-04 3 1  ON 62
ci_64                -4.397139e-04 3 1  ON 63
ci_65                -2.283743e-04 3 1  ON 64
ci_66                -3.930879e-04 3 1  ON 65
ci_67                -6.214103e-04 3 1  ON 66
ci_68                -1.451674e-03 3 1  ON 67
ci_69                -1.609688e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9348e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8575
    reference variance = 0.769624
====================================================
  Execution time = 1.0307e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1434e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0019e-01
  Total weights = 7.856194806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8791e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484447526433
                                         uncertainty =       0.001317769145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484447526433
                                         uncertainty =       0.001317769145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246081701
  error estimate for blocks of size 2^( 2) =       0.000255333279
  error estimate for blocks of size 2^( 3) =       0.000263815226
  error estimate for blocks of size 2^( 4) =       0.000269743467
  error estimate for blocks of size 2^( 5) =       0.000273104666
  error estimate for blocks of size 2^( 6) =       0.000274741355
  error estimate for blocks of size 2^( 7) =       0.000276103792
  error estimate for blocks of size 2^( 8) =       0.000276365674
  error estimate for blocks of size 2^( 9) =       0.000276373348

      target function =                  N/A
              le_mean =     -22.824826951467
             les_mean =     521.472919509222
             stat err =       0.000275896042
             autocorr =       1.256991386053
              std dev =       0.696024157349
             le_variance =       0.484449627613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282482695147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824826951464       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824835148241       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824835890216       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824836055314       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 8.812233e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824826951464       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824831141650       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824831462747       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824831497019       residual = 5.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.327983e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824826951464       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824828369364       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824828479793       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824828495106       residual = 3.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.520343e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2188e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.086705e-01 3 1  ON 0
ci_02                -2.215057e-02 3 1  ON 1
ci_03                -2.183403e-02 3 1  ON 2
ci_04                 2.172410e-02 3 1  ON 3
ci_05                -2.142884e-02 3 1  ON 4
ci_06                -2.158372e-02 3 1  ON 5
ci_07                 2.586109e-02 3 1  ON 6
ci_08                -3.531464e-03 3 1  ON 7
ci_09                -1.081734e-02 3 1  ON 8
ci_10                -1.108714e-02 3 1  ON 9
ci_11                 1.564219e-02 3 1  ON 10
ci_12                 1.107323e-02 3 1  ON 11
ci_13                 1.182097e-02 3 1  ON 12
ci_14                 1.702784e-02 3 1  ON 13
ci_15                 7.400736e-03 3 1  ON 14
ci_16                 7.506650e-03 3 1  ON 15
ci_17                -9.216197e-03 3 1  ON 16
ci_18                -9.281647e-03 3 1  ON 17
ci_19                 9.905708e-03 3 1  ON 18
ci_20                 1.051191e-02 3 1  ON 19
ci_21                 8.151528e-03 3 1  ON 20
ci_22                 8.670706e-03 3 1  ON 21
ci_23                 7.262389e-03 3 1  ON 22
ci_24                 7.014582e-03 3 1  ON 23
ci_25                 5.595456e-03 3 1  ON 24
ci_26                 2.758088e-03 3 1  ON 25
ci_27                 2.653215e-03 3 1  ON 26
ci_28                 3.075665e-03 3 1  ON 27
ci_29                 2.816078e-03 3 1  ON 28
ci_30                 8.695494e-04 3 1  ON 29
ci_31                 8.288276e-04 3 1  ON 30
ci_32                 5.828078e-06 3 1  ON 31
ci_33                -3.379153e-05 3 1  ON 32
ci_34                -2.385330e-04 3 1  ON 33
ci_35                 1.058675e-04 3 1  ON 34
ci_36                -3.188734e-04 3 1  ON 35
ci_37                -5.738174e-04 3 1  ON 36
ci_38                -2.110957e-04 3 1  ON 37
ci_39                 7.733294e-05 3 1  ON 38
ci_40                -1.475948e-03 3 1  ON 39
ci_41                 8.748747e-05 3 1  ON 40
ci_42                 1.520825e-04 3 1  ON 41
ci_43                -2.328778e-03 3 1  ON 42
ci_44                -2.399795e-03 3 1  ON 43
ci_45                -1.082658e-04 3 1  ON 44
ci_46                -8.326387e-05 3 1  ON 45
ci_47                 2.649821e-05 3 1  ON 46
ci_48                 2.417976e-04 3 1  ON 47
ci_49                -1.768330e-03 3 1  ON 48
ci_50                -4.582130e-04 3 1  ON 49
ci_51                 1.096885e-04 3 1  ON 50
ci_52                -9.620488e-05 3 1  ON 51
ci_53                -1.169828e-03 3 1  ON 52
ci_54                -9.082036e-04 3 1  ON 53
ci_55                -9.752132e-04 3 1  ON 54
ci_56                 1.578166e-03 3 1  ON 55
ci_57                 1.773356e-03 3 1  ON 56
ci_58                -9.288647e-04 3 1  ON 57
ci_59                -1.358893e-03 3 1  ON 58
ci_60                 1.831716e-03 3 1  ON 59
ci_61                 1.841907e-03 3 1  ON 60
ci_62                -7.372874e-04 3 1  ON 61
ci_63                -4.401113e-04 3 1  ON 62
ci_64                -7.758962e-05 3 1  ON 63
ci_65                -2.323128e-04 3 1  ON 64
ci_66                -3.405956e-04 3 1  ON 65
ci_67                -6.167074e-04 3 1  ON 66
ci_68                -1.523640e-03 3 1  ON 67
ci_69                -1.719229e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7567
    reference variance = 0.609276
====================================================
  Execution time = 9.9576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0363e-01
  Total weights = 7.8572e+06
  Execution time = 1.4397e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486350571223
                                         uncertainty =       0.001258551311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486350571223
                                         uncertainty =       0.001258551311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246564947
  error estimate for blocks of size 2^( 2) =       0.000255647398
  error estimate for blocks of size 2^( 3) =       0.000263839102
  error estimate for blocks of size 2^( 4) =       0.000269674066
  error estimate for blocks of size 2^( 5) =       0.000272945098
  error estimate for blocks of size 2^( 6) =       0.000274845450
  error estimate for blocks of size 2^( 7) =       0.000276289879
  error estimate for blocks of size 2^( 8) =       0.000276947825
  error estimate for blocks of size 2^( 9) =       0.000277646747

      target function =                  N/A
              le_mean =     -22.824246015303
             les_mean =     521.468367952376
             stat err =       0.000276432475
             autocorr =       1.256942620218
              std dev =       0.697390985465
             le_variance =       0.486354186608

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.043291
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486390367263
                                         uncertainty =       0.001268375970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486390367263
                                         uncertainty =       0.001268375970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246575054
  error estimate for blocks of size 2^( 2) =       0.000255658496
  error estimate for blocks of size 2^( 3) =       0.000263851917
  error estimate for blocks of size 2^( 4) =       0.000269686241
  error estimate for blocks of size 2^( 5) =       0.000272952890
  error estimate for blocks of size 2^( 6) =       0.000274848642
  error estimate for blocks of size 2^( 7) =       0.000276287943
  error estimate for blocks of size 2^( 8) =       0.000276918935
  error estimate for blocks of size 2^( 9) =       0.000277633206

      target function =                  N/A
              le_mean =     -22.824250551002
             les_mean =     522.407217982248
             stat err =       0.000276422182
             autocorr =       1.256745984058
              std dev =       0.697419571238
             le_variance =       0.486394058346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486301446100
                                         uncertainty =       0.001263612593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486301446100
                                         uncertainty =       0.001263612593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246552518
  error estimate for blocks of size 2^( 2) =       0.000255637806
  error estimate for blocks of size 2^( 3) =       0.000263831017
  error estimate for blocks of size 2^( 4) =       0.000269667429
  error estimate for blocks of size 2^( 5) =       0.000272938727
  error estimate for blocks of size 2^( 6) =       0.000274843301
  error estimate for blocks of size 2^( 7) =       0.000276281200
  error estimate for blocks of size 2^( 8) =       0.000276924541
  error estimate for blocks of size 2^( 9) =       0.000277627236

      target function =                  N/A
              le_mean =     -22.824247838711
             les_mean =     521.451945094818
             stat err =       0.000276419070
             autocorr =       1.256947441569
              std dev =       0.697355828634
             le_variance =       0.486305151730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486312761586
                                         uncertainty =       0.001259446137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486312761586
                                         uncertainty =       0.001259446137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246555372
  error estimate for blocks of size 2^( 2) =       0.000255638538
  error estimate for blocks of size 2^( 3) =       0.000263830710
  error estimate for blocks of size 2^( 4) =       0.000269666215
  error estimate for blocks of size 2^( 5) =       0.000272937496
  error estimate for blocks of size 2^( 6) =       0.000274840778
  error estimate for blocks of size 2^( 7) =       0.000276280290
  error estimate for blocks of size 2^( 8) =       0.000276933083
  error estimate for blocks of size 2^( 9) =       0.000277634952

      target function =                  N/A
              le_mean =     -22.824243172217
             les_mean =     521.462354793953
             stat err =       0.000276422276
             autocorr =       1.256947501928
              std dev =       0.697363900558
             le_variance =       0.486316409801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824246015303        initial
     9.5367e-02     9.5367e-01             8.8122e-04       -22.824250551002  <--
     3.8147e-01     3.8147e+00             4.3280e-04       -22.824247838711
     1.5259e+00     1.5259e+01             1.5203e-04       -22.824243172217

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 1.7176e+02
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.083429e-01 3 1  ON 0
ci_02                -2.186543e-02 3 1  ON 1
ci_03                -2.180010e-02 3 1  ON 2
ci_04                 2.166304e-02 3 1  ON 3
ci_05                -2.148791e-02 3 1  ON 4
ci_06                -2.158099e-02 3 1  ON 5
ci_07                 2.561664e-02 3 1  ON 6
ci_08                -3.586364e-03 3 1  ON 7
ci_09                -1.098785e-02 3 1  ON 8
ci_10                -1.102751e-02 3 1  ON 9
ci_11                 1.595982e-02 3 1  ON 10
ci_12                 1.094111e-02 3 1  ON 11
ci_13                 1.163126e-02 3 1  ON 12
ci_14                 1.732150e-02 3 1  ON 13
ci_15                 7.392925e-03 3 1  ON 14
ci_16                 7.271362e-03 3 1  ON 15
ci_17                -9.102650e-03 3 1  ON 16
ci_18                -9.205573e-03 3 1  ON 17
ci_19                 9.878117e-03 3 1  ON 18
ci_20                 1.059503e-02 3 1  ON 19
ci_21                 8.317816e-03 3 1  ON 20
ci_22                 8.622284e-03 3 1  ON 21
ci_23                 6.887235e-03 3 1  ON 22
ci_24                 7.168232e-03 3 1  ON 23
ci_25                 5.486460e-03 3 1  ON 24
ci_26                 2.503661e-03 3 1  ON 25
ci_27                 2.431021e-03 3 1  ON 26
ci_28                 3.110425e-03 3 1  ON 27
ci_29                 2.761404e-03 3 1  ON 28
ci_30                 1.153940e-03 3 1  ON 29
ci_31                 7.673348e-04 3 1  ON 30
ci_32                -3.359045e-05 3 1  ON 31
ci_33                -1.656131e-06 3 1  ON 32
ci_34                -2.035547e-04 3 1  ON 33
ci_35                 5.742159e-04 3 1  ON 34
ci_36                -1.610036e-04 3 1  ON 35
ci_37                -5.568154e-04 3 1  ON 36
ci_38                -1.111661e-04 3 1  ON 37
ci_39                 4.240642e-05 3 1  ON 38
ci_40                -1.411914e-03 3 1  ON 39
ci_41                -1.322657e-04 3 1  ON 40
ci_42                -1.109925e-04 3 1  ON 41
ci_43                -2.364215e-03 3 1  ON 42
ci_44                -2.353887e-03 3 1  ON 43
ci_45                -8.331931e-05 3 1  ON 44
ci_46                -1.574166e-04 3 1  ON 45
ci_47                 1.045262e-04 3 1  ON 46
ci_48                -9.903656e-05 3 1  ON 47
ci_49                -1.960553e-03 3 1  ON 48
ci_50                -4.154845e-04 3 1  ON 49
ci_51                 2.465351e-07 3 1  ON 50
ci_52                -1.736417e-04 3 1  ON 51
ci_53                -1.019040e-03 3 1  ON 52
ci_54                -1.047622e-03 3 1  ON 53
ci_55                -1.130386e-03 3 1  ON 54
ci_56                 1.776177e-03 3 1  ON 55
ci_57                 1.683220e-03 3 1  ON 56
ci_58                -8.770762e-04 3 1  ON 57
ci_59                -1.285670e-03 3 1  ON 58
ci_60                 1.787933e-03 3 1  ON 59
ci_61                 1.864377e-03 3 1  ON 60
ci_62                -8.537601e-04 3 1  ON 61
ci_63                -2.606960e-04 3 1  ON 62
ci_64                 2.542872e-04 3 1  ON 63
ci_65                -2.427566e-04 3 1  ON 64
ci_66                -3.003000e-04 3 1  ON 65
ci_67                -5.970005e-04 3 1  ON 66
ci_68                -1.599973e-03 3 1  ON 67
ci_69                -1.821744e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9365e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8459
    reference variance = 0.346016
====================================================
  Execution time = 1.0375e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1379e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0697e-01
  Total weights = 7.856542006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8613e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487046865414
                                         uncertainty =       0.001501646302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487046865414
                                         uncertainty =       0.001501646302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246740595
  error estimate for blocks of size 2^( 2) =       0.000255932595
  error estimate for blocks of size 2^( 3) =       0.000264241573
  error estimate for blocks of size 2^( 4) =       0.000270078270
  error estimate for blocks of size 2^( 5) =       0.000273224507
  error estimate for blocks of size 2^( 6) =       0.000275373634
  error estimate for blocks of size 2^( 7) =       0.000276174254
  error estimate for blocks of size 2^( 8) =       0.000277931429
  error estimate for blocks of size 2^( 9) =       0.000277303294

      target function =                  N/A
              le_mean =     -22.824132550537
             les_mean =     521.447999167071
             stat err =       0.000276695653
             autocorr =       1.257544770696
              std dev =       0.697887792395
             le_variance =       0.487047370774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282413255054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824132550532       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824139938306       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824139988277       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824139840653       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824139580569       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824139657329       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-02 is 1.472701e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824132550532       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824138227795       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824138189952       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824138130379       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824138064761       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 8.227596e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824132550532       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824135498026       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824135477335       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824135466987       residual = 7.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.105289e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2238e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.084429e-01 3 1  ON 0
ci_02                -2.215675e-02 3 1  ON 1
ci_03                -2.129943e-02 3 1  ON 2
ci_04                 2.186679e-02 3 1  ON 3
ci_05                -2.140622e-02 3 1  ON 4
ci_06                -2.181638e-02 3 1  ON 5
ci_07                 2.626743e-02 3 1  ON 6
ci_08                -3.280847e-03 3 1  ON 7
ci_09                -1.106964e-02 3 1  ON 8
ci_10                -1.039111e-02 3 1  ON 9
ci_11                 1.620617e-02 3 1  ON 10
ci_12                 1.055574e-02 3 1  ON 11
ci_13                 1.184997e-02 3 1  ON 12
ci_14                 1.814426e-02 3 1  ON 13
ci_15                 7.349094e-03 3 1  ON 14
ci_16                 7.662528e-03 3 1  ON 15
ci_17                -9.404211e-03 3 1  ON 16
ci_18                -9.234572e-03 3 1  ON 17
ci_19                 1.010757e-02 3 1  ON 18
ci_20                 1.099726e-02 3 1  ON 19
ci_21                 8.241158e-03 3 1  ON 20
ci_22                 8.705550e-03 3 1  ON 21
ci_23                 6.688002e-03 3 1  ON 22
ci_24                 7.356265e-03 3 1  ON 23
ci_25                 5.529186e-03 3 1  ON 24
ci_26                 3.004672e-03 3 1  ON 25
ci_27                 2.241666e-03 3 1  ON 26
ci_28                 3.001130e-03 3 1  ON 27
ci_29                 3.010833e-03 3 1  ON 28
ci_30                 1.089456e-03 3 1  ON 29
ci_31                 6.702790e-04 3 1  ON 30
ci_32                 5.126219e-04 3 1  ON 31
ci_33                 1.622420e-04 3 1  ON 32
ci_34                -4.705565e-04 3 1  ON 33
ci_35                 1.307062e-04 3 1  ON 34
ci_36                -5.446955e-04 3 1  ON 35
ci_37                -4.449342e-04 3 1  ON 36
ci_38                -2.871875e-04 3 1  ON 37
ci_39                -1.287757e-04 3 1  ON 38
ci_40                -1.480406e-03 3 1  ON 39
ci_41                -2.115439e-04 3 1  ON 40
ci_42                -1.302798e-04 3 1  ON 41
ci_43                -2.497048e-03 3 1  ON 42
ci_44                -2.386126e-03 3 1  ON 43
ci_45                -1.880670e-05 3 1  ON 44
ci_46                -8.245148e-05 3 1  ON 45
ci_47                -1.158076e-04 3 1  ON 46
ci_48                 2.858936e-04 3 1  ON 47
ci_49                -1.694589e-03 3 1  ON 48
ci_50                -6.259271e-04 3 1  ON 49
ci_51                 9.855148e-05 3 1  ON 50
ci_52                 3.324899e-04 3 1  ON 51
ci_53                -1.326695e-03 3 1  ON 52
ci_54                -1.109470e-03 3 1  ON 53
ci_55                -7.928931e-04 3 1  ON 54
ci_56                 1.706888e-03 3 1  ON 55
ci_57                 1.794460e-03 3 1  ON 56
ci_58                -1.174974e-03 3 1  ON 57
ci_59                -1.286371e-03 3 1  ON 58
ci_60                 1.719356e-03 3 1  ON 59
ci_61                 2.325080e-03 3 1  ON 60
ci_62                -3.451059e-04 3 1  ON 61
ci_63                -6.165565e-04 3 1  ON 62
ci_64                -5.500723e-04 3 1  ON 63
ci_65                 3.150923e-05 3 1  ON 64
ci_66                -3.396287e-04 3 1  ON 65
ci_67                -2.894707e-04 3 1  ON 66
ci_68                -1.555163e-03 3 1  ON 67
ci_69                -1.840358e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8082
    reference variance = 0.316491
====================================================
  Execution time = 9.9485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0421e-01
  Total weights = 7.8562e+06
  Execution time = 1.4380e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487128415647
                                         uncertainty =       0.001236251827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487128415647
                                         uncertainty =       0.001236251827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246761786
  error estimate for blocks of size 2^( 2) =       0.000255912784
  error estimate for blocks of size 2^( 3) =       0.000264187410
  error estimate for blocks of size 2^( 4) =       0.000270169873
  error estimate for blocks of size 2^( 5) =       0.000273454769
  error estimate for blocks of size 2^( 6) =       0.000275241147
  error estimate for blocks of size 2^( 7) =       0.000275830123
  error estimate for blocks of size 2^( 8) =       0.000276696916
  error estimate for blocks of size 2^( 9) =       0.000277074431

      target function =                  N/A
              le_mean =     -22.824745251852
             les_mean =     521.635169928115
             stat err =       0.000276210654
             autocorr =       1.252924905537
              std dev =       0.697947729901
             le_variance =       0.487131033673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486765252314
                                         uncertainty =       0.001235558310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486765252314
                                         uncertainty =       0.001235558310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246669833
  error estimate for blocks of size 2^( 2) =       0.000255828628
  error estimate for blocks of size 2^( 3) =       0.000264103226
  error estimate for blocks of size 2^( 4) =       0.000270086123
  error estimate for blocks of size 2^( 5) =       0.000273372133
  error estimate for blocks of size 2^( 6) =       0.000275147657
  error estimate for blocks of size 2^( 7) =       0.000275737407
  error estimate for blocks of size 2^( 8) =       0.000276575802
  error estimate for blocks of size 2^( 9) =       0.000276961207

      target function =                  N/A
              le_mean =     -22.824734705302
             les_mean =     521.477975978065
             stat err =       0.000276105518
             autocorr =       1.252904862661
              std dev =       0.697687645100
             le_variance =       0.486768050125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487597576337
                                         uncertainty =       0.001462046639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487597576337
                                         uncertainty =       0.001462046639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246880777
  error estimate for blocks of size 2^( 2) =       0.000256036551
  error estimate for blocks of size 2^( 3) =       0.000264305637
  error estimate for blocks of size 2^( 4) =       0.000270282271
  error estimate for blocks of size 2^( 5) =       0.000273564516
  error estimate for blocks of size 2^( 6) =       0.000275342368
  error estimate for blocks of size 2^( 7) =       0.000275940110
  error estimate for blocks of size 2^( 8) =       0.000276751225
  error estimate for blocks of size 2^( 9) =       0.000277171147

      target function =                  N/A
              le_mean =     -22.824754653927
             les_mean =     521.562864695129
             stat err =       0.000276301213
             autocorr =       1.252538350410
              std dev =       0.698284285357
             le_variance =       0.487600943177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486784742586
                                         uncertainty =       0.001233550567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486784742586
                                         uncertainty =       0.001233550567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246674763
  error estimate for blocks of size 2^( 2) =       0.000255830974
  error estimate for blocks of size 2^( 3) =       0.000264105028
  error estimate for blocks of size 2^( 4) =       0.000270088525
  error estimate for blocks of size 2^( 5) =       0.000273375220
  error estimate for blocks of size 2^( 6) =       0.000275151793
  error estimate for blocks of size 2^( 7) =       0.000275738557
  error estimate for blocks of size 2^( 8) =       0.000276583833
  error estimate for blocks of size 2^( 9) =       0.000276954661

      target function =                  N/A
              le_mean =     -22.824733407717
             les_mean =     521.478220883568
             stat err =       0.000276107211
             autocorr =       1.252870142786
              std dev =       0.697701589517
             le_variance =       0.486787508015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824745251852        initial
     2.3842e-02     2.3842e-01             1.4727e-03       -22.824734705302
     9.5367e-02     9.5367e-01             8.2276e-04       -22.824754653927  <--
     3.8147e-01     3.8147e+00             4.1053e-04       -22.824733407717

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 1.7155e+02
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.084429e-01 3 1  ON 0
ci_02                -2.215675e-02 3 1  ON 1
ci_03                -2.129943e-02 3 1  ON 2
ci_04                 2.186679e-02 3 1  ON 3
ci_05                -2.140622e-02 3 1  ON 4
ci_06                -2.181638e-02 3 1  ON 5
ci_07                 2.626743e-02 3 1  ON 6
ci_08                -3.280847e-03 3 1  ON 7
ci_09                -1.106964e-02 3 1  ON 8
ci_10                -1.039111e-02 3 1  ON 9
ci_11                 1.620617e-02 3 1  ON 10
ci_12                 1.055574e-02 3 1  ON 11
ci_13                 1.184997e-02 3 1  ON 12
ci_14                 1.814426e-02 3 1  ON 13
ci_15                 7.349094e-03 3 1  ON 14
ci_16                 7.662528e-03 3 1  ON 15
ci_17                -9.404211e-03 3 1  ON 16
ci_18                -9.234572e-03 3 1  ON 17
ci_19                 1.010757e-02 3 1  ON 18
ci_20                 1.099726e-02 3 1  ON 19
ci_21                 8.241158e-03 3 1  ON 20
ci_22                 8.705550e-03 3 1  ON 21
ci_23                 6.688002e-03 3 1  ON 22
ci_24                 7.356265e-03 3 1  ON 23
ci_25                 5.529186e-03 3 1  ON 24
ci_26                 3.004672e-03 3 1  ON 25
ci_27                 2.241666e-03 3 1  ON 26
ci_28                 3.001130e-03 3 1  ON 27
ci_29                 3.010833e-03 3 1  ON 28
ci_30                 1.089456e-03 3 1  ON 29
ci_31                 6.702790e-04 3 1  ON 30
ci_32                 5.126219e-04 3 1  ON 31
ci_33                 1.622420e-04 3 1  ON 32
ci_34                -4.705565e-04 3 1  ON 33
ci_35                 1.307062e-04 3 1  ON 34
ci_36                -5.446955e-04 3 1  ON 35
ci_37                -4.449342e-04 3 1  ON 36
ci_38                -2.871875e-04 3 1  ON 37
ci_39                -1.287757e-04 3 1  ON 38
ci_40                -1.480406e-03 3 1  ON 39
ci_41                -2.115439e-04 3 1  ON 40
ci_42                -1.302798e-04 3 1  ON 41
ci_43                -2.497048e-03 3 1  ON 42
ci_44                -2.386126e-03 3 1  ON 43
ci_45                -1.880670e-05 3 1  ON 44
ci_46                -8.245148e-05 3 1  ON 45
ci_47                -1.158076e-04 3 1  ON 46
ci_48                 2.858936e-04 3 1  ON 47
ci_49                -1.694589e-03 3 1  ON 48
ci_50                -6.259271e-04 3 1  ON 49
ci_51                 9.855148e-05 3 1  ON 50
ci_52                 3.324899e-04 3 1  ON 51
ci_53                -1.326695e-03 3 1  ON 52
ci_54                -1.109470e-03 3 1  ON 53
ci_55                -7.928931e-04 3 1  ON 54
ci_56                 1.706888e-03 3 1  ON 55
ci_57                 1.794460e-03 3 1  ON 56
ci_58                -1.174974e-03 3 1  ON 57
ci_59                -1.286371e-03 3 1  ON 58
ci_60                 1.719356e-03 3 1  ON 59
ci_61                 2.325080e-03 3 1  ON 60
ci_62                -3.451059e-04 3 1  ON 61
ci_63                -6.165565e-04 3 1  ON 62
ci_64                -5.500723e-04 3 1  ON 63
ci_65                 3.150923e-05 3 1  ON 64
ci_66                -3.396287e-04 3 1  ON 65
ci_67                -2.894707e-04 3 1  ON 66
ci_68                -1.555163e-03 3 1  ON 67
ci_69                -1.840358e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9394e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.944
    reference variance = 0.454941
====================================================
  Execution time = 1.0337e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1373e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0110e-01
  Total weights = 7.856218471e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8559e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485273153265
                                         uncertainty =       0.001338481441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485273153265
                                         uncertainty =       0.001338481441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246290984
  error estimate for blocks of size 2^( 2) =       0.000255448936
  error estimate for blocks of size 2^( 3) =       0.000263757554
  error estimate for blocks of size 2^( 4) =       0.000269655230
  error estimate for blocks of size 2^( 5) =       0.000273508422
  error estimate for blocks of size 2^( 6) =       0.000275739068
  error estimate for blocks of size 2^( 7) =       0.000276354647
  error estimate for blocks of size 2^( 8) =       0.000276626642
  error estimate for blocks of size 2^( 9) =       0.000276195768

      target function =                  N/A
              le_mean =     -22.824726174884
             les_mean =     521.469224867986
             stat err =       0.000276229031
             autocorr =       1.257886959273
              std dev =       0.696616098566
             le_variance =       0.485273988782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282472617488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824726174878       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824733260863       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824733033297       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824733223743       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824733250872       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-02 is 1.227211e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824726174878       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824731611573       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824731448683       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824731567779       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824731573790       residual = 5.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 7.378874e-04

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824726174878       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824728990336       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824728975631       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824729029721       residual = 4.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.049778e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2194e+02
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.090913e-01 3 1  ON 0
ci_02                -2.201476e-02 3 1  ON 1
ci_03                -2.155052e-02 3 1  ON 2
ci_04                 2.202227e-02 3 1  ON 3
ci_05                -2.152999e-02 3 1  ON 4
ci_06                -2.174884e-02 3 1  ON 5
ci_07                 2.581844e-02 3 1  ON 6
ci_08                -3.370270e-03 3 1  ON 7
ci_09                -1.112109e-02 3 1  ON 8
ci_10                -1.102837e-02 3 1  ON 9
ci_11                 1.623610e-02 3 1  ON 10
ci_12                 1.047864e-02 3 1  ON 11
ci_13                 1.197931e-02 3 1  ON 12
ci_14                 1.745027e-02 3 1  ON 13
ci_15                 7.667691e-03 3 1  ON 14
ci_16                 7.873015e-03 3 1  ON 15
ci_17                -9.342486e-03 3 1  ON 16
ci_18                -8.832612e-03 3 1  ON 17
ci_19                 9.547669e-03 3 1  ON 18
ci_20                 1.111381e-02 3 1  ON 19
ci_21                 7.795805e-03 3 1  ON 20
ci_22                 8.525411e-03 3 1  ON 21
ci_23                 6.347313e-03 3 1  ON 22
ci_24                 7.050866e-03 3 1  ON 23
ci_25                 5.385514e-03 3 1  ON 24
ci_26                 2.855213e-03 3 1  ON 25
ci_27                 2.079709e-03 3 1  ON 26
ci_28                 2.930624e-03 3 1  ON 27
ci_29                 2.706030e-03 3 1  ON 28
ci_30                 1.012729e-03 3 1  ON 29
ci_31                 8.674662e-04 3 1  ON 30
ci_32                 9.789266e-04 3 1  ON 31
ci_33                 2.518469e-04 3 1  ON 32
ci_34                 2.040648e-04 3 1  ON 33
ci_35                -3.344950e-04 3 1  ON 34
ci_36                -5.691662e-04 3 1  ON 35
ci_37                -2.625393e-04 3 1  ON 36
ci_38                -3.726561e-04 3 1  ON 37
ci_39                 1.140716e-04 3 1  ON 38
ci_40                -1.313645e-03 3 1  ON 39
ci_41                -4.452307e-06 3 1  ON 40
ci_42                -8.947771e-06 3 1  ON 41
ci_43                -2.354122e-03 3 1  ON 42
ci_44                -1.891347e-03 3 1  ON 43
ci_45                 9.561303e-05 3 1  ON 44
ci_46                -3.241539e-04 3 1  ON 45
ci_47                 1.494305e-04 3 1  ON 46
ci_48                -1.558546e-04 3 1  ON 47
ci_49                -9.567013e-04 3 1  ON 48
ci_50                -7.243428e-04 3 1  ON 49
ci_51                -3.041932e-04 3 1  ON 50
ci_52                -4.007613e-05 3 1  ON 51
ci_53                -1.211267e-03 3 1  ON 52
ci_54                -1.047685e-03 3 1  ON 53
ci_55                -7.894695e-04 3 1  ON 54
ci_56                 1.996155e-03 3 1  ON 55
ci_57                 1.341229e-03 3 1  ON 56
ci_58                -9.149615e-04 3 1  ON 57
ci_59                -1.442643e-03 3 1  ON 58
ci_60                 1.764127e-03 3 1  ON 59
ci_61                 2.546191e-03 3 1  ON 60
ci_62                -3.988440e-04 3 1  ON 61
ci_63                -8.374350e-05 3 1  ON 62
ci_64                -5.083143e-04 3 1  ON 63
ci_65                -2.001147e-04 3 1  ON 64
ci_66                -1.242760e-04 3 1  ON 65
ci_67                 4.281579e-05 3 1  ON 66
ci_68                -2.141995e-03 3 1  ON 67
ci_69                -2.476332e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7868
    reference variance = 0.483321
====================================================
  Execution time = 9.9271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0457e-01
  Total weights = 7.8565e+06
  Execution time = 1.4362e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491714120659
                                         uncertainty =       0.003770984748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491714120659
                                         uncertainty =       0.003770984748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247918247
  error estimate for blocks of size 2^( 2) =       0.000257020132
  error estimate for blocks of size 2^( 3) =       0.000265297670
  error estimate for blocks of size 2^( 4) =       0.000271340476
  error estimate for blocks of size 2^( 5) =       0.000274696418
  error estimate for blocks of size 2^( 6) =       0.000276792474
  error estimate for blocks of size 2^( 7) =       0.000278471104
  error estimate for blocks of size 2^( 8) =       0.000279255514
  error estimate for blocks of size 2^( 9) =       0.000279367906

      target function =                  N/A
              le_mean =     -22.824739140280
             les_mean =     547.271192050487
             stat err =       0.000278471749
             autocorr =       1.261668618637
              std dev =       0.701218694766
             le_variance =       0.491707657889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488430454581
                                         uncertainty =       0.001540986411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488430454581
                                         uncertainty =       0.001540986411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247090218
  error estimate for blocks of size 2^( 2) =       0.000256216115
  error estimate for blocks of size 2^( 3) =       0.000264506873
  error estimate for blocks of size 2^( 4) =       0.000270556083
  error estimate for blocks of size 2^( 5) =       0.000273908719
  error estimate for blocks of size 2^( 6) =       0.000275965628
  error estimate for blocks of size 2^( 7) =       0.000277602530
  error estimate for blocks of size 2^( 8) =       0.000278402804
  error estimate for blocks of size 2^( 9) =       0.000278575514

      target function =                  N/A
              le_mean =     -22.824703339204
             les_mean =     521.501159905328
             stat err =       0.000277636619
             autocorr =       1.262531984999
              std dev =       0.698876674690
             le_variance =       0.488428606425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488628083855
                                         uncertainty =       0.001542517106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488628083855
                                         uncertainty =       0.001542517106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247140192
  error estimate for blocks of size 2^( 2) =       0.000256264440
  error estimate for blocks of size 2^( 3) =       0.000264551132
  error estimate for blocks of size 2^( 4) =       0.000270594774
  error estimate for blocks of size 2^( 5) =       0.000273947055
  error estimate for blocks of size 2^( 6) =       0.000275996774
  error estimate for blocks of size 2^( 7) =       0.000277626657
  error estimate for blocks of size 2^( 8) =       0.000278422187
  error estimate for blocks of size 2^( 9) =       0.000278602930

      target function =                  N/A
              le_mean =     -22.824719379819
             les_mean =     521.489877370978
             stat err =       0.000277662137
             autocorr =       1.262253444380
              std dev =       0.699018022356
             le_variance =       0.488626195578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488321884671
                                         uncertainty =       0.001536530531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488321884671
                                         uncertainty =       0.001536530531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247062770
  error estimate for blocks of size 2^( 2) =       0.000256194013
  error estimate for blocks of size 2^( 3) =       0.000264490353
  error estimate for blocks of size 2^( 4) =       0.000270544297
  error estimate for blocks of size 2^( 5) =       0.000273899893
  error estimate for blocks of size 2^( 6) =       0.000275958456
  error estimate for blocks of size 2^( 7) =       0.000277594597
  error estimate for blocks of size 2^( 8) =       0.000278389328
  error estimate for blocks of size 2^( 9) =       0.000278577514

      target function =                  N/A
              le_mean =     -22.824705745947
             les_mean =     521.474850965443
             stat err =       0.000277629974
             autocorr =       1.262752075415
              std dev =       0.698799040491
             le_variance =       0.488320098990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824739140280        initial  <--
     2.3842e-02     2.3842e-01             1.2272e-03       -22.824703339204
     9.5367e-02     9.5367e-01             7.3789e-04       -22.824719379819
     3.8147e-01     3.8147e+00             4.0498e-04       -22.824705745947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.3888
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.084429e-01 3 1  ON 0
ci_02                -2.215675e-02 3 1  ON 1
ci_03                -2.129943e-02 3 1  ON 2
ci_04                 2.186679e-02 3 1  ON 3
ci_05                -2.140622e-02 3 1  ON 4
ci_06                -2.181638e-02 3 1  ON 5
ci_07                 2.626743e-02 3 1  ON 6
ci_08                -3.280847e-03 3 1  ON 7
ci_09                -1.106964e-02 3 1  ON 8
ci_10                -1.039111e-02 3 1  ON 9
ci_11                 1.620617e-02 3 1  ON 10
ci_12                 1.055574e-02 3 1  ON 11
ci_13                 1.184997e-02 3 1  ON 12
ci_14                 1.814426e-02 3 1  ON 13
ci_15                 7.349094e-03 3 1  ON 14
ci_16                 7.662528e-03 3 1  ON 15
ci_17                -9.404211e-03 3 1  ON 16
ci_18                -9.234572e-03 3 1  ON 17
ci_19                 1.010757e-02 3 1  ON 18
ci_20                 1.099726e-02 3 1  ON 19
ci_21                 8.241158e-03 3 1  ON 20
ci_22                 8.705550e-03 3 1  ON 21
ci_23                 6.688002e-03 3 1  ON 22
ci_24                 7.356265e-03 3 1  ON 23
ci_25                 5.529186e-03 3 1  ON 24
ci_26                 3.004672e-03 3 1  ON 25
ci_27                 2.241666e-03 3 1  ON 26
ci_28                 3.001130e-03 3 1  ON 27
ci_29                 3.010833e-03 3 1  ON 28
ci_30                 1.089456e-03 3 1  ON 29
ci_31                 6.702790e-04 3 1  ON 30
ci_32                 5.126219e-04 3 1  ON 31
ci_33                 1.622420e-04 3 1  ON 32
ci_34                -4.705565e-04 3 1  ON 33
ci_35                 1.307062e-04 3 1  ON 34
ci_36                -5.446955e-04 3 1  ON 35
ci_37                -4.449342e-04 3 1  ON 36
ci_38                -2.871875e-04 3 1  ON 37
ci_39                -1.287757e-04 3 1  ON 38
ci_40                -1.480406e-03 3 1  ON 39
ci_41                -2.115439e-04 3 1  ON 40
ci_42                -1.302798e-04 3 1  ON 41
ci_43                -2.497048e-03 3 1  ON 42
ci_44                -2.386126e-03 3 1  ON 43
ci_45                -1.880670e-05 3 1  ON 44
ci_46                -8.245148e-05 3 1  ON 45
ci_47                -1.158076e-04 3 1  ON 46
ci_48                 2.858936e-04 3 1  ON 47
ci_49                -1.694589e-03 3 1  ON 48
ci_50                -6.259271e-04 3 1  ON 49
ci_51                 9.855148e-05 3 1  ON 50
ci_52                 3.324899e-04 3 1  ON 51
ci_53                -1.326695e-03 3 1  ON 52
ci_54                -1.109470e-03 3 1  ON 53
ci_55                -7.928931e-04 3 1  ON 54
ci_56                 1.706888e-03 3 1  ON 55
ci_57                 1.794460e-03 3 1  ON 56
ci_58                -1.174974e-03 3 1  ON 57
ci_59                -1.286371e-03 3 1  ON 58
ci_60                 1.719356e-03 3 1  ON 59
ci_61                 2.325080e-03 3 1  ON 60
ci_62                -3.451059e-04 3 1  ON 61
ci_63                -6.165565e-04 3 1  ON 62
ci_64                -5.500723e-04 3 1  ON 63
ci_65                 3.150923e-05 3 1  ON 64
ci_66                -3.396287e-04 3 1  ON 65
ci_67                -2.894707e-04 3 1  ON 66
ci_68                -1.555163e-03 3 1  ON 67
ci_69                -1.840358e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9333e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8674
    reference variance = 0.336983
====================================================
  Execution time = 1.0323e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1369e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0812e-01
  Total weights = 7.856712128e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8622e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489581622962
                                         uncertainty =       0.002557091079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489581622962
                                         uncertainty =       0.002557091079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247382630
  error estimate for blocks of size 2^( 2) =       0.000256499167
  error estimate for blocks of size 2^( 3) =       0.000264686505
  error estimate for blocks of size 2^( 4) =       0.000270462453
  error estimate for blocks of size 2^( 5) =       0.000274125731
  error estimate for blocks of size 2^( 6) =       0.000275472662
  error estimate for blocks of size 2^( 7) =       0.000276309649
  error estimate for blocks of size 2^( 8) =       0.000277040513
  error estimate for blocks of size 2^( 9) =       0.000277617995

      target function =                  N/A
              le_mean =     -22.824533854897
             les_mean =     521.467467916721
             stat err =       0.000276610205
             autocorr =       1.250253249042
              std dev =       0.699703740857
             le_variance =       0.489585324969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282453385490e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824533854890       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824536851573       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824536969077       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824537015337       residual = 6.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 6.109148e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824533854890       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824534990580       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824534983971       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824534995316       residual = 3.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.250733e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824533854890       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824534180856       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824534173643       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824534176319       residual = 5.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 6.384075e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2187e+02
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.084878e-01 3 1  ON 0
ci_02                -2.201768e-02 3 1  ON 1
ci_03                -2.135864e-02 3 1  ON 2
ci_04                 2.186512e-02 3 1  ON 3
ci_05                -2.138215e-02 3 1  ON 4
ci_06                -2.176570e-02 3 1  ON 5
ci_07                 2.616259e-02 3 1  ON 6
ci_08                -3.297397e-03 3 1  ON 7
ci_09                -1.100914e-02 3 1  ON 8
ci_10                -1.049501e-02 3 1  ON 9
ci_11                 1.614984e-02 3 1  ON 10
ci_12                 1.071844e-02 3 1  ON 11
ci_13                 1.184515e-02 3 1  ON 12
ci_14                 1.808655e-02 3 1  ON 13
ci_15                 7.448786e-03 3 1  ON 14
ci_16                 7.599449e-03 3 1  ON 15
ci_17                -9.269764e-03 3 1  ON 16
ci_18                -9.267673e-03 3 1  ON 17
ci_19                 9.996746e-03 3 1  ON 18
ci_20                 1.099068e-02 3 1  ON 19
ci_21                 8.284891e-03 3 1  ON 20
ci_22                 8.739925e-03 3 1  ON 21
ci_23                 6.730526e-03 3 1  ON 22
ci_24                 7.366428e-03 3 1  ON 23
ci_25                 5.556866e-03 3 1  ON 24
ci_26                 2.937981e-03 3 1  ON 25
ci_27                 2.283001e-03 3 1  ON 26
ci_28                 3.047034e-03 3 1  ON 27
ci_29                 3.013323e-03 3 1  ON 28
ci_30                 1.129173e-03 3 1  ON 29
ci_31                 7.493328e-04 3 1  ON 30
ci_32                 5.239508e-04 3 1  ON 31
ci_33                 1.893648e-04 3 1  ON 32
ci_34                -2.955455e-04 3 1  ON 33
ci_35                 9.315203e-05 3 1  ON 34
ci_36                -5.025244e-04 3 1  ON 35
ci_37                -4.575835e-04 3 1  ON 36
ci_38                -2.509510e-04 3 1  ON 37
ci_39                -1.185060e-04 3 1  ON 38
ci_40                -1.335347e-03 3 1  ON 39
ci_41                -1.768973e-04 3 1  ON 40
ci_42                -8.333350e-05 3 1  ON 41
ci_43                -2.271975e-03 3 1  ON 42
ci_44                -2.340393e-03 3 1  ON 43
ci_45                -1.472876e-04 3 1  ON 44
ci_46                -1.005772e-04 3 1  ON 45
ci_47                -4.642511e-05 3 1  ON 46
ci_48                 2.042804e-04 3 1  ON 47
ci_49                -1.618078e-03 3 1  ON 48
ci_50                -6.054091e-04 3 1  ON 49
ci_51                 3.337802e-05 3 1  ON 50
ci_52                 2.814282e-04 3 1  ON 51
ci_53                -1.261770e-03 3 1  ON 52
ci_54                -1.009895e-03 3 1  ON 53
ci_55                -8.115868e-04 3 1  ON 54
ci_56                 1.671916e-03 3 1  ON 55
ci_57                 1.727336e-03 3 1  ON 56
ci_58                -1.142026e-03 3 1  ON 57
ci_59                -1.338876e-03 3 1  ON 58
ci_60                 1.710947e-03 3 1  ON 59
ci_61                 2.386078e-03 3 1  ON 60
ci_62                -4.418907e-04 3 1  ON 61
ci_63                -7.235937e-04 3 1  ON 62
ci_64                -5.635058e-04 3 1  ON 63
ci_65                -3.326045e-05 3 1  ON 64
ci_66                -3.299992e-04 3 1  ON 65
ci_67                -3.565241e-04 3 1  ON 66
ci_68                -1.549302e-03 3 1  ON 67
ci_69                -1.960603e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.9324
    reference variance = 0.364651
====================================================
  Execution time = 9.9433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0151e-01
  Total weights = 7.8566e+06
  Execution time = 1.4386e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487034075538
                                         uncertainty =       0.002431577401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487034075538
                                         uncertainty =       0.002431577401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246737335
  error estimate for blocks of size 2^( 2) =       0.000255948583
  error estimate for blocks of size 2^( 3) =       0.000264184290
  error estimate for blocks of size 2^( 4) =       0.000270163874
  error estimate for blocks of size 2^( 5) =       0.000273593919
  error estimate for blocks of size 2^( 6) =       0.000275917568
  error estimate for blocks of size 2^( 7) =       0.000277531939
  error estimate for blocks of size 2^( 8) =       0.000277640436
  error estimate for blocks of size 2^( 9) =       0.000279227957

      target function =                  N/A
              le_mean =     -22.825230404805
             les_mean =     521.871864287471
             stat err =       0.000277579475
             autocorr =       1.265624756683
              std dev =       0.697878570177
             le_variance =       0.487034498713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487010327644
                                         uncertainty =       0.002437555712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487010327644
                                         uncertainty =       0.002437555712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246731354
  error estimate for blocks of size 2^( 2) =       0.000255941845
  error estimate for blocks of size 2^( 3) =       0.000264177424
  error estimate for blocks of size 2^( 4) =       0.000270155792
  error estimate for blocks of size 2^( 5) =       0.000273584437
  error estimate for blocks of size 2^( 6) =       0.000275903577
  error estimate for blocks of size 2^( 7) =       0.000277512533
  error estimate for blocks of size 2^( 8) =       0.000277623203
  error estimate for blocks of size 2^( 9) =       0.000279186423

      target function =                  N/A
              le_mean =     -22.825228962063
             les_mean =     521.512572236977
             stat err =       0.000277556434
             autocorr =       1.265476000462
              std dev =       0.697861655376
             le_variance =       0.487010890045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986902726
                                         uncertainty =       0.002437354866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486986902726
                                         uncertainty =       0.002437354866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246725415
  error estimate for blocks of size 2^( 2) =       0.000255936369
  error estimate for blocks of size 2^( 3) =       0.000264171544
  error estimate for blocks of size 2^( 4) =       0.000270149655
  error estimate for blocks of size 2^( 5) =       0.000273578531
  error estimate for blocks of size 2^( 6) =       0.000275899042
  error estimate for blocks of size 2^( 7) =       0.000277508006
  error estimate for blocks of size 2^( 8) =       0.000277620667
  error estimate for blocks of size 2^( 9) =       0.000279182452

      target function =                  N/A
              le_mean =     -22.825227043444
             les_mean =     521.503352594127
             stat err =       0.000277552541
             autocorr =       1.265501430276
              std dev =       0.697844856353
             le_variance =       0.486987443539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486965870501
                                         uncertainty =       0.002434617149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486965870501
                                         uncertainty =       0.002434617149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246720066
  error estimate for blocks of size 2^( 2) =       0.000255931479
  error estimate for blocks of size 2^( 3) =       0.000264166569
  error estimate for blocks of size 2^( 4) =       0.000270143970
  error estimate for blocks of size 2^( 5) =       0.000273573312
  error estimate for blocks of size 2^( 6) =       0.000275897565
  error estimate for blocks of size 2^( 7) =       0.000277507490
  error estimate for blocks of size 2^( 8) =       0.000277625694
  error estimate for blocks of size 2^( 9) =       0.000279191563

      target function =                  N/A
              le_mean =     -22.825226748642
             les_mean =     521.504095228986
             stat err =       0.000277555578
             autocorr =       1.265583997743
              std dev =       0.697829726653
             le_variance =       0.486966327401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825230404805        initial  <--
     2.3842e-01     2.3842e+00             6.1091e-04       -22.825228962063
     9.5367e-01     9.5367e+00             2.2507e-04       -22.825227043444
     3.8147e+00     3.8147e+01             6.3841e-05       -22.825226748642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.4256
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.084429e-01 3 1  ON 0
ci_02                -2.215675e-02 3 1  ON 1
ci_03                -2.129943e-02 3 1  ON 2
ci_04                 2.186679e-02 3 1  ON 3
ci_05                -2.140622e-02 3 1  ON 4
ci_06                -2.181638e-02 3 1  ON 5
ci_07                 2.626743e-02 3 1  ON 6
ci_08                -3.280847e-03 3 1  ON 7
ci_09                -1.106964e-02 3 1  ON 8
ci_10                -1.039111e-02 3 1  ON 9
ci_11                 1.620617e-02 3 1  ON 10
ci_12                 1.055574e-02 3 1  ON 11
ci_13                 1.184997e-02 3 1  ON 12
ci_14                 1.814426e-02 3 1  ON 13
ci_15                 7.349094e-03 3 1  ON 14
ci_16                 7.662528e-03 3 1  ON 15
ci_17                -9.404211e-03 3 1  ON 16
ci_18                -9.234572e-03 3 1  ON 17
ci_19                 1.010757e-02 3 1  ON 18
ci_20                 1.099726e-02 3 1  ON 19
ci_21                 8.241158e-03 3 1  ON 20
ci_22                 8.705550e-03 3 1  ON 21
ci_23                 6.688002e-03 3 1  ON 22
ci_24                 7.356265e-03 3 1  ON 23
ci_25                 5.529186e-03 3 1  ON 24
ci_26                 3.004672e-03 3 1  ON 25
ci_27                 2.241666e-03 3 1  ON 26
ci_28                 3.001130e-03 3 1  ON 27
ci_29                 3.010833e-03 3 1  ON 28
ci_30                 1.089456e-03 3 1  ON 29
ci_31                 6.702790e-04 3 1  ON 30
ci_32                 5.126219e-04 3 1  ON 31
ci_33                 1.622420e-04 3 1  ON 32
ci_34                -4.705565e-04 3 1  ON 33
ci_35                 1.307062e-04 3 1  ON 34
ci_36                -5.446955e-04 3 1  ON 35
ci_37                -4.449342e-04 3 1  ON 36
ci_38                -2.871875e-04 3 1  ON 37
ci_39                -1.287757e-04 3 1  ON 38
ci_40                -1.480406e-03 3 1  ON 39
ci_41                -2.115439e-04 3 1  ON 40
ci_42                -1.302798e-04 3 1  ON 41
ci_43                -2.497048e-03 3 1  ON 42
ci_44                -2.386126e-03 3 1  ON 43
ci_45                -1.880670e-05 3 1  ON 44
ci_46                -8.245148e-05 3 1  ON 45
ci_47                -1.158076e-04 3 1  ON 46
ci_48                 2.858936e-04 3 1  ON 47
ci_49                -1.694589e-03 3 1  ON 48
ci_50                -6.259271e-04 3 1  ON 49
ci_51                 9.855148e-05 3 1  ON 50
ci_52                 3.324899e-04 3 1  ON 51
ci_53                -1.326695e-03 3 1  ON 52
ci_54                -1.109470e-03 3 1  ON 53
ci_55                -7.928931e-04 3 1  ON 54
ci_56                 1.706888e-03 3 1  ON 55
ci_57                 1.794460e-03 3 1  ON 56
ci_58                -1.174974e-03 3 1  ON 57
ci_59                -1.286371e-03 3 1  ON 58
ci_60                 1.719356e-03 3 1  ON 59
ci_61                 2.325080e-03 3 1  ON 60
ci_62                -3.451059e-04 3 1  ON 61
ci_63                -6.165565e-04 3 1  ON 62
ci_64                -5.500723e-04 3 1  ON 63
ci_65                 3.150923e-05 3 1  ON 64
ci_66                -3.396287e-04 3 1  ON 65
ci_67                -2.894707e-04 3 1  ON 66
ci_68                -1.555163e-03 3 1  ON 67
ci_69                -1.840358e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9331e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8358
    reference variance = 0.380285
====================================================
  Execution time = 1.0330e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1407e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1269e-01
  Total weights = 7.857439477e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8437e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491489184553
                                         uncertainty =       0.003844897488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491489184553
                                         uncertainty =       0.003844897488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247864595
  error estimate for blocks of size 2^( 2) =       0.000257033953
  error estimate for blocks of size 2^( 3) =       0.000265262498
  error estimate for blocks of size 2^( 4) =       0.000271147835
  error estimate for blocks of size 2^( 5) =       0.000274776712
  error estimate for blocks of size 2^( 6) =       0.000276994414
  error estimate for blocks of size 2^( 7) =       0.000277872698
  error estimate for blocks of size 2^( 8) =       0.000277829092
  error estimate for blocks of size 2^( 9) =       0.000278395645

      target function =                  N/A
              le_mean =     -22.824715047015
             les_mean =     521.480304207650
             stat err =       0.000277772962
             autocorr =       1.255888107339
              std dev =       0.701066943438
             le_variance =       0.491494859182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282471504701e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824715047012       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824715709664       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824715753885       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824715760474       residual = 6.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.186990e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824715047012       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824715223663       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824715237689       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824715239056       residual = 7.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 3.224004e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824715047012       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824715091919       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824715095637       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824715095971       residual = 7.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+01 is 8.238366e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2175e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.084363e-01 3 1  ON 0
ci_02                -2.216222e-02 3 1  ON 1
ci_03                -2.129597e-02 3 1  ON 2
ci_04                 2.187749e-02 3 1  ON 3
ci_05                -2.141107e-02 3 1  ON 4
ci_06                -2.181644e-02 3 1  ON 5
ci_07                 2.625982e-02 3 1  ON 6
ci_08                -3.289371e-03 3 1  ON 7
ci_09                -1.105253e-02 3 1  ON 8
ci_10                -1.041050e-02 3 1  ON 9
ci_11                 1.621781e-02 3 1  ON 10
ci_12                 1.053375e-02 3 1  ON 11
ci_13                 1.185450e-02 3 1  ON 12
ci_14                 1.813437e-02 3 1  ON 13
ci_15                 7.335066e-03 3 1  ON 14
ci_16                 7.674729e-03 3 1  ON 15
ci_17                -9.392988e-03 3 1  ON 16
ci_18                -9.245677e-03 3 1  ON 17
ci_19                 1.012095e-02 3 1  ON 18
ci_20                 1.099140e-02 3 1  ON 19
ci_21                 8.236584e-03 3 1  ON 20
ci_22                 8.688876e-03 3 1  ON 21
ci_23                 6.679408e-03 3 1  ON 22
ci_24                 7.360004e-03 3 1  ON 23
ci_25                 5.516208e-03 3 1  ON 24
ci_26                 3.009212e-03 3 1  ON 25
ci_27                 2.229145e-03 3 1  ON 26
ci_28                 2.998005e-03 3 1  ON 27
ci_29                 3.016631e-03 3 1  ON 28
ci_30                 1.077307e-03 3 1  ON 29
ci_31                 6.760075e-04 3 1  ON 30
ci_32                 4.959159e-04 3 1  ON 31
ci_33                 1.377975e-04 3 1  ON 32
ci_34                -4.707033e-04 3 1  ON 33
ci_35                 1.106624e-04 3 1  ON 34
ci_36                -5.401260e-04 3 1  ON 35
ci_37                -4.426156e-04 3 1  ON 36
ci_38                -2.829356e-04 3 1  ON 37
ci_39                -1.251216e-04 3 1  ON 38
ci_40                -1.492129e-03 3 1  ON 39
ci_41                -2.115548e-04 3 1  ON 40
ci_42                -1.395943e-04 3 1  ON 41
ci_43                -2.505268e-03 3 1  ON 42
ci_44                -2.370758e-03 3 1  ON 43
ci_45                -2.285675e-05 3 1  ON 44
ci_46                -9.815728e-05 3 1  ON 45
ci_47                -1.157895e-04 3 1  ON 46
ci_48                 2.902501e-04 3 1  ON 47
ci_49                -1.688797e-03 3 1  ON 48
ci_50                -6.313722e-04 3 1  ON 49
ci_51                 9.188053e-05 3 1  ON 50
ci_52                 3.046168e-04 3 1  ON 51
ci_53                -1.309025e-03 3 1  ON 52
ci_54                -1.103370e-03 3 1  ON 53
ci_55                -8.016492e-04 3 1  ON 54
ci_56                 1.689100e-03 3 1  ON 55
ci_57                 1.826700e-03 3 1  ON 56
ci_58                -1.185802e-03 3 1  ON 57
ci_59                -1.290712e-03 3 1  ON 58
ci_60                 1.725389e-03 3 1  ON 59
ci_61                 2.325976e-03 3 1  ON 60
ci_62                -3.391553e-04 3 1  ON 61
ci_63                -6.215954e-04 3 1  ON 62
ci_64                -5.390328e-04 3 1  ON 63
ci_65                 2.390185e-05 3 1  ON 64
ci_66                -3.371196e-04 3 1  ON 65
ci_67                -2.932061e-04 3 1  ON 66
ci_68                -1.542937e-03 3 1  ON 67
ci_69                -1.826690e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7332
    reference variance = 0.532078
====================================================
  Execution time = 9.9080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0296e-01
  Total weights = 7.8567e+06
  Execution time = 1.4333e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486322036716
                                         uncertainty =       0.001191004573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486322036716
                                         uncertainty =       0.001191004573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246557295
  error estimate for blocks of size 2^( 2) =       0.000255842132
  error estimate for blocks of size 2^( 3) =       0.000264171479
  error estimate for blocks of size 2^( 4) =       0.000269977166
  error estimate for blocks of size 2^( 5) =       0.000273687871
  error estimate for blocks of size 2^( 6) =       0.000275669794
  error estimate for blocks of size 2^( 7) =       0.000276337377
  error estimate for blocks of size 2^( 8) =       0.000276829657
  error estimate for blocks of size 2^( 9) =       0.000277337465

      target function =                  N/A
              le_mean =     -22.825101871764
             les_mean =     521.488224352769
             stat err =       0.000276543573
             autocorr =       1.258031239771
              std dev =       0.697369342302
             le_variance =       0.486323999583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486319605659
                                         uncertainty =       0.001189525338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486319605659
                                         uncertainty =       0.001189525338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246556679
  error estimate for blocks of size 2^( 2) =       0.000255840841
  error estimate for blocks of size 2^( 3) =       0.000264169968
  error estimate for blocks of size 2^( 4) =       0.000269975793
  error estimate for blocks of size 2^( 5) =       0.000273686211
  error estimate for blocks of size 2^( 6) =       0.000275669436
  error estimate for blocks of size 2^( 7) =       0.000276337044
  error estimate for blocks of size 2^( 8) =       0.000276830982
  error estimate for blocks of size 2^( 9) =       0.000277338086

      target function =                  N/A
              le_mean =     -22.825102198212
             les_mean =     521.525145553171
             stat err =       0.000276543887
             autocorr =       1.258040379496
              std dev =       0.697367600066
             le_variance =       0.486321569622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486320032479
                                         uncertainty =       0.001190202613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486320032479
                                         uncertainty =       0.001190202613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246556788
  error estimate for blocks of size 2^( 2) =       0.000255841275
  error estimate for blocks of size 2^( 3) =       0.000264170538
  error estimate for blocks of size 2^( 4) =       0.000269976317
  error estimate for blocks of size 2^( 5) =       0.000273686724
  error estimate for blocks of size 2^( 6) =       0.000275669129
  error estimate for blocks of size 2^( 7) =       0.000276336649
  error estimate for blocks of size 2^( 8) =       0.000276829752
  error estimate for blocks of size 2^( 9) =       0.000277337105

      target function =                  N/A
              le_mean =     -22.825101870461
             les_mean =     521.488428212463
             stat err =       0.000276543159
             autocorr =       1.258032650271
              std dev =       0.697367905726
             le_variance =       0.486321995937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486321710864
                                         uncertainty =       0.001190901388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486321710864
                                         uncertainty =       0.001190901388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246557213
  error estimate for blocks of size 2^( 2) =       0.000255842005
  error estimate for blocks of size 2^( 3) =       0.000264171342
  error estimate for blocks of size 2^( 4) =       0.000269977039
  error estimate for blocks of size 2^( 5) =       0.000273687707
  error estimate for blocks of size 2^( 6) =       0.000275669691
  error estimate for blocks of size 2^( 7) =       0.000276337259
  error estimate for blocks of size 2^( 8) =       0.000276829642
  error estimate for blocks of size 2^( 9) =       0.000277337390

      target function =                  N/A
              le_mean =     -22.825101862563
             les_mean =     521.488285375950
             stat err =       0.000276543496
             autocorr =       1.258031374227
              std dev =       0.697369108724
             le_variance =       0.486323673803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825101871764        initial
     2.3842e+00     2.3842e+01             1.1870e-04       -22.825102198212  <--
     9.5367e+00     9.5367e+01             3.2240e-05       -22.825101870461
     3.8147e+01     3.8147e+02             8.2384e-06       -22.825101862563

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 1.7071e+02
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.084170e-01 3 1  ON 0
ci_02                -2.217806e-02 3 1  ON 1
ci_03                -2.128624e-02 3 1  ON 2
ci_04                 2.190588e-02 3 1  ON 3
ci_05                -2.142440e-02 3 1  ON 4
ci_06                -2.181657e-02 3 1  ON 5
ci_07                 2.623800e-02 3 1  ON 6
ci_08                -3.311978e-03 3 1  ON 7
ci_09                -1.100472e-02 3 1  ON 8
ci_10                -1.046525e-02 3 1  ON 9
ci_11                 1.625013e-02 3 1  ON 10
ci_12                 1.047225e-02 3 1  ON 11
ci_13                 1.186692e-02 3 1  ON 12
ci_14                 1.810567e-02 3 1  ON 13
ci_15                 7.296147e-03 3 1  ON 14
ci_16                 7.708672e-03 3 1  ON 15
ci_17                -9.361437e-03 3 1  ON 16
ci_18                -9.277385e-03 3 1  ON 17
ci_19                 1.015649e-02 3 1  ON 18
ci_20                 1.097451e-02 3 1  ON 19
ci_21                 8.223867e-03 3 1  ON 20
ci_22                 8.641755e-03 3 1  ON 21
ci_23                 6.655837e-03 3 1  ON 22
ci_24                 7.370826e-03 3 1  ON 23
ci_25                 5.480525e-03 3 1  ON 24
ci_26                 3.021671e-03 3 1  ON 25
ci_27                 2.194946e-03 3 1  ON 26
ci_28                 2.989323e-03 3 1  ON 27
ci_29                 3.032921e-03 3 1  ON 28
ci_30                 1.043189e-03 3 1  ON 29
ci_31                 6.931715e-04 3 1  ON 30
ci_32                 4.514219e-04 3 1  ON 31
ci_33                 7.161034e-05 3 1  ON 32
ci_34                -4.711315e-04 3 1  ON 33
ci_35                 5.417401e-05 3 1  ON 34
ci_36                -5.276437e-04 3 1  ON 35
ci_37                -4.360331e-04 3 1  ON 36
ci_38                -2.713033e-04 3 1  ON 37
ci_39                -1.147028e-04 3 1  ON 38
ci_40                -1.522701e-03 3 1  ON 39
ci_41                -2.114681e-04 3 1  ON 40
ci_42                -1.641435e-04 3 1  ON 41
ci_43                -2.528849e-03 3 1  ON 42
ci_44                -2.327828e-03 3 1  ON 43
ci_45                -3.368597e-05 3 1  ON 44
ci_46                -1.406901e-04 3 1  ON 45
ci_47                -1.156259e-04 3 1  ON 46
ci_48                 3.024025e-04 3 1  ON 47
ci_49                -1.672955e-03 3 1  ON 48
ci_50                -6.454046e-04 3 1  ON 49
ci_51                 7.420279e-05 3 1  ON 50
ci_52                 2.291849e-04 3 1  ON 51
ci_53                -1.262408e-03 3 1  ON 52
ci_54                -1.086158e-03 3 1  ON 53
ci_55                -8.259276e-04 3 1  ON 54
ci_56                 1.640303e-03 3 1  ON 55
ci_57                 1.913159e-03 3 1  ON 56
ci_58                -1.215864e-03 3 1  ON 57
ci_59                -1.302808e-03 3 1  ON 58
ci_60                 1.742991e-03 3 1  ON 59
ci_61                 2.328454e-03 3 1  ON 60
ci_62                -3.236477e-04 3 1  ON 61
ci_63                -6.349748e-04 3 1  ON 62
ci_64                -5.087454e-04 3 1  ON 63
ci_65                 2.895704e-06 3 1  ON 64
ci_66                -3.302338e-04 3 1  ON 65
ci_67                -3.031541e-04 3 1  ON 66
ci_68                -1.509212e-03 3 1  ON 67
ci_69                -1.788932e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9247e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.896
    reference variance = 0.679793
====================================================
  Execution time = 1.0268e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1361e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0258e-01
  Total weights = 7.856017348e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8858e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486582484483
                                         uncertainty =       0.001430318745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486582484483
                                         uncertainty =       0.001430318745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246623276
  error estimate for blocks of size 2^( 2) =       0.000255798230
  error estimate for blocks of size 2^( 3) =       0.000264274142
  error estimate for blocks of size 2^( 4) =       0.000270180943
  error estimate for blocks of size 2^( 5) =       0.000273702747
  error estimate for blocks of size 2^( 6) =       0.000275881954
  error estimate for blocks of size 2^( 7) =       0.000276662216
  error estimate for blocks of size 2^( 8) =       0.000277022341
  error estimate for blocks of size 2^( 9) =       0.000276859704

      target function =                  N/A
              le_mean =     -22.824614155512
             les_mean =     521.465590437382
             stat err =       0.000276606554
             autocorr =       1.257930966913
              std dev =       0.697555962165
             le_variance =       0.486584320352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282461415551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824614155506       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824614689450       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824614784204       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824614807895       residual = 4.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 3.417147e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824614155506       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824614318675       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824614347249       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824614347637       residual = 7.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.031938e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824614155506       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824614198699       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824614206254       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824614205992       residual = 9.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+00 is 2.720241e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2155e+02
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.083771e-01 3 1  ON 0
ci_02                -2.217260e-02 3 1  ON 1
ci_03                -2.133249e-02 3 1  ON 2
ci_04                 2.192554e-02 3 1  ON 3
ci_05                -2.140770e-02 3 1  ON 4
ci_06                -2.178223e-02 3 1  ON 5
ci_07                 2.613481e-02 3 1  ON 6
ci_08                -3.285167e-03 3 1  ON 7
ci_09                -1.100720e-02 3 1  ON 8
ci_10                -1.049738e-02 3 1  ON 9
ci_11                 1.626838e-02 3 1  ON 10
ci_12                 1.048728e-02 3 1  ON 11
ci_13                 1.187943e-02 3 1  ON 12
ci_14                 1.808673e-02 3 1  ON 13
ci_15                 7.296258e-03 3 1  ON 14
ci_16                 7.709354e-03 3 1  ON 15
ci_17                -9.339566e-03 3 1  ON 16
ci_18                -9.269324e-03 3 1  ON 17
ci_19                 1.010581e-02 3 1  ON 18
ci_20                 1.091836e-02 3 1  ON 19
ci_21                 8.218303e-03 3 1  ON 20
ci_22                 8.610332e-03 3 1  ON 21
ci_23                 6.625548e-03 3 1  ON 22
ci_24                 7.384543e-03 3 1  ON 23
ci_25                 5.482789e-03 3 1  ON 24
ci_26                 3.009360e-03 3 1  ON 25
ci_27                 2.171054e-03 3 1  ON 26
ci_28                 2.989174e-03 3 1  ON 27
ci_29                 2.969315e-03 3 1  ON 28
ci_30                 9.598596e-04 3 1  ON 29
ci_31                 6.377985e-04 3 1  ON 30
ci_32                 3.848027e-04 3 1  ON 31
ci_33                 1.094334e-04 3 1  ON 32
ci_34                -4.198875e-04 3 1  ON 33
ci_35                 8.607421e-05 3 1  ON 34
ci_36                -5.034290e-04 3 1  ON 35
ci_37                -4.620438e-04 3 1  ON 36
ci_38                -3.014358e-04 3 1  ON 37
ci_39                -1.180490e-04 3 1  ON 38
ci_40                -1.505622e-03 3 1  ON 39
ci_41                -2.214248e-04 3 1  ON 40
ci_42                -1.959870e-04 3 1  ON 41
ci_43                -2.500283e-03 3 1  ON 42
ci_44                -2.369391e-03 3 1  ON 43
ci_45                -2.551154e-05 3 1  ON 44
ci_46                -1.633790e-04 3 1  ON 45
ci_47                -1.523977e-04 3 1  ON 46
ci_48                 2.560683e-04 3 1  ON 47
ci_49                -1.584251e-03 3 1  ON 48
ci_50                -6.221799e-04 3 1  ON 49
ci_51                 9.038803e-05 3 1  ON 50
ci_52                 1.884127e-04 3 1  ON 51
ci_53                -1.243157e-03 3 1  ON 52
ci_54                -1.048329e-03 3 1  ON 53
ci_55                -8.688064e-04 3 1  ON 54
ci_56                 1.642399e-03 3 1  ON 55
ci_57                 1.913342e-03 3 1  ON 56
ci_58                -1.252122e-03 3 1  ON 57
ci_59                -1.256327e-03 3 1  ON 58
ci_60                 1.716683e-03 3 1  ON 59
ci_61                 2.308041e-03 3 1  ON 60
ci_62                -2.949979e-04 3 1  ON 61
ci_63                -6.005192e-04 3 1  ON 62
ci_64                -4.345533e-04 3 1  ON 63
ci_65                -5.728847e-05 3 1  ON 64
ci_66                -3.481497e-04 3 1  ON 65
ci_67                -2.951961e-04 3 1  ON 66
ci_68                -1.507866e-03 3 1  ON 67
ci_69                -1.842509e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8809
    reference variance = 0.405818
====================================================
  Execution time = 9.9424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0336e-01
  Total weights = 7.8564e+06
  Execution time = 1.4319e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485766018317
                                         uncertainty =       0.001309049735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485766018317
                                         uncertainty =       0.001309049735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246416311
  error estimate for blocks of size 2^( 2) =       0.000255616035
  error estimate for blocks of size 2^( 3) =       0.000263848752
  error estimate for blocks of size 2^( 4) =       0.000269889035
  error estimate for blocks of size 2^( 5) =       0.000273161368
  error estimate for blocks of size 2^( 6) =       0.000274618652
  error estimate for blocks of size 2^( 7) =       0.000276122154
  error estimate for blocks of size 2^( 8) =       0.000277252290
  error estimate for blocks of size 2^( 9) =       0.000277555197

      target function =                  N/A
              le_mean =     -22.824267759128
             les_mean =     521.450846538813
             stat err =       0.000276387074
             autocorr =       1.258046090040
              std dev =       0.696970577644
             le_variance =       0.485767986102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485777841775
                                         uncertainty =       0.001312770337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485777841775
                                         uncertainty =       0.001312770337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246419304
  error estimate for blocks of size 2^( 2) =       0.000255618483
  error estimate for blocks of size 2^( 3) =       0.000263850565
  error estimate for blocks of size 2^( 4) =       0.000269890230
  error estimate for blocks of size 2^( 5) =       0.000273162729
  error estimate for blocks of size 2^( 6) =       0.000274619268
  error estimate for blocks of size 2^( 7) =       0.000276119590
  error estimate for blocks of size 2^( 8) =       0.000277248496
  error estimate for blocks of size 2^( 9) =       0.000277552014

      target function =                  N/A
              le_mean =     -22.824266669125
             les_mean =     521.456049479294
             stat err =       0.000276384842
             autocorr =       1.257995207919
              std dev =       0.696979044395
             le_variance =       0.485779788325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485769201157
                                         uncertainty =       0.001311299838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485769201157
                                         uncertainty =       0.001311299838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246417115
  error estimate for blocks of size 2^( 2) =       0.000255616556
  error estimate for blocks of size 2^( 3) =       0.000263849157
  error estimate for blocks of size 2^( 4) =       0.000269889176
  error estimate for blocks of size 2^( 5) =       0.000273161803
  error estimate for blocks of size 2^( 6) =       0.000274618955
  error estimate for blocks of size 2^( 7) =       0.000276121146
  error estimate for blocks of size 2^( 8) =       0.000277250949
  error estimate for blocks of size 2^( 9) =       0.000277553947

      target function =                  N/A
              le_mean =     -22.824266845344
             les_mean =     521.454961104519
             stat err =       0.000276386249
             autocorr =       1.258030378011
              std dev =       0.696972851185
             le_variance =       0.485771155289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485765658706
                                         uncertainty =       0.001309346607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485765658706
                                         uncertainty =       0.001309346607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246416219
  error estimate for blocks of size 2^( 2) =       0.000255615903
  error estimate for blocks of size 2^( 3) =       0.000263848562
  error estimate for blocks of size 2^( 4) =       0.000269888810
  error estimate for blocks of size 2^( 5) =       0.000273161157
  error estimate for blocks of size 2^( 6) =       0.000274618446
  error estimate for blocks of size 2^( 7) =       0.000276121809
  error estimate for blocks of size 2^( 8) =       0.000277251854
  error estimate for blocks of size 2^( 9) =       0.000277554774

      target function =                  N/A
              le_mean =     -22.824267575166
             les_mean =     521.451200203732
             stat err =       0.000276386721
             autocorr =       1.258043815431
              std dev =       0.696970318341
             le_variance =       0.485767624648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824267759128        initial  <--
     5.9605e-01     5.9605e+00             3.4171e-04       -22.824266669125
     2.3842e+00     2.3842e+01             1.0319e-04       -22.824266845344
     9.5367e+00     9.5367e+01             2.7202e-05       -22.824267575166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 171.1713
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.084170e-01 3 1  ON 0
ci_02                -2.217806e-02 3 1  ON 1
ci_03                -2.128624e-02 3 1  ON 2
ci_04                 2.190588e-02 3 1  ON 3
ci_05                -2.142440e-02 3 1  ON 4
ci_06                -2.181657e-02 3 1  ON 5
ci_07                 2.623800e-02 3 1  ON 6
ci_08                -3.311978e-03 3 1  ON 7
ci_09                -1.100472e-02 3 1  ON 8
ci_10                -1.046525e-02 3 1  ON 9
ci_11                 1.625013e-02 3 1  ON 10
ci_12                 1.047225e-02 3 1  ON 11
ci_13                 1.186692e-02 3 1  ON 12
ci_14                 1.810567e-02 3 1  ON 13
ci_15                 7.296147e-03 3 1  ON 14
ci_16                 7.708672e-03 3 1  ON 15
ci_17                -9.361437e-03 3 1  ON 16
ci_18                -9.277385e-03 3 1  ON 17
ci_19                 1.015649e-02 3 1  ON 18
ci_20                 1.097451e-02 3 1  ON 19
ci_21                 8.223867e-03 3 1  ON 20
ci_22                 8.641755e-03 3 1  ON 21
ci_23                 6.655837e-03 3 1  ON 22
ci_24                 7.370826e-03 3 1  ON 23
ci_25                 5.480525e-03 3 1  ON 24
ci_26                 3.021671e-03 3 1  ON 25
ci_27                 2.194946e-03 3 1  ON 26
ci_28                 2.989323e-03 3 1  ON 27
ci_29                 3.032921e-03 3 1  ON 28
ci_30                 1.043189e-03 3 1  ON 29
ci_31                 6.931715e-04 3 1  ON 30
ci_32                 4.514219e-04 3 1  ON 31
ci_33                 7.161034e-05 3 1  ON 32
ci_34                -4.711315e-04 3 1  ON 33
ci_35                 5.417401e-05 3 1  ON 34
ci_36                -5.276437e-04 3 1  ON 35
ci_37                -4.360331e-04 3 1  ON 36
ci_38                -2.713033e-04 3 1  ON 37
ci_39                -1.147028e-04 3 1  ON 38
ci_40                -1.522701e-03 3 1  ON 39
ci_41                -2.114681e-04 3 1  ON 40
ci_42                -1.641435e-04 3 1  ON 41
ci_43                -2.528849e-03 3 1  ON 42
ci_44                -2.327828e-03 3 1  ON 43
ci_45                -3.368597e-05 3 1  ON 44
ci_46                -1.406901e-04 3 1  ON 45
ci_47                -1.156259e-04 3 1  ON 46
ci_48                 3.024025e-04 3 1  ON 47
ci_49                -1.672955e-03 3 1  ON 48
ci_50                -6.454046e-04 3 1  ON 49
ci_51                 7.420279e-05 3 1  ON 50
ci_52                 2.291849e-04 3 1  ON 51
ci_53                -1.262408e-03 3 1  ON 52
ci_54                -1.086158e-03 3 1  ON 53
ci_55                -8.259276e-04 3 1  ON 54
ci_56                 1.640303e-03 3 1  ON 55
ci_57                 1.913159e-03 3 1  ON 56
ci_58                -1.215864e-03 3 1  ON 57
ci_59                -1.302808e-03 3 1  ON 58
ci_60                 1.742991e-03 3 1  ON 59
ci_61                 2.328454e-03 3 1  ON 60
ci_62                -3.236477e-04 3 1  ON 61
ci_63                -6.349748e-04 3 1  ON 62
ci_64                -5.087454e-04 3 1  ON 63
ci_65                 2.895704e-06 3 1  ON 64
ci_66                -3.302338e-04 3 1  ON 65
ci_67                -3.031541e-04 3 1  ON 66
ci_68                -1.509212e-03 3 1  ON 67
ci_69                -1.788932e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9273e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.9176
    reference variance = 0.447351
====================================================
  Execution time = 1.0145e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1376e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0780e-01
  Total weights = 7.855710881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8490e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488896712124
                                         uncertainty =       0.001542668901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488896712124
                                         uncertainty =       0.001542668901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247208730
  error estimate for blocks of size 2^( 2) =       0.000256454023
  error estimate for blocks of size 2^( 3) =       0.000264789480
  error estimate for blocks of size 2^( 4) =       0.000270778514
  error estimate for blocks of size 2^( 5) =       0.000274535495
  error estimate for blocks of size 2^( 6) =       0.000276726031
  error estimate for blocks of size 2^( 7) =       0.000277964248
  error estimate for blocks of size 2^( 8) =       0.000277564642
  error estimate for blocks of size 2^( 9) =       0.000278022296

      target function =                  N/A
              le_mean =     -22.824766370321
             les_mean =     521.477759510010
             stat err =       0.000277569304
             autocorr =       1.260710197402
              std dev =       0.699211877642
             le_variance =       0.488897249835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282476637032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824766370313       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824766613444       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824766615917       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824766616462       residual = 6.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.923130e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824766370313       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824766432697       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824766433375       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824766433513       residual = 8.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.279344e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824766370313       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824766386013       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824766386187       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824766386221       residual = 8.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 3.230223e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1995e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.084188e-01 3 1  ON 0
ci_02                -2.217587e-02 3 1  ON 1
ci_03                -2.129060e-02 3 1  ON 2
ci_04                 2.190205e-02 3 1  ON 3
ci_05                -2.142324e-02 3 1  ON 4
ci_06                -2.181422e-02 3 1  ON 5
ci_07                 2.623628e-02 3 1  ON 6
ci_08                -3.316839e-03 3 1  ON 7
ci_09                -1.100873e-02 3 1  ON 8
ci_10                -1.046087e-02 3 1  ON 9
ci_11                 1.625154e-02 3 1  ON 10
ci_12                 1.047698e-02 3 1  ON 11
ci_13                 1.187232e-02 3 1  ON 12
ci_14                 1.810331e-02 3 1  ON 13
ci_15                 7.299194e-03 3 1  ON 14
ci_16                 7.703532e-03 3 1  ON 15
ci_17                -9.356527e-03 3 1  ON 16
ci_18                -9.273349e-03 3 1  ON 17
ci_19                 1.015495e-02 3 1  ON 18
ci_20                 1.096890e-02 3 1  ON 19
ci_21                 8.227545e-03 3 1  ON 20
ci_22                 8.637398e-03 3 1  ON 21
ci_23                 6.654952e-03 3 1  ON 22
ci_24                 7.370432e-03 3 1  ON 23
ci_25                 5.475796e-03 3 1  ON 24
ci_26                 3.023260e-03 3 1  ON 25
ci_27                 2.198421e-03 3 1  ON 26
ci_28                 2.990765e-03 3 1  ON 27
ci_29                 3.034012e-03 3 1  ON 28
ci_30                 1.040307e-03 3 1  ON 29
ci_31                 6.888832e-04 3 1  ON 30
ci_32                 4.447508e-04 3 1  ON 31
ci_33                 7.256968e-05 3 1  ON 32
ci_34                -4.712490e-04 3 1  ON 33
ci_35                 4.930432e-05 3 1  ON 34
ci_36                -5.281491e-04 3 1  ON 35
ci_37                -4.405774e-04 3 1  ON 36
ci_38                -2.650193e-04 3 1  ON 37
ci_39                -1.179074e-04 3 1  ON 38
ci_40                -1.523371e-03 3 1  ON 39
ci_41                -2.141247e-04 3 1  ON 40
ci_42                -1.677946e-04 3 1  ON 41
ci_43                -2.529496e-03 3 1  ON 42
ci_44                -2.329103e-03 3 1  ON 43
ci_45                -3.253537e-05 3 1  ON 44
ci_46                -1.415803e-04 3 1  ON 45
ci_47                -1.156889e-04 3 1  ON 46
ci_48                 3.030090e-04 3 1  ON 47
ci_49                -1.672314e-03 3 1  ON 48
ci_50                -6.462108e-04 3 1  ON 49
ci_51                 7.108489e-05 3 1  ON 50
ci_52                 2.211499e-04 3 1  ON 51
ci_53                -1.266408e-03 3 1  ON 52
ci_54                -1.088263e-03 3 1  ON 53
ci_55                -8.286565e-04 3 1  ON 54
ci_56                 1.641345e-03 3 1  ON 55
ci_57                 1.914947e-03 3 1  ON 56
ci_58                -1.215711e-03 3 1  ON 57
ci_59                -1.304775e-03 3 1  ON 58
ci_60                 1.747065e-03 3 1  ON 59
ci_61                 2.329040e-03 3 1  ON 60
ci_62                -3.164890e-04 3 1  ON 61
ci_63                -6.221814e-04 3 1  ON 62
ci_64                -5.109663e-04 3 1  ON 63
ci_65                 4.531013e-06 3 1  ON 64
ci_66                -3.305401e-04 3 1  ON 65
ci_67                -3.048909e-04 3 1  ON 66
ci_68                -1.515997e-03 3 1  ON 67
ci_69                -1.785711e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8046
    reference variance = 0.366626
====================================================
  Execution time = 9.9142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0404e-01
  Total weights = 7.8561e+06
  Execution time = 1.4317e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487161962393
                                         uncertainty =       0.001369363299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487161962393
                                         uncertainty =       0.001369363299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246770058
  error estimate for blocks of size 2^( 2) =       0.000255870489
  error estimate for blocks of size 2^( 3) =       0.000264248860
  error estimate for blocks of size 2^( 4) =       0.000270272416
  error estimate for blocks of size 2^( 5) =       0.000273979495
  error estimate for blocks of size 2^( 6) =       0.000275697560
  error estimate for blocks of size 2^( 7) =       0.000276423668
  error estimate for blocks of size 2^( 8) =       0.000277159237
  error estimate for blocks of size 2^( 9) =       0.000276442610

      target function =                  N/A
              le_mean =     -22.824674153489
             les_mean =     521.469781307042
             stat err =       0.000276430769
             autocorr =       1.254838499902
              std dev =       0.697971126601
             le_variance =       0.487163693568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487157676010
                                         uncertainty =       0.001367664508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487157676010
                                         uncertainty =       0.001367664508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246768973
  error estimate for blocks of size 2^( 2) =       0.000255869445
  error estimate for blocks of size 2^( 3) =       0.000264247825
  error estimate for blocks of size 2^( 4) =       0.000270271242
  error estimate for blocks of size 2^( 5) =       0.000273978269
  error estimate for blocks of size 2^( 6) =       0.000275696301
  error estimate for blocks of size 2^( 7) =       0.000276422503
  error estimate for blocks of size 2^( 8) =       0.000277157300
  error estimate for blocks of size 2^( 9) =       0.000276440252

      target function =                  N/A
              le_mean =     -22.824674225993
             les_mean =     521.469811663350
             stat err =       0.000276429089
             autocorr =       1.254834287886
              std dev =       0.697968056994
             le_variance =       0.487159408585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487159698591
                                         uncertainty =       0.001368486305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487159698591
                                         uncertainty =       0.001368486305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246769485
  error estimate for blocks of size 2^( 2) =       0.000255869937
  error estimate for blocks of size 2^( 3) =       0.000264248314
  error estimate for blocks of size 2^( 4) =       0.000270271801
  error estimate for blocks of size 2^( 5) =       0.000273978851
  error estimate for blocks of size 2^( 6) =       0.000275696899
  error estimate for blocks of size 2^( 7) =       0.000276423055
  error estimate for blocks of size 2^( 8) =       0.000277158221
  error estimate for blocks of size 2^( 9) =       0.000276441379

      target function =                  N/A
              le_mean =     -22.824674184056
             les_mean =     521.469815457348
             stat err =       0.000276429888
             autocorr =       1.254836338363
              std dev =       0.697969505410
             le_variance =       0.487161430482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487161670270
                                         uncertainty =       0.001369252541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487161670270
                                         uncertainty =       0.001369252541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246769984
  error estimate for blocks of size 2^( 2) =       0.000255870417
  error estimate for blocks of size 2^( 3) =       0.000264248789
  error estimate for blocks of size 2^( 4) =       0.000270272337
  error estimate for blocks of size 2^( 5) =       0.000273979412
  error estimate for blocks of size 2^( 6) =       0.000275697475
  error estimate for blocks of size 2^( 7) =       0.000276423589
  error estimate for blocks of size 2^( 8) =       0.000277159107
  error estimate for blocks of size 2^( 9) =       0.000276442454

      target function =                  N/A
              le_mean =     -22.824674156406
             les_mean =     521.469781784314
             stat err =       0.000276430656
             autocorr =       1.254838233169
              std dev =       0.697970917399
             le_variance =       0.487163401535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824674153489        initial
     5.9605e+00     5.9605e+01             4.9231e-05       -22.824674225993  <--
     2.3842e+01     2.3842e+02             1.2793e-05       -22.824674184056
     9.5367e+01     9.5367e+02             3.2302e-06       -22.824674156406

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 1.7077e+02
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.084240e-01 3 1  ON 0
ci_02                -2.216950e-02 3 1  ON 1
ci_03                -2.130340e-02 3 1  ON 2
ci_04                 2.189091e-02 3 1  ON 3
ci_05                -2.141986e-02 3 1  ON 4
ci_06                -2.180732e-02 3 1  ON 5
ci_07                 2.623125e-02 3 1  ON 6
ci_08                -3.330687e-03 3 1  ON 7
ci_09                -1.102047e-02 3 1  ON 8
ci_10                -1.044807e-02 3 1  ON 9
ci_11                 1.625556e-02 3 1  ON 10
ci_12                 1.049083e-02 3 1  ON 11
ci_13                 1.188810e-02 3 1  ON 12
ci_14                 1.809636e-02 3 1  ON 13
ci_15                 7.308066e-03 3 1  ON 14
ci_16                 7.688572e-03 3 1  ON 15
ci_17                -9.342189e-03 3 1  ON 16
ci_18                -9.261523e-03 3 1  ON 17
ci_19                 1.015049e-02 3 1  ON 18
ci_20                 1.095260e-02 3 1  ON 19
ci_21                 8.238436e-03 3 1  ON 20
ci_22                 8.624720e-03 3 1  ON 21
ci_23                 6.652373e-03 3 1  ON 22
ci_24                 7.369294e-03 3 1  ON 23
ci_25                 5.462121e-03 3 1  ON 24
ci_26                 3.027997e-03 3 1  ON 25
ci_27                 2.208511e-03 3 1  ON 26
ci_28                 2.994935e-03 3 1  ON 27
ci_29                 3.037111e-03 3 1  ON 28
ci_30                 1.031885e-03 3 1  ON 29
ci_31                 6.764129e-04 3 1  ON 30
ci_32                 4.255033e-04 3 1  ON 31
ci_33                 7.532297e-05 3 1  ON 32
ci_34                -4.716229e-04 3 1  ON 33
ci_35                 3.514457e-05 3 1  ON 34
ci_36                -5.296465e-04 3 1  ON 35
ci_37                -4.535521e-04 3 1  ON 36
ci_38                -2.469299e-04 3 1  ON 37
ci_39                -1.270367e-04 3 1  ON 38
ci_40                -1.525309e-03 3 1  ON 39
ci_41                -2.217573e-04 3 1  ON 40
ci_42                -1.783161e-04 3 1  ON 41
ci_43                -2.531427e-03 3 1  ON 42
ci_44                -2.332737e-03 3 1  ON 43
ci_45                -2.919129e-05 3 1  ON 44
ci_46                -1.441215e-04 3 1  ON 45
ci_47                -1.158336e-04 3 1  ON 46
ci_48                 3.047772e-04 3 1  ON 47
ci_49                -1.670409e-03 3 1  ON 48
ci_50                -6.484724e-04 3 1  ON 49
ci_51                 6.214669e-05 3 1  ON 50
ci_52                 1.980664e-04 3 1  ON 51
ci_53                -1.277767e-03 3 1  ON 52
ci_54                -1.094367e-03 3 1  ON 53
ci_55                -8.365257e-04 3 1  ON 54
ci_56                 1.644290e-03 3 1  ON 55
ci_57                 1.919998e-03 3 1  ON 56
ci_58                -1.215280e-03 3 1  ON 57
ci_59                -1.310520e-03 3 1  ON 58
ci_60                 1.759133e-03 3 1  ON 59
ci_61                 2.330772e-03 3 1  ON 60
ci_62                -2.960961e-04 3 1  ON 61
ci_63                -5.857435e-04 3 1  ON 62
ci_64                -5.173764e-04 3 1  ON 63
ci_65                 9.259486e-06 3 1  ON 64
ci_66                -3.315039e-04 3 1  ON 65
ci_67                -3.098141e-04 3 1  ON 66
ci_68                -1.535651e-03 3 1  ON 67
ci_69                -1.776385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9073e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8471
    reference variance = 0.534208
====================================================
  Execution time = 1.0148e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1430e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0277e-01
  Total weights = 7.856928857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8518e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486271458372
                                         uncertainty =       0.002141552858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486271458372
                                         uncertainty =       0.002141552858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246544855
  error estimate for blocks of size 2^( 2) =       0.000255666820
  error estimate for blocks of size 2^( 3) =       0.000263697291
  error estimate for blocks of size 2^( 4) =       0.000269276138
  error estimate for blocks of size 2^( 5) =       0.000272789038
  error estimate for blocks of size 2^( 6) =       0.000274484336
  error estimate for blocks of size 2^( 7) =       0.000275155405
  error estimate for blocks of size 2^( 8) =       0.000275777126
  error estimate for blocks of size 2^( 9) =       0.000277779961

      target function =                  N/A
              le_mean =     -22.824793180152
             les_mean =     521.473958240424
             stat err =       0.000275799207
             autocorr =       1.251394198261
              std dev =       0.697334155958
             le_variance =       0.486274925066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282479318015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824793180145       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824794084359       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824794109922       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824794100808       residual = 5.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.438314e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824793180145       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824793428058       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824793437419       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824793435255       residual = 7.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.087242e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824793180145       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824793243658       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824793246243       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824793245740       residual = 9.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.058142e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2001e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.084337e-01 3 1  ON 0
ci_02                -2.217259e-02 3 1  ON 1
ci_03                -2.132611e-02 3 1  ON 2
ci_04                 2.187837e-02 3 1  ON 3
ci_05                -2.143417e-02 3 1  ON 4
ci_06                -2.179934e-02 3 1  ON 5
ci_07                 2.620030e-02 3 1  ON 6
ci_08                -3.339373e-03 3 1  ON 7
ci_09                -1.101362e-02 3 1  ON 8
ci_10                -1.045426e-02 3 1  ON 9
ci_11                 1.627451e-02 3 1  ON 10
ci_12                 1.049732e-02 3 1  ON 11
ci_13                 1.188787e-02 3 1  ON 12
ci_14                 1.806892e-02 3 1  ON 13
ci_15                 7.303145e-03 3 1  ON 14
ci_16                 7.694883e-03 3 1  ON 15
ci_17                -9.332395e-03 3 1  ON 16
ci_18                -9.275796e-03 3 1  ON 17
ci_19                 1.012835e-02 3 1  ON 18
ci_20                 1.094015e-02 3 1  ON 19
ci_21                 8.229013e-03 3 1  ON 20
ci_22                 8.627906e-03 3 1  ON 21
ci_23                 6.636446e-03 3 1  ON 22
ci_24                 7.355024e-03 3 1  ON 23
ci_25                 5.439147e-03 3 1  ON 24
ci_26                 3.039364e-03 3 1  ON 25
ci_27                 2.217221e-03 3 1  ON 26
ci_28                 2.987151e-03 3 1  ON 27
ci_29                 3.023741e-03 3 1  ON 28
ci_30                 1.026180e-03 3 1  ON 29
ci_31                 6.682234e-04 3 1  ON 30
ci_32                 4.136320e-04 3 1  ON 31
ci_33                 5.226557e-05 3 1  ON 32
ci_34                -4.415428e-04 3 1  ON 33
ci_35                 2.240159e-05 3 1  ON 34
ci_36                -4.887741e-04 3 1  ON 35
ci_37                -4.359425e-04 3 1  ON 36
ci_38                -2.312448e-04 3 1  ON 37
ci_39                -1.139167e-04 3 1  ON 38
ci_40                -1.531993e-03 3 1  ON 39
ci_41                -2.118198e-04 3 1  ON 40
ci_42                -1.995955e-04 3 1  ON 41
ci_43                -2.528613e-03 3 1  ON 42
ci_44                -2.323973e-03 3 1  ON 43
ci_45                -3.345561e-05 3 1  ON 44
ci_46                -1.304799e-04 3 1  ON 45
ci_47                -1.036510e-04 3 1  ON 46
ci_48                 2.831322e-04 3 1  ON 47
ci_49                -1.667539e-03 3 1  ON 48
ci_50                -6.423125e-04 3 1  ON 49
ci_51                 5.719403e-05 3 1  ON 50
ci_52                 1.920251e-04 3 1  ON 51
ci_53                -1.264793e-03 3 1  ON 52
ci_54                -1.101954e-03 3 1  ON 53
ci_55                -8.621661e-04 3 1  ON 54
ci_56                 1.648724e-03 3 1  ON 55
ci_57                 1.896277e-03 3 1  ON 56
ci_58                -1.210900e-03 3 1  ON 57
ci_59                -1.317700e-03 3 1  ON 58
ci_60                 1.770986e-03 3 1  ON 59
ci_61                 2.322372e-03 3 1  ON 60
ci_62                -3.130184e-04 3 1  ON 61
ci_63                -5.761049e-04 3 1  ON 62
ci_64                -5.248806e-04 3 1  ON 63
ci_65                -1.889217e-05 3 1  ON 64
ci_66                -3.236512e-04 3 1  ON 65
ci_67                -3.040221e-04 3 1  ON 66
ci_68                -1.555324e-03 3 1  ON 67
ci_69                -1.780113e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.9553
    reference variance = 0.447571
====================================================
  Execution time = 1.0078e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0034e-01
  Total weights = 7.8564e+06
  Execution time = 1.4322e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482820350496
                                         uncertainty =       0.001414267412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482820350496
                                         uncertainty =       0.001414267412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245668214
  error estimate for blocks of size 2^( 2) =       0.000254805980
  error estimate for blocks of size 2^( 3) =       0.000263147846
  error estimate for blocks of size 2^( 4) =       0.000269177083
  error estimate for blocks of size 2^( 5) =       0.000272595795
  error estimate for blocks of size 2^( 6) =       0.000274401489
  error estimate for blocks of size 2^( 7) =       0.000275930906
  error estimate for blocks of size 2^( 8) =       0.000275854839
  error estimate for blocks of size 2^( 9) =       0.000276106929

      target function =                  N/A
              le_mean =     -22.824661919430
             les_mean =     521.465588865284
             stat err =       0.000275573541
             autocorr =       1.258279431598
              std dev =       0.694854638801
             le_variance =       0.482822969063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482826242255
                                         uncertainty =       0.001411242092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482826242255
                                         uncertainty =       0.001411242092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245669712
  error estimate for blocks of size 2^( 2) =       0.000254807175
  error estimate for blocks of size 2^( 3) =       0.000263148132
  error estimate for blocks of size 2^( 4) =       0.000269176707
  error estimate for blocks of size 2^( 5) =       0.000272594797
  error estimate for blocks of size 2^( 6) =       0.000274400174
  error estimate for blocks of size 2^( 7) =       0.000275930325
  error estimate for blocks of size 2^( 8) =       0.000275853030
  error estimate for blocks of size 2^( 9) =       0.000276102344

      target function =                  N/A
              le_mean =     -22.824662455278
             les_mean =     521.465847310756
             stat err =       0.000275571468
             autocorr =       1.258245151139
              std dev =       0.694858878312
             le_variance =       0.482828860769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482822512287
                                         uncertainty =       0.001412519108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482822512287
                                         uncertainty =       0.001412519108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245668763
  error estimate for blocks of size 2^( 2) =       0.000254806366
  error estimate for blocks of size 2^( 3) =       0.000263147744
  error estimate for blocks of size 2^( 4) =       0.000269176632
  error estimate for blocks of size 2^( 5) =       0.000272595031
  error estimate for blocks of size 2^( 6) =       0.000274400534
  error estimate for blocks of size 2^( 7) =       0.000275930372
  error estimate for blocks of size 2^( 8) =       0.000275853567
  error estimate for blocks of size 2^( 9) =       0.000276104133

      target function =                  N/A
              le_mean =     -22.824662099738
             les_mean =     521.465623977075
             stat err =       0.000275572152
             autocorr =       1.258261111657
              std dev =       0.694856194334
             le_variance =       0.482825130804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482820500236
                                         uncertainty =       0.001414035509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482820500236
                                         uncertainty =       0.001414035509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245668252
  error estimate for blocks of size 2^( 2) =       0.000254805997
  error estimate for blocks of size 2^( 3) =       0.000263147800
  error estimate for blocks of size 2^( 4) =       0.000269176995
  error estimate for blocks of size 2^( 5) =       0.000272595677
  error estimate for blocks of size 2^( 6) =       0.000274401333
  error estimate for blocks of size 2^( 7) =       0.000275930797
  error estimate for blocks of size 2^( 8) =       0.000275854655
  error estimate for blocks of size 2^( 9) =       0.000276106553

      target function =                  N/A
              le_mean =     -22.824661940529
             les_mean =     521.465657345870
             stat err =       0.000275573334
             autocorr =       1.258277157413
              std dev =       0.694854746546
             le_variance =       0.482823118798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824661919430        initial
     1.4901e+00     1.4901e+01             1.4383e-04       -22.824662455278  <--
     5.9605e+00     5.9605e+01             4.0872e-05       -22.824662099738
     2.3842e+01     2.3842e+02             1.0581e-05       -22.824661940529

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 1.7251e+02
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.084614e-01 3 1  ON 0
ci_02                -2.218068e-02 3 1  ON 1
ci_03                -2.138681e-02 3 1  ON 2
ci_04                 2.184493e-02 3 1  ON 3
ci_05                -2.147251e-02 3 1  ON 4
ci_06                -2.177674e-02 3 1  ON 5
ci_07                 2.611535e-02 3 1  ON 6
ci_08                -3.361384e-03 3 1  ON 7
ci_09                -1.099487e-02 3 1  ON 8
ci_10                -1.047064e-02 3 1  ON 9
ci_11                 1.632601e-02 3 1  ON 10
ci_12                 1.051518e-02 3 1  ON 11
ci_13                 1.188758e-02 3 1  ON 12
ci_14                 1.799191e-02 3 1  ON 13
ci_15                 7.289485e-03 3 1  ON 14
ci_16                 7.711400e-03 3 1  ON 15
ci_17                -9.305893e-03 3 1  ON 16
ci_18                -9.314201e-03 3 1  ON 17
ci_19                 1.007292e-02 3 1  ON 18
ci_20                 1.090839e-02 3 1  ON 19
ci_21                 8.202577e-03 3 1  ON 20
ci_22                 8.635649e-03 3 1  ON 21
ci_23                 6.595986e-03 3 1  ON 22
ci_24                 7.314904e-03 3 1  ON 23
ci_25                 5.379435e-03 3 1  ON 24
ci_26                 3.069680e-03 3 1  ON 25
ci_27                 2.240562e-03 3 1  ON 26
ci_28                 2.966929e-03 3 1  ON 27
ci_29                 2.988225e-03 3 1  ON 28
ci_30                 1.010588e-03 3 1  ON 29
ci_31                 6.464828e-04 3 1  ON 30
ci_32                 3.821583e-04 3 1  ON 31
ci_33                -7.029762e-06 3 1  ON 32
ci_34                -3.614709e-04 3 1  ON 33
ci_35                -1.241346e-05 3 1  ON 34
ci_36                -3.858151e-04 3 1  ON 35
ci_37                -3.914976e-04 3 1  ON 36
ci_38                -1.919831e-04 3 1  ON 37
ci_39                -8.077129e-05 3 1  ON 38
ci_40                -1.548373e-03 3 1  ON 39
ci_41                -1.861879e-04 3 1  ON 40
ci_42                -2.552467e-04 3 1  ON 41
ci_43                -2.521835e-03 3 1  ON 42
ci_44                -2.299526e-03 3 1  ON 43
ci_45                -4.501908e-05 3 1  ON 44
ci_46                -9.732420e-05 3 1  ON 45
ci_47                -6.978316e-05 3 1  ON 46
ci_48                 2.242215e-04 3 1  ON 47
ci_49                -1.659242e-03 3 1  ON 48
ci_50                -6.280143e-04 3 1  ON 49
ci_51                 4.390956e-05 3 1  ON 50
ci_52                 1.766476e-04 3 1  ON 51
ci_53                -1.233007e-03 3 1  ON 52
ci_54                -1.121980e-03 3 1  ON 53
ci_55                -9.301396e-04 3 1  ON 54
ci_56                 1.660399e-03 3 1  ON 55
ci_57                 1.835872e-03 3 1  ON 56
ci_58                -1.199497e-03 3 1  ON 57
ci_59                -1.337130e-03 3 1  ON 58
ci_60                 1.804212e-03 3 1  ON 59
ci_61                 2.297604e-03 3 1  ON 60
ci_62                -3.547401e-04 3 1  ON 61
ci_63                -5.516658e-04 3 1  ON 62
ci_64                -5.434730e-04 3 1  ON 63
ci_65                -9.243800e-05 3 1  ON 64
ci_66                -3.029106e-04 3 1  ON 65
ci_67                -2.880536e-04 3 1  ON 66
ci_68                -1.607073e-03 3 1  ON 67
ci_69                -1.790241e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9254e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8406
    reference variance = 0.494749
====================================================
  Execution time = 1.0173e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1438e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0503e-01
  Total weights = 7.857069431e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8438e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487203279698
                                         uncertainty =       0.001615742563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487203279698
                                         uncertainty =       0.001615742563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246780414
  error estimate for blocks of size 2^( 2) =       0.000255875176
  error estimate for blocks of size 2^( 3) =       0.000264166856
  error estimate for blocks of size 2^( 4) =       0.000270351909
  error estimate for blocks of size 2^( 5) =       0.000273905348
  error estimate for blocks of size 2^( 6) =       0.000275962442
  error estimate for blocks of size 2^( 7) =       0.000276983295
  error estimate for blocks of size 2^( 8) =       0.000277968367
  error estimate for blocks of size 2^( 9) =       0.000278428190

      target function =                  N/A
              le_mean =     -22.824569231564
             les_mean =     521.465990597342
             stat err =       0.000277335573
             autocorr =       1.262960537042
              std dev =       0.698000418045
             le_variance =       0.487204583591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282456923156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824569231562       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824572835788       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824572640077       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824572687782       residual = 5.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 4.702088e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824569231562       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824570469388       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824570492316       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824570501910       residual = 3.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.598933e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824569231562       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824569572914       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824569590140       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824569592249       residual = 6.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.388724e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2018e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.084672e-01 3 1  ON 0
ci_02                -2.214149e-02 3 1  ON 1
ci_03                -2.146444e-02 3 1  ON 2
ci_04                 2.184974e-02 3 1  ON 3
ci_05                -2.149250e-02 3 1  ON 4
ci_06                -2.174252e-02 3 1  ON 5
ci_07                 2.602803e-02 3 1  ON 6
ci_08                -3.409820e-03 3 1  ON 7
ci_09                -1.102032e-02 3 1  ON 8
ci_10                -1.047845e-02 3 1  ON 9
ci_11                 1.639066e-02 3 1  ON 10
ci_12                 1.057911e-02 3 1  ON 11
ci_13                 1.185426e-02 3 1  ON 12
ci_14                 1.797423e-02 3 1  ON 13
ci_15                 7.322390e-03 3 1  ON 14
ci_16                 7.733120e-03 3 1  ON 15
ci_17                -9.305178e-03 3 1  ON 16
ci_18                -9.350459e-03 3 1  ON 17
ci_19                 1.001487e-02 3 1  ON 18
ci_20                 1.089429e-02 3 1  ON 19
ci_21                 8.158842e-03 3 1  ON 20
ci_22                 8.673666e-03 3 1  ON 21
ci_23                 6.595611e-03 3 1  ON 22
ci_24                 7.379316e-03 3 1  ON 23
ci_25                 5.356177e-03 3 1  ON 24
ci_26                 3.103377e-03 3 1  ON 25
ci_27                 2.336411e-03 3 1  ON 26
ci_28                 2.920367e-03 3 1  ON 27
ci_29                 2.952612e-03 3 1  ON 28
ci_30                 9.670996e-04 3 1  ON 29
ci_31                 6.773199e-04 3 1  ON 30
ci_32                 3.544440e-04 3 1  ON 31
ci_33                 7.277533e-05 3 1  ON 32
ci_34                -3.670444e-04 3 1  ON 33
ci_35                 5.902458e-05 3 1  ON 34
ci_36                -3.284799e-04 3 1  ON 35
ci_37                -3.950124e-04 3 1  ON 36
ci_38                -1.643322e-04 3 1  ON 37
ci_39                -8.080631e-05 3 1  ON 38
ci_40                -1.441218e-03 3 1  ON 39
ci_41                -1.816897e-04 3 1  ON 40
ci_42                -2.650237e-04 3 1  ON 41
ci_43                -2.481603e-03 3 1  ON 42
ci_44                -2.329088e-03 3 1  ON 43
ci_45                -4.065184e-05 3 1  ON 44
ci_46                -1.284051e-05 3 1  ON 45
ci_47                -7.972068e-05 3 1  ON 46
ci_48                 2.320128e-04 3 1  ON 47
ci_49                -1.539743e-03 3 1  ON 48
ci_50                -6.143176e-04 3 1  ON 49
ci_51                 8.162432e-05 3 1  ON 50
ci_52                 1.646004e-04 3 1  ON 51
ci_53                -1.202184e-03 3 1  ON 52
ci_54                -1.008937e-03 3 1  ON 53
ci_55                -8.638173e-04 3 1  ON 54
ci_56                 1.641115e-03 3 1  ON 55
ci_57                 1.767806e-03 3 1  ON 56
ci_58                -1.174451e-03 3 1  ON 57
ci_59                -1.381527e-03 3 1  ON 58
ci_60                 1.730793e-03 3 1  ON 59
ci_61                 2.284198e-03 3 1  ON 60
ci_62                -3.195340e-04 3 1  ON 61
ci_63                -4.729082e-04 3 1  ON 62
ci_64                -5.033053e-04 3 1  ON 63
ci_65                -2.523313e-04 3 1  ON 64
ci_66                -3.869623e-04 3 1  ON 65
ci_67                -3.142373e-04 3 1  ON 66
ci_68                -1.541112e-03 3 1  ON 67
ci_69                -1.810644e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.901
    reference variance = 0.395349
====================================================
  Execution time = 1.0106e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0184e-01
  Total weights = 7.8570e+06
  Execution time = 1.4348e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485878181862
                                         uncertainty =       0.001360311723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485878181862
                                         uncertainty =       0.001360311723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246443713
  error estimate for blocks of size 2^( 2) =       0.000255586930
  error estimate for blocks of size 2^( 3) =       0.000263912538
  error estimate for blocks of size 2^( 4) =       0.000269733597
  error estimate for blocks of size 2^( 5) =       0.000273020389
  error estimate for blocks of size 2^( 6) =       0.000274994258
  error estimate for blocks of size 2^( 7) =       0.000275975513
  error estimate for blocks of size 2^( 8) =       0.000276448901
  error estimate for blocks of size 2^( 9) =       0.000276464325

      target function =                  N/A
              le_mean =     -22.824439974101
             les_mean =     521.458913468944
             stat err =       0.000275970749
             autocorr =       1.253980020166
              std dev =       0.697048083747
             le_variance =       0.485876031056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485933542662
                                         uncertainty =       0.001364199047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485933542662
                                         uncertainty =       0.001364199047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246457750
  error estimate for blocks of size 2^( 2) =       0.000255599084
  error estimate for blocks of size 2^( 3) =       0.000263923004
  error estimate for blocks of size 2^( 4) =       0.000269741869
  error estimate for blocks of size 2^( 5) =       0.000273026922
  error estimate for blocks of size 2^( 6) =       0.000275002292
  error estimate for blocks of size 2^( 7) =       0.000275981872
  error estimate for blocks of size 2^( 8) =       0.000276459005
  error estimate for blocks of size 2^( 9) =       0.000276480791

      target function =                  N/A
              le_mean =     -22.824442498355
             les_mean =     521.461676547107
             stat err =       0.000275980990
             autocorr =       1.253930243910
              std dev =       0.697087785043
             le_variance =       0.485931380057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485908325355
                                         uncertainty =       0.001362676517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485908325355
                                         uncertainty =       0.001362676517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246451357
  error estimate for blocks of size 2^( 2) =       0.000255593341
  error estimate for blocks of size 2^( 3) =       0.000263918074
  error estimate for blocks of size 2^( 4) =       0.000269737657
  error estimate for blocks of size 2^( 5) =       0.000273023525
  error estimate for blocks of size 2^( 6) =       0.000274998869
  error estimate for blocks of size 2^( 7) =       0.000275979579
  error estimate for blocks of size 2^( 8) =       0.000276456509
  error estimate for blocks of size 2^( 9) =       0.000276474469

      target function =                  N/A
              le_mean =     -22.824441524636
             les_mean =     521.470361472927
             stat err =       0.000275977357
             autocorr =       1.253962284657
              std dev =       0.697069702443
             le_variance =       0.485906170063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485880457961
                                         uncertainty =       0.001360605634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485880457961
                                         uncertainty =       0.001360605634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246444291
  error estimate for blocks of size 2^( 2) =       0.000255587358
  error estimate for blocks of size 2^( 3) =       0.000263912924
  error estimate for blocks of size 2^( 4) =       0.000269733750
  error estimate for blocks of size 2^( 5) =       0.000273020571
  error estimate for blocks of size 2^( 6) =       0.000274994898
  error estimate for blocks of size 2^( 7) =       0.000275976038
  error estimate for blocks of size 2^( 8) =       0.000276450244
  error estimate for blocks of size 2^( 9) =       0.000276466567

      target function =                  N/A
              le_mean =     -22.824439921184
             les_mean =     521.457642461832
             stat err =       0.000275971937
             autocorr =       1.253984940019
              std dev =       0.697049716030
             le_variance =       0.485878306618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824439974101        initial
     3.7253e-01     3.7253e+00             4.7021e-04       -22.824442498355  <--
     1.4901e+00     1.4901e+01             1.5989e-04       -22.824441524636
     5.9605e+00     5.9605e+01             4.3887e-05       -22.824439921184

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 1.7285e+02
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.084814e-01 3 1  ON 0
ci_02                -2.205147e-02 3 1  ON 1
ci_03                -2.162920e-02 3 1  ON 2
ci_04                 2.186517e-02 3 1  ON 3
ci_05                -2.153005e-02 3 1  ON 4
ci_06                -2.167065e-02 3 1  ON 5
ci_07                 2.584176e-02 3 1  ON 6
ci_08                -3.492998e-03 3 1  ON 7
ci_09                -1.106702e-02 3 1  ON 8
ci_10                -1.049173e-02 3 1  ON 9
ci_11                 1.652471e-02 3 1  ON 10
ci_12                 1.070884e-02 3 1  ON 11
ci_13                 1.178658e-02 3 1  ON 12
ci_14                 1.791068e-02 3 1  ON 13
ci_15                 7.384572e-03 3 1  ON 14
ci_16                 7.775631e-03 3 1  ON 15
ci_17                -9.304338e-03 3 1  ON 16
ci_18                -9.421409e-03 3 1  ON 17
ci_19                 9.917874e-03 3 1  ON 18
ci_20                 1.087170e-02 3 1  ON 19
ci_21                 8.058311e-03 3 1  ON 20
ci_22                 8.747500e-03 3 1  ON 21
ci_23                 6.597546e-03 3 1  ON 22
ci_24                 7.526163e-03 3 1  ON 23
ci_25                 5.310328e-03 3 1  ON 24
ci_26                 3.168884e-03 3 1  ON 25
ci_27                 2.530770e-03 3 1  ON 26
ci_28                 2.832381e-03 3 1  ON 27
ci_29                 2.889284e-03 3 1  ON 28
ci_30                 8.773520e-04 3 1  ON 29
ci_31                 7.473546e-04 3 1  ON 30
ci_32                 2.999687e-04 3 1  ON 31
ci_33                 2.157252e-04 3 1  ON 32
ci_34                -3.870238e-04 3 1  ON 33
ci_35                 2.061745e-04 3 1  ON 34
ci_36                -2.381209e-04 3 1  ON 35
ci_37                -4.085978e-04 3 1  ON 36
ci_38                -1.216043e-04 3 1  ON 37
ci_39                -8.865277e-05 3 1  ON 38
ci_40                -1.280020e-03 3 1  ON 39
ci_41                -1.712437e-04 3 1  ON 40
ci_42                -2.892101e-04 3 1  ON 41
ci_43                -2.397821e-03 3 1  ON 42
ci_44                -2.384522e-03 3 1  ON 43
ci_45                -3.330031e-05 3 1  ON 44
ci_46                 1.318531e-04 3 1  ON 45
ci_47                -9.608363e-05 3 1  ON 46
ci_48                 2.552900e-04 3 1  ON 47
ci_49                -1.326516e-03 3 1  ON 48
ci_50                -5.925213e-04 3 1  ON 49
ci_51                 1.442168e-04 3 1  ON 50
ci_52                 1.428181e-04 3 1  ON 51
ci_53                -1.155224e-03 3 1  ON 52
ci_54                -7.866048e-04 3 1  ON 53
ci_55                -7.362359e-04 3 1  ON 54
ci_56                 1.613689e-03 3 1  ON 55
ci_57                 1.649015e-03 3 1  ON 56
ci_58                -1.124566e-03 3 1  ON 57
ci_59                -1.472743e-03 3 1  ON 58
ci_60                 1.542088e-03 3 1  ON 59
ci_61                 2.250759e-03 3 1  ON 60
ci_62                -2.629215e-04 3 1  ON 61
ci_63                -3.419409e-04 3 1  ON 62
ci_64                -4.305362e-04 3 1  ON 63
ci_65                -5.626468e-04 3 1  ON 64
ci_66                -5.349560e-04 3 1  ON 65
ci_67                -3.596909e-04 3 1  ON 66
ci_68                -1.415488e-03 3 1  ON 67
ci_69                -1.853388e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9304e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.88
    reference variance = 0.368437
====================================================
  Execution time = 1.0190e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1346e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0524e-01
  Total weights = 7.856100047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8501e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486412974415
                                         uncertainty =       0.001583594950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486412974415
                                         uncertainty =       0.001583594950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246580020
  error estimate for blocks of size 2^( 2) =       0.000255854716
  error estimate for blocks of size 2^( 3) =       0.000264102875
  error estimate for blocks of size 2^( 4) =       0.000269920604
  error estimate for blocks of size 2^( 5) =       0.000273440087
  error estimate for blocks of size 2^( 6) =       0.000275191138
  error estimate for blocks of size 2^( 7) =       0.000276613555
  error estimate for blocks of size 2^( 8) =       0.000277749392
  error estimate for blocks of size 2^( 9) =       0.000278300305

      target function =                  N/A
              le_mean =     -22.824517722185
             les_mean =     521.463847377802
             stat err =       0.000276963598
             autocorr =       1.261623056812
              std dev =       0.697433616578
             le_variance =       0.486413649533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282451772218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824517722180       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824521968047       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824521898334       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824521800412       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 7.172901e-04

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824517722180       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824519858795       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824519845920       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 3.390334e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824517722180       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824518437458       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824518451120       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.111613e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2042e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.086548e-01 3 1  ON 0
ci_02                -2.180312e-02 3 1  ON 1
ci_03                -2.188213e-02 3 1  ON 2
ci_04                 2.176217e-02 3 1  ON 3
ci_05                -2.148082e-02 3 1  ON 4
ci_06                -2.158435e-02 3 1  ON 5
ci_07                 2.589058e-02 3 1  ON 6
ci_08                -3.490589e-03 3 1  ON 7
ci_09                -1.105337e-02 3 1  ON 8
ci_10                -1.075179e-02 3 1  ON 9
ci_11                 1.641706e-02 3 1  ON 10
ci_12                 1.036981e-02 3 1  ON 11
ci_13                 1.189264e-02 3 1  ON 12
ci_14                 1.797459e-02 3 1  ON 13
ci_15                 7.418995e-03 3 1  ON 14
ci_16                 7.615752e-03 3 1  ON 15
ci_17                -9.125130e-03 3 1  ON 16
ci_18                -9.334193e-03 3 1  ON 17
ci_19                 9.941574e-03 3 1  ON 18
ci_20                 1.073131e-02 3 1  ON 19
ci_21                 8.205638e-03 3 1  ON 20
ci_22                 8.426442e-03 3 1  ON 21
ci_23                 6.549572e-03 3 1  ON 22
ci_24                 7.453398e-03 3 1  ON 23
ci_25                 5.221816e-03 3 1  ON 24
ci_26                 2.879154e-03 3 1  ON 25
ci_27                 2.246619e-03 3 1  ON 26
ci_28                 2.920895e-03 3 1  ON 27
ci_29                 2.880648e-03 3 1  ON 28
ci_30                 7.006933e-04 3 1  ON 29
ci_31                 7.206294e-04 3 1  ON 30
ci_32                 3.123221e-04 3 1  ON 31
ci_33                 1.978112e-04 3 1  ON 32
ci_34                -4.731785e-04 3 1  ON 33
ci_35                 2.623093e-04 3 1  ON 34
ci_36                -4.662175e-04 3 1  ON 35
ci_37                -4.013263e-04 3 1  ON 36
ci_38                -1.655273e-04 3 1  ON 37
ci_39                -5.754191e-05 3 1  ON 38
ci_40                -1.087047e-03 3 1  ON 39
ci_41                -2.652114e-04 3 1  ON 40
ci_42                -1.915809e-04 3 1  ON 41
ci_43                -2.386729e-03 3 1  ON 42
ci_44                -2.224567e-03 3 1  ON 43
ci_45                 8.876904e-05 3 1  ON 44
ci_46                 2.079650e-06 3 1  ON 45
ci_47                -1.319545e-04 3 1  ON 46
ci_48                 1.887468e-04 3 1  ON 47
ci_49                -1.197615e-03 3 1  ON 48
ci_50                -5.367793e-04 3 1  ON 49
ci_51                 4.476279e-05 3 1  ON 50
ci_52                -1.987969e-05 3 1  ON 51
ci_53                -1.091428e-03 3 1  ON 52
ci_54                -8.936691e-04 3 1  ON 53
ci_55                -8.453651e-04 3 1  ON 54
ci_56                 1.576367e-03 3 1  ON 55
ci_57                 1.705043e-03 3 1  ON 56
ci_58                -1.078966e-03 3 1  ON 57
ci_59                -1.664320e-03 3 1  ON 58
ci_60                 1.659400e-03 3 1  ON 59
ci_61                 2.299796e-03 3 1  ON 60
ci_62                -4.946662e-04 3 1  ON 61
ci_63                -2.747515e-04 3 1  ON 62
ci_64                -3.435212e-04 3 1  ON 63
ci_65                -5.869406e-04 3 1  ON 64
ci_66                -7.341788e-04 3 1  ON 65
ci_67                -3.405658e-04 3 1  ON 66
ci_68                -1.410150e-03 3 1  ON 67
ci_69                -1.609087e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8627
    reference variance = 0.476806
====================================================
  Execution time = 1.0115e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.2074e-01
  Total weights = 7.8570e+06
  Execution time = 1.4351e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489310089391
                                         uncertainty =       0.001563686246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489310089391
                                         uncertainty =       0.001563686246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247313402
  error estimate for blocks of size 2^( 2) =       0.000256412960
  error estimate for blocks of size 2^( 3) =       0.000264516607
  error estimate for blocks of size 2^( 4) =       0.000270311683
  error estimate for blocks of size 2^( 5) =       0.000273566111
  error estimate for blocks of size 2^( 6) =       0.000275589993
  error estimate for blocks of size 2^( 7) =       0.000276647450
  error estimate for blocks of size 2^( 8) =       0.000277063980
  error estimate for blocks of size 2^( 9) =       0.000278888039

      target function =                  N/A
              le_mean =     -22.825354946320
             les_mean =     521.554576567696
             stat err =       0.000277047366
             autocorr =       1.254910480434
              std dev =       0.699507934752
             le_variance =       0.489311350781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489312935743
                                         uncertainty =       0.001570526571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489312935743
                                         uncertainty =       0.001570526571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247314118
  error estimate for blocks of size 2^( 2) =       0.000256415065
  error estimate for blocks of size 2^( 3) =       0.000264519494
  error estimate for blocks of size 2^( 4) =       0.000270316654
  error estimate for blocks of size 2^( 5) =       0.000273570298
  error estimate for blocks of size 2^( 6) =       0.000275597527
  error estimate for blocks of size 2^( 7) =       0.000276662188
  error estimate for blocks of size 2^( 8) =       0.000277078027
  error estimate for blocks of size 2^( 9) =       0.000278878326

      target function =                  N/A
              le_mean =     -22.825354579017
             les_mean =     521.522351818006
             stat err =       0.000277054017
             autocorr =       1.254963470824
              std dev =       0.699509959252
             le_variance =       0.489314183092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489298696793
                                         uncertainty =       0.001570461153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489298696793
                                         uncertainty =       0.001570461153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247310521
  error estimate for blocks of size 2^( 2) =       0.000256412124
  error estimate for blocks of size 2^( 3) =       0.000264517293
  error estimate for blocks of size 2^( 4) =       0.000270315623
  error estimate for blocks of size 2^( 5) =       0.000273569907
  error estimate for blocks of size 2^( 6) =       0.000275596335
  error estimate for blocks of size 2^( 7) =       0.000276661510
  error estimate for blocks of size 2^( 8) =       0.000277077957
  error estimate for blocks of size 2^( 9) =       0.000278881381

      target function =                  N/A
              le_mean =     -22.825354581892
             les_mean =     521.527138056726
             stat err =       0.000277054296
             autocorr =       1.255002503436
              std dev =       0.699499786407
             le_variance =       0.489299951184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489538255243
                                         uncertainty =       0.001586670286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489538255243
                                         uncertainty =       0.001586670286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247371058
  error estimate for blocks of size 2^( 2) =       0.000256465404
  error estimate for blocks of size 2^( 3) =       0.000264560570
  error estimate for blocks of size 2^( 4) =       0.000270350475
  error estimate for blocks of size 2^( 5) =       0.000273602643
  error estimate for blocks of size 2^( 6) =       0.000275636081
  error estimate for blocks of size 2^( 7) =       0.000276703656
  error estimate for blocks of size 2^( 8) =       0.000277096174
  error estimate for blocks of size 2^( 9) =       0.000278904668

      target function =                  N/A
              le_mean =     -22.825359347410
             les_mean =     521.567814309872
             stat err =       0.000277085145
             autocorr =       1.254667683467
              std dev =       0.699671010489
             le_variance =       0.489539522918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825354946320        initial
     9.3132e-02     9.3132e-01             7.1729e-04       -22.825354579017
     3.7253e-01     3.7253e+00             3.3903e-04       -22.825354581892
     1.4901e+00     1.4901e+01             1.1116e-04       -22.825359347410  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 1.7294e+02
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.085329e-01 3 1  ON 0
ci_02                -2.197128e-02 3 1  ON 1
ci_03                -2.170950e-02 3 1  ON 2
ci_04                 2.182748e-02 3 1  ON 3
ci_05                -2.151536e-02 3 1  ON 4
ci_06                -2.164406e-02 3 1  ON 5
ci_07                 2.585789e-02 3 1  ON 6
ci_08                -3.491594e-03 3 1  ON 7
ci_09                -1.106227e-02 3 1  ON 8
ci_10                -1.056919e-02 3 1  ON 9
ci_11                 1.649209e-02 3 1  ON 10
ci_12                 1.059768e-02 3 1  ON 11
ci_13                 1.182166e-02 3 1  ON 12
ci_14                 1.792678e-02 3 1  ON 13
ci_15                 7.393374e-03 3 1  ON 14
ci_16                 7.723480e-03 3 1  ON 15
ci_17                -9.244863e-03 3 1  ON 16
ci_18                -9.392114e-03 3 1  ON 17
ci_19                 9.925551e-03 3 1  ON 18
ci_20                 1.082627e-02 3 1  ON 19
ci_21                 8.099042e-03 3 1  ON 20
ci_22                 8.646705e-03 3 1  ON 21
ci_23                 6.579516e-03 3 1  ON 22
ci_24                 7.503188e-03 3 1  ON 23
ci_25                 5.279449e-03 3 1  ON 24
ci_26                 3.073794e-03 3 1  ON 25
ci_27                 2.438217e-03 3 1  ON 26
ci_28                 2.859275e-03 3 1  ON 27
ci_29                 2.887938e-03 3 1  ON 28
ci_30                 8.213459e-04 3 1  ON 29
ci_31                 7.377049e-04 3 1  ON 30
ci_32                 3.051099e-04 3 1  ON 31
ci_33                 2.097246e-04 3 1  ON 32
ci_34                -4.135526e-04 3 1  ON 33
ci_35                 2.228465e-04 3 1  ON 34
ci_36                -3.244240e-04 3 1  ON 35
ci_37                -4.042961e-04 3 1  ON 36
ci_38                -1.396954e-04 3 1  ON 37
ci_39                -7.629900e-05 3 1  ON 38
ci_40                -1.204727e-03 3 1  ON 39
ci_41                -2.032685e-04 3 1  ON 40
ci_42                -2.540523e-04 3 1  ON 41
ci_43                -2.390972e-03 3 1  ON 42
ci_44                -2.330861e-03 3 1  ON 43
ci_45                 1.029155e-05 3 1  ON 44
ci_46                 8.216816e-05 3 1  ON 45
ci_47                -1.087003e-04 3 1  ON 46
ci_48                 2.371683e-04 3 1  ON 47
ci_49                -1.279551e-03 3 1  ON 48
ci_50                -5.686129e-04 3 1  ON 49
ci_51                 1.072676e-04 3 1  ON 50
ci_52                 8.503573e-05 3 1  ON 51
ci_53                -1.131383e-03 3 1  ON 52
ci_54                -8.239670e-04 3 1  ON 53
ci_55                -7.724340e-04 3 1  ON 54
ci_56                 1.599946e-03 3 1  ON 55
ci_57                 1.668609e-03 3 1  ON 56
ci_58                -1.108899e-03 3 1  ON 57
ci_59                -1.535959e-03 3 1  ON 58
ci_60                 1.575547e-03 3 1  ON 59
ci_61                 2.263712e-03 3 1  ON 60
ci_62                -3.509474e-04 3 1  ON 61
ci_63                -3.156573e-04 3 1  ON 62
ci_64                -4.014888e-04 3 1  ON 63
ci_65                -5.703568e-04 3 1  ON 64
ci_66                -6.058018e-04 3 1  ON 65
ci_67                -3.519242e-04 3 1  ON 66
ci_68                -1.411271e-03 3 1  ON 67
ci_69                -1.770116e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9337e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8129
    reference variance = 0.249671
====================================================
  Execution time = 1.0185e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1343e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0302e-01
  Total weights = 7.855878007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8493e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486357636137
                                         uncertainty =       0.001219866021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486357636137
                                         uncertainty =       0.001219866021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246566038
  error estimate for blocks of size 2^( 2) =       0.000255778561
  error estimate for blocks of size 2^( 3) =       0.000264005844
  error estimate for blocks of size 2^( 4) =       0.000269909330
  error estimate for blocks of size 2^( 5) =       0.000273249846
  error estimate for blocks of size 2^( 6) =       0.000275070887
  error estimate for blocks of size 2^( 7) =       0.000276440153
  error estimate for blocks of size 2^( 8) =       0.000276307525
  error estimate for blocks of size 2^( 9) =       0.000276785035

      target function =                  N/A
              le_mean =     -22.824616166010
             les_mean =     521.466127112618
             stat err =       0.000276150900
             autocorr =       1.254372174002
              std dev =       0.697394070874
             le_variance =       0.486358490090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282461616601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824616166003       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824617108378       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824617370507       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824617373579       residual = 5.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 3.090445e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824616166003       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824616482146       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824616554836       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.039857e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824616166003       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824616252426       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824616270811       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.845114e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2035e+02
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.085475e-01 3 1  ON 0
ci_02                -2.196469e-02 3 1  ON 1
ci_03                -2.177894e-02 3 1  ON 2
ci_04                 2.182718e-02 3 1  ON 3
ci_05                -2.148194e-02 3 1  ON 4
ci_06                -2.159273e-02 3 1  ON 5
ci_07                 2.586353e-02 3 1  ON 6
ci_08                -3.516716e-03 3 1  ON 7
ci_09                -1.105398e-02 3 1  ON 8
ci_10                -1.064193e-02 3 1  ON 9
ci_11                 1.648455e-02 3 1  ON 10
ci_12                 1.062737e-02 3 1  ON 11
ci_13                 1.189463e-02 3 1  ON 12
ci_14                 1.790086e-02 3 1  ON 13
ci_15                 7.386907e-03 3 1  ON 14
ci_16                 7.691420e-03 3 1  ON 15
ci_17                -9.200353e-03 3 1  ON 16
ci_18                -9.333483e-03 3 1  ON 17
ci_19                 9.933392e-03 3 1  ON 18
ci_20                 1.077816e-02 3 1  ON 19
ci_21                 8.116384e-03 3 1  ON 20
ci_22                 8.584984e-03 3 1  ON 21
ci_23                 6.547371e-03 3 1  ON 22
ci_24                 7.476987e-03 3 1  ON 23
ci_25                 5.191080e-03 3 1  ON 24
ci_26                 3.059444e-03 3 1  ON 25
ci_27                 2.468667e-03 3 1  ON 26
ci_28                 2.963261e-03 3 1  ON 27
ci_29                 2.922774e-03 3 1  ON 28
ci_30                 8.171410e-04 3 1  ON 29
ci_31                 7.402507e-04 3 1  ON 30
ci_32                 3.551329e-04 3 1  ON 31
ci_33                 1.485846e-04 3 1  ON 32
ci_34                -3.834834e-04 3 1  ON 33
ci_35                 1.889598e-04 3 1  ON 34
ci_36                -3.089432e-04 3 1  ON 35
ci_37                -4.326986e-04 3 1  ON 36
ci_38                -1.263006e-04 3 1  ON 37
ci_39                -5.006140e-05 3 1  ON 38
ci_40                -1.200371e-03 3 1  ON 39
ci_41                -1.782750e-04 3 1  ON 40
ci_42                -2.189594e-04 3 1  ON 41
ci_43                -2.387967e-03 3 1  ON 42
ci_44                -2.250336e-03 3 1  ON 43
ci_45                -4.521761e-05 3 1  ON 44
ci_46                 3.343291e-05 3 1  ON 45
ci_47                -5.046891e-05 3 1  ON 46
ci_48                 2.550422e-04 3 1  ON 47
ci_49                -1.264068e-03 3 1  ON 48
ci_50                -5.533262e-04 3 1  ON 49
ci_51                 5.154562e-05 3 1  ON 50
ci_52                 8.197761e-05 3 1  ON 51
ci_53                -1.068342e-03 3 1  ON 52
ci_54                -7.570069e-04 3 1  ON 53
ci_55                -8.210191e-04 3 1  ON 54
ci_56                 1.612167e-03 3 1  ON 55
ci_57                 1.613336e-03 3 1  ON 56
ci_58                -1.063713e-03 3 1  ON 57
ci_59                -1.442555e-03 3 1  ON 58
ci_60                 1.573995e-03 3 1  ON 59
ci_61                 2.190455e-03 3 1  ON 60
ci_62                -3.242170e-04 3 1  ON 61
ci_63                -3.976250e-04 3 1  ON 62
ci_64                -3.776313e-04 3 1  ON 63
ci_65                -5.287622e-04 3 1  ON 64
ci_66                -5.912601e-04 3 1  ON 65
ci_67                -3.014060e-04 3 1  ON 66
ci_68                -1.401982e-03 3 1  ON 67
ci_69                -1.730963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8331
    reference variance = 0.324884
====================================================
  Execution time = 1.0069e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0041e-01
  Total weights = 7.8567e+06
  Execution time = 1.4326e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0988943
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484612820139
                                         uncertainty =       0.001254265494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484612820139
                                         uncertainty =       0.001254265494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246123407
  error estimate for blocks of size 2^( 2) =       0.000255403940
  error estimate for blocks of size 2^( 3) =       0.000263479363
  error estimate for blocks of size 2^( 4) =       0.000269101779
  error estimate for blocks of size 2^( 5) =       0.000272701583
  error estimate for blocks of size 2^( 6) =       0.000274347336
  error estimate for blocks of size 2^( 7) =       0.000274808227
  error estimate for blocks of size 2^( 8) =       0.000275412727
  error estimate for blocks of size 2^( 9) =       0.000276062439

      target function =                  N/A
              le_mean =     -22.824946565026
             les_mean =     521.479001173157
             stat err =       0.000275157682
             autocorr =       1.249848721331
              std dev =       0.696142119493
             le_variance =       0.484613850532

ERROR Start of engine's reset
Before block part of reset
end of engine's reset
CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0105515
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484611038445
                                         uncertainty =       0.001252074379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484611038445
                                         uncertainty =       0.001252074379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246122956
  error estimate for blocks of size 2^( 2) =       0.000255404634
  error estimate for blocks of size 2^( 3) =       0.000263479318
  error estimate for blocks of size 2^( 4) =       0.000269102915
  error estimate for blocks of size 2^( 5) =       0.000272701214
  error estimate for blocks of size 2^( 6) =       0.000274346851
  error estimate for blocks of size 2^( 7) =       0.000274803439
  error estimate for blocks of size 2^( 8) =       0.000275411924
  error estimate for blocks of size 2^( 9) =       0.000276065923

      target function =                  N/A
              le_mean =     -22.824945408053
             les_mean =     521.492990208293
             stat err =       0.000275157034
             autocorr =       1.249847403791
              std dev =       0.696140845769
             le_variance =       0.484612077148

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.096501
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484605859235
                                         uncertainty =       0.001252645153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484605859235
                                         uncertainty =       0.001252645153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246121641
  error estimate for blocks of size 2^( 2) =       0.000255403011
  error estimate for blocks of size 2^( 3) =       0.000263478179
  error estimate for blocks of size 2^( 4) =       0.000269101343
  error estimate for blocks of size 2^( 5) =       0.000272700114
  error estimate for blocks of size 2^( 6) =       0.000274346232
  error estimate for blocks of size 2^( 7) =       0.000274804249
  error estimate for blocks of size 2^( 8) =       0.000275411666
  error estimate for blocks of size 2^( 9) =       0.000276063526

      target function =                  N/A
              le_mean =     -22.824945705861
             les_mean =     521.481099709015
             stat err =       0.000275156418
             autocorr =       1.249855172734
              std dev =       0.696137124582
             le_variance =       0.484606896221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484649458952
                                         uncertainty =       0.001259825753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484649458952
                                         uncertainty =       0.001259825753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246132709
  error estimate for blocks of size 2^( 2) =       0.000255411738
  error estimate for blocks of size 2^( 3) =       0.000263486977
  error estimate for blocks of size 2^( 4) =       0.000269110950
  error estimate for blocks of size 2^( 5) =       0.000272710835
  error estimate for blocks of size 2^( 6) =       0.000274363193
  error estimate for blocks of size 2^( 7) =       0.000274827863
  error estimate for blocks of size 2^( 8) =       0.000275423442
  error estimate for blocks of size 2^( 9) =       0.000276069981

      target function =                  N/A
              le_mean =     -22.824948484668
             les_mean =     522.211686896768
             stat err =       0.000275171120
             autocorr =       1.249876313767
              std dev =       0.696168431433
             le_variance =       0.484650484925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824946565026        initial
     3.7253e-01     3.7253e+00             3.0904e-04       -22.824945408053
     1.4901e+00     1.4901e+01             1.0399e-04       -22.824945705861
     5.9605e+00     5.9605e+01             2.8451e-05       -22.824948484668  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 1.7237e+02
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_01                 1.085366e-01 3 1  ON 0
ci_02                -2.196924e-02 3 1  ON 1
ci_03                -2.172788e-02 3 1  ON 2
ci_04                 2.182725e-02 3 1  ON 3
ci_05                -2.150650e-02 3 1  ON 4
ci_06                -2.163068e-02 3 1  ON 5
ci_07                 2.585976e-02 3 1  ON 6
ci_08                -3.498833e-03 3 1  ON 7
ci_09                -1.106013e-02 3 1  ON 8
ci_10                -1.058849e-02 3 1  ON 9
ci_11                 1.648997e-02 3 1  ON 10
ci_12                 1.060573e-02 3 1  ON 11
ci_13                 1.184120e-02 3 1  ON 12
ci_14                 1.792033e-02 3 1  ON 13
ci_15                 7.391614e-03 3 1  ON 14
ci_16                 7.714971e-03 3 1  ON 15
ci_17                -9.232886e-03 3 1  ON 16
ci_18                -9.376282e-03 3 1  ON 17
ci_19                 9.927721e-03 3 1  ON 18
ci_20                 1.081309e-02 3 1  ON 19
ci_21                 8.103405e-03 3 1  ON 20
ci_22                 8.630108e-03 3 1  ON 21
ci_23                 6.570362e-03 3 1  ON 22
ci_24                 7.496092e-03 3 1  ON 23
ci_25                 5.254954e-03 3 1  ON 24
ci_26                 3.069906e-03 3 1  ON 25
ci_27                 2.446347e-03 3 1  ON 26
ci_28                 2.887726e-03 3 1  ON 27
ci_29                 2.897701e-03 3 1  ON 28
ci_30                 8.199065e-04 3 1  ON 29
ci_31                 7.379120e-04 3 1  ON 30
ci_32                 3.193096e-04 3 1  ON 31
ci_33                 1.925612e-04 3 1  ON 32
ci_34                -4.051336e-04 3 1  ON 33
ci_35                 2.137764e-04 3 1  ON 34
ci_36                -3.202151e-04 3 1  ON 35
ci_37                -4.124234e-04 3 1  ON 36
ci_38                -1.361460e-04 3 1  ON 37
ci_39                -6.906142e-05 3 1  ON 38
ci_40                -1.203545e-03 3 1  ON 39
ci_41                -1.961578e-04 3 1  ON 40
ci_42                -2.442040e-04 3 1  ON 41
ci_43                -2.390106e-03 3 1  ON 42
ci_44                -2.308995e-03 3 1  ON 43
ci_45                -5.420559e-06 3 1  ON 44
ci_46                 6.836051e-05 3 1  ON 45
ci_47                -9.323278e-05 3 1  ON 46
ci_48                 2.422216e-04 3 1  ON 47
ci_49                -1.275153e-03 3 1  ON 48
ci_50                -5.639616e-04 3 1  ON 49
ci_51                 9.158852e-05 3 1  ON 50
ci_52                 8.408575e-05 3 1  ON 51
ci_53                -1.113316e-03 3 1  ON 52
ci_54                -8.058112e-04 3 1  ON 53
ci_55                -7.857119e-04 3 1  ON 54
ci_56                 1.603451e-03 3 1  ON 55
ci_57                 1.652864e-03 3 1  ON 56
ci_58                -1.096485e-03 3 1  ON 57
ci_59                -1.510451e-03 3 1  ON 58
ci_60                 1.575178e-03 3 1  ON 59
ci_61                 2.244837e-03 3 1  ON 60
ci_62                -3.431961e-04 3 1  ON 61
ci_63                -3.391008e-04 3 1  ON 62
ci_64                -3.949333e-04 3 1  ON 63
ci_65                -5.588924e-04 3 1  ON 64
ci_66                -6.016544e-04 3 1  ON 65
ci_67                -3.377615e-04 3 1  ON 66
ci_68                -1.408610e-03 3 1  ON 67
ci_69                -1.759468e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9273e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.8956
    reference variance = 0.230682
====================================================
  Execution time = 1.0007e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1370e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0276e-01
  Total weights = 7.856334548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8917e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487108244905
                                         uncertainty =       0.001260144422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487108244905
                                         uncertainty =       0.001260144422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246756431
  error estimate for blocks of size 2^( 2) =       0.000255871925
  error estimate for blocks of size 2^( 3) =       0.000264034581
  error estimate for blocks of size 2^( 4) =       0.000269986269
  error estimate for blocks of size 2^( 5) =       0.000273480349
  error estimate for blocks of size 2^( 6) =       0.000275341843
  error estimate for blocks of size 2^( 7) =       0.000276211084
  error estimate for blocks of size 2^( 8) =       0.000277014152
  error estimate for blocks of size 2^( 9) =       0.000278380814

      target function =                  N/A
              le_mean =     -22.824770155334
             les_mean =     521.472892206762
             stat err =       0.000276736973
             autocorr =       1.257758941262
              std dev =       0.697932581913
             le_variance =       0.487109888895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282477015533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824770155328       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824771134883       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824771060392       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.640325e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824770155328       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824770425634       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824770405867       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.467778e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824770155328       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824770224705       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824770219711       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.142598e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1900e+02
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.085447e-01 3 1  ON 0
ci_02                -2.197579e-02 3 1  ON 1
ci_03                -2.174211e-02 3 1  ON 2
ci_04                 2.182920e-02 3 1  ON 3
ci_05                -2.150402e-02 3 1  ON 4
ci_06                -2.163814e-02 3 1  ON 5
ci_07                 2.586586e-02 3 1  ON 6
ci_08                -3.496984e-03 3 1  ON 7
ci_09                -1.105891e-02 3 1  ON 8
ci_10                -1.059302e-02 3 1  ON 9
ci_11                 1.648978e-02 3 1  ON 10
ci_12                 1.061943e-02 3 1  ON 11
ci_13                 1.185090e-02 3 1  ON 12
ci_14                 1.792631e-02 3 1  ON 13
ci_15                 7.405947e-03 3 1  ON 14
ci_16                 7.698589e-03 3 1  ON 15
ci_17                -9.213103e-03 3 1  ON 16
ci_18                -9.375814e-03 3 1  ON 17
ci_19                 9.902549e-03 3 1  ON 18
ci_20                 1.082109e-02 3 1  ON 19
ci_21                 8.107478e-03 3 1  ON 20
ci_22                 8.621485e-03 3 1  ON 21
ci_23                 6.570629e-03 3 1  ON 22
ci_24                 7.502528e-03 3 1  ON 23
ci_25                 5.254168e-03 3 1  ON 24
ci_26                 3.056691e-03 3 1  ON 25
ci_27                 2.427919e-03 3 1  ON 26
ci_28                 2.899206e-03 3 1  ON 27
ci_29                 2.906005e-03 3 1  ON 28
ci_30                 8.266463e-04 3 1  ON 29
ci_31                 7.279898e-04 3 1  ON 30
ci_32                 3.255514e-04 3 1  ON 31
ci_33                 2.345028e-04 3 1  ON 32
ci_34                -3.895687e-04 3 1  ON 33
ci_35                 1.690986e-04 3 1  ON 34
ci_36                -3.251977e-04 3 1  ON 35
ci_37                -4.085175e-04 3 1  ON 36
ci_38                -1.370074e-04 3 1  ON 37
ci_39                -7.299102e-05 3 1  ON 38
ci_40                -1.215622e-03 3 1  ON 39
ci_41                -2.052917e-04 3 1  ON 40
ci_42                -2.230581e-04 3 1  ON 41
ci_43                -2.385966e-03 3 1  ON 42
ci_44                -2.324066e-03 3 1  ON 43
ci_45                -3.981333e-06 3 1  ON 44
ci_46                 6.330267e-05 3 1  ON 45
ci_47                -9.206113e-05 3 1  ON 46
ci_48                 2.446434e-04 3 1  ON 47
ci_49                -1.265605e-03 3 1  ON 48
ci_50                -5.648165e-04 3 1  ON 49
ci_51                 7.668650e-05 3 1  ON 50
ci_52                 7.932634e-05 3 1  ON 51
ci_53                -1.103226e-03 3 1  ON 52
ci_54                -7.940130e-04 3 1  ON 53
ci_55                -7.775124e-04 3 1  ON 54
ci_56                 1.606525e-03 3 1  ON 55
ci_57                 1.645501e-03 3 1  ON 56
ci_58                -1.088216e-03 3 1  ON 57
ci_59                -1.498273e-03 3 1  ON 58
ci_60                 1.570093e-03 3 1  ON 59
ci_61                 2.247228e-03 3 1  ON 60
ci_62                -3.499598e-04 3 1  ON 61
ci_63                -3.381153e-04 3 1  ON 62
ci_64                -4.165804e-04 3 1  ON 63
ci_65                -5.608887e-04 3 1  ON 64
ci_66                -5.853821e-04 3 1  ON 65
ci_67                -3.236541e-04 3 1  ON 66
ci_68                -1.399200e-03 3 1  ON 67
ci_69                -1.749234e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7573
    reference variance = 0.307787
====================================================
  Execution time = 1.0115e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0035e-01
  Total weights = 7.8565e+06
  Execution time = 1.4346e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485215059895
                                         uncertainty =       0.001275598039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485215059895
                                         uncertainty =       0.001275598039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246276637
  error estimate for blocks of size 2^( 2) =       0.000255428559
  error estimate for blocks of size 2^( 3) =       0.000263765821
  error estimate for blocks of size 2^( 4) =       0.000269910912
  error estimate for blocks of size 2^( 5) =       0.000273503142
  error estimate for blocks of size 2^( 6) =       0.000275602825
  error estimate for blocks of size 2^( 7) =       0.000276919198
  error estimate for blocks of size 2^( 8) =       0.000276992726
  error estimate for blocks of size 2^( 9) =       0.000279014084

      target function =                  N/A
              le_mean =     -22.824810150284
             les_mean =     521.472343896576
             stat err =       0.000277132208
             autocorr =       1.266273660513
              std dev =       0.696575521544
             le_variance =       0.485217457214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485222523163
                                         uncertainty =       0.001274838531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485222523163
                                         uncertainty =       0.001274838531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246278530
  error estimate for blocks of size 2^( 2) =       0.000255430410
  error estimate for blocks of size 2^( 3) =       0.000263767580
  error estimate for blocks of size 2^( 4) =       0.000269912787
  error estimate for blocks of size 2^( 5) =       0.000273504577
  error estimate for blocks of size 2^( 6) =       0.000275605121
  error estimate for blocks of size 2^( 7) =       0.000276920056
  error estimate for blocks of size 2^( 8) =       0.000276995068
  error estimate for blocks of size 2^( 9) =       0.000279020070

      target function =                  N/A
              le_mean =     -22.824809918910
             les_mean =     521.472380759365
             stat err =       0.000277135079
             autocorr =       1.266280430606
              std dev =       0.696580875416
             le_variance =       0.485224915996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485218513502
                                         uncertainty =       0.001275177959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485218513502
                                         uncertainty =       0.001275177959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246277513
  error estimate for blocks of size 2^( 2) =       0.000255429434
  error estimate for blocks of size 2^( 3) =       0.000263766666
  error estimate for blocks of size 2^( 4) =       0.000269911840
  error estimate for blocks of size 2^( 5) =       0.000273503833
  error estimate for blocks of size 2^( 6) =       0.000275603971
  error estimate for blocks of size 2^( 7) =       0.000276919546
  error estimate for blocks of size 2^( 8) =       0.000276993880
  error estimate for blocks of size 2^( 9) =       0.000279017305

      target function =                  N/A
              le_mean =     -22.824809972581
             les_mean =     521.472334909486
             stat err =       0.000277133675
             autocorr =       1.266278062494
              std dev =       0.696577998783
             le_variance =       0.485220908389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485215420501
                                         uncertainty =       0.001275543396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485215420501
                                         uncertainty =       0.001275543396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246276729
  error estimate for blocks of size 2^( 2) =       0.000255428653
  error estimate for blocks of size 2^( 3) =       0.000263765912
  error estimate for blocks of size 2^( 4) =       0.000269911010
  error estimate for blocks of size 2^( 5) =       0.000273503205
  error estimate for blocks of size 2^( 6) =       0.000275602954
  error estimate for blocks of size 2^( 7) =       0.000276919204
  error estimate for blocks of size 2^( 8) =       0.000276992821
  error estimate for blocks of size 2^( 9) =       0.000279014424

      target function =                  N/A
              le_mean =     -22.824810127822
             les_mean =     521.472737629319
             stat err =       0.000277132351
             autocorr =       1.266274023651
              std dev =       0.696575780161
             le_variance =       0.485217817507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824810150284        initial  <--
     1.4901e+00     1.4901e+01             1.6403e-04       -22.824809918910
     5.9605e+00     5.9605e+01             4.4678e-05       -22.824809972581
     2.3842e+01     2.3842e+02             1.1426e-05       -22.824810127822

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.9107
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_01                 1.085366e-01 3 1  ON 0
ci_02                -2.196924e-02 3 1  ON 1
ci_03                -2.172788e-02 3 1  ON 2
ci_04                 2.182725e-02 3 1  ON 3
ci_05                -2.150650e-02 3 1  ON 4
ci_06                -2.163068e-02 3 1  ON 5
ci_07                 2.585976e-02 3 1  ON 6
ci_08                -3.498833e-03 3 1  ON 7
ci_09                -1.106013e-02 3 1  ON 8
ci_10                -1.058849e-02 3 1  ON 9
ci_11                 1.648997e-02 3 1  ON 10
ci_12                 1.060573e-02 3 1  ON 11
ci_13                 1.184120e-02 3 1  ON 12
ci_14                 1.792033e-02 3 1  ON 13
ci_15                 7.391614e-03 3 1  ON 14
ci_16                 7.714971e-03 3 1  ON 15
ci_17                -9.232886e-03 3 1  ON 16
ci_18                -9.376282e-03 3 1  ON 17
ci_19                 9.927721e-03 3 1  ON 18
ci_20                 1.081309e-02 3 1  ON 19
ci_21                 8.103405e-03 3 1  ON 20
ci_22                 8.630108e-03 3 1  ON 21
ci_23                 6.570362e-03 3 1  ON 22
ci_24                 7.496092e-03 3 1  ON 23
ci_25                 5.254954e-03 3 1  ON 24
ci_26                 3.069906e-03 3 1  ON 25
ci_27                 2.446347e-03 3 1  ON 26
ci_28                 2.887726e-03 3 1  ON 27
ci_29                 2.897701e-03 3 1  ON 28
ci_30                 8.199065e-04 3 1  ON 29
ci_31                 7.379120e-04 3 1  ON 30
ci_32                 3.193096e-04 3 1  ON 31
ci_33                 1.925612e-04 3 1  ON 32
ci_34                -4.051336e-04 3 1  ON 33
ci_35                 2.137764e-04 3 1  ON 34
ci_36                -3.202151e-04 3 1  ON 35
ci_37                -4.124234e-04 3 1  ON 36
ci_38                -1.361460e-04 3 1  ON 37
ci_39                -6.906142e-05 3 1  ON 38
ci_40                -1.203545e-03 3 1  ON 39
ci_41                -1.961578e-04 3 1  ON 40
ci_42                -2.442040e-04 3 1  ON 41
ci_43                -2.390106e-03 3 1  ON 42
ci_44                -2.308995e-03 3 1  ON 43
ci_45                -5.420559e-06 3 1  ON 44
ci_46                 6.836051e-05 3 1  ON 45
ci_47                -9.323278e-05 3 1  ON 46
ci_48                 2.422216e-04 3 1  ON 47
ci_49                -1.275153e-03 3 1  ON 48
ci_50                -5.639616e-04 3 1  ON 49
ci_51                 9.158852e-05 3 1  ON 50
ci_52                 8.408575e-05 3 1  ON 51
ci_53                -1.113316e-03 3 1  ON 52
ci_54                -8.058112e-04 3 1  ON 53
ci_55                -7.857119e-04 3 1  ON 54
ci_56                 1.603451e-03 3 1  ON 55
ci_57                 1.652864e-03 3 1  ON 56
ci_58                -1.096485e-03 3 1  ON 57
ci_59                -1.510451e-03 3 1  ON 58
ci_60                 1.575178e-03 3 1  ON 59
ci_61                 2.244837e-03 3 1  ON 60
ci_62                -3.431961e-04 3 1  ON 61
ci_63                -3.391008e-04 3 1  ON 62
ci_64                -3.949333e-04 3 1  ON 63
ci_65                -5.588924e-04 3 1  ON 64
ci_66                -6.016544e-04 3 1  ON 65
ci_67                -3.377615e-04 3 1  ON 66
ci_68                -1.408610e-03 3 1  ON 67
ci_69                -1.759468e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9192e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7951
    reference variance = 0.365229
====================================================
  Execution time = 1.0022e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1375e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0393e-01
  Total weights = 7.857346567e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8476e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486007809356
                                         uncertainty =       0.001172544027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486007809356
                                         uncertainty =       0.001172544027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246477363
  error estimate for blocks of size 2^( 2) =       0.000255606412
  error estimate for blocks of size 2^( 3) =       0.000263987512
  error estimate for blocks of size 2^( 4) =       0.000269677133
  error estimate for blocks of size 2^( 5) =       0.000273068643
  error estimate for blocks of size 2^( 6) =       0.000275088355
  error estimate for blocks of size 2^( 7) =       0.000276319358
  error estimate for blocks of size 2^( 8) =       0.000276769335
  error estimate for blocks of size 2^( 9) =       0.000277564557

      target function =                  N/A
              le_mean =     -22.824737914618
             les_mean =     521.472594433797
             stat err =       0.000276435401
             autocorr =       1.257862703999
              std dev =       0.697143259706
             le_variance =       0.486008724553


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282473791462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824737914613       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824738009963       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824738020744       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824738020647       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 1.862234e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824737914613       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824737938670       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824737941390       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824737941374       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+01 is 4.717649e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824737914613       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824737920641       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824737921323       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824737921319       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 1.183355e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1871e+02
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.085341e-01 3 1  ON 0
ci_02                -2.197048e-02 3 1  ON 1
ci_03                -2.172808e-02 3 1  ON 2
ci_04                 2.182691e-02 3 1  ON 3
ci_05                -2.150698e-02 3 1  ON 4
ci_06                -2.162964e-02 3 1  ON 5
ci_07                 2.585895e-02 3 1  ON 6
ci_08                -3.500017e-03 3 1  ON 7
ci_09                -1.106070e-02 3 1  ON 8
ci_10                -1.058928e-02 3 1  ON 9
ci_11                 1.648842e-02 3 1  ON 10
ci_12                 1.060612e-02 3 1  ON 11
ci_13                 1.184326e-02 3 1  ON 12
ci_14                 1.791735e-02 3 1  ON 13
ci_15                 7.391416e-03 3 1  ON 14
ci_16                 7.715227e-03 3 1  ON 15
ci_17                -9.232722e-03 3 1  ON 16
ci_18                -9.374817e-03 3 1  ON 17
ci_19                 9.927421e-03 3 1  ON 18
ci_20                 1.081154e-02 3 1  ON 19
ci_21                 8.106915e-03 3 1  ON 20
ci_22                 8.629973e-03 3 1  ON 21
ci_23                 6.565645e-03 3 1  ON 22
ci_24                 7.496830e-03 3 1  ON 23
ci_25                 5.255618e-03 3 1  ON 24
ci_26                 3.066815e-03 3 1  ON 25
ci_27                 2.446878e-03 3 1  ON 26
ci_28                 2.887161e-03 3 1  ON 27
ci_29                 2.897215e-03 3 1  ON 28
ci_30                 8.197229e-04 3 1  ON 29
ci_31                 7.376303e-04 3 1  ON 30
ci_32                 3.178010e-04 3 1  ON 31
ci_33                 1.926957e-04 3 1  ON 32
ci_34                -4.045302e-04 3 1  ON 33
ci_35                 2.133585e-04 3 1  ON 34
ci_36                -3.177213e-04 3 1  ON 35
ci_37                -4.153763e-04 3 1  ON 36
ci_38                -1.361542e-04 3 1  ON 37
ci_39                -6.926537e-05 3 1  ON 38
ci_40                -1.204749e-03 3 1  ON 39
ci_41                -1.967760e-04 3 1  ON 40
ci_42                -2.438002e-04 3 1  ON 41
ci_43                -2.393989e-03 3 1  ON 42
ci_44                -2.308841e-03 3 1  ON 43
ci_45                -3.154957e-06 3 1  ON 44
ci_46                 6.843713e-05 3 1  ON 45
ci_47                -9.285381e-05 3 1  ON 46
ci_48                 2.431810e-04 3 1  ON 47
ci_49                -1.275064e-03 3 1  ON 48
ci_50                -5.635441e-04 3 1  ON 49
ci_51                 9.004160e-05 3 1  ON 50
ci_52                 8.445626e-05 3 1  ON 51
ci_53                -1.113294e-03 3 1  ON 52
ci_54                -8.063142e-04 3 1  ON 53
ci_55                -7.867622e-04 3 1  ON 54
ci_56                 1.604582e-03 3 1  ON 55
ci_57                 1.654307e-03 3 1  ON 56
ci_58                -1.097914e-03 3 1  ON 57
ci_59                -1.511029e-03 3 1  ON 58
ci_60                 1.575407e-03 3 1  ON 59
ci_61                 2.244615e-03 3 1  ON 60
ci_62                -3.400103e-04 3 1  ON 61
ci_63                -3.405426e-04 3 1  ON 62
ci_64                -3.953822e-04 3 1  ON 63
ci_65                -5.600737e-04 3 1  ON 64
ci_66                -6.031821e-04 3 1  ON 65
ci_67                -3.368625e-04 3 1  ON 66
ci_68                -1.410601e-03 3 1  ON 67
ci_69                -1.759566e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.693
    reference variance = 0.350187
====================================================
  Execution time = 1.0134e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0607e-01
  Total weights = 7.8567e+06
  Execution time = 1.4323e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487870074014
                                         uncertainty =       0.001519039547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487870074014
                                         uncertainty =       0.001519039547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246949322
  error estimate for blocks of size 2^( 2) =       0.000256157108
  error estimate for blocks of size 2^( 3) =       0.000264412345
  error estimate for blocks of size 2^( 4) =       0.000270308509
  error estimate for blocks of size 2^( 5) =       0.000273713916
  error estimate for blocks of size 2^( 6) =       0.000275504891
  error estimate for blocks of size 2^( 7) =       0.000275942012
  error estimate for blocks of size 2^( 8) =       0.000276710664
  error estimate for blocks of size 2^( 9) =       0.000278523403

      target function =                  N/A
              le_mean =     -22.824640767055
             les_mean =     521.470286942218
             stat err =       0.000276670243
             autocorr =       1.255189296623
              std dev =       0.698478159709
             le_variance =       0.487871739590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487867828720
                                         uncertainty =       0.001517824297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487867828720
                                         uncertainty =       0.001517824297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246948754
  error estimate for blocks of size 2^( 2) =       0.000256156621
  error estimate for blocks of size 2^( 3) =       0.000264411869
  error estimate for blocks of size 2^( 4) =       0.000270308065
  error estimate for blocks of size 2^( 5) =       0.000273713569
  error estimate for blocks of size 2^( 6) =       0.000275504637
  error estimate for blocks of size 2^( 7) =       0.000275941821
  error estimate for blocks of size 2^( 8) =       0.000276710396
  error estimate for blocks of size 2^( 9) =       0.000278523195

      target function =                  N/A
              le_mean =     -22.824640754447
             les_mean =     521.470317349074
             stat err =       0.000276670012
             autocorr =       1.255192979746
              std dev =       0.698476553398
             le_variance =       0.487869495646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487868930861
                                         uncertainty =       0.001518425145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487868930861
                                         uncertainty =       0.001518425145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246949032
  error estimate for blocks of size 2^( 2) =       0.000256156860
  error estimate for blocks of size 2^( 3) =       0.000264412102
  error estimate for blocks of size 2^( 4) =       0.000270308282
  error estimate for blocks of size 2^( 5) =       0.000273713739
  error estimate for blocks of size 2^( 6) =       0.000275504762
  error estimate for blocks of size 2^( 7) =       0.000275941915
  error estimate for blocks of size 2^( 8) =       0.000276710527
  error estimate for blocks of size 2^( 9) =       0.000278523293

      target function =                  N/A
              le_mean =     -22.824640759964
             les_mean =     521.470305939710
             stat err =       0.000276670124
             autocorr =       1.255191159691
              std dev =       0.698477341880
             le_variance =       0.487870597120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487869929620
                                         uncertainty =       0.001518962451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487869929620
                                         uncertainty =       0.001518962451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246949285
  error estimate for blocks of size 2^( 2) =       0.000256157076
  error estimate for blocks of size 2^( 3) =       0.000264412314
  error estimate for blocks of size 2^( 4) =       0.000270308480
  error estimate for blocks of size 2^( 5) =       0.000273713894
  error estimate for blocks of size 2^( 6) =       0.000275504874
  error estimate for blocks of size 2^( 7) =       0.000275942000
  error estimate for blocks of size 2^( 8) =       0.000276710647
  error estimate for blocks of size 2^( 9) =       0.000278523390

      target function =                  N/A
              le_mean =     -22.824640766003
             les_mean =     521.470288347773
             stat err =       0.000276670228
             autocorr =       1.255189530452
              std dev =       0.698478056406
             le_variance =       0.487871595281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824640767055        initial  <--
     1.4901e+01     1.4901e+02             1.8622e-05       -22.824640754447
     5.9605e+01     5.9605e+02             4.7176e-06       -22.824640759964
     2.3842e+02     2.3842e+03             1.1834e-06       -22.824640766003

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.9757
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_01                 1.085366e-01 3 1  ON 0
ci_02                -2.196924e-02 3 1  ON 1
ci_03                -2.172788e-02 3 1  ON 2
ci_04                 2.182725e-02 3 1  ON 3
ci_05                -2.150650e-02 3 1  ON 4
ci_06                -2.163068e-02 3 1  ON 5
ci_07                 2.585976e-02 3 1  ON 6
ci_08                -3.498833e-03 3 1  ON 7
ci_09                -1.106013e-02 3 1  ON 8
ci_10                -1.058849e-02 3 1  ON 9
ci_11                 1.648997e-02 3 1  ON 10
ci_12                 1.060573e-02 3 1  ON 11
ci_13                 1.184120e-02 3 1  ON 12
ci_14                 1.792033e-02 3 1  ON 13
ci_15                 7.391614e-03 3 1  ON 14
ci_16                 7.714971e-03 3 1  ON 15
ci_17                -9.232886e-03 3 1  ON 16
ci_18                -9.376282e-03 3 1  ON 17
ci_19                 9.927721e-03 3 1  ON 18
ci_20                 1.081309e-02 3 1  ON 19
ci_21                 8.103405e-03 3 1  ON 20
ci_22                 8.630108e-03 3 1  ON 21
ci_23                 6.570362e-03 3 1  ON 22
ci_24                 7.496092e-03 3 1  ON 23
ci_25                 5.254954e-03 3 1  ON 24
ci_26                 3.069906e-03 3 1  ON 25
ci_27                 2.446347e-03 3 1  ON 26
ci_28                 2.887726e-03 3 1  ON 27
ci_29                 2.897701e-03 3 1  ON 28
ci_30                 8.199065e-04 3 1  ON 29
ci_31                 7.379120e-04 3 1  ON 30
ci_32                 3.193096e-04 3 1  ON 31
ci_33                 1.925612e-04 3 1  ON 32
ci_34                -4.051336e-04 3 1  ON 33
ci_35                 2.137764e-04 3 1  ON 34
ci_36                -3.202151e-04 3 1  ON 35
ci_37                -4.124234e-04 3 1  ON 36
ci_38                -1.361460e-04 3 1  ON 37
ci_39                -6.906142e-05 3 1  ON 38
ci_40                -1.203545e-03 3 1  ON 39
ci_41                -1.961578e-04 3 1  ON 40
ci_42                -2.442040e-04 3 1  ON 41
ci_43                -2.390106e-03 3 1  ON 42
ci_44                -2.308995e-03 3 1  ON 43
ci_45                -5.420559e-06 3 1  ON 44
ci_46                 6.836051e-05 3 1  ON 45
ci_47                -9.323278e-05 3 1  ON 46
ci_48                 2.422216e-04 3 1  ON 47
ci_49                -1.275153e-03 3 1  ON 48
ci_50                -5.639616e-04 3 1  ON 49
ci_51                 9.158852e-05 3 1  ON 50
ci_52                 8.408575e-05 3 1  ON 51
ci_53                -1.113316e-03 3 1  ON 52
ci_54                -8.058112e-04 3 1  ON 53
ci_55                -7.857119e-04 3 1  ON 54
ci_56                 1.603451e-03 3 1  ON 55
ci_57                 1.652864e-03 3 1  ON 56
ci_58                -1.096485e-03 3 1  ON 57
ci_59                -1.510451e-03 3 1  ON 58
ci_60                 1.575178e-03 3 1  ON 59
ci_61                 2.244837e-03 3 1  ON 60
ci_62                -3.431961e-04 3 1  ON 61
ci_63                -3.391008e-04 3 1  ON 62
ci_64                -3.949333e-04 3 1  ON 63
ci_65                -5.588924e-04 3 1  ON 64
ci_66                -6.016544e-04 3 1  ON 65
ci_67                -3.377615e-04 3 1  ON 66
ci_68                -1.408610e-03 3 1  ON 67
ci_69                -1.759468e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9169e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7568
    reference variance = 0.610102
====================================================
  Execution time = 1.0023e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1329e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0035e-01
  Total weights = 7.856294572e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8514e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485108163357
                                         uncertainty =       0.001240305896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485108163357
                                         uncertainty =       0.001240305896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246248683
  error estimate for blocks of size 2^( 2) =       0.000255380839
  error estimate for blocks of size 2^( 3) =       0.000263491721
  error estimate for blocks of size 2^( 4) =       0.000269488555
  error estimate for blocks of size 2^( 5) =       0.000272969084
  error estimate for blocks of size 2^( 6) =       0.000274755949
  error estimate for blocks of size 2^( 7) =       0.000276113621
  error estimate for blocks of size 2^( 8) =       0.000276033497
  error estimate for blocks of size 2^( 9) =       0.000276624623

      target function =                  N/A
              le_mean =     -22.824679078150
             les_mean =     521.466320587503
             stat err =       0.000275881923
             autocorr =       1.255158736076
              std dev =       0.696496455713
             le_variance =       0.485107312821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282467907815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824679078147       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824679078639       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824679079268       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824679079380       residual = 6.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.348719e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824679078147       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824679078270       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824679078427       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824679078455       residual = 6.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.376495e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824679078147       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824679078178       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824679078217       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824679078225       residual = 6.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 8.444181e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.2251e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.085366e-01 3 1  ON 0
ci_02                -2.196928e-02 3 1  ON 1
ci_03                -2.172795e-02 3 1  ON 2
ci_04                 2.182719e-02 3 1  ON 3
ci_05                -2.150651e-02 3 1  ON 4
ci_06                -2.163085e-02 3 1  ON 5
ci_07                 2.585970e-02 3 1  ON 6
ci_08                -3.498891e-03 3 1  ON 7
ci_09                -1.106006e-02 3 1  ON 8
ci_10                -1.058857e-02 3 1  ON 9
ci_11                 1.649009e-02 3 1  ON 10
ci_12                 1.060585e-02 3 1  ON 11
ci_13                 1.184122e-02 3 1  ON 12
ci_14                 1.792034e-02 3 1  ON 13
ci_15                 7.391483e-03 3 1  ON 14
ci_16                 7.715211e-03 3 1  ON 15
ci_17                -9.232722e-03 3 1  ON 16
ci_18                -9.376170e-03 3 1  ON 17
ci_19                 9.927433e-03 3 1  ON 18
ci_20                 1.081292e-02 3 1  ON 19
ci_21                 8.103133e-03 3 1  ON 20
ci_22                 8.630146e-03 3 1  ON 21
ci_23                 6.570292e-03 3 1  ON 22
ci_24                 7.495912e-03 3 1  ON 23
ci_25                 5.255098e-03 3 1  ON 24
ci_26                 3.069815e-03 3 1  ON 25
ci_27                 2.446320e-03 3 1  ON 26
ci_28                 2.887643e-03 3 1  ON 27
ci_29                 2.897865e-03 3 1  ON 28
ci_30                 8.198094e-04 3 1  ON 29
ci_31                 7.380091e-04 3 1  ON 30
ci_32                 3.190974e-04 3 1  ON 31
ci_33                 1.927053e-04 3 1  ON 32
ci_34                -4.050202e-04 3 1  ON 33
ci_35                 2.136696e-04 3 1  ON 34
ci_36                -3.203029e-04 3 1  ON 35
ci_37                -4.125024e-04 3 1  ON 36
ci_38                -1.364837e-04 3 1  ON 37
ci_39                -6.917198e-05 3 1  ON 38
ci_40                -1.203362e-03 3 1  ON 39
ci_41                -1.963165e-04 3 1  ON 40
ci_42                -2.440687e-04 3 1  ON 41
ci_43                -2.390091e-03 3 1  ON 42
ci_44                -2.309293e-03 3 1  ON 43
ci_45                -5.523906e-06 3 1  ON 44
ci_46                 6.823420e-05 3 1  ON 45
ci_47                -9.342960e-05 3 1  ON 46
ci_48                 2.420723e-04 3 1  ON 47
ci_49                -1.275023e-03 3 1  ON 48
ci_50                -5.639486e-04 3 1  ON 49
ci_51                 9.150613e-05 3 1  ON 50
ci_52                 8.383694e-05 3 1  ON 51
ci_53                -1.113248e-03 3 1  ON 52
ci_54                -8.059425e-04 3 1  ON 53
ci_55                -7.857166e-04 3 1  ON 54
ci_56                 1.603267e-03 3 1  ON 55
ci_57                 1.652573e-03 3 1  ON 56
ci_58                -1.096576e-03 3 1  ON 57
ci_59                -1.510478e-03 3 1  ON 58
ci_60                 1.575180e-03 3 1  ON 59
ci_61                 2.244791e-03 3 1  ON 60
ci_62                -3.432857e-04 3 1  ON 61
ci_63                -3.393266e-04 3 1  ON 62
ci_64                -3.949799e-04 3 1  ON 63
ci_65                -5.589676e-04 3 1  ON 64
ci_66                -6.014231e-04 3 1  ON 65
ci_67                -3.376562e-04 3 1  ON 66
ci_68                -1.408488e-03 3 1  ON 67
ci_69                -1.759273e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.9016
    reference variance = 0.567557
====================================================
  Execution time = 1.0093e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9911e-01
  Total weights = 7.8568e+06
  Execution time = 1.4314e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834803108
                                         uncertainty =       0.001178634989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834803108
                                         uncertainty =       0.001178634989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245671373
  error estimate for blocks of size 2^( 2) =       0.000254886219
  error estimate for blocks of size 2^( 3) =       0.000263193400
  error estimate for blocks of size 2^( 4) =       0.000269181505
  error estimate for blocks of size 2^( 5) =       0.000272746175
  error estimate for blocks of size 2^( 6) =       0.000274526161
  error estimate for blocks of size 2^( 7) =       0.000276007539
  error estimate for blocks of size 2^( 8) =       0.000276674357
  error estimate for blocks of size 2^( 9) =       0.000277131162

      target function =                  N/A
              le_mean =     -22.824036414756
             les_mean =     521.435753691078
             stat err =       0.000276084805
             autocorr =       1.262920177931
              std dev =       0.694863576355
             le_variance =       0.482835389745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834808357
                                         uncertainty =       0.001178626755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834808357
                                         uncertainty =       0.001178626755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245671375
  error estimate for blocks of size 2^( 2) =       0.000254886218
  error estimate for blocks of size 2^( 3) =       0.000263193400
  error estimate for blocks of size 2^( 4) =       0.000269181499
  error estimate for blocks of size 2^( 5) =       0.000272746162
  error estimate for blocks of size 2^( 6) =       0.000274526164
  error estimate for blocks of size 2^( 7) =       0.000276007541
  error estimate for blocks of size 2^( 8) =       0.000276674360
  error estimate for blocks of size 2^( 9) =       0.000277131157

      target function =                  N/A
              le_mean =     -22.824036419811
             les_mean =     521.435749821982
             stat err =       0.000276084805
             autocorr =       1.262920168100
              std dev =       0.694863580133
             le_variance =       0.482835394996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834805631
                                         uncertainty =       0.001178630867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834805631
                                         uncertainty =       0.001178630867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245671374
  error estimate for blocks of size 2^( 2) =       0.000254886218
  error estimate for blocks of size 2^( 3) =       0.000263193400
  error estimate for blocks of size 2^( 4) =       0.000269181502
  error estimate for blocks of size 2^( 5) =       0.000272746168
  error estimate for blocks of size 2^( 6) =       0.000274526162
  error estimate for blocks of size 2^( 7) =       0.000276007540
  error estimate for blocks of size 2^( 8) =       0.000276674359
  error estimate for blocks of size 2^( 9) =       0.000277131160

      target function =                  N/A
              le_mean =     -22.824036417268
             les_mean =     521.435751286067
             stat err =       0.000276084805
             autocorr =       1.262920173305
              std dev =       0.694863578171
             le_variance =       0.482835392269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834803412
                                         uncertainty =       0.001178634474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482834803412
                                         uncertainty =       0.001178634474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000245671373
  error estimate for blocks of size 2^( 2) =       0.000254886219
  error estimate for blocks of size 2^( 3) =       0.000263193400
  error estimate for blocks of size 2^( 4) =       0.000269181505
  error estimate for blocks of size 2^( 5) =       0.000272746174
  error estimate for blocks of size 2^( 6) =       0.000274526161
  error estimate for blocks of size 2^( 7) =       0.000276007540
  error estimate for blocks of size 2^( 8) =       0.000276674357
  error estimate for blocks of size 2^( 9) =       0.000277131162

      target function =                  N/A
              le_mean =     -22.824036415068
             les_mean =     521.435753326094
             stat err =       0.000276084805
             autocorr =       1.262920177389
              std dev =       0.694863576574
             le_variance =       0.482835390050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824036414756        initial
     1.4901e+02     1.4901e+03             1.3487e-06       -22.824036419811  <--
     5.9605e+02     5.9605e+03             3.3765e-07       -22.824036417268
     2.3842e+03     2.3842e+04             8.4442e-08       -22.824036415068

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 1.7255e+02
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_01                 1.085366e-01 3 1  ON 0
ci_02                -2.196942e-02 3 1  ON 1
ci_03                -2.172817e-02 3 1  ON 2
ci_04                 2.182702e-02 3 1  ON 3
ci_05                -2.150653e-02 3 1  ON 4
ci_06                -2.163137e-02 3 1  ON 5
ci_07                 2.585953e-02 3 1  ON 6
ci_08                -3.499063e-03 3 1  ON 7
ci_09                -1.105985e-02 3 1  ON 8
ci_10                -1.058879e-02 3 1  ON 9
ci_11                 1.649044e-02 3 1  ON 10
ci_12                 1.060619e-02 3 1  ON 11
ci_13                 1.184129e-02 3 1  ON 12
ci_14                 1.792039e-02 3 1  ON 13
ci_15                 7.391088e-03 3 1  ON 14
ci_16                 7.715928e-03 3 1  ON 15
ci_17                -9.232229e-03 3 1  ON 16
ci_18                -9.375833e-03 3 1  ON 17
ci_19                 9.926572e-03 3 1  ON 18
ci_20                 1.081239e-02 3 1  ON 19
ci_21                 8.102319e-03 3 1  ON 20
ci_22                 8.630260e-03 3 1  ON 21
ci_23                 6.570082e-03 3 1  ON 22
ci_24                 7.495372e-03 3 1  ON 23
ci_25                 5.255529e-03 3 1  ON 24
ci_26                 3.069541e-03 3 1  ON 25
ci_27                 2.446237e-03 3 1  ON 26
ci_28                 2.887393e-03 3 1  ON 27
ci_29                 2.898357e-03 3 1  ON 28
ci_30                 8.195185e-04 3 1  ON 29
ci_31                 7.383000e-04 3 1  ON 30
ci_32                 3.184618e-04 3 1  ON 31
ci_33                 1.931368e-04 3 1  ON 32
ci_34                -4.046802e-04 3 1  ON 33
ci_35                 2.133497e-04 3 1  ON 34
ci_36                -3.205655e-04 3 1  ON 35
ci_37                -4.127388e-04 3 1  ON 36
ci_38                -1.374947e-04 3 1  ON 37
ci_39                -6.950297e-05 3 1  ON 38
ci_40                -1.202816e-03 3 1  ON 39
ci_41                -1.967917e-04 3 1  ON 40
ci_42                -2.436636e-04 3 1  ON 41
ci_43                -2.390046e-03 3 1  ON 42
ci_44                -2.310186e-03 3 1  ON 43
ci_45                -5.833263e-06 3 1  ON 44
ci_46                 6.785602e-05 3 1  ON 45
ci_47                -9.401941e-05 3 1  ON 46
ci_48                 2.416248e-04 3 1  ON 47
ci_49                -1.274635e-03 3 1  ON 48
ci_50                -5.639098e-04 3 1  ON 49
ci_51                 9.125953e-05 3 1  ON 50
ci_52                 8.309189e-05 3 1  ON 51
ci_53                -1.113046e-03 3 1  ON 52
ci_54                -8.063359e-04 3 1  ON 53
ci_55                -7.857307e-04 3 1  ON 54
ci_56                 1.602717e-03 3 1  ON 55
ci_57                 1.651702e-03 3 1  ON 56
ci_58                -1.096850e-03 3 1  ON 57
ci_59                -1.510558e-03 3 1  ON 58
ci_60                 1.575184e-03 3 1  ON 59
ci_61                 2.244651e-03 3 1  ON 60
ci_62                -3.435538e-04 3 1  ON 61
ci_63                -3.400025e-04 3 1  ON 62
ci_64                -3.951195e-04 3 1  ON 63
ci_65                -5.591927e-04 3 1  ON 64
ci_66                -6.007304e-04 3 1  ON 65
ci_67                -3.373410e-04 3 1  ON 66
ci_68                -1.408121e-03 3 1  ON 67
ci_69                -1.758691e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9508e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7764
    reference variance = 0.406745
====================================================
  Execution time = 1.0020e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1434e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0443e-01
  Total weights = 7.856273350e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8928e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486049807285
                                         uncertainty =       0.001436723058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486049807285
                                         uncertainty =       0.001436723058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246487738
  error estimate for blocks of size 2^( 2) =       0.000255574638
  error estimate for blocks of size 2^( 3) =       0.000263803850
  error estimate for blocks of size 2^( 4) =       0.000269727639
  error estimate for blocks of size 2^( 5) =       0.000273263169
  error estimate for blocks of size 2^( 6) =       0.000275482160
  error estimate for blocks of size 2^( 7) =       0.000276762389
  error estimate for blocks of size 2^( 8) =       0.000276706448
  error estimate for blocks of size 2^( 9) =       0.000276040727

      target function =                  N/A
              le_mean =     -22.824596927020
             les_mean =     521.466650146308
             stat err =       0.000276247931
             autocorr =       1.256051453004
              std dev =       0.697172603713
             le_variance =       0.486049639367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282459692702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824596927009       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596942499       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824596941624       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824596942071       residual = 7.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 5.139019e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824596927009       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596930897       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824596930679       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824596930793       residual = 8.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.291636e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824596927009       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824596927982       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824596927927       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824596927956       residual = 8.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.233422e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1914e+02
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.085357e-01 3 1  ON 0
ci_02                -2.196926e-02 3 1  ON 1
ci_03                -2.172807e-02 3 1  ON 2
ci_04                 2.182611e-02 3 1  ON 3
ci_05                -2.150595e-02 3 1  ON 4
ci_06                -2.163195e-02 3 1  ON 5
ci_07                 2.585873e-02 3 1  ON 6
ci_08                -3.499429e-03 3 1  ON 7
ci_09                -1.105937e-02 3 1  ON 8
ci_10                -1.058926e-02 3 1  ON 9
ci_11                 1.648955e-02 3 1  ON 10
ci_12                 1.060605e-02 3 1  ON 11
ci_13                 1.184210e-02 3 1  ON 12
ci_14                 1.792027e-02 3 1  ON 13
ci_15                 7.391808e-03 3 1  ON 14
ci_16                 7.715905e-03 3 1  ON 15
ci_17                -9.232118e-03 3 1  ON 16
ci_18                -9.375642e-03 3 1  ON 17
ci_19                 9.927077e-03 3 1  ON 18
ci_20                 1.081200e-02 3 1  ON 19
ci_21                 8.102486e-03 3 1  ON 20
ci_22                 8.629758e-03 3 1  ON 21
ci_23                 6.569356e-03 3 1  ON 22
ci_24                 7.495995e-03 3 1  ON 23
ci_25                 5.255498e-03 3 1  ON 24
ci_26                 3.068552e-03 3 1  ON 25
ci_27                 2.447254e-03 3 1  ON 26
ci_28                 2.887250e-03 3 1  ON 27
ci_29                 2.898725e-03 3 1  ON 28
ci_30                 8.195510e-04 3 1  ON 29
ci_31                 7.381270e-04 3 1  ON 30
ci_32                 3.184169e-04 3 1  ON 31
ci_33                 1.929748e-04 3 1  ON 32
ci_34                -4.050869e-04 3 1  ON 33
ci_35                 2.132297e-04 3 1  ON 34
ci_36                -3.215422e-04 3 1  ON 35
ci_37                -4.137973e-04 3 1  ON 36
ci_38                -1.377392e-04 3 1  ON 37
ci_39                -6.952347e-05 3 1  ON 38
ci_40                -1.202380e-03 3 1  ON 39
ci_41                -1.965423e-04 3 1  ON 40
ci_42                -2.423720e-04 3 1  ON 41
ci_43                -2.390649e-03 3 1  ON 42
ci_44                -2.309841e-03 3 1  ON 43
ci_45                -6.515600e-06 3 1  ON 44
ci_46                 6.766768e-05 3 1  ON 45
ci_47                -9.440418e-05 3 1  ON 46
ci_48                 2.414930e-04 3 1  ON 47
ci_49                -1.274218e-03 3 1  ON 48
ci_50                -5.638323e-04 3 1  ON 49
ci_51                 9.063315e-05 3 1  ON 50
ci_52                 8.326239e-05 3 1  ON 51
ci_53                -1.112361e-03 3 1  ON 52
ci_54                -8.069631e-04 3 1  ON 53
ci_55                -7.855819e-04 3 1  ON 54
ci_56                 1.601843e-03 3 1  ON 55
ci_57                 1.651245e-03 3 1  ON 56
ci_58                -1.096756e-03 3 1  ON 57
ci_59                -1.510357e-03 3 1  ON 58
ci_60                 1.574831e-03 3 1  ON 59
ci_61                 2.244719e-03 3 1  ON 60
ci_62                -3.441616e-04 3 1  ON 61
ci_63                -3.401084e-04 3 1  ON 62
ci_64                -3.952857e-04 3 1  ON 63
ci_65                -5.598863e-04 3 1  ON 64
ci_66                -6.005250e-04 3 1  ON 65
ci_67                -3.367273e-04 3 1  ON 66
ci_68                -1.408604e-03 3 1  ON 67
ci_69                -1.757589e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8671
    reference variance = 0.682638
====================================================
  Execution time = 1.0253e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0229e-01
  Total weights = 7.8575e+06
  Execution time = 1.4294e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023362857
                                         uncertainty =       0.001166101321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023362857
                                         uncertainty =       0.001166101321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246481643
  error estimate for blocks of size 2^( 2) =       0.000255675245
  error estimate for blocks of size 2^( 3) =       0.000263750295
  error estimate for blocks of size 2^( 4) =       0.000269559855
  error estimate for blocks of size 2^( 5) =       0.000273064332
  error estimate for blocks of size 2^( 6) =       0.000274476141
  error estimate for blocks of size 2^( 7) =       0.000275525910
  error estimate for blocks of size 2^( 8) =       0.000277301701
  error estimate for blocks of size 2^( 9) =       0.000277656374

      target function =                  N/A
              le_mean =     -22.824856160530
             les_mean =     521.476350139026
             stat err =       0.000276240032
             autocorr =       1.256041736392
              std dev =       0.697155364137
             le_variance =       0.486025601745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023534493
                                         uncertainty =       0.001166171359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023534493
                                         uncertainty =       0.001166171359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246481686
  error estimate for blocks of size 2^( 2) =       0.000255675338
  error estimate for blocks of size 2^( 3) =       0.000263750440
  error estimate for blocks of size 2^( 4) =       0.000269560024
  error estimate for blocks of size 2^( 5) =       0.000273064484
  error estimate for blocks of size 2^( 6) =       0.000274476301
  error estimate for blocks of size 2^( 7) =       0.000275526063
  error estimate for blocks of size 2^( 8) =       0.000277301852
  error estimate for blocks of size 2^( 9) =       0.000277656691

      target function =                  N/A
              le_mean =     -22.824856149663
             les_mean =     521.476373041338
             stat err =       0.000276240227
             autocorr =       1.256043065632
              std dev =       0.697155487490
             le_variance =       0.486025773737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023447639
                                         uncertainty =       0.001166136463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023447639
                                         uncertainty =       0.001166136463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246481664
  error estimate for blocks of size 2^( 2) =       0.000255675292
  error estimate for blocks of size 2^( 3) =       0.000263750367
  error estimate for blocks of size 2^( 4) =       0.000269559939
  error estimate for blocks of size 2^( 5) =       0.000273064408
  error estimate for blocks of size 2^( 6) =       0.000274476221
  error estimate for blocks of size 2^( 7) =       0.000275525986
  error estimate for blocks of size 2^( 8) =       0.000277301776
  error estimate for blocks of size 2^( 9) =       0.000277656532

      target function =                  N/A
              le_mean =     -22.824856154981
             les_mean =     521.476358992419
             stat err =       0.000276240129
             autocorr =       1.256042400889
              std dev =       0.697155425071
             le_variance =       0.486025686706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023373320
                                         uncertainty =       0.001166105717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486023373320
                                         uncertainty =       0.001166105717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246481645
  error estimate for blocks of size 2^( 2) =       0.000255675251
  error estimate for blocks of size 2^( 3) =       0.000263750304
  error estimate for blocks of size 2^( 4) =       0.000269559865
  error estimate for blocks of size 2^( 5) =       0.000273064341
  error estimate for blocks of size 2^( 6) =       0.000274476151
  error estimate for blocks of size 2^( 7) =       0.000275525920
  error estimate for blocks of size 2^( 8) =       0.000277301711
  error estimate for blocks of size 2^( 9) =       0.000277656393

      target function =                  N/A
              le_mean =     -22.824856159810
             les_mean =     521.476350781556
             stat err =       0.000276240044
             autocorr =       1.256041819589
              std dev =       0.697155371657
             le_variance =       0.486025612231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824856160530        initial  <--
     3.7253e+01     3.7253e+02             5.1390e-06       -22.824856149663
     1.4901e+02     1.4901e+03             1.2916e-06       -22.824856154981
     5.9605e+02     5.9605e+03             3.2334e-07       -22.824856159810

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.1909
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_01                 1.085366e-01 3 1  ON 0
ci_02                -2.196942e-02 3 1  ON 1
ci_03                -2.172817e-02 3 1  ON 2
ci_04                 2.182702e-02 3 1  ON 3
ci_05                -2.150653e-02 3 1  ON 4
ci_06                -2.163137e-02 3 1  ON 5
ci_07                 2.585953e-02 3 1  ON 6
ci_08                -3.499063e-03 3 1  ON 7
ci_09                -1.105985e-02 3 1  ON 8
ci_10                -1.058879e-02 3 1  ON 9
ci_11                 1.649044e-02 3 1  ON 10
ci_12                 1.060619e-02 3 1  ON 11
ci_13                 1.184129e-02 3 1  ON 12
ci_14                 1.792039e-02 3 1  ON 13
ci_15                 7.391088e-03 3 1  ON 14
ci_16                 7.715928e-03 3 1  ON 15
ci_17                -9.232229e-03 3 1  ON 16
ci_18                -9.375833e-03 3 1  ON 17
ci_19                 9.926572e-03 3 1  ON 18
ci_20                 1.081239e-02 3 1  ON 19
ci_21                 8.102319e-03 3 1  ON 20
ci_22                 8.630260e-03 3 1  ON 21
ci_23                 6.570082e-03 3 1  ON 22
ci_24                 7.495372e-03 3 1  ON 23
ci_25                 5.255529e-03 3 1  ON 24
ci_26                 3.069541e-03 3 1  ON 25
ci_27                 2.446237e-03 3 1  ON 26
ci_28                 2.887393e-03 3 1  ON 27
ci_29                 2.898357e-03 3 1  ON 28
ci_30                 8.195185e-04 3 1  ON 29
ci_31                 7.383000e-04 3 1  ON 30
ci_32                 3.184618e-04 3 1  ON 31
ci_33                 1.931368e-04 3 1  ON 32
ci_34                -4.046802e-04 3 1  ON 33
ci_35                 2.133497e-04 3 1  ON 34
ci_36                -3.205655e-04 3 1  ON 35
ci_37                -4.127388e-04 3 1  ON 36
ci_38                -1.374947e-04 3 1  ON 37
ci_39                -6.950297e-05 3 1  ON 38
ci_40                -1.202816e-03 3 1  ON 39
ci_41                -1.967917e-04 3 1  ON 40
ci_42                -2.436636e-04 3 1  ON 41
ci_43                -2.390046e-03 3 1  ON 42
ci_44                -2.310186e-03 3 1  ON 43
ci_45                -5.833263e-06 3 1  ON 44
ci_46                 6.785602e-05 3 1  ON 45
ci_47                -9.401941e-05 3 1  ON 46
ci_48                 2.416248e-04 3 1  ON 47
ci_49                -1.274635e-03 3 1  ON 48
ci_50                -5.639098e-04 3 1  ON 49
ci_51                 9.125953e-05 3 1  ON 50
ci_52                 8.309189e-05 3 1  ON 51
ci_53                -1.113046e-03 3 1  ON 52
ci_54                -8.063359e-04 3 1  ON 53
ci_55                -7.857307e-04 3 1  ON 54
ci_56                 1.602717e-03 3 1  ON 55
ci_57                 1.651702e-03 3 1  ON 56
ci_58                -1.096850e-03 3 1  ON 57
ci_59                -1.510558e-03 3 1  ON 58
ci_60                 1.575184e-03 3 1  ON 59
ci_61                 2.244651e-03 3 1  ON 60
ci_62                -3.435538e-04 3 1  ON 61
ci_63                -3.400025e-04 3 1  ON 62
ci_64                -3.951195e-04 3 1  ON 63
ci_65                -5.591927e-04 3 1  ON 64
ci_66                -6.007304e-04 3 1  ON 65
ci_67                -3.373410e-04 3 1  ON 66
ci_68                -1.408121e-03 3 1  ON 67
ci_69                -1.758691e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9334e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7541
    reference variance = 0.401216
====================================================
  Execution time = 1.0008e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1357e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0475e-01
  Total weights = 7.857508702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8458e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486884866320
                                         uncertainty =       0.002196277080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486884866320
                                         uncertainty =       0.002196277080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246699846
  error estimate for blocks of size 2^( 2) =       0.000255927182
  error estimate for blocks of size 2^( 3) =       0.000264191972
  error estimate for blocks of size 2^( 4) =       0.000270054996
  error estimate for blocks of size 2^( 5) =       0.000273392507
  error estimate for blocks of size 2^( 6) =       0.000275358481
  error estimate for blocks of size 2^( 7) =       0.000276735605
  error estimate for blocks of size 2^( 8) =       0.000277165916
  error estimate for blocks of size 2^( 9) =       0.000278034885

      target function =                  N/A
              le_mean =     -22.824469988278
             les_mean =     521.461180240869
             stat err =       0.000276823722
             autocorr =       1.259125011427
              std dev =       0.697772534685
             le_variance =       0.486886510161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282446998828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824469988271       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824469991067       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824469992462       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824469992433       residual = 9.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 1.612076e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824469988271       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824469988970       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824469989319       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824469989312       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 4.032667e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824469988271       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824469988446       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824469988533       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824469988531       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 1.008322e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091909 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1855e+02
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.085367e-01 3 1  ON 0
ci_02                -2.196953e-02 3 1  ON 1
ci_03                -2.172820e-02 3 1  ON 2
ci_04                 2.182705e-02 3 1  ON 3
ci_05                -2.150649e-02 3 1  ON 4
ci_06                -2.163140e-02 3 1  ON 5
ci_07                 2.585932e-02 3 1  ON 6
ci_08                -3.498996e-03 3 1  ON 7
ci_09                -1.105976e-02 3 1  ON 8
ci_10                -1.058880e-02 3 1  ON 9
ci_11                 1.649039e-02 3 1  ON 10
ci_12                 1.060600e-02 3 1  ON 11
ci_13                 1.184127e-02 3 1  ON 12
ci_14                 1.792050e-02 3 1  ON 13
ci_15                 7.391182e-03 3 1  ON 14
ci_16                 7.716058e-03 3 1  ON 15
ci_17                -9.232154e-03 3 1  ON 16
ci_18                -9.375852e-03 3 1  ON 17
ci_19                 9.926706e-03 3 1  ON 18
ci_20                 1.081232e-02 3 1  ON 19
ci_21                 8.102274e-03 3 1  ON 20
ci_22                 8.630123e-03 3 1  ON 21
ci_23                 6.569992e-03 3 1  ON 22
ci_24                 7.495357e-03 3 1  ON 23
ci_25                 5.255463e-03 3 1  ON 24
ci_26                 3.069758e-03 3 1  ON 25
ci_27                 2.446358e-03 3 1  ON 26
ci_28                 2.887541e-03 3 1  ON 27
ci_29                 2.898406e-03 3 1  ON 28
ci_30                 8.194343e-04 3 1  ON 29
ci_31                 7.383388e-04 3 1  ON 30
ci_32                 3.185394e-04 3 1  ON 31
ci_33                 1.931809e-04 3 1  ON 32
ci_34                -4.048191e-04 3 1  ON 33
ci_35                 2.131094e-04 3 1  ON 34
ci_36                -3.206331e-04 3 1  ON 35
ci_37                -4.124936e-04 3 1  ON 36
ci_38                -1.374512e-04 3 1  ON 37
ci_39                -6.951956e-05 3 1  ON 38
ci_40                -1.202745e-03 3 1  ON 39
ci_41                -1.967730e-04 3 1  ON 40
ci_42                -2.435851e-04 3 1  ON 41
ci_43                -2.390047e-03 3 1  ON 42
ci_44                -2.310323e-03 3 1  ON 43
ci_45                -5.731399e-06 3 1  ON 44
ci_46                 6.788283e-05 3 1  ON 45
ci_47                -9.408169e-05 3 1  ON 46
ci_48                 2.415216e-04 3 1  ON 47
ci_49                -1.274726e-03 3 1  ON 48
ci_50                -5.639640e-04 3 1  ON 49
ci_51                 9.122071e-05 3 1  ON 50
ci_52                 8.310726e-05 3 1  ON 51
ci_53                -1.113072e-03 3 1  ON 52
ci_54                -8.063397e-04 3 1  ON 53
ci_55                -7.858067e-04 3 1  ON 54
ci_56                 1.602809e-03 3 1  ON 55
ci_57                 1.651731e-03 3 1  ON 56
ci_58                -1.096769e-03 3 1  ON 57
ci_59                -1.510396e-03 3 1  ON 58
ci_60                 1.575188e-03 3 1  ON 59
ci_61                 2.244535e-03 3 1  ON 60
ci_62                -3.439570e-04 3 1  ON 61
ci_63                -3.399258e-04 3 1  ON 62
ci_64                -3.950479e-04 3 1  ON 63
ci_65                -5.590220e-04 3 1  ON 64
ci_66                -6.006081e-04 3 1  ON 65
ci_67                -3.373523e-04 3 1  ON 66
ci_68                -1.408041e-03 3 1  ON 67
ci_69                -1.758535e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.89
    reference variance = 0.46464
====================================================
  Execution time = 1.0249e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0009e-01
  Total weights = 7.8570e+06
  Execution time = 1.4328e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594123811
                                         uncertainty =       0.001145898958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594123811
                                         uncertainty =       0.001145898958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246372286
  error estimate for blocks of size 2^( 2) =       0.000255518202
  error estimate for blocks of size 2^( 3) =       0.000263604419
  error estimate for blocks of size 2^( 4) =       0.000269598547
  error estimate for blocks of size 2^( 5) =       0.000273004549
  error estimate for blocks of size 2^( 6) =       0.000274983802
  error estimate for blocks of size 2^( 7) =       0.000276326479
  error estimate for blocks of size 2^( 8) =       0.000276845707
  error estimate for blocks of size 2^( 9) =       0.000277777329

      target function =                  N/A
              le_mean =     -22.824662069945
             les_mean =     521.465292374220
             stat err =       0.000276483329
             autocorr =       1.259372462695
              std dev =       0.696846057364
             le_variance =       0.485594427664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594067890
                                         uncertainty =       0.001145876111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594067890
                                         uncertainty =       0.001145876111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246372272
  error estimate for blocks of size 2^( 2) =       0.000255518193
  error estimate for blocks of size 2^( 3) =       0.000263604416
  error estimate for blocks of size 2^( 4) =       0.000269598543
  error estimate for blocks of size 2^( 5) =       0.000273004549
  error estimate for blocks of size 2^( 6) =       0.000274983803
  error estimate for blocks of size 2^( 7) =       0.000276326458
  error estimate for blocks of size 2^( 8) =       0.000276845675
  error estimate for blocks of size 2^( 9) =       0.000277777302

      target function =                  N/A
              le_mean =     -22.824662073024
             les_mean =     521.465292384983
             stat err =       0.000276483310
             autocorr =       1.259372431132
              std dev =       0.696846017226
             le_variance =       0.485594371724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594095757
                                         uncertainty =       0.001145887527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594095757
                                         uncertainty =       0.001145887527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246372279
  error estimate for blocks of size 2^( 2) =       0.000255518198
  error estimate for blocks of size 2^( 3) =       0.000263604417
  error estimate for blocks of size 2^( 4) =       0.000269598545
  error estimate for blocks of size 2^( 5) =       0.000273004549
  error estimate for blocks of size 2^( 6) =       0.000274983803
  error estimate for blocks of size 2^( 7) =       0.000276326468
  error estimate for blocks of size 2^( 8) =       0.000276845691
  error estimate for blocks of size 2^( 9) =       0.000277777316

      target function =                  N/A
              le_mean =     -22.824662071474
             les_mean =     521.465291735487
             stat err =       0.000276483319
             autocorr =       1.259372446974
              std dev =       0.696846037228
             le_variance =       0.485594399601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594120295
                                         uncertainty =       0.001145897528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485594120295
                                         uncertainty =       0.001145897528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246372285
  error estimate for blocks of size 2^( 2) =       0.000255518201
  error estimate for blocks of size 2^( 3) =       0.000263604419
  error estimate for blocks of size 2^( 4) =       0.000269598546
  error estimate for blocks of size 2^( 5) =       0.000273004549
  error estimate for blocks of size 2^( 6) =       0.000274983802
  error estimate for blocks of size 2^( 7) =       0.000276326477
  error estimate for blocks of size 2^( 8) =       0.000276845705
  error estimate for blocks of size 2^( 9) =       0.000277777327

      target function =                  N/A
              le_mean =     -22.824662070134
             les_mean =     521.465292097306
             stat err =       0.000276483328
             autocorr =       1.259372460741
              std dev =       0.696846054841
             le_variance =       0.485594424147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824662069945        initial
     3.7253e+02     3.7253e+03             1.6121e-06       -22.824662073024  <--
     1.4901e+03     1.4901e+04             4.0327e-07       -22.824662071474
     5.9605e+03     5.9605e+04             1.0083e-07       -22.824662070134

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 1.7417e+02
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_01                 1.085370e-01 3 1  ON 0
ci_02                -2.196986e-02 3 1  ON 1
ci_03                -2.172830e-02 3 1  ON 2
ci_04                 2.182714e-02 3 1  ON 3
ci_05                -2.150637e-02 3 1  ON 4
ci_06                -2.163151e-02 3 1  ON 5
ci_07                 2.585867e-02 3 1  ON 6
ci_08                -3.498795e-03 3 1  ON 7
ci_09                -1.105947e-02 3 1  ON 8
ci_10                -1.058881e-02 3 1  ON 9
ci_11                 1.649025e-02 3 1  ON 10
ci_12                 1.060543e-02 3 1  ON 11
ci_13                 1.184122e-02 3 1  ON 12
ci_14                 1.792083e-02 3 1  ON 13
ci_15                 7.391464e-03 3 1  ON 14
ci_16                 7.716447e-03 3 1  ON 15
ci_17                -9.231930e-03 3 1  ON 16
ci_18                -9.375907e-03 3 1  ON 17
ci_19                 9.927107e-03 3 1  ON 18
ci_20                 1.081210e-02 3 1  ON 19
ci_21                 8.102140e-03 3 1  ON 20
ci_22                 8.629715e-03 3 1  ON 21
ci_23                 6.569724e-03 3 1  ON 22
ci_24                 7.495313e-03 3 1  ON 23
ci_25                 5.255266e-03 3 1  ON 24
ci_26                 3.070410e-03 3 1  ON 25
ci_27                 2.446721e-03 3 1  ON 26
ci_28                 2.887983e-03 3 1  ON 27
ci_29                 2.898551e-03 3 1  ON 28
ci_30                 8.191817e-04 3 1  ON 29
ci_31                 7.384553e-04 3 1  ON 30
ci_32                 3.187724e-04 3 1  ON 31
ci_33                 1.933133e-04 3 1  ON 32
ci_34                -4.052355e-04 3 1  ON 33
ci_35                 2.123888e-04 3 1  ON 34
ci_36                -3.208356e-04 3 1  ON 35
ci_37                -4.117585e-04 3 1  ON 36
ci_38                -1.373206e-04 3 1  ON 37
ci_39                -6.956933e-05 3 1  ON 38
ci_40                -1.202533e-03 3 1  ON 39
ci_41                -1.967170e-04 3 1  ON 40
ci_42                -2.433497e-04 3 1  ON 41
ci_43                -2.390050e-03 3 1  ON 42
ci_44                -2.310736e-03 3 1  ON 43
ci_45                -5.426051e-06 3 1  ON 44
ci_46                 6.796320e-05 3 1  ON 45
ci_47                -9.426843e-05 3 1  ON 46
ci_48                 2.412119e-04 3 1  ON 47
ci_49                -1.275001e-03 3 1  ON 48
ci_50                -5.641264e-04 3 1  ON 49
ci_51                 9.110434e-05 3 1  ON 50
ci_52                 8.315331e-05 3 1  ON 51
ci_53                -1.113151e-03 3 1  ON 52
ci_54                -8.063511e-04 3 1  ON 53
ci_55                -7.860347e-04 3 1  ON 54
ci_56                 1.603086e-03 3 1  ON 55
ci_57                 1.651820e-03 3 1  ON 56
ci_58                -1.096528e-03 3 1  ON 57
ci_59                -1.509912e-03 3 1  ON 58
ci_60                 1.575198e-03 3 1  ON 59
ci_61                 2.244187e-03 3 1  ON 60
ci_62                -3.451658e-04 3 1  ON 61
ci_63                -3.396960e-04 3 1  ON 62
ci_64                -3.948329e-04 3 1  ON 63
ci_65                -5.585103e-04 3 1  ON 64
ci_66                -6.002417e-04 3 1  ON 65
ci_67                -3.373862e-04 3 1  ON 66
ci_68                -1.407802e-03 3 1  ON 67
ci_69                -1.758067e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9273e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7055
    reference variance = 0.390339
====================================================
  Execution time = 1.0009e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1399e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0393e-01
  Total weights = 7.856965750e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8699e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487008518431
                                         uncertainty =       0.001234932734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487008518431
                                         uncertainty =       0.001234932734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246731141
  error estimate for blocks of size 2^( 2) =       0.000255929465
  error estimate for blocks of size 2^( 3) =       0.000264184116
  error estimate for blocks of size 2^( 4) =       0.000269917712
  error estimate for blocks of size 2^( 5) =       0.000273080740
  error estimate for blocks of size 2^( 6) =       0.000275156798
  error estimate for blocks of size 2^( 7) =       0.000276124693
  error estimate for blocks of size 2^( 8) =       0.000276555403
  error estimate for blocks of size 2^( 9) =       0.000277392064

      target function =                  N/A
              le_mean =     -22.824394023408
             les_mean =     521.456890155452
             stat err =       0.000276307240
             autocorr =       1.254112785480
              std dev =       0.697861050750
             le_variance =       0.487010046154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282439402341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824394023401       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824394040471       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824394042546       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824394042706       residual = 7.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 3.354304e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824394023401       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824394027675       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824394028196       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824394028236       residual = 7.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 8.397344e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824394023401       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824394024470       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824394024600       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824394024610       residual = 7.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 2.100061e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1880e+02
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.085369e-01 3 1  ON 0
ci_02                -2.196978e-02 3 1  ON 1
ci_03                -2.172859e-02 3 1  ON 2
ci_04                 2.182711e-02 3 1  ON 3
ci_05                -2.150662e-02 3 1  ON 4
ci_06                -2.163169e-02 3 1  ON 5
ci_07                 2.585783e-02 3 1  ON 6
ci_08                -3.498925e-03 3 1  ON 7
ci_09                -1.105947e-02 3 1  ON 8
ci_10                -1.058893e-02 3 1  ON 9
ci_11                 1.649007e-02 3 1  ON 10
ci_12                 1.060515e-02 3 1  ON 11
ci_13                 1.184144e-02 3 1  ON 12
ci_14                 1.792043e-02 3 1  ON 13
ci_15                 7.391532e-03 3 1  ON 14
ci_16                 7.716806e-03 3 1  ON 15
ci_17                -9.231887e-03 3 1  ON 16
ci_18                -9.375551e-03 3 1  ON 17
ci_19                 9.926715e-03 3 1  ON 18
ci_20                 1.081189e-02 3 1  ON 19
ci_21                 8.101782e-03 3 1  ON 20
ci_22                 8.629654e-03 3 1  ON 21
ci_23                 6.569523e-03 3 1  ON 22
ci_24                 7.495454e-03 3 1  ON 23
ci_25                 5.255361e-03 3 1  ON 24
ci_26                 3.070381e-03 3 1  ON 25
ci_27                 2.446769e-03 3 1  ON 26
ci_28                 2.888038e-03 3 1  ON 27
ci_29                 2.898714e-03 3 1  ON 28
ci_30                 8.190162e-04 3 1  ON 29
ci_31                 7.389165e-04 3 1  ON 30
ci_32                 3.185166e-04 3 1  ON 31
ci_33                 1.932606e-04 3 1  ON 32
ci_34                -4.051445e-04 3 1  ON 33
ci_35                 2.125707e-04 3 1  ON 34
ci_36                -3.209518e-04 3 1  ON 35
ci_37                -4.117471e-04 3 1  ON 36
ci_38                -1.370082e-04 3 1  ON 37
ci_39                -6.960674e-05 3 1  ON 38
ci_40                -1.202797e-03 3 1  ON 39
ci_41                -1.968676e-04 3 1  ON 40
ci_42                -2.432807e-04 3 1  ON 41
ci_43                -2.390220e-03 3 1  ON 42
ci_44                -2.310469e-03 3 1  ON 43
ci_45                -5.311459e-06 3 1  ON 44
ci_46                 6.778654e-05 3 1  ON 45
ci_47                -9.415923e-05 3 1  ON 46
ci_48                 2.408361e-04 3 1  ON 47
ci_49                -1.274745e-03 3 1  ON 48
ci_50                -5.643216e-04 3 1  ON 49
ci_51                 9.089835e-05 3 1  ON 50
ci_52                 8.317650e-05 3 1  ON 51
ci_53                -1.113278e-03 3 1  ON 52
ci_54                -8.062304e-04 3 1  ON 53
ci_55                -7.861248e-04 3 1  ON 54
ci_56                 1.603115e-03 3 1  ON 55
ci_57                 1.651778e-03 3 1  ON 56
ci_58                -1.096650e-03 3 1  ON 57
ci_59                -1.509908e-03 3 1  ON 58
ci_60                 1.575103e-03 3 1  ON 59
ci_61                 2.244271e-03 3 1  ON 60
ci_62                -3.451003e-04 3 1  ON 61
ci_63                -3.392660e-04 3 1  ON 62
ci_64                -3.949198e-04 3 1  ON 63
ci_65                -5.580831e-04 3 1  ON 64
ci_66                -6.002198e-04 3 1  ON 65
ci_67                -3.374395e-04 3 1  ON 66
ci_68                -1.408105e-03 3 1  ON 67
ci_69                -1.757889e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7777
    reference variance = 0.362047
====================================================
  Execution time = 1.0257e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0227e-01
  Total weights = 7.8567e+06
  Execution time = 1.4372e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145582321
                                         uncertainty =       0.001278637808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145582321
                                         uncertainty =       0.001278637808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246511994
  error estimate for blocks of size 2^( 2) =       0.000255724245
  error estimate for blocks of size 2^( 3) =       0.000263981060
  error estimate for blocks of size 2^( 4) =       0.000269914060
  error estimate for blocks of size 2^( 5) =       0.000273496378
  error estimate for blocks of size 2^( 6) =       0.000275316730
  error estimate for blocks of size 2^( 7) =       0.000276053268
  error estimate for blocks of size 2^( 8) =       0.000276780624
  error estimate for blocks of size 2^( 9) =       0.000277504119

      target function =                  N/A
              le_mean =     -22.824837715966
             les_mean =     521.475493262724
             stat err =       0.000276413685
             autocorr =       1.257311751410
              std dev =       0.697241209387
             le_variance =       0.486145304067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145943406
                                         uncertainty =       0.001278619868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145943406
                                         uncertainty =       0.001278619868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246512085
  error estimate for blocks of size 2^( 2) =       0.000255724326
  error estimate for blocks of size 2^( 3) =       0.000263981128
  error estimate for blocks of size 2^( 4) =       0.000269914104
  error estimate for blocks of size 2^( 5) =       0.000273496415
  error estimate for blocks of size 2^( 6) =       0.000275316768
  error estimate for blocks of size 2^( 7) =       0.000276053306
  error estimate for blocks of size 2^( 8) =       0.000276780644
  error estimate for blocks of size 2^( 9) =       0.000277504136

      target function =                  N/A
              le_mean =     -22.824837714061
             les_mean =     521.475488339898
             stat err =       0.000276413713
             autocorr =       1.257311072279
              std dev =       0.697241468336
             le_variance =       0.486145665167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145762871
                                         uncertainty =       0.001278628833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145762871
                                         uncertainty =       0.001278628833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246512039
  error estimate for blocks of size 2^( 2) =       0.000255724286
  error estimate for blocks of size 2^( 3) =       0.000263981094
  error estimate for blocks of size 2^( 4) =       0.000269914082
  error estimate for blocks of size 2^( 5) =       0.000273496396
  error estimate for blocks of size 2^( 6) =       0.000275316749
  error estimate for blocks of size 2^( 7) =       0.000276053287
  error estimate for blocks of size 2^( 8) =       0.000276780634
  error estimate for blocks of size 2^( 9) =       0.000277504128

      target function =                  N/A
              le_mean =     -22.824837715040
             les_mean =     521.475507842063
             stat err =       0.000276413700
             autocorr =       1.257311413145
              std dev =       0.697241338867
             le_variance =       0.486145484625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145604871
                                         uncertainty =       0.001278636686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486145604871
                                         uncertainty =       0.001278636686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246511999
  error estimate for blocks of size 2^( 2) =       0.000255724250
  error estimate for blocks of size 2^( 3) =       0.000263981064
  error estimate for blocks of size 2^( 4) =       0.000269914063
  error estimate for blocks of size 2^( 5) =       0.000273496380
  error estimate for blocks of size 2^( 6) =       0.000275316732
  error estimate for blocks of size 2^( 7) =       0.000276053271
  error estimate for blocks of size 2^( 8) =       0.000276780625
  error estimate for blocks of size 2^( 9) =       0.000277504120

      target function =                  N/A
              le_mean =     -22.824837715843
             les_mean =     521.475492787454
             stat err =       0.000276413687
             autocorr =       1.257311708969
              std dev =       0.697241225559
             le_variance =       0.486145326619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824837715966        initial  <--
     9.3132e+01     9.3132e+02             3.3543e-06       -22.824837714061
     3.7253e+02     3.7253e+03             8.3973e-07       -22.824837715040
     1.4901e+03     1.4901e+04             2.1001e-07       -22.824837715843

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.7164
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_01                 1.085370e-01 3 1  ON 0
ci_02                -2.196986e-02 3 1  ON 1
ci_03                -2.172830e-02 3 1  ON 2
ci_04                 2.182714e-02 3 1  ON 3
ci_05                -2.150637e-02 3 1  ON 4
ci_06                -2.163151e-02 3 1  ON 5
ci_07                 2.585867e-02 3 1  ON 6
ci_08                -3.498795e-03 3 1  ON 7
ci_09                -1.105947e-02 3 1  ON 8
ci_10                -1.058881e-02 3 1  ON 9
ci_11                 1.649025e-02 3 1  ON 10
ci_12                 1.060543e-02 3 1  ON 11
ci_13                 1.184122e-02 3 1  ON 12
ci_14                 1.792083e-02 3 1  ON 13
ci_15                 7.391464e-03 3 1  ON 14
ci_16                 7.716447e-03 3 1  ON 15
ci_17                -9.231930e-03 3 1  ON 16
ci_18                -9.375907e-03 3 1  ON 17
ci_19                 9.927107e-03 3 1  ON 18
ci_20                 1.081210e-02 3 1  ON 19
ci_21                 8.102140e-03 3 1  ON 20
ci_22                 8.629715e-03 3 1  ON 21
ci_23                 6.569724e-03 3 1  ON 22
ci_24                 7.495313e-03 3 1  ON 23
ci_25                 5.255266e-03 3 1  ON 24
ci_26                 3.070410e-03 3 1  ON 25
ci_27                 2.446721e-03 3 1  ON 26
ci_28                 2.887983e-03 3 1  ON 27
ci_29                 2.898551e-03 3 1  ON 28
ci_30                 8.191817e-04 3 1  ON 29
ci_31                 7.384553e-04 3 1  ON 30
ci_32                 3.187724e-04 3 1  ON 31
ci_33                 1.933133e-04 3 1  ON 32
ci_34                -4.052355e-04 3 1  ON 33
ci_35                 2.123888e-04 3 1  ON 34
ci_36                -3.208356e-04 3 1  ON 35
ci_37                -4.117585e-04 3 1  ON 36
ci_38                -1.373206e-04 3 1  ON 37
ci_39                -6.956933e-05 3 1  ON 38
ci_40                -1.202533e-03 3 1  ON 39
ci_41                -1.967170e-04 3 1  ON 40
ci_42                -2.433497e-04 3 1  ON 41
ci_43                -2.390050e-03 3 1  ON 42
ci_44                -2.310736e-03 3 1  ON 43
ci_45                -5.426051e-06 3 1  ON 44
ci_46                 6.796320e-05 3 1  ON 45
ci_47                -9.426843e-05 3 1  ON 46
ci_48                 2.412119e-04 3 1  ON 47
ci_49                -1.275001e-03 3 1  ON 48
ci_50                -5.641264e-04 3 1  ON 49
ci_51                 9.110434e-05 3 1  ON 50
ci_52                 8.315331e-05 3 1  ON 51
ci_53                -1.113151e-03 3 1  ON 52
ci_54                -8.063511e-04 3 1  ON 53
ci_55                -7.860347e-04 3 1  ON 54
ci_56                 1.603086e-03 3 1  ON 55
ci_57                 1.651820e-03 3 1  ON 56
ci_58                -1.096528e-03 3 1  ON 57
ci_59                -1.509912e-03 3 1  ON 58
ci_60                 1.575198e-03 3 1  ON 59
ci_61                 2.244187e-03 3 1  ON 60
ci_62                -3.451658e-04 3 1  ON 61
ci_63                -3.396960e-04 3 1  ON 62
ci_64                -3.948329e-04 3 1  ON 63
ci_65                -5.585103e-04 3 1  ON 64
ci_66                -6.002417e-04 3 1  ON 65
ci_67                -3.373862e-04 3 1  ON 66
ci_68                -1.407802e-03 3 1  ON 67
ci_69                -1.758067e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9352e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8291
    reference variance = 1.04146
====================================================
  Execution time = 1.0018e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1351e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0509e-01
  Total weights = 7.856594961e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8587e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487402375567
                                         uncertainty =       0.001343002653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487402375567
                                         uncertainty =       0.001343002653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246831446
  error estimate for blocks of size 2^( 2) =       0.000256029641
  error estimate for blocks of size 2^( 3) =       0.000264355843
  error estimate for blocks of size 2^( 4) =       0.000270092384
  error estimate for blocks of size 2^( 5) =       0.000273715536
  error estimate for blocks of size 2^( 6) =       0.000275619829
  error estimate for blocks of size 2^( 7) =       0.000276616964
  error estimate for blocks of size 2^( 8) =       0.000276453996
  error estimate for blocks of size 2^( 9) =       0.000276472438

      target function =                  N/A
              le_mean =     -22.824755097743
             les_mean =     521.474534327389
             stat err =       0.000276290807
             autocorr =       1.252944676351
              std dev =       0.698144756623
             le_variance =       0.487406101200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282475509774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824755097742       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824755099756       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824755100397       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824755100357       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 2.632789e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824755097742       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824755098245       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824755098406       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824755098396       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 6.583529e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824755097742       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824755097868       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824755097908       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824755097905       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 1.645979e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1878e+02
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.085370e-01 3 1  ON 0
ci_02                -2.196989e-02 3 1  ON 1
ci_03                -2.172832e-02 3 1  ON 2
ci_04                 2.182714e-02 3 1  ON 3
ci_05                -2.150636e-02 3 1  ON 4
ci_06                -2.163153e-02 3 1  ON 5
ci_07                 2.585866e-02 3 1  ON 6
ci_08                -3.498786e-03 3 1  ON 7
ci_09                -1.105948e-02 3 1  ON 8
ci_10                -1.058884e-02 3 1  ON 9
ci_11                 1.649023e-02 3 1  ON 10
ci_12                 1.060544e-02 3 1  ON 11
ci_13                 1.184122e-02 3 1  ON 12
ci_14                 1.792081e-02 3 1  ON 13
ci_15                 7.391450e-03 3 1  ON 14
ci_16                 7.716457e-03 3 1  ON 15
ci_17                -9.231885e-03 3 1  ON 16
ci_18                -9.375875e-03 3 1  ON 17
ci_19                 9.927173e-03 3 1  ON 18
ci_20                 1.081207e-02 3 1  ON 19
ci_21                 8.102162e-03 3 1  ON 20
ci_22                 8.629678e-03 3 1  ON 21
ci_23                 6.569714e-03 3 1  ON 22
ci_24                 7.495319e-03 3 1  ON 23
ci_25                 5.255286e-03 3 1  ON 24
ci_26                 3.070384e-03 3 1  ON 25
ci_27                 2.446735e-03 3 1  ON 26
ci_28                 2.887978e-03 3 1  ON 27
ci_29                 2.898528e-03 3 1  ON 28
ci_30                 8.191896e-04 3 1  ON 29
ci_31                 7.384491e-04 3 1  ON 30
ci_32                 3.187630e-04 3 1  ON 31
ci_33                 1.932923e-04 3 1  ON 32
ci_34                -4.052339e-04 3 1  ON 33
ci_35                 2.123618e-04 3 1  ON 34
ci_36                -3.208879e-04 3 1  ON 35
ci_37                -4.117986e-04 3 1  ON 36
ci_38                -1.373368e-04 3 1  ON 37
ci_39                -6.954730e-05 3 1  ON 38
ci_40                -1.202586e-03 3 1  ON 39
ci_41                -1.967279e-04 3 1  ON 40
ci_42                -2.433196e-04 3 1  ON 41
ci_43                -2.390076e-03 3 1  ON 42
ci_44                -2.310759e-03 3 1  ON 43
ci_45                -5.466185e-06 3 1  ON 44
ci_46                 6.795445e-05 3 1  ON 45
ci_47                -9.426783e-05 3 1  ON 46
ci_48                 2.411745e-04 3 1  ON 47
ci_49                -1.275037e-03 3 1  ON 48
ci_50                -5.641542e-04 3 1  ON 49
ci_51                 9.107573e-05 3 1  ON 50
ci_52                 8.312806e-05 3 1  ON 51
ci_53                -1.113097e-03 3 1  ON 52
ci_54                -8.063563e-04 3 1  ON 53
ci_55                -7.860298e-04 3 1  ON 54
ci_56                 1.603077e-03 3 1  ON 55
ci_57                 1.651873e-03 3 1  ON 56
ci_58                -1.096572e-03 3 1  ON 57
ci_59                -1.509928e-03 3 1  ON 58
ci_60                 1.575207e-03 3 1  ON 59
ci_61                 2.244210e-03 3 1  ON 60
ci_62                -3.451312e-04 3 1  ON 61
ci_63                -3.397006e-04 3 1  ON 62
ci_64                -3.947893e-04 3 1  ON 63
ci_65                -5.585179e-04 3 1  ON 64
ci_66                -6.002481e-04 3 1  ON 65
ci_67                -3.373592e-04 3 1  ON 66
ci_68                -1.407801e-03 3 1  ON 67
ci_69                -1.758031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7318
    reference variance = 0.823681
====================================================
  Execution time = 1.0226e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0446e-01
  Total weights = 7.8557e+06
  Execution time = 1.4425e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310366875
                                         uncertainty =       0.001342055714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310366875
                                         uncertainty =       0.001342055714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247060951
  error estimate for blocks of size 2^( 2) =       0.000256188794
  error estimate for blocks of size 2^( 3) =       0.000264367776
  error estimate for blocks of size 2^( 4) =       0.000270186952
  error estimate for blocks of size 2^( 5) =       0.000273740413
  error estimate for blocks of size 2^( 6) =       0.000275832849
  error estimate for blocks of size 2^( 7) =       0.000277238946
  error estimate for blocks of size 2^( 8) =       0.000278887340
  error estimate for blocks of size 2^( 9) =       0.000280287114

      target function =                  N/A
              le_mean =     -22.825052988137
             les_mean =     521.487508529856
             stat err =       0.000278061562
             autocorr =       1.266699795256
              std dev =       0.698793894538
             le_variance =       0.488312907044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310398891
                                         uncertainty =       0.001342057065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310398891
                                         uncertainty =       0.001342057065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247060959
  error estimate for blocks of size 2^( 2) =       0.000256188802
  error estimate for blocks of size 2^( 3) =       0.000264367782
  error estimate for blocks of size 2^( 4) =       0.000270186957
  error estimate for blocks of size 2^( 5) =       0.000273740417
  error estimate for blocks of size 2^( 6) =       0.000275832851
  error estimate for blocks of size 2^( 7) =       0.000277238949
  error estimate for blocks of size 2^( 8) =       0.000278887346
  error estimate for blocks of size 2^( 9) =       0.000280287111

      target function =                  N/A
              le_mean =     -22.825052989727
             les_mean =     521.487508286233
             stat err =       0.000278061564
             autocorr =       1.266699729518
              std dev =       0.698793917448
             le_variance =       0.488312939063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310382882
                                         uncertainty =       0.001342056390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310382882
                                         uncertainty =       0.001342056390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247060955
  error estimate for blocks of size 2^( 2) =       0.000256188798
  error estimate for blocks of size 2^( 3) =       0.000264367779
  error estimate for blocks of size 2^( 4) =       0.000270186954
  error estimate for blocks of size 2^( 5) =       0.000273740415
  error estimate for blocks of size 2^( 6) =       0.000275832850
  error estimate for blocks of size 2^( 7) =       0.000277238948
  error estimate for blocks of size 2^( 8) =       0.000278887343
  error estimate for blocks of size 2^( 9) =       0.000280287113

      target function =                  N/A
              le_mean =     -22.825052988932
             les_mean =     521.487508406160
             stat err =       0.000278061563
             autocorr =       1.266699762404
              std dev =       0.698793905992
             le_variance =       0.488312923051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310368876
                                         uncertainty =       0.001342055798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488310368876
                                         uncertainty =       0.001342055798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247060951
  error estimate for blocks of size 2^( 2) =       0.000256188795
  error estimate for blocks of size 2^( 3) =       0.000264367776
  error estimate for blocks of size 2^( 4) =       0.000270186952
  error estimate for blocks of size 2^( 5) =       0.000273740414
  error estimate for blocks of size 2^( 6) =       0.000275832849
  error estimate for blocks of size 2^( 7) =       0.000277238946
  error estimate for blocks of size 2^( 8) =       0.000278887340
  error estimate for blocks of size 2^( 9) =       0.000280287114

      target function =                  N/A
              le_mean =     -22.825052988237
             les_mean =     521.487508514186
             stat err =       0.000278061562
             autocorr =       1.266699791159
              std dev =       0.698793895969
             le_variance =       0.488312909044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825052988137        initial
     9.3132e+02     9.3132e+03             2.6328e-07       -22.825052989727  <--
     3.7253e+03     3.7253e+04             6.5835e-08       -22.825052988932
     1.4901e+04     1.4901e+05             1.6460e-08       -22.825052988237

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 1.7459e+02
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_01                 1.085370e-01 3 1  ON 0
ci_02                -2.196995e-02 3 1  ON 1
ci_03                -2.172837e-02 3 1  ON 2
ci_04                 2.182715e-02 3 1  ON 3
ci_05                -2.150635e-02 3 1  ON 4
ci_06                -2.163161e-02 3 1  ON 5
ci_07                 2.585866e-02 3 1  ON 6
ci_08                -3.498760e-03 3 1  ON 7
ci_09                -1.105951e-02 3 1  ON 8
ci_10                -1.058891e-02 3 1  ON 9
ci_11                 1.649016e-02 3 1  ON 10
ci_12                 1.060545e-02 3 1  ON 11
ci_13                 1.184122e-02 3 1  ON 12
ci_14                 1.792075e-02 3 1  ON 13
ci_15                 7.391406e-03 3 1  ON 14
ci_16                 7.716488e-03 3 1  ON 15
ci_17                -9.231748e-03 3 1  ON 16
ci_18                -9.375778e-03 3 1  ON 17
ci_19                 9.927370e-03 3 1  ON 18
ci_20                 1.081199e-02 3 1  ON 19
ci_21                 8.102227e-03 3 1  ON 20
ci_22                 8.629565e-03 3 1  ON 21
ci_23                 6.569681e-03 3 1  ON 22
ci_24                 7.495338e-03 3 1  ON 23
ci_25                 5.255344e-03 3 1  ON 24
ci_26                 3.070308e-03 3 1  ON 25
ci_27                 2.446777e-03 3 1  ON 26
ci_28                 2.887964e-03 3 1  ON 27
ci_29                 2.898457e-03 3 1  ON 28
ci_30                 8.192131e-04 3 1  ON 29
ci_31                 7.384308e-04 3 1  ON 30
ci_32                 3.187348e-04 3 1  ON 31
ci_33                 1.932293e-04 3 1  ON 32
ci_34                -4.052291e-04 3 1  ON 33
ci_35                 2.122809e-04 3 1  ON 34
ci_36                -3.210449e-04 3 1  ON 35
ci_37                -4.119189e-04 3 1  ON 36
ci_38                -1.373856e-04 3 1  ON 37
ci_39                -6.948122e-05 3 1  ON 38
ci_40                -1.202743e-03 3 1  ON 39
ci_41                -1.967606e-04 3 1  ON 40
ci_42                -2.432293e-04 3 1  ON 41
ci_43                -2.390154e-03 3 1  ON 42
ci_44                -2.310827e-03 3 1  ON 43
ci_45                -5.586549e-06 3 1  ON 44
ci_46                 6.792820e-05 3 1  ON 45
ci_47                -9.426601e-05 3 1  ON 46
ci_48                 2.410620e-04 3 1  ON 47
ci_49                -1.275146e-03 3 1  ON 48
ci_50                -5.642375e-04 3 1  ON 49
ci_51                 9.098992e-05 3 1  ON 50
ci_52                 8.305233e-05 3 1  ON 51
ci_53                -1.112935e-03 3 1  ON 52
ci_54                -8.063718e-04 3 1  ON 53
ci_55                -7.860151e-04 3 1  ON 54
ci_56                 1.603050e-03 3 1  ON 55
ci_57                 1.652035e-03 3 1  ON 56
ci_58                -1.096706e-03 3 1  ON 57
ci_59                -1.509976e-03 3 1  ON 58
ci_60                 1.575237e-03 3 1  ON 59
ci_61                 2.244278e-03 3 1  ON 60
ci_62                -3.450272e-04 3 1  ON 61
ci_63                -3.397147e-04 3 1  ON 62
ci_64                -3.946586e-04 3 1  ON 63
ci_65                -5.585408e-04 3 1  ON 64
ci_66                -6.002675e-04 3 1  ON 65
ci_67                -3.372780e-04 3 1  ON 66
ci_68                -1.407798e-03 3 1  ON 67
ci_69                -1.757922e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9337e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8976
    reference variance = 0.828111
====================================================
  Execution time = 1.0011e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1378e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0433e-01
  Total weights = 7.856346388e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8652e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487037518550
                                         uncertainty =       0.001430927647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487037518550
                                         uncertainty =       0.001430927647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246738843
  error estimate for blocks of size 2^( 2) =       0.000255913912
  error estimate for blocks of size 2^( 3) =       0.000264078102
  error estimate for blocks of size 2^( 4) =       0.000269915966
  error estimate for blocks of size 2^( 5) =       0.000273520059
  error estimate for blocks of size 2^( 6) =       0.000275295510
  error estimate for blocks of size 2^( 7) =       0.000275764820
  error estimate for blocks of size 2^( 8) =       0.000276274888
  error estimate for blocks of size 2^( 9) =       0.000276178641

      target function =                  N/A
              le_mean =     -22.824426022645
             les_mean =     521.458756650290
             stat err =       0.000275878465
             autocorr =       1.250145479046
              std dev =       0.697882835733
             le_variance =       0.487040452411


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282442602265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824426022639       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824426023510       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824426024495       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824426024439       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.732615e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824426022639       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824426022857       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824426023104       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824426023090       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 4.335079e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824426022639       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824426022694       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824426022755       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824426022752       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 1.083991e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1878e+02
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.085370e-01 3 1  ON 0
ci_02                -2.196997e-02 3 1  ON 1
ci_03                -2.172827e-02 3 1  ON 2
ci_04                 2.182710e-02 3 1  ON 3
ci_05                -2.150625e-02 3 1  ON 4
ci_06                -2.163165e-02 3 1  ON 5
ci_07                 2.585871e-02 3 1  ON 6
ci_08                -3.498756e-03 3 1  ON 7
ci_09                -1.105964e-02 3 1  ON 8
ci_10                -1.058891e-02 3 1  ON 9
ci_11                 1.649014e-02 3 1  ON 10
ci_12                 1.060566e-02 3 1  ON 11
ci_13                 1.184129e-02 3 1  ON 12
ci_14                 1.792063e-02 3 1  ON 13
ci_15                 7.391427e-03 3 1  ON 14
ci_16                 7.716374e-03 3 1  ON 15
ci_17                -9.231687e-03 3 1  ON 16
ci_18                -9.375841e-03 3 1  ON 17
ci_19                 9.927046e-03 3 1  ON 18
ci_20                 1.081182e-02 3 1  ON 19
ci_21                 8.102224e-03 3 1  ON 20
ci_22                 8.629504e-03 3 1  ON 21
ci_23                 6.569659e-03 3 1  ON 22
ci_24                 7.495238e-03 3 1  ON 23
ci_25                 5.255156e-03 3 1  ON 24
ci_26                 3.070328e-03 3 1  ON 25
ci_27                 2.446602e-03 3 1  ON 26
ci_28                 2.887847e-03 3 1  ON 27
ci_29                 2.898464e-03 3 1  ON 28
ci_30                 8.192446e-04 3 1  ON 29
ci_31                 7.384231e-04 3 1  ON 30
ci_32                 3.183013e-04 3 1  ON 31
ci_33                 1.932623e-04 3 1  ON 32
ci_34                -4.052300e-04 3 1  ON 33
ci_35                 2.122971e-04 3 1  ON 34
ci_36                -3.209549e-04 3 1  ON 35
ci_37                -4.119280e-04 3 1  ON 36
ci_38                -1.373563e-04 3 1  ON 37
ci_39                -6.951791e-05 3 1  ON 38
ci_40                -1.202910e-03 3 1  ON 39
ci_41                -1.967830e-04 3 1  ON 40
ci_42                -2.432687e-04 3 1  ON 41
ci_43                -2.390120e-03 3 1  ON 42
ci_44                -2.310768e-03 3 1  ON 43
ci_45                -5.535083e-06 3 1  ON 44
ci_46                 6.810091e-05 3 1  ON 45
ci_47                -9.431295e-05 3 1  ON 46
ci_48                 2.411510e-04 3 1  ON 47
ci_49                -1.275239e-03 3 1  ON 48
ci_50                -5.641782e-04 3 1  ON 49
ci_51                 9.090999e-05 3 1  ON 50
ci_52                 8.304524e-05 3 1  ON 51
ci_53                -1.112765e-03 3 1  ON 52
ci_54                -8.062366e-04 3 1  ON 53
ci_55                -7.860933e-04 3 1  ON 54
ci_56                 1.603015e-03 3 1  ON 55
ci_57                 1.652466e-03 3 1  ON 56
ci_58                -1.096513e-03 3 1  ON 57
ci_59                -1.509947e-03 3 1  ON 58
ci_60                 1.575189e-03 3 1  ON 59
ci_61                 2.244227e-03 3 1  ON 60
ci_62                -3.448465e-04 3 1  ON 61
ci_63                -3.393740e-04 3 1  ON 62
ci_64                -3.946114e-04 3 1  ON 63
ci_65                -5.583156e-04 3 1  ON 64
ci_66                -6.001294e-04 3 1  ON 65
ci_67                -3.371121e-04 3 1  ON 66
ci_68                -1.407962e-03 3 1  ON 67
ci_69                -1.757941e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.761
    reference variance = 0.376966
====================================================
  Execution time = 1.0268e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0628e-01
  Total weights = 7.8575e+06
  Execution time = 1.4358e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488516012041
                                         uncertainty =       0.001383799128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488516012041
                                         uncertainty =       0.001383799128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247113106
  error estimate for blocks of size 2^( 2) =       0.000256292053
  error estimate for blocks of size 2^( 3) =       0.000264518718
  error estimate for blocks of size 2^( 4) =       0.000270632908
  error estimate for blocks of size 2^( 5) =       0.000274168760
  error estimate for blocks of size 2^( 6) =       0.000275951787
  error estimate for blocks of size 2^( 7) =       0.000276784156
  error estimate for blocks of size 2^( 8) =       0.000278576261
  error estimate for blocks of size 2^( 9) =       0.000278922856

      target function =                  N/A
              le_mean =     -22.824543553546
             les_mean =     521.466068050183
             stat err =       0.000277558765
             autocorr =       1.261590278626
              std dev =       0.698941412251
             le_variance =       0.488519097759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488514932177
                                         uncertainty =       0.001383337729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488514932177
                                         uncertainty =       0.001383337729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247112832
  error estimate for blocks of size 2^( 2) =       0.000256291791
  error estimate for blocks of size 2^( 3) =       0.000264518466
  error estimate for blocks of size 2^( 4) =       0.000270632664
  error estimate for blocks of size 2^( 5) =       0.000274168513
  error estimate for blocks of size 2^( 6) =       0.000275951537
  error estimate for blocks of size 2^( 7) =       0.000276783897
  error estimate for blocks of size 2^( 8) =       0.000278575965
  error estimate for blocks of size 2^( 9) =       0.000278922556

      target function =                  N/A
              le_mean =     -22.824543558969
             les_mean =     521.466066496497
             stat err =       0.000277558489
             autocorr =       1.261590560549
              std dev =       0.698940638134
             le_variance =       0.488518015635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488515471366
                                         uncertainty =       0.001383568081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488515471366
                                         uncertainty =       0.001383568081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247112969
  error estimate for blocks of size 2^( 2) =       0.000256291922
  error estimate for blocks of size 2^( 3) =       0.000264518592
  error estimate for blocks of size 2^( 4) =       0.000270632786
  error estimate for blocks of size 2^( 5) =       0.000274168636
  error estimate for blocks of size 2^( 6) =       0.000275951661
  error estimate for blocks of size 2^( 7) =       0.000276784026
  error estimate for blocks of size 2^( 8) =       0.000278576113
  error estimate for blocks of size 2^( 9) =       0.000278922706

      target function =                  N/A
              le_mean =     -22.824543556252
             les_mean =     521.466067255207
             stat err =       0.000277558627
             autocorr =       1.261590419780
              std dev =       0.698941024660
             le_variance =       0.488518555953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488515944410
                                         uncertainty =       0.001383770224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488515944410
                                         uncertainty =       0.001383770224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247113089
  error estimate for blocks of size 2^( 2) =       0.000256292036
  error estimate for blocks of size 2^( 3) =       0.000264518702
  error estimate for blocks of size 2^( 4) =       0.000270632893
  error estimate for blocks of size 2^( 5) =       0.000274168745
  error estimate for blocks of size 2^( 6) =       0.000275951771
  error estimate for blocks of size 2^( 7) =       0.000276784140
  error estimate for blocks of size 2^( 8) =       0.000278576243
  error estimate for blocks of size 2^( 9) =       0.000278922837

      target function =                  N/A
              le_mean =     -22.824543553884
             les_mean =     521.466067948887
             stat err =       0.000277558748
             autocorr =       1.261590296277
              std dev =       0.698941363769
             le_variance =       0.488519029987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824543553546        initial
     2.3283e+02     2.3283e+03             1.7326e-06       -22.824543558969  <--
     9.3132e+02     9.3132e+03             4.3351e-07       -22.824543556252
     3.7253e+03     3.7253e+04             1.0840e-07       -22.824543553884

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 1.7442e+02
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_01                 1.085369e-01 3 1  ON 0
ci_02                -2.197006e-02 3 1  ON 1
ci_03                -2.172796e-02 3 1  ON 2
ci_04                 2.182697e-02 3 1  ON 3
ci_05                -2.150595e-02 3 1  ON 4
ci_06                -2.163177e-02 3 1  ON 5
ci_07                 2.585888e-02 3 1  ON 6
ci_08                -3.498745e-03 3 1  ON 7
ci_09                -1.106000e-02 3 1  ON 8
ci_10                -1.058888e-02 3 1  ON 9
ci_11                 1.649008e-02 3 1  ON 10
ci_12                 1.060629e-02 3 1  ON 11
ci_13                 1.184150e-02 3 1  ON 12
ci_14                 1.792029e-02 3 1  ON 13
ci_15                 7.391491e-03 3 1  ON 14
ci_16                 7.716033e-03 3 1  ON 15
ci_17                -9.231504e-03 3 1  ON 16
ci_18                -9.376029e-03 3 1  ON 17
ci_19                 9.926072e-03 3 1  ON 18
ci_20                 1.081131e-02 3 1  ON 19
ci_21                 8.102215e-03 3 1  ON 20
ci_22                 8.629323e-03 3 1  ON 21
ci_23                 6.569591e-03 3 1  ON 22
ci_24                 7.494937e-03 3 1  ON 23
ci_25                 5.254590e-03 3 1  ON 24
ci_26                 3.070385e-03 3 1  ON 25
ci_27                 2.446077e-03 3 1  ON 26
ci_28                 2.887494e-03 3 1  ON 27
ci_29                 2.898484e-03 3 1  ON 28
ci_30                 8.193393e-04 3 1  ON 29
ci_31                 7.384000e-04 3 1  ON 30
ci_32                 3.170022e-04 3 1  ON 31
ci_33                 1.933613e-04 3 1  ON 32
ci_34                -4.052327e-04 3 1  ON 33
ci_35                 2.123457e-04 3 1  ON 34
ci_36                -3.206851e-04 3 1  ON 35
ci_37                -4.119554e-04 3 1  ON 36
ci_38                -1.372684e-04 3 1  ON 37
ci_39                -6.962782e-05 3 1  ON 38
ci_40                -1.203410e-03 3 1  ON 39
ci_41                -1.968499e-04 3 1  ON 40
ci_42                -2.433868e-04 3 1  ON 41
ci_43                -2.390018e-03 3 1  ON 42
ci_44                -2.310589e-03 3 1  ON 43
ci_45                -5.380840e-06 3 1  ON 44
ci_46                 6.861845e-05 3 1  ON 45
ci_47                -9.445375e-05 3 1  ON 46
ci_48                 2.414178e-04 3 1  ON 47
ci_49                -1.275518e-03 3 1  ON 48
ci_50                -5.640006e-04 3 1  ON 49
ci_51                 9.067042e-05 3 1  ON 50
ci_52                 8.302400e-05 3 1  ON 51
ci_53                -1.112257e-03 3 1  ON 52
ci_54                -8.058310e-04 3 1  ON 53
ci_55                -7.863275e-04 3 1  ON 54
ci_56                 1.602908e-03 3 1  ON 55
ci_57                 1.653759e-03 3 1  ON 56
ci_58                -1.095934e-03 3 1  ON 57
ci_59                -1.509863e-03 3 1  ON 58
ci_60                 1.575045e-03 3 1  ON 59
ci_61                 2.244075e-03 3 1  ON 60
ci_62                -3.443049e-04 3 1  ON 61
ci_63                -3.383534e-04 3 1  ON 62
ci_64                -3.944700e-04 3 1  ON 63
ci_65                -5.576406e-04 3 1  ON 64
ci_66                -5.997155e-04 3 1  ON 65
ci_67                -3.366151e-04 3 1  ON 66
ci_68                -1.408455e-03 3 1  ON 67
ci_69                -1.757997e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9321e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8081
    reference variance = 0.621228
====================================================
  Execution time = 1.0049e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1353e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0191e-01
  Total weights = 7.855983571e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8453e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486225741798
                                         uncertainty =       0.001813754788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486225741798
                                         uncertainty =       0.001813754788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246532206
  error estimate for blocks of size 2^( 2) =       0.000255761031
  error estimate for blocks of size 2^( 3) =       0.000263823356
  error estimate for blocks of size 2^( 4) =       0.000269770622
  error estimate for blocks of size 2^( 5) =       0.000273349070
  error estimate for blocks of size 2^( 6) =       0.000275069720
  error estimate for blocks of size 2^( 7) =       0.000275954537
  error estimate for blocks of size 2^( 8) =       0.000276875821
  error estimate for blocks of size 2^( 9) =       0.000276068486

      target function =                  N/A
              le_mean =     -22.824519511326
             les_mean =     521.460597521479
             stat err =       0.000275992141
             autocorr =       1.253274222412
              std dev =       0.697298378497
             le_variance =       0.486225028655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282451951133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824519511316       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824519531327       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824519532162       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824519531846       residual = 4.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 3.014351e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824519511316       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824519516331       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824519516536       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824519516457       residual = 4.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 7.552005e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824519511316       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824519512571       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824519512622       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824519512602       residual = 4.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 1.889012e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097432 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1896e+02
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.085370e-01 3 1  ON 0
ci_02                -2.197029e-02 3 1  ON 1
ci_03                -2.172824e-02 3 1  ON 2
ci_04                 2.182721e-02 3 1  ON 3
ci_05                -2.150588e-02 3 1  ON 4
ci_06                -2.163209e-02 3 1  ON 5
ci_07                 2.585875e-02 3 1  ON 6
ci_08                -3.498824e-03 3 1  ON 7
ci_09                -1.105999e-02 3 1  ON 8
ci_10                -1.058894e-02 3 1  ON 9
ci_11                 1.648938e-02 3 1  ON 10
ci_12                 1.060654e-02 3 1  ON 11
ci_13                 1.184161e-02 3 1  ON 12
ci_14                 1.791967e-02 3 1  ON 13
ci_15                 7.391602e-03 3 1  ON 14
ci_16                 7.716387e-03 3 1  ON 15
ci_17                -9.231314e-03 3 1  ON 16
ci_18                -9.375456e-03 3 1  ON 17
ci_19                 9.926101e-03 3 1  ON 18
ci_20                 1.081084e-02 3 1  ON 19
ci_21                 8.102378e-03 3 1  ON 20
ci_22                 8.628746e-03 3 1  ON 21
ci_23                 6.569251e-03 3 1  ON 22
ci_24                 7.494781e-03 3 1  ON 23
ci_25                 5.254719e-03 3 1  ON 24
ci_26                 3.069992e-03 3 1  ON 25
ci_27                 2.446472e-03 3 1  ON 26
ci_28                 2.886870e-03 3 1  ON 27
ci_29                 2.898834e-03 3 1  ON 28
ci_30                 8.192292e-04 3 1  ON 29
ci_31                 7.386007e-04 3 1  ON 30
ci_32                 3.172838e-04 3 1  ON 31
ci_33                 1.935094e-04 3 1  ON 32
ci_34                -4.049382e-04 3 1  ON 33
ci_35                 2.115905e-04 3 1  ON 34
ci_36                -3.208736e-04 3 1  ON 35
ci_37                -4.112433e-04 3 1  ON 36
ci_38                -1.376309e-04 3 1  ON 37
ci_39                -6.998800e-05 3 1  ON 38
ci_40                -1.203640e-03 3 1  ON 39
ci_41                -1.964546e-04 3 1  ON 40
ci_42                -2.429579e-04 3 1  ON 41
ci_43                -2.390458e-03 3 1  ON 42
ci_44                -2.310506e-03 3 1  ON 43
ci_45                -5.363231e-06 3 1  ON 44
ci_46                 6.852628e-05 3 1  ON 45
ci_47                -9.430673e-05 3 1  ON 46
ci_48                 2.413906e-04 3 1  ON 47
ci_49                -1.275868e-03 3 1  ON 48
ci_50                -5.640578e-04 3 1  ON 49
ci_51                 9.115068e-05 3 1  ON 50
ci_52                 8.334002e-05 3 1  ON 51
ci_53                -1.112519e-03 3 1  ON 52
ci_54                -8.056162e-04 3 1  ON 53
ci_55                -7.865060e-04 3 1  ON 54
ci_56                 1.602577e-03 3 1  ON 55
ci_57                 1.653945e-03 3 1  ON 56
ci_58                -1.096355e-03 3 1  ON 57
ci_59                -1.509157e-03 3 1  ON 58
ci_60                 1.575335e-03 3 1  ON 59
ci_61                 2.243812e-03 3 1  ON 60
ci_62                -3.446577e-04 3 1  ON 61
ci_63                -3.384552e-04 3 1  ON 62
ci_64                -3.941328e-04 3 1  ON 63
ci_65                -5.573304e-04 3 1  ON 64
ci_66                -5.998396e-04 3 1  ON 65
ci_67                -3.366767e-04 3 1  ON 66
ci_68                -1.408573e-03 3 1  ON 67
ci_69                -1.758080e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.9003
    reference variance = 0.338728
====================================================
  Execution time = 1.0248e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0020e-01
  Total weights = 7.8563e+06
  Execution time = 1.4306e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520555469
                                         uncertainty =       0.001136818868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520555469
                                         uncertainty =       0.001136818868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246354154
  error estimate for blocks of size 2^( 2) =       0.000255558082
  error estimate for blocks of size 2^( 3) =       0.000263762694
  error estimate for blocks of size 2^( 4) =       0.000269551803
  error estimate for blocks of size 2^( 5) =       0.000272791812
  error estimate for blocks of size 2^( 6) =       0.000274714452
  error estimate for blocks of size 2^( 7) =       0.000275754706
  error estimate for blocks of size 2^( 8) =       0.000276956657
  error estimate for blocks of size 2^( 9) =       0.000277580568

      target function =                  N/A
              le_mean =     -22.824134516118
             les_mean =     521.441313705378
             stat err =       0.000276251596
             autocorr =       1.257447358300
              std dev =       0.696794770231
             le_variance =       0.485522951822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520497754
                                         uncertainty =       0.001136827920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520497754
                                         uncertainty =       0.001136827920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246354139
  error estimate for blocks of size 2^( 2) =       0.000255558062
  error estimate for blocks of size 2^( 3) =       0.000263762672
  error estimate for blocks of size 2^( 4) =       0.000269551775
  error estimate for blocks of size 2^( 5) =       0.000272791786
  error estimate for blocks of size 2^( 6) =       0.000274714431
  error estimate for blocks of size 2^( 7) =       0.000275754694
  error estimate for blocks of size 2^( 8) =       0.000276956632
  error estimate for blocks of size 2^( 9) =       0.000277580534

      target function =                  N/A
              le_mean =     -22.824134509317
             les_mean =     521.441316374844
             stat err =       0.000276251573
             autocorr =       1.257447297335
              std dev =       0.696794728861
             le_variance =       0.485522894169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520526106
                                         uncertainty =       0.001136823389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520526106
                                         uncertainty =       0.001136823389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246354146
  error estimate for blocks of size 2^( 2) =       0.000255558072
  error estimate for blocks of size 2^( 3) =       0.000263762683
  error estimate for blocks of size 2^( 4) =       0.000269551789
  error estimate for blocks of size 2^( 5) =       0.000272791799
  error estimate for blocks of size 2^( 6) =       0.000274714442
  error estimate for blocks of size 2^( 7) =       0.000275754700
  error estimate for blocks of size 2^( 8) =       0.000276956644
  error estimate for blocks of size 2^( 9) =       0.000277580551

      target function =                  N/A
              le_mean =     -22.824134512678
             les_mean =     521.441314639843
             stat err =       0.000276251584
             autocorr =       1.257447327956
              std dev =       0.696794749184
             le_variance =       0.485522922490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520551748
                                         uncertainty =       0.001136819433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485520551748
                                         uncertainty =       0.001136819433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246354153
  error estimate for blocks of size 2^( 2) =       0.000255558080
  error estimate for blocks of size 2^( 3) =       0.000263762692
  error estimate for blocks of size 2^( 4) =       0.000269551801
  error estimate for blocks of size 2^( 5) =       0.000272791810
  error estimate for blocks of size 2^( 6) =       0.000274714451
  error estimate for blocks of size 2^( 7) =       0.000275754705
  error estimate for blocks of size 2^( 8) =       0.000276956655
  error estimate for blocks of size 2^( 9) =       0.000277580566

      target function =                  N/A
              le_mean =     -22.824134515684
             les_mean =     521.441313777280
             stat err =       0.000276251594
             autocorr =       1.257447354511
              std dev =       0.696794767564
             le_variance =       0.485522948105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824134516118        initial  <--
     5.8208e+01     5.8208e+02             3.0144e-06       -22.824134509317
     2.3283e+02     2.3283e+03             7.5520e-07       -22.824134512678
     9.3132e+02     9.3132e+03             1.8890e-07       -22.824134515684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 174.1330
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_01                 1.085369e-01 3 1  ON 0
ci_02                -2.197006e-02 3 1  ON 1
ci_03                -2.172796e-02 3 1  ON 2
ci_04                 2.182697e-02 3 1  ON 3
ci_05                -2.150595e-02 3 1  ON 4
ci_06                -2.163177e-02 3 1  ON 5
ci_07                 2.585888e-02 3 1  ON 6
ci_08                -3.498745e-03 3 1  ON 7
ci_09                -1.106000e-02 3 1  ON 8
ci_10                -1.058888e-02 3 1  ON 9
ci_11                 1.649008e-02 3 1  ON 10
ci_12                 1.060629e-02 3 1  ON 11
ci_13                 1.184150e-02 3 1  ON 12
ci_14                 1.792029e-02 3 1  ON 13
ci_15                 7.391491e-03 3 1  ON 14
ci_16                 7.716033e-03 3 1  ON 15
ci_17                -9.231504e-03 3 1  ON 16
ci_18                -9.376029e-03 3 1  ON 17
ci_19                 9.926072e-03 3 1  ON 18
ci_20                 1.081131e-02 3 1  ON 19
ci_21                 8.102215e-03 3 1  ON 20
ci_22                 8.629323e-03 3 1  ON 21
ci_23                 6.569591e-03 3 1  ON 22
ci_24                 7.494937e-03 3 1  ON 23
ci_25                 5.254590e-03 3 1  ON 24
ci_26                 3.070385e-03 3 1  ON 25
ci_27                 2.446077e-03 3 1  ON 26
ci_28                 2.887494e-03 3 1  ON 27
ci_29                 2.898484e-03 3 1  ON 28
ci_30                 8.193393e-04 3 1  ON 29
ci_31                 7.384000e-04 3 1  ON 30
ci_32                 3.170022e-04 3 1  ON 31
ci_33                 1.933613e-04 3 1  ON 32
ci_34                -4.052327e-04 3 1  ON 33
ci_35                 2.123457e-04 3 1  ON 34
ci_36                -3.206851e-04 3 1  ON 35
ci_37                -4.119554e-04 3 1  ON 36
ci_38                -1.372684e-04 3 1  ON 37
ci_39                -6.962782e-05 3 1  ON 38
ci_40                -1.203410e-03 3 1  ON 39
ci_41                -1.968499e-04 3 1  ON 40
ci_42                -2.433868e-04 3 1  ON 41
ci_43                -2.390018e-03 3 1  ON 42
ci_44                -2.310589e-03 3 1  ON 43
ci_45                -5.380840e-06 3 1  ON 44
ci_46                 6.861845e-05 3 1  ON 45
ci_47                -9.445375e-05 3 1  ON 46
ci_48                 2.414178e-04 3 1  ON 47
ci_49                -1.275518e-03 3 1  ON 48
ci_50                -5.640006e-04 3 1  ON 49
ci_51                 9.067042e-05 3 1  ON 50
ci_52                 8.302400e-05 3 1  ON 51
ci_53                -1.112257e-03 3 1  ON 52
ci_54                -8.058310e-04 3 1  ON 53
ci_55                -7.863275e-04 3 1  ON 54
ci_56                 1.602908e-03 3 1  ON 55
ci_57                 1.653759e-03 3 1  ON 56
ci_58                -1.095934e-03 3 1  ON 57
ci_59                -1.509863e-03 3 1  ON 58
ci_60                 1.575045e-03 3 1  ON 59
ci_61                 2.244075e-03 3 1  ON 60
ci_62                -3.443049e-04 3 1  ON 61
ci_63                -3.383534e-04 3 1  ON 62
ci_64                -3.944700e-04 3 1  ON 63
ci_65                -5.576406e-04 3 1  ON 64
ci_66                -5.997155e-04 3 1  ON 65
ci_67                -3.366151e-04 3 1  ON 66
ci_68                -1.408455e-03 3 1  ON 67
ci_69                -1.757997e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9310e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8177
    reference variance = 0.346988
====================================================
  Execution time = 1.0022e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1396e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0254e-01
  Total weights = 7.856863177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8512e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486804769951
                                         uncertainty =       0.001293946040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486804769951
                                         uncertainty =       0.001293946040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246679952
  error estimate for blocks of size 2^( 2) =       0.000255779535
  error estimate for blocks of size 2^( 3) =       0.000264018411
  error estimate for blocks of size 2^( 4) =       0.000269724347
  error estimate for blocks of size 2^( 5) =       0.000272930569
  error estimate for blocks of size 2^( 6) =       0.000275132572
  error estimate for blocks of size 2^( 7) =       0.000276012637
  error estimate for blocks of size 2^( 8) =       0.000277243867
  error estimate for blocks of size 2^( 9) =       0.000276946107

      target function =                  N/A
              le_mean =     -22.824676023579
             les_mean =     521.468376776719
             stat err =       0.000276333796
             autocorr =       1.254874504133
              std dev =       0.697716266531
             le_variance =       0.486807988581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282467602358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824676023574       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824676025817       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824676025883       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824676025893       residual = 4.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 3.803581e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824676023574       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824676024135       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824676024151       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824676024154       residual = 4.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 9.511110e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824676023574       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824676023714       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824676023718       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824676023720       residual = 4.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 2.377912e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1875e+02
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.085369e-01 3 1  ON 0
ci_02                -2.197008e-02 3 1  ON 1
ci_03                -2.172797e-02 3 1  ON 2
ci_04                 2.182697e-02 3 1  ON 3
ci_05                -2.150596e-02 3 1  ON 4
ci_06                -2.163177e-02 3 1  ON 5
ci_07                 2.585883e-02 3 1  ON 6
ci_08                -3.498765e-03 3 1  ON 7
ci_09                -1.105999e-02 3 1  ON 8
ci_10                -1.058889e-02 3 1  ON 9
ci_11                 1.649006e-02 3 1  ON 10
ci_12                 1.060633e-02 3 1  ON 11
ci_13                 1.184150e-02 3 1  ON 12
ci_14                 1.792023e-02 3 1  ON 13
ci_15                 7.391507e-03 3 1  ON 14
ci_16                 7.716069e-03 3 1  ON 15
ci_17                -9.231459e-03 3 1  ON 16
ci_18                -9.375996e-03 3 1  ON 17
ci_19                 9.926089e-03 3 1  ON 18
ci_20                 1.081131e-02 3 1  ON 19
ci_21                 8.102211e-03 3 1  ON 20
ci_22                 8.629333e-03 3 1  ON 21
ci_23                 6.569535e-03 3 1  ON 22
ci_24                 7.494957e-03 3 1  ON 23
ci_25                 5.254595e-03 3 1  ON 24
ci_26                 3.070400e-03 3 1  ON 25
ci_27                 2.446030e-03 3 1  ON 26
ci_28                 2.887461e-03 3 1  ON 27
ci_29                 2.898512e-03 3 1  ON 28
ci_30                 8.193614e-04 3 1  ON 29
ci_31                 7.383705e-04 3 1  ON 30
ci_32                 3.169279e-04 3 1  ON 31
ci_33                 1.934021e-04 3 1  ON 32
ci_34                -4.051376e-04 3 1  ON 33
ci_35                 2.123347e-04 3 1  ON 34
ci_36                -3.207274e-04 3 1  ON 35
ci_37                -4.119776e-04 3 1  ON 36
ci_38                -1.372495e-04 3 1  ON 37
ci_39                -6.964689e-05 3 1  ON 38
ci_40                -1.203421e-03 3 1  ON 39
ci_41                -1.968508e-04 3 1  ON 40
ci_42                -2.433954e-04 3 1  ON 41
ci_43                -2.390085e-03 3 1  ON 42
ci_44                -2.310574e-03 3 1  ON 43
ci_45                -5.435779e-06 3 1  ON 44
ci_46                 6.856317e-05 3 1  ON 45
ci_47                -9.445996e-05 3 1  ON 46
ci_48                 2.413510e-04 3 1  ON 47
ci_49                -1.275539e-03 3 1  ON 48
ci_50                -5.640186e-04 3 1  ON 49
ci_51                 9.067383e-05 3 1  ON 50
ci_52                 8.299505e-05 3 1  ON 51
ci_53                -1.112225e-03 3 1  ON 52
ci_54                -8.058343e-04 3 1  ON 53
ci_55                -7.863285e-04 3 1  ON 54
ci_56                 1.602919e-03 3 1  ON 55
ci_57                 1.653767e-03 3 1  ON 56
ci_58                -1.095927e-03 3 1  ON 57
ci_59                -1.509867e-03 3 1  ON 58
ci_60                 1.575067e-03 3 1  ON 59
ci_61                 2.244042e-03 3 1  ON 60
ci_62                -3.443261e-04 3 1  ON 61
ci_63                -3.383975e-04 3 1  ON 62
ci_64                -3.945071e-04 3 1  ON 63
ci_65                -5.576426e-04 3 1  ON 64
ci_66                -5.997151e-04 3 1  ON 65
ci_67                -3.366028e-04 3 1  ON 66
ci_68                -1.408463e-03 3 1  ON 67
ci_69                -1.757954e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.8293
    reference variance = 0.410309
====================================================
  Execution time = 1.0256e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0332e-01
  Total weights = 7.8564e+06
  Execution time = 1.4323e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880537323
                                         uncertainty =       0.001226601178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880537323
                                         uncertainty =       0.001226601178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246698922
  error estimate for blocks of size 2^( 2) =       0.000255986532
  error estimate for blocks of size 2^( 3) =       0.000264301912
  error estimate for blocks of size 2^( 4) =       0.000270293882
  error estimate for blocks of size 2^( 5) =       0.000274085972
  error estimate for blocks of size 2^( 6) =       0.000276373216
  error estimate for blocks of size 2^( 7) =       0.000277242441
  error estimate for blocks of size 2^( 8) =       0.000277031977
  error estimate for blocks of size 2^( 9) =       0.000277177195

      target function =                  N/A
              le_mean =     -22.824608914351
             les_mean =     521.466088901932
             stat err =       0.000276956207
             autocorr =       1.260339952052
              std dev =       0.697769922545
             le_variance =       0.486882864809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880518168
                                         uncertainty =       0.001226597797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880518168
                                         uncertainty =       0.001226597797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246698917
  error estimate for blocks of size 2^( 2) =       0.000255986525
  error estimate for blocks of size 2^( 3) =       0.000264301903
  error estimate for blocks of size 2^( 4) =       0.000270293872
  error estimate for blocks of size 2^( 5) =       0.000274085962
  error estimate for blocks of size 2^( 6) =       0.000276373208
  error estimate for blocks of size 2^( 7) =       0.000277242435
  error estimate for blocks of size 2^( 8) =       0.000277031981
  error estimate for blocks of size 2^( 9) =       0.000277177192

      target function =                  N/A
              le_mean =     -22.824608914623
             les_mean =     521.466089966249
             stat err =       0.000276956204
             autocorr =       1.260339972833
              std dev =       0.697769908821
             le_variance =       0.486882845656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880527739
                                         uncertainty =       0.001226599487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880527739
                                         uncertainty =       0.001226599487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246698920
  error estimate for blocks of size 2^( 2) =       0.000255986528
  error estimate for blocks of size 2^( 3) =       0.000264301907
  error estimate for blocks of size 2^( 4) =       0.000270293877
  error estimate for blocks of size 2^( 5) =       0.000274085967
  error estimate for blocks of size 2^( 6) =       0.000276373212
  error estimate for blocks of size 2^( 7) =       0.000277242438
  error estimate for blocks of size 2^( 8) =       0.000277031979
  error estimate for blocks of size 2^( 9) =       0.000277177194

      target function =                  N/A
              le_mean =     -22.824608914487
             les_mean =     521.466089425422
             stat err =       0.000276956206
             autocorr =       1.260339962431
              std dev =       0.697769915678
             le_variance =       0.486882855226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880536125
                                         uncertainty =       0.001226600966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486880536125
                                         uncertainty =       0.001226600966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246698922
  error estimate for blocks of size 2^( 2) =       0.000255986531
  error estimate for blocks of size 2^( 3) =       0.000264301911
  error estimate for blocks of size 2^( 4) =       0.000270293881
  error estimate for blocks of size 2^( 5) =       0.000274085971
  error estimate for blocks of size 2^( 6) =       0.000276373216
  error estimate for blocks of size 2^( 7) =       0.000277242441
  error estimate for blocks of size 2^( 8) =       0.000277031977
  error estimate for blocks of size 2^( 9) =       0.000277177195

      target function =                  N/A
              le_mean =     -22.824608914368
             les_mean =     521.466088966585
             stat err =       0.000276956207
             autocorr =       1.260339953369
              std dev =       0.697769921686
             le_variance =       0.486882863610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824608914351        initial
     5.8208e+02     5.8208e+03             3.8036e-07       -22.824608914623  <--
     2.3283e+03     2.3283e+04             9.5111e-08       -22.824608914487
     9.3132e+03     9.3132e+04             2.3779e-08       -22.824608914368

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 1.7425e+02
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_01                 1.085369e-01 3 1  ON 0
ci_02                -2.197015e-02 3 1  ON 1
ci_03                -2.172802e-02 3 1  ON 2
ci_04                 2.182695e-02 3 1  ON 3
ci_05                -2.150598e-02 3 1  ON 4
ci_06                -2.163179e-02 3 1  ON 5
ci_07                 2.585866e-02 3 1  ON 6
ci_08                -3.498825e-03 3 1  ON 7
ci_09                -1.105995e-02 3 1  ON 8
ci_10                -1.058893e-02 3 1  ON 9
ci_11                 1.649001e-02 3 1  ON 10
ci_12                 1.060644e-02 3 1  ON 11
ci_13                 1.184148e-02 3 1  ON 12
ci_14                 1.792007e-02 3 1  ON 13
ci_15                 7.391553e-03 3 1  ON 14
ci_16                 7.716177e-03 3 1  ON 15
ci_17                -9.231325e-03 3 1  ON 16
ci_18                -9.375898e-03 3 1  ON 17
ci_19                 9.926137e-03 3 1  ON 18
ci_20                 1.081130e-02 3 1  ON 19
ci_21                 8.102197e-03 3 1  ON 20
ci_22                 8.629364e-03 3 1  ON 21
ci_23                 6.569368e-03 3 1  ON 22
ci_24                 7.495017e-03 3 1  ON 23
ci_25                 5.254611e-03 3 1  ON 24
ci_26                 3.070443e-03 3 1  ON 25
ci_27                 2.445889e-03 3 1  ON 26
ci_28                 2.887362e-03 3 1  ON 27
ci_29                 2.898598e-03 3 1  ON 28
ci_30                 8.194276e-04 3 1  ON 29
ci_31                 7.382821e-04 3 1  ON 30
ci_32                 3.167050e-04 3 1  ON 31
ci_33                 1.935245e-04 3 1  ON 32
ci_34                -4.048524e-04 3 1  ON 33
ci_35                 2.123018e-04 3 1  ON 34
ci_36                -3.208543e-04 3 1  ON 35
ci_37                -4.120443e-04 3 1  ON 36
ci_38                -1.371927e-04 3 1  ON 37
ci_39                -6.970407e-05 3 1  ON 38
ci_40                -1.203455e-03 3 1  ON 39
ci_41                -1.968537e-04 3 1  ON 40
ci_42                -2.434213e-04 3 1  ON 41
ci_43                -2.390284e-03 3 1  ON 42
ci_44                -2.310530e-03 3 1  ON 43
ci_45                -5.600519e-06 3 1  ON 44
ci_46                 6.839740e-05 3 1  ON 45
ci_47                -9.447856e-05 3 1  ON 46
ci_48                 2.411505e-04 3 1  ON 47
ci_49                -1.275602e-03 3 1  ON 48
ci_50                -5.640725e-04 3 1  ON 49
ci_51                 9.068403e-05 3 1  ON 50
ci_52                 8.290825e-05 3 1  ON 51
ci_53                -1.112128e-03 3 1  ON 52
ci_54                -8.058439e-04 3 1  ON 53
ci_55                -7.863315e-04 3 1  ON 54
ci_56                 1.602952e-03 3 1  ON 55
ci_57                 1.653790e-03 3 1  ON 56
ci_58                -1.095907e-03 3 1  ON 57
ci_59                -1.509879e-03 3 1  ON 58
ci_60                 1.575135e-03 3 1  ON 59
ci_61                 2.243940e-03 3 1  ON 60
ci_62                -3.443895e-04 3 1  ON 61
ci_63                -3.385297e-04 3 1  ON 62
ci_64                -3.946184e-04 3 1  ON 63
ci_65                -5.576485e-04 3 1  ON 64
ci_66                -5.997140e-04 3 1  ON 65
ci_67                -3.365661e-04 3 1  ON 66
ci_68                -1.408487e-03 3 1  ON 67
ci_69                -1.757823e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9300e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8627
    reference variance = 0.424598
====================================================
  Execution time = 1.0037e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1425e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0342e-01
  Total weights = 7.856673160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8484e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487080599607
                                         uncertainty =       0.001410037580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487080599607
                                         uncertainty =       0.001410037580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246749482
  error estimate for blocks of size 2^( 2) =       0.000256010111
  error estimate for blocks of size 2^( 3) =       0.000264464730
  error estimate for blocks of size 2^( 4) =       0.000270024495
  error estimate for blocks of size 2^( 5) =       0.000273625801
  error estimate for blocks of size 2^( 6) =       0.000275591644
  error estimate for blocks of size 2^( 7) =       0.000276472098
  error estimate for blocks of size 2^( 8) =       0.000277264942
  error estimate for blocks of size 2^( 9) =       0.000277310830

      target function =                  N/A
              le_mean =     -22.824392696259
             les_mean =     521.456325251723
             stat err =       0.000276659879
             autocorr =       1.257129056775
              std dev =       0.697912927857
             le_variance =       0.487082454869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282439269626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824392696254       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824392709342       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824392708929       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824392708869       residual = 9.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 1.706653e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824392696254       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824392699529       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824392699427       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824392699412       residual = 9.96e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 4.272130e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824392696254       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824392697073       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824392697047       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824392697043       residual = 9.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.068377e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1887e+02
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.085371e-01 3 1  ON 0
ci_02                -2.197016e-02 3 1  ON 1
ci_03                -2.172829e-02 3 1  ON 2
ci_04                 2.182671e-02 3 1  ON 3
ci_05                -2.150591e-02 3 1  ON 4
ci_06                -2.163199e-02 3 1  ON 5
ci_07                 2.585850e-02 3 1  ON 6
ci_08                -3.498737e-03 3 1  ON 7
ci_09                -1.105986e-02 3 1  ON 8
ci_10                -1.058887e-02 3 1  ON 9
ci_11                 1.648986e-02 3 1  ON 10
ci_12                 1.060650e-02 3 1  ON 11
ci_13                 1.184150e-02 3 1  ON 12
ci_14                 1.791997e-02 3 1  ON 13
ci_15                 7.391639e-03 3 1  ON 14
ci_16                 7.716170e-03 3 1  ON 15
ci_17                -9.231112e-03 3 1  ON 16
ci_18                -9.375764e-03 3 1  ON 17
ci_19                 9.926300e-03 3 1  ON 18
ci_20                 1.081119e-02 3 1  ON 19
ci_21                 8.102246e-03 3 1  ON 20
ci_22                 8.629343e-03 3 1  ON 21
ci_23                 6.569683e-03 3 1  ON 22
ci_24                 7.494934e-03 3 1  ON 23
ci_25                 5.254244e-03 3 1  ON 24
ci_26                 3.070247e-03 3 1  ON 25
ci_27                 2.446014e-03 3 1  ON 26
ci_28                 2.887280e-03 3 1  ON 27
ci_29                 2.898599e-03 3 1  ON 28
ci_30                 8.194054e-04 3 1  ON 29
ci_31                 7.382728e-04 3 1  ON 30
ci_32                 3.168002e-04 3 1  ON 31
ci_33                 1.934874e-04 3 1  ON 32
ci_34                -4.047345e-04 3 1  ON 33
ci_35                 2.123728e-04 3 1  ON 34
ci_36                -3.207733e-04 3 1  ON 35
ci_37                -4.120224e-04 3 1  ON 36
ci_38                -1.370533e-04 3 1  ON 37
ci_39                -6.980978e-05 3 1  ON 38
ci_40                -1.203439e-03 3 1  ON 39
ci_41                -1.967104e-04 3 1  ON 40
ci_42                -2.429941e-04 3 1  ON 41
ci_43                -2.390227e-03 3 1  ON 42
ci_44                -2.310764e-03 3 1  ON 43
ci_45                -5.643861e-06 3 1  ON 44
ci_46                 6.835950e-05 3 1  ON 45
ci_47                -9.447016e-05 3 1  ON 46
ci_48                 2.408524e-04 3 1  ON 47
ci_49                -1.275523e-03 3 1  ON 48
ci_50                -5.639112e-04 3 1  ON 49
ci_51                 9.063265e-05 3 1  ON 50
ci_52                 8.275131e-05 3 1  ON 51
ci_53                -1.112039e-03 3 1  ON 52
ci_54                -8.057724e-04 3 1  ON 53
ci_55                -7.863281e-04 3 1  ON 54
ci_56                 1.602566e-03 3 1  ON 55
ci_57                 1.653581e-03 3 1  ON 56
ci_58                -1.095858e-03 3 1  ON 57
ci_59                -1.509880e-03 3 1  ON 58
ci_60                 1.575181e-03 3 1  ON 59
ci_61                 2.243789e-03 3 1  ON 60
ci_62                -3.444579e-04 3 1  ON 61
ci_63                -3.388870e-04 3 1  ON 62
ci_64                -3.946869e-04 3 1  ON 63
ci_65                -5.577992e-04 3 1  ON 64
ci_66                -5.994411e-04 3 1  ON 65
ci_67                -3.365786e-04 3 1  ON 66
ci_68                -1.408733e-03 3 1  ON 67
ci_69                -1.757703e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7327
    reference variance = 0.296948
====================================================
  Execution time = 1.0087e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0210e-01
  Total weights = 7.8568e+06
  Execution time = 1.4592e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253185247
                                         uncertainty =       0.001307844094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253185247
                                         uncertainty =       0.001307844094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246285801
  error estimate for blocks of size 2^( 2) =       0.000255404360
  error estimate for blocks of size 2^( 3) =       0.000263477995
  error estimate for blocks of size 2^( 4) =       0.000269164657
  error estimate for blocks of size 2^( 5) =       0.000273069260
  error estimate for blocks of size 2^( 6) =       0.000274671755
  error estimate for blocks of size 2^( 7) =       0.000275441927
  error estimate for blocks of size 2^( 8) =       0.000275612630
  error estimate for blocks of size 2^( 9) =       0.000276529703

      target function =                  N/A
              le_mean =     -22.824602014213
             les_mean =     521.464554161378
             stat err =       0.000275564004
             autocorr =       1.251890152277
              std dev =       0.696601439790
             le_variance =       0.485253565918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253161978
                                         uncertainty =       0.001307835996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253161978
                                         uncertainty =       0.001307835996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246285795
  error estimate for blocks of size 2^( 2) =       0.000255404358
  error estimate for blocks of size 2^( 3) =       0.000263477994
  error estimate for blocks of size 2^( 4) =       0.000269164660
  error estimate for blocks of size 2^( 5) =       0.000273069263
  error estimate for blocks of size 2^( 6) =       0.000274671742
  error estimate for blocks of size 2^( 7) =       0.000275441934
  error estimate for blocks of size 2^( 8) =       0.000275612652
  error estimate for blocks of size 2^( 9) =       0.000276529726

      target function =                  N/A
              le_mean =     -22.824602023092
             les_mean =     521.464550819601
             stat err =       0.000275564013
             autocorr =       1.251890302005
              std dev =       0.696601423171
             le_variance =       0.485253542764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253173480
                                         uncertainty =       0.001307840043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253173480
                                         uncertainty =       0.001307840043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246285798
  error estimate for blocks of size 2^( 2) =       0.000255404359
  error estimate for blocks of size 2^( 3) =       0.000263477995
  error estimate for blocks of size 2^( 4) =       0.000269164659
  error estimate for blocks of size 2^( 5) =       0.000273069262
  error estimate for blocks of size 2^( 6) =       0.000274671749
  error estimate for blocks of size 2^( 7) =       0.000275441930
  error estimate for blocks of size 2^( 8) =       0.000275612641
  error estimate for blocks of size 2^( 9) =       0.000276529714

      target function =                  N/A
              le_mean =     -22.824602018641
             les_mean =     521.464552429218
             stat err =       0.000275564009
             autocorr =       1.251890227375
              std dev =       0.696601431386
             le_variance =       0.485253554209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253183763
                                         uncertainty =       0.001307843587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485253183763
                                         uncertainty =       0.001307843587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246285801
  error estimate for blocks of size 2^( 2) =       0.000255404360
  error estimate for blocks of size 2^( 3) =       0.000263477995
  error estimate for blocks of size 2^( 4) =       0.000269164657
  error estimate for blocks of size 2^( 5) =       0.000273069261
  error estimate for blocks of size 2^( 6) =       0.000274671754
  error estimate for blocks of size 2^( 7) =       0.000275441927
  error estimate for blocks of size 2^( 8) =       0.000275612631
  error estimate for blocks of size 2^( 9) =       0.000276529704

      target function =                  N/A
              le_mean =     -22.824602014765
             les_mean =     521.464553937786
             stat err =       0.000275564004
             autocorr =       1.251890161620
              std dev =       0.696601438730
             le_variance =       0.485253564441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824602014213        initial
     1.4552e+02     1.4552e+03             1.7067e-06       -22.824602023092  <--
     5.8208e+02     5.8208e+03             4.2721e-07       -22.824602018641
     2.3283e+03     2.3283e+04             1.0684e-07       -22.824602014765

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 1.7277e+02
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_01                 1.085374e-01 3 1  ON 0
ci_02                -2.197018e-02 3 1  ON 1
ci_03                -2.172907e-02 3 1  ON 2
ci_04                 2.182597e-02 3 1  ON 3
ci_05                -2.150571e-02 3 1  ON 4
ci_06                -2.163259e-02 3 1  ON 5
ci_07                 2.585803e-02 3 1  ON 6
ci_08                -3.498473e-03 3 1  ON 7
ci_09                -1.105956e-02 3 1  ON 8
ci_10                -1.058869e-02 3 1  ON 9
ci_11                 1.648942e-02 3 1  ON 10
ci_12                 1.060668e-02 3 1  ON 11
ci_13                 1.184155e-02 3 1  ON 12
ci_14                 1.791965e-02 3 1  ON 13
ci_15                 7.391897e-03 3 1  ON 14
ci_16                 7.716153e-03 3 1  ON 15
ci_17                -9.230473e-03 3 1  ON 16
ci_18                -9.375364e-03 3 1  ON 17
ci_19                 9.926788e-03 3 1  ON 18
ci_20                 1.081085e-02 3 1  ON 19
ci_21                 8.102391e-03 3 1  ON 20
ci_22                 8.629279e-03 3 1  ON 21
ci_23                 6.570626e-03 3 1  ON 22
ci_24                 7.494685e-03 3 1  ON 23
ci_25                 5.253145e-03 3 1  ON 24
ci_26                 3.069658e-03 3 1  ON 25
ci_27                 2.446391e-03 3 1  ON 26
ci_28                 2.887033e-03 3 1  ON 27
ci_29                 2.898603e-03 3 1  ON 28
ci_30                 8.193387e-04 3 1  ON 29
ci_31                 7.382451e-04 3 1  ON 30
ci_32                 3.170852e-04 3 1  ON 31
ci_33                 1.933760e-04 3 1  ON 32
ci_34                -4.043816e-04 3 1  ON 33
ci_35                 2.125859e-04 3 1  ON 34
ci_36                -3.205307e-04 3 1  ON 35
ci_37                -4.119568e-04 3 1  ON 36
ci_38                -1.366359e-04 3 1  ON 37
ci_39                -7.012622e-05 3 1  ON 38
ci_40                -1.203392e-03 3 1  ON 39
ci_41                -1.962812e-04 3 1  ON 40
ci_42                -2.417146e-04 3 1  ON 41
ci_43                -2.390057e-03 3 1  ON 42
ci_44                -2.311467e-03 3 1  ON 43
ci_45                -5.773662e-06 3 1  ON 44
ci_46                 6.824598e-05 3 1  ON 45
ci_47                -9.444482e-05 3 1  ON 46
ci_48                 2.399593e-04 3 1  ON 47
ci_49                -1.275286e-03 3 1  ON 48
ci_50                -5.634286e-04 3 1  ON 49
ci_51                 9.047878e-05 3 1  ON 50
ci_52                 8.228138e-05 3 1  ON 51
ci_53                -1.111773e-03 3 1  ON 52
ci_54                -8.055583e-04 3 1  ON 53
ci_55                -7.863179e-04 3 1  ON 54
ci_56                 1.601413e-03 3 1  ON 55
ci_57                 1.652955e-03 3 1  ON 56
ci_58                -1.095714e-03 3 1  ON 57
ci_59                -1.509883e-03 3 1  ON 58
ci_60                 1.575318e-03 3 1  ON 59
ci_61                 2.243335e-03 3 1  ON 60
ci_62                -3.446629e-04 3 1  ON 61
ci_63                -3.399563e-04 3 1  ON 62
ci_64                -3.948919e-04 3 1  ON 63
ci_65                -5.582506e-04 3 1  ON 64
ci_66                -5.986238e-04 3 1  ON 65
ci_67                -3.366161e-04 3 1  ON 66
ci_68                -1.409469e-03 3 1  ON 67
ci_69                -1.757343e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9165e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.724
    reference variance = 1.07355
====================================================
  Execution time = 1.0026e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1359e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1043e-01
  Total weights = 7.856646221e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8451e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490655852861
                                         uncertainty =       0.001616052747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.490655852861
                                         uncertainty =       0.001616052747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247653189
  error estimate for blocks of size 2^( 2) =       0.000256740446
  error estimate for blocks of size 2^( 3) =       0.000264975172
  error estimate for blocks of size 2^( 4) =       0.000270906767
  error estimate for blocks of size 2^( 5) =       0.000274580502
  error estimate for blocks of size 2^( 6) =       0.000276090500
  error estimate for blocks of size 2^( 7) =       0.000277002057
  error estimate for blocks of size 2^( 8) =       0.000276563187
  error estimate for blocks of size 2^( 9) =       0.000276912326

      target function =                  N/A
              le_mean =     -22.824863270037
             les_mean =     521.484815949483
             stat err =       0.000276642017
             autocorr =       1.247809927859
              std dev =       0.700468997099
             le_variance =       0.490656815896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282486327004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824863270035       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824863272582       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824863276113       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824863276237       residual = 9.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+01 is 5.117576e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824863270035       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824863270674       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824863271552       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824863271584       residual = 9.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 1.283932e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824863270035       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824863270195       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824863270414       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824863270422       residual = 9.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 3.212677e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1872e+02
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.085377e-01 3 1  ON 0
ci_02                -2.197051e-02 3 1  ON 1
ci_03                -2.172934e-02 3 1  ON 2
ci_04                 2.182623e-02 3 1  ON 3
ci_05                -2.150530e-02 3 1  ON 4
ci_06                -2.163222e-02 3 1  ON 5
ci_07                 2.585716e-02 3 1  ON 6
ci_08                -3.498532e-03 3 1  ON 7
ci_09                -1.105883e-02 3 1  ON 8
ci_10                -1.058917e-02 3 1  ON 9
ci_11                 1.649015e-02 3 1  ON 10
ci_12                 1.060635e-02 3 1  ON 11
ci_13                 1.184204e-02 3 1  ON 12
ci_14                 1.791916e-02 3 1  ON 13
ci_15                 7.392298e-03 3 1  ON 14
ci_16                 7.715094e-03 3 1  ON 15
ci_17                -9.230003e-03 3 1  ON 16
ci_18                -9.375811e-03 3 1  ON 17
ci_19                 9.927142e-03 3 1  ON 18
ci_20                 1.081077e-02 3 1  ON 19
ci_21                 8.102942e-03 3 1  ON 20
ci_22                 8.629304e-03 3 1  ON 21
ci_23                 6.571455e-03 3 1  ON 22
ci_24                 7.494499e-03 3 1  ON 23
ci_25                 5.251941e-03 3 1  ON 24
ci_26                 3.068726e-03 3 1  ON 25
ci_27                 2.447088e-03 3 1  ON 26
ci_28                 2.887058e-03 3 1  ON 27
ci_29                 2.898968e-03 3 1  ON 28
ci_30                 8.202335e-04 3 1  ON 29
ci_31                 7.388559e-04 3 1  ON 30
ci_32                 3.178362e-04 3 1  ON 31
ci_33                 1.923020e-04 3 1  ON 32
ci_34                -4.030976e-04 3 1  ON 33
ci_35                 2.128822e-04 3 1  ON 34
ci_36                -3.214005e-04 3 1  ON 35
ci_37                -4.120111e-04 3 1  ON 36
ci_38                -1.361933e-04 3 1  ON 37
ci_39                -7.021750e-05 3 1  ON 38
ci_40                -1.203840e-03 3 1  ON 39
ci_41                -1.950103e-04 3 1  ON 40
ci_42                -2.421535e-04 3 1  ON 41
ci_43                -2.389934e-03 3 1  ON 42
ci_44                -2.311140e-03 3 1  ON 43
ci_45                -5.319711e-06 3 1  ON 44
ci_46                 6.802183e-05 3 1  ON 45
ci_47                -9.475851e-05 3 1  ON 46
ci_48                 2.391344e-04 3 1  ON 47
ci_49                -1.275062e-03 3 1  ON 48
ci_50                -5.640842e-04 3 1  ON 49
ci_51                 8.998449e-05 3 1  ON 50
ci_52                 8.203646e-05 3 1  ON 51
ci_53                -1.111452e-03 3 1  ON 52
ci_54                -8.048046e-04 3 1  ON 53
ci_55                -7.868078e-04 3 1  ON 54
ci_56                 1.601400e-03 3 1  ON 55
ci_57                 1.653214e-03 3 1  ON 56
ci_58                -1.095775e-03 3 1  ON 57
ci_59                -1.509065e-03 3 1  ON 58
ci_60                 1.574961e-03 3 1  ON 59
ci_61                 2.242821e-03 3 1  ON 60
ci_62                -3.450119e-04 3 1  ON 61
ci_63                -3.399247e-04 3 1  ON 62
ci_64                -3.948807e-04 3 1  ON 63
ci_65                -5.583939e-04 3 1  ON 64
ci_66                -5.986294e-04 3 1  ON 65
ci_67                -3.364121e-04 3 1  ON 66
ci_68                -1.408913e-03 3 1  ON 67
ci_69                -1.756567e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.727
    reference variance = 0.407623
====================================================
  Execution time = 1.0067e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0429e-01
  Total weights = 7.8566e+06
  Execution time = 1.4395e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601585992
                                         uncertainty =       0.001340660360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601585992
                                         uncertainty =       0.001340660360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246880398
  error estimate for blocks of size 2^( 2) =       0.000256031515
  error estimate for blocks of size 2^( 3) =       0.000264369235
  error estimate for blocks of size 2^( 4) =       0.000270380704
  error estimate for blocks of size 2^( 5) =       0.000273699952
  error estimate for blocks of size 2^( 6) =       0.000275597205
  error estimate for blocks of size 2^( 7) =       0.000277020599
  error estimate for blocks of size 2^( 8) =       0.000277782956
  error estimate for blocks of size 2^( 9) =       0.000276961393

      target function =                  N/A
              le_mean =     -22.824898183606
             les_mean =     521.480264699271
             stat err =       0.000276840538
             autocorr =       1.257436759606
              std dev =       0.698283213768
             le_variance =       0.487599446630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601659122
                                         uncertainty =       0.001340685068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601659122
                                         uncertainty =       0.001340685068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246880416
  error estimate for blocks of size 2^( 2) =       0.000256031533
  error estimate for blocks of size 2^( 3) =       0.000264369226
  error estimate for blocks of size 2^( 4) =       0.000270380651
  error estimate for blocks of size 2^( 5) =       0.000273699892
  error estimate for blocks of size 2^( 6) =       0.000275597179
  error estimate for blocks of size 2^( 7) =       0.000277020508
  error estimate for blocks of size 2^( 8) =       0.000277782788
  error estimate for blocks of size 2^( 9) =       0.000276961194

      target function =                  N/A
              le_mean =     -22.824898202623
             les_mean =     521.480272135264
             stat err =       0.000276840417
             autocorr =       1.257435472608
              std dev =       0.698283266259
             le_variance =       0.487599519937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601621132
                                         uncertainty =       0.001340672770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601621132
                                         uncertainty =       0.001340672770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246880407
  error estimate for blocks of size 2^( 2) =       0.000256031524
  error estimate for blocks of size 2^( 3) =       0.000264369230
  error estimate for blocks of size 2^( 4) =       0.000270380677
  error estimate for blocks of size 2^( 5) =       0.000273699921
  error estimate for blocks of size 2^( 6) =       0.000275597191
  error estimate for blocks of size 2^( 7) =       0.000277020552
  error estimate for blocks of size 2^( 8) =       0.000277782870
  error estimate for blocks of size 2^( 9) =       0.000276961292

      target function =                  N/A
              le_mean =     -22.824898193122
             les_mean =     521.480271253641
             stat err =       0.000276840476
             autocorr =       1.257436107557
              std dev =       0.698283238993
             le_variance =       0.487599481859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601590234
                                         uncertainty =       0.001340661913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487601590234
                                         uncertainty =       0.001340661913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246880399
  error estimate for blocks of size 2^( 2) =       0.000256031516
  error estimate for blocks of size 2^( 3) =       0.000264369235
  error estimate for blocks of size 2^( 4) =       0.000270380700
  error estimate for blocks of size 2^( 5) =       0.000273699949
  error estimate for blocks of size 2^( 6) =       0.000275597203
  error estimate for blocks of size 2^( 7) =       0.000277020593
  error estimate for blocks of size 2^( 8) =       0.000277782945
  error estimate for blocks of size 2^( 9) =       0.000276961380

      target function =                  N/A
              le_mean =     -22.824898184767
             les_mean =     521.480264868808
             stat err =       0.000276840530
             autocorr =       1.257436678416
              std dev =       0.698283216813
             le_variance =       0.487599450883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824898183606        initial
     3.6380e+01     3.6380e+02             5.1176e-06       -22.824898202623  <--
     1.4552e+02     1.4552e+03             1.2839e-06       -22.824898193122
     5.8208e+02     5.8208e+03             3.2127e-07       -22.824898184767

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 1.7246e+02
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_01                 1.085387e-01 3 1  ON 0
ci_02                -2.197150e-02 3 1  ON 1
ci_03                -2.173014e-02 3 1  ON 2
ci_04                 2.182701e-02 3 1  ON 3
ci_05                -2.150406e-02 3 1  ON 4
ci_06                -2.163108e-02 3 1  ON 5
ci_07                 2.585456e-02 3 1  ON 6
ci_08                -3.498707e-03 3 1  ON 7
ci_09                -1.105664e-02 3 1  ON 8
ci_10                -1.059063e-02 3 1  ON 9
ci_11                 1.649235e-02 3 1  ON 10
ci_12                 1.060535e-02 3 1  ON 11
ci_13                 1.184354e-02 3 1  ON 12
ci_14                 1.791769e-02 3 1  ON 13
ci_15                 7.393497e-03 3 1  ON 14
ci_16                 7.711934e-03 3 1  ON 15
ci_17                -9.228598e-03 3 1  ON 16
ci_18                -9.377147e-03 3 1  ON 17
ci_19                 9.928198e-03 3 1  ON 18
ci_20                 1.081053e-02 3 1  ON 19
ci_21                 8.104585e-03 3 1  ON 20
ci_22                 8.629377e-03 3 1  ON 21
ci_23                 6.573924e-03 3 1  ON 22
ci_24                 7.493940e-03 3 1  ON 23
ci_25                 5.248351e-03 3 1  ON 24
ci_26                 3.065941e-03 3 1  ON 25
ci_27                 2.449171e-03 3 1  ON 26
ci_28                 2.887133e-03 3 1  ON 27
ci_29                 2.900060e-03 3 1  ON 28
ci_30                 8.229078e-04 3 1  ON 29
ci_31                 7.406838e-04 3 1  ON 30
ci_32                 3.200736e-04 3 1  ON 31
ci_33                 1.891030e-04 3 1  ON 32
ci_34                -3.992640e-04 3 1  ON 33
ci_35                 2.137647e-04 3 1  ON 34
ci_36                -3.239899e-04 3 1  ON 35
ci_37                -4.121710e-04 3 1  ON 36
ci_38                -1.348735e-04 3 1  ON 37
ci_39                -7.048903e-05 3 1  ON 38
ci_40                -1.205169e-03 3 1  ON 39
ci_41                -1.912229e-04 3 1  ON 40
ci_42                -2.434591e-04 3 1  ON 41
ci_43                -2.389571e-03 3 1  ON 42
ci_44                -2.310167e-03 3 1  ON 43
ci_45                -3.967430e-06 3 1  ON 44
ci_46                 6.735605e-05 3 1  ON 45
ci_47                -9.569219e-05 3 1  ON 46
ci_48                 2.366728e-04 3 1  ON 47
ci_49                -1.274394e-03 3 1  ON 48
ci_50                -5.660293e-04 3 1  ON 49
ci_51                 8.851240e-05 3 1  ON 50
ci_52                 8.130638e-05 3 1  ON 51
ci_53                -1.110496e-03 3 1  ON 52
ci_54                -8.025532e-04 3 1  ON 53
ci_55                -7.882712e-04 3 1  ON 54
ci_56                 1.601361e-03 3 1  ON 55
ci_57                 1.653987e-03 3 1  ON 56
ci_58                -1.095958e-03 3 1  ON 57
ci_59                -1.506623e-03 3 1  ON 58
ci_60                 1.573889e-03 3 1  ON 59
ci_61                 2.241282e-03 3 1  ON 60
ci_62                -3.460497e-04 3 1  ON 61
ci_63                -3.398306e-04 3 1  ON 62
ci_64                -3.948470e-04 3 1  ON 63
ci_65                -5.588217e-04 3 1  ON 64
ci_66                -5.986471e-04 3 1  ON 65
ci_67                -3.358047e-04 3 1  ON 66
ci_68                -1.407253e-03 3 1  ON 67
ci_69                -1.754257e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8096
    reference variance = 0.421505
====================================================
  Execution time = 1.0024e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1374e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0663e-01
  Total weights = 7.856901461e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8461e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487098817145
                                         uncertainty =       0.001398404204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487098817145
                                         uncertainty =       0.001398404204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246753621
  error estimate for blocks of size 2^( 2) =       0.000255965149
  error estimate for blocks of size 2^( 3) =       0.000264245868
  error estimate for blocks of size 2^( 4) =       0.000270093847
  error estimate for blocks of size 2^( 5) =       0.000273682340
  error estimate for blocks of size 2^( 6) =       0.000275756098
  error estimate for blocks of size 2^( 7) =       0.000277238441
  error estimate for blocks of size 2^( 8) =       0.000278492151
  error estimate for blocks of size 2^( 9) =       0.000279116989

      target function =                  N/A
              le_mean =     -22.824246400621
             les_mean =     521.452856092907
             stat err =       0.000277650920
             autocorr =       1.266109197556
              std dev =       0.697924634919
             le_variance =       0.487098796026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282424640062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824246400615       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824246242382       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824246303075       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824246307085       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+00 is 8.448098e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824246400615       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824246360270       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824246375685       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824246376638       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+01 is 2.149904e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824246400615       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824246390479       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824246394347       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824246394582       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 5.399014e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1871e+02
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.085396e-01 3 1  ON 0
ci_02                -2.196946e-02 3 1  ON 1
ci_03                -2.173219e-02 3 1  ON 2
ci_04                 2.182944e-02 3 1  ON 3
ci_05                -2.150247e-02 3 1  ON 4
ci_06                -2.162983e-02 3 1  ON 5
ci_07                 2.585711e-02 3 1  ON 6
ci_08                -3.490799e-03 3 1  ON 7
ci_09                -1.105811e-02 3 1  ON 8
ci_10                -1.058277e-02 3 1  ON 9
ci_11                 1.649172e-02 3 1  ON 10
ci_12                 1.060735e-02 3 1  ON 11
ci_13                 1.184247e-02 3 1  ON 12
ci_14                 1.792362e-02 3 1  ON 13
ci_15                 7.393845e-03 3 1  ON 14
ci_16                 7.705849e-03 3 1  ON 15
ci_17                -9.227838e-03 3 1  ON 16
ci_18                -9.377860e-03 3 1  ON 17
ci_19                 9.931160e-03 3 1  ON 18
ci_20                 1.081439e-02 3 1  ON 19
ci_21                 8.106027e-03 3 1  ON 20
ci_22                 8.633154e-03 3 1  ON 21
ci_23                 6.572775e-03 3 1  ON 22
ci_24                 7.492232e-03 3 1  ON 23
ci_25                 5.248259e-03 3 1  ON 24
ci_26                 3.054566e-03 3 1  ON 25
ci_27                 2.453505e-03 3 1  ON 26
ci_28                 2.887311e-03 3 1  ON 27
ci_29                 2.902550e-03 3 1  ON 28
ci_30                 8.225204e-04 3 1  ON 29
ci_31                 7.442056e-04 3 1  ON 30
ci_32                 3.186052e-04 3 1  ON 31
ci_33                 1.866145e-04 3 1  ON 32
ci_34                -3.946405e-04 3 1  ON 33
ci_35                 2.113801e-04 3 1  ON 34
ci_36                -3.276229e-04 3 1  ON 35
ci_37                -4.272059e-04 3 1  ON 36
ci_38                -1.380228e-04 3 1  ON 37
ci_39                -7.670965e-05 3 1  ON 38
ci_40                -1.206625e-03 3 1  ON 39
ci_41                -1.876219e-04 3 1  ON 40
ci_42                -2.434041e-04 3 1  ON 41
ci_43                -2.392515e-03 3 1  ON 42
ci_44                -2.316480e-03 3 1  ON 43
ci_45                -1.366748e-05 3 1  ON 44
ci_46                 6.604393e-05 3 1  ON 45
ci_47                -9.399178e-05 3 1  ON 46
ci_48                 2.368293e-04 3 1  ON 47
ci_49                -1.283386e-03 3 1  ON 48
ci_50                -5.624902e-04 3 1  ON 49
ci_51                 9.112600e-05 3 1  ON 50
ci_52                 7.956658e-05 3 1  ON 51
ci_53                -1.111786e-03 3 1  ON 52
ci_54                -8.031675e-04 3 1  ON 53
ci_55                -8.097703e-04 3 1  ON 54
ci_56                 1.602271e-03 3 1  ON 55
ci_57                 1.656418e-03 3 1  ON 56
ci_58                -1.099810e-03 3 1  ON 57
ci_59                -1.509784e-03 3 1  ON 58
ci_60                 1.576826e-03 3 1  ON 59
ci_61                 2.241694e-03 3 1  ON 60
ci_62                -3.469181e-04 3 1  ON 61
ci_63                -3.347103e-04 3 1  ON 62
ci_64                -4.017380e-04 3 1  ON 63
ci_65                -5.540557e-04 3 1  ON 64
ci_66                -5.921260e-04 3 1  ON 65
ci_67                -3.368084e-04 3 1  ON 66
ci_68                -1.414043e-03 3 1  ON 67
ci_69                -1.750335e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8188
    reference variance = 0.513999
====================================================
  Execution time = 1.0076e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0320e-01
  Total weights = 7.8565e+06
  Execution time = 1.4348e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485107943510
                                         uncertainty =       0.001688999512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485107943510
                                         uncertainty =       0.001688999512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246249107
  error estimate for blocks of size 2^( 2) =       0.000255459924
  error estimate for blocks of size 2^( 3) =       0.000263812207
  error estimate for blocks of size 2^( 4) =       0.000269667733
  error estimate for blocks of size 2^( 5) =       0.000273219348
  error estimate for blocks of size 2^( 6) =       0.000274533764
  error estimate for blocks of size 2^( 7) =       0.000275756148
  error estimate for blocks of size 2^( 8) =       0.000275318825
  error estimate for blocks of size 2^( 9) =       0.000274977224

      target function =                  N/A
              le_mean =     -22.824415458313
             les_mean =     521.457126489154
             stat err =       0.000275146490
             autocorr =       1.248471483220
              std dev =       0.696497652676
             le_variance =       0.485108980184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485106485792
                                         uncertainty =       0.001688246207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485106485792
                                         uncertainty =       0.001688246207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246248736
  error estimate for blocks of size 2^( 2) =       0.000255459603
  error estimate for blocks of size 2^( 3) =       0.000263811836
  error estimate for blocks of size 2^( 4) =       0.000269667255
  error estimate for blocks of size 2^( 5) =       0.000273218844
  error estimate for blocks of size 2^( 6) =       0.000274533572
  error estimate for blocks of size 2^( 7) =       0.000275755731
  error estimate for blocks of size 2^( 8) =       0.000275318587
  error estimate for blocks of size 2^( 9) =       0.000274977642

      target function =                  N/A
              le_mean =     -22.824415368881
             les_mean =     521.457207165470
             stat err =       0.000275146383
             autocorr =       1.248474268120
              std dev =       0.696496604949
             le_variance =       0.485107520706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485107098156
                                         uncertainty =       0.001688613527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485107098156
                                         uncertainty =       0.001688613527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246248892
  error estimate for blocks of size 2^( 2) =       0.000255459735
  error estimate for blocks of size 2^( 3) =       0.000263811992
  error estimate for blocks of size 2^( 4) =       0.000269667464
  error estimate for blocks of size 2^( 5) =       0.000273219067
  error estimate for blocks of size 2^( 6) =       0.000274533643
  error estimate for blocks of size 2^( 7) =       0.000275755910
  error estimate for blocks of size 2^( 8) =       0.000275318677
  error estimate for blocks of size 2^( 9) =       0.000274977410

      target function =                  N/A
              le_mean =     -22.824415396379
             les_mean =     521.457151831238
             stat err =       0.000275146410
             autocorr =       1.248472934318
              std dev =       0.696497045177
             le_variance =       0.485108133940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485107824251
                                         uncertainty =       0.001688950809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485107824251
                                         uncertainty =       0.001688950809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246249076
  error estimate for blocks of size 2^( 2) =       0.000255459897
  error estimate for blocks of size 2^( 3) =       0.000263812177
  error estimate for blocks of size 2^( 4) =       0.000269667696
  error estimate for blocks of size 2^( 5) =       0.000273219309
  error estimate for blocks of size 2^( 6) =       0.000274533746
  error estimate for blocks of size 2^( 7) =       0.000275756115
  error estimate for blocks of size 2^( 8) =       0.000275318803
  error estimate for blocks of size 2^( 9) =       0.000274977244

      target function =                  N/A
              le_mean =     -22.824415448778
             les_mean =     521.457128357692
             stat err =       0.000275146477
             autocorr =       1.248471670344
              std dev =       0.696497566984
             le_variance =       0.485108860815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824415458313        initial  <--
     9.0949e+00     9.0949e+01             8.4481e-05       -22.824415368881
     3.6380e+01     3.6380e+02             2.1499e-05       -22.824415396379
     1.4552e+02     1.4552e+03             5.3990e-06       -22.824415448778

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.7450
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_01                 1.085387e-01 3 1  ON 0
ci_02                -2.197150e-02 3 1  ON 1
ci_03                -2.173014e-02 3 1  ON 2
ci_04                 2.182701e-02 3 1  ON 3
ci_05                -2.150406e-02 3 1  ON 4
ci_06                -2.163108e-02 3 1  ON 5
ci_07                 2.585456e-02 3 1  ON 6
ci_08                -3.498707e-03 3 1  ON 7
ci_09                -1.105664e-02 3 1  ON 8
ci_10                -1.059063e-02 3 1  ON 9
ci_11                 1.649235e-02 3 1  ON 10
ci_12                 1.060535e-02 3 1  ON 11
ci_13                 1.184354e-02 3 1  ON 12
ci_14                 1.791769e-02 3 1  ON 13
ci_15                 7.393497e-03 3 1  ON 14
ci_16                 7.711934e-03 3 1  ON 15
ci_17                -9.228598e-03 3 1  ON 16
ci_18                -9.377147e-03 3 1  ON 17
ci_19                 9.928198e-03 3 1  ON 18
ci_20                 1.081053e-02 3 1  ON 19
ci_21                 8.104585e-03 3 1  ON 20
ci_22                 8.629377e-03 3 1  ON 21
ci_23                 6.573924e-03 3 1  ON 22
ci_24                 7.493940e-03 3 1  ON 23
ci_25                 5.248351e-03 3 1  ON 24
ci_26                 3.065941e-03 3 1  ON 25
ci_27                 2.449171e-03 3 1  ON 26
ci_28                 2.887133e-03 3 1  ON 27
ci_29                 2.900060e-03 3 1  ON 28
ci_30                 8.229078e-04 3 1  ON 29
ci_31                 7.406838e-04 3 1  ON 30
ci_32                 3.200736e-04 3 1  ON 31
ci_33                 1.891030e-04 3 1  ON 32
ci_34                -3.992640e-04 3 1  ON 33
ci_35                 2.137647e-04 3 1  ON 34
ci_36                -3.239899e-04 3 1  ON 35
ci_37                -4.121710e-04 3 1  ON 36
ci_38                -1.348735e-04 3 1  ON 37
ci_39                -7.048903e-05 3 1  ON 38
ci_40                -1.205169e-03 3 1  ON 39
ci_41                -1.912229e-04 3 1  ON 40
ci_42                -2.434591e-04 3 1  ON 41
ci_43                -2.389571e-03 3 1  ON 42
ci_44                -2.310167e-03 3 1  ON 43
ci_45                -3.967430e-06 3 1  ON 44
ci_46                 6.735605e-05 3 1  ON 45
ci_47                -9.569219e-05 3 1  ON 46
ci_48                 2.366728e-04 3 1  ON 47
ci_49                -1.274394e-03 3 1  ON 48
ci_50                -5.660293e-04 3 1  ON 49
ci_51                 8.851240e-05 3 1  ON 50
ci_52                 8.130638e-05 3 1  ON 51
ci_53                -1.110496e-03 3 1  ON 52
ci_54                -8.025532e-04 3 1  ON 53
ci_55                -7.882712e-04 3 1  ON 54
ci_56                 1.601361e-03 3 1  ON 55
ci_57                 1.653987e-03 3 1  ON 56
ci_58                -1.095958e-03 3 1  ON 57
ci_59                -1.506623e-03 3 1  ON 58
ci_60                 1.573889e-03 3 1  ON 59
ci_61                 2.241282e-03 3 1  ON 60
ci_62                -3.460497e-04 3 1  ON 61
ci_63                -3.398306e-04 3 1  ON 62
ci_64                -3.948470e-04 3 1  ON 63
ci_65                -5.588217e-04 3 1  ON 64
ci_66                -5.986471e-04 3 1  ON 65
ci_67                -3.358047e-04 3 1  ON 66
ci_68                -1.407253e-03 3 1  ON 67
ci_69                -1.754257e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9147e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.9298
    reference variance = 0.585339
====================================================
  Execution time = 1.0032e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1397e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0719e-01
  Total weights = 7.857235468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8495e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491508318376
                                         uncertainty =       0.006086062685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.491508318376
                                         uncertainty =       0.006086062685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247867686
  error estimate for blocks of size 2^( 2) =       0.000257009549
  error estimate for blocks of size 2^( 3) =       0.000265102962
  error estimate for blocks of size 2^( 4) =       0.000270850027
  error estimate for blocks of size 2^( 5) =       0.000274199747
  error estimate for blocks of size 2^( 6) =       0.000275808142
  error estimate for blocks of size 2^( 7) =       0.000276858280
  error estimate for blocks of size 2^( 8) =       0.000277172191
  error estimate for blocks of size 2^( 9) =       0.000277238636

      target function =                  N/A
              le_mean =     -22.825252492519
             les_mean =     521.499338770602
             stat err =       0.000276769312
             autocorr =       1.246797852055
              std dev =       0.701075685558
             le_variance =       0.491507116880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282525249252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825252492515       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825252503901       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825252502902       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825252502873       residual = 3.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+01 is 2.181798e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825252492515       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825252495366       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825252495116       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825252495109       residual = 3.89e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 5.462421e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825252492515       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825252493228       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825252493165       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825252493164       residual = 3.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 1.366101e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1883e+02
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.085386e-01 3 1  ON 0
ci_02                -2.197145e-02 3 1  ON 1
ci_03                -2.173031e-02 3 1  ON 2
ci_04                 2.182708e-02 3 1  ON 3
ci_05                -2.150422e-02 3 1  ON 4
ci_06                -2.163082e-02 3 1  ON 5
ci_07                 2.585436e-02 3 1  ON 6
ci_08                -3.498449e-03 3 1  ON 7
ci_09                -1.105645e-02 3 1  ON 8
ci_10                -1.059092e-02 3 1  ON 9
ci_11                 1.649240e-02 3 1  ON 10
ci_12                 1.060555e-02 3 1  ON 11
ci_13                 1.184369e-02 3 1  ON 12
ci_14                 1.791742e-02 3 1  ON 13
ci_15                 7.393512e-03 3 1  ON 14
ci_16                 7.711676e-03 3 1  ON 15
ci_17                -9.228052e-03 3 1  ON 16
ci_18                -9.376843e-03 3 1  ON 17
ci_19                 9.928073e-03 3 1  ON 18
ci_20                 1.081032e-02 3 1  ON 19
ci_21                 8.104584e-03 3 1  ON 20
ci_22                 8.629403e-03 3 1  ON 21
ci_23                 6.573541e-03 3 1  ON 22
ci_24                 7.493629e-03 3 1  ON 23
ci_25                 5.248079e-03 3 1  ON 24
ci_26                 3.065709e-03 3 1  ON 25
ci_27                 2.448929e-03 3 1  ON 26
ci_28                 2.887334e-03 3 1  ON 27
ci_29                 2.900037e-03 3 1  ON 28
ci_30                 8.230279e-04 3 1  ON 29
ci_31                 7.408693e-04 3 1  ON 30
ci_32                 3.202440e-04 3 1  ON 31
ci_33                 1.891421e-04 3 1  ON 32
ci_34                -3.992550e-04 3 1  ON 33
ci_35                 2.136089e-04 3 1  ON 34
ci_36                -3.244018e-04 3 1  ON 35
ci_37                -4.117135e-04 3 1  ON 36
ci_38                -1.346307e-04 3 1  ON 37
ci_39                -7.055322e-05 3 1  ON 38
ci_40                -1.205560e-03 3 1  ON 39
ci_41                -1.913650e-04 3 1  ON 40
ci_42                -2.433456e-04 3 1  ON 41
ci_43                -2.389479e-03 3 1  ON 42
ci_44                -2.310150e-03 3 1  ON 43
ci_45                -3.963553e-06 3 1  ON 44
ci_46                 6.735045e-05 3 1  ON 45
ci_47                -9.567686e-05 3 1  ON 46
ci_48                 2.364970e-04 3 1  ON 47
ci_49                -1.274418e-03 3 1  ON 48
ci_50                -5.655565e-04 3 1  ON 49
ci_51                 8.846443e-05 3 1  ON 50
ci_52                 8.113629e-05 3 1  ON 51
ci_53                -1.110266e-03 3 1  ON 52
ci_54                -8.026343e-04 3 1  ON 53
ci_55                -7.883614e-04 3 1  ON 54
ci_56                 1.601138e-03 3 1  ON 55
ci_57                 1.653878e-03 3 1  ON 56
ci_58                -1.096110e-03 3 1  ON 57
ci_59                -1.506745e-03 3 1  ON 58
ci_60                 1.573983e-03 3 1  ON 59
ci_61                 2.241086e-03 3 1  ON 60
ci_62                -3.459269e-04 3 1  ON 61
ci_63                -3.401458e-04 3 1  ON 62
ci_64                -3.950434e-04 3 1  ON 63
ci_65                -5.587911e-04 3 1  ON 64
ci_66                -5.983254e-04 3 1  ON 65
ci_67                -3.358184e-04 3 1  ON 66
ci_68                -1.407542e-03 3 1  ON 67
ci_69                -1.753787e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7634
    reference variance = 0.2395
====================================================
  Execution time = 1.0091e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1008e-01
  Total weights = 7.8572e+06
  Execution time = 1.4361e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489756520055
                                         uncertainty =       0.003555949102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489756520055
                                         uncertainty =       0.003555949102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247425054
  error estimate for blocks of size 2^( 2) =       0.000256626944
  error estimate for blocks of size 2^( 3) =       0.000264914387
  error estimate for blocks of size 2^( 4) =       0.000270549286
  error estimate for blocks of size 2^( 5) =       0.000274248759
  error estimate for blocks of size 2^( 6) =       0.000276115626
  error estimate for blocks of size 2^( 7) =       0.000276958444
  error estimate for blocks of size 2^( 8) =       0.000277774053
  error estimate for blocks of size 2^( 9) =       0.000278016581

      target function =                  N/A
              le_mean =     -22.825010578237
             les_mean =     521.491192090860
             stat err =       0.000277216176
             autocorr =       1.255306532182
              std dev =       0.699823735484
             le_variance =       0.489753260747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489755965549
                                         uncertainty =       0.003555570197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489755965549
                                         uncertainty =       0.003555570197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247424915
  error estimate for blocks of size 2^( 2) =       0.000256626815
  error estimate for blocks of size 2^( 3) =       0.000264914268
  error estimate for blocks of size 2^( 4) =       0.000270549169
  error estimate for blocks of size 2^( 5) =       0.000274248641
  error estimate for blocks of size 2^( 6) =       0.000276115494
  error estimate for blocks of size 2^( 7) =       0.000276958318
  error estimate for blocks of size 2^( 8) =       0.000277773920
  error estimate for blocks of size 2^( 9) =       0.000278016409

      target function =                  N/A
              le_mean =     -22.825010579765
             les_mean =     521.491188164314
             stat err =       0.000277216035
             autocorr =       1.255306674822
              std dev =       0.699823339526
             le_variance =       0.489752706545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489756242203
                                         uncertainty =       0.003555759396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489756242203
                                         uncertainty =       0.003555759396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247424984
  error estimate for blocks of size 2^( 2) =       0.000256626879
  error estimate for blocks of size 2^( 3) =       0.000264914328
  error estimate for blocks of size 2^( 4) =       0.000270549227
  error estimate for blocks of size 2^( 5) =       0.000274248700
  error estimate for blocks of size 2^( 6) =       0.000276115560
  error estimate for blocks of size 2^( 7) =       0.000276958381
  error estimate for blocks of size 2^( 8) =       0.000277773987
  error estimate for blocks of size 2^( 9) =       0.000278016495

      target function =                  N/A
              le_mean =     -22.825010578978
             les_mean =     521.491190088443
             stat err =       0.000277216106
             autocorr =       1.255306603676
              std dev =       0.699823537077
             le_variance =       0.489752983047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489756485286
                                         uncertainty =       0.003555925380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.489756485286
                                         uncertainty =       0.003555925380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247425046
  error estimate for blocks of size 2^( 2) =       0.000256626936
  error estimate for blocks of size 2^( 3) =       0.000264914380
  error estimate for blocks of size 2^( 4) =       0.000270549278
  error estimate for blocks of size 2^( 5) =       0.000274248752
  error estimate for blocks of size 2^( 6) =       0.000276115618
  error estimate for blocks of size 2^( 7) =       0.000276958436
  error estimate for blocks of size 2^( 8) =       0.000277774045
  error estimate for blocks of size 2^( 9) =       0.000278016571

      target function =                  N/A
              le_mean =     -22.825010578327
             les_mean =     521.491191836046
             stat err =       0.000277216167
             autocorr =       1.255306541132
              std dev =       0.699823710657
             le_variance =       0.489753225998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825010578237        initial
     9.0949e+01     9.0949e+02             2.1818e-06       -22.825010579765  <--
     3.6380e+02     3.6380e+03             5.4624e-07       -22.825010578978
     1.4552e+03     1.4552e+04             1.3661e-07       -22.825010578327

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 1.7389e+02
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197131e-02 3 1  ON 1
ci_03                -2.173079e-02 3 1  ON 2
ci_04                 2.182730e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585375e-02 3 1  ON 6
ci_08                -3.497675e-03 3 1  ON 7
ci_09                -1.105588e-02 3 1  ON 8
ci_10                -1.059178e-02 3 1  ON 9
ci_11                 1.649254e-02 3 1  ON 10
ci_12                 1.060614e-02 3 1  ON 11
ci_13                 1.184413e-02 3 1  ON 12
ci_14                 1.791663e-02 3 1  ON 13
ci_15                 7.393557e-03 3 1  ON 14
ci_16                 7.710903e-03 3 1  ON 15
ci_17                -9.226416e-03 3 1  ON 16
ci_18                -9.375931e-03 3 1  ON 17
ci_19                 9.927699e-03 3 1  ON 18
ci_20                 1.080968e-02 3 1  ON 19
ci_21                 8.104579e-03 3 1  ON 20
ci_22                 8.629481e-03 3 1  ON 21
ci_23                 6.572395e-03 3 1  ON 22
ci_24                 7.492698e-03 3 1  ON 23
ci_25                 5.247267e-03 3 1  ON 24
ci_26                 3.065016e-03 3 1  ON 25
ci_27                 2.448205e-03 3 1  ON 26
ci_28                 2.887937e-03 3 1  ON 27
ci_29                 2.899969e-03 3 1  ON 28
ci_30                 8.233879e-04 3 1  ON 29
ci_31                 7.414251e-04 3 1  ON 30
ci_32                 3.207538e-04 3 1  ON 31
ci_33                 1.892590e-04 3 1  ON 32
ci_34                -3.992281e-04 3 1  ON 33
ci_35                 2.131425e-04 3 1  ON 34
ci_36                -3.256339e-04 3 1  ON 35
ci_37                -4.103450e-04 3 1  ON 36
ci_38                -1.339040e-04 3 1  ON 37
ci_39                -7.074534e-05 3 1  ON 38
ci_40                -1.206728e-03 3 1  ON 39
ci_41                -1.917906e-04 3 1  ON 40
ci_42                -2.430060e-04 3 1  ON 41
ci_43                -2.389206e-03 3 1  ON 42
ci_44                -2.310101e-03 3 1  ON 43
ci_45                -3.952309e-06 3 1  ON 44
ci_46                 6.733392e-05 3 1  ON 45
ci_47                -9.563073e-05 3 1  ON 46
ci_48                 2.359707e-04 3 1  ON 47
ci_49                -1.274488e-03 3 1  ON 48
ci_50                -5.641442e-04 3 1  ON 49
ci_51                 8.832108e-05 3 1  ON 50
ci_52                 8.062743e-05 3 1  ON 51
ci_53                -1.109579e-03 3 1  ON 52
ci_54                -8.028765e-04 3 1  ON 53
ci_55                -7.886314e-04 3 1  ON 54
ci_56                 1.600471e-03 3 1  ON 55
ci_57                 1.653550e-03 3 1  ON 56
ci_58                -1.096564e-03 3 1  ON 57
ci_59                -1.507110e-03 3 1  ON 58
ci_60                 1.574263e-03 3 1  ON 59
ci_61                 2.240498e-03 3 1  ON 60
ci_62                -3.455594e-04 3 1  ON 61
ci_63                -3.410882e-04 3 1  ON 62
ci_64                -3.956313e-04 3 1  ON 63
ci_65                -5.586992e-04 3 1  ON 64
ci_66                -5.973628e-04 3 1  ON 65
ci_67                -3.358595e-04 3 1  ON 66
ci_68                -1.408406e-03 3 1  ON 67
ci_69                -1.752383e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9272e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8615
    reference variance = 0.411457
====================================================
  Execution time = 1.0013e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1398e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0710e-01
  Total weights = 7.857403883e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8501e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488419661300
                                         uncertainty =       0.001719454400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488419661300
                                         uncertainty =       0.001719454400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000247088904
  error estimate for blocks of size 2^( 2) =       0.000256179566
  error estimate for blocks of size 2^( 3) =       0.000264320826
  error estimate for blocks of size 2^( 4) =       0.000270478075
  error estimate for blocks of size 2^( 5) =       0.000274054093
  error estimate for blocks of size 2^( 6) =       0.000276065862
  error estimate for blocks of size 2^( 7) =       0.000276631203
  error estimate for blocks of size 2^( 8) =       0.000278081987
  error estimate for blocks of size 2^( 9) =       0.000279225258

      target function =                  N/A
              le_mean =     -22.824919033679
             les_mean =     521.484026554235
             stat err =       0.000277501078
             autocorr =       1.261312970942
              std dev =       0.698872958034
             le_variance =       0.488423411471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282491903368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824919033674       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824919024980       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824919027654       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824919028232       residual = 5.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+01 is 8.220480e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824919033674       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824919031487       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824919032141       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824919032291       residual = 5.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+01 is 2.072553e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824919033674       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824919033127       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824919033289       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824919033327       residual = 5.49e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 5.192398e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106405 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1864e+02
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.085381e-01 3 1  ON 0
ci_02                -2.197027e-02 3 1  ON 1
ci_03                -2.173280e-02 3 1  ON 2
ci_04                 2.182755e-02 3 1  ON 3
ci_05                -2.150499e-02 3 1  ON 4
ci_06                -2.163050e-02 3 1  ON 5
ci_07                 2.585441e-02 3 1  ON 6
ci_08                -3.497289e-03 3 1  ON 7
ci_09                -1.105600e-02 3 1  ON 8
ci_10                -1.059187e-02 3 1  ON 9
ci_11                 1.649135e-02 3 1  ON 10
ci_12                 1.060792e-02 3 1  ON 11
ci_13                 1.184409e-02 3 1  ON 12
ci_14                 1.791659e-02 3 1  ON 13
ci_15                 7.393992e-03 3 1  ON 14
ci_16                 7.712477e-03 3 1  ON 15
ci_17                -9.226483e-03 3 1  ON 16
ci_18                -9.374576e-03 3 1  ON 17
ci_19                 9.926280e-03 3 1  ON 18
ci_20                 1.080905e-02 3 1  ON 19
ci_21                 8.105581e-03 3 1  ON 20
ci_22                 8.627875e-03 3 1  ON 21
ci_23                 6.572023e-03 3 1  ON 22
ci_24                 7.491240e-03 3 1  ON 23
ci_25                 5.248574e-03 3 1  ON 24
ci_26                 3.064443e-03 3 1  ON 25
ci_27                 2.447607e-03 3 1  ON 26
ci_28                 2.887321e-03 3 1  ON 27
ci_29                 2.898904e-03 3 1  ON 28
ci_30                 8.245012e-04 3 1  ON 29
ci_31                 7.421348e-04 3 1  ON 30
ci_32                 3.190302e-04 3 1  ON 31
ci_33                 1.888134e-04 3 1  ON 32
ci_34                -3.979727e-04 3 1  ON 33
ci_35                 2.115368e-04 3 1  ON 34
ci_36                -3.267289e-04 3 1  ON 35
ci_37                -4.114083e-04 3 1  ON 36
ci_38                -1.330702e-04 3 1  ON 37
ci_39                -6.935254e-05 3 1  ON 38
ci_40                -1.208001e-03 3 1  ON 39
ci_41                -1.907904e-04 3 1  ON 40
ci_42                -2.437116e-04 3 1  ON 41
ci_43                -2.389093e-03 3 1  ON 42
ci_44                -2.310069e-03 3 1  ON 43
ci_45                -3.949270e-06 3 1  ON 44
ci_46                 6.750743e-05 3 1  ON 45
ci_47                -9.532529e-05 3 1  ON 46
ci_48                 2.365372e-04 3 1  ON 47
ci_49                -1.273578e-03 3 1  ON 48
ci_50                -5.635476e-04 3 1  ON 49
ci_51                 8.624853e-05 3 1  ON 50
ci_52                 7.984937e-05 3 1  ON 51
ci_53                -1.110668e-03 3 1  ON 52
ci_54                -8.033365e-04 3 1  ON 53
ci_55                -7.883667e-04 3 1  ON 54
ci_56                 1.599933e-03 3 1  ON 55
ci_57                 1.652818e-03 3 1  ON 56
ci_58                -1.096933e-03 3 1  ON 57
ci_59                -1.507654e-03 3 1  ON 58
ci_60                 1.574874e-03 3 1  ON 59
ci_61                 2.240191e-03 3 1  ON 60
ci_62                -3.456957e-04 3 1  ON 61
ci_63                -3.419186e-04 3 1  ON 62
ci_64                -3.953497e-04 3 1  ON 63
ci_65                -5.584583e-04 3 1  ON 64
ci_66                -5.971974e-04 3 1  ON 65
ci_67                -3.344260e-04 3 1  ON 66
ci_68                -1.407436e-03 3 1  ON 67
ci_69                -1.752542e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.8315
    reference variance = 0.271281
====================================================
  Execution time = 1.0118e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9951e-01
  Total weights = 7.8561e+06
  Execution time = 1.4334e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151233382
                                         uncertainty =       0.001373193394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151233382
                                         uncertainty =       0.001373193394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246006564
  error estimate for blocks of size 2^( 2) =       0.000255147062
  error estimate for blocks of size 2^( 3) =       0.000263300322
  error estimate for blocks of size 2^( 4) =       0.000268974549
  error estimate for blocks of size 2^( 5) =       0.000272742304
  error estimate for blocks of size 2^( 6) =       0.000274631180
  error estimate for blocks of size 2^( 7) =       0.000276151027
  error estimate for blocks of size 2^( 8) =       0.000277628253
  error estimate for blocks of size 2^( 9) =       0.000277493362

      target function =                  N/A
              le_mean =     -22.824851278892
             les_mean =     521.473345589509
             stat err =       0.000276475955
             autocorr =       1.263052328532
              std dev =       0.695811639062
             le_variance =       0.484153837054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151496980
                                         uncertainty =       0.001373188102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151496980
                                         uncertainty =       0.001373188102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246006631
  error estimate for blocks of size 2^( 2) =       0.000255147096
  error estimate for blocks of size 2^( 3) =       0.000263300323
  error estimate for blocks of size 2^( 4) =       0.000268974528
  error estimate for blocks of size 2^( 5) =       0.000272742272
  error estimate for blocks of size 2^( 6) =       0.000274631119
  error estimate for blocks of size 2^( 7) =       0.000276151073
  error estimate for blocks of size 2^( 8) =       0.000277628158
  error estimate for blocks of size 2^( 9) =       0.000277493325

      target function =                  N/A
              le_mean =     -22.824851273267
             les_mean =     521.473351785727
             stat err =       0.000276475919
             autocorr =       1.263051307365
              std dev =       0.695811828627
             le_variance =       0.484154100857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151362290
                                         uncertainty =       0.001373190762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151362290
                                         uncertainty =       0.001373190762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246006597
  error estimate for blocks of size 2^( 2) =       0.000255147078
  error estimate for blocks of size 2^( 3) =       0.000263300322
  error estimate for blocks of size 2^( 4) =       0.000268974537
  error estimate for blocks of size 2^( 5) =       0.000272742287
  error estimate for blocks of size 2^( 6) =       0.000274631148
  error estimate for blocks of size 2^( 7) =       0.000276151050
  error estimate for blocks of size 2^( 8) =       0.000277628205
  error estimate for blocks of size 2^( 9) =       0.000277493342

      target function =                  N/A
              le_mean =     -22.824851275667
             les_mean =     521.473349555968
             stat err =       0.000276475936
             autocorr =       1.263051816041
              std dev =       0.695811731768
             le_variance =       0.484153966066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151249124
                                         uncertainty =       0.001373193064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484151249124
                                         uncertainty =       0.001373193064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246006568
  error estimate for blocks of size 2^( 2) =       0.000255147064
  error estimate for blocks of size 2^( 3) =       0.000263300322
  error estimate for blocks of size 2^( 4) =       0.000268974547
  error estimate for blocks of size 2^( 5) =       0.000272742301
  error estimate for blocks of size 2^( 6) =       0.000274631176
  error estimate for blocks of size 2^( 7) =       0.000276151030
  error estimate for blocks of size 2^( 8) =       0.000277628247
  error estimate for blocks of size 2^( 9) =       0.000277493359

      target function =                  N/A
              le_mean =     -22.824851278441
             les_mean =     521.473345860810
             stat err =       0.000276475953
             autocorr =       1.263052264761
              std dev =       0.695811650384
             le_variance =       0.484153852810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824851278892        initial  <--
     2.2737e+01     2.2737e+02             8.2205e-06       -22.824851273267
     9.0949e+01     9.0949e+02             2.0726e-06       -22.824851275667
     3.6380e+02     3.6380e+03             5.1924e-07       -22.824851278441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 173.1140
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197131e-02 3 1  ON 1
ci_03                -2.173079e-02 3 1  ON 2
ci_04                 2.182730e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585375e-02 3 1  ON 6
ci_08                -3.497675e-03 3 1  ON 7
ci_09                -1.105588e-02 3 1  ON 8
ci_10                -1.059178e-02 3 1  ON 9
ci_11                 1.649254e-02 3 1  ON 10
ci_12                 1.060614e-02 3 1  ON 11
ci_13                 1.184413e-02 3 1  ON 12
ci_14                 1.791663e-02 3 1  ON 13
ci_15                 7.393557e-03 3 1  ON 14
ci_16                 7.710903e-03 3 1  ON 15
ci_17                -9.226416e-03 3 1  ON 16
ci_18                -9.375931e-03 3 1  ON 17
ci_19                 9.927699e-03 3 1  ON 18
ci_20                 1.080968e-02 3 1  ON 19
ci_21                 8.104579e-03 3 1  ON 20
ci_22                 8.629481e-03 3 1  ON 21
ci_23                 6.572395e-03 3 1  ON 22
ci_24                 7.492698e-03 3 1  ON 23
ci_25                 5.247267e-03 3 1  ON 24
ci_26                 3.065016e-03 3 1  ON 25
ci_27                 2.448205e-03 3 1  ON 26
ci_28                 2.887937e-03 3 1  ON 27
ci_29                 2.899969e-03 3 1  ON 28
ci_30                 8.233879e-04 3 1  ON 29
ci_31                 7.414251e-04 3 1  ON 30
ci_32                 3.207538e-04 3 1  ON 31
ci_33                 1.892590e-04 3 1  ON 32
ci_34                -3.992281e-04 3 1  ON 33
ci_35                 2.131425e-04 3 1  ON 34
ci_36                -3.256339e-04 3 1  ON 35
ci_37                -4.103450e-04 3 1  ON 36
ci_38                -1.339040e-04 3 1  ON 37
ci_39                -7.074534e-05 3 1  ON 38
ci_40                -1.206728e-03 3 1  ON 39
ci_41                -1.917906e-04 3 1  ON 40
ci_42                -2.430060e-04 3 1  ON 41
ci_43                -2.389206e-03 3 1  ON 42
ci_44                -2.310101e-03 3 1  ON 43
ci_45                -3.952309e-06 3 1  ON 44
ci_46                 6.733392e-05 3 1  ON 45
ci_47                -9.563073e-05 3 1  ON 46
ci_48                 2.359707e-04 3 1  ON 47
ci_49                -1.274488e-03 3 1  ON 48
ci_50                -5.641442e-04 3 1  ON 49
ci_51                 8.832108e-05 3 1  ON 50
ci_52                 8.062743e-05 3 1  ON 51
ci_53                -1.109579e-03 3 1  ON 52
ci_54                -8.028765e-04 3 1  ON 53
ci_55                -7.886314e-04 3 1  ON 54
ci_56                 1.600471e-03 3 1  ON 55
ci_57                 1.653550e-03 3 1  ON 56
ci_58                -1.096564e-03 3 1  ON 57
ci_59                -1.507110e-03 3 1  ON 58
ci_60                 1.574263e-03 3 1  ON 59
ci_61                 2.240498e-03 3 1  ON 60
ci_62                -3.455594e-04 3 1  ON 61
ci_63                -3.410882e-04 3 1  ON 62
ci_64                -3.956313e-04 3 1  ON 63
ci_65                -5.586992e-04 3 1  ON 64
ci_66                -5.973628e-04 3 1  ON 65
ci_67                -3.358595e-04 3 1  ON 66
ci_68                -1.408406e-03 3 1  ON 67
ci_69                -1.752383e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9176e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8675
    reference variance = 0.42344
====================================================
  Execution time = 1.0021e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1361e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0282e-01
  Total weights = 7.856595744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8597e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487219598620
                                         uncertainty =       0.001671604969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487219598620
                                         uncertainty =       0.001671604969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246783681
  error estimate for blocks of size 2^( 2) =       0.000255879362
  error estimate for blocks of size 2^( 3) =       0.000264001656
  error estimate for blocks of size 2^( 4) =       0.000269955367
  error estimate for blocks of size 2^( 5) =       0.000273337377
  error estimate for blocks of size 2^( 6) =       0.000275500175
  error estimate for blocks of size 2^( 7) =       0.000276786036
  error estimate for blocks of size 2^( 8) =       0.000276811964
  error estimate for blocks of size 2^( 9) =       0.000276467966

      target function =                  N/A
              le_mean =     -22.824935386800
             les_mean =     521.480500090725
             stat err =       0.000276391535
             autocorr =       1.254343840584
              std dev =       0.698009656811
             le_variance =       0.487217481001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282493538680e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824935386792       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824935396371       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824935396338       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824935396374       residual = 3.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 1.095298e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824935386792       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824935389188       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824935389180       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824935389189       residual = 3.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 2.740736e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824935386792       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824935387391       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824935387389       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824935387391       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 6.853398e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1882e+02
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.085383e-01 3 1  ON 0
ci_02                -2.197135e-02 3 1  ON 1
ci_03                -2.173076e-02 3 1  ON 2
ci_04                 2.182728e-02 3 1  ON 3
ci_05                -2.150475e-02 3 1  ON 4
ci_06                -2.163005e-02 3 1  ON 5
ci_07                 2.585368e-02 3 1  ON 6
ci_08                -3.497798e-03 3 1  ON 7
ci_09                -1.105580e-02 3 1  ON 8
ci_10                -1.059173e-02 3 1  ON 9
ci_11                 1.649233e-02 3 1  ON 10
ci_12                 1.060616e-02 3 1  ON 11
ci_13                 1.184423e-02 3 1  ON 12
ci_14                 1.791647e-02 3 1  ON 13
ci_15                 7.393574e-03 3 1  ON 14
ci_16                 7.710918e-03 3 1  ON 15
ci_17                -9.226456e-03 3 1  ON 16
ci_18                -9.375775e-03 3 1  ON 17
ci_19                 9.927677e-03 3 1  ON 18
ci_20                 1.080959e-02 3 1  ON 19
ci_21                 8.104639e-03 3 1  ON 20
ci_22                 8.629569e-03 3 1  ON 21
ci_23                 6.572121e-03 3 1  ON 22
ci_24                 7.492729e-03 3 1  ON 23
ci_25                 5.247158e-03 3 1  ON 24
ci_26                 3.065024e-03 3 1  ON 25
ci_27                 2.448206e-03 3 1  ON 26
ci_28                 2.887835e-03 3 1  ON 27
ci_29                 2.900035e-03 3 1  ON 28
ci_30                 8.233306e-04 3 1  ON 29
ci_31                 7.414314e-04 3 1  ON 30
ci_32                 3.208228e-04 3 1  ON 31
ci_33                 1.891960e-04 3 1  ON 32
ci_34                -3.991987e-04 3 1  ON 33
ci_35                 2.130543e-04 3 1  ON 34
ci_36                -3.256635e-04 3 1  ON 35
ci_37                -4.103540e-04 3 1  ON 36
ci_38                -1.339776e-04 3 1  ON 37
ci_39                -7.078568e-05 3 1  ON 38
ci_40                -1.206803e-03 3 1  ON 39
ci_41                -1.917191e-04 3 1  ON 40
ci_42                -2.430207e-04 3 1  ON 41
ci_43                -2.389194e-03 3 1  ON 42
ci_44                -2.310049e-03 3 1  ON 43
ci_45                -4.108593e-06 3 1  ON 44
ci_46                 6.726630e-05 3 1  ON 45
ci_47                -9.562366e-05 3 1  ON 46
ci_48                 2.359721e-04 3 1  ON 47
ci_49                -1.274594e-03 3 1  ON 48
ci_50                -5.641041e-04 3 1  ON 49
ci_51                 8.826982e-05 3 1  ON 50
ci_52                 8.064186e-05 3 1  ON 51
ci_53                -1.109529e-03 3 1  ON 52
ci_54                -8.028799e-04 3 1  ON 53
ci_55                -7.886490e-04 3 1  ON 54
ci_56                 1.600584e-03 3 1  ON 55
ci_57                 1.653390e-03 3 1  ON 56
ci_58                -1.096664e-03 3 1  ON 57
ci_59                -1.507120e-03 3 1  ON 58
ci_60                 1.574197e-03 3 1  ON 59
ci_61                 2.240422e-03 3 1  ON 60
ci_62                -3.453498e-04 3 1  ON 61
ci_63                -3.411332e-04 3 1  ON 62
ci_64                -3.957051e-04 3 1  ON 63
ci_65                -5.586355e-04 3 1  ON 64
ci_66                -5.973209e-04 3 1  ON 65
ci_67                -3.358266e-04 3 1  ON 66
ci_68                -1.408476e-03 3 1  ON 67
ci_69                -1.752315e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7155
    reference variance = 0.559118
====================================================
  Execution time = 1.0105e+02
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0493e-01
  Total weights = 7.8568e+06
  Execution time = 1.4386e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900428390
                                         uncertainty =       0.001596273939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900428390
                                         uncertainty =       0.001596273939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246703856
  error estimate for blocks of size 2^( 2) =       0.000255854959
  error estimate for blocks of size 2^( 3) =       0.000264003255
  error estimate for blocks of size 2^( 4) =       0.000269933100
  error estimate for blocks of size 2^( 5) =       0.000273351136
  error estimate for blocks of size 2^( 6) =       0.000275533754
  error estimate for blocks of size 2^( 7) =       0.000277083180
  error estimate for blocks of size 2^( 8) =       0.000277738384
  error estimate for blocks of size 2^( 9) =       0.000277614332

      target function =                  N/A
              le_mean =     -22.824472171655
             les_mean =     521.461458971595
             stat err =       0.000276992412
             autocorr =       1.260619067785
              std dev =       0.697783876783
             le_variance =       0.486902338699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900142396
                                         uncertainty =       0.001596241731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900142396
                                         uncertainty =       0.001596241731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246703783
  error estimate for blocks of size 2^( 2) =       0.000255854891
  error estimate for blocks of size 2^( 3) =       0.000264003190
  error estimate for blocks of size 2^( 4) =       0.000269933037
  error estimate for blocks of size 2^( 5) =       0.000273351076
  error estimate for blocks of size 2^( 6) =       0.000275533690
  error estimate for blocks of size 2^( 7) =       0.000277083106
  error estimate for blocks of size 2^( 8) =       0.000277738296
  error estimate for blocks of size 2^( 9) =       0.000277614267

      target function =                  N/A
              le_mean =     -22.824472167126
             les_mean =     521.461457223362
             stat err =       0.000276992340
             autocorr =       1.260619148113
              std dev =       0.697783671872
             le_variance =       0.486902052731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900285159
                                         uncertainty =       0.001596257808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900285159
                                         uncertainty =       0.001596257808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246703819
  error estimate for blocks of size 2^( 2) =       0.000255854925
  error estimate for blocks of size 2^( 3) =       0.000264003222
  error estimate for blocks of size 2^( 4) =       0.000269933068
  error estimate for blocks of size 2^( 5) =       0.000273351106
  error estimate for blocks of size 2^( 6) =       0.000275533722
  error estimate for blocks of size 2^( 7) =       0.000277083143
  error estimate for blocks of size 2^( 8) =       0.000277738340
  error estimate for blocks of size 2^( 9) =       0.000277614300

      target function =                  N/A
              le_mean =     -22.824472169383
             les_mean =     521.461458083408
             stat err =       0.000276992376
             autocorr =       1.260619108024
              std dev =       0.697783774160
             le_variance =       0.486902195482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900410469
                                         uncertainty =       0.001596271921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486900410469
                                         uncertainty =       0.001596271921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246703851
  error estimate for blocks of size 2^( 2) =       0.000255854954
  error estimate for blocks of size 2^( 3) =       0.000264003251
  error estimate for blocks of size 2^( 4) =       0.000269933096
  error estimate for blocks of size 2^( 5) =       0.000273351133
  error estimate for blocks of size 2^( 6) =       0.000275533750
  error estimate for blocks of size 2^( 7) =       0.000277083175
  error estimate for blocks of size 2^( 8) =       0.000277738378
  error estimate for blocks of size 2^( 9) =       0.000277614328

      target function =                  N/A
              le_mean =     -22.824472171371
             les_mean =     521.461458859095
             stat err =       0.000276992408
             autocorr =       1.260619072781
              std dev =       0.697783863944
             le_variance =       0.486902320781


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824472171655        initial  <--
     2.2737e+02     2.2737e+03             1.0953e-06       -22.824472167126
     9.0949e+02     9.0949e+03             2.7407e-07       -22.824472169383
     3.6380e+03     3.6380e+04             6.8534e-08       -22.824472171371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.3122
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197131e-02 3 1  ON 1
ci_03                -2.173079e-02 3 1  ON 2
ci_04                 2.182730e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585375e-02 3 1  ON 6
ci_08                -3.497675e-03 3 1  ON 7
ci_09                -1.105588e-02 3 1  ON 8
ci_10                -1.059178e-02 3 1  ON 9
ci_11                 1.649254e-02 3 1  ON 10
ci_12                 1.060614e-02 3 1  ON 11
ci_13                 1.184413e-02 3 1  ON 12
ci_14                 1.791663e-02 3 1  ON 13
ci_15                 7.393557e-03 3 1  ON 14
ci_16                 7.710903e-03 3 1  ON 15
ci_17                -9.226416e-03 3 1  ON 16
ci_18                -9.375931e-03 3 1  ON 17
ci_19                 9.927699e-03 3 1  ON 18
ci_20                 1.080968e-02 3 1  ON 19
ci_21                 8.104579e-03 3 1  ON 20
ci_22                 8.629481e-03 3 1  ON 21
ci_23                 6.572395e-03 3 1  ON 22
ci_24                 7.492698e-03 3 1  ON 23
ci_25                 5.247267e-03 3 1  ON 24
ci_26                 3.065016e-03 3 1  ON 25
ci_27                 2.448205e-03 3 1  ON 26
ci_28                 2.887937e-03 3 1  ON 27
ci_29                 2.899969e-03 3 1  ON 28
ci_30                 8.233879e-04 3 1  ON 29
ci_31                 7.414251e-04 3 1  ON 30
ci_32                 3.207538e-04 3 1  ON 31
ci_33                 1.892590e-04 3 1  ON 32
ci_34                -3.992281e-04 3 1  ON 33
ci_35                 2.131425e-04 3 1  ON 34
ci_36                -3.256339e-04 3 1  ON 35
ci_37                -4.103450e-04 3 1  ON 36
ci_38                -1.339040e-04 3 1  ON 37
ci_39                -7.074534e-05 3 1  ON 38
ci_40                -1.206728e-03 3 1  ON 39
ci_41                -1.917906e-04 3 1  ON 40
ci_42                -2.430060e-04 3 1  ON 41
ci_43                -2.389206e-03 3 1  ON 42
ci_44                -2.310101e-03 3 1  ON 43
ci_45                -3.952309e-06 3 1  ON 44
ci_46                 6.733392e-05 3 1  ON 45
ci_47                -9.563073e-05 3 1  ON 46
ci_48                 2.359707e-04 3 1  ON 47
ci_49                -1.274488e-03 3 1  ON 48
ci_50                -5.641442e-04 3 1  ON 49
ci_51                 8.832108e-05 3 1  ON 50
ci_52                 8.062743e-05 3 1  ON 51
ci_53                -1.109579e-03 3 1  ON 52
ci_54                -8.028765e-04 3 1  ON 53
ci_55                -7.886314e-04 3 1  ON 54
ci_56                 1.600471e-03 3 1  ON 55
ci_57                 1.653550e-03 3 1  ON 56
ci_58                -1.096564e-03 3 1  ON 57
ci_59                -1.507110e-03 3 1  ON 58
ci_60                 1.574263e-03 3 1  ON 59
ci_61                 2.240498e-03 3 1  ON 60
ci_62                -3.455594e-04 3 1  ON 61
ci_63                -3.410882e-04 3 1  ON 62
ci_64                -3.956313e-04 3 1  ON 63
ci_65                -5.586992e-04 3 1  ON 64
ci_66                -5.973628e-04 3 1  ON 65
ci_67                -3.358595e-04 3 1  ON 66
ci_68                -1.408406e-03 3 1  ON 67
ci_69                -1.752383e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9414e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7655
    reference variance = 0.41588
====================================================
  Execution time = 1.0016e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1376e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0330e-01
  Total weights = 7.857398324e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8632e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486028522645
                                         uncertainty =       0.001354694656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486028522645
                                         uncertainty =       0.001354694656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246482770
  error estimate for blocks of size 2^( 2) =       0.000255576582
  error estimate for blocks of size 2^( 3) =       0.000263933410
  error estimate for blocks of size 2^( 4) =       0.000269660021
  error estimate for blocks of size 2^( 5) =       0.000273296149
  error estimate for blocks of size 2^( 6) =       0.000274831291
  error estimate for blocks of size 2^( 7) =       0.000275469036
  error estimate for blocks of size 2^( 8) =       0.000275895714
  error estimate for blocks of size 2^( 9) =       0.000274873335

      target function =                  N/A
              le_mean =     -22.824663765187
             les_mean =     521.468578584763
             stat err =       0.000275267344
             autocorr =       1.247200437442
              std dev =       0.697158551200
             le_variance =       0.486030045512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282466376519e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824663765183       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824663765728       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824663765742       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824663765749       residual = 5.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 1.568687e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824663765183       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824663765319       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824663765323       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824663765327       residual = 5.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 3.922064e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824663765183       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824663765217       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824663765218       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824663765253       residual = 5.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 9.805375e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1881e+02
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197131e-02 3 1  ON 1
ci_03                -2.173080e-02 3 1  ON 2
ci_04                 2.182731e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585376e-02 3 1  ON 6
ci_08                -3.497659e-03 3 1  ON 7
ci_09                -1.105589e-02 3 1  ON 8
ci_10                -1.059180e-02 3 1  ON 9
ci_11                 1.649253e-02 3 1  ON 10
ci_12                 1.060615e-02 3 1  ON 11
ci_13                 1.184413e-02 3 1  ON 12
ci_14                 1.791661e-02 3 1  ON 13
ci_15                 7.393555e-03 3 1  ON 14
ci_16                 7.710899e-03 3 1  ON 15
ci_17                -9.226432e-03 3 1  ON 16
ci_18                -9.375935e-03 3 1  ON 17
ci_19                 9.927690e-03 3 1  ON 18
ci_20                 1.080967e-02 3 1  ON 19
ci_21                 8.104582e-03 3 1  ON 20
ci_22                 8.629494e-03 3 1  ON 21
ci_23                 6.572392e-03 3 1  ON 22
ci_24                 7.492692e-03 3 1  ON 23
ci_25                 5.247263e-03 3 1  ON 24
ci_26                 3.065009e-03 3 1  ON 25
ci_27                 2.448213e-03 3 1  ON 26
ci_28                 2.887946e-03 3 1  ON 27
ci_29                 2.899960e-03 3 1  ON 28
ci_30                 8.233823e-04 3 1  ON 29
ci_31                 7.414136e-04 3 1  ON 30
ci_32                 3.207502e-04 3 1  ON 31
ci_33                 1.892570e-04 3 1  ON 32
ci_34                -3.992249e-04 3 1  ON 33
ci_35                 2.131382e-04 3 1  ON 34
ci_36                -3.256391e-04 3 1  ON 35
ci_37                -4.103569e-04 3 1  ON 36
ci_38                -1.339232e-04 3 1  ON 37
ci_39                -7.075063e-05 3 1  ON 38
ci_40                -1.206717e-03 3 1  ON 39
ci_41                -1.917912e-04 3 1  ON 40
ci_42                -2.430052e-04 3 1  ON 41
ci_43                -2.389209e-03 3 1  ON 42
ci_44                -2.310104e-03 3 1  ON 43
ci_45                -3.959989e-06 3 1  ON 44
ci_46                 6.729470e-05 3 1  ON 45
ci_47                -9.562339e-05 3 1  ON 46
ci_48                 2.359790e-04 3 1  ON 47
ci_49                -1.274479e-03 3 1  ON 48
ci_50                -5.641345e-04 3 1  ON 49
ci_51                 8.833960e-05 3 1  ON 50
ci_52                 8.062362e-05 3 1  ON 51
ci_53                -1.109562e-03 3 1  ON 52
ci_54                -8.028735e-04 3 1  ON 53
ci_55                -7.886413e-04 3 1  ON 54
ci_56                 1.600456e-03 3 1  ON 55
ci_57                 1.653562e-03 3 1  ON 56
ci_58                -1.096571e-03 3 1  ON 57
ci_59                -1.507096e-03 3 1  ON 58
ci_60                 1.574276e-03 3 1  ON 59
ci_61                 2.240484e-03 3 1  ON 60
ci_62                -3.455631e-04 3 1  ON 61
ci_63                -3.410811e-04 3 1  ON 62
ci_64                -3.956293e-04 3 1  ON 63
ci_65                -5.587018e-04 3 1  ON 64
ci_66                -5.973480e-04 3 1  ON 65
ci_67                -3.358442e-04 3 1  ON 66
ci_68                -1.408412e-03 3 1  ON 67
ci_69                -1.752383e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7381
    reference variance = 0.985502
====================================================
  Execution time = 9.9790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0226e-01
  Total weights = 7.8566e+06
  Execution time = 1.4529e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018580866
                                         uncertainty =       0.001202414017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018580866
                                         uncertainty =       0.001202414017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246480838
  error estimate for blocks of size 2^( 2) =       0.000255652257
  error estimate for blocks of size 2^( 3) =       0.000263932693
  error estimate for blocks of size 2^( 4) =       0.000269951923
  error estimate for blocks of size 2^( 5) =       0.000273446303
  error estimate for blocks of size 2^( 6) =       0.000275452245
  error estimate for blocks of size 2^( 7) =       0.000276628452
  error estimate for blocks of size 2^( 8) =       0.000276472869
  error estimate for blocks of size 2^( 9) =       0.000278501429

      target function =                  N/A
              le_mean =     -22.824326178692
             les_mean =     521.452125959192
             stat err =       0.000276763749
             autocorr =       1.260817088029
              std dev =       0.697153087117
             le_variance =       0.486022426877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018583973
                                         uncertainty =       0.001202414906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018583973
                                         uncertainty =       0.001202414906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246480839
  error estimate for blocks of size 2^( 2) =       0.000255652258
  error estimate for blocks of size 2^( 3) =       0.000263932695
  error estimate for blocks of size 2^( 4) =       0.000269951925
  error estimate for blocks of size 2^( 5) =       0.000273446304
  error estimate for blocks of size 2^( 6) =       0.000275452246
  error estimate for blocks of size 2^( 7) =       0.000276628452
  error estimate for blocks of size 2^( 8) =       0.000276472870
  error estimate for blocks of size 2^( 9) =       0.000278501430

      target function =                  N/A
              le_mean =     -22.824326178726
             les_mean =     521.452125961883
             stat err =       0.000276763749
             autocorr =       1.260817084945
              std dev =       0.697153089344
             le_variance =       0.486022429982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018582419
                                         uncertainty =       0.001202414461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018582419
                                         uncertainty =       0.001202414461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246480838
  error estimate for blocks of size 2^( 2) =       0.000255652257
  error estimate for blocks of size 2^( 3) =       0.000263932694
  error estimate for blocks of size 2^( 4) =       0.000269951924
  error estimate for blocks of size 2^( 5) =       0.000273446304
  error estimate for blocks of size 2^( 6) =       0.000275452246
  error estimate for blocks of size 2^( 7) =       0.000276628452
  error estimate for blocks of size 2^( 8) =       0.000276472870
  error estimate for blocks of size 2^( 9) =       0.000278501429

      target function =                  N/A
              le_mean =     -22.824326178709
             les_mean =     521.452125960366
             stat err =       0.000276763749
             autocorr =       1.260817086502
              std dev =       0.697153088230
             le_variance =       0.486022428429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018581060
                                         uncertainty =       0.001202414072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486018581060
                                         uncertainty =       0.001202414072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246480838
  error estimate for blocks of size 2^( 2) =       0.000255652257
  error estimate for blocks of size 2^( 3) =       0.000263932693
  error estimate for blocks of size 2^( 4) =       0.000269951923
  error estimate for blocks of size 2^( 5) =       0.000273446303
  error estimate for blocks of size 2^( 6) =       0.000275452245
  error estimate for blocks of size 2^( 7) =       0.000276628452
  error estimate for blocks of size 2^( 8) =       0.000276472869
  error estimate for blocks of size 2^( 9) =       0.000278501429

      target function =                  N/A
              le_mean =     -22.824326178694
             les_mean =     521.452125959320
             stat err =       0.000276763749
             autocorr =       1.260817087846
              std dev =       0.697153087257
             le_variance =       0.486022427071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824326178692        initial
     2.2737e+03     2.2737e+04             1.5687e-07       -22.824326178726  <--
     9.0949e+03     9.0949e+04             3.9221e-08       -22.824326178709
     3.6380e+04     3.6380e+05             9.8054e-09       -22.824326178694

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 1.7263e+02
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197129e-02 3 1  ON 1
ci_03                -2.173082e-02 3 1  ON 2
ci_04                 2.182733e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585377e-02 3 1  ON 6
ci_08                -3.497610e-03 3 1  ON 7
ci_09                -1.105591e-02 3 1  ON 8
ci_10                -1.059184e-02 3 1  ON 9
ci_11                 1.649249e-02 3 1  ON 10
ci_12                 1.060616e-02 3 1  ON 11
ci_13                 1.184412e-02 3 1  ON 12
ci_14                 1.791657e-02 3 1  ON 13
ci_15                 7.393547e-03 3 1  ON 14
ci_16                 7.710886e-03 3 1  ON 15
ci_17                -9.226480e-03 3 1  ON 16
ci_18                -9.375947e-03 3 1  ON 17
ci_19                 9.927665e-03 3 1  ON 18
ci_20                 1.080965e-02 3 1  ON 19
ci_21                 8.104590e-03 3 1  ON 20
ci_22                 8.629531e-03 3 1  ON 21
ci_23                 6.572385e-03 3 1  ON 22
ci_24                 7.492672e-03 3 1  ON 23
ci_25                 5.247253e-03 3 1  ON 24
ci_26                 3.064989e-03 3 1  ON 25
ci_27                 2.448236e-03 3 1  ON 26
ci_28                 2.887972e-03 3 1  ON 27
ci_29                 2.899932e-03 3 1  ON 28
ci_30                 8.233656e-04 3 1  ON 29
ci_31                 7.413791e-04 3 1  ON 30
ci_32                 3.207393e-04 3 1  ON 31
ci_33                 1.892510e-04 3 1  ON 32
ci_34                -3.992154e-04 3 1  ON 33
ci_35                 2.131256e-04 3 1  ON 34
ci_36                -3.256546e-04 3 1  ON 35
ci_37                -4.103925e-04 3 1  ON 36
ci_38                -1.339810e-04 3 1  ON 37
ci_39                -7.076650e-05 3 1  ON 38
ci_40                -1.206685e-03 3 1  ON 39
ci_41                -1.917932e-04 3 1  ON 40
ci_42                -2.430029e-04 3 1  ON 41
ci_43                -2.389219e-03 3 1  ON 42
ci_44                -2.310112e-03 3 1  ON 43
ci_45                -3.983026e-06 3 1  ON 44
ci_46                 6.717705e-05 3 1  ON 45
ci_47                -9.560140e-05 3 1  ON 46
ci_48                 2.360039e-04 3 1  ON 47
ci_49                -1.274455e-03 3 1  ON 48
ci_50                -5.641055e-04 3 1  ON 49
ci_51                 8.839514e-05 3 1  ON 50
ci_52                 8.061221e-05 3 1  ON 51
ci_53                -1.109512e-03 3 1  ON 52
ci_54                -8.028645e-04 3 1  ON 53
ci_55                -7.886708e-04 3 1  ON 54
ci_56                 1.600412e-03 3 1  ON 55
ci_57                 1.653598e-03 3 1  ON 56
ci_58                -1.096593e-03 3 1  ON 57
ci_59                -1.507055e-03 3 1  ON 58
ci_60                 1.574316e-03 3 1  ON 59
ci_61                 2.240441e-03 3 1  ON 60
ci_62                -3.455740e-04 3 1  ON 61
ci_63                -3.410598e-04 3 1  ON 62
ci_64                -3.956232e-04 3 1  ON 63
ci_65                -5.587096e-04 3 1  ON 64
ci_66                -5.973033e-04 3 1  ON 65
ci_67                -3.357983e-04 3 1  ON 66
ci_68                -1.408431e-03 3 1  ON 67
ci_69                -1.752385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9144e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8864
    reference variance = 0.307067
====================================================
  Execution time = 1.0060e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1395e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0121e-01
  Total weights = 7.856556688e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8549e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486230088526
                                         uncertainty =       0.001541586773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486230088526
                                         uncertainty =       0.001541586773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246534594
  error estimate for blocks of size 2^( 2) =       0.000255679488
  error estimate for blocks of size 2^( 3) =       0.000263765713
  error estimate for blocks of size 2^( 4) =       0.000269645005
  error estimate for blocks of size 2^( 5) =       0.000273237682
  error estimate for blocks of size 2^( 6) =       0.000275303638
  error estimate for blocks of size 2^( 7) =       0.000275869742
  error estimate for blocks of size 2^( 8) =       0.000276461527
  error estimate for blocks of size 2^( 9) =       0.000276454154

      target function =                  N/A
              le_mean =     -22.824831420419
             les_mean =     521.474137724279
             stat err =       0.000276022265
             autocorr =       1.253523536290
              std dev =       0.697305133632
             le_variance =       0.486234449390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282483142042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824831420415       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824831420349       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824831420433       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824831420421       residual = 4.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 3.304575e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824831420415       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824831420398       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824831420419       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824831420419       residual = 4.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 8.264662e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824831420415       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824831420411       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824831420416       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824831420415       residual = 4.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 2.066367e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111091 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1916e+02
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197128e-02 3 1  ON 1
ci_03                -2.173080e-02 3 1  ON 2
ci_04                 2.182730e-02 3 1  ON 3
ci_05                -2.150473e-02 3 1  ON 4
ci_06                -2.163001e-02 3 1  ON 5
ci_07                 2.585372e-02 3 1  ON 6
ci_08                -3.497615e-03 3 1  ON 7
ci_09                -1.105592e-02 3 1  ON 8
ci_10                -1.059188e-02 3 1  ON 9
ci_11                 1.649245e-02 3 1  ON 10
ci_12                 1.060621e-02 3 1  ON 11
ci_13                 1.184410e-02 3 1  ON 12
ci_14                 1.791655e-02 3 1  ON 13
ci_15                 7.393541e-03 3 1  ON 14
ci_16                 7.710911e-03 3 1  ON 15
ci_17                -9.226449e-03 3 1  ON 16
ci_18                -9.375926e-03 3 1  ON 17
ci_19                 9.927604e-03 3 1  ON 18
ci_20                 1.080964e-02 3 1  ON 19
ci_21                 8.104598e-03 3 1  ON 20
ci_22                 8.629489e-03 3 1  ON 21
ci_23                 6.572335e-03 3 1  ON 22
ci_24                 7.492659e-03 3 1  ON 23
ci_25                 5.247199e-03 3 1  ON 24
ci_26                 3.064936e-03 3 1  ON 25
ci_27                 2.448314e-03 3 1  ON 26
ci_28                 2.888013e-03 3 1  ON 27
ci_29                 2.899947e-03 3 1  ON 28
ci_30                 8.233398e-04 3 1  ON 29
ci_31                 7.413684e-04 3 1  ON 30
ci_32                 3.207552e-04 3 1  ON 31
ci_33                 1.892637e-04 3 1  ON 32
ci_34                -3.991716e-04 3 1  ON 33
ci_35                 2.131553e-04 3 1  ON 34
ci_36                -3.257372e-04 3 1  ON 35
ci_37                -4.104331e-04 3 1  ON 36
ci_38                -1.339843e-04 3 1  ON 37
ci_39                -7.078347e-05 3 1  ON 38
ci_40                -1.206675e-03 3 1  ON 39
ci_41                -1.917786e-04 3 1  ON 40
ci_42                -2.429787e-04 3 1  ON 41
ci_43                -2.389241e-03 3 1  ON 42
ci_44                -2.310137e-03 3 1  ON 43
ci_45                -3.981857e-06 3 1  ON 44
ci_46                 6.715796e-05 3 1  ON 45
ci_47                -9.567152e-05 3 1  ON 46
ci_48                 2.359851e-04 3 1  ON 47
ci_49                -1.274430e-03 3 1  ON 48
ci_50                -5.641315e-04 3 1  ON 49
ci_51                 8.839482e-05 3 1  ON 50
ci_52                 8.060606e-05 3 1  ON 51
ci_53                -1.109526e-03 3 1  ON 52
ci_54                -8.028810e-04 3 1  ON 53
ci_55                -7.886678e-04 3 1  ON 54
ci_56                 1.600433e-03 3 1  ON 55
ci_57                 1.653592e-03 3 1  ON 56
ci_58                -1.096675e-03 3 1  ON 57
ci_59                -1.507076e-03 3 1  ON 58
ci_60                 1.574316e-03 3 1  ON 59
ci_61                 2.240475e-03 3 1  ON 60
ci_62                -3.455740e-04 3 1  ON 61
ci_63                -3.410022e-04 3 1  ON 62
ci_64                -3.956456e-04 3 1  ON 63
ci_65                -5.586760e-04 3 1  ON 64
ci_66                -5.973059e-04 3 1  ON 65
ci_67                -3.357791e-04 3 1  ON 66
ci_68                -1.408437e-03 3 1  ON 67
ci_69                -1.752362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.9131
    reference variance = 0.380847
====================================================
  Execution time = 9.9603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0111e-01
  Total weights = 7.8564e+06
  Execution time = 1.4510e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154002393
                                         uncertainty =       0.001300976392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154002393
                                         uncertainty =       0.001300976392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246514944
  error estimate for blocks of size 2^( 2) =       0.000255602312
  error estimate for blocks of size 2^( 3) =       0.000263942772
  error estimate for blocks of size 2^( 4) =       0.000270076020
  error estimate for blocks of size 2^( 5) =       0.000273733493
  error estimate for blocks of size 2^( 6) =       0.000275402557
  error estimate for blocks of size 2^( 7) =       0.000276842685
  error estimate for blocks of size 2^( 8) =       0.000278316863
  error estimate for blocks of size 2^( 9) =       0.000278730856

      target function =                  N/A
              le_mean =     -22.824609604344
             les_mean =     521.463906763466
             stat err =       0.000277323240
             autocorr =       1.265569579527
              std dev =       0.697249555547
             le_variance =       0.486156942711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154012184
                                         uncertainty =       0.001300979547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154012184
                                         uncertainty =       0.001300979547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246514947
  error estimate for blocks of size 2^( 2) =       0.000255602316
  error estimate for blocks of size 2^( 3) =       0.000263942778
  error estimate for blocks of size 2^( 4) =       0.000270076027
  error estimate for blocks of size 2^( 5) =       0.000273733500
  error estimate for blocks of size 2^( 6) =       0.000275402565
  error estimate for blocks of size 2^( 7) =       0.000276842696
  error estimate for blocks of size 2^( 8) =       0.000278316877
  error estimate for blocks of size 2^( 9) =       0.000278730866

      target function =                  N/A
              le_mean =     -22.824609602964
             les_mean =     521.463918522112
             stat err =       0.000277323251
             autocorr =       1.265569648772
              std dev =       0.697249562575
             le_variance =       0.486156952512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154007285
                                         uncertainty =       0.001300977970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154007285
                                         uncertainty =       0.001300977970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246514946
  error estimate for blocks of size 2^( 2) =       0.000255602314
  error estimate for blocks of size 2^( 3) =       0.000263942775
  error estimate for blocks of size 2^( 4) =       0.000270076023
  error estimate for blocks of size 2^( 5) =       0.000273733497
  error estimate for blocks of size 2^( 6) =       0.000275402561
  error estimate for blocks of size 2^( 7) =       0.000276842691
  error estimate for blocks of size 2^( 8) =       0.000278316870
  error estimate for blocks of size 2^( 9) =       0.000278730861

      target function =                  N/A
              le_mean =     -22.824609603655
             les_mean =     521.463912160857
             stat err =       0.000277323246
             autocorr =       1.265569614118
              std dev =       0.697249559059
             le_variance =       0.486156947608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154003004
                                         uncertainty =       0.001300976590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.486154003004
                                         uncertainty =       0.001300976590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246514945
  error estimate for blocks of size 2^( 2) =       0.000255602312
  error estimate for blocks of size 2^( 3) =       0.000263942773
  error estimate for blocks of size 2^( 4) =       0.000270076020
  error estimate for blocks of size 2^( 5) =       0.000273733493
  error estimate for blocks of size 2^( 6) =       0.000275402558
  error estimate for blocks of size 2^( 7) =       0.000276842686
  error estimate for blocks of size 2^( 8) =       0.000278316864
  error estimate for blocks of size 2^( 9) =       0.000278730857

      target function =                  N/A
              le_mean =     -22.824609604258
             les_mean =     521.463907391723
             stat err =       0.000277323241
             autocorr =       1.265569583849
              std dev =       0.697249555986
             le_variance =       0.486156943322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824609604344        initial  <--
     5.6843e+02     5.6843e+03             3.3046e-07       -22.824609602964
     2.2737e+03     2.2737e+04             8.2647e-08       -22.824609603655
     9.0949e+03     9.0949e+04             2.0664e-08       -22.824609604258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 175.1807
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197129e-02 3 1  ON 1
ci_03                -2.173082e-02 3 1  ON 2
ci_04                 2.182733e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585377e-02 3 1  ON 6
ci_08                -3.497610e-03 3 1  ON 7
ci_09                -1.105591e-02 3 1  ON 8
ci_10                -1.059184e-02 3 1  ON 9
ci_11                 1.649249e-02 3 1  ON 10
ci_12                 1.060616e-02 3 1  ON 11
ci_13                 1.184412e-02 3 1  ON 12
ci_14                 1.791657e-02 3 1  ON 13
ci_15                 7.393547e-03 3 1  ON 14
ci_16                 7.710886e-03 3 1  ON 15
ci_17                -9.226480e-03 3 1  ON 16
ci_18                -9.375947e-03 3 1  ON 17
ci_19                 9.927665e-03 3 1  ON 18
ci_20                 1.080965e-02 3 1  ON 19
ci_21                 8.104590e-03 3 1  ON 20
ci_22                 8.629531e-03 3 1  ON 21
ci_23                 6.572385e-03 3 1  ON 22
ci_24                 7.492672e-03 3 1  ON 23
ci_25                 5.247253e-03 3 1  ON 24
ci_26                 3.064989e-03 3 1  ON 25
ci_27                 2.448236e-03 3 1  ON 26
ci_28                 2.887972e-03 3 1  ON 27
ci_29                 2.899932e-03 3 1  ON 28
ci_30                 8.233656e-04 3 1  ON 29
ci_31                 7.413791e-04 3 1  ON 30
ci_32                 3.207393e-04 3 1  ON 31
ci_33                 1.892510e-04 3 1  ON 32
ci_34                -3.992154e-04 3 1  ON 33
ci_35                 2.131256e-04 3 1  ON 34
ci_36                -3.256546e-04 3 1  ON 35
ci_37                -4.103925e-04 3 1  ON 36
ci_38                -1.339810e-04 3 1  ON 37
ci_39                -7.076650e-05 3 1  ON 38
ci_40                -1.206685e-03 3 1  ON 39
ci_41                -1.917932e-04 3 1  ON 40
ci_42                -2.430029e-04 3 1  ON 41
ci_43                -2.389219e-03 3 1  ON 42
ci_44                -2.310112e-03 3 1  ON 43
ci_45                -3.983026e-06 3 1  ON 44
ci_46                 6.717705e-05 3 1  ON 45
ci_47                -9.560140e-05 3 1  ON 46
ci_48                 2.360039e-04 3 1  ON 47
ci_49                -1.274455e-03 3 1  ON 48
ci_50                -5.641055e-04 3 1  ON 49
ci_51                 8.839514e-05 3 1  ON 50
ci_52                 8.061221e-05 3 1  ON 51
ci_53                -1.109512e-03 3 1  ON 52
ci_54                -8.028645e-04 3 1  ON 53
ci_55                -7.886708e-04 3 1  ON 54
ci_56                 1.600412e-03 3 1  ON 55
ci_57                 1.653598e-03 3 1  ON 56
ci_58                -1.096593e-03 3 1  ON 57
ci_59                -1.507055e-03 3 1  ON 58
ci_60                 1.574316e-03 3 1  ON 59
ci_61                 2.240441e-03 3 1  ON 60
ci_62                -3.455740e-04 3 1  ON 61
ci_63                -3.410598e-04 3 1  ON 62
ci_64                -3.956232e-04 3 1  ON 63
ci_65                -5.587096e-04 3 1  ON 64
ci_66                -5.973033e-04 3 1  ON 65
ci_67                -3.357983e-04 3 1  ON 66
ci_68                -1.408431e-03 3 1  ON 67
ci_69                -1.752385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9435e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 250
  steps          = 250
  substeps       = 10
  current        = 0
  target samples = 8.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">250</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">6.2500e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">8.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">6.2500e+04</parameter>
<parameter name="steps" condition="int">250</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7402
    reference variance = 0.308818
====================================================
  Execution time = 1.0037e+02
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 6.1350e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0441e-01
  Total weights = 7.857323695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.8533e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485677784261
                                         uncertainty =       0.001366920504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485677784261
                                         uncertainty =       0.001366920504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246392886
  error estimate for blocks of size 2^( 2) =       0.000255657168
  error estimate for blocks of size 2^( 3) =       0.000263919644
  error estimate for blocks of size 2^( 4) =       0.000269623693
  error estimate for blocks of size 2^( 5) =       0.000273194735
  error estimate for blocks of size 2^( 6) =       0.000275256318
  error estimate for blocks of size 2^( 7) =       0.000276118564
  error estimate for blocks of size 2^( 8) =       0.000275150798
  error estimate for blocks of size 2^( 9) =       0.000274139727

      target function =                  N/A
              le_mean =     -22.824523596156
             les_mean =     521.463283270921
             stat err =       0.000275166352
             autocorr =       1.247194888953
              std dev =       0.696904322506
             le_variance =       0.485675634727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282452359616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824523596154       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824523596227       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824523596258       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824523596253       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+03 is 4.668493e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824523596154       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824523596172       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824523596180       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824523596178       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+04 is 1.167149e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824523596154       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824523596158       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824523596160       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824523596160       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+04 is 2.917889e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112449 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.1892e+02
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197129e-02 3 1  ON 1
ci_03                -2.173082e-02 3 1  ON 2
ci_04                 2.182733e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163003e-02 3 1  ON 5
ci_07                 2.585375e-02 3 1  ON 6
ci_08                -3.497610e-03 3 1  ON 7
ci_09                -1.105591e-02 3 1  ON 8
ci_10                -1.059183e-02 3 1  ON 9
ci_11                 1.649248e-02 3 1  ON 10
ci_12                 1.060616e-02 3 1  ON 11
ci_13                 1.184412e-02 3 1  ON 12
ci_14                 1.791656e-02 3 1  ON 13
ci_15                 7.393554e-03 3 1  ON 14
ci_16                 7.710880e-03 3 1  ON 15
ci_17                -9.226484e-03 3 1  ON 16
ci_18                -9.375940e-03 3 1  ON 17
ci_19                 9.927655e-03 3 1  ON 18
ci_20                 1.080964e-02 3 1  ON 19
ci_21                 8.104585e-03 3 1  ON 20
ci_22                 8.629527e-03 3 1  ON 21
ci_23                 6.572380e-03 3 1  ON 22
ci_24                 7.492671e-03 3 1  ON 23
ci_25                 5.247252e-03 3 1  ON 24
ci_26                 3.064983e-03 3 1  ON 25
ci_27                 2.448238e-03 3 1  ON 26
ci_28                 2.887974e-03 3 1  ON 27
ci_29                 2.899930e-03 3 1  ON 28
ci_30                 8.233630e-04 3 1  ON 29
ci_31                 7.413736e-04 3 1  ON 30
ci_32                 3.207346e-04 3 1  ON 31
ci_33                 1.892452e-04 3 1  ON 32
ci_34                -3.992102e-04 3 1  ON 33
ci_35                 2.131167e-04 3 1  ON 34
ci_36                -3.256602e-04 3 1  ON 35
ci_37                -4.103868e-04 3 1  ON 36
ci_38                -1.339835e-04 3 1  ON 37
ci_39                -7.077006e-05 3 1  ON 38
ci_40                -1.206683e-03 3 1  ON 39
ci_41                -1.917907e-04 3 1  ON 40
ci_42                -2.430032e-04 3 1  ON 41
ci_43                -2.389223e-03 3 1  ON 42
ci_44                -2.310111e-03 3 1  ON 43
ci_45                -3.984017e-06 3 1  ON 44
ci_46                 6.717082e-05 3 1  ON 45
ci_47                -9.559994e-05 3 1  ON 46
ci_48                 2.360086e-04 3 1  ON 47
ci_49                -1.274458e-03 3 1  ON 48
ci_50                -5.641136e-04 3 1  ON 49
ci_51                 8.839162e-05 3 1  ON 50
ci_52                 8.061217e-05 3 1  ON 51
ci_53                -1.109508e-03 3 1  ON 52
ci_54                -8.028631e-04 3 1  ON 53
ci_55                -7.886713e-04 3 1  ON 54
ci_56                 1.600412e-03 3 1  ON 55
ci_57                 1.653597e-03 3 1  ON 56
ci_58                -1.096601e-03 3 1  ON 57
ci_59                -1.507056e-03 3 1  ON 58
ci_60                 1.574319e-03 3 1  ON 59
ci_61                 2.240439e-03 3 1  ON 60
ci_62                -3.455715e-04 3 1  ON 61
ci_63                -3.410622e-04 3 1  ON 62
ci_64                -3.956235e-04 3 1  ON 63
ci_65                -5.587075e-04 3 1  ON 64
ci_66                -5.973017e-04 3 1  ON 65
ci_67                -3.357996e-04 3 1  ON 66
ci_68                -1.408430e-03 3 1  ON 67
ci_69                -1.752376e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="250">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =8000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8422
    reference variance = 0.385239
====================================================
  Execution time = 9.9177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 62500 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9968e-01
  Total weights = 7.8561e+06
  Execution time = 1.4553e+01
  </log>
</opt>
<opt stage="main" walkers="62500">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184345686
                                         uncertainty =       0.001050684391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184345686
                                         uncertainty =       0.001050684391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246015354
  error estimate for blocks of size 2^( 2) =       0.000255230096
  error estimate for blocks of size 2^( 3) =       0.000263722233
  error estimate for blocks of size 2^( 4) =       0.000269771651
  error estimate for blocks of size 2^( 5) =       0.000273154220
  error estimate for blocks of size 2^( 6) =       0.000275214237
  error estimate for blocks of size 2^( 7) =       0.000276844452
  error estimate for blocks of size 2^( 8) =       0.000278456980
  error estimate for blocks of size 2^( 9) =       0.000279721268

      target function =                  N/A
              le_mean =     -22.824218119813
             les_mean =     521.444616733975
             stat err =       0.000277559234
             autocorr =       1.272878460823
              std dev =       0.695836499581
             le_variance =       0.484188434149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184342388
                                         uncertainty =       0.001050684370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184342388
                                         uncertainty =       0.001050684370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246015353
  error estimate for blocks of size 2^( 2) =       0.000255230096
  error estimate for blocks of size 2^( 3) =       0.000263722233
  error estimate for blocks of size 2^( 4) =       0.000269771651
  error estimate for blocks of size 2^( 5) =       0.000273154220
  error estimate for blocks of size 2^( 6) =       0.000275214237
  error estimate for blocks of size 2^( 7) =       0.000276844452
  error estimate for blocks of size 2^( 8) =       0.000278456980
  error estimate for blocks of size 2^( 9) =       0.000279721268

      target function =                  N/A
              le_mean =     -22.824218119698
             les_mean =     521.444616702562
             stat err =       0.000277559234
             autocorr =       1.272878466427
              std dev =       0.695836497209
             le_variance =       0.484188430848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184344037
                                         uncertainty =       0.001050684381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184344037
                                         uncertainty =       0.001050684381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246015353
  error estimate for blocks of size 2^( 2) =       0.000255230096
  error estimate for blocks of size 2^( 3) =       0.000263722233
  error estimate for blocks of size 2^( 4) =       0.000269771651
  error estimate for blocks of size 2^( 5) =       0.000273154220
  error estimate for blocks of size 2^( 6) =       0.000275214237
  error estimate for blocks of size 2^( 7) =       0.000276844452
  error estimate for blocks of size 2^( 8) =       0.000278456980
  error estimate for blocks of size 2^( 9) =       0.000279721268

      target function =                  N/A
              le_mean =     -22.824218119755
             les_mean =     521.444616718138
             stat err =       0.000277559234
             autocorr =       1.272878463640
              std dev =       0.695836498395
             le_variance =       0.484188432498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184345480
                                         uncertainty =       0.001050684390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484184345480
                                         uncertainty =       0.001050684390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000246015354
  error estimate for blocks of size 2^( 2) =       0.000255230096
  error estimate for blocks of size 2^( 3) =       0.000263722233
  error estimate for blocks of size 2^( 4) =       0.000269771651
  error estimate for blocks of size 2^( 5) =       0.000273154220
  error estimate for blocks of size 2^( 6) =       0.000275214237
  error estimate for blocks of size 2^( 7) =       0.000276844452
  error estimate for blocks of size 2^( 8) =       0.000278456980
  error estimate for blocks of size 2^( 9) =       0.000279721268

      target function =                  N/A
              le_mean =     -22.824218119806
             les_mean =     521.444616731981
             stat err =       0.000277559234
             autocorr =       1.272878461133
              std dev =       0.695836499433
             le_variance =       0.484188433943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824218119813        initial  <--
     5.6843e+03     5.6843e+04             4.6685e-08       -22.824218119698
     2.2737e+04     2.2737e+05             1.1671e-08       -22.824218119755
     9.0949e+04     9.0949e+05             2.9179e-09       -22.824218119806

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 172.0360
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_01                 1.085382e-01 3 1  ON 0
ci_02                -2.197129e-02 3 1  ON 1
ci_03                -2.173082e-02 3 1  ON 2
ci_04                 2.182733e-02 3 1  ON 3
ci_05                -2.150471e-02 3 1  ON 4
ci_06                -2.163004e-02 3 1  ON 5
ci_07                 2.585377e-02 3 1  ON 6
ci_08                -3.497610e-03 3 1  ON 7
ci_09                -1.105591e-02 3 1  ON 8
ci_10                -1.059184e-02 3 1  ON 9
ci_11                 1.649249e-02 3 1  ON 10
ci_12                 1.060616e-02 3 1  ON 11
ci_13                 1.184412e-02 3 1  ON 12
ci_14                 1.791657e-02 3 1  ON 13
ci_15                 7.393547e-03 3 1  ON 14
ci_16                 7.710886e-03 3 1  ON 15
ci_17                -9.226480e-03 3 1  ON 16
ci_18                -9.375947e-03 3 1  ON 17
ci_19                 9.927665e-03 3 1  ON 18
ci_20                 1.080965e-02 3 1  ON 19
ci_21                 8.104590e-03 3 1  ON 20
ci_22                 8.629531e-03 3 1  ON 21
ci_23                 6.572385e-03 3 1  ON 22
ci_24                 7.492672e-03 3 1  ON 23
ci_25                 5.247253e-03 3 1  ON 24
ci_26                 3.064989e-03 3 1  ON 25
ci_27                 2.448236e-03 3 1  ON 26
ci_28                 2.887972e-03 3 1  ON 27
ci_29                 2.899932e-03 3 1  ON 28
ci_30                 8.233656e-04 3 1  ON 29
ci_31                 7.413791e-04 3 1  ON 30
ci_32                 3.207393e-04 3 1  ON 31
ci_33                 1.892510e-04 3 1  ON 32
ci_34                -3.992154e-04 3 1  ON 33
ci_35                 2.131256e-04 3 1  ON 34
ci_36                -3.256546e-04 3 1  ON 35
ci_37                -4.103925e-04 3 1  ON 36
ci_38                -1.339810e-04 3 1  ON 37
ci_39                -7.076650e-05 3 1  ON 38
ci_40                -1.206685e-03 3 1  ON 39
ci_41                -1.917932e-04 3 1  ON 40
ci_42                -2.430029e-04 3 1  ON 41
ci_43                -2.389219e-03 3 1  ON 42
ci_44                -2.310112e-03 3 1  ON 43
ci_45                -3.983026e-06 3 1  ON 44
ci_46                 6.717705e-05 3 1  ON 45
ci_47                -9.560140e-05 3 1  ON 46
ci_48                 2.360039e-04 3 1  ON 47
ci_49                -1.274455e-03 3 1  ON 48
ci_50                -5.641055e-04 3 1  ON 49
ci_51                 8.839514e-05 3 1  ON 50
ci_52                 8.061221e-05 3 1  ON 51
ci_53                -1.109512e-03 3 1  ON 52
ci_54                -8.028645e-04 3 1  ON 53
ci_55                -7.886708e-04 3 1  ON 54
ci_56                 1.600412e-03 3 1  ON 55
ci_57                 1.653598e-03 3 1  ON 56
ci_58                -1.096593e-03 3 1  ON 57
ci_59                -1.507055e-03 3 1  ON 58
ci_60                 1.574316e-03 3 1  ON 59
ci_61                 2.240441e-03 3 1  ON 60
ci_62                -3.455740e-04 3 1  ON 61
ci_63                -3.410598e-04 3 1  ON 62
ci_64                -3.956232e-04 3 1  ON 63
ci_65                -5.587096e-04 3 1  ON 64
ci_66                -5.973033e-04 3 1  ON 65
ci_67                -3.357983e-04 3 1  ON 66
ci_68                -1.408431e-03 3 1  ON 67
ci_69                -1.752385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 2.9096e+02 secs
  Total Execution time = 1.7597e+04 secs

=========================================================
  A new xml input file : FORM.s059.cont.xml
