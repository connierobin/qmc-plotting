Rank =    0  Free Memory = 88654 MB
Rank =    1  Free Memory = 88654 MB
Rank =    2  Free Memory = 88654 MB
Rank =    3  Free Memory = 88654 MB
Rank =    4  Free Memory = 88654 MB
Rank =    5  Free Memory = 88654 MB
Rank =    6  Free Memory = 88654 MB
Rank =    7  Free Memory = 88654 MB
Rank =    8  Free Memory = 88654 MB
Rank =    9  Free Memory = 88654 MB
Rank =   10  Free Memory = 88654 MB
Rank =   11  Free Memory = 88654 MB
Rank =   12  Free Memory = 88654 MB
Rank =   13  Free Memory = 88654 MB
Rank =   14  Free Memory = 88654 MB
Rank =   15  Free Memory = 88639 MB
Rank =   16  Free Memory = 88639 MB
Rank =   17  Free Memory = 88639 MB
Rank =   18  Free Memory = 88638 MB
Rank =   19  Free Memory = 88638 MB
Rank =   20  Free Memory = 88638 MB
Rank =   21  Free Memory = 88638 MB
Rank =   22  Free Memory = 88638 MB
Rank =   23  Free Memory = 88638 MB
Rank =   24  Free Memory = 88638 MB
Rank =   25  Free Memory = 88638 MB
Rank =   26  Free Memory = 88638 MB
Rank =   27  Free Memory = 88638 MB
Rank =   28  Free Memory = 88638 MB
Rank =   29  Free Memory = 88638 MB
Rank =   30  Free Memory = 88638 MB
Rank =   31  Free Memory = 88638 MB
Rank =   32  Free Memory = 89167 MB
Rank =   33  Free Memory = 89166 MB
Rank =   34  Free Memory = 89166 MB
Rank =   35  Free Memory = 89166 MB
Rank =   36  Free Memory = 89166 MB
Rank =   37  Free Memory = 89166 MB
Rank =   38  Free Memory = 89166 MB
Rank =   39  Free Memory = 89166 MB
Rank =   40  Free Memory = 89166 MB
Rank =   41  Free Memory = 89166 MB
Rank =   42  Free Memory = 89166 MB
Rank =   43  Free Memory = 89166 MB
Rank =   44  Free Memory = 89166 MB
Rank =   45  Free Memory = 89166 MB
Rank =   46  Free Memory = 89166 MB
Rank =   47  Free Memory = 89166 MB
Rank =   48  Free Memory = 89166 MB
Rank =   49  Free Memory = 89166 MB
Rank =   50  Free Memory = 89166 MB
Rank =   51  Free Memory = 89166 MB
Rank =   52  Free Memory = 89166 MB
Rank =   53  Free Memory = 89166 MB
Rank =   54  Free Memory = 89166 MB
Rank =   55  Free Memory = 89166 MB
Rank =   56  Free Memory = 89166 MB
Rank =   57  Free Memory = 89166 MB
Rank =   58  Free Memory = 89166 MB
Rank =   59  Free Memory = 89166 MB
Rank =   60  Free Memory = 89166 MB
Rank =   61  Free Memory = 89166 MB
Rank =   62  Free Memory = 89166 MB
Rank =   63  Free Memory = 89166 MB
Rank =   64  Free Memory = 77913 MB
Rank =   65  Free Memory = 77913 MB
Rank =   66  Free Memory = 77913 MB
Rank =   67  Free Memory = 77913 MB
Rank =   68  Free Memory = 77912 MB
Rank =   69  Free Memory = 77912 MB
Rank =   70  Free Memory = 77912 MB
Rank =   71  Free Memory = 77912 MB
Rank =   72  Free Memory = 77912 MB
Rank =   73  Free Memory = 77912 MB
Rank =   74  Free Memory = 77912 MB
Rank =   75  Free Memory = 77912 MB
Rank =   76  Free Memory = 77912 MB
Rank =   77  Free Memory = 77912 MB
Rank =   78  Free Memory = 77912 MB
Rank =   79  Free Memory = 77912 MB
Rank =   80  Free Memory = 77912 MB
Rank =   81  Free Memory = 77912 MB
Rank =   82  Free Memory = 77912 MB
Rank =   83  Free Memory = 77912 MB
Rank =   84  Free Memory = 77912 MB
Rank =   85  Free Memory = 77912 MB
Rank =   86  Free Memory = 77912 MB
Rank =   87  Free Memory = 77912 MB
Rank =   88  Free Memory = 77912 MB
Rank =   89  Free Memory = 77912 MB
Rank =   90  Free Memory = 77912 MB
Rank =   91  Free Memory = 77912 MB
Rank =   92  Free Memory = 77912 MB
Rank =   93  Free Memory = 77912 MB
Rank =   94  Free Memory = 77912 MB
Rank =   95  Free Memory = 77912 MB
Rank =   96  Free Memory = 70447 MB
Rank =   97  Free Memory = 70447 MB
Rank =   98  Free Memory = 70447 MB
Rank =   99  Free Memory = 70447 MB
Rank =  100  Free Memory = 70447 MB
Rank =  101  Free Memory = 70447 MB
Rank =  102  Free Memory = 70447 MB
Rank =  103  Free Memory = 70447 MB
Rank =  104  Free Memory = 70447 MB
Rank =  105  Free Memory = 70447 MB
Rank =  106  Free Memory = 70447 MB
Rank =  107  Free Memory = 70447 MB
Rank =  108  Free Memory = 70447 MB
Rank =  109  Free Memory = 70447 MB
Rank =  110  Free Memory = 70447 MB
Rank =  111  Free Memory = 70447 MB
Rank =  112  Free Memory = 70447 MB
Rank =  113  Free Memory = 70447 MB
Rank =  114  Free Memory = 70447 MB
Rank =  115  Free Memory = 70447 MB
Rank =  116  Free Memory = 70447 MB
Rank =  117  Free Memory = 70447 MB
Rank =  118  Free Memory = 70447 MB
Rank =  119  Free Memory = 70447 MB
Rank =  120  Free Memory = 70447 MB
Rank =  121  Free Memory = 70447 MB
Rank =  122  Free Memory = 70447 MB
Rank =  123  Free Memory = 70447 MB
Rank =  124  Free Memory = 70447 MB
Rank =  125  Free Memory = 70447 MB
Rank =  126  Free Memory = 70447 MB
Rank =  127  Free Memory = 70447 MB
  Input file(s): opt_form_gs_lmtt_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_lmtt_run001a.xml

  Project = FORM
  date    = 2023-02-15 11:07:40 PST
  host    = n0018.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 380

  Range of prime numbers to use as seeds over processors and threads = 2633-3643


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.536032e-01    1         1 OFF
     uu_1                 8.197417e-02    1         1 OFF
     uu_2                -2.279515e-02    1         1 OFF
     uu_3                -7.836857e-02    1         1 OFF
     uu_4                -1.013427e-01    1         1 OFF
     uu_5                -1.044477e-01    1         1 OFF
     uu_6                -9.224414e-02    1         1 OFF
     uu_7                -6.062712e-02    1         1 OFF
     uu_8                -1.023404e-02    1         1 OFF
     uu_9                 4.851606e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.792217e-01    1         1 OFF
     ud_1                 1.041447e-01    1         1 OFF
     ud_2                -2.759756e-02    1         1 OFF
     ud_3                -9.201142e-02    1         1 OFF
     ud_4                -1.207933e-01    1         1 OFF
     ud_5                -1.273508e-01    1         1 OFF
     ud_6                -1.163455e-01    1         1 OFF
     ud_7                -8.399626e-02    1         1 OFF
     ud_8                -3.198393e-02    1         1 OFF
     ud_9                 3.386961e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -3.996214e-01    1         1 OFF
     eC_1                -2.494767e-01    1         1 OFF
     eC_2                 3.700011e-03    1         1 OFF
     eC_3                 1.573024e-01    1         1 OFF
     eC_4                 1.937498e-01    1         1 OFF
     eC_5                 1.904877e-01    1         1 OFF
     eC_6                 7.711846e-02    1         1 OFF
     eC_7                 2.034542e-02    1         1 OFF
     eC_8                 3.700966e-03    1         1 OFF
     eC_9                 1.944711e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.797092e-01    1         1 OFF
     eO_1                -4.355440e-01    1         1 OFF
     eO_2                -2.455303e-02    1         1 OFF
     eO_3                 2.277127e-01    1         1 OFF
     eO_4                 3.261577e-01    1         1 OFF
     eO_5                 3.430617e-01    1         1 OFF
     eO_6                 2.378897e-01    1         1 OFF
     eO_7                 8.612036e-02    1         1 OFF
     eO_8                 2.385595e-03    1         1 OFF
     eO_9                 8.162181e-03    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -9.737895e-02    1         1 OFF
     eH1_1                -1.599916e-02    1         1 OFF
     eH1_2                 3.445961e-03    1         1 OFF
     eH1_3                -1.247711e-02    1         1 OFF
     eH1_4                 6.338141e-03    1         1 OFF
     eH1_5                 1.464916e-02    1         1 OFF
     eH1_6                 3.536630e-02    1         1 OFF
     eH1_7                 3.910225e-02    1         1 OFF
     eH1_8                 2.028485e-02    1         1 OFF
     eH1_9                 5.094825e-03    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -9.796051e-02    1         1 OFF
     eH2_1                -1.537428e-02    1         1 OFF
     eH2_2                 4.200477e-03    1         1 OFF
     eH2_3                -1.217164e-02    1         1 OFF
     eH2_4                 6.944154e-03    1         1 OFF
     eH2_5                 1.575404e-02    1         1 OFF
     eH2_6                 3.502549e-02    1         1 OFF
     eH2_7                 3.688055e-02    1         1 OFF
     eH2_8                 2.096512e-02    1         1 OFF
     eH2_9                 4.252178e-03    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.999797e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.4505e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6855
    reference variance = 0.392578
====================================================
  Execution time = 2.6708e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -2.2809e+01
  VMC Evar = 5.2134e-01
  Total weights = 1.962930266e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505339767971
                                         uncertainty =       0.002210566220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505339767971
                                         uncertainty =       0.002210566220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502650065
  error estimate for blocks of size 2^( 2) =       0.000524060417
  error estimate for blocks of size 2^( 3) =       0.000544713673
  error estimate for blocks of size 2^( 4) =       0.000559209823
  error estimate for blocks of size 2^( 5) =       0.000568197751
  error estimate for blocks of size 2^( 6) =       0.000573914022
  error estimate for blocks of size 2^( 7) =       0.000578809168

      target function =                  N/A
              le_mean =     -22.809176750483
             les_mean =     520.779882855058
             stat err =       0.000570032691
             autocorr =       1.286080164704
              std dev =       0.710854538615
             le_variance =       0.505314175070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.280917675048e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.809176750471       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.813354781925       residual = 9.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.813628361715       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.813634311067       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.813634880770       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.813634849363       residual = 6.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.706745e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.809176750471       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.810794550212       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.810857675557       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.810858512882       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.810858777027       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.841373e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.809176750471       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.809645433590       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.809660260389       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.809660578323       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.809660657930       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.809660660330       residual = 2.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.015247e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1464e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01 1.598055e-01                 3 1 ON  0
ci_02 -5.419239e-02                3 1 ON  1
ci_03 -5.409768e-02                3 1 ON  2
ci_04 5.204113e-02                 3 1 ON  3
ci_05 -3.802933e-02                3 1 ON  4
ci_06 -3.804344e-02                3 1 ON  5
ci_07 3.012223e-02                 3 1 ON  6
ci_08 -1.618950e-02                3 1 ON  7
ci_09 -1.681010e-02                3 1 ON  8
ci_10 -1.685450e-02                3 1 ON  9
ci_11 1.629007e-02                 3 1 ON  10
ci_12 1.320063e-02                 3 1 ON  11
ci_13 1.258123e-02                 3 1 ON  12
ci_14 1.285357e-02                 3 1 ON  13
ci_15 1.196787e-02                 3 1 ON  14
ci_16 1.197537e-02                 3 1 ON  15
ci_17 -1.176907e-02                3 1 ON  16
ci_18 -1.204320e-02                3 1 ON  17
ci_19 1.109707e-02                 3 1 ON  18
ci_20 1.064936e-02                 3 1 ON  19
ci_21 9.805635e-03                 3 1 ON  20
ci_22 9.791431e-03                 3 1 ON  21
ci_23 6.784037e-03                 3 1 ON  22
ci_24 5.284843e-03                 3 1 ON  23
ci_25 5.162860e-03                 3 1 ON  24
ci_26 4.477949e-03                 3 1 ON  25
ci_27 4.523089e-03                 3 1 ON  26
ci_28 4.569660e-03                 3 1 ON  27
ci_29 4.582515e-03                 3 1 ON  28
ci_30 -3.454950e-03                3 1 ON  29
ci_31 -3.318139e-03                3 1 ON  30
ci_32 -2.415914e-03                3 1 ON  31
ci_33 -2.613687e-03                3 1 ON  32
ci_34 2.214830e-03                 3 1 ON  33
ci_35 2.227000e-03                 3 1 ON  34
ci_36 -2.294628e-03                3 1 ON  35
ci_37 -2.429781e-03                3 1 ON  36
ci_38 -1.951027e-03                3 1 ON  37
ci_39 -1.759527e-03                3 1 ON  38
ci_40 -2.031003e-03                3 1 ON  39
ci_41 -8.973580e-04                3 1 ON  40
ci_42 -1.198858e-03                3 1 ON  41
ci_43 -2.021043e-03                3 1 ON  42
ci_44 -2.454367e-03                3 1 ON  43
ci_45 -1.714306e-03                3 1 ON  44
ci_46 -1.663429e-03                3 1 ON  45
ci_47 -2.087755e-03                3 1 ON  46
ci_48 -1.803987e-03                3 1 ON  47
ci_49 -1.512280e-03                3 1 ON  48
ci_50 -1.302852e-03                3 1 ON  49
ci_51 1.427979e-03                 3 1 ON  50
ci_52 1.258632e-03                 3 1 ON  51
ci_53 -1.368063e-03                3 1 ON  52
ci_54 -1.188665e-03                3 1 ON  53
ci_55 -1.393488e-03                3 1 ON  54
ci_56 1.319402e-03                 3 1 ON  55
ci_57 1.296855e-03                 3 1 ON  56
ci_58 -1.308002e-03                3 1 ON  57
ci_59 -1.203203e-03                3 1 ON  58
ci_60 1.262603e-03                 3 1 ON  59
ci_61 1.231911e-03                 3 1 ON  60
ci_62 -1.001302e-03                3 1 ON  61
ci_63 -9.469982e-04                3 1 ON  62
ci_64 -8.348544e-04                3 1 ON  63
ci_65 -1.140183e-03                3 1 ON  64
ci_66 -9.923626e-04                3 1 ON  65
ci_67 -1.069451e-03                3 1 ON  66
ci_68 5.009923e-04                 3 1 ON  67
ci_69 6.697300e-04                 3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7824
    reference variance = 0.435087
====================================================
  Execution time = 2.5554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2812e+01
  VMC Evar = 5.2014e-01
  Total weights = 1.9630e+06
  Execution time = 3.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0668862
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518577932992
                                         uncertainty =       0.003628234637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518577932992
                                         uncertainty =       0.003628234637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509180402
  error estimate for blocks of size 2^( 2) =       0.000530734747
  error estimate for blocks of size 2^( 3) =       0.000550464016
  error estimate for blocks of size 2^( 4) =       0.000565152979
  error estimate for blocks of size 2^( 5) =       0.000575356080
  error estimate for blocks of size 2^( 6) =       0.000582827021
  error estimate for blocks of size 2^( 7) =       0.000585573104

      target function =                  N/A
              le_mean =     -22.812386727825
             les_mean =     521.005946495896
             stat err =       0.000577227296
             autocorr =       1.285139762337
              std dev =       0.720089829952
             le_variance =       0.518529363200

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0196576
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506998496380
                                         uncertainty =       0.013588569790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506998496380
                                         uncertainty =       0.013588569790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503460744
  error estimate for blocks of size 2^( 2) =       0.000524035483
  error estimate for blocks of size 2^( 3) =       0.000543171850
  error estimate for blocks of size 2^( 4) =       0.000557516036
  error estimate for blocks of size 2^( 5) =       0.000567488494
  error estimate for blocks of size 2^( 6) =       0.000574473674
  error estimate for blocks of size 2^( 7) =       0.000577826147

      target function =                  N/A
              le_mean =     -22.812951680967
             les_mean =     521.606292158354
             stat err =       0.000569326088
             autocorr =       1.278765594599
              std dev =       0.712001012123
             le_variance =       0.506945441264

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0673324
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494075321748
                                         uncertainty =       0.002894401448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494075321748
                                         uncertainty =       0.002894401448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497005769
  error estimate for blocks of size 2^( 2) =       0.000518068880
  error estimate for blocks of size 2^( 3) =       0.000537549090
  error estimate for blocks of size 2^( 4) =       0.000552174238
  error estimate for blocks of size 2^( 5) =       0.000562425662
  error estimate for blocks of size 2^( 6) =       0.000569651273
  error estimate for blocks of size 2^( 7) =       0.000572772927

      target function =                  N/A
              le_mean =     -22.812330051617
             les_mean =     520.935955768901
             stat err =       0.000564256025
             autocorr =       1.288930649651
              std dev =       0.702872298835
             le_variance =       0.494029468469

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.278795
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512553255088
                                         uncertainty =       0.003293379433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512553255088
                                         uncertainty =       0.003293379433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506214466
  error estimate for blocks of size 2^( 2) =       0.000527668659
  error estimate for blocks of size 2^( 3) =       0.000547366656
  error estimate for blocks of size 2^( 4) =       0.000562107707
  error estimate for blocks of size 2^( 5) =       0.000572313129
  error estimate for blocks of size 2^( 6) =       0.000579671012
  error estimate for blocks of size 2^( 7) =       0.000582424813

      target function =                  N/A
              le_mean =     -22.812207114194
             les_mean =     520.941163438463
             stat err =       0.000574129165
             autocorr =       1.286323238295
              std dev =       0.715895362675
             le_variance =       0.512506170300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.812386727825        initial
     2.5000e-01     2.5000e+00             1.7067e-02       -22.812951680967  <--
     1.0000e+00     1.0000e+01             6.8414e-03       -22.812330051617
     4.0000e+00     4.0000e+01             2.0152e-03       -22.812207114194

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.3483e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_01                 1.510710e-01 3 1  ON 0
ci_02                -4.564481e-02 3 1  ON 1
ci_03                -4.537836e-02 3 1  ON 2
ci_04                 4.181505e-02 3 1  ON 3
ci_05                -3.254146e-02 3 1  ON 4
ci_06                -3.262922e-02 3 1  ON 5
ci_07                 2.905388e-02 3 1  ON 6
ci_08                -1.175376e-02 3 1  ON 7
ci_09                -1.503391e-02 3 1  ON 8
ci_10                -1.519549e-02 3 1  ON 9
ci_11                 1.612643e-02 3 1  ON 10
ci_12                 1.249785e-02 3 1  ON 11
ci_13                 1.242621e-02 3 1  ON 12
ci_14                 1.342242e-02 3 1  ON 13
ci_15                 1.085083e-02 3 1  ON 14
ci_16                 1.091941e-02 3 1  ON 15
ci_17                -1.086363e-02 3 1  ON 16
ci_18                -1.160499e-02 3 1  ON 17
ci_19                 1.016030e-02 3 1  ON 18
ci_20                 1.070716e-02 3 1  ON 19
ci_21                 9.454024e-03 3 1  ON 20
ci_22                 9.444670e-03 3 1  ON 21
ci_23                 6.819923e-03 3 1  ON 22
ci_24                 5.152771e-03 3 1  ON 23
ci_25                 5.003457e-03 3 1  ON 24
ci_26                 3.756052e-03 3 1  ON 25
ci_27                 3.885439e-03 3 1  ON 26
ci_28                 4.930387e-03 3 1  ON 27
ci_29                 4.917135e-03 3 1  ON 28
ci_30                -2.884500e-03 3 1  ON 29
ci_31                -2.490916e-03 3 1  ON 30
ci_32                -1.151138e-03 3 1  ON 31
ci_33                -1.639568e-03 3 1  ON 32
ci_34                 1.412141e-03 3 1  ON 33
ci_35                 1.364734e-03 3 1  ON 34
ci_36                -1.706651e-03 3 1  ON 35
ci_37                -2.056338e-03 3 1  ON 36
ci_38                -1.627455e-03 3 1  ON 37
ci_39                -1.106465e-03 3 1  ON 38
ci_40                -1.960644e-03 3 1  ON 39
ci_41                 4.496243e-04 3 1  ON 40
ci_42                -3.147485e-04 3 1  ON 41
ci_43                -1.769093e-03 3 1  ON 42
ci_44                -2.965199e-03 3 1  ON 43
ci_45                -1.386193e-03 3 1  ON 44
ci_46                -1.248829e-03 3 1  ON 45
ci_47                -2.335653e-03 3 1  ON 46
ci_48                -1.549529e-03 3 1  ON 47
ci_49                -1.160313e-03 3 1  ON 48
ci_50                -7.155628e-04 3 1  ON 49
ci_51                 1.002806e-03 3 1  ON 50
ci_52                 5.708447e-04 3 1  ON 51
ci_53                -1.182442e-03 3 1  ON 52
ci_54                -5.815185e-04 3 1  ON 53
ci_55                -1.146948e-03 3 1  ON 54
ci_56                 1.360479e-03 3 1  ON 55
ci_57                 1.292613e-03 3 1  ON 56
ci_58                -1.435333e-03 3 1  ON 57
ci_59                -1.176574e-03 3 1  ON 58
ci_60                 1.526941e-03 3 1  ON 59
ci_61                 1.429936e-03 3 1  ON 60
ci_62                -7.789047e-04 3 1  ON 61
ci_63                -6.529087e-04 3 1  ON 62
ci_64                -4.242100e-04 3 1  ON 63
ci_65                -1.224292e-03 3 1  ON 64
ci_66                -9.253646e-04 3 1  ON 65
ci_67                -1.032801e-03 3 1  ON 66
ci_68                -3.104473e-04 3 1  ON 67
ci_69                 1.691368e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2734e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8675
    reference variance = 1.19883
====================================================
  Execution time = 2.6168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9565e-01
  Total weights = 1.963140152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479713952972
                                         uncertainty =       0.002418294610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479713952972
                                         uncertainty =       0.002418294610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489735958
  error estimate for blocks of size 2^( 2) =       0.000510806608
  error estimate for blocks of size 2^( 3) =       0.000529930659
  error estimate for blocks of size 2^( 4) =       0.000544925474
  error estimate for blocks of size 2^( 5) =       0.000553313222
  error estimate for blocks of size 2^( 6) =       0.000556412639
  error estimate for blocks of size 2^( 7) =       0.000559319877

      target function =                  N/A
              le_mean =     -22.815538376643
             les_mean =     521.044436831982
             stat err =       0.000553492803
             autocorr =       1.277320759954
              std dev =       0.692591234340
             le_variance =       0.479682617884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281553837664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815538376612       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817819951172       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818047297461       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818077184367       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818078226842       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818077942535       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818077997943       residual = 9.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 2.073237e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815538376612       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816882743442       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816954254709       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816957681731       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816957807336       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.403040e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.815538376612       residual = 5.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816046901694       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816062895441       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816063384209       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816063410844       residual = 3.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.353547e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0798e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.416679e-01 3 1  ON 0
ci_02                -3.777982e-02 3 1  ON 1
ci_03                -3.719080e-02 3 1  ON 2
ci_04                 3.346411e-02 3 1  ON 3
ci_05                -2.752804e-02 3 1  ON 4
ci_06                -2.722971e-02 3 1  ON 5
ci_07                 2.804095e-02 3 1  ON 6
ci_08                -8.209877e-03 3 1  ON 7
ci_09                -1.351289e-02 3 1  ON 8
ci_10                -1.390767e-02 3 1  ON 9
ci_11                 1.596009e-02 3 1  ON 10
ci_12                 1.212142e-02 3 1  ON 11
ci_13                 1.182593e-02 3 1  ON 12
ci_14                 1.326349e-02 3 1  ON 13
ci_15                 9.765479e-03 3 1  ON 14
ci_16                 9.935041e-03 3 1  ON 15
ci_17                -1.067546e-02 3 1  ON 16
ci_18                -1.062790e-02 3 1  ON 17
ci_19                 9.919059e-03 3 1  ON 18
ci_20                 1.080798e-02 3 1  ON 19
ci_21                 8.896322e-03 3 1  ON 20
ci_22                 9.601908e-03 3 1  ON 21
ci_23                 7.077201e-03 3 1  ON 22
ci_24                 5.104452e-03 3 1  ON 23
ci_25                 4.998080e-03 3 1  ON 24
ci_26                 3.249046e-03 3 1  ON 25
ci_27                 3.173838e-03 3 1  ON 26
ci_28                 4.919920e-03 3 1  ON 27
ci_29                 4.515626e-03 3 1  ON 28
ci_30                -1.999412e-03 3 1  ON 29
ci_31                -1.185990e-03 3 1  ON 30
ci_32                -6.731759e-04 3 1  ON 31
ci_33                -4.565990e-04 3 1  ON 32
ci_34                 8.731442e-04 3 1  ON 33
ci_35                 2.284536e-04 3 1  ON 34
ci_36                -1.580031e-03 3 1  ON 35
ci_37                -1.434662e-03 3 1  ON 36
ci_38                -4.348486e-04 3 1  ON 37
ci_39                -7.834907e-04 3 1  ON 38
ci_40                -1.841099e-03 3 1  ON 39
ci_41                 4.516477e-04 3 1  ON 40
ci_42                 5.872967e-04 3 1  ON 41
ci_43                -2.064895e-03 3 1  ON 42
ci_44                -3.149763e-03 3 1  ON 43
ci_45                -9.000998e-04 3 1  ON 44
ci_46                -7.889072e-04 3 1  ON 45
ci_47                -2.187601e-03 3 1  ON 46
ci_48                -1.164673e-03 3 1  ON 47
ci_49                -9.904721e-04 3 1  ON 48
ci_50                -8.238857e-04 3 1  ON 49
ci_51                 6.294387e-04 3 1  ON 50
ci_52                 6.228478e-04 3 1  ON 51
ci_53                -1.049558e-03 3 1  ON 52
ci_54                -1.457722e-03 3 1  ON 53
ci_55                -8.822887e-04 3 1  ON 54
ci_56                 9.808650e-04 3 1  ON 55
ci_57                 1.578528e-03 3 1  ON 56
ci_58                -1.322638e-03 3 1  ON 57
ci_59                -1.140776e-03 3 1  ON 58
ci_60                 1.713080e-03 3 1  ON 59
ci_61                 2.462999e-03 3 1  ON 60
ci_62                -3.527215e-04 3 1  ON 61
ci_63                -1.081361e-03 3 1  ON 62
ci_64                -9.585676e-04 3 1  ON 63
ci_65                -1.348478e-03 3 1  ON 64
ci_66                -6.451799e-04 3 1  ON 65
ci_67                -8.867180e-04 3 1  ON 66
ci_68                -6.135742e-04 3 1  ON 67
ci_69                -8.609832e-06 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8685
    reference variance = 0.597504
====================================================
  Execution time = 2.5611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8801e-01
  Total weights = 1.9633e+06
  Execution time = 3.5549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485090900659
                                         uncertainty =       0.002576165351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485090900659
                                         uncertainty =       0.002576165351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492636741
  error estimate for blocks of size 2^( 2) =       0.000513610062
  error estimate for blocks of size 2^( 3) =       0.000533577580
  error estimate for blocks of size 2^( 4) =       0.000548594595
  error estimate for blocks of size 2^( 5) =       0.000557553387
  error estimate for blocks of size 2^( 6) =       0.000563212622
  error estimate for blocks of size 2^( 7) =       0.000565663654

      target function =                  N/A
              le_mean =     -22.818641225303
             les_mean =     521.242773996264
             stat err =       0.000558756065
             autocorr =       1.286444052243
              std dev =       0.696693559859
             le_variance =       0.485381916349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475306488543
                                         uncertainty =       0.004436468566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475306488543
                                         uncertainty =       0.004436468566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487612033
  error estimate for blocks of size 2^( 2) =       0.000508661596
  error estimate for blocks of size 2^( 3) =       0.000528819456
  error estimate for blocks of size 2^( 4) =       0.000544084601
  error estimate for blocks of size 2^( 5) =       0.000553277236
  error estimate for blocks of size 2^( 6) =       0.000559267123
  error estimate for blocks of size 2^( 7) =       0.000561292441

      target function =                  N/A
              le_mean =     -22.818178837700
             les_mean =     521.921127097932
             stat err =       0.000554480350
             autocorr =       1.293074331473
              std dev =       0.689587550766
             le_variance =       0.475530990172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529017880010
                                         uncertainty =       0.060089074852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.529017880010
                                         uncertainty =       0.060089074852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000514394252
  error estimate for blocks of size 2^( 2) =       0.000534601498
  error estimate for blocks of size 2^( 3) =       0.000553845929
  error estimate for blocks of size 2^( 4) =       0.000568470509
  error estimate for blocks of size 2^( 5) =       0.000577212739
  error estimate for blocks of size 2^( 6) =       0.000582701718
  error estimate for blocks of size 2^( 7) =       0.000584313373

      target function =                  N/A
              le_mean =     -22.818235308343
             les_mean =     522.640144934817
             stat err =       0.000578174585
             autocorr =       1.263356098210
              std dev =       0.727463327244
             le_variance =       0.529202892485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478735266732
                                         uncertainty =       0.002266536684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478735266732
                                         uncertainty =       0.002266536684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489394869
  error estimate for blocks of size 2^( 2) =       0.000510387790
  error estimate for blocks of size 2^( 3) =       0.000530370266
  error estimate for blocks of size 2^( 4) =       0.000545447779
  error estimate for blocks of size 2^( 5) =       0.000554526791
  error estimate for blocks of size 2^( 6) =       0.000560355631
  error estimate for blocks of size 2^( 7) =       0.000562702848

      target function =                  N/A
              le_mean =     -22.818182365608
             les_mean =     521.184917748430
             stat err =       0.000555758262
             autocorr =       1.289594085551
              std dev =       0.692108861000
             le_variance =       0.479014675475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818641225303        initial  <--
     6.2500e-02     6.2500e-01             2.0732e-02       -22.818178837700
     2.5000e-01     2.5000e+00             9.4030e-03       -22.818235308343
     1.0000e+00     1.0000e+01             3.3535e-03       -22.818182365608

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5080
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_01                 1.510710e-01 3 1  ON 0
ci_02                -4.564481e-02 3 1  ON 1
ci_03                -4.537836e-02 3 1  ON 2
ci_04                 4.181505e-02 3 1  ON 3
ci_05                -3.254146e-02 3 1  ON 4
ci_06                -3.262922e-02 3 1  ON 5
ci_07                 2.905388e-02 3 1  ON 6
ci_08                -1.175376e-02 3 1  ON 7
ci_09                -1.503391e-02 3 1  ON 8
ci_10                -1.519549e-02 3 1  ON 9
ci_11                 1.612643e-02 3 1  ON 10
ci_12                 1.249785e-02 3 1  ON 11
ci_13                 1.242621e-02 3 1  ON 12
ci_14                 1.342242e-02 3 1  ON 13
ci_15                 1.085083e-02 3 1  ON 14
ci_16                 1.091941e-02 3 1  ON 15
ci_17                -1.086363e-02 3 1  ON 16
ci_18                -1.160499e-02 3 1  ON 17
ci_19                 1.016030e-02 3 1  ON 18
ci_20                 1.070716e-02 3 1  ON 19
ci_21                 9.454024e-03 3 1  ON 20
ci_22                 9.444670e-03 3 1  ON 21
ci_23                 6.819923e-03 3 1  ON 22
ci_24                 5.152771e-03 3 1  ON 23
ci_25                 5.003457e-03 3 1  ON 24
ci_26                 3.756052e-03 3 1  ON 25
ci_27                 3.885439e-03 3 1  ON 26
ci_28                 4.930387e-03 3 1  ON 27
ci_29                 4.917135e-03 3 1  ON 28
ci_30                -2.884500e-03 3 1  ON 29
ci_31                -2.490916e-03 3 1  ON 30
ci_32                -1.151138e-03 3 1  ON 31
ci_33                -1.639568e-03 3 1  ON 32
ci_34                 1.412141e-03 3 1  ON 33
ci_35                 1.364734e-03 3 1  ON 34
ci_36                -1.706651e-03 3 1  ON 35
ci_37                -2.056338e-03 3 1  ON 36
ci_38                -1.627455e-03 3 1  ON 37
ci_39                -1.106465e-03 3 1  ON 38
ci_40                -1.960644e-03 3 1  ON 39
ci_41                 4.496243e-04 3 1  ON 40
ci_42                -3.147485e-04 3 1  ON 41
ci_43                -1.769093e-03 3 1  ON 42
ci_44                -2.965199e-03 3 1  ON 43
ci_45                -1.386193e-03 3 1  ON 44
ci_46                -1.248829e-03 3 1  ON 45
ci_47                -2.335653e-03 3 1  ON 46
ci_48                -1.549529e-03 3 1  ON 47
ci_49                -1.160313e-03 3 1  ON 48
ci_50                -7.155628e-04 3 1  ON 49
ci_51                 1.002806e-03 3 1  ON 50
ci_52                 5.708447e-04 3 1  ON 51
ci_53                -1.182442e-03 3 1  ON 52
ci_54                -5.815185e-04 3 1  ON 53
ci_55                -1.146948e-03 3 1  ON 54
ci_56                 1.360479e-03 3 1  ON 55
ci_57                 1.292613e-03 3 1  ON 56
ci_58                -1.435333e-03 3 1  ON 57
ci_59                -1.176574e-03 3 1  ON 58
ci_60                 1.526941e-03 3 1  ON 59
ci_61                 1.429936e-03 3 1  ON 60
ci_62                -7.789047e-04 3 1  ON 61
ci_63                -6.529087e-04 3 1  ON 62
ci_64                -4.242100e-04 3 1  ON 63
ci_65                -1.224292e-03 3 1  ON 64
ci_66                -9.253646e-04 3 1  ON 65
ci_67                -1.032801e-03 3 1  ON 66
ci_68                -3.104473e-04 3 1  ON 67
ci_69                 1.691368e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2801e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.9042
    reference variance = 2.24292
====================================================
  Execution time = 2.6029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.9431e-01
  Total weights = 1.963039231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477736339245
                                         uncertainty =       0.001946298936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477736339245
                                         uncertainty =       0.001946298936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488845711
  error estimate for blocks of size 2^( 2) =       0.000509328001
  error estimate for blocks of size 2^( 3) =       0.000529347936
  error estimate for blocks of size 2^( 4) =       0.000544357484
  error estimate for blocks of size 2^( 5) =       0.000552232749
  error estimate for blocks of size 2^( 6) =       0.000557028836
  error estimate for blocks of size 2^( 7) =       0.000560682590

      target function =                  N/A
              le_mean =     -22.814899140255
             les_mean =     521.013936247865
             stat err =       0.000553575415
             autocorr =       1.282360021327
              std dev =       0.691332234342
             le_variance =       0.477940258240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281489914026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.814899140172       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.815637801167       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.815661601683       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.815661753141       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.815661698519       residual = 5.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.965375e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.814899140172       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.815126259253       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.815131906104       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.815132003480       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.815131959092       residual = 6.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.582973e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.814899140172       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.814959381311       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.814960809215       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.814960845541       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.814960831466       residual = 8.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 4.250977e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0654e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.498125e-01 3 1  ON 0
ci_02                -4.436346e-02 3 1  ON 1
ci_03                -4.409961e-02 3 1  ON 2
ci_04                 4.023208e-02 3 1  ON 3
ci_05                -3.169550e-02 3 1  ON 4
ci_06                -3.181674e-02 3 1  ON 5
ci_07                 2.891901e-02 3 1  ON 6
ci_08                -1.106883e-02 3 1  ON 7
ci_09                -1.487921e-02 3 1  ON 8
ci_10                -1.506026e-02 3 1  ON 9
ci_11                 1.597663e-02 3 1  ON 10
ci_12                 1.241263e-02 3 1  ON 11
ci_13                 1.241185e-02 3 1  ON 12
ci_14                 1.353681e-02 3 1  ON 13
ci_15                 1.066537e-02 3 1  ON 14
ci_16                 1.079903e-02 3 1  ON 15
ci_17                -1.086554e-02 3 1  ON 16
ci_18                -1.148021e-02 3 1  ON 17
ci_19                 9.975732e-03 3 1  ON 18
ci_20                 1.062460e-02 3 1  ON 19
ci_21                 9.453690e-03 3 1  ON 20
ci_22                 9.391276e-03 3 1  ON 21
ci_23                 6.780936e-03 3 1  ON 22
ci_24                 5.204742e-03 3 1  ON 23
ci_25                 5.011935e-03 3 1  ON 24
ci_26                 3.578192e-03 3 1  ON 25
ci_27                 3.785072e-03 3 1  ON 26
ci_28                 4.960787e-03 3 1  ON 27
ci_29                 4.951743e-03 3 1  ON 28
ci_30                -2.714805e-03 3 1  ON 29
ci_31                -2.378576e-03 3 1  ON 30
ci_32                -1.005903e-03 3 1  ON 31
ci_33                -1.432410e-03 3 1  ON 32
ci_34                 1.222794e-03 3 1  ON 33
ci_35                 1.128449e-03 3 1  ON 34
ci_36                -1.719824e-03 3 1  ON 35
ci_37                -2.009914e-03 3 1  ON 36
ci_38                -1.504797e-03 3 1  ON 37
ci_39                -1.056869e-03 3 1  ON 38
ci_40                -1.888997e-03 3 1  ON 39
ci_41                 4.779953e-04 3 1  ON 40
ci_42                -1.446161e-04 3 1  ON 41
ci_43                -1.860090e-03 3 1  ON 42
ci_44                -2.946431e-03 3 1  ON 43
ci_45                -1.320304e-03 3 1  ON 44
ci_46                -1.233626e-03 3 1  ON 45
ci_47                -2.214751e-03 3 1  ON 46
ci_48                -1.554133e-03 3 1  ON 47
ci_49                -1.188044e-03 3 1  ON 48
ci_50                -6.904575e-04 3 1  ON 49
ci_51                 9.508941e-04 3 1  ON 50
ci_52                 5.124702e-04 3 1  ON 51
ci_53                -1.143048e-03 3 1  ON 52
ci_54                -5.657965e-04 3 1  ON 53
ci_55                -1.204182e-03 3 1  ON 54
ci_56                 1.316217e-03 3 1  ON 55
ci_57                 1.266075e-03 3 1  ON 56
ci_58                -1.421587e-03 3 1  ON 57
ci_59                -1.140546e-03 3 1  ON 58
ci_60                 1.561403e-03 3 1  ON 59
ci_61                 1.459114e-03 3 1  ON 60
ci_62                -7.803216e-04 3 1  ON 61
ci_63                -6.957620e-04 3 1  ON 62
ci_64                -3.831924e-04 3 1  ON 63
ci_65                -1.256573e-03 3 1  ON 64
ci_66                -8.408183e-04 3 1  ON 65
ci_67                -1.038185e-03 3 1  ON 66
ci_68                -4.012836e-04 3 1  ON 67
ci_69                 5.827254e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7351
    reference variance = 0.237343
====================================================
  Execution time = 2.5716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.9918e-01
  Total weights = 1.9632e+06
  Execution time = 3.5674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 9.62871e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493864873224
                                         uncertainty =       0.011004755375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493864873224
                                         uncertainty =       0.011004755375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496904805
  error estimate for blocks of size 2^( 2) =       0.000517820950
  error estimate for blocks of size 2^( 3) =       0.000536653308
  error estimate for blocks of size 2^( 4) =       0.000552122183
  error estimate for blocks of size 2^( 5) =       0.000562106662
  error estimate for blocks of size 2^( 6) =       0.000568114634
  error estimate for blocks of size 2^( 7) =       0.000571412465

      target function =                  N/A
              le_mean =     -22.816713594120
             les_mean =     525.310200709336
             stat err =       0.000563438986
             autocorr =       1.285722948569
              std dev =       0.702729514080
             le_variance =       0.493828769959

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.13867e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479124126429
                                         uncertainty =       0.002483828719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479124126429
                                         uncertainty =       0.002483828719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489434031
  error estimate for blocks of size 2^( 2) =       0.000510439688
  error estimate for blocks of size 2^( 3) =       0.000529437287
  error estimate for blocks of size 2^( 4) =       0.000544986566
  error estimate for blocks of size 2^( 5) =       0.000555048450
  error estimate for blocks of size 2^( 6) =       0.000561093996
  error estimate for blocks of size 2^( 7) =       0.000564264105

      target function =                  N/A
              le_mean =     -22.816736298941
             les_mean =     521.229724689474
             stat err =       0.000556348279
             autocorr =       1.292126912339
              std dev =       0.692164244290
             le_variance =       0.479091341074

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 9.61297e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479737509077
                                         uncertainty =       0.002433046242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479737509077
                                         uncertainty =       0.002433046242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489747474
  error estimate for blocks of size 2^( 2) =       0.000510794064
  error estimate for blocks of size 2^( 3) =       0.000529770991
  error estimate for blocks of size 2^( 4) =       0.000545362053
  error estimate for blocks of size 2^( 5) =       0.000555381652
  error estimate for blocks of size 2^( 6) =       0.000561394703
  error estimate for blocks of size 2^( 7) =       0.000564662169

      target function =                  N/A
              le_mean =     -22.816657401862
             les_mean =     521.100089278899
             stat err =       0.000556700144
             autocorr =       1.292106339303
              std dev =       0.692607520334
             le_variance =       0.479705177223

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000130073
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482396935673
                                         uncertainty =       0.002455483025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482396935673
                                         uncertainty =       0.002455483025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000491102317
  error estimate for blocks of size 2^( 2) =       0.000512183038
  error estimate for blocks of size 2^( 3) =       0.000531174198
  error estimate for blocks of size 2^( 4) =       0.000546773659
  error estimate for blocks of size 2^( 5) =       0.000556776853
  error estimate for blocks of size 2^( 6) =       0.000562782040
  error estimate for blocks of size 2^( 7) =       0.000566115066

      target function =                  N/A
              le_mean =     -22.816634056093
             les_mean =     521.101833600850
             stat err =       0.000558111904
             autocorr =       1.291512477177
              std dev =       0.694523556803
             le_variance =       0.482362970954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.816713594120        initial
     6.2500e-01     6.2500e+00             4.9654e-03       -22.816736298941  <--
     2.5000e+00     2.5000e+01             1.5830e-03       -22.816657401862
     1.0000e+01     1.0000e+02             4.2510e-04       -22.816634056093

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 4.3661e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_01                 1.465786e-01 3 1  ON 0
ci_02                -4.138436e-02 3 1  ON 1
ci_03                -4.112371e-02 3 1  ON 2
ci_04                 3.684967e-02 3 1  ON 3
ci_05                -2.980899e-02 3 1  ON 4
ci_06                -2.999671e-02 3 1  ON 5
ci_07                 2.860723e-02 3 1  ON 6
ci_08                -9.613453e-03 3 1  ON 7
ci_09                -1.449818e-02 3 1  ON 8
ci_10                -1.473350e-02 3 1  ON 9
ci_11                 1.563804e-02 3 1  ON 10
ci_12                 1.222360e-02 3 1  ON 11
ci_13                 1.239477e-02 3 1  ON 12
ci_14                 1.387355e-02 3 1  ON 13
ci_15                 1.023210e-02 3 1  ON 14
ci_16                 1.051800e-02 3 1  ON 15
ci_17                -1.082847e-02 3 1  ON 16
ci_18                -1.114314e-02 3 1  ON 17
ci_19                 9.620611e-03 3 1  ON 18
ci_20                 1.045993e-02 3 1  ON 19
ci_21                 9.454996e-03 3 1  ON 20
ci_22                 9.251362e-03 3 1  ON 21
ci_23                 6.714505e-03 3 1  ON 22
ci_24                 5.350959e-03 3 1  ON 23
ci_25                 5.037190e-03 3 1  ON 24
ci_26                 3.166311e-03 3 1  ON 25
ci_27                 3.566859e-03 3 1  ON 26
ci_28                 4.986123e-03 3 1  ON 27
ci_29                 4.984909e-03 3 1  ON 28
ci_30                -2.289594e-03 3 1  ON 29
ci_31                -2.087941e-03 3 1  ON 30
ci_32                -7.765611e-04 3 1  ON 31
ci_33                -1.066184e-03 3 1  ON 32
ci_34                 8.570208e-04 3 1  ON 33
ci_35                 6.471093e-04 3 1  ON 34
ci_36                -1.729217e-03 3 1  ON 35
ci_37                -1.892483e-03 3 1  ON 36
ci_38                -1.233430e-03 3 1  ON 37
ci_39                -9.370103e-04 3 1  ON 38
ci_40                -1.747862e-03 3 1  ON 39
ci_41                 4.551004e-04 3 1  ON 40
ci_42                 1.431013e-04 3 1  ON 41
ci_43                -2.018947e-03 3 1  ON 42
ci_44                -2.852970e-03 3 1  ON 43
ci_45                -1.172132e-03 3 1  ON 44
ci_46                -1.188853e-03 3 1  ON 45
ci_47                -1.898855e-03 3 1  ON 46
ci_48                -1.543841e-03 3 1  ON 47
ci_49                -1.243998e-03 3 1  ON 48
ci_50                -6.393498e-04 3 1  ON 49
ci_51                 8.289560e-04 3 1  ON 50
ci_52                 3.794475e-04 3 1  ON 51
ci_53                -1.070380e-03 3 1  ON 52
ci_54                -5.201350e-04 3 1  ON 53
ci_55                -1.333243e-03 3 1  ON 54
ci_56                 1.238588e-03 3 1  ON 55
ci_57                 1.231316e-03 3 1  ON 56
ci_58                -1.397805e-03 3 1  ON 57
ci_59                -1.065577e-03 3 1  ON 58
ci_60                 1.658379e-03 3 1  ON 59
ci_61                 1.540867e-03 3 1  ON 60
ci_62                -7.688174e-04 3 1  ON 61
ci_63                -7.683598e-04 3 1  ON 62
ci_64                -2.754432e-04 3 1  ON 63
ci_65                -1.316999e-03 3 1  ON 64
ci_66                -6.532346e-04 3 1  ON 65
ci_67                -1.044451e-03 3 1  ON 66
ci_68                -5.984707e-04 3 1  ON 67
ci_69                -1.863220e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8467
    reference variance = 0.561536
====================================================
  Execution time = 2.8047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.9942e-01
  Total weights = 1.963259187e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484527611198
                                         uncertainty =       0.003036679286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484527611198
                                         uncertainty =       0.003036679286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492173813
  error estimate for blocks of size 2^( 2) =       0.000512722410
  error estimate for blocks of size 2^( 3) =       0.000532564117
  error estimate for blocks of size 2^( 4) =       0.000547719974
  error estimate for blocks of size 2^( 5) =       0.000556326451
  error estimate for blocks of size 2^( 6) =       0.000559850419
  error estimate for blocks of size 2^( 7) =       0.000562685933

      target function =                  N/A
              le_mean =     -22.816449445670
             les_mean =     521.089782860691
             stat err =       0.000556645694
             autocorr =       1.279147727539
              std dev =       0.696038881132
             le_variance =       0.484470124047


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281644944567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.816449445640       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.817542463194       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.817616473797       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.817618007274       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.817617915513       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.172609e-02

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.816449445640       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816918390981       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816933708938       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816934330161       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816934289296       residual = 3.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.099176e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.816449445640       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.816592238861       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.816595856613       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.816596093786       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.816596090832       residual = 4.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.144269e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2688e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.424794e-01 3 1  ON 0
ci_02                -3.805332e-02 3 1  ON 1
ci_03                -3.787959e-02 3 1  ON 2
ci_04                 3.350450e-02 3 1  ON 3
ci_05                -2.787917e-02 3 1  ON 4
ci_06                -2.801033e-02 3 1  ON 5
ci_07                 2.781588e-02 3 1  ON 6
ci_08                -8.143354e-03 3 1  ON 7
ci_09                -1.396176e-02 3 1  ON 8
ci_10                -1.435763e-02 3 1  ON 9
ci_11                 1.554173e-02 3 1  ON 10
ci_12                 1.175301e-02 3 1  ON 11
ci_13                 1.211333e-02 3 1  ON 12
ci_14                 1.404055e-02 3 1  ON 13
ci_15                 9.765915e-03 3 1  ON 14
ci_16                 1.008023e-02 3 1  ON 15
ci_17                -1.066937e-02 3 1  ON 16
ci_18                -1.069489e-02 3 1  ON 17
ci_19                 9.624084e-03 3 1  ON 18
ci_20                 1.068607e-02 3 1  ON 19
ci_21                 9.157432e-03 3 1  ON 20
ci_22                 9.291274e-03 3 1  ON 21
ci_23                 6.749446e-03 3 1  ON 22
ci_24                 5.649261e-03 3 1  ON 23
ci_25                 4.831775e-03 3 1  ON 24
ci_26                 3.043230e-03 3 1  ON 25
ci_27                 3.514146e-03 3 1  ON 26
ci_28                 4.881216e-03 3 1  ON 27
ci_29                 5.023396e-03 3 1  ON 28
ci_30                -1.913009e-03 3 1  ON 29
ci_31                -1.865589e-03 3 1  ON 30
ci_32                -4.993342e-05 3 1  ON 31
ci_33                -6.036443e-04 3 1  ON 32
ci_34                 3.922626e-04 3 1  ON 33
ci_35                 5.808311e-04 3 1  ON 34
ci_36                -1.824417e-03 3 1  ON 35
ci_37                -1.540876e-03 3 1  ON 36
ci_38                -1.095428e-03 3 1  ON 37
ci_39                -8.340698e-04 3 1  ON 38
ci_40                -1.684535e-03 3 1  ON 39
ci_41                 7.433944e-04 3 1  ON 40
ci_42                 4.943435e-04 3 1  ON 41
ci_43                -2.153027e-03 3 1  ON 42
ci_44                -2.766049e-03 3 1  ON 43
ci_45                -7.300669e-04 3 1  ON 44
ci_46                -1.031923e-03 3 1  ON 45
ci_47                -1.847426e-03 3 1  ON 46
ci_48                -1.287226e-03 3 1  ON 47
ci_49                -1.232121e-03 3 1  ON 48
ci_50                -5.400721e-04 3 1  ON 49
ci_51                 5.794772e-04 3 1  ON 50
ci_52                 3.658633e-04 3 1  ON 51
ci_53                -1.112817e-03 3 1  ON 52
ci_54                -5.950827e-04 3 1  ON 53
ci_55                -9.735965e-04 3 1  ON 54
ci_56                 1.384113e-03 3 1  ON 55
ci_57                 1.530828e-03 3 1  ON 56
ci_58                -1.475924e-03 3 1  ON 57
ci_59                -1.194733e-03 3 1  ON 58
ci_60                 1.788903e-03 3 1  ON 59
ci_61                 1.347081e-03 3 1  ON 60
ci_62                -8.349012e-04 3 1  ON 61
ci_63                -5.712788e-04 3 1  ON 62
ci_64                -6.269250e-04 3 1  ON 63
ci_65                -1.014796e-03 3 1  ON 64
ci_66                -7.036610e-04 3 1  ON 65
ci_67                -8.324594e-04 3 1  ON 66
ci_68                -8.215254e-04 3 1  ON 67
ci_69                -5.704894e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8494
    reference variance = 0.731434
====================================================
  Execution time = 2.5467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9923e-01
  Total weights = 1.9633e+06
  Execution time = 3.5607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485710049937
                                         uncertainty =       0.003009439930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.485710049937
                                         uncertainty =       0.003009439930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492767448
  error estimate for blocks of size 2^( 2) =       0.000513569144
  error estimate for blocks of size 2^( 3) =       0.000532991534
  error estimate for blocks of size 2^( 4) =       0.000547794180
  error estimate for blocks of size 2^( 5) =       0.000557299374
  error estimate for blocks of size 2^( 6) =       0.000561926168
  error estimate for blocks of size 2^( 7) =       0.000564990350

      target function =                  N/A
              le_mean =     -22.818120081005
             les_mean =     521.200655844428
             stat err =       0.000558002518
             autocorr =       1.282296022492
              std dev =       0.696878408376
             le_variance =       0.485639516061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580027484881
                                         uncertainty =       0.098654592143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.580027484881
                                         uncertainty =       0.098654592143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000538388683
  error estimate for blocks of size 2^( 2) =       0.000557513457
  error estimate for blocks of size 2^( 3) =       0.000575532895
  error estimate for blocks of size 2^( 4) =       0.000589066027
  error estimate for blocks of size 2^( 5) =       0.000598051069
  error estimate for blocks of size 2^( 6) =       0.000602499591
  error estimate for blocks of size 2^( 7) =       0.000605623993

      target function =                  N/A
              le_mean =     -22.818424404070
             les_mean =     523.078269839965
             stat err =       0.000598810170
             autocorr =       1.237047826864
              std dev =       0.761396577542
             le_variance =       0.579724748293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479826967631
                                         uncertainty =       0.002917761699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479826967631
                                         uncertainty =       0.002917761699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489774667
  error estimate for blocks of size 2^( 2) =       0.000510693220
  error estimate for blocks of size 2^( 3) =       0.000530310981
  error estimate for blocks of size 2^( 4) =       0.000545254779
  error estimate for blocks of size 2^( 5) =       0.000554775354
  error estimate for blocks of size 2^( 6) =       0.000559407421
  error estimate for blocks of size 2^( 7) =       0.000562429067

      target function =                  N/A
              le_mean =     -22.818130109652
             les_mean =     521.209022350440
             stat err =       0.000555466655
             autocorr =       1.286243965806
              std dev =       0.692645976516
             le_variance =       0.479758448783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484338833984
                                         uncertainty =       0.002960349297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.484338833984
                                         uncertainty =       0.002960349297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000492071860
  error estimate for blocks of size 2^( 2) =       0.000512887351
  error estimate for blocks of size 2^( 3) =       0.000532335524
  error estimate for blocks of size 2^( 4) =       0.000547138737
  error estimate for blocks of size 2^( 5) =       0.000556654639
  error estimate for blocks of size 2^( 6) =       0.000561256582
  error estimate for blocks of size 2^( 7) =       0.000564278903

      target function =                  N/A
              le_mean =     -22.818067622598
             les_mean =     521.173881791786
             stat err =       0.000557332215
             autocorr =       1.282836280687
              std dev =       0.695894698454
             le_variance =       0.484269431337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818120081005        initial
     1.5625e-01     1.5625e+00             1.1726e-02       -22.818424404070  <--
     6.2500e-01     6.2500e+00             4.0992e-03       -22.818130109652
     2.5000e+00     2.5000e+01             1.1443e-03       -22.818067622598

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 4.3365e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_01                 1.348525e-01 3 1  ON 0
ci_02                -3.336508e-02 3 1  ON 1
ci_03                -3.332498e-02 3 1  ON 2
ci_04                 2.969635e-02 3 1  ON 3
ci_05                -2.550201e-02 3 1  ON 4
ci_06                -2.550008e-02 3 1  ON 5
ci_07                 2.665365e-02 3 1  ON 6
ci_08                -6.419714e-03 3 1  ON 7
ci_09                -1.308057e-02 3 1  ON 8
ci_10                -1.375146e-02 3 1  ON 9
ci_11                 1.550579e-02 3 1  ON 10
ci_12                 1.113259e-02 3 1  ON 11
ci_13                 1.170288e-02 3 1  ON 12
ci_14                 1.448837e-02 3 1  ON 13
ci_15                 9.117164e-03 3 1  ON 14
ci_16                 9.430724e-03 3 1  ON 15
ci_17                -1.031752e-02 3 1  ON 16
ci_18                -9.918639e-03 3 1  ON 17
ci_19                 9.663119e-03 3 1  ON 18
ci_20                 1.104246e-02 3 1  ON 19
ci_21                 8.562637e-03 3 1  ON 20
ci_22                 9.280090e-03 3 1  ON 21
ci_23                 6.817482e-03 3 1  ON 22
ci_24                 6.233178e-03 3 1  ON 23
ci_25                 4.590051e-03 3 1  ON 24
ci_26                 2.913926e-03 3 1  ON 25
ci_27                 3.499927e-03 3 1  ON 26
ci_28                 4.563942e-03 3 1  ON 27
ci_29                 4.907130e-03 3 1  ON 28
ci_30                -1.203242e-03 3 1  ON 29
ci_31                -1.506227e-03 3 1  ON 30
ci_32                 6.170404e-04 3 1  ON 31
ci_33                -2.641577e-04 3 1  ON 32
ci_34                -9.555196e-06 3 1  ON 33
ci_35                 7.798050e-04 3 1  ON 34
ci_36                -1.898032e-03 3 1  ON 35
ci_37                -1.134506e-03 3 1  ON 36
ci_38                -9.156024e-04 3 1  ON 37
ci_39                -7.140083e-04 3 1  ON 38
ci_40                -1.601549e-03 3 1  ON 39
ci_41                 9.003511e-04 3 1  ON 40
ci_42                 7.424728e-04 3 1  ON 41
ci_43                -2.168779e-03 3 1  ON 42
ci_44                -2.494570e-03 3 1  ON 43
ci_45                -2.413490e-04 3 1  ON 44
ci_46                -8.238536e-04 3 1  ON 45
ci_47                -1.685316e-03 3 1  ON 46
ci_48                -7.474571e-04 3 1  ON 47
ci_49                -1.193372e-03 3 1  ON 48
ci_50                -4.386381e-04 3 1  ON 49
ci_51                 2.625491e-04 3 1  ON 50
ci_52                 3.009139e-04 3 1  ON 51
ci_53                -1.130224e-03 3 1  ON 52
ci_54                -7.073075e-04 3 1  ON 53
ci_55                -5.025332e-04 3 1  ON 54
ci_56                 1.552515e-03 3 1  ON 55
ci_57                 1.891087e-03 3 1  ON 56
ci_58                -1.601798e-03 3 1  ON 57
ci_59                -1.374688e-03 3 1  ON 58
ci_60                 2.065799e-03 3 1  ON 59
ci_61                 9.704767e-04 3 1  ON 60
ci_62                -8.717882e-04 3 1  ON 61
ci_63                -3.668293e-04 3 1  ON 62
ci_64                -1.047231e-03 3 1  ON 63
ci_65                -6.278693e-04 3 1  ON 64
ci_66                -7.350279e-04 3 1  ON 65
ci_67                -5.856473e-04 3 1  ON 66
ci_68                -1.099361e-03 3 1  ON 67
ci_69                -1.045056e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8748
    reference variance = 1.04675
====================================================
  Execution time = 2.6228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.9544e-01
  Total weights = 1.963748947e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479301397277
                                         uncertainty =       0.004629599770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479301397277
                                         uncertainty =       0.004629599770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489540363
  error estimate for blocks of size 2^( 2) =       0.000510508944
  error estimate for blocks of size 2^( 3) =       0.000530390981
  error estimate for blocks of size 2^( 4) =       0.000545644907
  error estimate for blocks of size 2^( 5) =       0.000555172563
  error estimate for blocks of size 2^( 6) =       0.000562313548
  error estimate for blocks of size 2^( 7) =       0.000563607864

      target function =                  N/A
              le_mean =     -22.817941048172
             les_mean =     521.153874001736
             stat err =       0.000556684720
             autocorr =       1.293128223608
              std dev =       0.692314621245
             le_variance =       0.479299534790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281794104817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.817941048095       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818278366974       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818331082083       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818342451345       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818343604110       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818344147867       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 1.105661e-02

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.817941048095       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818159378911       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818179773247       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818181915562       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818182077983       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 5.712474e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.817941048095       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818031601216       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818036427394       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818036691716       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.982853e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0833e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.291400e-01 3 1  ON 0
ci_02                -2.916884e-02 3 1  ON 1
ci_03                -2.944139e-02 3 1  ON 2
ci_04                 2.682742e-02 3 1  ON 3
ci_05                -2.322968e-02 3 1  ON 4
ci_06                -2.396207e-02 3 1  ON 5
ci_07                 2.621044e-02 3 1  ON 6
ci_08                -5.457553e-03 3 1  ON 7
ci_09                -1.323287e-02 3 1  ON 8
ci_10                -1.224978e-02 3 1  ON 9
ci_11                 1.552543e-02 3 1  ON 10
ci_12                 1.107582e-02 3 1  ON 11
ci_13                 1.160717e-02 3 1  ON 12
ci_14                 1.543554e-02 3 1  ON 13
ci_15                 7.999004e-03 3 1  ON 14
ci_16                 8.858772e-03 3 1  ON 15
ci_17                -9.390650e-03 3 1  ON 16
ci_18                -1.021466e-02 3 1  ON 17
ci_19                 9.471575e-03 3 1  ON 18
ci_20                 1.012109e-02 3 1  ON 19
ci_21                 7.722913e-03 3 1  ON 20
ci_22                 9.104358e-03 3 1  ON 21
ci_23                 6.665742e-03 3 1  ON 22
ci_24                 6.608573e-03 3 1  ON 23
ci_25                 4.201520e-03 3 1  ON 24
ci_26                 2.081756e-03 3 1  ON 25
ci_27                 2.712118e-03 3 1  ON 26
ci_28                 4.748128e-03 3 1  ON 27
ci_29                 4.003681e-03 3 1  ON 28
ci_30                -1.019101e-03 3 1  ON 29
ci_31                -3.614522e-04 3 1  ON 30
ci_32                 2.592800e-05 3 1  ON 31
ci_33                -8.964926e-04 3 1  ON 32
ci_34                 5.155808e-04 3 1  ON 33
ci_35                 2.941718e-04 3 1  ON 34
ci_36                -1.376633e-03 3 1  ON 35
ci_37                -1.220079e-03 3 1  ON 36
ci_38                -4.382951e-04 3 1  ON 37
ci_39                -1.881565e-04 3 1  ON 38
ci_40                -1.502836e-03 3 1  ON 39
ci_41                 8.070242e-04 3 1  ON 40
ci_42                 8.163155e-04 3 1  ON 41
ci_43                -1.456155e-03 3 1  ON 42
ci_44                -2.600082e-03 3 1  ON 43
ci_45                 1.588256e-04 3 1  ON 44
ci_46                -7.375391e-04 3 1  ON 45
ci_47                -1.930398e-03 3 1  ON 46
ci_48                -1.099869e-03 3 1  ON 47
ci_49                -1.202930e-03 3 1  ON 48
ci_50                -5.397256e-04 3 1  ON 49
ci_51                -4.554628e-04 3 1  ON 50
ci_52                 1.966739e-04 3 1  ON 51
ci_53                -8.977798e-04 3 1  ON 52
ci_54                -7.523133e-04 3 1  ON 53
ci_55                -7.892496e-04 3 1  ON 54
ci_56                 1.496537e-03 3 1  ON 55
ci_57                 1.860503e-03 3 1  ON 56
ci_58                -1.846713e-03 3 1  ON 57
ci_59                -1.336705e-03 3 1  ON 58
ci_60                 1.743707e-03 3 1  ON 59
ci_61                 2.093555e-04 3 1  ON 60
ci_62                 4.096762e-06 3 1  ON 61
ci_63                 8.500883e-05 3 1  ON 62
ci_64                -1.404576e-03 3 1  ON 63
ci_65                -4.678930e-04 3 1  ON 64
ci_66                -3.229948e-04 3 1  ON 65
ci_67                -5.672763e-04 3 1  ON 66
ci_68                -1.404727e-03 3 1  ON 67
ci_69                -1.704357e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8307
    reference variance = 0.326292
====================================================
  Execution time = 2.5512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9073e-01
  Total weights = 1.9636e+06
  Execution time = 3.5682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.595850595250
                                         uncertainty =       0.107470549247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.595850595250
                                         uncertainty =       0.107470549247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000545779685
  error estimate for blocks of size 2^( 2) =       0.000564479680
  error estimate for blocks of size 2^( 3) =       0.000582164672
  error estimate for blocks of size 2^( 4) =       0.000595340021
  error estimate for blocks of size 2^( 5) =       0.000605224294
  error estimate for blocks of size 2^( 6) =       0.000608694730
  error estimate for blocks of size 2^( 7) =       0.000610492785

      target function =                  N/A
              le_mean =     -22.819747776905
             les_mean =     530.224952405460
             stat err =       0.000604937957
             autocorr =       1.228533316437
              std dev =       0.771849032632
             le_variance =       0.595750929175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474842763969
                                         uncertainty =       0.002880573648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474842763969
                                         uncertainty =       0.002880573648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487234557
  error estimate for blocks of size 2^( 2) =       0.000508458720
  error estimate for blocks of size 2^( 3) =       0.000528389733
  error estimate for blocks of size 2^( 4) =       0.000543008064
  error estimate for blocks of size 2^( 5) =       0.000554123402
  error estimate for blocks of size 2^( 6) =       0.000558334940
  error estimate for blocks of size 2^( 7) =       0.000561204998

      target function =                  N/A
              le_mean =     -22.819394287867
             les_mean =     521.229337593239
             stat err =       0.000554167851
             autocorr =       1.293619305698
              std dev =       0.689053719084
             le_variance =       0.474795027784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514220125407
                                         uncertainty =       0.038019798834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514220125407
                                         uncertainty =       0.038019798834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507015191
  error estimate for blocks of size 2^( 2) =       0.000527549966
  error estimate for blocks of size 2^( 3) =       0.000546784106
  error estimate for blocks of size 2^( 4) =       0.000561032238
  error estimate for blocks of size 2^( 5) =       0.000571785809
  error estimate for blocks of size 2^( 6) =       0.000575532233
  error estimate for blocks of size 2^( 7) =       0.000577760932

      target function =                  N/A
              le_mean =     -22.819601046773
             les_mean =     522.422485596285
             stat err =       0.000571527803
             autocorr =       1.270670014270
              std dev =       0.717027759002
             le_variance =       0.514128807179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477447510239
                                         uncertainty =       0.003152728670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.477447510239
                                         uncertainty =       0.003152728670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488567097
  error estimate for blocks of size 2^( 2) =       0.000509657790
  error estimate for blocks of size 2^( 3) =       0.000529366273
  error estimate for blocks of size 2^( 4) =       0.000543871935
  error estimate for blocks of size 2^( 5) =       0.000554846711
  error estimate for blocks of size 2^( 6) =       0.000558903805
  error estimate for blocks of size 2^( 7) =       0.000561943768

      target function =                  N/A
              le_mean =     -22.819393875462
             les_mean =     521.643484706939
             stat err =       0.000554891555
             autocorr =       1.289934915945
              std dev =       0.690938214869
             le_variance =       0.477395616766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819747776905        initial  <--
     3.9062e-02     3.9062e-01             1.1057e-02       -22.819394287867
     1.5625e-01     1.5625e+00             5.7125e-03       -22.819601046773
     6.2500e-01     6.2500e+00             1.9829e-03       -22.819393875462

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4492
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_01                 1.348525e-01 3 1  ON 0
ci_02                -3.336508e-02 3 1  ON 1
ci_03                -3.332498e-02 3 1  ON 2
ci_04                 2.969635e-02 3 1  ON 3
ci_05                -2.550201e-02 3 1  ON 4
ci_06                -2.550008e-02 3 1  ON 5
ci_07                 2.665365e-02 3 1  ON 6
ci_08                -6.419714e-03 3 1  ON 7
ci_09                -1.308057e-02 3 1  ON 8
ci_10                -1.375146e-02 3 1  ON 9
ci_11                 1.550579e-02 3 1  ON 10
ci_12                 1.113259e-02 3 1  ON 11
ci_13                 1.170288e-02 3 1  ON 12
ci_14                 1.448837e-02 3 1  ON 13
ci_15                 9.117164e-03 3 1  ON 14
ci_16                 9.430724e-03 3 1  ON 15
ci_17                -1.031752e-02 3 1  ON 16
ci_18                -9.918639e-03 3 1  ON 17
ci_19                 9.663119e-03 3 1  ON 18
ci_20                 1.104246e-02 3 1  ON 19
ci_21                 8.562637e-03 3 1  ON 20
ci_22                 9.280090e-03 3 1  ON 21
ci_23                 6.817482e-03 3 1  ON 22
ci_24                 6.233178e-03 3 1  ON 23
ci_25                 4.590051e-03 3 1  ON 24
ci_26                 2.913926e-03 3 1  ON 25
ci_27                 3.499927e-03 3 1  ON 26
ci_28                 4.563942e-03 3 1  ON 27
ci_29                 4.907130e-03 3 1  ON 28
ci_30                -1.203242e-03 3 1  ON 29
ci_31                -1.506227e-03 3 1  ON 30
ci_32                 6.170404e-04 3 1  ON 31
ci_33                -2.641577e-04 3 1  ON 32
ci_34                -9.555196e-06 3 1  ON 33
ci_35                 7.798050e-04 3 1  ON 34
ci_36                -1.898032e-03 3 1  ON 35
ci_37                -1.134506e-03 3 1  ON 36
ci_38                -9.156024e-04 3 1  ON 37
ci_39                -7.140083e-04 3 1  ON 38
ci_40                -1.601549e-03 3 1  ON 39
ci_41                 9.003511e-04 3 1  ON 40
ci_42                 7.424728e-04 3 1  ON 41
ci_43                -2.168779e-03 3 1  ON 42
ci_44                -2.494570e-03 3 1  ON 43
ci_45                -2.413490e-04 3 1  ON 44
ci_46                -8.238536e-04 3 1  ON 45
ci_47                -1.685316e-03 3 1  ON 46
ci_48                -7.474571e-04 3 1  ON 47
ci_49                -1.193372e-03 3 1  ON 48
ci_50                -4.386381e-04 3 1  ON 49
ci_51                 2.625491e-04 3 1  ON 50
ci_52                 3.009139e-04 3 1  ON 51
ci_53                -1.130224e-03 3 1  ON 52
ci_54                -7.073075e-04 3 1  ON 53
ci_55                -5.025332e-04 3 1  ON 54
ci_56                 1.552515e-03 3 1  ON 55
ci_57                 1.891087e-03 3 1  ON 56
ci_58                -1.601798e-03 3 1  ON 57
ci_59                -1.374688e-03 3 1  ON 58
ci_60                 2.065799e-03 3 1  ON 59
ci_61                 9.704767e-04 3 1  ON 60
ci_62                -8.717882e-04 3 1  ON 61
ci_63                -3.668293e-04 3 1  ON 62
ci_64                -1.047231e-03 3 1  ON 63
ci_65                -6.278693e-04 3 1  ON 64
ci_66                -7.350279e-04 3 1  ON 65
ci_67                -5.856473e-04 3 1  ON 66
ci_68                -1.099361e-03 3 1  ON 67
ci_69                -1.045056e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.774
    reference variance = 0.317156
====================================================
  Execution time = 2.6140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9042e-01
  Total weights = 1.963488313e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475131521552
                                         uncertainty =       0.002561570722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475131521552
                                         uncertainty =       0.002561570722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487357096
  error estimate for blocks of size 2^( 2) =       0.000508260268
  error estimate for blocks of size 2^( 3) =       0.000527932278
  error estimate for blocks of size 2^( 4) =       0.000542369035
  error estimate for blocks of size 2^( 5) =       0.000550419982
  error estimate for blocks of size 2^( 6) =       0.000555768775
  error estimate for blocks of size 2^( 7) =       0.000558049460

      target function =                  N/A
              le_mean =     -22.819232621137
             les_mean =     521.207800090184
             stat err =       0.000551651813
             autocorr =       1.281254821037
              std dev =       0.689227014377
             le_variance =       0.475033877347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281923262114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819232621101       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819397898944       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819414435178       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819416108895       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819416236582       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.383676e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819232621101       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819287035835       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819291438859       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819291960904       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819292021683       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 9.939738e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819232621101       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819247395295       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819248534165       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819248672548       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819248694171       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.601911e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0742e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.338585e-01 3 1  ON 0
ci_02                -3.259634e-02 3 1  ON 1
ci_03                -3.247461e-02 3 1  ON 2
ci_04                 2.890411e-02 3 1  ON 3
ci_05                -2.507638e-02 3 1  ON 4
ci_06                -2.507997e-02 3 1  ON 5
ci_07                 2.650232e-02 3 1  ON 6
ci_08                -6.106068e-03 3 1  ON 7
ci_09                -1.298664e-02 3 1  ON 8
ci_10                -1.359449e-02 3 1  ON 9
ci_11                 1.568415e-02 3 1  ON 10
ci_12                 1.099731e-02 3 1  ON 11
ci_13                 1.169417e-02 3 1  ON 12
ci_14                 1.448224e-02 3 1  ON 13
ci_15                 9.030059e-03 3 1  ON 14
ci_16                 9.209597e-03 3 1  ON 15
ci_17                -1.026566e-02 3 1  ON 16
ci_18                -9.909159e-03 3 1  ON 17
ci_19                 9.461913e-03 3 1  ON 18
ci_20                 1.106579e-02 3 1  ON 19
ci_21                 8.621857e-03 3 1  ON 20
ci_22                 9.170537e-03 3 1  ON 21
ci_23                 6.828101e-03 3 1  ON 22
ci_24                 6.322719e-03 3 1  ON 23
ci_25                 4.623532e-03 3 1  ON 24
ci_26                 2.950178e-03 3 1  ON 25
ci_27                 3.255038e-03 3 1  ON 26
ci_28                 4.677483e-03 3 1  ON 27
ci_29                 4.864494e-03 3 1  ON 28
ci_30                -1.185685e-03 3 1  ON 29
ci_31                -1.315340e-03 3 1  ON 30
ci_32                 5.498377e-04 3 1  ON 31
ci_33                -2.693323e-04 3 1  ON 32
ci_34                -2.464914e-05 3 1  ON 33
ci_35                 7.045324e-04 3 1  ON 34
ci_36                -1.647237e-03 3 1  ON 35
ci_37                -1.129937e-03 3 1  ON 36
ci_38                -7.692420e-04 3 1  ON 37
ci_39                -6.587855e-04 3 1  ON 38
ci_40                -1.548842e-03 3 1  ON 39
ci_41                 8.589289e-04 3 1  ON 40
ci_42                 5.763409e-04 3 1  ON 41
ci_43                -2.195185e-03 3 1  ON 42
ci_44                -2.505310e-03 3 1  ON 43
ci_45                -3.005233e-04 3 1  ON 44
ci_46                -7.780567e-04 3 1  ON 45
ci_47                -1.739036e-03 3 1  ON 46
ci_48                -8.152914e-04 3 1  ON 47
ci_49                -1.279444e-03 3 1  ON 48
ci_50                -4.248140e-04 3 1  ON 49
ci_51                 2.475507e-04 3 1  ON 50
ci_52                 3.660613e-04 3 1  ON 51
ci_53                -1.142413e-03 3 1  ON 52
ci_54                -7.689611e-04 3 1  ON 53
ci_55                -5.006778e-04 3 1  ON 54
ci_56                 1.483611e-03 3 1  ON 55
ci_57                 1.843845e-03 3 1  ON 56
ci_58                -1.505012e-03 3 1  ON 57
ci_59                -1.519944e-03 3 1  ON 58
ci_60                 2.122010e-03 3 1  ON 59
ci_61                 9.823041e-04 3 1  ON 60
ci_62                -8.643331e-04 3 1  ON 61
ci_63                -4.383406e-04 3 1  ON 62
ci_64                -1.114828e-03 3 1  ON 63
ci_65                -6.495057e-04 3 1  ON 64
ci_66                -6.795023e-04 3 1  ON 65
ci_67                -5.285461e-04 3 1  ON 66
ci_68                -1.115545e-03 3 1  ON 67
ci_69                -9.300645e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.9793
    reference variance = 3.01278
====================================================
  Execution time = 2.5749e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2817e+01
  VMC Evar = 4.7718e-01
  Total weights = 1.9635e+06
  Execution time = 3.5655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465008726700
                                         uncertainty =       0.002001073372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465008726700
                                         uncertainty =       0.002001073372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482254049
  error estimate for blocks of size 2^( 2) =       0.000503331971
  error estimate for blocks of size 2^( 3) =       0.000524732129
  error estimate for blocks of size 2^( 4) =       0.000539078946
  error estimate for blocks of size 2^( 5) =       0.000548382008
  error estimate for blocks of size 2^( 6) =       0.000553756227
  error estimate for blocks of size 2^( 7) =       0.000553394554

      target function =                  N/A
              le_mean =     -22.817030691700
             les_mean =     521.095345764611
             stat err =       0.000548652934
             autocorr =       1.294325915389
              std dev =       0.682010216143
             le_variance =       0.465137934923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463943299409
                                         uncertainty =       0.001991807230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463943299409
                                         uncertainty =       0.001991807230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481702073
  error estimate for blocks of size 2^( 2) =       0.000502845312
  error estimate for blocks of size 2^( 3) =       0.000524328201
  error estimate for blocks of size 2^( 4) =       0.000538744938
  error estimate for blocks of size 2^( 5) =       0.000548086587
  error estimate for blocks of size 2^( 6) =       0.000553521849
  error estimate for blocks of size 2^( 7) =       0.000553210890

      target function =                  N/A
              le_mean =     -22.817053892067
             les_mean =     521.109694538755
             stat err =       0.000548391066
             autocorr =       1.296055832922
              std dev =       0.681229604957
             le_variance =       0.464073774670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464206558328
                                         uncertainty =       0.001992702449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464206558328
                                         uncertainty =       0.001992702449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481838372
  error estimate for blocks of size 2^( 2) =       0.000502957096
  error estimate for blocks of size 2^( 3) =       0.000524411335
  error estimate for blocks of size 2^( 4) =       0.000538798604
  error estimate for blocks of size 2^( 5) =       0.000548128084
  error estimate for blocks of size 2^( 6) =       0.000553537240
  error estimate for blocks of size 2^( 7) =       0.000553213054

      target function =                  N/A
              le_mean =     -22.817031079654
             les_mean =     521.096112912087
             stat err =       0.000548419246
             autocorr =       1.295455827448
              std dev =       0.681422360124
             le_variance =       0.464336432877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464899700138
                                         uncertainty =       0.002000631681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.464899700138
                                         uncertainty =       0.002000631681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482197545
  error estimate for blocks of size 2^( 2) =       0.000503280954
  error estimate for blocks of size 2^( 3) =       0.000524691372
  error estimate for blocks of size 2^( 4) =       0.000539047441
  error estimate for blocks of size 2^( 5) =       0.000548353154
  error estimate for blocks of size 2^( 6) =       0.000553727873
  error estimate for blocks of size 2^( 7) =       0.000553390629

      target function =                  N/A
              le_mean =     -22.817030266345
             les_mean =     521.120616505953
             stat err =       0.000548629774
             autocorr =       1.294519978717
              std dev =       0.681930307268
             le_variance =       0.465028943971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.817030691700        initial
     3.9062e-01     3.9062e+00             3.3837e-03       -22.817053892067  <--
     1.5625e+00     1.5625e+01             9.9397e-04       -22.817031079654
     6.2500e+00     6.2500e+01             2.6019e-04       -22.817030266345

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 4.3686e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_01                 1.314688e-01 3 1  ON 0
ci_02                -3.100872e-02 3 1  ON 1
ci_03                -3.072393e-02 3 1  ON 2
ci_04                 2.743931e-02 3 1  ON 3
ci_05                -2.427402e-02 3 1  ON 4
ci_06                -2.428040e-02 3 1  ON 5
ci_07                 2.618650e-02 3 1  ON 6
ci_08                -5.525188e-03 3 1  ON 7
ci_09                -1.280183e-02 3 1  ON 8
ci_10                -1.325634e-02 3 1  ON 9
ci_11                 1.609907e-02 3 1  ON 10
ci_12                 1.072080e-02 3 1  ON 11
ci_13                 1.169834e-02 3 1  ON 12
ci_14                 1.449846e-02 3 1  ON 13
ci_15                 8.860345e-03 3 1  ON 14
ci_16                 8.746050e-03 3 1  ON 15
ci_17                -1.014036e-02 3 1  ON 16
ci_18                -9.875239e-03 3 1  ON 17
ci_19                 9.123063e-03 3 1  ON 18
ci_20                 1.112595e-02 3 1  ON 19
ci_21                 8.748569e-03 3 1  ON 20
ci_22                 8.904758e-03 3 1  ON 21
ci_23                 6.841695e-03 3 1  ON 22
ci_24                 6.533000e-03 3 1  ON 23
ci_25                 4.688124e-03 3 1  ON 24
ci_26                 3.048778e-03 3 1  ON 25
ci_27                 2.746474e-03 3 1  ON 26
ci_28                 4.881446e-03 3 1  ON 27
ci_29                 4.748276e-03 3 1  ON 28
ci_30                -1.137457e-03 3 1  ON 29
ci_31                -8.578532e-04 3 1  ON 30
ci_32                 3.844635e-04 3 1  ON 31
ci_33                -3.088621e-04 3 1  ON 32
ci_34                 4.644536e-09 3 1  ON 33
ci_35                 6.010669e-04 3 1  ON 34
ci_36                -1.203671e-03 3 1  ON 35
ci_37                -1.109405e-03 3 1  ON 36
ci_38                -5.070345e-04 3 1  ON 37
ci_39                -5.507160e-04 3 1  ON 38
ci_40                -1.459789e-03 3 1  ON 39
ci_41                 7.429917e-04 3 1  ON 40
ci_42                 2.293338e-04 3 1  ON 41
ci_43                -2.232213e-03 3 1  ON 42
ci_44                -2.501301e-03 3 1  ON 43
ci_45                -3.991479e-04 3 1  ON 44
ci_46                -7.078578e-04 3 1  ON 45
ci_47                -1.820768e-03 3 1  ON 46
ci_48                -9.567482e-04 3 1  ON 47
ci_49                -1.429487e-03 3 1  ON 48
ci_50                -4.111794e-04 3 1  ON 49
ci_51                 2.064150e-04 3 1  ON 50
ci_52                 4.749841e-04 3 1  ON 51
ci_53                -1.160881e-03 3 1  ON 52
ci_54                -8.989424e-04 3 1  ON 53
ci_55                -4.884850e-04 3 1  ON 54
ci_56                 1.372243e-03 3 1  ON 55
ci_57                 1.759483e-03 3 1  ON 56
ci_58                -1.312884e-03 3 1  ON 57
ci_59                -1.819340e-03 3 1  ON 58
ci_60                 2.254743e-03 3 1  ON 59
ci_61                 1.010919e-03 3 1  ON 60
ci_62                -8.440123e-04 3 1  ON 61
ci_63                -5.476473e-04 3 1  ON 62
ci_64                -1.232249e-03 3 1  ON 63
ci_65                -6.763422e-04 3 1  ON 64
ci_66                -5.750957e-04 3 1  ON 65
ci_67                -4.071137e-04 3 1  ON 66
ci_68                -1.150227e-03 3 1  ON 67
ci_69                -7.011967e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.8294
    reference variance = 0.519949
====================================================
  Execution time = 2.6298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8939e-01
  Total weights = 1.963234152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474427191602
                                         uncertainty =       0.002859148741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474427191602
                                         uncertainty =       0.002859148741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487093983
  error estimate for blocks of size 2^( 2) =       0.000507809806
  error estimate for blocks of size 2^( 3) =       0.000527780089
  error estimate for blocks of size 2^( 4) =       0.000543954125
  error estimate for blocks of size 2^( 5) =       0.000551679048
  error estimate for blocks of size 2^( 6) =       0.000557142879
  error estimate for blocks of size 2^( 7) =       0.000559193561

      target function =                  N/A
              le_mean =     -22.819520815969
             les_mean =     521.219916914722
             stat err =       0.000552992403
             autocorr =       1.288880939382
              std dev =       0.688854916614
             le_variance =       0.474521096143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281952081597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819520815945       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819657487060       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819682272636       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819685585559       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819685823388       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819685866514       residual = 3.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 7.382645e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819520815945       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819584452350       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819591454538       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819591901878       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.776677e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819520815945       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819541097995       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819542890116       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819542970955       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.986000e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0902e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.286921e-01 3 1  ON 0
ci_02                -2.939549e-02 3 1  ON 1
ci_03                -2.945508e-02 3 1  ON 2
ci_04                 2.642690e-02 3 1  ON 3
ci_05                -2.392795e-02 3 1  ON 4
ci_06                -2.388745e-02 3 1  ON 5
ci_07                 2.603480e-02 3 1  ON 6
ci_08                -5.234951e-03 3 1  ON 7
ci_09                -1.207310e-02 3 1  ON 8
ci_10                -1.220774e-02 3 1  ON 9
ci_11                 1.591018e-02 3 1  ON 10
ci_12                 1.088702e-02 3 1  ON 11
ci_13                 1.235772e-02 3 1  ON 12
ci_14                 1.461146e-02 3 1  ON 13
ci_15                 8.723822e-03 3 1  ON 14
ci_16                 8.202948e-03 3 1  ON 15
ci_17                -9.715234e-03 3 1  ON 16
ci_18                -9.775452e-03 3 1  ON 17
ci_19                 9.155307e-03 3 1  ON 18
ci_20                 1.108937e-02 3 1  ON 19
ci_21                 8.398789e-03 3 1  ON 20
ci_22                 7.960146e-03 3 1  ON 21
ci_23                 6.551880e-03 3 1  ON 22
ci_24                 6.487557e-03 3 1  ON 23
ci_25                 4.491178e-03 3 1  ON 24
ci_26                 2.665512e-03 3 1  ON 25
ci_27                 2.532639e-03 3 1  ON 26
ci_28                 4.453881e-03 3 1  ON 27
ci_29                 4.817945e-03 3 1  ON 28
ci_30                -1.013771e-03 3 1  ON 29
ci_31                -9.889142e-04 3 1  ON 30
ci_32                 5.642067e-05 3 1  ON 31
ci_33                 5.477149e-05 3 1  ON 32
ci_34                 1.509131e-04 3 1  ON 33
ci_35                 6.288202e-04 3 1  ON 34
ci_36                -8.481449e-04 3 1  ON 35
ci_37                -9.243663e-04 3 1  ON 36
ci_38                -7.936842e-04 3 1  ON 37
ci_39                -3.618461e-04 3 1  ON 38
ci_40                -1.398687e-03 3 1  ON 39
ci_41                 1.062735e-03 3 1  ON 40
ci_42                 4.177977e-04 3 1  ON 41
ci_43                -2.102840e-03 3 1  ON 42
ci_44                -2.936523e-03 3 1  ON 43
ci_45                -1.136417e-04 3 1  ON 44
ci_46                -5.395269e-04 3 1  ON 45
ci_47                -1.703139e-03 3 1  ON 46
ci_48                -7.597088e-04 3 1  ON 47
ci_49                -1.562084e-03 3 1  ON 48
ci_50                -6.421719e-04 3 1  ON 49
ci_51                 3.641196e-04 3 1  ON 50
ci_52                 4.038555e-04 3 1  ON 51
ci_53                -1.115276e-03 3 1  ON 52
ci_54                -9.878846e-04 3 1  ON 53
ci_55                -5.647936e-04 3 1  ON 54
ci_56                 1.398936e-03 3 1  ON 55
ci_57                 1.575883e-03 3 1  ON 56
ci_58                -1.491517e-03 3 1  ON 57
ci_59                -1.380030e-03 3 1  ON 58
ci_60                 2.512931e-03 3 1  ON 59
ci_61                 1.256861e-03 3 1  ON 60
ci_62                -7.875684e-04 3 1  ON 61
ci_63                -1.402340e-04 3 1  ON 62
ci_64                -9.329626e-04 3 1  ON 63
ci_65                -4.509928e-04 3 1  ON 64
ci_66                -7.728888e-04 3 1  ON 65
ci_67                 8.144446e-05 3 1  ON 66
ci_68                -1.733055e-03 3 1  ON 67
ci_69                -8.230735e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7698
    reference variance = 0.371311
====================================================
  Execution time = 2.5759e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8689e-01
  Total weights = 1.9637e+06
  Execution time = 3.5520e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472796592900
                                         uncertainty =       0.002397448912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472796592900
                                         uncertainty =       0.002397448912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486222589
  error estimate for blocks of size 2^( 2) =       0.000507254027
  error estimate for blocks of size 2^( 3) =       0.000527329254
  error estimate for blocks of size 2^( 4) =       0.000542694759
  error estimate for blocks of size 2^( 5) =       0.000552654464
  error estimate for blocks of size 2^( 6) =       0.000557510653
  error estimate for blocks of size 2^( 7) =       0.000557120322

      target function =                  N/A
              le_mean =     -22.818865929066
             les_mean =     521.211728892817
             stat err =       0.000552495050
             autocorr =       1.291179192046
              std dev =       0.687622580100
             le_variance =       0.472824812663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471613935155
                                         uncertainty =       0.002360349770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471613935155
                                         uncertainty =       0.002360349770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485617268
  error estimate for blocks of size 2^( 2) =       0.000506780753
  error estimate for blocks of size 2^( 3) =       0.000526990688
  error estimate for blocks of size 2^( 4) =       0.000542490542
  error estimate for blocks of size 2^( 5) =       0.000552540451
  error estimate for blocks of size 2^( 6) =       0.000557469056
  error estimate for blocks of size 2^( 7) =       0.000557052497

      target function =                  N/A
              le_mean =     -22.818920928971
             les_mean =     521.203480246664
             stat err =       0.000552388136
             autocorr =       1.293899196443
              std dev =       0.686766526237
             le_variance =       0.471648261560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471748445132
                                         uncertainty =       0.002338642155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471748445132
                                         uncertainty =       0.002338642155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485685765
  error estimate for blocks of size 2^( 2) =       0.000506833490
  error estimate for blocks of size 2^( 3) =       0.000527022383
  error estimate for blocks of size 2^( 4) =       0.000542506681
  error estimate for blocks of size 2^( 5) =       0.000552548544
  error estimate for blocks of size 2^( 6) =       0.000557468056
  error estimate for blocks of size 2^( 7) =       0.000557076412

      target function =                  N/A
              le_mean =     -22.818895827449
             les_mean =     521.212534744485
             stat err =       0.000552399923
             autocorr =       1.293589465958
              std dev =       0.686863395374
             le_variance =       0.471781323904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472493015749
                                         uncertainty =       0.002390490968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472493015749
                                         uncertainty =       0.002390490968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486066741
  error estimate for blocks of size 2^( 2) =       0.000507129125
  error estimate for blocks of size 2^( 3) =       0.000527228547
  error estimate for blocks of size 2^( 4) =       0.000542605325
  error estimate for blocks of size 2^( 5) =       0.000552581328
  error estimate for blocks of size 2^( 6) =       0.000557426959
  error estimate for blocks of size 2^( 7) =       0.000556957272

      target function =                  N/A
              le_mean =     -22.818855670121
             les_mean =     521.215274017764
             stat err =       0.000552392721
             autocorr =       1.291528764303
              std dev =       0.687402177209
             le_variance =       0.472521753232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818865929066        initial
     9.7656e-02     9.7656e-01             7.3826e-03       -22.818920928971  <--
     3.9062e-01     3.9062e+00             2.7767e-03       -22.818895827449
     1.5625e+00     1.5625e+01             7.9860e-04       -22.818855670121

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.3863e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_01                 1.240862e-01 3 1  ON 0
ci_02                -2.769085e-02 3 1  ON 1
ci_03                -2.815100e-02 3 1  ON 2
ci_04                 2.555805e-02 3 1  ON 3
ci_05                -2.374726e-02 3 1  ON 4
ci_06                -2.369857e-02 3 1  ON 5
ci_07                 2.579041e-02 3 1  ON 6
ci_08                -4.935076e-03 3 1  ON 7
ci_09                -1.116358e-02 3 1  ON 8
ci_10                -1.089614e-02 3 1  ON 9
ci_11                 1.574588e-02 3 1  ON 10
ci_12                 1.111403e-02 3 1  ON 11
ci_13                 1.321935e-02 3 1  ON 12
ci_14                 1.494059e-02 3 1  ON 13
ci_15                 8.616828e-03 3 1  ON 14
ci_16                 7.647244e-03 3 1  ON 15
ci_17                -9.229047e-03 3 1  ON 16
ci_18                -9.624303e-03 3 1  ON 17
ci_19                 9.182742e-03 3 1  ON 18
ci_20                 1.105125e-02 3 1  ON 19
ci_21                 8.065126e-03 3 1  ON 20
ci_22                 6.792399e-03 3 1  ON 21
ci_23                 6.333204e-03 3 1  ON 22
ci_24                 6.463567e-03 3 1  ON 23
ci_25                 4.313843e-03 3 1  ON 24
ci_26                 2.285977e-03 3 1  ON 25
ci_27                 2.320564e-03 3 1  ON 26
ci_28                 3.895120e-03 3 1  ON 27
ci_29                 4.787739e-03 3 1  ON 28
ci_30                -7.546824e-04 3 1  ON 29
ci_31                -1.054995e-03 3 1  ON 30
ci_32                -2.795607e-04 3 1  ON 31
ci_33                 3.306537e-04 3 1  ON 32
ci_34                 4.335280e-04 3 1  ON 33
ci_35                 8.309706e-04 3 1  ON 34
ci_36                -5.213450e-04 3 1  ON 35
ci_37                -7.908299e-04 3 1  ON 36
ci_38                -1.028190e-03 3 1  ON 37
ci_39                -2.150935e-04 3 1  ON 38
ci_40                -1.344522e-03 3 1  ON 39
ci_41                 1.322487e-03 3 1  ON 40
ci_42                 5.291780e-04 3 1  ON 41
ci_43                -1.968403e-03 3 1  ON 42
ci_44                -3.365551e-03 3 1  ON 43
ci_45                 1.421629e-04 3 1  ON 44
ci_46                -4.108904e-04 3 1  ON 45
ci_47                -1.554623e-03 3 1  ON 46
ci_48                -5.514178e-04 3 1  ON 47
ci_49                -1.670400e-03 3 1  ON 48
ci_50                -7.824965e-04 3 1  ON 49
ci_51                 4.718408e-04 3 1  ON 50
ci_52                 3.358712e-04 3 1  ON 51
ci_53                -1.073272e-03 3 1  ON 52
ci_54                -1.087028e-03 3 1  ON 53
ci_55                -6.477047e-04 3 1  ON 54
ci_56                 1.441595e-03 3 1  ON 55
ci_57                 1.422346e-03 3 1  ON 56
ci_58                -1.688692e-03 3 1  ON 57
ci_59                -9.405792e-04 3 1  ON 58
ci_60                 2.977750e-03 3 1  ON 59
ci_61                 1.680089e-03 3 1  ON 60
ci_62                -7.474338e-04 3 1  ON 61
ci_63                 1.531474e-04 3 1  ON 62
ci_64                -6.498213e-04 3 1  ON 63
ci_65                -2.434400e-04 3 1  ON 64
ci_66                -9.680364e-04 3 1  ON 65
ci_67                 5.327615e-04 3 1  ON 66
ci_68                -2.292053e-03 3 1  ON 67
ci_69                -9.650924e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7972
    reference variance = 0.299998
====================================================
  Execution time = 2.8120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8584e-01
  Total weights = 1.963686262e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470986899292
                                         uncertainty =       0.002465142011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470986899292
                                         uncertainty =       0.002465142011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485274802
  error estimate for blocks of size 2^( 2) =       0.000506634310
  error estimate for blocks of size 2^( 3) =       0.000526935471
  error estimate for blocks of size 2^( 4) =       0.000542254610
  error estimate for blocks of size 2^( 5) =       0.000552214591
  error estimate for blocks of size 2^( 6) =       0.000556753659
  error estimate for blocks of size 2^( 7) =       0.000560472420

      target function =                  N/A
              le_mean =     -22.819912690312
             les_mean =     521.234250437140
             stat err =       0.000552923820
             autocorr =       1.298240393690
              std dev =       0.686282206155
             le_variance =       0.470983266485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281991269031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819912690252       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819979282592       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819999894713       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820003739671       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820004563317       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.820004465259       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 5.996142e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819912690252       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819962093719       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819972077411       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819973331073       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819973524478       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 3.585576e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819912690252       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819936997033       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819939204673       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819939468995       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.399270e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2728e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.205006e-01 3 1  ON 0
ci_02                -2.666547e-02 3 1  ON 1
ci_03                -2.668946e-02 3 1  ON 2
ci_04                 2.445572e-02 3 1  ON 3
ci_05                -2.264771e-02 3 1  ON 4
ci_06                -2.273234e-02 3 1  ON 5
ci_07                 2.494784e-02 3 1  ON 6
ci_08                -4.378971e-03 3 1  ON 7
ci_09                -1.174403e-02 3 1  ON 8
ci_10                -1.098527e-02 3 1  ON 9
ci_11                 1.666168e-02 3 1  ON 10
ci_12                 9.656869e-03 3 1  ON 11
ci_13                 1.326267e-02 3 1  ON 12
ci_14                 1.517537e-02 3 1  ON 13
ci_15                 8.424499e-03 3 1  ON 14
ci_16                 8.125669e-03 3 1  ON 15
ci_17                -9.267807e-03 3 1  ON 16
ci_18                -9.299707e-03 3 1  ON 17
ci_19                 9.391511e-03 3 1  ON 18
ci_20                 1.077584e-02 3 1  ON 19
ci_21                 8.020332e-03 3 1  ON 20
ci_22                 7.461131e-03 3 1  ON 21
ci_23                 6.722209e-03 3 1  ON 22
ci_24                 7.444515e-03 3 1  ON 23
ci_25                 4.927513e-03 3 1  ON 24
ci_26                 1.333200e-03 3 1  ON 25
ci_27                 2.322705e-03 3 1  ON 26
ci_28                 3.832103e-03 3 1  ON 27
ci_29                 4.852165e-03 3 1  ON 28
ci_30                 1.211391e-04 3 1  ON 29
ci_31                 5.702537e-04 3 1  ON 30
ci_32                -1.016358e-03 3 1  ON 31
ci_33                 5.637470e-04 3 1  ON 32
ci_34                 9.859106e-04 3 1  ON 33
ci_35                 2.435968e-04 3 1  ON 34
ci_36                -6.706047e-04 3 1  ON 35
ci_37                -5.810898e-04 3 1  ON 36
ci_38                -1.097013e-03 3 1  ON 37
ci_39                -4.744790e-04 3 1  ON 38
ci_40                -1.413124e-03 3 1  ON 39
ci_41                 1.107172e-03 3 1  ON 40
ci_42                -4.589893e-05 3 1  ON 41
ci_43                -2.007804e-03 3 1  ON 42
ci_44                -2.701326e-03 3 1  ON 43
ci_45                -6.557955e-04 3 1  ON 44
ci_46                 8.514471e-05 3 1  ON 45
ci_47                -7.977620e-04 3 1  ON 46
ci_48                -1.098400e-04 3 1  ON 47
ci_49                -8.846902e-04 3 1  ON 48
ci_50                -5.337174e-04 3 1  ON 49
ci_51                 3.764943e-04 3 1  ON 50
ci_52                -3.094260e-05 3 1  ON 51
ci_53                -6.891337e-04 3 1  ON 52
ci_54                -1.188219e-03 3 1  ON 53
ci_55                -1.284561e-03 3 1  ON 54
ci_56                 1.451103e-03 3 1  ON 55
ci_57                 1.512146e-03 3 1  ON 56
ci_58                -1.568260e-03 3 1  ON 57
ci_59                -1.748372e-03 3 1  ON 58
ci_60                 2.724263e-03 3 1  ON 59
ci_61                 1.776956e-03 3 1  ON 60
ci_62                -3.091101e-04 3 1  ON 61
ci_63                 2.781742e-04 3 1  ON 62
ci_64                -7.130114e-04 3 1  ON 63
ci_65                 2.512711e-04 3 1  ON 64
ci_66                -3.779832e-04 3 1  ON 65
ci_67                -6.876976e-04 3 1  ON 66
ci_68                -9.477079e-04 3 1  ON 67
ci_69                -1.552596e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7433
    reference variance = 0.311663
====================================================
  Execution time = 2.5666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8815e-01
  Total weights = 1.9636e+06
  Execution time = 3.5701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0354705
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473322322877
                                         uncertainty =       0.002864150768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473322322877
                                         uncertainty =       0.002864150768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486509764
  error estimate for blocks of size 2^( 2) =       0.000507736376
  error estimate for blocks of size 2^( 3) =       0.000527975623
  error estimate for blocks of size 2^( 4) =       0.000544104431
  error estimate for blocks of size 2^( 5) =       0.000553223424
  error estimate for blocks of size 2^( 6) =       0.000558604582
  error estimate for blocks of size 2^( 7) =       0.000561332371

      target function =                  N/A
              le_mean =     -22.819751365660
             les_mean =     521.263201048584
             stat err =       0.000554316202
             autocorr =       1.298171361395
              std dev =       0.688028706313
             le_variance =       0.473383500711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472211946170
                                         uncertainty =       0.002852990985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472211946170
                                         uncertainty =       0.002852990985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485932942
  error estimate for blocks of size 2^( 2) =       0.000507259139
  error estimate for blocks of size 2^( 3) =       0.000527629885
  error estimate for blocks of size 2^( 4) =       0.000543868935
  error estimate for blocks of size 2^( 5) =       0.000553081214
  error estimate for blocks of size 2^( 6) =       0.000558479534
  error estimate for blocks of size 2^( 7) =       0.000561251413

      target function =                  N/A
              le_mean =     -22.819696492550
             les_mean =     521.231208234370
             stat err =       0.000554170274
             autocorr =       1.300570112435
              std dev =       0.687212956879
             le_variance =       0.472261648103

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0361207
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473647297368
                                         uncertainty =       0.003039662692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473647297368
                                         uncertainty =       0.003039662692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486668678
  error estimate for blocks of size 2^( 2) =       0.000508002979
  error estimate for blocks of size 2^( 3) =       0.000528345716
  error estimate for blocks of size 2^( 4) =       0.000544573923
  error estimate for blocks of size 2^( 5) =       0.000553806750
  error estimate for blocks of size 2^( 6) =       0.000559203586
  error estimate for blocks of size 2^( 7) =       0.000561943172

      target function =                  N/A
              le_mean =     -22.819757945593
             les_mean =     521.405090057522
             stat err =       0.000554881858
             autocorr =       1.299972778545
              std dev =       0.688253445418
             le_variance =       0.473692805130

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.291567
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472689116430
                                         uncertainty =       0.002857515269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472689116430
                                         uncertainty =       0.002857515269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486182077
  error estimate for blocks of size 2^( 2) =       0.000507443938
  error estimate for blocks of size 2^( 3) =       0.000527736320
  error estimate for blocks of size 2^( 4) =       0.000543915221
  error estimate for blocks of size 2^( 5) =       0.000553067864
  error estimate for blocks of size 2^( 6) =       0.000558483444
  error estimate for blocks of size 2^( 7) =       0.000561213664

      target function =                  N/A
              le_mean =     -22.819697271553
             les_mean =     521.573678096332
             stat err =       0.000554170048
             autocorr =       1.299236488660
              std dev =       0.687565287388
             le_variance =       0.472746024421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819751365660        initial
     2.4414e-02     2.4414e-01             5.9961e-03       -22.819696492550
     9.7656e-02     9.7656e-01             3.5856e-03       -22.819757945593  <--
     3.9062e-01     3.9062e+00             1.3993e-03       -22.819697271553

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 4.3612e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_01                 1.205006e-01 3 1  ON 0
ci_02                -2.666547e-02 3 1  ON 1
ci_03                -2.668946e-02 3 1  ON 2
ci_04                 2.445572e-02 3 1  ON 3
ci_05                -2.264771e-02 3 1  ON 4
ci_06                -2.273234e-02 3 1  ON 5
ci_07                 2.494784e-02 3 1  ON 6
ci_08                -4.378971e-03 3 1  ON 7
ci_09                -1.174403e-02 3 1  ON 8
ci_10                -1.098527e-02 3 1  ON 9
ci_11                 1.666168e-02 3 1  ON 10
ci_12                 9.656869e-03 3 1  ON 11
ci_13                 1.326267e-02 3 1  ON 12
ci_14                 1.517537e-02 3 1  ON 13
ci_15                 8.424499e-03 3 1  ON 14
ci_16                 8.125669e-03 3 1  ON 15
ci_17                -9.267807e-03 3 1  ON 16
ci_18                -9.299707e-03 3 1  ON 17
ci_19                 9.391511e-03 3 1  ON 18
ci_20                 1.077584e-02 3 1  ON 19
ci_21                 8.020332e-03 3 1  ON 20
ci_22                 7.461131e-03 3 1  ON 21
ci_23                 6.722209e-03 3 1  ON 22
ci_24                 7.444515e-03 3 1  ON 23
ci_25                 4.927513e-03 3 1  ON 24
ci_26                 1.333200e-03 3 1  ON 25
ci_27                 2.322705e-03 3 1  ON 26
ci_28                 3.832103e-03 3 1  ON 27
ci_29                 4.852165e-03 3 1  ON 28
ci_30                 1.211391e-04 3 1  ON 29
ci_31                 5.702537e-04 3 1  ON 30
ci_32                -1.016358e-03 3 1  ON 31
ci_33                 5.637470e-04 3 1  ON 32
ci_34                 9.859106e-04 3 1  ON 33
ci_35                 2.435968e-04 3 1  ON 34
ci_36                -6.706047e-04 3 1  ON 35
ci_37                -5.810898e-04 3 1  ON 36
ci_38                -1.097013e-03 3 1  ON 37
ci_39                -4.744790e-04 3 1  ON 38
ci_40                -1.413124e-03 3 1  ON 39
ci_41                 1.107172e-03 3 1  ON 40
ci_42                -4.589893e-05 3 1  ON 41
ci_43                -2.007804e-03 3 1  ON 42
ci_44                -2.701326e-03 3 1  ON 43
ci_45                -6.557955e-04 3 1  ON 44
ci_46                 8.514471e-05 3 1  ON 45
ci_47                -7.977620e-04 3 1  ON 46
ci_48                -1.098400e-04 3 1  ON 47
ci_49                -8.846902e-04 3 1  ON 48
ci_50                -5.337174e-04 3 1  ON 49
ci_51                 3.764943e-04 3 1  ON 50
ci_52                -3.094260e-05 3 1  ON 51
ci_53                -6.891337e-04 3 1  ON 52
ci_54                -1.188219e-03 3 1  ON 53
ci_55                -1.284561e-03 3 1  ON 54
ci_56                 1.451103e-03 3 1  ON 55
ci_57                 1.512146e-03 3 1  ON 56
ci_58                -1.568260e-03 3 1  ON 57
ci_59                -1.748372e-03 3 1  ON 58
ci_60                 2.724263e-03 3 1  ON 59
ci_61                 1.776956e-03 3 1  ON 60
ci_62                -3.091101e-04 3 1  ON 61
ci_63                 2.781742e-04 3 1  ON 62
ci_64                -7.130114e-04 3 1  ON 63
ci_65                 2.512711e-04 3 1  ON 64
ci_66                -3.779832e-04 3 1  ON 65
ci_67                -6.876976e-04 3 1  ON 66
ci_68                -9.477079e-04 3 1  ON 67
ci_69                -1.552596e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.9357
    reference variance = 0.262191
====================================================
  Execution time = 2.6090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8576e-01
  Total weights = 1.963697979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468913546929
                                         uncertainty =       0.002305306554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468913546929
                                         uncertainty =       0.002305306554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484173363
  error estimate for blocks of size 2^( 2) =       0.000505731518
  error estimate for blocks of size 2^( 3) =       0.000526373775
  error estimate for blocks of size 2^( 4) =       0.000541624593
  error estimate for blocks of size 2^( 5) =       0.000551633784
  error estimate for blocks of size 2^( 6) =       0.000558060329
  error estimate for blocks of size 2^( 7) =       0.000559940181

      target function =                  N/A
              le_mean =     -22.819785983776
             les_mean =     521.228389883568
             stat err =       0.000552814722
             autocorr =       1.303639209676
              std dev =       0.684724536633
             le_variance =       0.468847691067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281978598378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819785983712       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819798908806       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819809224770       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819809842305       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819810573175       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819811028240       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 3.299696e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819785983712       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819795800719       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819801276115       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819801330533       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819801534929       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 2.448584e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819785983712       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819790987592       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819792191790       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819792133853       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.211582e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0738e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.187121e-01 3 1  ON 0
ci_02                -2.673279e-02 3 1  ON 1
ci_03                -2.646445e-02 3 1  ON 2
ci_04                 2.408223e-02 3 1  ON 3
ci_05                -2.279124e-02 3 1  ON 4
ci_06                -2.241684e-02 3 1  ON 5
ci_07                 2.435455e-02 3 1  ON 6
ci_08                -4.598282e-03 3 1  ON 7
ci_09                -1.066939e-02 3 1  ON 8
ci_10                -1.128721e-02 3 1  ON 9
ci_11                 1.661305e-02 3 1  ON 10
ci_12                 1.028964e-02 3 1  ON 11
ci_13                 1.305478e-02 3 1  ON 12
ci_14                 1.464945e-02 3 1  ON 13
ci_15                 9.247360e-03 3 1  ON 14
ci_16                 7.488036e-03 3 1  ON 15
ci_17                -9.759814e-03 3 1  ON 16
ci_18                -9.183318e-03 3 1  ON 17
ci_19                 8.146195e-03 3 1  ON 18
ci_20                 1.050521e-02 3 1  ON 19
ci_21                 7.842956e-03 3 1  ON 20
ci_22                 7.464619e-03 3 1  ON 21
ci_23                 6.802016e-03 3 1  ON 22
ci_24                 6.513832e-03 3 1  ON 23
ci_25                 5.722389e-03 3 1  ON 24
ci_26                 2.845380e-03 3 1  ON 25
ci_27                 1.446743e-03 3 1  ON 26
ci_28                 3.061764e-03 3 1  ON 27
ci_29                 4.412674e-03 3 1  ON 28
ci_30                 6.124524e-04 3 1  ON 29
ci_31                 5.918206e-04 3 1  ON 30
ci_32                -2.954787e-04 3 1  ON 31
ci_33                 2.626126e-04 3 1  ON 32
ci_34                 3.269461e-04 3 1  ON 33
ci_35                 8.765659e-04 3 1  ON 34
ci_36                 1.723875e-04 3 1  ON 35
ci_37                -8.112904e-04 3 1  ON 36
ci_38                -5.396006e-04 3 1  ON 37
ci_39                -6.287202e-04 3 1  ON 38
ci_40                -1.424165e-03 3 1  ON 39
ci_41                 6.327531e-04 3 1  ON 40
ci_42                 4.091081e-04 3 1  ON 41
ci_43                -1.624725e-03 3 1  ON 42
ci_44                -9.559591e-04 3 1  ON 43
ci_45                -3.528276e-04 3 1  ON 44
ci_46                 4.524151e-04 3 1  ON 45
ci_47                -2.964887e-04 3 1  ON 46
ci_48                -2.790779e-04 3 1  ON 47
ci_49                -1.887826e-03 3 1  ON 48
ci_50                -8.300931e-04 3 1  ON 49
ci_51                -2.530507e-04 3 1  ON 50
ci_52                -6.864916e-05 3 1  ON 51
ci_53                -9.868140e-04 3 1  ON 52
ci_54                -8.169309e-04 3 1  ON 53
ci_55                -1.026604e-03 3 1  ON 54
ci_56                 2.529194e-03 3 1  ON 55
ci_57                 1.502241e-03 3 1  ON 56
ci_58                -1.915889e-03 3 1  ON 57
ci_59                -4.196956e-03 3 1  ON 58
ci_60                 2.081929e-03 3 1  ON 59
ci_61                 2.204677e-03 3 1  ON 60
ci_62                -2.798028e-04 3 1  ON 61
ci_63                -6.172542e-04 3 1  ON 62
ci_64                 7.537515e-05 3 1  ON 63
ci_65                -1.775630e-04 3 1  ON 64
ci_66                -6.898603e-04 3 1  ON 65
ci_67                -5.315963e-04 3 1  ON 66
ci_68                -4.121530e-04 3 1  ON 67
ci_69                -1.833391e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7822
    reference variance = 0.695558
====================================================
  Execution time = 2.5760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8477e-01
  Total weights = 1.9640e+06
  Execution time = 3.5600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470640102900
                                         uncertainty =       0.002360601140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470640102900
                                         uncertainty =       0.002360601140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485089437
  error estimate for blocks of size 2^( 2) =       0.000506537266
  error estimate for blocks of size 2^( 3) =       0.000526566567
  error estimate for blocks of size 2^( 4) =       0.000542556035
  error estimate for blocks of size 2^( 5) =       0.000552648926
  error estimate for blocks of size 2^( 6) =       0.000559694594
  error estimate for blocks of size 2^( 7) =       0.000562391613

      target function =                  N/A
              le_mean =     -22.820522592033
             les_mean =     521.402928855867
             stat err =       0.000554322792
             autocorr =       1.305815550149
              std dev =       0.686020060877
             le_variance =       0.470623523925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469754544014
                                         uncertainty =       0.002334311702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469754544014
                                         uncertainty =       0.002334311702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484633899
  error estimate for blocks of size 2^( 2) =       0.000506113544
  error estimate for blocks of size 2^( 3) =       0.000526211683
  error estimate for blocks of size 2^( 4) =       0.000542171436
  error estimate for blocks of size 2^( 5) =       0.000552280131
  error estimate for blocks of size 2^( 6) =       0.000559267085
  error estimate for blocks of size 2^( 7) =       0.000561712056

      target function =                  N/A
              le_mean =     -22.820464623929
             les_mean =     521.301405844434
             stat err =       0.000553857677
             autocorr =       1.306076999128
              std dev =       0.685375832923
             le_variance =       0.469740032355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471557341233
                                         uncertainty =       0.002551322812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471557341233
                                         uncertainty =       0.002551322812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485562061
  error estimate for blocks of size 2^( 2) =       0.000506999617
  error estimate for blocks of size 2^( 3) =       0.000527087011
  error estimate for blocks of size 2^( 4) =       0.000542994790
  error estimate for blocks of size 2^( 5) =       0.000553022618
  error estimate for blocks of size 2^( 6) =       0.000559936748
  error estimate for blocks of size 2^( 7) =       0.000562415758

      target function =                  N/A
              le_mean =     -22.820516525398
             les_mean =     522.780679378770
             stat err =       0.000554592478
             autocorr =       1.304543177540
              std dev =       0.686688452127
             le_variance =       0.471541030284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469518345546
                                         uncertainty =       0.002329834519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469518345546
                                         uncertainty =       0.002329834519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484511778
  error estimate for blocks of size 2^( 2) =       0.000505970156
  error estimate for blocks of size 2^( 3) =       0.000526031641
  error estimate for blocks of size 2^( 4) =       0.000541997578
  error estimate for blocks of size 2^( 5) =       0.000552080537
  error estimate for blocks of size 2^( 6) =       0.000559091432
  error estimate for blocks of size 2^( 7) =       0.000561546880

      target function =                  N/A
              le_mean =     -22.820463385974
             les_mean =     521.267621201359
             stat err =       0.000553679107
             autocorr =       1.305893000269
              std dev =       0.685203127287
             le_variance =       0.469503325644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820522592033        initial  <--
     2.4414e-02     2.4414e-01             3.2997e-03       -22.820464623929
     9.7656e-02     9.7656e-01             2.4486e-03       -22.820516525398
     3.9062e-01     3.9062e+00             1.2116e-03       -22.820463385974

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6944
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_01                 1.205006e-01 3 1  ON 0
ci_02                -2.666547e-02 3 1  ON 1
ci_03                -2.668946e-02 3 1  ON 2
ci_04                 2.445572e-02 3 1  ON 3
ci_05                -2.264771e-02 3 1  ON 4
ci_06                -2.273234e-02 3 1  ON 5
ci_07                 2.494784e-02 3 1  ON 6
ci_08                -4.378971e-03 3 1  ON 7
ci_09                -1.174403e-02 3 1  ON 8
ci_10                -1.098527e-02 3 1  ON 9
ci_11                 1.666168e-02 3 1  ON 10
ci_12                 9.656869e-03 3 1  ON 11
ci_13                 1.326267e-02 3 1  ON 12
ci_14                 1.517537e-02 3 1  ON 13
ci_15                 8.424499e-03 3 1  ON 14
ci_16                 8.125669e-03 3 1  ON 15
ci_17                -9.267807e-03 3 1  ON 16
ci_18                -9.299707e-03 3 1  ON 17
ci_19                 9.391511e-03 3 1  ON 18
ci_20                 1.077584e-02 3 1  ON 19
ci_21                 8.020332e-03 3 1  ON 20
ci_22                 7.461131e-03 3 1  ON 21
ci_23                 6.722209e-03 3 1  ON 22
ci_24                 7.444515e-03 3 1  ON 23
ci_25                 4.927513e-03 3 1  ON 24
ci_26                 1.333200e-03 3 1  ON 25
ci_27                 2.322705e-03 3 1  ON 26
ci_28                 3.832103e-03 3 1  ON 27
ci_29                 4.852165e-03 3 1  ON 28
ci_30                 1.211391e-04 3 1  ON 29
ci_31                 5.702537e-04 3 1  ON 30
ci_32                -1.016358e-03 3 1  ON 31
ci_33                 5.637470e-04 3 1  ON 32
ci_34                 9.859106e-04 3 1  ON 33
ci_35                 2.435968e-04 3 1  ON 34
ci_36                -6.706047e-04 3 1  ON 35
ci_37                -5.810898e-04 3 1  ON 36
ci_38                -1.097013e-03 3 1  ON 37
ci_39                -4.744790e-04 3 1  ON 38
ci_40                -1.413124e-03 3 1  ON 39
ci_41                 1.107172e-03 3 1  ON 40
ci_42                -4.589893e-05 3 1  ON 41
ci_43                -2.007804e-03 3 1  ON 42
ci_44                -2.701326e-03 3 1  ON 43
ci_45                -6.557955e-04 3 1  ON 44
ci_46                 8.514471e-05 3 1  ON 45
ci_47                -7.977620e-04 3 1  ON 46
ci_48                -1.098400e-04 3 1  ON 47
ci_49                -8.846902e-04 3 1  ON 48
ci_50                -5.337174e-04 3 1  ON 49
ci_51                 3.764943e-04 3 1  ON 50
ci_52                -3.094260e-05 3 1  ON 51
ci_53                -6.891337e-04 3 1  ON 52
ci_54                -1.188219e-03 3 1  ON 53
ci_55                -1.284561e-03 3 1  ON 54
ci_56                 1.451103e-03 3 1  ON 55
ci_57                 1.512146e-03 3 1  ON 56
ci_58                -1.568260e-03 3 1  ON 57
ci_59                -1.748372e-03 3 1  ON 58
ci_60                 2.724263e-03 3 1  ON 59
ci_61                 1.776956e-03 3 1  ON 60
ci_62                -3.091101e-04 3 1  ON 61
ci_63                 2.781742e-04 3 1  ON 62
ci_64                -7.130114e-04 3 1  ON 63
ci_65                 2.512711e-04 3 1  ON 64
ci_66                -3.779832e-04 3 1  ON 65
ci_67                -6.876976e-04 3 1  ON 66
ci_68                -9.477079e-04 3 1  ON 67
ci_69                -1.552596e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8535
    reference variance = 0.317175
====================================================
  Execution time = 2.6137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9126e-01
  Total weights = 1.963496193e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472804357714
                                         uncertainty =       0.002137674563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472804357714
                                         uncertainty =       0.002137674563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486320579
  error estimate for blocks of size 2^( 2) =       0.000507402178
  error estimate for blocks of size 2^( 3) =       0.000528052631
  error estimate for blocks of size 2^( 4) =       0.000543811434
  error estimate for blocks of size 2^( 5) =       0.000552694394
  error estimate for blocks of size 2^( 6) =       0.000556596848
  error estimate for blocks of size 2^( 7) =       0.000558010015

      target function =                  N/A
              le_mean =     -22.819031453378
             les_mean =     521.199455432940
             stat err =       0.000552778173
             autocorr =       1.291982042487
              std dev =       0.687761158168
             le_variance =       0.473015410685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281903145338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819031453321       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819054741922       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819055075457       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819055345987       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.136639e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819031453321       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819040183563       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819040329810       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819040383868       residual = 5.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.922774e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819031453321       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819033947308       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819034005725       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819034022033       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 1.089085e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0791e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.203270e-01 3 1  ON 0
ci_02                -2.646987e-02 3 1  ON 1
ci_03                -2.653510e-02 3 1  ON 2
ci_04                 2.462646e-02 3 1  ON 3
ci_05                -2.303999e-02 3 1  ON 4
ci_06                -2.257197e-02 3 1  ON 5
ci_07                 2.505295e-02 3 1  ON 6
ci_08                -4.134058e-03 3 1  ON 7
ci_09                -1.164736e-02 3 1  ON 8
ci_10                -1.111680e-02 3 1  ON 9
ci_11                 1.641180e-02 3 1  ON 10
ci_12                 9.922266e-03 3 1  ON 11
ci_13                 1.324458e-02 3 1  ON 12
ci_14                 1.533694e-02 3 1  ON 13
ci_15                 8.212065e-03 3 1  ON 14
ci_16                 8.153936e-03 3 1  ON 15
ci_17                -9.139346e-03 3 1  ON 16
ci_18                -9.232234e-03 3 1  ON 17
ci_19                 9.508624e-03 3 1  ON 18
ci_20                 1.081160e-02 3 1  ON 19
ci_21                 8.089524e-03 3 1  ON 20
ci_22                 7.667573e-03 3 1  ON 21
ci_23                 6.608503e-03 3 1  ON 22
ci_24                 7.616243e-03 3 1  ON 23
ci_25                 4.967314e-03 3 1  ON 24
ci_26                 1.606729e-03 3 1  ON 25
ci_27                 2.385440e-03 3 1  ON 26
ci_28                 4.027525e-03 3 1  ON 27
ci_29                 4.686402e-03 3 1  ON 28
ci_30                 1.695276e-04 3 1  ON 29
ci_31                 6.944479e-04 3 1  ON 30
ci_32                -8.734277e-04 3 1  ON 31
ci_33                 4.249105e-04 3 1  ON 32
ci_34                 8.884636e-04 3 1  ON 33
ci_35                 1.654144e-04 3 1  ON 34
ci_36                -6.973073e-04 3 1  ON 35
ci_37                -5.411656e-04 3 1  ON 36
ci_38                -8.322382e-04 3 1  ON 37
ci_39                -3.631861e-04 3 1  ON 38
ci_40                -1.387090e-03 3 1  ON 39
ci_41                 9.926387e-04 3 1  ON 40
ci_42                -2.811955e-04 3 1  ON 41
ci_43                -2.147065e-03 3 1  ON 42
ci_44                -2.780257e-03 3 1  ON 43
ci_45                -6.128359e-04 3 1  ON 44
ci_46                 3.918177e-05 3 1  ON 45
ci_47                -5.711735e-04 3 1  ON 46
ci_48                -1.530826e-04 3 1  ON 47
ci_49                -8.852783e-04 3 1  ON 48
ci_50                -4.487733e-04 3 1  ON 49
ci_51                 2.435873e-04 3 1  ON 50
ci_52                -1.512177e-04 3 1  ON 51
ci_53                -7.188900e-04 3 1  ON 52
ci_54                -1.154101e-03 3 1  ON 53
ci_55                -1.140878e-03 3 1  ON 54
ci_56                 1.466263e-03 3 1  ON 55
ci_57                 1.407605e-03 3 1  ON 56
ci_58                -1.277246e-03 3 1  ON 57
ci_59                -1.714156e-03 3 1  ON 58
ci_60                 2.693654e-03 3 1  ON 59
ci_61                 1.844753e-03 3 1  ON 60
ci_62                -1.821547e-04 3 1  ON 61
ci_63                -7.558513e-05 3 1  ON 62
ci_64                -7.245467e-04 3 1  ON 63
ci_65                 6.091165e-05 3 1  ON 64
ci_66                -4.364109e-04 3 1  ON 65
ci_67                -7.941452e-04 3 1  ON 66
ci_68                -9.176303e-04 3 1  ON 67
ci_69                -1.375107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7496
    reference variance = 0.309215
====================================================
  Execution time = 2.5446e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8984e-01
  Total weights = 1.9637e+06
  Execution time = 3.5708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471000314781
                                         uncertainty =       0.002937349390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471000314781
                                         uncertainty =       0.002937349390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485312016
  error estimate for blocks of size 2^( 2) =       0.000506931063
  error estimate for blocks of size 2^( 3) =       0.000527884726
  error estimate for blocks of size 2^( 4) =       0.000543902775
  error estimate for blocks of size 2^( 5) =       0.000556173784
  error estimate for blocks of size 2^( 6) =       0.000562263810
  error estimate for blocks of size 2^( 7) =       0.000566411914

      target function =                  N/A
              le_mean =     -22.818866025084
             les_mean =     521.194441760989
             stat err =       0.000557188071
             autocorr =       1.318139973269
              std dev =       0.686334835378
             le_variance =       0.471055506253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471147733544
                                         uncertainty =       0.002964023960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471147733544
                                         uncertainty =       0.002964023960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485388065
  error estimate for blocks of size 2^( 2) =       0.000507016607
  error estimate for blocks of size 2^( 3) =       0.000527969311
  error estimate for blocks of size 2^( 4) =       0.000543974607
  error estimate for blocks of size 2^( 5) =       0.000556261902
  error estimate for blocks of size 2^( 6) =       0.000562350956
  error estimate for blocks of size 2^( 7) =       0.000566485084

      target function =                  N/A
              le_mean =     -22.818886214277
             les_mean =     521.325673026483
             stat err =       0.000557268137
             autocorr =       1.318105698379
              std dev =       0.686442384729
             le_variance =       0.471203147553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470999349283
                                         uncertainty =       0.002947451008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470999349283
                                         uncertainty =       0.002947451008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485311705
  error estimate for blocks of size 2^( 2) =       0.000506939958
  error estimate for blocks of size 2^( 3) =       0.000527892376
  error estimate for blocks of size 2^( 4) =       0.000543901169
  error estimate for blocks of size 2^( 5) =       0.000556187027
  error estimate for blocks of size 2^( 6) =       0.000562258419
  error estimate for blocks of size 2^( 7) =       0.000566410980

      target function =                  N/A
              le_mean =     -22.818870214982
             les_mean =     521.191738404130
             stat err =       0.000557189399
             autocorr =       1.318147950271
              std dev =       0.686334394749
             le_variance =       0.471054901416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470988951816
                                         uncertainty =       0.002938526893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470988951816
                                         uncertainty =       0.002938526893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485306202
  error estimate for blocks of size 2^( 2) =       0.000506926109
  error estimate for blocks of size 2^( 3) =       0.000527877029
  error estimate for blocks of size 2^( 4) =       0.000543892037
  error estimate for blocks of size 2^( 5) =       0.000556165595
  error estimate for blocks of size 2^( 6) =       0.000562250996
  error estimate for blocks of size 2^( 7) =       0.000566395297

      target function =                  N/A
              le_mean =     -22.818865265560
             les_mean =     521.191714022586
             stat err =       0.000557175981
             autocorr =       1.318114353881
              std dev =       0.686326613289
             le_variance =       0.471044220109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818866025084        initial
     2.4414e-01     2.4414e+00             1.1366e-03       -22.818886214277  <--
     9.7656e-01     9.7656e+00             3.9228e-04       -22.818870214982
     3.9062e+00     3.9062e+01             1.0891e-04       -22.818865265560

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 4.3345e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_01                 1.199124e-01 3 1  ON 0
ci_02                -2.608645e-02 3 1  ON 1
ci_03                -2.625305e-02 3 1  ON 2
ci_04                 2.485615e-02 3 1  ON 3
ci_05                -2.378435e-02 3 1  ON 4
ci_06                -2.229197e-02 3 1  ON 5
ci_07                 2.523343e-02 3 1  ON 6
ci_08                -3.807865e-03 3 1  ON 7
ci_09                -1.148824e-02 3 1  ON 8
ci_10                -1.135586e-02 3 1  ON 9
ci_11                 1.593853e-02 3 1  ON 10
ci_12                 1.036656e-02 3 1  ON 11
ci_13                 1.325622e-02 3 1  ON 12
ci_14                 1.569375e-02 3 1  ON 13
ci_15                 7.825528e-03 3 1  ON 14
ci_16                 8.183963e-03 3 1  ON 15
ci_17                -8.946055e-03 3 1  ON 16
ci_18                -9.108518e-03 3 1  ON 17
ci_19                 9.686611e-03 3 1  ON 18
ci_20                 1.089018e-02 3 1  ON 19
ci_21                 8.233158e-03 3 1  ON 20
ci_22                 8.059659e-03 3 1  ON 21
ci_23                 6.425643e-03 3 1  ON 22
ci_24                 7.998626e-03 3 1  ON 23
ci_25                 5.030501e-03 3 1  ON 24
ci_26                 2.088308e-03 3 1  ON 25
ci_27                 2.521939e-03 3 1  ON 26
ci_28                 4.393526e-03 3 1  ON 27
ci_29                 4.393784e-03 3 1  ON 28
ci_30                 2.313149e-04 3 1  ON 29
ci_31                 9.226534e-04 3 1  ON 30
ci_32                -6.482415e-04 3 1  ON 31
ci_33                 2.408912e-04 3 1  ON 32
ci_34                 7.302112e-04 3 1  ON 33
ci_35                 4.199342e-05 3 1  ON 34
ci_36                -7.515096e-04 3 1  ON 35
ci_37                -5.029496e-04 3 1  ON 36
ci_38                -4.423966e-04 3 1  ON 37
ci_39                -1.967241e-04 3 1  ON 38
ci_40                -1.360137e-03 3 1  ON 39
ci_41                 8.210903e-04 3 1  ON 40
ci_42                -6.369904e-04 3 1  ON 41
ci_43                -2.418606e-03 3 1  ON 42
ci_44                -2.909079e-03 3 1  ON 43
ci_45                -5.592609e-04 3 1  ON 44
ci_46                -2.539650e-05 3 1  ON 45
ci_47                -1.250688e-04 3 1  ON 46
ci_48                -2.133220e-04 3 1  ON 47
ci_49                -8.824288e-04 3 1  ON 48
ci_50                -3.554755e-04 3 1  ON 49
ci_51                 4.230085e-05 3 1  ON 50
ci_52                -3.244738e-04 3 1  ON 51
ci_53                -7.456926e-04 3 1  ON 52
ci_54                -1.109298e-03 3 1  ON 53
ci_55                -9.031681e-04 3 1  ON 54
ci_56                 1.479657e-03 3 1  ON 55
ci_57                 1.241094e-03 3 1  ON 56
ci_58                -7.731591e-04 3 1  ON 57
ci_59                -1.656257e-03 3 1  ON 58
ci_60                 2.633917e-03 3 1  ON 59
ci_61                 2.018731e-03 3 1  ON 60
ci_62                -1.123024e-05 3 1  ON 61
ci_63                -5.336132e-04 3 1  ON 62
ci_64                -7.470079e-04 3 1  ON 63
ci_65                -2.263695e-04 3 1  ON 64
ci_66                -5.172756e-04 3 1  ON 65
ci_67                -9.434186e-04 3 1  ON 66
ci_68                -8.764588e-04 3 1  ON 67
ci_69                -1.055387e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.764
    reference variance = 0.255916
====================================================
  Execution time = 2.5925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8398e-01
  Total weights = 1.963801678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469135704351
                                         uncertainty =       0.001967596931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469135704351
                                         uncertainty =       0.001967596931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484362133
  error estimate for blocks of size 2^( 2) =       0.000506409096
  error estimate for blocks of size 2^( 3) =       0.000526246178
  error estimate for blocks of size 2^( 4) =       0.000542751133
  error estimate for blocks of size 2^( 5) =       0.000551620141
  error estimate for blocks of size 2^( 6) =       0.000557541787
  error estimate for blocks of size 2^( 7) =       0.000559879163

      target function =                  N/A
              le_mean =     -22.819614956433
             les_mean =     521.218811230972
             stat err =       0.000552948056
             autocorr =       1.303251712624
              std dev =       0.684991498055
             le_variance =       0.469213352407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281961495643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819614956421       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819638706468       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819640678126       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819639567407       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819639913033       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 3.215933e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819614956421       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819628979783       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819629296614       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819629029046       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 1.396430e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819614956421       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819620271962       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819620293065       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819620271663       residual = 4.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 4.326836e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0473e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.185160e-01 3 1  ON 0
ci_02                -2.629328e-02 3 1  ON 1
ci_03                -2.611852e-02 3 1  ON 2
ci_04                 2.514849e-02 3 1  ON 3
ci_05                -2.331536e-02 3 1  ON 4
ci_06                -2.239567e-02 3 1  ON 5
ci_07                 2.561279e-02 3 1  ON 6
ci_08                -4.641053e-03 3 1  ON 7
ci_09                -1.115546e-02 3 1  ON 8
ci_10                -1.128608e-02 3 1  ON 9
ci_11                 1.607352e-02 3 1  ON 10
ci_12                 1.079103e-02 3 1  ON 11
ci_13                 1.309682e-02 3 1  ON 12
ci_14                 1.568271e-02 3 1  ON 13
ci_15                 7.843074e-03 3 1  ON 14
ci_16                 8.164612e-03 3 1  ON 15
ci_17                -9.326120e-03 3 1  ON 16
ci_18                -9.032860e-03 3 1  ON 17
ci_19                 9.324311e-03 3 1  ON 18
ci_20                 1.097585e-02 3 1  ON 19
ci_21                 8.698249e-03 3 1  ON 20
ci_22                 7.919847e-03 3 1  ON 21
ci_23                 6.529472e-03 3 1  ON 22
ci_24                 7.538820e-03 3 1  ON 23
ci_25                 4.813103e-03 3 1  ON 24
ci_26                 2.610229e-03 3 1  ON 25
ci_27                 2.377364e-03 3 1  ON 26
ci_28                 4.347069e-03 3 1  ON 27
ci_29                 4.041907e-03 3 1  ON 28
ci_30                -1.330779e-04 3 1  ON 29
ci_31                 5.176412e-04 3 1  ON 30
ci_32                -3.922346e-04 3 1  ON 31
ci_33                 2.468012e-04 3 1  ON 32
ci_34                 8.421038e-04 3 1  ON 33
ci_35                 1.471439e-05 3 1  ON 34
ci_36                -7.157069e-04 3 1  ON 35
ci_37                -5.811385e-04 3 1  ON 36
ci_38                 2.578809e-05 3 1  ON 37
ci_39                -2.318038e-04 3 1  ON 38
ci_40                -1.456628e-03 3 1  ON 39
ci_41                 5.496605e-04 3 1  ON 40
ci_42                 1.752809e-04 3 1  ON 41
ci_43                -2.413793e-03 3 1  ON 42
ci_44                -2.681396e-03 3 1  ON 43
ci_45                -2.691153e-04 3 1  ON 44
ci_46                -7.945131e-04 3 1  ON 45
ci_47                 1.060169e-04 3 1  ON 46
ci_48                -2.400202e-04 3 1  ON 47
ci_49                -1.058102e-03 3 1  ON 48
ci_50                -4.417917e-04 3 1  ON 49
ci_51                 6.400444e-05 3 1  ON 50
ci_52                 1.542109e-04 3 1  ON 51
ci_53                -7.106737e-04 3 1  ON 52
ci_54                -6.233767e-04 3 1  ON 53
ci_55                -7.052933e-04 3 1  ON 54
ci_56                 1.248615e-03 3 1  ON 55
ci_57                 1.308813e-03 3 1  ON 56
ci_58                -7.136672e-04 3 1  ON 57
ci_59                -1.157611e-03 3 1  ON 58
ci_60                 2.829882e-03 3 1  ON 59
ci_61                 1.852645e-03 3 1  ON 60
ci_62                -1.164084e-04 3 1  ON 61
ci_63                -2.193552e-04 3 1  ON 62
ci_64                -1.067563e-03 3 1  ON 63
ci_65                -2.636207e-04 3 1  ON 64
ci_66                -2.348076e-04 3 1  ON 65
ci_67                -7.530081e-04 3 1  ON 66
ci_68                -8.685157e-04 3 1  ON 67
ci_69                -7.423641e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7654
    reference variance = 0.338555
====================================================
  Execution time = 2.5457e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.7968e-01
  Total weights = 1.9635e+06
  Execution time = 3.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465570220121
                                         uncertainty =       0.001722451686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465570220121
                                         uncertainty =       0.001722451686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482468929
  error estimate for blocks of size 2^( 2) =       0.000503819552
  error estimate for blocks of size 2^( 3) =       0.000523724421
  error estimate for blocks of size 2^( 4) =       0.000538424491
  error estimate for blocks of size 2^( 5) =       0.000547932794
  error estimate for blocks of size 2^( 6) =       0.000553004543
  error estimate for blocks of size 2^( 7) =       0.000555515001

      target function =                  N/A
              le_mean =     -22.818187156006
             les_mean =     521.245429461022
             stat err =       0.000548719207
             autocorr =       1.293485679279
              std dev =       0.682314102557
             le_variance =       0.465552534548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465360277020
                                         uncertainty =       0.001750538206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465360277020
                                         uncertainty =       0.001750538206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482359234
  error estimate for blocks of size 2^( 2) =       0.000503726665
  error estimate for blocks of size 2^( 3) =       0.000523652833
  error estimate for blocks of size 2^( 4) =       0.000538330432
  error estimate for blocks of size 2^( 5) =       0.000547925822
  error estimate for blocks of size 2^( 6) =       0.000552892099
  error estimate for blocks of size 2^( 7) =       0.000555461898

      target function =                  N/A
              le_mean =     -22.818135519963
             les_mean =     521.560318404914
             stat err =       0.000548652563
             autocorr =       1.293759737299
              std dev =       0.682158970217
             le_variance =       0.465340860648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465129842129
                                         uncertainty =       0.001724681939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465129842129
                                         uncertainty =       0.001724681939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482239950
  error estimate for blocks of size 2^( 2) =       0.000503597450
  error estimate for blocks of size 2^( 3) =       0.000523525332
  error estimate for blocks of size 2^( 4) =       0.000538225389
  error estimate for blocks of size 2^( 5) =       0.000547807295
  error estimate for blocks of size 2^( 6) =       0.000552844899
  error estimate for blocks of size 2^( 7) =       0.000555384911

      target function =                  N/A
              le_mean =     -22.818149910223
             les_mean =     521.196257056905
             stat err =       0.000548565624
             autocorr =       1.293989659823
              std dev =       0.681990277664
             le_variance =       0.465110738828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465077550705
                                         uncertainty =       0.001731929621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465077550705
                                         uncertainty =       0.001731929621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482213291
  error estimate for blocks of size 2^( 2) =       0.000503577896
  error estimate for blocks of size 2^( 3) =       0.000523496262
  error estimate for blocks of size 2^( 4) =       0.000538188335
  error estimate for blocks of size 2^( 5) =       0.000547713045
  error estimate for blocks of size 2^( 6) =       0.000552729989
  error estimate for blocks of size 2^( 7) =       0.000555211059

      target function =                  N/A
              le_mean =     -22.818162832942
             les_mean =     521.154119735054
             stat err =       0.000548460607
             autocorr =       1.293637293023
              std dev =       0.681952576096
             le_variance =       0.465059316044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818187156006        initial  <--
     6.1035e-02     6.1035e-01             3.2159e-03       -22.818135519963
     2.4414e-01     2.4414e+00             1.3964e-03       -22.818149910223
     9.7656e-01     9.7656e+00             4.3268e-04       -22.818162832942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2883
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_01                 1.199124e-01 3 1  ON 0
ci_02                -2.608645e-02 3 1  ON 1
ci_03                -2.625305e-02 3 1  ON 2
ci_04                 2.485615e-02 3 1  ON 3
ci_05                -2.378435e-02 3 1  ON 4
ci_06                -2.229197e-02 3 1  ON 5
ci_07                 2.523343e-02 3 1  ON 6
ci_08                -3.807865e-03 3 1  ON 7
ci_09                -1.148824e-02 3 1  ON 8
ci_10                -1.135586e-02 3 1  ON 9
ci_11                 1.593853e-02 3 1  ON 10
ci_12                 1.036656e-02 3 1  ON 11
ci_13                 1.325622e-02 3 1  ON 12
ci_14                 1.569375e-02 3 1  ON 13
ci_15                 7.825528e-03 3 1  ON 14
ci_16                 8.183963e-03 3 1  ON 15
ci_17                -8.946055e-03 3 1  ON 16
ci_18                -9.108518e-03 3 1  ON 17
ci_19                 9.686611e-03 3 1  ON 18
ci_20                 1.089018e-02 3 1  ON 19
ci_21                 8.233158e-03 3 1  ON 20
ci_22                 8.059659e-03 3 1  ON 21
ci_23                 6.425643e-03 3 1  ON 22
ci_24                 7.998626e-03 3 1  ON 23
ci_25                 5.030501e-03 3 1  ON 24
ci_26                 2.088308e-03 3 1  ON 25
ci_27                 2.521939e-03 3 1  ON 26
ci_28                 4.393526e-03 3 1  ON 27
ci_29                 4.393784e-03 3 1  ON 28
ci_30                 2.313149e-04 3 1  ON 29
ci_31                 9.226534e-04 3 1  ON 30
ci_32                -6.482415e-04 3 1  ON 31
ci_33                 2.408912e-04 3 1  ON 32
ci_34                 7.302112e-04 3 1  ON 33
ci_35                 4.199342e-05 3 1  ON 34
ci_36                -7.515096e-04 3 1  ON 35
ci_37                -5.029496e-04 3 1  ON 36
ci_38                -4.423966e-04 3 1  ON 37
ci_39                -1.967241e-04 3 1  ON 38
ci_40                -1.360137e-03 3 1  ON 39
ci_41                 8.210903e-04 3 1  ON 40
ci_42                -6.369904e-04 3 1  ON 41
ci_43                -2.418606e-03 3 1  ON 42
ci_44                -2.909079e-03 3 1  ON 43
ci_45                -5.592609e-04 3 1  ON 44
ci_46                -2.539650e-05 3 1  ON 45
ci_47                -1.250688e-04 3 1  ON 46
ci_48                -2.133220e-04 3 1  ON 47
ci_49                -8.824288e-04 3 1  ON 48
ci_50                -3.554755e-04 3 1  ON 49
ci_51                 4.230085e-05 3 1  ON 50
ci_52                -3.244738e-04 3 1  ON 51
ci_53                -7.456926e-04 3 1  ON 52
ci_54                -1.109298e-03 3 1  ON 53
ci_55                -9.031681e-04 3 1  ON 54
ci_56                 1.479657e-03 3 1  ON 55
ci_57                 1.241094e-03 3 1  ON 56
ci_58                -7.731591e-04 3 1  ON 57
ci_59                -1.656257e-03 3 1  ON 58
ci_60                 2.633917e-03 3 1  ON 59
ci_61                 2.018731e-03 3 1  ON 60
ci_62                -1.123024e-05 3 1  ON 61
ci_63                -5.336132e-04 3 1  ON 62
ci_64                -7.470079e-04 3 1  ON 63
ci_65                -2.263695e-04 3 1  ON 64
ci_66                -5.172756e-04 3 1  ON 65
ci_67                -9.434186e-04 3 1  ON 66
ci_68                -8.764588e-04 3 1  ON 67
ci_69                -1.055387e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8467
    reference variance = 0.377561
====================================================
  Execution time = 2.7466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5323e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8502e-01
  Total weights = 1.963607236e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470088778697
                                         uncertainty =       0.003006014789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470088778697
                                         uncertainty =       0.003006014789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484813115
  error estimate for blocks of size 2^( 2) =       0.000506140207
  error estimate for blocks of size 2^( 3) =       0.000526788486
  error estimate for blocks of size 2^( 4) =       0.000542060317
  error estimate for blocks of size 2^( 5) =       0.000550142562
  error estimate for blocks of size 2^( 6) =       0.000558386564
  error estimate for blocks of size 2^( 7) =       0.000560500310

      target function =                  N/A
              le_mean =     -22.820112080316
             les_mean =     521.242530363960
             stat err =       0.000552772438
             autocorr =       1.300002063004
              std dev =       0.685629282789
             le_variance =       0.470087513418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282011208032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820112080258       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820118247621       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820118978501       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820119016447       residual = 9.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 4.380170e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820112080258       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820113956356       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820114103713       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820114099511       residual = 1.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.362388e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820112080258       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820112576159       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820112609093       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820112607778       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.648566e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2007e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.197956e-01 3 1  ON 0
ci_02                -2.602026e-02 3 1  ON 1
ci_03                -2.625937e-02 3 1  ON 2
ci_04                 2.494039e-02 3 1  ON 3
ci_05                -2.378491e-02 3 1  ON 4
ci_06                -2.239431e-02 3 1  ON 5
ci_07                 2.519287e-02 3 1  ON 6
ci_08                -3.868857e-03 3 1  ON 7
ci_09                -1.154550e-02 3 1  ON 8
ci_10                -1.135965e-02 3 1  ON 9
ci_11                 1.593549e-02 3 1  ON 10
ci_12                 1.043312e-02 3 1  ON 11
ci_13                 1.322636e-02 3 1  ON 12
ci_14                 1.579602e-02 3 1  ON 13
ci_15                 7.871777e-03 3 1  ON 14
ci_16                 8.154193e-03 3 1  ON 15
ci_17                -8.966222e-03 3 1  ON 16
ci_18                -9.187682e-03 3 1  ON 17
ci_19                 9.731691e-03 3 1  ON 18
ci_20                 1.084435e-02 3 1  ON 19
ci_21                 8.221533e-03 3 1  ON 20
ci_22                 8.021763e-03 3 1  ON 21
ci_23                 6.394815e-03 3 1  ON 22
ci_24                 7.950407e-03 3 1  ON 23
ci_25                 5.072777e-03 3 1  ON 24
ci_26                 2.094883e-03 3 1  ON 25
ci_27                 2.489290e-03 3 1  ON 26
ci_28                 4.354146e-03 3 1  ON 27
ci_29                 4.417438e-03 3 1  ON 28
ci_30                 1.928272e-04 3 1  ON 29
ci_31                 9.549034e-04 3 1  ON 30
ci_32                -6.448877e-04 3 1  ON 31
ci_33                 1.902374e-04 3 1  ON 32
ci_34                 7.946833e-04 3 1  ON 33
ci_35                 4.888949e-05 3 1  ON 34
ci_36                -8.231511e-04 3 1  ON 35
ci_37                -5.284780e-04 3 1  ON 36
ci_38                -3.061578e-04 3 1  ON 37
ci_39                -1.841608e-04 3 1  ON 38
ci_40                -1.409898e-03 3 1  ON 39
ci_41                 7.436911e-04 3 1  ON 40
ci_42                -5.742335e-04 3 1  ON 41
ci_43                -2.431742e-03 3 1  ON 42
ci_44                -2.777196e-03 3 1  ON 43
ci_45                -6.572822e-04 3 1  ON 44
ci_46                -7.181765e-05 3 1  ON 45
ci_47                -1.758185e-04 3 1  ON 46
ci_48                -2.890473e-04 3 1  ON 47
ci_49                -8.334791e-04 3 1  ON 48
ci_50                -3.780154e-04 3 1  ON 49
ci_51                 3.583797e-05 3 1  ON 50
ci_52                -2.489559e-04 3 1  ON 51
ci_53                -7.889343e-04 3 1  ON 52
ci_54                -1.077925e-03 3 1  ON 53
ci_55                -9.887085e-04 3 1  ON 54
ci_56                 1.459399e-03 3 1  ON 55
ci_57                 1.165436e-03 3 1  ON 56
ci_58                -7.673659e-04 3 1  ON 57
ci_59                -1.664098e-03 3 1  ON 58
ci_60                 2.592113e-03 3 1  ON 59
ci_61                 1.972509e-03 3 1  ON 60
ci_62                -1.270785e-04 3 1  ON 61
ci_63                -5.737165e-04 3 1  ON 62
ci_64                -6.781515e-04 3 1  ON 63
ci_65                -2.523396e-04 3 1  ON 64
ci_66                -4.647148e-04 3 1  ON 65
ci_67                -9.350638e-04 3 1  ON 66
ci_68                -9.764299e-04 3 1  ON 67
ci_69                -1.140839e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8296
    reference variance = 0.343432
====================================================
  Execution time = 2.4927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8623e-01
  Total weights = 1.9637e+06
  Execution time = 3.5455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469545737104
                                         uncertainty =       0.002358709968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469545737104
                                         uncertainty =       0.002358709968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484538089
  error estimate for blocks of size 2^( 2) =       0.000505951519
  error estimate for blocks of size 2^( 3) =       0.000526454489
  error estimate for blocks of size 2^( 4) =       0.000542195307
  error estimate for blocks of size 2^( 5) =       0.000552218328
  error estimate for blocks of size 2^( 6) =       0.000560067150
  error estimate for blocks of size 2^( 7) =       0.000562650574

      target function =                  N/A
              le_mean =     -22.818834569302
             les_mean =     521.185603082168
             stat err =       0.000554282840
             autocorr =       1.308600318165
              std dev =       0.685240337645
             le_variance =       0.469554320336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469566118574
                                         uncertainty =       0.002359120355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469566118574
                                         uncertainty =       0.002359120355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484549548
  error estimate for blocks of size 2^( 2) =       0.000505951094
  error estimate for blocks of size 2^( 3) =       0.000526449501
  error estimate for blocks of size 2^( 4) =       0.000542187392
  error estimate for blocks of size 2^( 5) =       0.000552211831
  error estimate for blocks of size 2^( 6) =       0.000560073772
  error estimate for blocks of size 2^( 7) =       0.000562661584

      target function =                  N/A
              le_mean =     -22.818843611349
             les_mean =     521.186462433995
             stat err =       0.000554283645
             autocorr =       1.308542229080
              std dev =       0.685256542585
             le_variance =       0.469576529155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469550075441
                                         uncertainty =       0.002358696077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469550075441
                                         uncertainty =       0.002358696077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484540882
  error estimate for blocks of size 2^( 2) =       0.000505946865
  error estimate for blocks of size 2^( 3) =       0.000526447038
  error estimate for blocks of size 2^( 4) =       0.000542185784
  error estimate for blocks of size 2^( 5) =       0.000552210159
  error estimate for blocks of size 2^( 6) =       0.000560067311
  error estimate for blocks of size 2^( 7) =       0.000562652858

      target function =                  N/A
              le_mean =     -22.818838798077
             les_mean =     521.186213640856
             stat err =       0.000554279028
             autocorr =       1.308567235045
              std dev =       0.685244287215
             le_variance =       0.469559733161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469544707016
                                         uncertainty =       0.002358690846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469544707016
                                         uncertainty =       0.002358690846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484537630
  error estimate for blocks of size 2^( 2) =       0.000505950099
  error estimate for blocks of size 2^( 3) =       0.000526452705
  error estimate for blocks of size 2^( 4) =       0.000542193299
  error estimate for blocks of size 2^( 5) =       0.000552216433
  error estimate for blocks of size 2^( 6) =       0.000560066249
  error estimate for blocks of size 2^( 7) =       0.000562649971

      target function =                  N/A
              le_mean =     -22.818834929973
             les_mean =     521.185615997365
             stat err =       0.000554281488
             autocorr =       1.308596415070
              std dev =       0.685239688352
             le_variance =       0.469553430493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818834569302        initial
     6.1035e-01     6.1035e+00             4.3802e-04       -22.818843611349  <--
     2.4414e+00     2.4414e+01             1.3624e-04       -22.818838798077
     9.7656e+00     9.7656e+01             3.6486e-05       -22.818834929973

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 4.2718e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_01                 1.194892e-01 3 1  ON 0
ci_02                -2.586064e-02 3 1  ON 1
ci_03                -2.626970e-02 3 1  ON 2
ci_04                 2.512245e-02 3 1  ON 3
ci_05                -2.379335e-02 3 1  ON 4
ci_06                -2.264245e-02 3 1  ON 5
ci_07                 2.510363e-02 3 1  ON 6
ci_08                -3.991821e-03 3 1  ON 7
ci_09                -1.168643e-02 3 1  ON 8
ci_10                -1.137268e-02 3 1  ON 9
ci_11                 1.593485e-02 3 1  ON 10
ci_12                 1.058823e-02 3 1  ON 11
ci_13                 1.314692e-02 3 1  ON 12
ci_14                 1.607792e-02 3 1  ON 13
ci_15                 7.977862e-03 3 1  ON 14
ci_16                 8.077618e-03 3 1  ON 15
ci_17                -9.013679e-03 3 1  ON 16
ci_18                -9.381715e-03 3 1  ON 17
ci_19                 9.829101e-03 3 1  ON 18
ci_20                 1.073270e-02 3 1  ON 19
ci_21                 8.188726e-03 3 1  ON 20
ci_22                 7.922904e-03 3 1  ON 21
ci_23                 6.330053e-03 3 1  ON 22
ci_24                 7.824466e-03 3 1  ON 23
ci_25                 5.165664e-03 3 1  ON 24
ci_26                 2.111225e-03 3 1  ON 25
ci_27                 2.405721e-03 3 1  ON 26
ci_28                 4.254354e-03 3 1  ON 27
ci_29                 4.466192e-03 3 1  ON 28
ci_30                 8.998344e-05 3 1  ON 29
ci_31                 1.034626e-03 3 1  ON 30
ci_32                -6.296725e-04 3 1  ON 31
ci_33                 8.931563e-05 3 1  ON 32
ci_34                 9.452948e-04 3 1  ON 33
ci_35                 6.396765e-05 3 1  ON 34
ci_36                -9.738919e-04 3 1  ON 35
ci_37                -5.696483e-04 3 1  ON 36
ci_38                -1.230123e-05 3 1  ON 37
ci_39                -1.542022e-04 3 1  ON 38
ci_40                -1.502068e-03 3 1  ON 39
ci_41                 5.794002e-04 3 1  ON 40
ci_42                -4.380623e-04 3 1  ON 41
ci_43                -2.461736e-03 3 1  ON 42
ci_44                -2.471062e-03 3 1  ON 43
ci_45                -8.676143e-04 3 1  ON 44
ci_46                -1.683681e-04 3 1  ON 45
ci_47                -2.935755e-04 3 1  ON 46
ci_48                -4.710226e-04 3 1  ON 47
ci_49                -7.288756e-04 3 1  ON 48
ci_50                -4.177924e-04 3 1  ON 49
ci_51                 2.099046e-05 3 1  ON 50
ci_52                -8.712537e-05 3 1  ON 51
ci_53                -8.719846e-04 3 1  ON 52
ci_54                -1.007331e-03 3 1  ON 53
ci_55                -1.191059e-03 3 1  ON 54
ci_56                 1.413005e-03 3 1  ON 55
ci_57                 1.011530e-03 3 1  ON 56
ci_58                -7.566489e-04 3 1  ON 57
ci_59                -1.682393e-03 3 1  ON 58
ci_60                 2.479684e-03 3 1  ON 59
ci_61                 1.849386e-03 3 1  ON 60
ci_62                -3.540594e-04 3 1  ON 61
ci_63                -6.490952e-04 3 1  ON 62
ci_64                -5.234657e-04 3 1  ON 63
ci_65                -3.123535e-04 3 1  ON 64
ci_66                -3.501286e-04 3 1  ON 65
ci_67                -9.123377e-04 3 1  ON 66
ci_68                -1.200311e-03 3 1  ON 67
ci_69                -1.333445e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8817
    reference variance = 0.473922
====================================================
  Execution time = 2.5584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8705e-01
  Total weights = 1.963610794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471221884047
                                         uncertainty =       0.002227978425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471221884047
                                         uncertainty =       0.002227978425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485378569
  error estimate for blocks of size 2^( 2) =       0.000506342239
  error estimate for blocks of size 2^( 3) =       0.000527097211
  error estimate for blocks of size 2^( 4) =       0.000542682596
  error estimate for blocks of size 2^( 5) =       0.000553405348
  error estimate for blocks of size 2^( 6) =       0.000558821121
  error estimate for blocks of size 2^( 7) =       0.000560470390

      target function =                  N/A
              le_mean =     -22.819470663256
             les_mean =     521.215288425544
             stat err =       0.000553844864
             autocorr =       1.302012250079
              std dev =       0.686428955596
             le_variance =       0.471184711080


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281947066326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819470663209       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819491545495       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819491554213       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819491576400       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-01 is 1.652391e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819470663209       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819479739815       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819479682115       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819479678546       residual = 4.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-01 is 6.036076e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819470663209       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819473446264       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819473446133       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819473437015       residual = 4.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 1.943234e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0138e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.189346e-01 3 1  ON 0
ci_02                -2.597203e-02 3 1  ON 1
ci_03                -2.626408e-02 3 1  ON 2
ci_04                 2.469449e-02 3 1  ON 3
ci_05                -2.367900e-02 3 1  ON 4
ci_06                -2.280824e-02 3 1  ON 5
ci_07                 2.488816e-02 3 1  ON 6
ci_08                -4.019390e-03 3 1  ON 7
ci_09                -1.157230e-02 3 1  ON 8
ci_10                -1.119549e-02 3 1  ON 9
ci_11                 1.601460e-02 3 1  ON 10
ci_12                 1.069967e-02 3 1  ON 11
ci_13                 1.286280e-02 3 1  ON 12
ci_14                 1.611776e-02 3 1  ON 13
ci_15                 7.840863e-03 3 1  ON 14
ci_16                 8.190223e-03 3 1  ON 15
ci_17                -8.990668e-03 3 1  ON 16
ci_18                -9.060146e-03 3 1  ON 17
ci_19                 9.818992e-03 3 1  ON 18
ci_20                 1.069667e-02 3 1  ON 19
ci_21                 8.302480e-03 3 1  ON 20
ci_22                 7.731362e-03 3 1  ON 21
ci_23                 6.390265e-03 3 1  ON 22
ci_24                 7.765750e-03 3 1  ON 23
ci_25                 5.014360e-03 3 1  ON 24
ci_26                 2.086715e-03 3 1  ON 25
ci_27                 2.621623e-03 3 1  ON 26
ci_28                 4.254718e-03 3 1  ON 27
ci_29                 4.095083e-03 3 1  ON 28
ci_30                 2.412880e-05 3 1  ON 29
ci_31                 1.036175e-03 3 1  ON 30
ci_32                -8.036997e-04 3 1  ON 31
ci_33                 4.076893e-05 3 1  ON 32
ci_34                 9.695740e-04 3 1  ON 33
ci_35                -9.973308e-06 3 1  ON 34
ci_36                -9.182933e-04 3 1  ON 35
ci_37                -7.531077e-04 3 1  ON 36
ci_38                -2.144314e-04 3 1  ON 37
ci_39                -3.368761e-04 3 1  ON 38
ci_40                -1.387753e-03 3 1  ON 39
ci_41                 6.472213e-04 3 1  ON 40
ci_42                -6.610740e-05 3 1  ON 41
ci_43                -2.452919e-03 3 1  ON 42
ci_44                -2.586402e-03 3 1  ON 43
ci_45                -5.859671e-04 3 1  ON 44
ci_46                 1.205045e-05 3 1  ON 45
ci_47                -5.414157e-04 3 1  ON 46
ci_48                -5.392216e-04 3 1  ON 47
ci_49                -9.207737e-04 3 1  ON 48
ci_50                -4.388486e-04 3 1  ON 49
ci_51                 2.143968e-04 3 1  ON 50
ci_52                -3.103978e-05 3 1  ON 51
ci_53                -8.442485e-04 3 1  ON 52
ci_54                -9.517083e-04 3 1  ON 53
ci_55                -1.068271e-03 3 1  ON 54
ci_56                 1.410312e-03 3 1  ON 55
ci_57                 1.615138e-03 3 1  ON 56
ci_58                -1.079843e-03 3 1  ON 57
ci_59                -1.622908e-03 3 1  ON 58
ci_60                 2.341198e-03 3 1  ON 59
ci_61                 1.954723e-03 3 1  ON 60
ci_62                -5.419367e-04 3 1  ON 61
ci_63                -7.770055e-04 3 1  ON 62
ci_64                -5.770546e-04 3 1  ON 63
ci_65                -3.789896e-04 3 1  ON 64
ci_66                -5.237990e-04 3 1  ON 65
ci_67                -8.465037e-04 3 1  ON 66
ci_68                -1.204044e-03 3 1  ON 67
ci_69                -1.056727e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8284
    reference variance = 0.555896
====================================================
  Execution time = 2.4885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9079e-01
  Total weights = 1.9637e+06
  Execution time = 3.5367e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475696324188
                                         uncertainty =       0.002305113822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475696324188
                                         uncertainty =       0.002305113822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487706931
  error estimate for blocks of size 2^( 2) =       0.000509032373
  error estimate for blocks of size 2^( 3) =       0.000529492990
  error estimate for blocks of size 2^( 4) =       0.000545044208
  error estimate for blocks of size 2^( 5) =       0.000554136729
  error estimate for blocks of size 2^( 6) =       0.000560667104
  error estimate for blocks of size 2^( 7) =       0.000563677736

      target function =                  N/A
              le_mean =     -22.818913526120
             les_mean =     521.199837813941
             stat err =       0.000555881444
             autocorr =       1.299111716344
              std dev =       0.689721755843
             le_variance =       0.475716100482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475603193232
                                         uncertainty =       0.002306919918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475603193232
                                         uncertainty =       0.002306919918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487658294
  error estimate for blocks of size 2^( 2) =       0.000508996434
  error estimate for blocks of size 2^( 3) =       0.000529488001
  error estimate for blocks of size 2^( 4) =       0.000545068048
  error estimate for blocks of size 2^( 5) =       0.000554185034
  error estimate for blocks of size 2^( 6) =       0.000560724543
  error estimate for blocks of size 2^( 7) =       0.000563716113

      target function =                  N/A
              le_mean =     -22.818913281622
             les_mean =     521.210471499542
             stat err =       0.000555923435
             autocorr =       1.299567174312
              std dev =       0.689652973654
             le_variance =       0.475621224070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475639156639
                                         uncertainty =       0.002303860112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475639156639
                                         uncertainty =       0.002303860112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487676935
  error estimate for blocks of size 2^( 2) =       0.000509019407
  error estimate for blocks of size 2^( 3) =       0.000529504727
  error estimate for blocks of size 2^( 4) =       0.000545078522
  error estimate for blocks of size 2^( 5) =       0.000554189687
  error estimate for blocks of size 2^( 6) =       0.000560722375
  error estimate for blocks of size 2^( 7) =       0.000563682508

      target function =                  N/A
              le_mean =     -22.818909326550
             les_mean =     521.651825967255
             stat err =       0.000555918273
             autocorr =       1.299443696442
              std dev =       0.689679336061
             le_variance =       0.475657586589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475661255243
                                         uncertainty =       0.002304993779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475661255243
                                         uncertainty =       0.002304993779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487688860
  error estimate for blocks of size 2^( 2) =       0.000509017263
  error estimate for blocks of size 2^( 3) =       0.000529481760
  error estimate for blocks of size 2^( 4) =       0.000545036738
  error estimate for blocks of size 2^( 5) =       0.000554134672
  error estimate for blocks of size 2^( 6) =       0.000560665034
  error estimate for blocks of size 2^( 7) =       0.000563671174

      target function =                  N/A
              le_mean =     -22.818909577465
             les_mean =     521.194420906787
             stat err =       0.000555876905
             autocorr =       1.299186772549
              std dev =       0.689696200225
             le_variance =       0.475680848605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818913526120        initial  <--
     1.5259e-01     1.5259e+00             1.6524e-03       -22.818913281622
     6.1035e-01     6.1035e+00             6.0361e-04       -22.818909326550
     2.4414e+00     2.4414e+01             1.9432e-04       -22.818909577465

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7072
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_01                 1.194892e-01 3 1  ON 0
ci_02                -2.586064e-02 3 1  ON 1
ci_03                -2.626970e-02 3 1  ON 2
ci_04                 2.512245e-02 3 1  ON 3
ci_05                -2.379335e-02 3 1  ON 4
ci_06                -2.264245e-02 3 1  ON 5
ci_07                 2.510363e-02 3 1  ON 6
ci_08                -3.991821e-03 3 1  ON 7
ci_09                -1.168643e-02 3 1  ON 8
ci_10                -1.137268e-02 3 1  ON 9
ci_11                 1.593485e-02 3 1  ON 10
ci_12                 1.058823e-02 3 1  ON 11
ci_13                 1.314692e-02 3 1  ON 12
ci_14                 1.607792e-02 3 1  ON 13
ci_15                 7.977862e-03 3 1  ON 14
ci_16                 8.077618e-03 3 1  ON 15
ci_17                -9.013679e-03 3 1  ON 16
ci_18                -9.381715e-03 3 1  ON 17
ci_19                 9.829101e-03 3 1  ON 18
ci_20                 1.073270e-02 3 1  ON 19
ci_21                 8.188726e-03 3 1  ON 20
ci_22                 7.922904e-03 3 1  ON 21
ci_23                 6.330053e-03 3 1  ON 22
ci_24                 7.824466e-03 3 1  ON 23
ci_25                 5.165664e-03 3 1  ON 24
ci_26                 2.111225e-03 3 1  ON 25
ci_27                 2.405721e-03 3 1  ON 26
ci_28                 4.254354e-03 3 1  ON 27
ci_29                 4.466192e-03 3 1  ON 28
ci_30                 8.998344e-05 3 1  ON 29
ci_31                 1.034626e-03 3 1  ON 30
ci_32                -6.296725e-04 3 1  ON 31
ci_33                 8.931563e-05 3 1  ON 32
ci_34                 9.452948e-04 3 1  ON 33
ci_35                 6.396765e-05 3 1  ON 34
ci_36                -9.738919e-04 3 1  ON 35
ci_37                -5.696483e-04 3 1  ON 36
ci_38                -1.230123e-05 3 1  ON 37
ci_39                -1.542022e-04 3 1  ON 38
ci_40                -1.502068e-03 3 1  ON 39
ci_41                 5.794002e-04 3 1  ON 40
ci_42                -4.380623e-04 3 1  ON 41
ci_43                -2.461736e-03 3 1  ON 42
ci_44                -2.471062e-03 3 1  ON 43
ci_45                -8.676143e-04 3 1  ON 44
ci_46                -1.683681e-04 3 1  ON 45
ci_47                -2.935755e-04 3 1  ON 46
ci_48                -4.710226e-04 3 1  ON 47
ci_49                -7.288756e-04 3 1  ON 48
ci_50                -4.177924e-04 3 1  ON 49
ci_51                 2.099046e-05 3 1  ON 50
ci_52                -8.712537e-05 3 1  ON 51
ci_53                -8.719846e-04 3 1  ON 52
ci_54                -1.007331e-03 3 1  ON 53
ci_55                -1.191059e-03 3 1  ON 54
ci_56                 1.413005e-03 3 1  ON 55
ci_57                 1.011530e-03 3 1  ON 56
ci_58                -7.566489e-04 3 1  ON 57
ci_59                -1.682393e-03 3 1  ON 58
ci_60                 2.479684e-03 3 1  ON 59
ci_61                 1.849386e-03 3 1  ON 60
ci_62                -3.540594e-04 3 1  ON 61
ci_63                -6.490952e-04 3 1  ON 62
ci_64                -5.234657e-04 3 1  ON 63
ci_65                -3.123535e-04 3 1  ON 64
ci_66                -3.501286e-04 3 1  ON 65
ci_67                -9.123377e-04 3 1  ON 66
ci_68                -1.200311e-03 3 1  ON 67
ci_69                -1.333445e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7949
    reference variance = 0.354286
====================================================
  Execution time = 2.5416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8617e-01
  Total weights = 1.963610013e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472251701479
                                         uncertainty =       0.002405300857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472251701479
                                         uncertainty =       0.002405300857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485892345
  error estimate for blocks of size 2^( 2) =       0.000507371684
  error estimate for blocks of size 2^( 3) =       0.000527916269
  error estimate for blocks of size 2^( 4) =       0.000543290240
  error estimate for blocks of size 2^( 5) =       0.000553234645
  error estimate for blocks of size 2^( 6) =       0.000558376141
  error estimate for blocks of size 2^( 7) =       0.000559524083

      target function =                  N/A
              le_mean =     -22.819284123716
             les_mean =     521.205900439818
             stat err =       0.000553606277
             autocorr =       1.298141090450
              std dev =       0.687155544700
             le_variance =       0.472182742612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281928412372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819284123644       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819289718515       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819289761437       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819289762647       residual = 5.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.170006e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819284123644       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819285644413       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819285673612       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819285671474       residual = 7.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 5.717707e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819284123644       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819284512315       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819284521210       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819284520491       residual = 8.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.449080e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9982e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.194337e-01 3 1  ON 0
ci_02                -2.583896e-02 3 1  ON 1
ci_03                -2.628976e-02 3 1  ON 2
ci_04                 2.510035e-02 3 1  ON 3
ci_05                -2.377938e-02 3 1  ON 4
ci_06                -2.266161e-02 3 1  ON 5
ci_07                 2.510508e-02 3 1  ON 6
ci_08                -4.021237e-03 3 1  ON 7
ci_09                -1.167920e-02 3 1  ON 8
ci_10                -1.142294e-02 3 1  ON 9
ci_11                 1.593674e-02 3 1  ON 10
ci_12                 1.058818e-02 3 1  ON 11
ci_13                 1.308975e-02 3 1  ON 12
ci_14                 1.608773e-02 3 1  ON 13
ci_15                 7.983596e-03 3 1  ON 14
ci_16                 8.047317e-03 3 1  ON 15
ci_17                -9.029792e-03 3 1  ON 16
ci_18                -9.380678e-03 3 1  ON 17
ci_19                 9.786432e-03 3 1  ON 18
ci_20                 1.072800e-02 3 1  ON 19
ci_21                 8.192627e-03 3 1  ON 20
ci_22                 7.925362e-03 3 1  ON 21
ci_23                 6.278639e-03 3 1  ON 22
ci_24                 7.814467e-03 3 1  ON 23
ci_25                 5.110857e-03 3 1  ON 24
ci_26                 2.108078e-03 3 1  ON 25
ci_27                 2.428303e-03 3 1  ON 26
ci_28                 4.253303e-03 3 1  ON 27
ci_29                 4.448009e-03 3 1  ON 28
ci_30                 8.004217e-05 3 1  ON 29
ci_31                 1.015658e-03 3 1  ON 30
ci_32                -5.964710e-04 3 1  ON 31
ci_33                 6.219140e-05 3 1  ON 32
ci_34                 9.205634e-04 3 1  ON 33
ci_35                 9.554537e-05 3 1  ON 34
ci_36                -9.744035e-04 3 1  ON 35
ci_37                -5.898118e-04 3 1  ON 36
ci_38                -3.079869e-05 3 1  ON 37
ci_39                -1.850416e-04 3 1  ON 38
ci_40                -1.485452e-03 3 1  ON 39
ci_41                 5.756652e-04 3 1  ON 40
ci_42                -4.039887e-04 3 1  ON 41
ci_43                -2.441307e-03 3 1  ON 42
ci_44                -2.493588e-03 3 1  ON 43
ci_45                -8.451238e-04 3 1  ON 44
ci_46                -1.582182e-04 3 1  ON 45
ci_47                -3.030214e-04 3 1  ON 46
ci_48                -4.567600e-04 3 1  ON 47
ci_49                -7.690866e-04 3 1  ON 48
ci_50                -4.143777e-04 3 1  ON 49
ci_51                 3.730862e-05 3 1  ON 50
ci_52                -8.236206e-05 3 1  ON 51
ci_53                -8.885539e-04 3 1  ON 52
ci_54                -9.811339e-04 3 1  ON 53
ci_55                -1.172709e-03 3 1  ON 54
ci_56                 1.461422e-03 3 1  ON 55
ci_57                 1.054008e-03 3 1  ON 56
ci_58                -7.632372e-04 3 1  ON 57
ci_59                -1.695722e-03 3 1  ON 58
ci_60                 2.510289e-03 3 1  ON 59
ci_61                 1.821946e-03 3 1  ON 60
ci_62                -3.238409e-04 3 1  ON 61
ci_63                -6.225892e-04 3 1  ON 62
ci_64                -4.842709e-04 3 1  ON 63
ci_65                -3.211145e-04 3 1  ON 64
ci_66                -3.602947e-04 3 1  ON 65
ci_67                -8.796798e-04 3 1  ON 66
ci_68                -1.206353e-03 3 1  ON 67
ci_69                -1.334287e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.852
    reference variance = 1.09443
====================================================
  Execution time = 2.4726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8985e-01
  Total weights = 1.9633e+06
  Execution time = 3.5612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471954255989
                                         uncertainty =       0.002884478980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471954255989
                                         uncertainty =       0.002884478980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485806718
  error estimate for blocks of size 2^( 2) =       0.000506700925
  error estimate for blocks of size 2^( 3) =       0.000527050289
  error estimate for blocks of size 2^( 4) =       0.000543486411
  error estimate for blocks of size 2^( 5) =       0.000552499444
  error estimate for blocks of size 2^( 6) =       0.000559880016
  error estimate for blocks of size 2^( 7) =       0.000560826365

      target function =                  N/A
              le_mean =     -22.819235817609
             les_mean =     521.207412521146
             stat err =       0.000554173059
             autocorr =       1.301259117579
              std dev =       0.687034449180
             le_variance =       0.472016334360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471927560272
                                         uncertainty =       0.002883328145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471927560272
                                         uncertainty =       0.002883328145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485793121
  error estimate for blocks of size 2^( 2) =       0.000506690658
  error estimate for blocks of size 2^( 3) =       0.000527045030
  error estimate for blocks of size 2^( 4) =       0.000543487710
  error estimate for blocks of size 2^( 5) =       0.000552509084
  error estimate for blocks of size 2^( 6) =       0.000559892694
  error estimate for blocks of size 2^( 7) =       0.000560844952

      target function =                  N/A
              le_mean =     -22.819236100841
             les_mean =     521.207712032497
             stat err =       0.000554183610
             autocorr =       1.301381513853
              std dev =       0.687015220131
             le_variance =       0.471989912691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471940190484
                                         uncertainty =       0.002883895143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471940190484
                                         uncertainty =       0.002883895143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485799557
  error estimate for blocks of size 2^( 2) =       0.000506693884
  error estimate for blocks of size 2^( 3) =       0.000527043638
  error estimate for blocks of size 2^( 4) =       0.000543483946
  error estimate for blocks of size 2^( 5) =       0.000552500606
  error estimate for blocks of size 2^( 6) =       0.000559882265
  error estimate for blocks of size 2^( 7) =       0.000560831398

      target function =                  N/A
              le_mean =     -22.819236900035
             les_mean =     521.640412964631
             stat err =       0.000554174554
             autocorr =       1.301304500812
              std dev =       0.687024321585
             le_variance =       0.472002418449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471951841639
                                         uncertainty =       0.002884396623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471951841639
                                         uncertainty =       0.002884396623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485805486
  error estimate for blocks of size 2^( 2) =       0.000506699954
  error estimate for blocks of size 2^( 3) =       0.000527049684
  error estimate for blocks of size 2^( 4) =       0.000543486283
  error estimate for blocks of size 2^( 5) =       0.000552499900
  error estimate for blocks of size 2^( 6) =       0.000559880636
  error estimate for blocks of size 2^( 7) =       0.000560827370

      target function =                  N/A
              le_mean =     -22.819235781540
             les_mean =     521.207374959682
             stat err =       0.000554173547
             autocorr =       1.301268012333
              std dev =       0.687032706305
             le_variance =       0.472013939533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819235817609        initial
     1.5259e+00     1.5259e+01             2.1700e-04       -22.819236100841
     6.1035e+00     6.1035e+01             5.7177e-05       -22.819236900035  <--
     2.4414e+01     2.4414e+02             1.4491e-05       -22.819235781540

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.2522e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_01                 1.194337e-01 3 1  ON 0
ci_02                -2.583896e-02 3 1  ON 1
ci_03                -2.628976e-02 3 1  ON 2
ci_04                 2.510035e-02 3 1  ON 3
ci_05                -2.377938e-02 3 1  ON 4
ci_06                -2.266161e-02 3 1  ON 5
ci_07                 2.510508e-02 3 1  ON 6
ci_08                -4.021237e-03 3 1  ON 7
ci_09                -1.167920e-02 3 1  ON 8
ci_10                -1.142294e-02 3 1  ON 9
ci_11                 1.593674e-02 3 1  ON 10
ci_12                 1.058818e-02 3 1  ON 11
ci_13                 1.308975e-02 3 1  ON 12
ci_14                 1.608773e-02 3 1  ON 13
ci_15                 7.983596e-03 3 1  ON 14
ci_16                 8.047317e-03 3 1  ON 15
ci_17                -9.029792e-03 3 1  ON 16
ci_18                -9.380678e-03 3 1  ON 17
ci_19                 9.786432e-03 3 1  ON 18
ci_20                 1.072800e-02 3 1  ON 19
ci_21                 8.192627e-03 3 1  ON 20
ci_22                 7.925362e-03 3 1  ON 21
ci_23                 6.278639e-03 3 1  ON 22
ci_24                 7.814467e-03 3 1  ON 23
ci_25                 5.110857e-03 3 1  ON 24
ci_26                 2.108078e-03 3 1  ON 25
ci_27                 2.428303e-03 3 1  ON 26
ci_28                 4.253303e-03 3 1  ON 27
ci_29                 4.448009e-03 3 1  ON 28
ci_30                 8.004217e-05 3 1  ON 29
ci_31                 1.015658e-03 3 1  ON 30
ci_32                -5.964710e-04 3 1  ON 31
ci_33                 6.219140e-05 3 1  ON 32
ci_34                 9.205634e-04 3 1  ON 33
ci_35                 9.554537e-05 3 1  ON 34
ci_36                -9.744035e-04 3 1  ON 35
ci_37                -5.898118e-04 3 1  ON 36
ci_38                -3.079869e-05 3 1  ON 37
ci_39                -1.850416e-04 3 1  ON 38
ci_40                -1.485452e-03 3 1  ON 39
ci_41                 5.756652e-04 3 1  ON 40
ci_42                -4.039887e-04 3 1  ON 41
ci_43                -2.441307e-03 3 1  ON 42
ci_44                -2.493588e-03 3 1  ON 43
ci_45                -8.451238e-04 3 1  ON 44
ci_46                -1.582182e-04 3 1  ON 45
ci_47                -3.030214e-04 3 1  ON 46
ci_48                -4.567600e-04 3 1  ON 47
ci_49                -7.690866e-04 3 1  ON 48
ci_50                -4.143777e-04 3 1  ON 49
ci_51                 3.730862e-05 3 1  ON 50
ci_52                -8.236206e-05 3 1  ON 51
ci_53                -8.885539e-04 3 1  ON 52
ci_54                -9.811339e-04 3 1  ON 53
ci_55                -1.172709e-03 3 1  ON 54
ci_56                 1.461422e-03 3 1  ON 55
ci_57                 1.054008e-03 3 1  ON 56
ci_58                -7.632372e-04 3 1  ON 57
ci_59                -1.695722e-03 3 1  ON 58
ci_60                 2.510289e-03 3 1  ON 59
ci_61                 1.821946e-03 3 1  ON 60
ci_62                -3.238409e-04 3 1  ON 61
ci_63                -6.225892e-04 3 1  ON 62
ci_64                -4.842709e-04 3 1  ON 63
ci_65                -3.211145e-04 3 1  ON 64
ci_66                -3.602947e-04 3 1  ON 65
ci_67                -8.796798e-04 3 1  ON 66
ci_68                -1.206353e-03 3 1  ON 67
ci_69                -1.334287e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.8743
    reference variance = 0.669342
====================================================
  Execution time = 2.5329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5358e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8829e-01
  Total weights = 1.963812805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471483714101
                                         uncertainty =       0.002352211764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471483714101
                                         uncertainty =       0.002352211764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485578306
  error estimate for blocks of size 2^( 2) =       0.000506668456
  error estimate for blocks of size 2^( 3) =       0.000527259560
  error estimate for blocks of size 2^( 4) =       0.000543745862
  error estimate for blocks of size 2^( 5) =       0.000554083124
  error estimate for blocks of size 2^( 6) =       0.000562056350
  error estimate for blocks of size 2^( 7) =       0.000564909897

      target function =                  N/A
              le_mean =     -22.818956711457
             les_mean =     521.193077170673
             stat err =       0.000556198808
             autocorr =       1.312023327183
              std dev =       0.686711426121
             le_variance =       0.471572582766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281895671146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818956711395       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818960855329       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818960573524       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818960559835       residual = 3.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.726531e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818956711395       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818957839670       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818957761890       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818957754650       residual = 6.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 7.328920e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818956711395       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818956999889       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818956980064       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818956977980       residual = 7.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.871289e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9895e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.193628e-01 3 1  ON 0
ci_02                -2.585165e-02 3 1  ON 1
ci_03                -2.627874e-02 3 1  ON 2
ci_04                 2.511269e-02 3 1  ON 3
ci_05                -2.374124e-02 3 1  ON 4
ci_06                -2.264965e-02 3 1  ON 5
ci_07                 2.511643e-02 3 1  ON 6
ci_08                -4.022041e-03 3 1  ON 7
ci_09                -1.168305e-02 3 1  ON 8
ci_10                -1.143708e-02 3 1  ON 9
ci_11                 1.598213e-02 3 1  ON 10
ci_12                 1.057897e-02 3 1  ON 11
ci_13                 1.308880e-02 3 1  ON 12
ci_14                 1.612327e-02 3 1  ON 13
ci_15                 7.945199e-03 3 1  ON 14
ci_16                 8.068746e-03 3 1  ON 15
ci_17                -9.045380e-03 3 1  ON 16
ci_18                -9.360260e-03 3 1  ON 17
ci_19                 9.780539e-03 3 1  ON 18
ci_20                 1.073915e-02 3 1  ON 19
ci_21                 8.187885e-03 3 1  ON 20
ci_22                 7.909518e-03 3 1  ON 21
ci_23                 6.232314e-03 3 1  ON 22
ci_24                 7.815890e-03 3 1  ON 23
ci_25                 5.088646e-03 3 1  ON 24
ci_26                 2.181367e-03 3 1  ON 25
ci_27                 2.478230e-03 3 1  ON 26
ci_28                 4.263796e-03 3 1  ON 27
ci_29                 4.394824e-03 3 1  ON 28
ci_30                 1.074421e-04 3 1  ON 29
ci_31                 9.859863e-04 3 1  ON 30
ci_32                -5.393949e-04 3 1  ON 31
ci_33                 6.939806e-05 3 1  ON 32
ci_34                 8.760219e-04 3 1  ON 33
ci_35                 1.665449e-04 3 1  ON 34
ci_36                -9.896253e-04 3 1  ON 35
ci_37                -6.058942e-04 3 1  ON 36
ci_38                -4.526196e-05 3 1  ON 37
ci_39                -1.818722e-04 3 1  ON 38
ci_40                -1.478678e-03 3 1  ON 39
ci_41                 5.793707e-04 3 1  ON 40
ci_42                -3.475162e-04 3 1  ON 41
ci_43                -2.403330e-03 3 1  ON 42
ci_44                -2.500759e-03 3 1  ON 43
ci_45                -8.272731e-04 3 1  ON 44
ci_46                -1.621473e-04 3 1  ON 45
ci_47                -2.848646e-04 3 1  ON 46
ci_48                -4.286195e-04 3 1  ON 47
ci_49                -7.851718e-04 3 1  ON 48
ci_50                -4.352534e-04 3 1  ON 49
ci_51                 4.331374e-05 3 1  ON 50
ci_52                -7.661635e-05 3 1  ON 51
ci_53                -8.997557e-04 3 1  ON 52
ci_54                -9.992023e-04 3 1  ON 53
ci_55                -1.172100e-03 3 1  ON 54
ci_56                 1.406414e-03 3 1  ON 55
ci_57                 1.041042e-03 3 1  ON 56
ci_58                -7.755963e-04 3 1  ON 57
ci_59                -1.728176e-03 3 1  ON 58
ci_60                 2.524211e-03 3 1  ON 59
ci_61                 1.833162e-03 3 1  ON 60
ci_62                -3.026262e-04 3 1  ON 61
ci_63                -6.508890e-04 3 1  ON 62
ci_64                -5.049583e-04 3 1  ON 63
ci_65                -3.433751e-04 3 1  ON 64
ci_66                -3.573771e-04 3 1  ON 65
ci_67                -8.186881e-04 3 1  ON 66
ci_68                -1.228094e-03 3 1  ON 67
ci_69                -1.342993e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7965
    reference variance = 0.357382
====================================================
  Execution time = 2.4808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8577e-01
  Total weights = 1.9634e+06
  Execution time = 3.5236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470210880105
                                         uncertainty =       0.002414188326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470210880105
                                         uncertainty =       0.002414188326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484873947
  error estimate for blocks of size 2^( 2) =       0.000506150510
  error estimate for blocks of size 2^( 3) =       0.000526820888
  error estimate for blocks of size 2^( 4) =       0.000542413394
  error estimate for blocks of size 2^( 5) =       0.000552546934
  error estimate for blocks of size 2^( 6) =       0.000558141567
  error estimate for blocks of size 2^( 7) =       0.000563384284

      target function =                  N/A
              le_mean =     -22.819207131245
             les_mean =     521.202141884603
             stat err =       0.000554121545
             autocorr =       1.306027654597
              std dev =       0.685715312188
             le_variance =       0.470205489369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470240176999
                                         uncertainty =       0.002419116175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470240176999
                                         uncertainty =       0.002419116175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484888279
  error estimate for blocks of size 2^( 2) =       0.000506167032
  error estimate for blocks of size 2^( 3) =       0.000526839641
  error estimate for blocks of size 2^( 4) =       0.000542431707
  error estimate for blocks of size 2^( 5) =       0.000552570199
  error estimate for blocks of size 2^( 6) =       0.000558173630
  error estimate for blocks of size 2^( 7) =       0.000563437715

      target function =                  N/A
              le_mean =     -22.819208619465
             les_mean =     521.205799554159
             stat err =       0.000554153313
             autocorr =       1.306100196963
              std dev =       0.685735580633
             le_variance =       0.470233286546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470224562692
                                         uncertainty =       0.002416841123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470224562692
                                         uncertainty =       0.002416841123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484880566
  error estimate for blocks of size 2^( 2) =       0.000506158524
  error estimate for blocks of size 2^( 3) =       0.000526829844
  error estimate for blocks of size 2^( 4) =       0.000542422267
  error estimate for blocks of size 2^( 5) =       0.000552558415
  error estimate for blocks of size 2^( 6) =       0.000558157481
  error estimate for blocks of size 2^( 7) =       0.000563412454

      target function =                  N/A
              le_mean =     -22.819207829145
             les_mean =     521.202425559357
             stat err =       0.000554137654
             autocorr =       1.306067938453
              std dev =       0.685724672038
             le_variance =       0.470218325842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470212320181
                                         uncertainty =       0.002414519378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470212320181
                                         uncertainty =       0.002414519378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484874632
  error estimate for blocks of size 2^( 2) =       0.000506151372
  error estimate for blocks of size 2^( 3) =       0.000526821876
  error estimate for blocks of size 2^( 4) =       0.000542414274
  error estimate for blocks of size 2^( 5) =       0.000552548019
  error estimate for blocks of size 2^( 6) =       0.000558142691
  error estimate for blocks of size 2^( 7) =       0.000563386596

      target function =                  N/A
              le_mean =     -22.819207323379
             les_mean =     521.205964838428
             stat err =       0.000554122895
             autocorr =       1.306030329332
              std dev =       0.685716281136
             le_variance =       0.470206818215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819207131245        initial
     1.5259e+00     1.5259e+01             2.7265e-04       -22.819208619465  <--
     6.1035e+00     6.1035e+01             7.3289e-05       -22.819207829145
     2.4414e+01     2.4414e+02             1.8713e-05       -22.819207323379

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.2538e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_01                 1.191610e-01 3 1  ON 0
ci_02                -2.588464e-02 3 1  ON 1
ci_03                -2.625135e-02 3 1  ON 2
ci_04                 2.514911e-02 3 1  ON 3
ci_05                -2.363721e-02 3 1  ON 4
ci_06                -2.261737e-02 3 1  ON 5
ci_07                 2.514580e-02 3 1  ON 6
ci_08                -4.023931e-03 3 1  ON 7
ci_09                -1.169284e-02 3 1  ON 8
ci_10                -1.147327e-02 3 1  ON 9
ci_11                 1.610582e-02 3 1  ON 10
ci_12                 1.055603e-02 3 1  ON 11
ci_13                 1.308338e-02 3 1  ON 12
ci_14                 1.622602e-02 3 1  ON 13
ci_15                 7.838352e-03 3 1  ON 14
ci_16                 8.124681e-03 3 1  ON 15
ci_17                -9.086732e-03 3 1  ON 16
ci_18                -9.302940e-03 3 1  ON 17
ci_19                 9.767971e-03 3 1  ON 18
ci_20                 1.077116e-02 3 1  ON 19
ci_21                 8.175091e-03 3 1  ON 20
ci_22                 7.866673e-03 3 1  ON 21
ci_23                 6.116619e-03 3 1  ON 22
ci_24                 7.819582e-03 3 1  ON 23
ci_25                 5.030657e-03 3 1  ON 24
ci_26                 2.378676e-03 3 1  ON 25
ci_27                 2.613402e-03 3 1  ON 26
ci_28                 4.291553e-03 3 1  ON 27
ci_29                 4.251267e-03 3 1  ON 28
ci_30                 1.861560e-04 3 1  ON 29
ci_31                 9.049653e-04 3 1  ON 30
ci_32                -3.924124e-04 3 1  ON 31
ci_33                 8.605667e-05 3 1  ON 32
ci_34                 7.551420e-04 3 1  ON 33
ci_35                 3.578183e-04 3 1  ON 34
ci_36                -1.026779e-03 3 1  ON 35
ci_37                -6.470051e-04 3 1  ON 36
ci_38                -8.097523e-05 3 1  ON 37
ci_39                -1.733322e-04 3 1  ON 38
ci_40                -1.462194e-03 3 1  ON 39
ci_41                 5.859109e-04 3 1  ON 40
ci_42                -2.024539e-04 3 1  ON 41
ci_43                -2.297264e-03 3 1  ON 42
ci_44                -2.519615e-03 3 1  ON 43
ci_45                -7.814594e-04 3 1  ON 44
ci_46                -1.721308e-04 3 1  ON 45
ci_47                -2.367667e-04 3 1  ON 46
ci_48                -3.515787e-04 3 1  ON 47
ci_49                -8.259142e-04 3 1  ON 48
ci_50                -4.850698e-04 3 1  ON 49
ci_51                 5.914588e-05 3 1  ON 50
ci_52                -6.208506e-05 3 1  ON 51
ci_53                -9.270151e-04 3 1  ON 52
ci_54                -1.047671e-03 3 1  ON 53
ci_55                -1.170573e-03 3 1  ON 54
ci_56                 1.266657e-03 3 1  ON 55
ci_57                 1.011313e-03 3 1  ON 56
ci_58                -8.088648e-04 3 1  ON 57
ci_59                -1.815188e-03 3 1  ON 58
ci_60                 2.564853e-03 3 1  ON 59
ci_61                 1.865832e-03 3 1  ON 60
ci_62                -2.493821e-04 3 1  ON 61
ci_63                -7.207698e-04 3 1  ON 62
ci_64                -5.594860e-04 3 1  ON 63
ci_65                -4.010368e-04 3 1  ON 64
ci_66                -3.507504e-04 3 1  ON 65
ci_67                -6.618592e-04 3 1  ON 66
ci_68                -1.287387e-03 3 1  ON 67
ci_69                -1.364625e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2449e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8304
    reference variance = 0.477858
====================================================
  Execution time = 2.7621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5331e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9346e-01
  Total weights = 1.963741691e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476367134840
                                         uncertainty =       0.004574191240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476367134840
                                         uncertainty =       0.004574191240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488043337
  error estimate for blocks of size 2^( 2) =       0.000508943027
  error estimate for blocks of size 2^( 3) =       0.000528973935
  error estimate for blocks of size 2^( 4) =       0.000545108888
  error estimate for blocks of size 2^( 5) =       0.000553876190
  error estimate for blocks of size 2^( 6) =       0.000559594001
  error estimate for blocks of size 2^( 7) =       0.000564620646

      target function =                  N/A
              le_mean =     -22.818806964550
             les_mean =     521.191409265951
             stat err =       0.000555799931
             autocorr =       1.296940946991
              std dev =       0.690197505866
             le_variance =       0.476372597103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281880696455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818806964505       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818812498483       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818812379840       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818812240264       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 7.047281e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818806964505       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818808834855       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818808582393       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818808559691       residual = 6.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.390188e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818806964505       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818807477197       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818807388018       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818807384674       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 6.676599e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163204 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2134e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.189807e-01 3 1  ON 0
ci_02                -2.574044e-02 3 1  ON 1
ci_03                -2.622124e-02 3 1  ON 2
ci_04                 2.508350e-02 3 1  ON 3
ci_05                -2.351387e-02 3 1  ON 4
ci_06                -2.267127e-02 3 1  ON 5
ci_07                 2.537218e-02 3 1  ON 6
ci_08                -4.126489e-03 3 1  ON 7
ci_09                -1.159457e-02 3 1  ON 8
ci_10                -1.149854e-02 3 1  ON 9
ci_11                 1.606441e-02 3 1  ON 10
ci_12                 1.064665e-02 3 1  ON 11
ci_13                 1.292168e-02 3 1  ON 12
ci_14                 1.617361e-02 3 1  ON 13
ci_15                 7.765285e-03 3 1  ON 14
ci_16                 8.103437e-03 3 1  ON 15
ci_17                -9.239156e-03 3 1  ON 16
ci_18                -9.248060e-03 3 1  ON 17
ci_19                 9.566500e-03 3 1  ON 18
ci_20                 1.084491e-02 3 1  ON 19
ci_21                 8.234744e-03 3 1  ON 20
ci_22                 7.781583e-03 3 1  ON 21
ci_23                 6.282535e-03 3 1  ON 22
ci_24                 7.659176e-03 3 1  ON 23
ci_25                 4.961990e-03 3 1  ON 24
ci_26                 2.458623e-03 3 1  ON 25
ci_27                 2.384858e-03 3 1  ON 26
ci_28                 4.171131e-03 3 1  ON 27
ci_29                 4.236851e-03 3 1  ON 28
ci_30                 3.927861e-04 3 1  ON 29
ci_31                 8.380579e-04 3 1  ON 30
ci_32                -2.780388e-04 3 1  ON 31
ci_33                 4.635525e-05 3 1  ON 32
ci_34                 7.914464e-04 3 1  ON 33
ci_35                 4.134955e-04 3 1  ON 34
ci_36                -9.748108e-04 3 1  ON 35
ci_37                -6.728278e-04 3 1  ON 36
ci_38                 1.028257e-05 3 1  ON 37
ci_39                -1.881700e-04 3 1  ON 38
ci_40                -1.500024e-03 3 1  ON 39
ci_41                 8.249297e-04 3 1  ON 40
ci_42                -6.369851e-05 3 1  ON 41
ci_43                -2.447413e-03 3 1  ON 42
ci_44                -2.422282e-03 3 1  ON 43
ci_45                -6.917081e-04 3 1  ON 44
ci_46                -3.784348e-05 3 1  ON 45
ci_47                -2.200953e-04 3 1  ON 46
ci_48                -3.519113e-04 3 1  ON 47
ci_49                -8.247632e-04 3 1  ON 48
ci_50                -3.663335e-04 3 1  ON 49
ci_51                 1.010416e-04 3 1  ON 50
ci_52                 7.174232e-05 3 1  ON 51
ci_53                -8.764037e-04 3 1  ON 52
ci_54                -1.043057e-03 3 1  ON 53
ci_55                -1.132572e-03 3 1  ON 54
ci_56                 1.243460e-03 3 1  ON 55
ci_57                 1.175920e-03 3 1  ON 56
ci_58                -7.431596e-04 3 1  ON 57
ci_59                -1.786911e-03 3 1  ON 58
ci_60                 2.523927e-03 3 1  ON 59
ci_61                 1.777347e-03 3 1  ON 60
ci_62                -1.373121e-04 3 1  ON 61
ci_63                -5.285874e-04 3 1  ON 62
ci_64                -4.668053e-04 3 1  ON 63
ci_65                -4.317277e-04 3 1  ON 64
ci_66                -4.296386e-04 3 1  ON 65
ci_67                -5.387991e-04 3 1  ON 66
ci_68                -1.151758e-03 3 1  ON 67
ci_69                -1.480797e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7311
    reference variance = 0.506226
====================================================
  Execution time = 2.4675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8754e-01
  Total weights = 1.9636e+06
  Execution time = 3.5365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.227566
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470300870251
                                         uncertainty =       0.002313050987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470300870251
                                         uncertainty =       0.002313050987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484917995
  error estimate for blocks of size 2^( 2) =       0.000506120547
  error estimate for blocks of size 2^( 3) =       0.000526748574
  error estimate for blocks of size 2^( 4) =       0.000542446045
  error estimate for blocks of size 2^( 5) =       0.000551586741
  error estimate for blocks of size 2^( 6) =       0.000558229772
  error estimate for blocks of size 2^( 7) =       0.000561787390

      target function =                  N/A
              le_mean =     -22.818840864102
             les_mean =     521.187811688765
             stat err =       0.000553512487
             autocorr =       1.302921481233
              std dev =       0.685777604974
             le_variance =       0.470290923484

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.019053
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470300783552
                                         uncertainty =       0.002314019577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470300783552
                                         uncertainty =       0.002314019577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484917586
  error estimate for blocks of size 2^( 2) =       0.000506139565
  error estimate for blocks of size 2^( 3) =       0.000526781888
  error estimate for blocks of size 2^( 4) =       0.000542494427
  error estimate for blocks of size 2^( 5) =       0.000551641521
  error estimate for blocks of size 2^( 6) =       0.000558310815
  error estimate for blocks of size 2^( 7) =       0.000561873094

      target function =                  N/A
              le_mean =     -22.818838613292
             les_mean =     521.203557079966
             stat err =       0.000553579964
             autocorr =       1.303241367188
              std dev =       0.685777027320
             le_variance =       0.470290131200

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.237394
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470268090585
                                         uncertainty =       0.002314964827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470268090585
                                         uncertainty =       0.002314964827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484900806
  error estimate for blocks of size 2^( 2) =       0.000506117496
  error estimate for blocks of size 2^( 3) =       0.000526755102
  error estimate for blocks of size 2^( 4) =       0.000542457434
  error estimate for blocks of size 2^( 5) =       0.000551600111
  error estimate for blocks of size 2^( 6) =       0.000558261286
  error estimate for blocks of size 2^( 7) =       0.000561818218

      target function =                  N/A
              le_mean =     -22.818837742817
             les_mean =     521.197257959598
             stat err =       0.000553534262
             autocorr =       1.303116379547
              std dev =       0.685753295895
             le_variance =       0.470257582831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470291148602
                                         uncertainty =       0.002313182450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470291148602
                                         uncertainty =       0.002313182450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484912943
  error estimate for blocks of size 2^( 2) =       0.000506117791
  error estimate for blocks of size 2^( 3) =       0.000526747473
  error estimate for blocks of size 2^( 4) =       0.000542445889
  error estimate for blocks of size 2^( 5) =       0.000551586952
  error estimate for blocks of size 2^( 6) =       0.000558231126
  error estimate for blocks of size 2^( 7) =       0.000561788422

      target function =                  N/A
              le_mean =     -22.818839170742
             les_mean =     521.195286680666
             stat err =       0.000553513097
             autocorr =       1.302951500046
              std dev =       0.685770460990
             le_variance =       0.470281125166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818840864102        initial  <--
     3.8147e-01     3.8147e+00             7.0473e-04       -22.818838613292
     1.5259e+00     1.5259e+01             2.3902e-04       -22.818837742817
     6.1035e+00     6.1035e+01             6.6766e-05       -22.818839170742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4291
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_01                 1.191610e-01 3 1  ON 0
ci_02                -2.588464e-02 3 1  ON 1
ci_03                -2.625135e-02 3 1  ON 2
ci_04                 2.514911e-02 3 1  ON 3
ci_05                -2.363721e-02 3 1  ON 4
ci_06                -2.261737e-02 3 1  ON 5
ci_07                 2.514580e-02 3 1  ON 6
ci_08                -4.023931e-03 3 1  ON 7
ci_09                -1.169284e-02 3 1  ON 8
ci_10                -1.147327e-02 3 1  ON 9
ci_11                 1.610582e-02 3 1  ON 10
ci_12                 1.055603e-02 3 1  ON 11
ci_13                 1.308338e-02 3 1  ON 12
ci_14                 1.622602e-02 3 1  ON 13
ci_15                 7.838352e-03 3 1  ON 14
ci_16                 8.124681e-03 3 1  ON 15
ci_17                -9.086732e-03 3 1  ON 16
ci_18                -9.302940e-03 3 1  ON 17
ci_19                 9.767971e-03 3 1  ON 18
ci_20                 1.077116e-02 3 1  ON 19
ci_21                 8.175091e-03 3 1  ON 20
ci_22                 7.866673e-03 3 1  ON 21
ci_23                 6.116619e-03 3 1  ON 22
ci_24                 7.819582e-03 3 1  ON 23
ci_25                 5.030657e-03 3 1  ON 24
ci_26                 2.378676e-03 3 1  ON 25
ci_27                 2.613402e-03 3 1  ON 26
ci_28                 4.291553e-03 3 1  ON 27
ci_29                 4.251267e-03 3 1  ON 28
ci_30                 1.861560e-04 3 1  ON 29
ci_31                 9.049653e-04 3 1  ON 30
ci_32                -3.924124e-04 3 1  ON 31
ci_33                 8.605667e-05 3 1  ON 32
ci_34                 7.551420e-04 3 1  ON 33
ci_35                 3.578183e-04 3 1  ON 34
ci_36                -1.026779e-03 3 1  ON 35
ci_37                -6.470051e-04 3 1  ON 36
ci_38                -8.097523e-05 3 1  ON 37
ci_39                -1.733322e-04 3 1  ON 38
ci_40                -1.462194e-03 3 1  ON 39
ci_41                 5.859109e-04 3 1  ON 40
ci_42                -2.024539e-04 3 1  ON 41
ci_43                -2.297264e-03 3 1  ON 42
ci_44                -2.519615e-03 3 1  ON 43
ci_45                -7.814594e-04 3 1  ON 44
ci_46                -1.721308e-04 3 1  ON 45
ci_47                -2.367667e-04 3 1  ON 46
ci_48                -3.515787e-04 3 1  ON 47
ci_49                -8.259142e-04 3 1  ON 48
ci_50                -4.850698e-04 3 1  ON 49
ci_51                 5.914588e-05 3 1  ON 50
ci_52                -6.208506e-05 3 1  ON 51
ci_53                -9.270151e-04 3 1  ON 52
ci_54                -1.047671e-03 3 1  ON 53
ci_55                -1.170573e-03 3 1  ON 54
ci_56                 1.266657e-03 3 1  ON 55
ci_57                 1.011313e-03 3 1  ON 56
ci_58                -8.088648e-04 3 1  ON 57
ci_59                -1.815188e-03 3 1  ON 58
ci_60                 2.564853e-03 3 1  ON 59
ci_61                 1.865832e-03 3 1  ON 60
ci_62                -2.493821e-04 3 1  ON 61
ci_63                -7.207698e-04 3 1  ON 62
ci_64                -5.594860e-04 3 1  ON 63
ci_65                -4.010368e-04 3 1  ON 64
ci_66                -3.507504e-04 3 1  ON 65
ci_67                -6.618592e-04 3 1  ON 66
ci_68                -1.287387e-03 3 1  ON 67
ci_69                -1.364625e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8384
    reference variance = 0.463558
====================================================
  Execution time = 2.5442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8281e-01
  Total weights = 1.963704105e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469635128662
                                         uncertainty =       0.002446450287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469635128662
                                         uncertainty =       0.002446450287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484613907
  error estimate for blocks of size 2^( 2) =       0.000506290794
  error estimate for blocks of size 2^( 3) =       0.000526996670
  error estimate for blocks of size 2^( 4) =       0.000542582131
  error estimate for blocks of size 2^( 5) =       0.000552849278
  error estimate for blocks of size 2^( 6) =       0.000556327664
  error estimate for blocks of size 2^( 7) =       0.000560916090

      target function =                  N/A
              le_mean =     -22.819283171930
             les_mean =     521.202495902881
             stat err =       0.000553168791
             autocorr =       1.302937526830
              std dev =       0.685347560254
             le_variance =       0.469701278346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281928317193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819283171909       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819284157741       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819284207889       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819284214205       residual = 8.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 1.227722e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819283171909       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819283426363       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819283438890       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819283440608       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 3.174052e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819283171909       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819283236043       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819283239178       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819283239613       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 8.003606e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9977e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.191435e-01 3 1  ON 0
ci_02                -2.588058e-02 3 1  ON 1
ci_03                -2.624266e-02 3 1  ON 2
ci_04                 2.514365e-02 3 1  ON 3
ci_05                -2.363464e-02 3 1  ON 4
ci_06                -2.262348e-02 3 1  ON 5
ci_07                 2.514032e-02 3 1  ON 6
ci_08                -4.039479e-03 3 1  ON 7
ci_09                -1.169856e-02 3 1  ON 8
ci_10                -1.148108e-02 3 1  ON 9
ci_11                 1.611187e-02 3 1  ON 10
ci_12                 1.056629e-02 3 1  ON 11
ci_13                 1.306508e-02 3 1  ON 12
ci_14                 1.621280e-02 3 1  ON 13
ci_15                 7.834270e-03 3 1  ON 14
ci_16                 8.121739e-03 3 1  ON 15
ci_17                -9.093382e-03 3 1  ON 16
ci_18                -9.310886e-03 3 1  ON 17
ci_19                 9.787306e-03 3 1  ON 18
ci_20                 1.076525e-02 3 1  ON 19
ci_21                 8.188076e-03 3 1  ON 20
ci_22                 7.864052e-03 3 1  ON 21
ci_23                 6.120850e-03 3 1  ON 22
ci_24                 7.815125e-03 3 1  ON 23
ci_25                 5.032878e-03 3 1  ON 24
ci_26                 2.380379e-03 3 1  ON 25
ci_27                 2.613666e-03 3 1  ON 26
ci_28                 4.276412e-03 3 1  ON 27
ci_29                 4.254778e-03 3 1  ON 28
ci_30                 1.972146e-04 3 1  ON 29
ci_31                 9.019056e-04 3 1  ON 30
ci_32                -3.900441e-04 3 1  ON 31
ci_33                 8.321509e-05 3 1  ON 32
ci_34                 7.585202e-04 3 1  ON 33
ci_35                 3.586533e-04 3 1  ON 34
ci_36                -1.028557e-03 3 1  ON 35
ci_37                -6.414955e-04 3 1  ON 36
ci_38                -8.029115e-05 3 1  ON 37
ci_39                -1.762124e-04 3 1  ON 38
ci_40                -1.449069e-03 3 1  ON 39
ci_41                 5.920967e-04 3 1  ON 40
ci_42                -1.963179e-04 3 1  ON 41
ci_43                -2.292111e-03 3 1  ON 42
ci_44                -2.518790e-03 3 1  ON 43
ci_45                -7.728707e-04 3 1  ON 44
ci_46                -1.741087e-04 3 1  ON 45
ci_47                -2.343813e-04 3 1  ON 46
ci_48                -3.591625e-04 3 1  ON 47
ci_49                -8.461908e-04 3 1  ON 48
ci_50                -4.774891e-04 3 1  ON 49
ci_51                 5.512227e-05 3 1  ON 50
ci_52                -6.321940e-05 3 1  ON 51
ci_53                -9.278322e-04 3 1  ON 52
ci_54                -1.023675e-03 3 1  ON 53
ci_55                -1.138832e-03 3 1  ON 54
ci_56                 1.269948e-03 3 1  ON 55
ci_57                 1.017221e-03 3 1  ON 56
ci_58                -7.977536e-04 3 1  ON 57
ci_59                -1.791891e-03 3 1  ON 58
ci_60                 2.542258e-03 3 1  ON 59
ci_61                 1.875400e-03 3 1  ON 60
ci_62                -2.413024e-04 3 1  ON 61
ci_63                -7.286848e-04 3 1  ON 62
ci_64                -5.756870e-04 3 1  ON 63
ci_65                -4.036354e-04 3 1  ON 64
ci_66                -3.683361e-04 3 1  ON 65
ci_67                -6.678692e-04 3 1  ON 66
ci_68                -1.287938e-03 3 1  ON 67
ci_69                -1.366674e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8722
    reference variance = 0.365939
====================================================
  Execution time = 2.5016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8048e-01
  Total weights = 1.9637e+06
  Execution time = 3.5060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467587987711
                                         uncertainty =       0.002277628581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467587987711
                                         uncertainty =       0.002277628581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483534928
  error estimate for blocks of size 2^( 2) =       0.000505082810
  error estimate for blocks of size 2^( 3) =       0.000525662862
  error estimate for blocks of size 2^( 4) =       0.000541118434
  error estimate for blocks of size 2^( 5) =       0.000551486534
  error estimate for blocks of size 2^( 6) =       0.000555635703
  error estimate for blocks of size 2^( 7) =       0.000554766857

      target function =                  N/A
              le_mean =     -22.819792909205
             les_mean =     521.223492464945
             stat err =       0.000550751882
             autocorr =       1.297347376175
              std dev =       0.683821653747
             le_variance =       0.467612054134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467581003137
                                         uncertainty =       0.002276792646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467581003137
                                         uncertainty =       0.002276792646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483531370
  error estimate for blocks of size 2^( 2) =       0.000505079234
  error estimate for blocks of size 2^( 3) =       0.000525659371
  error estimate for blocks of size 2^( 4) =       0.000541114654
  error estimate for blocks of size 2^( 5) =       0.000551481836
  error estimate for blocks of size 2^( 6) =       0.000555634650
  error estimate for blocks of size 2^( 7) =       0.000554769893

      target function =                  N/A
              le_mean =     -22.819793152334
             les_mean =     521.224783314239
             stat err =       0.000550750258
             autocorr =       1.297358818843
              std dev =       0.683816621489
             le_variance =       0.467605171825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467583925189
                                         uncertainty =       0.002277188281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467583925189
                                         uncertainty =       0.002277188281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483532856
  error estimate for blocks of size 2^( 2) =       0.000505080769
  error estimate for blocks of size 2^( 3) =       0.000525660935
  error estimate for blocks of size 2^( 4) =       0.000541116448
  error estimate for blocks of size 2^( 5) =       0.000551484158
  error estimate for blocks of size 2^( 6) =       0.000555635426
  error estimate for blocks of size 2^( 7) =       0.000554768478

      target function =                  N/A
              le_mean =     -22.819793059420
             les_mean =     521.223413513486
             stat err =       0.000550751127
             autocorr =       1.297354943433
              std dev =       0.683818722169
             le_variance =       0.467608044789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467587428482
                                         uncertainty =       0.002277572374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467587428482
                                         uncertainty =       0.002277572374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483534643
  error estimate for blocks of size 2^( 2) =       0.000505082528
  error estimate for blocks of size 2^( 3) =       0.000525662595
  error estimate for blocks of size 2^( 4) =       0.000541118161
  error estimate for blocks of size 2^( 5) =       0.000551486218
  error estimate for blocks of size 2^( 6) =       0.000555635659
  error estimate for blocks of size 2^( 7) =       0.000554767063

      target function =                  N/A
              le_mean =     -22.819792921999
             les_mean =     521.223471049449
             stat err =       0.000550751775
             autocorr =       1.297348404409
              std dev =       0.683821249766
             le_variance =       0.467611501632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819792909205        initial
     3.8147e+00     3.8147e+01             1.2277e-04       -22.819793152334  <--
     1.5259e+01     1.5259e+02             3.1741e-05       -22.819793059420
     6.1035e+01     6.1035e+02             8.0036e-06       -22.819792921999

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 4.2594e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_01                 1.190924e-01 3 1  ON 0
ci_02                -2.586894e-02 3 1  ON 1
ci_03                -2.621757e-02 3 1  ON 2
ci_04                 2.512851e-02 3 1  ON 3
ci_05                -2.362739e-02 3 1  ON 4
ci_06                -2.264160e-02 3 1  ON 5
ci_07                 2.512483e-02 3 1  ON 6
ci_08                -4.082616e-03 3 1  ON 7
ci_09                -1.171519e-02 3 1  ON 8
ci_10                -1.150364e-02 3 1  ON 9
ci_11                 1.612955e-02 3 1  ON 10
ci_12                 1.059558e-02 3 1  ON 11
ci_13                 1.301245e-02 3 1  ON 12
ci_14                 1.617307e-02 3 1  ON 13
ci_15                 7.822362e-03 3 1  ON 14
ci_16                 8.113104e-03 3 1  ON 15
ci_17                -9.112498e-03 3 1  ON 16
ci_18                -9.333784e-03 3 1  ON 17
ci_19                 9.841112e-03 3 1  ON 18
ci_20                 1.074864e-02 3 1  ON 19
ci_21                 8.225505e-03 3 1  ON 20
ci_22                 7.855816e-03 3 1  ON 21
ci_23                 6.132754e-03 3 1  ON 22
ci_24                 7.802111e-03 3 1  ON 23
ci_25                 5.039261e-03 3 1  ON 24
ci_26                 2.385197e-03 3 1  ON 25
ci_27                 2.614392e-03 3 1  ON 26
ci_28                 4.233132e-03 3 1  ON 27
ci_29                 4.264885e-03 3 1  ON 28
ci_30                 2.289186e-04 3 1  ON 29
ci_31                 8.927323e-04 3 1  ON 30
ci_32                -3.832586e-04 3 1  ON 31
ci_33                 7.521207e-05 3 1  ON 32
ci_34                 7.683264e-04 3 1  ON 33
ci_35                 3.611035e-04 3 1  ON 34
ci_36                -1.033842e-03 3 1  ON 35
ci_37                -6.266790e-04 3 1  ON 36
ci_38                -7.850796e-05 3 1  ON 37
ci_39                -1.848950e-04 3 1  ON 38
ci_40                -1.412874e-03 3 1  ON 39
ci_41                 6.094537e-04 3 1  ON 40
ci_42                -1.790179e-04 3 1  ON 41
ci_43                -2.277177e-03 3 1  ON 42
ci_44                -2.516544e-03 3 1  ON 43
ci_45                -7.489170e-04 3 1  ON 44
ci_46                -1.795226e-04 3 1  ON 45
ci_47                -2.270684e-04 3 1  ON 46
ci_48                -3.808596e-04 3 1  ON 47
ci_49                -9.030558e-04 3 1  ON 48
ci_50                -4.566601e-04 3 1  ON 49
ci_51                 4.387643e-05 3 1  ON 50
ci_52                -6.646744e-05 3 1  ON 51
ci_53                -9.300681e-04 3 1  ON 52
ci_54                -9.550352e-04 3 1  ON 53
ci_55                -1.047801e-03 3 1  ON 54
ci_56                 1.279076e-03 3 1  ON 55
ci_57                 1.033650e-03 3 1  ON 56
ci_58                -7.659836e-04 3 1  ON 57
ci_59                -1.725271e-03 3 1  ON 58
ci_60                 2.475290e-03 3 1  ON 59
ci_61                 1.903590e-03 3 1  ON 60
ci_62                -2.189563e-04 3 1  ON 61
ci_63                -7.507752e-04 3 1  ON 62
ci_64                -6.213480e-04 3 1  ON 63
ci_65                -4.103942e-04 3 1  ON 64
ci_66                -4.179145e-04 3 1  ON 65
ci_67                -6.844747e-04 3 1  ON 66
ci_68                -1.289428e-03 3 1  ON 67
ci_69                -1.372709e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8684
    reference variance = 0.316369
====================================================
  Execution time = 2.5576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8419e-01
  Total weights = 1.963501418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469448422468
                                         uncertainty =       0.001987069708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469448422468
                                         uncertainty =       0.001987069708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484504576
  error estimate for blocks of size 2^( 2) =       0.000505857397
  error estimate for blocks of size 2^( 3) =       0.000526178880
  error estimate for blocks of size 2^( 4) =       0.000540860704
  error estimate for blocks of size 2^( 5) =       0.000550882197
  error estimate for blocks of size 2^( 6) =       0.000554715965
  error estimate for blocks of size 2^( 7) =       0.000554337979

      target function =                  N/A
              le_mean =     -22.819124784440
             les_mean =     521.196649118013
             stat err =       0.000550199211
             autocorr =       1.289567741765
              std dev =       0.685192942219
             le_variance =       0.469489368067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281912478444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819124784387       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819127885980       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819128250355       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819128237032       residual = 2.35e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.914470e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819124784387       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819125675054       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819125798307       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819125795211       residual = 3.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 7.841816e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819124784387       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819125015649       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819125049171       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819125048778       residual = 4.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 2.000156e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0146e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.190140e-01 3 1  ON 0
ci_02                -2.586692e-02 3 1  ON 1
ci_03                -2.620940e-02 3 1  ON 2
ci_04                 2.507929e-02 3 1  ON 3
ci_05                -2.358170e-02 3 1  ON 4
ci_06                -2.262150e-02 3 1  ON 5
ci_07                 2.520248e-02 3 1  ON 6
ci_08                -4.155499e-03 3 1  ON 7
ci_09                -1.175168e-02 3 1  ON 8
ci_10                -1.146058e-02 3 1  ON 9
ci_11                 1.612857e-02 3 1  ON 10
ci_12                 1.060047e-02 3 1  ON 11
ci_13                 1.298016e-02 3 1  ON 12
ci_14                 1.616561e-02 3 1  ON 13
ci_15                 7.835880e-03 3 1  ON 14
ci_16                 8.106901e-03 3 1  ON 15
ci_17                -9.082760e-03 3 1  ON 16
ci_18                -9.387856e-03 3 1  ON 17
ci_19                 9.812743e-03 3 1  ON 18
ci_20                 1.075685e-02 3 1  ON 19
ci_21                 8.267405e-03 3 1  ON 20
ci_22                 7.907970e-03 3 1  ON 21
ci_23                 6.085320e-03 3 1  ON 22
ci_24                 7.786558e-03 3 1  ON 23
ci_25                 5.027353e-03 3 1  ON 24
ci_26                 2.337152e-03 3 1  ON 25
ci_27                 2.638388e-03 3 1  ON 26
ci_28                 4.253094e-03 3 1  ON 27
ci_29                 4.238383e-03 3 1  ON 28
ci_30                 2.774818e-04 3 1  ON 29
ci_31                 9.196739e-04 3 1  ON 30
ci_32                -4.189191e-04 3 1  ON 31
ci_33                 8.351944e-05 3 1  ON 32
ci_34                 7.629484e-04 3 1  ON 33
ci_35                 3.281740e-04 3 1  ON 34
ci_36                -1.001415e-03 3 1  ON 35
ci_37                -6.626658e-04 3 1  ON 36
ci_38                -9.755376e-05 3 1  ON 37
ci_39                -1.936511e-04 3 1  ON 38
ci_40                -1.397263e-03 3 1  ON 39
ci_41                 5.845671e-04 3 1  ON 40
ci_42                -1.851410e-04 3 1  ON 41
ci_43                -2.291861e-03 3 1  ON 42
ci_44                -2.499461e-03 3 1  ON 43
ci_45                -7.528008e-04 3 1  ON 44
ci_46                -1.870984e-04 3 1  ON 45
ci_47                -2.377309e-04 3 1  ON 46
ci_48                -3.736193e-04 3 1  ON 47
ci_49                -9.007318e-04 3 1  ON 48
ci_50                -5.115679e-04 3 1  ON 49
ci_51                 3.208350e-05 3 1  ON 50
ci_52                -5.699645e-05 3 1  ON 51
ci_53                -9.467971e-04 3 1  ON 52
ci_54                -1.002766e-03 3 1  ON 53
ci_55                -1.023056e-03 3 1  ON 54
ci_56                 1.332839e-03 3 1  ON 55
ci_57                 9.971546e-04 3 1  ON 56
ci_58                -8.211525e-04 3 1  ON 57
ci_59                -1.696334e-03 3 1  ON 58
ci_60                 2.468166e-03 3 1  ON 59
ci_61                 1.930160e-03 3 1  ON 60
ci_62                -2.176790e-04 3 1  ON 61
ci_63                -7.204085e-04 3 1  ON 62
ci_64                -6.108487e-04 3 1  ON 63
ci_65                -4.506312e-04 3 1  ON 64
ci_66                -4.290388e-04 3 1  ON 65
ci_67                -6.385751e-04 3 1  ON 66
ci_68                -1.286654e-03 3 1  ON 67
ci_69                -1.365771e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8436
    reference variance = 0.547809
====================================================
  Execution time = 2.4778e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8965e-01
  Total weights = 1.9641e+06
  Execution time = 3.5060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472397339585
                                         uncertainty =       0.002564815337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472397339585
                                         uncertainty =       0.002564815337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485996235
  error estimate for blocks of size 2^( 2) =       0.000507280367
  error estimate for blocks of size 2^( 3) =       0.000527939347
  error estimate for blocks of size 2^( 4) =       0.000542951416
  error estimate for blocks of size 2^( 5) =       0.000553205576
  error estimate for blocks of size 2^( 6) =       0.000559116043
  error estimate for blocks of size 2^( 7) =       0.000561978262

      target function =                  N/A
              le_mean =     -22.819099786783
             les_mean =     521.201062858434
             stat err =       0.000554312824
             autocorr =       1.300900385513
              std dev =       0.687302466933
             le_variance =       0.472384681052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472390330151
                                         uncertainty =       0.002571218833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472390330151
                                         uncertainty =       0.002571218833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485992946
  error estimate for blocks of size 2^( 2) =       0.000507283846
  error estimate for blocks of size 2^( 3) =       0.000527946261
  error estimate for blocks of size 2^( 4) =       0.000542962964
  error estimate for blocks of size 2^( 5) =       0.000553221639
  error estimate for blocks of size 2^( 6) =       0.000559128447
  error estimate for blocks of size 2^( 7) =       0.000561989836

      target function =                  N/A
              le_mean =     -22.819101170278
             les_mean =     521.201182319391
             stat err =       0.000554325722
             autocorr =       1.300978535982
              std dev =       0.687297814819
             le_variance =       0.472378286255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472391337134
                                         uncertainty =       0.002568669195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472391337134
                                         uncertainty =       0.002568669195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485993326
  error estimate for blocks of size 2^( 2) =       0.000507281515
  error estimate for blocks of size 2^( 3) =       0.000527942413
  error estimate for blocks of size 2^( 4) =       0.000542957056
  error estimate for blocks of size 2^( 5) =       0.000553213869
  error estimate for blocks of size 2^( 6) =       0.000559122091
  error estimate for blocks of size 2^( 7) =       0.000561983888

      target function =                  N/A
              le_mean =     -22.819100194918
             les_mean =     521.201348846842
             stat err =       0.000554319226
             autocorr =       1.300946005676
              std dev =       0.687298353517
             le_variance =       0.472379026747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472396133164
                                         uncertainty =       0.002565317293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472396133164
                                         uncertainty =       0.002565317293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485995638
  error estimate for blocks of size 2^( 2) =       0.000507280330
  error estimate for blocks of size 2^( 3) =       0.000527939518
  error estimate for blocks of size 2^( 4) =       0.000542951809
  error estimate for blocks of size 2^( 5) =       0.000553206400
  error estimate for blocks of size 2^( 6) =       0.000559116545
  error estimate for blocks of size 2^( 7) =       0.000561978957

      target function =                  N/A
              le_mean =     -22.819099742221
             les_mean =     521.201451414414
             stat err =       0.000554313428
             autocorr =       1.300906418919
              std dev =       0.687301621833
             le_variance =       0.472383519374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819099786783        initial
     9.5367e-01     9.5367e+00             2.9145e-04       -22.819101170278  <--
     3.8147e+00     3.8147e+01             7.8418e-05       -22.819100194918
     1.5259e+01     1.5259e+02             2.0002e-05       -22.819099742221

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.2344e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_01                 1.188010e-01 3 1  ON 0
ci_02                -2.586713e-02 3 1  ON 1
ci_03                -2.619371e-02 3 1  ON 2
ci_04                 2.496287e-02 3 1  ON 3
ci_05                -2.346747e-02 3 1  ON 4
ci_06                -2.257358e-02 3 1  ON 5
ci_07                 2.540799e-02 3 1  ON 6
ci_08                -4.317782e-03 3 1  ON 7
ci_09                -1.184555e-02 3 1  ON 8
ci_10                -1.134930e-02 3 1  ON 9
ci_11                 1.612963e-02 3 1  ON 10
ci_12                 1.061392e-02 3 1  ON 11
ci_13                 1.290269e-02 3 1  ON 12
ci_14                 1.614483e-02 3 1  ON 13
ci_15                 7.867933e-03 3 1  ON 14
ci_16                 8.093642e-03 3 1  ON 15
ci_17                -9.005292e-03 3 1  ON 16
ci_18                -9.525948e-03 3 1  ON 17
ci_19                 9.745059e-03 3 1  ON 18
ci_20                 1.077892e-02 3 1  ON 19
ci_21                 8.376363e-03 3 1  ON 20
ci_22                 8.043545e-03 3 1  ON 21
ci_23                 5.974349e-03 3 1  ON 22
ci_24                 7.744582e-03 3 1  ON 23
ci_25                 4.999090e-03 3 1  ON 24
ci_26                 2.217292e-03 3 1  ON 25
ci_27                 2.697819e-03 3 1  ON 26
ci_28                 4.301644e-03 3 1  ON 27
ci_29                 4.170383e-03 3 1  ON 28
ci_30                 4.019166e-04 3 1  ON 29
ci_31                 9.855058e-04 3 1  ON 30
ci_32                -5.067466e-04 3 1  ON 31
ci_33                 1.030897e-04 3 1  ON 32
ci_34                 7.495292e-04 3 1  ON 33
ci_35                 2.439757e-04 3 1  ON 34
ci_36                -9.233254e-04 3 1  ON 35
ci_37                -7.474342e-04 3 1  ON 36
ci_38                -1.423380e-04 3 1  ON 37
ci_39                -2.136535e-04 3 1  ON 38
ci_40                -1.362654e-03 3 1  ON 39
ci_41                 5.252237e-04 3 1  ON 40
ci_42                -2.039795e-04 3 1  ON 41
ci_43                -2.329615e-03 3 1  ON 42
ci_44                -2.452270e-03 3 1  ON 43
ci_45                -7.594055e-04 3 1  ON 44
ci_46                -2.059497e-04 3 1  ON 45
ci_47                -2.656453e-04 3 1  ON 46
ci_48                -3.547717e-04 3 1  ON 47
ci_49                -8.940355e-04 3 1  ON 48
ci_50                -6.277384e-04 3 1  ON 49
ci_51                 4.135068e-06 3 1  ON 50
ci_52                -3.392752e-05 3 1  ON 51
ci_53                -9.832135e-04 3 1  ON 52
ci_54                -1.123355e-03 3 1  ON 53
ci_55                -9.588580e-04 3 1  ON 54
ci_56                 1.459091e-03 3 1  ON 55
ci_57                 9.110675e-04 3 1  ON 56
ci_58                -9.595464e-04 3 1  ON 57
ci_59                -1.623299e-03 3 1  ON 58
ci_60                 2.447481e-03 3 1  ON 59
ci_61                 2.003902e-03 3 1  ON 60
ci_62                -2.151035e-04 3 1  ON 61
ci_63                -6.526418e-04 3 1  ON 62
ci_64                -5.844716e-04 3 1  ON 63
ci_65                -5.494461e-04 3 1  ON 64
ci_66                -4.563099e-04 3 1  ON 65
ci_67                -5.285772e-04 3 1  ON 66
ci_68                -1.279792e-03 3 1  ON 67
ci_69                -1.348321e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2505e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8929
    reference variance = 0.362201
====================================================
  Execution time = 2.5655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8356e-01
  Total weights = 1.963579491e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469204450012
                                         uncertainty =       0.002159205095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469204450012
                                         uncertainty =       0.002159205095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484448718
  error estimate for blocks of size 2^( 2) =       0.000505720658
  error estimate for blocks of size 2^( 3) =       0.000526772077
  error estimate for blocks of size 2^( 4) =       0.000542213487
  error estimate for blocks of size 2^( 5) =       0.000551765973
  error estimate for blocks of size 2^( 6) =       0.000558705943
  error estimate for blocks of size 2^( 7) =       0.000558338273

      target function =                  N/A
              le_mean =     -22.819674043626
             les_mean =     521.221081881729
             stat err =       0.000552755919
             autocorr =       1.301880680771
              std dev =       0.685113946822
             le_variance =       0.469381120130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281967404363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819674043579       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819680409955       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819681505400       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819681997636       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 1.117465e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819674043579       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819676473556       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819676533611       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819676600348       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.349234e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819674043579       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819674743207       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819674723088       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819674732485       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 9.587128e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0221e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.186452e-01 3 1  ON 0
ci_02                -2.572073e-02 3 1  ON 1
ci_03                -2.612786e-02 3 1  ON 2
ci_04                 2.497638e-02 3 1  ON 3
ci_05                -2.338950e-02 3 1  ON 4
ci_06                -2.261597e-02 3 1  ON 5
ci_07                 2.532590e-02 3 1  ON 6
ci_08                -4.408662e-03 3 1  ON 7
ci_09                -1.175629e-02 3 1  ON 8
ci_10                -1.135554e-02 3 1  ON 9
ci_11                 1.593938e-02 3 1  ON 10
ci_12                 1.070065e-02 3 1  ON 11
ci_13                 1.287518e-02 3 1  ON 12
ci_14                 1.647975e-02 3 1  ON 13
ci_15                 7.771499e-03 3 1  ON 14
ci_16                 7.935001e-03 3 1  ON 15
ci_17                -9.108701e-03 3 1  ON 16
ci_18                -9.504939e-03 3 1  ON 17
ci_19                 9.616749e-03 3 1  ON 18
ci_20                 1.089942e-02 3 1  ON 19
ci_21                 8.405551e-03 3 1  ON 20
ci_22                 7.935988e-03 3 1  ON 21
ci_23                 6.150730e-03 3 1  ON 22
ci_24                 7.784699e-03 3 1  ON 23
ci_25                 5.122885e-03 3 1  ON 24
ci_26                 2.218767e-03 3 1  ON 25
ci_27                 2.644377e-03 3 1  ON 26
ci_28                 4.361333e-03 3 1  ON 27
ci_29                 4.230224e-03 3 1  ON 28
ci_30                 5.368486e-04 3 1  ON 29
ci_31                 8.415852e-04 3 1  ON 30
ci_32                -4.612821e-04 3 1  ON 31
ci_33                -8.956618e-05 3 1  ON 32
ci_34                 6.240163e-04 3 1  ON 33
ci_35                 1.302376e-04 3 1  ON 34
ci_36                -7.297283e-04 3 1  ON 35
ci_37                -9.084298e-04 3 1  ON 36
ci_38                -3.328445e-05 3 1  ON 37
ci_39                -2.229024e-04 3 1  ON 38
ci_40                -1.525350e-03 3 1  ON 39
ci_41                 6.546807e-04 3 1  ON 40
ci_42                -1.512185e-04 3 1  ON 41
ci_43                -2.395702e-03 3 1  ON 42
ci_44                -2.276264e-03 3 1  ON 43
ci_45                -7.998841e-04 3 1  ON 44
ci_46                -4.411667e-05 3 1  ON 45
ci_47                -2.751310e-04 3 1  ON 46
ci_48                -4.931859e-04 3 1  ON 47
ci_49                -1.212311e-03 3 1  ON 48
ci_50                -6.422116e-04 3 1  ON 49
ci_51                 1.102782e-04 3 1  ON 50
ci_52                -1.771824e-05 3 1  ON 51
ci_53                -1.041184e-03 3 1  ON 52
ci_54                -1.022335e-03 3 1  ON 53
ci_55                -9.154093e-04 3 1  ON 54
ci_56                 1.423682e-03 3 1  ON 55
ci_57                 1.100828e-03 3 1  ON 56
ci_58                -8.817308e-04 3 1  ON 57
ci_59                -1.610755e-03 3 1  ON 58
ci_60                 2.365230e-03 3 1  ON 59
ci_61                 2.067333e-03 3 1  ON 60
ci_62                -1.421450e-04 3 1  ON 61
ci_63                -5.731471e-04 3 1  ON 62
ci_64                -6.391468e-04 3 1  ON 63
ci_65                -7.408156e-04 3 1  ON 64
ci_66                -5.285832e-04 3 1  ON 65
ci_67                -6.357043e-04 3 1  ON 66
ci_68                -1.424771e-03 3 1  ON 67
ci_69                -1.162577e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7834
    reference variance = 0.433589
====================================================
  Execution time = 2.4942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8501e-01
  Total weights = 1.9639e+06
  Execution time = 3.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469280693189
                                         uncertainty =       0.002135298374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469280693189
                                         uncertainty =       0.002135298374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484398437
  error estimate for blocks of size 2^( 2) =       0.000505853021
  error estimate for blocks of size 2^( 3) =       0.000526095843
  error estimate for blocks of size 2^( 4) =       0.000541298868
  error estimate for blocks of size 2^( 5) =       0.000551979833
  error estimate for blocks of size 2^( 6) =       0.000557102243
  error estimate for blocks of size 2^( 7) =       0.000561426317

      target function =                  N/A
              le_mean =     -22.819173818474
             les_mean =     521.201901016876
             stat err =       0.000552951815
             autocorr =       1.303074090628
              std dev =       0.685042839664
             le_variance =       0.469283692175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469296391154
                                         uncertainty =       0.002126674929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469296391154
                                         uncertainty =       0.002126674929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484407607
  error estimate for blocks of size 2^( 2) =       0.000505862720
  error estimate for blocks of size 2^( 3) =       0.000526116196
  error estimate for blocks of size 2^( 4) =       0.000541321801
  error estimate for blocks of size 2^( 5) =       0.000552009209
  error estimate for blocks of size 2^( 6) =       0.000557164470
  error estimate for blocks of size 2^( 7) =       0.000561544572

      target function =                  N/A
              le_mean =     -22.819184804531
             les_mean =     521.213529564552
             stat err =       0.000553010013
             autocorr =       1.303299055561
              std dev =       0.685055807833
             le_variance =       0.469301459846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469292366203
                                         uncertainty =       0.002128479059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469292366203
                                         uncertainty =       0.002128479059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484405302
  error estimate for blocks of size 2^( 2) =       0.000505862136
  error estimate for blocks of size 2^( 3) =       0.000526110513
  error estimate for blocks of size 2^( 4) =       0.000541312605
  error estimate for blocks of size 2^( 5) =       0.000552003798
  error estimate for blocks of size 2^( 6) =       0.000557141433
  error estimate for blocks of size 2^( 7) =       0.000561491425

      target function =                  N/A
              le_mean =     -22.819179678119
             les_mean =     521.292891181194
             stat err =       0.000552987315
             autocorr =       1.303204476011
              std dev =       0.685052547325
             le_variance =       0.469296992597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469272991420
                                         uncertainty =       0.002134055888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469272991420
                                         uncertainty =       0.002134055888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484394590
  error estimate for blocks of size 2^( 2) =       0.000505849353
  error estimate for blocks of size 2^( 3) =       0.000526093613
  error estimate for blocks of size 2^( 4) =       0.000541297404
  error estimate for blocks of size 2^( 5) =       0.000551978943
  error estimate for blocks of size 2^( 6) =       0.000557103760
  error estimate for blocks of size 2^( 7) =       0.000561431460

      target function =                  N/A
              le_mean =     -22.819174172126
             les_mean =     521.204017692337
             stat err =       0.000552952892
             autocorr =       1.303099864299
              std dev =       0.685037398418
             le_variance =       0.469276237232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819173818474        initial
     2.3842e-01     2.3842e+00             1.1175e-03       -22.819184804531  <--
     9.5367e-01     9.5367e+00             3.3492e-04       -22.819179678119
     3.8147e+00     3.8147e+01             9.5871e-05       -22.819174172126

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.2539e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_01                 1.183171e-01 3 1  ON 0
ci_02                -2.545950e-02 3 1  ON 1
ci_03                -2.603542e-02 3 1  ON 2
ci_04                 2.500599e-02 3 1  ON 3
ci_05                -2.328619e-02 3 1  ON 4
ci_06                -2.268954e-02 3 1  ON 5
ci_07                 2.518369e-02 3 1  ON 6
ci_08                -4.513976e-03 3 1  ON 7
ci_09                -1.159607e-02 3 1  ON 8
ci_10                -1.138118e-02 3 1  ON 9
ci_11                 1.558925e-02 3 1  ON 10
ci_12                 1.084978e-02 3 1  ON 11
ci_13                 1.282304e-02 3 1  ON 12
ci_14                 1.726230e-02 3 1  ON 13
ci_15                 7.600419e-03 3 1  ON 14
ci_16                 7.649897e-03 3 1  ON 15
ci_17                -9.292133e-03 3 1  ON 16
ci_18                -9.481481e-03 3 1  ON 17
ci_19                 9.418755e-03 3 1  ON 18
ci_20                 1.112293e-02 3 1  ON 19
ci_21                 8.454372e-03 3 1  ON 20
ci_22                 7.723886e-03 3 1  ON 21
ci_23                 6.405723e-03 3 1  ON 22
ci_24                 7.871483e-03 3 1  ON 23
ci_25                 5.313915e-03 3 1  ON 24
ci_26                 2.243266e-03 3 1  ON 25
ci_27                 2.565785e-03 3 1  ON 26
ci_28                 4.461147e-03 3 1  ON 27
ci_29                 4.317524e-03 3 1  ON 28
ci_30                 7.768889e-04 3 1  ON 29
ci_31                 5.396046e-04 3 1  ON 30
ci_32                -3.978747e-04 3 1  ON 31
ci_33                -3.792610e-04 3 1  ON 32
ci_34                 4.073489e-04 3 1  ON 33
ci_35                -6.022319e-05 3 1  ON 34
ci_36                -4.786225e-04 3 1  ON 35
ci_37                -1.128294e-03 3 1  ON 36
ci_38                 1.066757e-04 3 1  ON 37
ci_39                -2.292044e-04 3 1  ON 38
ci_40                -1.710627e-03 3 1  ON 39
ci_41                 8.541916e-04 3 1  ON 40
ci_42                -3.412909e-05 3 1  ON 41
ci_43                -2.502479e-03 3 1  ON 42
ci_44                -1.961896e-03 3 1  ON 43
ci_45                -8.496002e-04 3 1  ON 44
ci_46                 1.766744e-04 3 1  ON 45
ci_47                -3.007778e-04 3 1  ON 46
ci_48                -7.471918e-04 3 1  ON 47
ci_49                -1.653112e-03 3 1  ON 48
ci_50                -6.608405e-04 3 1  ON 49
ci_51                 2.528973e-04 3 1  ON 50
ci_52                 7.639537e-06 3 1  ON 51
ci_53                -1.111060e-03 3 1  ON 52
ci_54                -8.790175e-04 3 1  ON 53
ci_55                -8.630534e-04 3 1  ON 54
ci_56                 1.369312e-03 3 1  ON 55
ci_57                 1.374357e-03 3 1  ON 56
ci_58                -7.438158e-04 3 1  ON 57
ci_59                -1.585927e-03 3 1  ON 58
ci_60                 2.186404e-03 3 1  ON 59
ci_61                 2.238303e-03 3 1  ON 60
ci_62                -4.051834e-05 3 1  ON 61
ci_63                -4.700162e-04 3 1  ON 62
ci_64                -7.161765e-04 3 1  ON 63
ci_65                -1.031079e-03 3 1  ON 64
ci_66                -6.443571e-04 3 1  ON 65
ci_67                -7.721403e-04 3 1  ON 66
ci_68                -1.663489e-03 3 1  ON 67
ci_69                -8.513544e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2775e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8427
    reference variance = 0.457807
====================================================
  Execution time = 2.5347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8803e-01
  Total weights = 1.963283009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.0270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467963690164
                                         uncertainty =       0.002808119796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467963690164
                                         uncertainty =       0.002808119796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483699797
  error estimate for blocks of size 2^( 2) =       0.000505278830
  error estimate for blocks of size 2^( 3) =       0.000525727974
  error estimate for blocks of size 2^( 4) =       0.000541762491
  error estimate for blocks of size 2^( 5) =       0.000551997012
  error estimate for blocks of size 2^( 6) =       0.000555965214
  error estimate for blocks of size 2^( 7) =       0.000561154096

      target function =                  N/A
              le_mean =     -22.818925111231
             les_mean =     521.191377810545
             stat err =       0.000552719703
             autocorr =       1.305744132544
              std dev =       0.684054813118
             le_variance =       0.467930987350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281892511123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818925111143       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818938464227       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818936755152       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818936535966       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818936924408       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.757536e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818925111143       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818933184563       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818932461540       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818932452368       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 9.631257e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818925111143       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818928238485       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818928121619       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818928115402       residual = 3.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.425152e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0394e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.180898e-01 3 1  ON 0
ci_02                -2.587913e-02 3 1  ON 1
ci_03                -2.620836e-02 3 1  ON 2
ci_04                 2.481869e-02 3 1  ON 3
ci_05                -2.306307e-02 3 1  ON 4
ci_06                -2.295645e-02 3 1  ON 5
ci_07                 2.422057e-02 3 1  ON 6
ci_08                -4.275997e-03 3 1  ON 7
ci_09                -1.117101e-02 3 1  ON 8
ci_10                -1.138638e-02 3 1  ON 9
ci_11                 1.559617e-02 3 1  ON 10
ci_12                 1.130008e-02 3 1  ON 11
ci_13                 1.245991e-02 3 1  ON 12
ci_14                 1.703537e-02 3 1  ON 13
ci_15                 7.876561e-03 3 1  ON 14
ci_16                 7.970220e-03 3 1  ON 15
ci_17                -9.708256e-03 3 1  ON 16
ci_18                -9.039240e-03 3 1  ON 17
ci_19                 1.008341e-02 3 1  ON 18
ci_20                 1.074939e-02 3 1  ON 19
ci_21                 8.125207e-03 3 1  ON 20
ci_22                 7.818209e-03 3 1  ON 21
ci_23                 5.933148e-03 3 1  ON 22
ci_24                 7.697458e-03 3 1  ON 23
ci_25                 4.988430e-03 3 1  ON 24
ci_26                 2.316307e-03 3 1  ON 25
ci_27                 2.315368e-03 3 1  ON 26
ci_28                 4.219221e-03 3 1  ON 27
ci_29                 3.903740e-03 3 1  ON 28
ci_30                 4.431061e-04 3 1  ON 29
ci_31                -3.141077e-05 3 1  ON 30
ci_32                -3.757160e-04 3 1  ON 31
ci_33                 2.370948e-06 3 1  ON 32
ci_34                 4.832865e-04 3 1  ON 33
ci_35                 6.374316e-04 3 1  ON 34
ci_36                -6.036472e-04 3 1  ON 35
ci_37                -4.695331e-04 3 1  ON 36
ci_38                 1.295861e-04 3 1  ON 37
ci_39                -3.865575e-04 3 1  ON 38
ci_40                -1.796827e-03 3 1  ON 39
ci_41                 8.854454e-04 3 1  ON 40
ci_42                 1.993838e-04 3 1  ON 41
ci_43                -2.504325e-03 3 1  ON 42
ci_44                -2.229744e-03 3 1  ON 43
ci_45                -5.783930e-04 3 1  ON 44
ci_46                -1.789001e-04 3 1  ON 45
ci_47                -4.416083e-04 3 1  ON 46
ci_48                -5.226420e-04 3 1  ON 47
ci_49                -1.325492e-03 3 1  ON 48
ci_50                -3.599062e-04 3 1  ON 49
ci_51                -8.559878e-05 3 1  ON 50
ci_52                -1.238803e-04 3 1  ON 51
ci_53                -1.389781e-03 3 1  ON 52
ci_54                -7.586427e-04 3 1  ON 53
ci_55                -5.637836e-04 3 1  ON 54
ci_56                 1.247781e-03 3 1  ON 55
ci_57                 9.117400e-04 3 1  ON 56
ci_58                -1.063141e-03 3 1  ON 57
ci_59                -1.448649e-03 3 1  ON 58
ci_60                 2.617581e-03 3 1  ON 59
ci_61                 1.771032e-03 3 1  ON 60
ci_62                 1.363302e-04 3 1  ON 61
ci_63                 7.119258e-05 3 1  ON 62
ci_64                -6.409318e-04 3 1  ON 63
ci_65                -6.834210e-04 3 1  ON 64
ci_66                -3.496103e-04 3 1  ON 65
ci_67                -7.857276e-04 3 1  ON 66
ci_68                -1.461118e-03 3 1  ON 67
ci_69                -1.029015e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.798
    reference variance = 0.281258
====================================================
  Execution time = 2.4993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8886e-01
  Total weights = 1.9638e+06
  Execution time = 3.5290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0477145
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472694985662
                                         uncertainty =       0.002585269951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472694985662
                                         uncertainty =       0.002585269951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486154823
  error estimate for blocks of size 2^( 2) =       0.000507684820
  error estimate for blocks of size 2^( 3) =       0.000527925774
  error estimate for blocks of size 2^( 4) =       0.000543427747
  error estimate for blocks of size 2^( 5) =       0.000553923329
  error estimate for blocks of size 2^( 6) =       0.000559282468
  error estimate for blocks of size 2^( 7) =       0.000560815743

      target function =                  N/A
              le_mean =     -22.818570961237
             les_mean =     521.193050511256
             stat err =       0.000554362322
             autocorr =       1.300283983235
              std dev =       0.687526743842
             le_variance =       0.472693023498

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.183078
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473286977173
                                         uncertainty =       0.002743198543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473286977173
                                         uncertainty =       0.002743198543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486459536
  error estimate for blocks of size 2^( 2) =       0.000507992261
  error estimate for blocks of size 2^( 3) =       0.000528214026
  error estimate for blocks of size 2^( 4) =       0.000543718053
  error estimate for blocks of size 2^( 5) =       0.000554197388
  error estimate for blocks of size 2^( 6) =       0.000559605315
  error estimate for blocks of size 2^( 7) =       0.000561084212

      target function =                  N/A
              le_mean =     -22.818586275008
             les_mean =     521.188735970187
             stat err =       0.000554651242
             autocorr =       1.300009537385
              std dev =       0.687957672677
             le_variance =       0.473285759396

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0463917
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473357809554
                                         uncertainty =       0.002743342122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473357809554
                                         uncertainty =       0.002743342122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486495806
  error estimate for blocks of size 2^( 2) =       0.000508031736
  error estimate for blocks of size 2^( 3) =       0.000528249615
  error estimate for blocks of size 2^( 4) =       0.000543751468
  error estimate for blocks of size 2^( 5) =       0.000554232065
  error estimate for blocks of size 2^( 6) =       0.000559651245
  error estimate for blocks of size 2^( 7) =       0.000561143805

      target function =                  N/A
              le_mean =     -22.818587129932
             les_mean =     521.188357184627
             stat err =       0.000554694646
             autocorr =       1.300019136851
              std dev =       0.688008967452
             le_variance =       0.473356339295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472707012993
                                         uncertainty =       0.002594376820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472707012993
                                         uncertainty =       0.002594376820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486161050
  error estimate for blocks of size 2^( 2) =       0.000507695297
  error estimate for blocks of size 2^( 3) =       0.000527932906
  error estimate for blocks of size 2^( 4) =       0.000543452838
  error estimate for blocks of size 2^( 5) =       0.000553945583
  error estimate for blocks of size 2^( 6) =       0.000559339543
  error estimate for blocks of size 2^( 7) =       0.000560826910

      target function =                  N/A
              le_mean =     -22.818562768904
             les_mean =     521.263643164237
             stat err =       0.000554391219
             autocorr =       1.300386231649
              std dev =       0.687535550363
             le_variance =       0.472705133014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818570961237        initial
     5.9605e-02     5.9605e-01             1.7575e-03       -22.818586275008
     2.3842e-01     2.3842e+00             9.6313e-04       -22.818587129932  <--
     9.5367e-01     9.5367e+00             3.4252e-04       -22.818562768904

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.2769e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_01                 1.180898e-01 3 1  ON 0
ci_02                -2.587913e-02 3 1  ON 1
ci_03                -2.620836e-02 3 1  ON 2
ci_04                 2.481869e-02 3 1  ON 3
ci_05                -2.306307e-02 3 1  ON 4
ci_06                -2.295645e-02 3 1  ON 5
ci_07                 2.422057e-02 3 1  ON 6
ci_08                -4.275997e-03 3 1  ON 7
ci_09                -1.117101e-02 3 1  ON 8
ci_10                -1.138638e-02 3 1  ON 9
ci_11                 1.559617e-02 3 1  ON 10
ci_12                 1.130008e-02 3 1  ON 11
ci_13                 1.245991e-02 3 1  ON 12
ci_14                 1.703537e-02 3 1  ON 13
ci_15                 7.876561e-03 3 1  ON 14
ci_16                 7.970220e-03 3 1  ON 15
ci_17                -9.708256e-03 3 1  ON 16
ci_18                -9.039240e-03 3 1  ON 17
ci_19                 1.008341e-02 3 1  ON 18
ci_20                 1.074939e-02 3 1  ON 19
ci_21                 8.125207e-03 3 1  ON 20
ci_22                 7.818209e-03 3 1  ON 21
ci_23                 5.933148e-03 3 1  ON 22
ci_24                 7.697458e-03 3 1  ON 23
ci_25                 4.988430e-03 3 1  ON 24
ci_26                 2.316307e-03 3 1  ON 25
ci_27                 2.315368e-03 3 1  ON 26
ci_28                 4.219221e-03 3 1  ON 27
ci_29                 3.903740e-03 3 1  ON 28
ci_30                 4.431061e-04 3 1  ON 29
ci_31                -3.141077e-05 3 1  ON 30
ci_32                -3.757160e-04 3 1  ON 31
ci_33                 2.370948e-06 3 1  ON 32
ci_34                 4.832865e-04 3 1  ON 33
ci_35                 6.374316e-04 3 1  ON 34
ci_36                -6.036472e-04 3 1  ON 35
ci_37                -4.695331e-04 3 1  ON 36
ci_38                 1.295861e-04 3 1  ON 37
ci_39                -3.865575e-04 3 1  ON 38
ci_40                -1.796827e-03 3 1  ON 39
ci_41                 8.854454e-04 3 1  ON 40
ci_42                 1.993838e-04 3 1  ON 41
ci_43                -2.504325e-03 3 1  ON 42
ci_44                -2.229744e-03 3 1  ON 43
ci_45                -5.783930e-04 3 1  ON 44
ci_46                -1.789001e-04 3 1  ON 45
ci_47                -4.416083e-04 3 1  ON 46
ci_48                -5.226420e-04 3 1  ON 47
ci_49                -1.325492e-03 3 1  ON 48
ci_50                -3.599062e-04 3 1  ON 49
ci_51                -8.559878e-05 3 1  ON 50
ci_52                -1.238803e-04 3 1  ON 51
ci_53                -1.389781e-03 3 1  ON 52
ci_54                -7.586427e-04 3 1  ON 53
ci_55                -5.637836e-04 3 1  ON 54
ci_56                 1.247781e-03 3 1  ON 55
ci_57                 9.117400e-04 3 1  ON 56
ci_58                -1.063141e-03 3 1  ON 57
ci_59                -1.448649e-03 3 1  ON 58
ci_60                 2.617581e-03 3 1  ON 59
ci_61                 1.771032e-03 3 1  ON 60
ci_62                 1.363302e-04 3 1  ON 61
ci_63                 7.119258e-05 3 1  ON 62
ci_64                -6.409318e-04 3 1  ON 63
ci_65                -6.834210e-04 3 1  ON 64
ci_66                -3.496103e-04 3 1  ON 65
ci_67                -7.857276e-04 3 1  ON 66
ci_68                -1.461118e-03 3 1  ON 67
ci_69                -1.029015e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.9599
    reference variance = 1.05266
====================================================
  Execution time = 2.5418e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8028e-01
  Total weights = 1.963660124e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466526170107
                                         uncertainty =       0.002274898058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466526170107
                                         uncertainty =       0.002274898058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482942120
  error estimate for blocks of size 2^( 2) =       0.000504639875
  error estimate for blocks of size 2^( 3) =       0.000525637469
  error estimate for blocks of size 2^( 4) =       0.000541281875
  error estimate for blocks of size 2^( 5) =       0.000550625980
  error estimate for blocks of size 2^( 6) =       0.000555030794
  error estimate for blocks of size 2^( 7) =       0.000557546386

      target function =                  N/A
              le_mean =     -22.818970619953
             les_mean =     521.185701620544
             stat err =       0.000551121259
             autocorr =       1.302279364781
              std dev =       0.682983296156
             le_variance =       0.466466182829


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281897061995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818970619870       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818979405523       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818988557283       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818991019011       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818992670247       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818992443354       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818992348469       residual = 7.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 2.985979e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818970619870       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818976056416       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818980945605       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818981519931       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818981706025       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 1.471836e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818970619870       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818972773120       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818974519903       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818974561350       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818974529837       residual = 8.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 5.492172e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9969e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.170690e-01 3 1  ON 0
ci_02                -2.538109e-02 3 1  ON 1
ci_03                -2.672206e-02 3 1  ON 2
ci_04                 2.511549e-02 3 1  ON 3
ci_05                -2.333025e-02 3 1  ON 4
ci_06                -2.268265e-02 3 1  ON 5
ci_07                 2.445022e-02 3 1  ON 6
ci_08                -4.955053e-03 3 1  ON 7
ci_09                -1.096526e-02 3 1  ON 8
ci_10                -1.116054e-02 3 1  ON 9
ci_11                 1.585487e-02 3 1  ON 10
ci_12                 1.148437e-02 3 1  ON 11
ci_13                 1.327809e-02 3 1  ON 12
ci_14                 1.664350e-02 3 1  ON 13
ci_15                 8.137869e-03 3 1  ON 14
ci_16                 8.073521e-03 3 1  ON 15
ci_17                -1.007449e-02 3 1  ON 16
ci_18                -9.047741e-03 3 1  ON 17
ci_19                 9.936524e-03 3 1  ON 18
ci_20                 1.118766e-02 3 1  ON 19
ci_21                 9.215327e-03 3 1  ON 20
ci_22                 8.077116e-03 3 1  ON 21
ci_23                 5.975766e-03 3 1  ON 22
ci_24                 7.483870e-03 3 1  ON 23
ci_25                 4.563431e-03 3 1  ON 24
ci_26                 2.887245e-03 3 1  ON 25
ci_27                 3.452221e-03 3 1  ON 26
ci_28                 3.908313e-03 3 1  ON 27
ci_29                 3.149755e-03 3 1  ON 28
ci_30                 4.438387e-04 3 1  ON 29
ci_31                -6.164944e-04 3 1  ON 30
ci_32                -4.322773e-04 3 1  ON 31
ci_33                 2.481013e-04 3 1  ON 32
ci_34                 8.686605e-04 3 1  ON 33
ci_35                 1.634226e-04 3 1  ON 34
ci_36                -4.407450e-04 3 1  ON 35
ci_37                -1.311505e-03 3 1  ON 36
ci_38                -5.021681e-05 3 1  ON 37
ci_39                -4.968184e-04 3 1  ON 38
ci_40                -1.598511e-03 3 1  ON 39
ci_41                 6.961868e-04 3 1  ON 40
ci_42                 2.465402e-04 3 1  ON 41
ci_43                -2.118533e-03 3 1  ON 42
ci_44                -1.185873e-03 3 1  ON 43
ci_45                -3.420694e-04 3 1  ON 44
ci_46                -7.662597e-04 3 1  ON 45
ci_47                -1.913445e-03 3 1  ON 46
ci_48                -1.087767e-03 3 1  ON 47
ci_49                -1.698819e-03 3 1  ON 48
ci_50                -8.282834e-04 3 1  ON 49
ci_51                -3.444405e-05 3 1  ON 50
ci_52                 3.454008e-04 3 1  ON 51
ci_53                -1.549210e-03 3 1  ON 52
ci_54                -1.285713e-03 3 1  ON 53
ci_55                -1.327871e-03 3 1  ON 54
ci_56                 1.760890e-03 3 1  ON 55
ci_57                 1.395245e-03 3 1  ON 56
ci_58                -1.125033e-03 3 1  ON 57
ci_59                 9.323693e-06 3 1  ON 58
ci_60                 3.479551e-03 3 1  ON 59
ci_61                 5.650450e-04 3 1  ON 60
ci_62                -2.666083e-04 3 1  ON 61
ci_63                -7.542368e-04 3 1  ON 62
ci_64                -2.693058e-04 3 1  ON 63
ci_65                -5.823307e-04 3 1  ON 64
ci_66                -9.536109e-05 3 1  ON 65
ci_67                -5.475285e-04 3 1  ON 66
ci_68                -1.961112e-03 3 1  ON 67
ci_69                -1.048131e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7929
    reference variance = 0.39501
====================================================
  Execution time = 2.4811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8181e-01
  Total weights = 1.9641e+06
  Execution time = 3.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468307134438
                                         uncertainty =       0.002055792858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468307134438
                                         uncertainty =       0.002055792858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483932782
  error estimate for blocks of size 2^( 2) =       0.000505480652
  error estimate for blocks of size 2^( 3) =       0.000526295685
  error estimate for blocks of size 2^( 4) =       0.000541979588
  error estimate for blocks of size 2^( 5) =       0.000552501361
  error estimate for blocks of size 2^( 6) =       0.000558031359
  error estimate for blocks of size 2^( 7) =       0.000559936467

      target function =                  N/A
              le_mean =     -22.819887052188
             les_mean =     521.231931650664
             stat err =       0.000553112194
             autocorr =       1.306340467963
              std dev =       0.684384303671
             le_variance =       0.468381875111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468545185192
                                         uncertainty =       0.002038973357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468545185192
                                         uncertainty =       0.002038973357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484055890
  error estimate for blocks of size 2^( 2) =       0.000505585861
  error estimate for blocks of size 2^( 3) =       0.000526387909
  error estimate for blocks of size 2^( 4) =       0.000542058007
  error estimate for blocks of size 2^( 5) =       0.000552547345
  error estimate for blocks of size 2^( 6) =       0.000558129553
  error estimate for blocks of size 2^( 7) =       0.000560024127

      target function =                  N/A
              le_mean =     -22.819886322816
             les_mean =     521.236924184908
             stat err =       0.000553189758
             autocorr =       1.306042299899
              std dev =       0.684558404748
             le_variance =       0.468620209511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468813385841
                                         uncertainty =       0.002046711483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468813385841
                                         uncertainty =       0.002046711483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484194096
  error estimate for blocks of size 2^( 2) =       0.000505708894
  error estimate for blocks of size 2^( 3) =       0.000526500590
  error estimate for blocks of size 2^( 4) =       0.000542161614
  error estimate for blocks of size 2^( 5) =       0.000552628949
  error estimate for blocks of size 2^( 6) =       0.000558221414
  error estimate for blocks of size 2^( 7) =       0.000560127498

      target function =                  N/A
              le_mean =     -22.819897646389
             les_mean =     521.251501031176
             stat err =       0.000553284869
             autocorr =       1.305745708844
              std dev =       0.684753857471
             le_variance =       0.468887845322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468231057989
                                         uncertainty =       0.002047999134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468231057989
                                         uncertainty =       0.002047999134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483893448
  error estimate for blocks of size 2^( 2) =       0.000505435012
  error estimate for blocks of size 2^( 3) =       0.000526246397
  error estimate for blocks of size 2^( 4) =       0.000541934073
  error estimate for blocks of size 2^( 5) =       0.000552450054
  error estimate for blocks of size 2^( 6) =       0.000557995568
  error estimate for blocks of size 2^( 7) =       0.000559897220

      target function =                  N/A
              le_mean =     -22.819866924417
             les_mean =     521.230247705379
             stat err =       0.000553069229
             autocorr =       1.306349879223
              std dev =       0.684328676286
             le_variance =       0.468305737188


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819887052188        initial
     5.9605e-02     5.9605e-01             2.9860e-03       -22.819886322816
     2.3842e-01     2.3842e+00             1.4718e-03       -22.819897646389  <--
     9.5367e-01     9.5367e+00             5.4922e-04       -22.819866924417

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 4.2388e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_01                 1.170690e-01 3 1  ON 0
ci_02                -2.538109e-02 3 1  ON 1
ci_03                -2.672206e-02 3 1  ON 2
ci_04                 2.511549e-02 3 1  ON 3
ci_05                -2.333025e-02 3 1  ON 4
ci_06                -2.268265e-02 3 1  ON 5
ci_07                 2.445022e-02 3 1  ON 6
ci_08                -4.955053e-03 3 1  ON 7
ci_09                -1.096526e-02 3 1  ON 8
ci_10                -1.116054e-02 3 1  ON 9
ci_11                 1.585487e-02 3 1  ON 10
ci_12                 1.148437e-02 3 1  ON 11
ci_13                 1.327809e-02 3 1  ON 12
ci_14                 1.664350e-02 3 1  ON 13
ci_15                 8.137869e-03 3 1  ON 14
ci_16                 8.073521e-03 3 1  ON 15
ci_17                -1.007449e-02 3 1  ON 16
ci_18                -9.047741e-03 3 1  ON 17
ci_19                 9.936524e-03 3 1  ON 18
ci_20                 1.118766e-02 3 1  ON 19
ci_21                 9.215327e-03 3 1  ON 20
ci_22                 8.077116e-03 3 1  ON 21
ci_23                 5.975766e-03 3 1  ON 22
ci_24                 7.483870e-03 3 1  ON 23
ci_25                 4.563431e-03 3 1  ON 24
ci_26                 2.887245e-03 3 1  ON 25
ci_27                 3.452221e-03 3 1  ON 26
ci_28                 3.908313e-03 3 1  ON 27
ci_29                 3.149755e-03 3 1  ON 28
ci_30                 4.438387e-04 3 1  ON 29
ci_31                -6.164944e-04 3 1  ON 30
ci_32                -4.322773e-04 3 1  ON 31
ci_33                 2.481013e-04 3 1  ON 32
ci_34                 8.686605e-04 3 1  ON 33
ci_35                 1.634226e-04 3 1  ON 34
ci_36                -4.407450e-04 3 1  ON 35
ci_37                -1.311505e-03 3 1  ON 36
ci_38                -5.021681e-05 3 1  ON 37
ci_39                -4.968184e-04 3 1  ON 38
ci_40                -1.598511e-03 3 1  ON 39
ci_41                 6.961868e-04 3 1  ON 40
ci_42                 2.465402e-04 3 1  ON 41
ci_43                -2.118533e-03 3 1  ON 42
ci_44                -1.185873e-03 3 1  ON 43
ci_45                -3.420694e-04 3 1  ON 44
ci_46                -7.662597e-04 3 1  ON 45
ci_47                -1.913445e-03 3 1  ON 46
ci_48                -1.087767e-03 3 1  ON 47
ci_49                -1.698819e-03 3 1  ON 48
ci_50                -8.282834e-04 3 1  ON 49
ci_51                -3.444405e-05 3 1  ON 50
ci_52                 3.454008e-04 3 1  ON 51
ci_53                -1.549210e-03 3 1  ON 52
ci_54                -1.285713e-03 3 1  ON 53
ci_55                -1.327871e-03 3 1  ON 54
ci_56                 1.760890e-03 3 1  ON 55
ci_57                 1.395245e-03 3 1  ON 56
ci_58                -1.125033e-03 3 1  ON 57
ci_59                 9.323693e-06 3 1  ON 58
ci_60                 3.479551e-03 3 1  ON 59
ci_61                 5.650450e-04 3 1  ON 60
ci_62                -2.666083e-04 3 1  ON 61
ci_63                -7.542368e-04 3 1  ON 62
ci_64                -2.693058e-04 3 1  ON 63
ci_65                -5.823307e-04 3 1  ON 64
ci_66                -9.536109e-05 3 1  ON 65
ci_67                -5.475285e-04 3 1  ON 66
ci_68                -1.961112e-03 3 1  ON 67
ci_69                -1.048131e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.9314
    reference variance = 0.460003
====================================================
  Execution time = 2.5305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9517e-01
  Total weights = 1.963718120e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473408091772
                                         uncertainty =       0.002551547113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473408091772
                                         uncertainty =       0.002551547113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486475171
  error estimate for blocks of size 2^( 2) =       0.000508084826
  error estimate for blocks of size 2^( 3) =       0.000528822958
  error estimate for blocks of size 2^( 4) =       0.000543698889
  error estimate for blocks of size 2^( 5) =       0.000552992812
  error estimate for blocks of size 2^( 6) =       0.000557352806
  error estimate for blocks of size 2^( 7) =       0.000560191839

      target function =                  N/A
              le_mean =     -22.820302559598
             les_mean =     521.261382721292
             stat err =       0.000553559086
             autocorr =       1.294811681343
              std dev =       0.687979784761
             le_variance =       0.473316184240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282030255960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820302559568       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820352937105       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820352949393       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820352869926       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.820352429226       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.820352412539       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 2.323026e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820302559568       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820331598072       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820331085304       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820331014304       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 1.219880e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.820302559568       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.820313337148       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.820313165910       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.820313192054       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 4.298225e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9844e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.164857e-01 3 1  ON 0
ci_02                -2.513916e-02 3 1  ON 1
ci_03                -2.601005e-02 3 1  ON 2
ci_04                 2.516977e-02 3 1  ON 3
ci_05                -2.300261e-02 3 1  ON 4
ci_06                -2.282898e-02 3 1  ON 5
ci_07                 2.560459e-02 3 1  ON 6
ci_08                -4.609345e-03 3 1  ON 7
ci_09                -1.090785e-02 3 1  ON 8
ci_10                -1.050094e-02 3 1  ON 9
ci_11                 1.586072e-02 3 1  ON 10
ci_12                 1.124548e-02 3 1  ON 11
ci_13                 1.221292e-02 3 1  ON 12
ci_14                 1.657413e-02 3 1  ON 13
ci_15                 8.213541e-03 3 1  ON 14
ci_16                 7.724897e-03 3 1  ON 15
ci_17                -1.047817e-02 3 1  ON 16
ci_18                -1.026762e-02 3 1  ON 17
ci_19                 9.247845e-03 3 1  ON 18
ci_20                 1.067128e-02 3 1  ON 19
ci_21                 9.015778e-03 3 1  ON 20
ci_22                 7.476128e-03 3 1  ON 21
ci_23                 6.040916e-03 3 1  ON 22
ci_24                 7.377334e-03 3 1  ON 23
ci_25                 4.814637e-03 3 1  ON 24
ci_26                 2.908085e-03 3 1  ON 25
ci_27                 2.857638e-03 3 1  ON 26
ci_28                 3.861192e-03 3 1  ON 27
ci_29                 3.156710e-03 3 1  ON 28
ci_30                 3.496662e-04 3 1  ON 29
ci_31                -7.458609e-04 3 1  ON 30
ci_32                -9.999392e-05 3 1  ON 31
ci_33                -4.367005e-04 3 1  ON 32
ci_34                 7.535466e-04 3 1  ON 33
ci_35                 8.678704e-04 3 1  ON 34
ci_36                -6.570067e-04 3 1  ON 35
ci_37                -1.200143e-03 3 1  ON 36
ci_38                 6.642397e-04 3 1  ON 37
ci_39                -6.529664e-04 3 1  ON 38
ci_40                -1.532321e-03 3 1  ON 39
ci_41                 1.466905e-04 3 1  ON 40
ci_42                 5.208439e-04 3 1  ON 41
ci_43                -1.943741e-03 3 1  ON 42
ci_44                -4.692546e-04 3 1  ON 43
ci_45                 1.609561e-04 3 1  ON 44
ci_46                -5.404615e-04 3 1  ON 45
ci_47                -1.456885e-03 3 1  ON 46
ci_48                -8.623640e-04 3 1  ON 47
ci_49                -1.672086e-03 3 1  ON 48
ci_50                -5.534356e-04 3 1  ON 49
ci_51                -2.736044e-04 3 1  ON 50
ci_52                -1.708605e-05 3 1  ON 51
ci_53                -1.843178e-03 3 1  ON 52
ci_54                -1.132758e-03 3 1  ON 53
ci_55                -1.335177e-03 3 1  ON 54
ci_56                 1.507746e-03 3 1  ON 55
ci_57                 1.374673e-03 3 1  ON 56
ci_58                -6.018377e-04 3 1  ON 57
ci_59                -1.147181e-03 3 1  ON 58
ci_60                 2.758533e-03 3 1  ON 59
ci_61                -1.198423e-04 3 1  ON 60
ci_62                -3.103330e-04 3 1  ON 61
ci_63                -2.227231e-04 3 1  ON 62
ci_64                 1.638959e-05 3 1  ON 63
ci_65                -6.677387e-04 3 1  ON 64
ci_66                -3.158815e-04 3 1  ON 65
ci_67                -6.345162e-05 3 1  ON 66
ci_68                -1.361244e-03 3 1  ON 67
ci_69                -1.529753e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8823
    reference variance = 0.840722
====================================================
  Execution time = 2.4766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9182e-01
  Total weights = 1.9636e+06
  Execution time = 3.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0782775
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476598835128
                                         uncertainty =       0.005116530503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476598835128
                                         uncertainty =       0.005116530503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488091936
  error estimate for blocks of size 2^( 2) =       0.000509585261
  error estimate for blocks of size 2^( 3) =       0.000530152568
  error estimate for blocks of size 2^( 4) =       0.000545712305
  error estimate for blocks of size 2^( 5) =       0.000555835650
  error estimate for blocks of size 2^( 6) =       0.000563569638
  error estimate for blocks of size 2^( 7) =       0.000566012144

      target function =                  N/A
              le_mean =     -22.818764091868
             les_mean =     521.190309547040
             stat err =       0.000557782434
             autocorr =       1.305949555364
              std dev =       0.690266235053
             le_variance =       0.476467475254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476586270785
                                         uncertainty =       0.005017233760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476586270785
                                         uncertainty =       0.005017233760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488085510
  error estimate for blocks of size 2^( 2) =       0.000509620633
  error estimate for blocks of size 2^( 3) =       0.000530237040
  error estimate for blocks of size 2^( 4) =       0.000545819725
  error estimate for blocks of size 2^( 5) =       0.000555953323
  error estimate for blocks of size 2^( 6) =       0.000563768342
  error estimate for blocks of size 2^( 7) =       0.000566203080

      target function =                  N/A
              le_mean =     -22.818767577790
             les_mean =     521.194488363736
             stat err =       0.000557936117
             autocorr =       1.306703704640
              std dev =       0.690257147646
             le_variance =       0.476454929876

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0807305
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482041734332
                                         uncertainty =       0.006896814861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.482041734332
                                         uncertainty =       0.006896814861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490868211
  error estimate for blocks of size 2^( 2) =       0.000512295520
  error estimate for blocks of size 2^( 3) =       0.000532939460
  error estimate for blocks of size 2^( 4) =       0.000548491180
  error estimate for blocks of size 2^( 5) =       0.000558535480
  error estimate for blocks of size 2^( 6) =       0.000566196002
  error estimate for blocks of size 2^( 7) =       0.000568500508

      target function =                  N/A
              le_mean =     -22.818735812025
             les_mean =     530.055542254626
             stat err =       0.000560430793
             autocorr =       1.303509385817
              std dev =       0.694192481779
             le_variance =       0.481903201759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476502231876
                                         uncertainty =       0.005100156385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476502231876
                                         uncertainty =       0.005100156385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488042516
  error estimate for blocks of size 2^( 2) =       0.000509543968
  error estimate for blocks of size 2^( 3) =       0.000530124000
  error estimate for blocks of size 2^( 4) =       0.000545690200
  error estimate for blocks of size 2^( 5) =       0.000555814147
  error estimate for blocks of size 2^( 6) =       0.000563579438
  error estimate for blocks of size 2^( 7) =       0.000566007495

      target function =                  N/A
              le_mean =     -22.818755831195
             les_mean =     521.267518507747
             stat err =       0.000557772820
             autocorr =       1.306169023119
              std dev =       0.690196345477
             le_variance =       0.476370995310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818764091868        initial
     5.9605e-02     5.9605e-01             2.3230e-03       -22.818767577790  <--
     2.3842e-01     2.3842e+00             1.2199e-03       -22.818735812025
     9.5367e-01     9.5367e+00             4.2982e-04       -22.818755831195

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 4.2315e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_01                 1.156921e-01 3 1  ON 0
ci_02                -2.490254e-02 3 1  ON 1
ci_03                -2.541985e-02 3 1  ON 2
ci_04                 2.520884e-02 3 1  ON 3
ci_05                -2.276877e-02 3 1  ON 4
ci_06                -2.303413e-02 3 1  ON 5
ci_07                 2.650652e-02 3 1  ON 6
ci_08                -4.425510e-03 3 1  ON 7
ci_09                -1.088606e-02 3 1  ON 8
ci_10                -9.919944e-03 3 1  ON 9
ci_11                 1.578490e-02 3 1  ON 10
ci_12                 1.107896e-02 3 1  ON 11
ci_13                 1.095506e-02 3 1  ON 12
ci_14                 1.627567e-02 3 1  ON 13
ci_15                 8.274250e-03 3 1  ON 14
ci_16                 7.461563e-03 3 1  ON 15
ci_17                -1.081666e-02 3 1  ON 16
ci_18                -1.129303e-02 3 1  ON 17
ci_19                 8.867930e-03 3 1  ON 18
ci_20                 1.029444e-02 3 1  ON 19
ci_21                 8.812787e-03 3 1  ON 20
ci_22                 6.857249e-03 3 1  ON 21
ci_23                 6.090725e-03 3 1  ON 22
ci_24                 7.197684e-03 3 1  ON 23
ci_25                 4.965360e-03 3 1  ON 24
ci_26                 2.991805e-03 3 1  ON 25
ci_27                 2.381808e-03 3 1  ON 26
ci_28                 3.775234e-03 3 1  ON 27
ci_29                 3.166039e-03 3 1  ON 28
ci_30                 1.256227e-04 3 1  ON 29
ci_31                -9.381886e-04 3 1  ON 30
ci_32                 1.206567e-04 3 1  ON 31
ci_33                -8.428183e-04 3 1  ON 32
ci_34                 7.309018e-04 3 1  ON 33
ci_35                 1.402180e-03 3 1  ON 34
ci_36                -8.354286e-04 3 1  ON 35
ci_37                -1.166867e-03 3 1  ON 36
ci_38                 1.082962e-03 3 1  ON 37
ci_39                -7.671310e-04 3 1  ON 38
ci_40                -1.507430e-03 3 1  ON 39
ci_41                -1.946177e-04 3 1  ON 40
ci_42                 7.052494e-04 3 1  ON 41
ci_43                -1.747701e-03 3 1  ON 42
ci_44                 6.929693e-05 3 1  ON 43
ci_45                 4.207421e-04 3 1  ON 44
ci_46                -4.285273e-04 3 1  ON 45
ci_47                -1.168245e-03 3 1  ON 46
ci_48                -7.996628e-04 3 1  ON 47
ci_49                -1.648481e-03 3 1  ON 48
ci_50                -4.517930e-04 3 1  ON 49
ci_51                -4.279353e-04 3 1  ON 50
ci_52                -2.351803e-04 3 1  ON 51
ci_53                -1.978529e-03 3 1  ON 52
ci_54                -1.034312e-03 3 1  ON 53
ci_55                -1.347054e-03 3 1  ON 54
ci_56                 1.352788e-03 3 1  ON 55
ci_57                 1.403448e-03 3 1  ON 56
ci_58                -2.090251e-04 3 1  ON 57
ci_59                -1.987721e-03 3 1  ON 58
ci_60                 1.702862e-03 3 1  ON 59
ci_61                -1.045752e-03 3 1  ON 60
ci_62                -3.270657e-04 3 1  ON 61
ci_63                 5.020324e-05 3 1  ON 62
ci_64                 2.140774e-04 3 1  ON 63
ci_65                -7.270832e-04 3 1  ON 64
ci_66                -4.479255e-04 3 1  ON 65
ci_67                 2.447743e-04 3 1  ON 66
ci_68                -9.661228e-04 3 1  ON 67
ci_69                -1.865521e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2831e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7629
    reference variance = 0.450674
====================================================
  Execution time = 2.5456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8431e-01
  Total weights = 1.963854828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470124312290
                                         uncertainty =       0.002387843414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470124312290
                                         uncertainty =       0.002387843414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484794751
  error estimate for blocks of size 2^( 2) =       0.000506129118
  error estimate for blocks of size 2^( 3) =       0.000526240614
  error estimate for blocks of size 2^( 4) =       0.000542367553
  error estimate for blocks of size 2^( 5) =       0.000551620321
  error estimate for blocks of size 2^( 6) =       0.000557067659
  error estimate for blocks of size 2^( 7) =       0.000558124457

      target function =                  N/A
              le_mean =     -22.819964879670
             les_mean =     521.235104976903
             stat err =       0.000552294998
             autocorr =       1.297855675474
              std dev =       0.685603312471
             le_variance =       0.470051902071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281996487967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819964879619       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819980119464       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819988392346       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819988416772       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819988328856       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819988640469       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 3.273372e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819964879619       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819977770109       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819983630783       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819983638402       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819983585815       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819983674887       residual = 8.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 2.110865e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819964879619       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819972853269       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819975376158       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819975450215       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 1.092007e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196461 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9996e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.161380e-01 3 1  ON 0
ci_02                -2.506965e-02 3 1  ON 1
ci_03                -2.553749e-02 3 1  ON 2
ci_04                 2.444535e-02 3 1  ON 3
ci_05                -2.240022e-02 3 1  ON 4
ci_06                -2.295041e-02 3 1  ON 5
ci_07                 2.685297e-02 3 1  ON 6
ci_08                -4.381278e-03 3 1  ON 7
ci_09                -1.028589e-02 3 1  ON 8
ci_10                -9.970782e-03 3 1  ON 9
ci_11                 1.566974e-02 3 1  ON 10
ci_12                 1.138219e-02 3 1  ON 11
ci_13                 1.037402e-02 3 1  ON 12
ci_14                 1.545602e-02 3 1  ON 13
ci_15                 8.710411e-03 3 1  ON 14
ci_16                 8.241180e-03 3 1  ON 15
ci_17                -9.668739e-03 3 1  ON 16
ci_18                -9.651459e-03 3 1  ON 17
ci_19                 9.120254e-03 3 1  ON 18
ci_20                 9.224628e-03 3 1  ON 19
ci_21                 8.028405e-03 3 1  ON 20
ci_22                 6.711537e-03 3 1  ON 21
ci_23                 6.474592e-03 3 1  ON 22
ci_24                 7.166489e-03 3 1  ON 23
ci_25                 5.366920e-03 3 1  ON 24
ci_26                 3.598169e-03 3 1  ON 25
ci_27                 3.565546e-03 3 1  ON 26
ci_28                 3.391433e-03 3 1  ON 27
ci_29                 3.401764e-03 3 1  ON 28
ci_30                 1.915152e-04 3 1  ON 29
ci_31                -9.693523e-04 3 1  ON 30
ci_32                -4.093204e-04 3 1  ON 31
ci_33                -3.727735e-04 3 1  ON 32
ci_34                 9.484001e-04 3 1  ON 33
ci_35                 2.409099e-04 3 1  ON 34
ci_36                -5.194558e-04 3 1  ON 35
ci_37                -1.276173e-03 3 1  ON 36
ci_38                -1.186419e-04 3 1  ON 37
ci_39                -4.794996e-04 3 1  ON 38
ci_40                -9.395186e-04 3 1  ON 39
ci_41                 3.803284e-04 3 1  ON 40
ci_42                 3.743816e-04 3 1  ON 41
ci_43                -1.850775e-03 3 1  ON 42
ci_44                -1.856941e-03 3 1  ON 43
ci_45                 3.215947e-05 3 1  ON 44
ci_46                -2.536953e-04 3 1  ON 45
ci_47                -1.678611e-03 3 1  ON 46
ci_48                -2.733410e-04 3 1  ON 47
ci_49                -1.678984e-03 3 1  ON 48
ci_50                -1.224826e-03 3 1  ON 49
ci_51                 5.458369e-04 3 1  ON 50
ci_52                 5.064660e-04 3 1  ON 51
ci_53                -8.130802e-04 3 1  ON 52
ci_54                -1.293514e-03 3 1  ON 53
ci_55                -4.619643e-05 3 1  ON 54
ci_56                 3.500375e-04 3 1  ON 55
ci_57                 1.884038e-03 3 1  ON 56
ci_58                -1.335530e-03 3 1  ON 57
ci_59                -1.256682e-03 3 1  ON 58
ci_60                 1.283524e-03 3 1  ON 59
ci_61                 1.065113e-03 3 1  ON 60
ci_62                -1.436559e-03 3 1  ON 61
ci_63                 7.393425e-05 3 1  ON 62
ci_64                -8.725062e-04 3 1  ON 63
ci_65                -3.538623e-04 3 1  ON 64
ci_66                -8.113155e-04 3 1  ON 65
ci_67                -7.567642e-04 3 1  ON 66
ci_68                -7.979773e-04 3 1  ON 67
ci_69                -1.494682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7119
    reference variance = 0.352738
====================================================
  Execution time = 2.4715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8764e-01
  Total weights = 1.9638e+06
  Execution time = 3.5068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00276244
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473496166719
                                         uncertainty =       0.002401335621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473496166719
                                         uncertainty =       0.002401335621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486539488
  error estimate for blocks of size 2^( 2) =       0.000507725329
  error estimate for blocks of size 2^( 3) =       0.000528419384
  error estimate for blocks of size 2^( 4) =       0.000544172285
  error estimate for blocks of size 2^( 5) =       0.000552607757
  error estimate for blocks of size 2^( 6) =       0.000556921847
  error estimate for blocks of size 2^( 7) =       0.000561026962

      target function =                  N/A
              le_mean =     -22.819307894104
             les_mean =     521.252136384847
             stat err =       0.000553682213
             autocorr =       1.295045289977
              std dev =       0.688070742177
             le_variance =       0.473441346240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472748956467
                                         uncertainty =       0.002405568100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472748956467
                                         uncertainty =       0.002405568100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486155196
  error estimate for blocks of size 2^( 2) =       0.000507391643
  error estimate for blocks of size 2^( 3) =       0.000528105128
  error estimate for blocks of size 2^( 4) =       0.000543910300
  error estimate for blocks of size 2^( 5) =       0.000552342793
  error estimate for blocks of size 2^( 6) =       0.000556711988
  error estimate for blocks of size 2^( 7) =       0.000560777323

      target function =                  N/A
              le_mean =     -22.819231866856
             les_mean =     521.206838192223
             stat err =       0.000553435601
             autocorr =       1.295938288808
              std dev =       0.687527271576
             le_variance =       0.472693749160

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00279255
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474907225192
                                         uncertainty =       0.002834922731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474907225192
                                         uncertainty =       0.002834922731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487260175
  error estimate for blocks of size 2^( 2) =       0.000508480916
  error estimate for blocks of size 2^( 3) =       0.000529122466
  error estimate for blocks of size 2^( 4) =       0.000544803486
  error estimate for blocks of size 2^( 5) =       0.000553197028
  error estimate for blocks of size 2^( 6) =       0.000557484120
  error estimate for blocks of size 2^( 7) =       0.000561406246

      target function =                  N/A
              le_mean =     -22.819319520305
             les_mean =     521.337824164209
             stat err =       0.000554222720
             autocorr =       1.293739439553
              std dev =       0.689089947552
             le_variance =       0.474844955817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472821161617
                                         uncertainty =       0.002403601804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472821161617
                                         uncertainty =       0.002403601804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486192739
  error estimate for blocks of size 2^( 2) =       0.000507410382
  error estimate for blocks of size 2^( 3) =       0.000528121759
  error estimate for blocks of size 2^( 4) =       0.000543896108
  error estimate for blocks of size 2^( 5) =       0.000552348171
  error estimate for blocks of size 2^( 6) =       0.000556744889
  error estimate for blocks of size 2^( 7) =       0.000560849460

      target function =                  N/A
              le_mean =     -22.819252807009
             les_mean =     521.835518247779
             stat err =       0.000553459657
             autocorr =       1.295850802367
              std dev =       0.687580365818
             le_variance =       0.472766759458


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819307894104        initial
     1.4901e-02     1.4901e-01             3.2734e-03       -22.819231866856
     5.9605e-02     5.9605e-01             2.1109e-03       -22.819319520305  <--
     2.3842e-01     2.3842e+00             1.0920e-03       -22.819252807009

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 4.2297e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_01                 1.161380e-01 3 1  ON 0
ci_02                -2.506965e-02 3 1  ON 1
ci_03                -2.553749e-02 3 1  ON 2
ci_04                 2.444535e-02 3 1  ON 3
ci_05                -2.240022e-02 3 1  ON 4
ci_06                -2.295041e-02 3 1  ON 5
ci_07                 2.685297e-02 3 1  ON 6
ci_08                -4.381278e-03 3 1  ON 7
ci_09                -1.028589e-02 3 1  ON 8
ci_10                -9.970782e-03 3 1  ON 9
ci_11                 1.566974e-02 3 1  ON 10
ci_12                 1.138219e-02 3 1  ON 11
ci_13                 1.037402e-02 3 1  ON 12
ci_14                 1.545602e-02 3 1  ON 13
ci_15                 8.710411e-03 3 1  ON 14
ci_16                 8.241180e-03 3 1  ON 15
ci_17                -9.668739e-03 3 1  ON 16
ci_18                -9.651459e-03 3 1  ON 17
ci_19                 9.120254e-03 3 1  ON 18
ci_20                 9.224628e-03 3 1  ON 19
ci_21                 8.028405e-03 3 1  ON 20
ci_22                 6.711537e-03 3 1  ON 21
ci_23                 6.474592e-03 3 1  ON 22
ci_24                 7.166489e-03 3 1  ON 23
ci_25                 5.366920e-03 3 1  ON 24
ci_26                 3.598169e-03 3 1  ON 25
ci_27                 3.565546e-03 3 1  ON 26
ci_28                 3.391433e-03 3 1  ON 27
ci_29                 3.401764e-03 3 1  ON 28
ci_30                 1.915152e-04 3 1  ON 29
ci_31                -9.693523e-04 3 1  ON 30
ci_32                -4.093204e-04 3 1  ON 31
ci_33                -3.727735e-04 3 1  ON 32
ci_34                 9.484001e-04 3 1  ON 33
ci_35                 2.409099e-04 3 1  ON 34
ci_36                -5.194558e-04 3 1  ON 35
ci_37                -1.276173e-03 3 1  ON 36
ci_38                -1.186419e-04 3 1  ON 37
ci_39                -4.794996e-04 3 1  ON 38
ci_40                -9.395186e-04 3 1  ON 39
ci_41                 3.803284e-04 3 1  ON 40
ci_42                 3.743816e-04 3 1  ON 41
ci_43                -1.850775e-03 3 1  ON 42
ci_44                -1.856941e-03 3 1  ON 43
ci_45                 3.215947e-05 3 1  ON 44
ci_46                -2.536953e-04 3 1  ON 45
ci_47                -1.678611e-03 3 1  ON 46
ci_48                -2.733410e-04 3 1  ON 47
ci_49                -1.678984e-03 3 1  ON 48
ci_50                -1.224826e-03 3 1  ON 49
ci_51                 5.458369e-04 3 1  ON 50
ci_52                 5.064660e-04 3 1  ON 51
ci_53                -8.130802e-04 3 1  ON 52
ci_54                -1.293514e-03 3 1  ON 53
ci_55                -4.619643e-05 3 1  ON 54
ci_56                 3.500375e-04 3 1  ON 55
ci_57                 1.884038e-03 3 1  ON 56
ci_58                -1.335530e-03 3 1  ON 57
ci_59                -1.256682e-03 3 1  ON 58
ci_60                 1.283524e-03 3 1  ON 59
ci_61                 1.065113e-03 3 1  ON 60
ci_62                -1.436559e-03 3 1  ON 61
ci_63                 7.393425e-05 3 1  ON 62
ci_64                -8.725062e-04 3 1  ON 63
ci_65                -3.538623e-04 3 1  ON 64
ci_66                -8.113155e-04 3 1  ON 65
ci_67                -7.567642e-04 3 1  ON 66
ci_68                -7.979773e-04 3 1  ON 67
ci_69                -1.494682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8402
    reference variance = 0.646599
====================================================
  Execution time = 2.5350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8917e-01
  Total weights = 1.963755231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474945308366
                                         uncertainty =       0.005062865127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474945308366
                                         uncertainty =       0.005062865127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487311983
  error estimate for blocks of size 2^( 2) =       0.000508928537
  error estimate for blocks of size 2^( 3) =       0.000529781266
  error estimate for blocks of size 2^( 4) =       0.000545747295
  error estimate for blocks of size 2^( 5) =       0.000556987627
  error estimate for blocks of size 2^( 6) =       0.000562870456
  error estimate for blocks of size 2^( 7) =       0.000569250523

      target function =                  N/A
              le_mean =     -22.818823557755
             les_mean =     521.187882900237
             stat err =       0.000558713975
             autocorr =       1.314513008685
              std dev =       0.689163214762
             le_variance =       0.474945936582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281882355776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818823557707       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818847598387       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818865856021       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818864509338       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818863486855       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818862304329       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818862149416       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 8.114976e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818823557707       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818843268885       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818856828793       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818855860813       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818855484201       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818855072052       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 6.217224e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818823557707       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818835015255       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818841659541       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818841255182       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818841204454       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 3.249561e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202107 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9900e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.185039e-01 3 1  ON 0
ci_02                -2.645912e-02 3 1  ON 1
ci_03                -2.603893e-02 3 1  ON 2
ci_04                 2.490490e-02 3 1  ON 3
ci_05                -2.323426e-02 3 1  ON 4
ci_06                -2.294704e-02 3 1  ON 5
ci_07                 3.131940e-02 3 1  ON 6
ci_08                -3.404019e-03 3 1  ON 7
ci_09                -9.664185e-03 3 1  ON 8
ci_10                -1.124395e-02 3 1  ON 9
ci_11                 1.654434e-02 3 1  ON 10
ci_12                 1.042971e-02 3 1  ON 11
ci_13                 1.181997e-02 3 1  ON 12
ci_14                 1.579357e-02 3 1  ON 13
ci_15                 6.843603e-03 3 1  ON 14
ci_16                 9.162358e-03 3 1  ON 15
ci_17                -1.088298e-02 3 1  ON 16
ci_18                -1.052775e-02 3 1  ON 17
ci_19                 8.790260e-03 3 1  ON 18
ci_20                 1.032195e-02 3 1  ON 19
ci_21                 1.811181e-03 3 1  ON 20
ci_22                 8.563677e-03 3 1  ON 21
ci_23                 5.836401e-03 3 1  ON 22
ci_24                 5.148563e-03 3 1  ON 23
ci_25                 4.850635e-03 3 1  ON 24
ci_26                 2.557169e-03 3 1  ON 25
ci_27                 1.464612e-03 3 1  ON 26
ci_28                 5.140896e-03 3 1  ON 27
ci_29                 3.563287e-03 3 1  ON 28
ci_30                -4.241763e-03 3 1  ON 29
ci_31                -1.672419e-03 3 1  ON 30
ci_32                -7.363529e-04 3 1  ON 31
ci_33                -1.613195e-04 3 1  ON 32
ci_34                 3.893551e-03 3 1  ON 33
ci_35                 4.382007e-05 3 1  ON 34
ci_36                 4.713363e-04 3 1  ON 35
ci_37                -3.903214e-03 3 1  ON 36
ci_38                 7.620529e-04 3 1  ON 37
ci_39                -1.922763e-03 3 1  ON 38
ci_40                -9.006779e-04 3 1  ON 39
ci_41                 7.431473e-04 3 1  ON 40
ci_42                 2.651826e-04 3 1  ON 41
ci_43                -3.939032e-03 3 1  ON 42
ci_44                -2.319743e-03 3 1  ON 43
ci_45                -1.292213e-03 3 1  ON 44
ci_46                 5.346787e-04 3 1  ON 45
ci_47                 1.575921e-03 3 1  ON 46
ci_48                 1.087281e-03 3 1  ON 47
ci_49                -2.263169e-05 3 1  ON 48
ci_50                -9.249070e-04 3 1  ON 49
ci_51                 1.022128e-03 3 1  ON 50
ci_52                -8.347089e-04 3 1  ON 51
ci_53                -9.634014e-04 3 1  ON 52
ci_54                 3.153517e-03 3 1  ON 53
ci_55                -6.922191e-04 3 1  ON 54
ci_56                 4.222711e-04 3 1  ON 55
ci_57                 1.364607e-03 3 1  ON 56
ci_58                -1.389952e-03 3 1  ON 57
ci_59                -8.735257e-04 3 1  ON 58
ci_60                 3.315864e-03 3 1  ON 59
ci_61                 6.564605e-04 3 1  ON 60
ci_62                 1.641887e-04 3 1  ON 61
ci_63                -4.424202e-04 3 1  ON 62
ci_64                -2.857344e-04 3 1  ON 63
ci_65                -2.358272e-03 3 1  ON 64
ci_66                 3.148860e-03 3 1  ON 65
ci_67                 2.017859e-04 3 1  ON 66
ci_68                -3.870832e-04 3 1  ON 67
ci_69                -4.614360e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.858
    reference variance = 0.29077
====================================================
  Execution time = 2.6822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9308e-01
  Total weights = 1.9637e+06
  Execution time = 3.5128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0175291
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.541353613022
                                         uncertainty =       0.063256938008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.541353613022
                                         uncertainty =       0.063256938008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000520214920
  error estimate for blocks of size 2^( 2) =       0.000540043089
  error estimate for blocks of size 2^( 3) =       0.000559692649
  error estimate for blocks of size 2^( 4) =       0.000573838080
  error estimate for blocks of size 2^( 5) =       0.000582956323
  error estimate for blocks of size 2^( 6) =       0.000589202801
  error estimate for blocks of size 2^( 7) =       0.000592312915

      target function =                  N/A
              le_mean =     -22.820359167495
             les_mean =     527.445431941506
             stat err =       0.000584577530
             autocorr =       1.262753636879
              std dev =       0.735694994940
             le_variance =       0.541247125580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475118887814
                                         uncertainty =       0.003304323786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475118887814
                                         uncertainty =       0.003304323786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487365157
  error estimate for blocks of size 2^( 2) =       0.000508530179
  error estimate for blocks of size 2^( 3) =       0.000529379923
  error estimate for blocks of size 2^( 4) =       0.000544494968
  error estimate for blocks of size 2^( 5) =       0.000553798300
  error estimate for blocks of size 2^( 6) =       0.000560365544
  error estimate for blocks of size 2^( 7) =       0.000564000334

      target function =                  N/A
              le_mean =     -22.819832580169
             les_mean =     521.260195171840
             stat err =       0.000555664786
             autocorr =       1.299920510667
              std dev =       0.689238415365
             le_variance =       0.475049593215

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0179708
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488815360202
                                         uncertainty =       0.004677247973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488815360202
                                         uncertainty =       0.004677247973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494330771
  error estimate for blocks of size 2^( 2) =       0.000515298345
  error estimate for blocks of size 2^( 3) =       0.000535891901
  error estimate for blocks of size 2^( 4) =       0.000550763308
  error estimate for blocks of size 2^( 5) =       0.000559801812
  error estimate for blocks of size 2^( 6) =       0.000566476041
  error estimate for blocks of size 2^( 7) =       0.000570240593

      target function =                  N/A
              le_mean =     -22.820263035970
             les_mean =     521.389992173738
             stat err =       0.000561820438
             autocorr =       1.291694404505
              std dev =       0.699089280386
             le_variance =       0.488725821950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478220747003
                                         uncertainty =       0.004791707247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478220747003
                                         uncertainty =       0.004791707247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488953383
  error estimate for blocks of size 2^( 2) =       0.000510036027
  error estimate for blocks of size 2^( 3) =       0.000530761525
  error estimate for blocks of size 2^( 4) =       0.000545757356
  error estimate for blocks of size 2^( 5) =       0.000555088847
  error estimate for blocks of size 2^( 6) =       0.000561715975
  error estimate for blocks of size 2^( 7) =       0.000565288754

      target function =                  N/A
              le_mean =     -22.819822588202
             les_mean =     521.345914186560
             stat err =       0.000556962733
             autocorr =       1.297529869638
              std dev =       0.691484505084
             le_variance =       0.478150820772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820359167495        initial  <--
     1.4901e-02     1.4901e-01             8.1150e-03       -22.819832580169
     5.9605e-02     5.9605e-01             6.2172e-03       -22.820263035970
     2.3842e-01     2.3842e+00             3.2496e-03       -22.819822588202

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4002
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_01                 1.161380e-01 3 1  ON 0
ci_02                -2.506965e-02 3 1  ON 1
ci_03                -2.553749e-02 3 1  ON 2
ci_04                 2.444535e-02 3 1  ON 3
ci_05                -2.240022e-02 3 1  ON 4
ci_06                -2.295041e-02 3 1  ON 5
ci_07                 2.685297e-02 3 1  ON 6
ci_08                -4.381278e-03 3 1  ON 7
ci_09                -1.028589e-02 3 1  ON 8
ci_10                -9.970782e-03 3 1  ON 9
ci_11                 1.566974e-02 3 1  ON 10
ci_12                 1.138219e-02 3 1  ON 11
ci_13                 1.037402e-02 3 1  ON 12
ci_14                 1.545602e-02 3 1  ON 13
ci_15                 8.710411e-03 3 1  ON 14
ci_16                 8.241180e-03 3 1  ON 15
ci_17                -9.668739e-03 3 1  ON 16
ci_18                -9.651459e-03 3 1  ON 17
ci_19                 9.120254e-03 3 1  ON 18
ci_20                 9.224628e-03 3 1  ON 19
ci_21                 8.028405e-03 3 1  ON 20
ci_22                 6.711537e-03 3 1  ON 21
ci_23                 6.474592e-03 3 1  ON 22
ci_24                 7.166489e-03 3 1  ON 23
ci_25                 5.366920e-03 3 1  ON 24
ci_26                 3.598169e-03 3 1  ON 25
ci_27                 3.565546e-03 3 1  ON 26
ci_28                 3.391433e-03 3 1  ON 27
ci_29                 3.401764e-03 3 1  ON 28
ci_30                 1.915152e-04 3 1  ON 29
ci_31                -9.693523e-04 3 1  ON 30
ci_32                -4.093204e-04 3 1  ON 31
ci_33                -3.727735e-04 3 1  ON 32
ci_34                 9.484001e-04 3 1  ON 33
ci_35                 2.409099e-04 3 1  ON 34
ci_36                -5.194558e-04 3 1  ON 35
ci_37                -1.276173e-03 3 1  ON 36
ci_38                -1.186419e-04 3 1  ON 37
ci_39                -4.794996e-04 3 1  ON 38
ci_40                -9.395186e-04 3 1  ON 39
ci_41                 3.803284e-04 3 1  ON 40
ci_42                 3.743816e-04 3 1  ON 41
ci_43                -1.850775e-03 3 1  ON 42
ci_44                -1.856941e-03 3 1  ON 43
ci_45                 3.215947e-05 3 1  ON 44
ci_46                -2.536953e-04 3 1  ON 45
ci_47                -1.678611e-03 3 1  ON 46
ci_48                -2.733410e-04 3 1  ON 47
ci_49                -1.678984e-03 3 1  ON 48
ci_50                -1.224826e-03 3 1  ON 49
ci_51                 5.458369e-04 3 1  ON 50
ci_52                 5.064660e-04 3 1  ON 51
ci_53                -8.130802e-04 3 1  ON 52
ci_54                -1.293514e-03 3 1  ON 53
ci_55                -4.619643e-05 3 1  ON 54
ci_56                 3.500375e-04 3 1  ON 55
ci_57                 1.884038e-03 3 1  ON 56
ci_58                -1.335530e-03 3 1  ON 57
ci_59                -1.256682e-03 3 1  ON 58
ci_60                 1.283524e-03 3 1  ON 59
ci_61                 1.065113e-03 3 1  ON 60
ci_62                -1.436559e-03 3 1  ON 61
ci_63                 7.393425e-05 3 1  ON 62
ci_64                -8.725062e-04 3 1  ON 63
ci_65                -3.538623e-04 3 1  ON 64
ci_66                -8.113155e-04 3 1  ON 65
ci_67                -7.567642e-04 3 1  ON 66
ci_68                -7.979773e-04 3 1  ON 67
ci_69                -1.494682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7925
    reference variance = 0.265381
====================================================
  Execution time = 2.5344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8381e-01
  Total weights = 1.963890361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468708359477
                                         uncertainty =       0.002293611870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468708359477
                                         uncertainty =       0.002293611870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484039861
  error estimate for blocks of size 2^( 2) =       0.000505773185
  error estimate for blocks of size 2^( 3) =       0.000525941243
  error estimate for blocks of size 2^( 4) =       0.000541503028
  error estimate for blocks of size 2^( 5) =       0.000553290287
  error estimate for blocks of size 2^( 6) =       0.000558490973
  error estimate for blocks of size 2^( 7) =       0.000560065200

      target function =                  N/A
              le_mean =     -22.818727277262
             les_mean =     521.178122876319
             stat err =       0.000553337372
             autocorr =       1.306825954417
              std dev =       0.684535735942
             le_variance =       0.468589173782


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281872727726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818727277219       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818747776717       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818748576218       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818749156514       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818749020553       residual = 8.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.494695e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818727277219       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818736147644       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818736485628       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818736456430       residual = 8.58e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 5.804494e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818727277219       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818729990595       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818730139584       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818730106192       residual = 3.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.704761e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9858e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.161262e-01 3 1  ON 0
ci_02                -2.513613e-02 3 1  ON 1
ci_03                -2.559748e-02 3 1  ON 2
ci_04                 2.476124e-02 3 1  ON 3
ci_05                -2.254259e-02 3 1  ON 4
ci_06                -2.290622e-02 3 1  ON 5
ci_07                 2.657910e-02 3 1  ON 6
ci_08                -4.346806e-03 3 1  ON 7
ci_09                -1.061361e-02 3 1  ON 8
ci_10                -1.017983e-02 3 1  ON 9
ci_11                 1.595956e-02 3 1  ON 10
ci_12                 1.133948e-02 3 1  ON 11
ci_13                 1.048511e-02 3 1  ON 12
ci_14                 1.555947e-02 3 1  ON 13
ci_15                 8.518542e-03 3 1  ON 14
ci_16                 7.919258e-03 3 1  ON 15
ci_17                -9.849252e-03 3 1  ON 16
ci_18                -9.556014e-03 3 1  ON 17
ci_19                 9.283502e-03 3 1  ON 18
ci_20                 9.368784e-03 3 1  ON 19
ci_21                 8.131916e-03 3 1  ON 20
ci_22                 7.291986e-03 3 1  ON 21
ci_23                 6.592159e-03 3 1  ON 22
ci_24                 7.345206e-03 3 1  ON 23
ci_25                 5.420064e-03 3 1  ON 24
ci_26                 3.335315e-03 3 1  ON 25
ci_27                 3.428432e-03 3 1  ON 26
ci_28                 3.519125e-03 3 1  ON 27
ci_29                 3.420749e-03 3 1  ON 28
ci_30                 3.063262e-04 3 1  ON 29
ci_31                -8.082506e-04 3 1  ON 30
ci_32                -2.437287e-04 3 1  ON 31
ci_33                -2.344099e-04 3 1  ON 32
ci_34                 9.077569e-04 3 1  ON 33
ci_35                 1.775378e-04 3 1  ON 34
ci_36                -4.465889e-04 3 1  ON 35
ci_37                -1.381879e-03 3 1  ON 36
ci_38                -1.926596e-04 3 1  ON 37
ci_39                -4.696116e-04 3 1  ON 38
ci_40                -8.866898e-04 3 1  ON 39
ci_41                 3.383078e-04 3 1  ON 40
ci_42                 3.144483e-04 3 1  ON 41
ci_43                -1.893233e-03 3 1  ON 42
ci_44                -1.918252e-03 3 1  ON 43
ci_45                -1.471347e-04 3 1  ON 44
ci_46                -3.358570e-04 3 1  ON 45
ci_47                -1.867936e-03 3 1  ON 46
ci_48                -2.128409e-04 3 1  ON 47
ci_49                -1.632753e-03 3 1  ON 48
ci_50                -1.088300e-03 3 1  ON 49
ci_51                 3.632423e-04 3 1  ON 50
ci_52                 6.384459e-04 3 1  ON 51
ci_53                -7.084468e-04 3 1  ON 52
ci_54                -1.256847e-03 3 1  ON 53
ci_55                -3.574985e-04 3 1  ON 54
ci_56                 3.933610e-04 3 1  ON 55
ci_57                 1.912155e-03 3 1  ON 56
ci_58                -1.370027e-03 3 1  ON 57
ci_59                -1.380286e-03 3 1  ON 58
ci_60                 1.348899e-03 3 1  ON 59
ci_61                 1.178101e-03 3 1  ON 60
ci_62                -9.348651e-04 3 1  ON 61
ci_63                 2.195535e-04 3 1  ON 62
ci_64                -6.618378e-04 3 1  ON 63
ci_65                -5.887382e-05 3 1  ON 64
ci_66                -8.532152e-04 3 1  ON 65
ci_67                -7.273677e-04 3 1  ON 66
ci_68                -5.987512e-04 3 1  ON 67
ci_69                -1.288571e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7801
    reference variance = 0.425618
====================================================
  Execution time = 2.4815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8481e-01
  Total weights = 1.9635e+06
  Execution time = 3.5128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468539538956
                                         uncertainty =       0.002141382307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468539538956
                                         uncertainty =       0.002141382307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484000600
  error estimate for blocks of size 2^( 2) =       0.000505188576
  error estimate for blocks of size 2^( 3) =       0.000525518476
  error estimate for blocks of size 2^( 4) =       0.000541585762
  error estimate for blocks of size 2^( 5) =       0.000551060194
  error estimate for blocks of size 2^( 6) =       0.000556246449
  error estimate for blocks of size 2^( 7) =       0.000561914742

      target function =                  N/A
              le_mean =     -22.819390709669
             les_mean =     521.323064452077
             stat err =       0.000552701787
             autocorr =       1.304037066266
              std dev =       0.684480213377
             le_variance =       0.468513162505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468822952724
                                         uncertainty =       0.002164477560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468822952724
                                         uncertainty =       0.002164477560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484145682
  error estimate for blocks of size 2^( 2) =       0.000505326048
  error estimate for blocks of size 2^( 3) =       0.000525631963
  error estimate for blocks of size 2^( 4) =       0.000541670224
  error estimate for blocks of size 2^( 5) =       0.000551129943
  error estimate for blocks of size 2^( 6) =       0.000556335880
  error estimate for blocks of size 2^( 7) =       0.000561969819

      target function =                  N/A
              le_mean =     -22.819388227589
             les_mean =     521.228872788996
             stat err =       0.000552776467
             autocorr =       1.303607846222
              std dev =       0.684685389241
             le_variance =       0.468794082241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468735170181
                                         uncertainty =       0.002155592020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468735170181
                                         uncertainty =       0.002155592020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484100337
  error estimate for blocks of size 2^( 2) =       0.000505281668
  error estimate for blocks of size 2^( 3) =       0.000525591939
  error estimate for blocks of size 2^( 4) =       0.000541639202
  error estimate for blocks of size 2^( 5) =       0.000551100576
  error estimate for blocks of size 2^( 6) =       0.000556297435
  error estimate for blocks of size 2^( 7) =       0.000561934841

      target function =                  N/A
              le_mean =     -22.819386616167
             les_mean =     521.211937535609
             stat err =       0.000552743014
             autocorr =       1.303694260775
              std dev =       0.684621262484
             le_variance =       0.468706273046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468554961246
                                         uncertainty =       0.002142996994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468554961246
                                         uncertainty =       0.002142996994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484008342
  error estimate for blocks of size 2^( 2) =       0.000505194493
  error estimate for blocks of size 2^( 3) =       0.000525523072
  error estimate for blocks of size 2^( 4) =       0.000541590510
  error estimate for blocks of size 2^( 5) =       0.000551059558
  error estimate for blocks of size 2^( 6) =       0.000556242270
  error estimate for blocks of size 2^( 7) =       0.000561901064

      target function =                  N/A
              le_mean =     -22.819384781347
             les_mean =     521.240055908645
             stat err =       0.000552698351
             autocorr =       1.303979136862
              std dev =       0.684491161760
             le_variance =       0.468528150527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819390709669        initial  <--
     1.4901e-01     1.4901e+00             1.4947e-03       -22.819388227589
     5.9605e-01     5.9605e+00             5.8045e-04       -22.819386616167
     2.3842e+00     2.3842e+01             1.7048e-04       -22.819384781347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4152
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_01                 1.161380e-01 3 1  ON 0
ci_02                -2.506965e-02 3 1  ON 1
ci_03                -2.553749e-02 3 1  ON 2
ci_04                 2.444535e-02 3 1  ON 3
ci_05                -2.240022e-02 3 1  ON 4
ci_06                -2.295041e-02 3 1  ON 5
ci_07                 2.685297e-02 3 1  ON 6
ci_08                -4.381278e-03 3 1  ON 7
ci_09                -1.028589e-02 3 1  ON 8
ci_10                -9.970782e-03 3 1  ON 9
ci_11                 1.566974e-02 3 1  ON 10
ci_12                 1.138219e-02 3 1  ON 11
ci_13                 1.037402e-02 3 1  ON 12
ci_14                 1.545602e-02 3 1  ON 13
ci_15                 8.710411e-03 3 1  ON 14
ci_16                 8.241180e-03 3 1  ON 15
ci_17                -9.668739e-03 3 1  ON 16
ci_18                -9.651459e-03 3 1  ON 17
ci_19                 9.120254e-03 3 1  ON 18
ci_20                 9.224628e-03 3 1  ON 19
ci_21                 8.028405e-03 3 1  ON 20
ci_22                 6.711537e-03 3 1  ON 21
ci_23                 6.474592e-03 3 1  ON 22
ci_24                 7.166489e-03 3 1  ON 23
ci_25                 5.366920e-03 3 1  ON 24
ci_26                 3.598169e-03 3 1  ON 25
ci_27                 3.565546e-03 3 1  ON 26
ci_28                 3.391433e-03 3 1  ON 27
ci_29                 3.401764e-03 3 1  ON 28
ci_30                 1.915152e-04 3 1  ON 29
ci_31                -9.693523e-04 3 1  ON 30
ci_32                -4.093204e-04 3 1  ON 31
ci_33                -3.727735e-04 3 1  ON 32
ci_34                 9.484001e-04 3 1  ON 33
ci_35                 2.409099e-04 3 1  ON 34
ci_36                -5.194558e-04 3 1  ON 35
ci_37                -1.276173e-03 3 1  ON 36
ci_38                -1.186419e-04 3 1  ON 37
ci_39                -4.794996e-04 3 1  ON 38
ci_40                -9.395186e-04 3 1  ON 39
ci_41                 3.803284e-04 3 1  ON 40
ci_42                 3.743816e-04 3 1  ON 41
ci_43                -1.850775e-03 3 1  ON 42
ci_44                -1.856941e-03 3 1  ON 43
ci_45                 3.215947e-05 3 1  ON 44
ci_46                -2.536953e-04 3 1  ON 45
ci_47                -1.678611e-03 3 1  ON 46
ci_48                -2.733410e-04 3 1  ON 47
ci_49                -1.678984e-03 3 1  ON 48
ci_50                -1.224826e-03 3 1  ON 49
ci_51                 5.458369e-04 3 1  ON 50
ci_52                 5.064660e-04 3 1  ON 51
ci_53                -8.130802e-04 3 1  ON 52
ci_54                -1.293514e-03 3 1  ON 53
ci_55                -4.619643e-05 3 1  ON 54
ci_56                 3.500375e-04 3 1  ON 55
ci_57                 1.884038e-03 3 1  ON 56
ci_58                -1.335530e-03 3 1  ON 57
ci_59                -1.256682e-03 3 1  ON 58
ci_60                 1.283524e-03 3 1  ON 59
ci_61                 1.065113e-03 3 1  ON 60
ci_62                -1.436559e-03 3 1  ON 61
ci_63                 7.393425e-05 3 1  ON 62
ci_64                -8.725062e-04 3 1  ON 63
ci_65                -3.538623e-04 3 1  ON 64
ci_66                -8.113155e-04 3 1  ON 65
ci_67                -7.567642e-04 3 1  ON 66
ci_68                -7.979773e-04 3 1  ON 67
ci_69                -1.494682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6899
    reference variance = 0.375749
====================================================
  Execution time = 2.5641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8494e-01
  Total weights = 1.963847720e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470899068789
                                         uncertainty =       0.002508632841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470899068789
                                         uncertainty =       0.002508632841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485327614
  error estimate for blocks of size 2^( 2) =       0.000507006454
  error estimate for blocks of size 2^( 3) =       0.000527659402
  error estimate for blocks of size 2^( 4) =       0.000543461872
  error estimate for blocks of size 2^( 5) =       0.000553877552
  error estimate for blocks of size 2^( 6) =       0.000561141114
  error estimate for blocks of size 2^( 7) =       0.000565228260

      target function =                  N/A
              le_mean =     -22.819876223066
             les_mean =     521.231687419478
             stat err =       0.000555927200
             autocorr =       1.312096697652
              std dev =       0.686356893560
             le_variance =       0.471085785338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281987622307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819876223054       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819883120528       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819883334236       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819883332770       residual = 3.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 2.916053e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819876223054       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819878112522       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819878174287       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819878174645       residual = 5.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 8.230300e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819876223054       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819876707005       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819876723151       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819876723414       residual = 6.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 2.126350e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0153e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.161478e-01 3 1  ON 0
ci_02                -2.512374e-02 3 1  ON 1
ci_03                -2.554766e-02 3 1  ON 2
ci_04                 2.447308e-02 3 1  ON 3
ci_05                -2.244472e-02 3 1  ON 4
ci_06                -2.297189e-02 3 1  ON 5
ci_07                 2.677623e-02 3 1  ON 6
ci_08                -4.353970e-03 3 1  ON 7
ci_09                -1.031005e-02 3 1  ON 8
ci_10                -9.985792e-03 3 1  ON 9
ci_11                 1.567948e-02 3 1  ON 10
ci_12                 1.135229e-02 3 1  ON 11
ci_13                 1.042549e-02 3 1  ON 12
ci_14                 1.548562e-02 3 1  ON 13
ci_15                 8.678762e-03 3 1  ON 14
ci_16                 8.209192e-03 3 1  ON 15
ci_17                -9.697968e-03 3 1  ON 16
ci_18                -9.656211e-03 3 1  ON 17
ci_19                 9.112578e-03 3 1  ON 18
ci_20                 9.264287e-03 3 1  ON 19
ci_21                 8.029482e-03 3 1  ON 20
ci_22                 6.716194e-03 3 1  ON 21
ci_23                 6.434253e-03 3 1  ON 22
ci_24                 7.182184e-03 3 1  ON 23
ci_25                 5.370493e-03 3 1  ON 24
ci_26                 3.535573e-03 3 1  ON 25
ci_27                 3.584102e-03 3 1  ON 26
ci_28                 3.397735e-03 3 1  ON 27
ci_29                 3.432667e-03 3 1  ON 28
ci_30                 1.870507e-04 3 1  ON 29
ci_31                -9.396492e-04 3 1  ON 30
ci_32                -4.061833e-04 3 1  ON 31
ci_33                -4.000721e-04 3 1  ON 32
ci_34                 9.285142e-04 3 1  ON 33
ci_35                 2.775649e-04 3 1  ON 34
ci_36                -5.253789e-04 3 1  ON 35
ci_37                -1.265333e-03 3 1  ON 36
ci_38                -1.578569e-04 3 1  ON 37
ci_39                -4.510871e-04 3 1  ON 38
ci_40                -9.650706e-04 3 1  ON 39
ci_41                 4.012121e-04 3 1  ON 40
ci_42                 3.675040e-04 3 1  ON 41
ci_43                -1.837274e-03 3 1  ON 42
ci_44                -1.862350e-03 3 1  ON 43
ci_45                -5.584923e-07 3 1  ON 44
ci_46                -2.614216e-04 3 1  ON 45
ci_47                -1.692128e-03 3 1  ON 46
ci_48                -2.616556e-04 3 1  ON 47
ci_49                -1.640494e-03 3 1  ON 48
ci_50                -1.202258e-03 3 1  ON 49
ci_51                 5.495413e-04 3 1  ON 50
ci_52                 4.792489e-04 3 1  ON 51
ci_53                -8.493161e-04 3 1  ON 52
ci_54                -1.223506e-03 3 1  ON 53
ci_55                -6.054279e-05 3 1  ON 54
ci_56                 4.323405e-04 3 1  ON 55
ci_57                 1.833710e-03 3 1  ON 56
ci_58                -1.343034e-03 3 1  ON 57
ci_59                -1.241327e-03 3 1  ON 58
ci_60                 1.290258e-03 3 1  ON 59
ci_61                 1.077156e-03 3 1  ON 60
ci_62                -1.416932e-03 3 1  ON 61
ci_63                 8.304999e-05 3 1  ON 62
ci_64                -8.889157e-04 3 1  ON 63
ci_65                -3.975472e-04 3 1  ON 64
ci_66                -8.333509e-04 3 1  ON 65
ci_67                -7.416349e-04 3 1  ON 66
ci_68                -7.811612e-04 3 1  ON 67
ci_69                -1.459491e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7656
    reference variance = 0.520729
====================================================
  Execution time = 2.4898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8935e-01
  Total weights = 1.9638e+06
  Execution time = 3.4936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472333393487
                                         uncertainty =       0.002792955966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472333393487
                                         uncertainty =       0.002792955966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485930821
  error estimate for blocks of size 2^( 2) =       0.000507465305
  error estimate for blocks of size 2^( 3) =       0.000528341444
  error estimate for blocks of size 2^( 4) =       0.000544189563
  error estimate for blocks of size 2^( 5) =       0.000552723587
  error estimate for blocks of size 2^( 6) =       0.000557147462
  error estimate for blocks of size 2^( 7) =       0.000559244981

      target function =                  N/A
              le_mean =     -22.820189191863
             les_mean =     521.250487527499
             stat err =       0.000553326398
             autocorr =       1.296623503163
              std dev =       0.687209956865
             le_variance =       0.472257524814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472357012630
                                         uncertainty =       0.002807804111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472357012630
                                         uncertainty =       0.002807804111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485943069
  error estimate for blocks of size 2^( 2) =       0.000507471036
  error estimate for blocks of size 2^( 3) =       0.000528339050
  error estimate for blocks of size 2^( 4) =       0.000544181910
  error estimate for blocks of size 2^( 5) =       0.000552704226
  error estimate for blocks of size 2^( 6) =       0.000557122293
  error estimate for blocks of size 2^( 7) =       0.000559225945

      target function =                  N/A
              le_mean =     -22.820193400404
             les_mean =     521.256587335457
             stat err =       0.000553308594
             autocorr =       1.296474701227
              std dev =       0.687227278551
             le_variance =       0.472281332385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472340195045
                                         uncertainty =       0.002800717631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472340195045
                                         uncertainty =       0.002800717631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485934374
  error estimate for blocks of size 2^( 2) =       0.000507465328
  error estimate for blocks of size 2^( 3) =       0.000528337094
  error estimate for blocks of size 2^( 4) =       0.000544182727
  error estimate for blocks of size 2^( 5) =       0.000552711902
  error estimate for blocks of size 2^( 6) =       0.000557131946
  error estimate for blocks of size 2^( 7) =       0.000559231148

      target function =                  N/A
              le_mean =     -22.820191360369
             les_mean =     521.250693241502
             stat err =       0.000553314431
             autocorr =       1.296548455159
              std dev =       0.687214981557
             le_variance =       0.472264430876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472333650902
                                         uncertainty =       0.002793910000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472333650902
                                         uncertainty =       0.002793910000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485930960
  error estimate for blocks of size 2^( 2) =       0.000507465004
  error estimate for blocks of size 2^( 3) =       0.000528340599
  error estimate for blocks of size 2^( 4) =       0.000544188373
  error estimate for blocks of size 2^( 5) =       0.000552721700
  error estimate for blocks of size 2^( 6) =       0.000557145088
  error estimate for blocks of size 2^( 7) =       0.000559242927

      target function =                  N/A
              le_mean =     -22.820189436133
             les_mean =     521.250370219308
             stat err =       0.000553324522
             autocorr =       1.296613964339
              std dev =       0.687210154104
             le_variance =       0.472257795903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.820189191863        initial
     1.4901e+00     1.4901e+01             2.9161e-04       -22.820193400404  <--
     5.9605e+00     5.9605e+01             8.2303e-05       -22.820191360369
     2.3842e+01     2.3842e+02             2.1263e-05       -22.820189436133

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 4.2395e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_01                 1.161732e-01 3 1  ON 0
ci_02                -2.526819e-02 3 1  ON 1
ci_03                -2.557371e-02 3 1  ON 2
ci_04                 2.454294e-02 3 1  ON 3
ci_05                -2.256418e-02 3 1  ON 4
ci_06                -2.302934e-02 3 1  ON 5
ci_07                 2.656768e-02 3 1  ON 6
ci_08                -4.286928e-03 3 1  ON 7
ci_09                -1.037694e-02 3 1  ON 8
ci_10                -1.002955e-02 3 1  ON 9
ci_11                 1.570711e-02 3 1  ON 10
ci_12                 1.127272e-02 3 1  ON 11
ci_13                 1.056992e-02 3 1  ON 12
ci_14                 1.556944e-02 3 1  ON 13
ci_15                 8.591896e-03 3 1  ON 14
ci_16                 8.123038e-03 3 1  ON 15
ci_17                -9.778998e-03 3 1  ON 16
ci_18                -9.669849e-03 3 1  ON 17
ci_19                 9.092157e-03 3 1  ON 18
ci_20                 9.370775e-03 3 1  ON 19
ci_21                 8.032206e-03 3 1  ON 20
ci_22                 6.728251e-03 3 1  ON 21
ci_23                 6.331771e-03 3 1  ON 22
ci_24                 7.226523e-03 3 1  ON 23
ci_25                 5.380445e-03 3 1  ON 24
ci_26                 3.367302e-03 3 1  ON 25
ci_27                 3.633836e-03 3 1  ON 26
ci_28                 3.415505e-03 3 1  ON 27
ci_29                 3.516384e-03 3 1  ON 28
ci_30                 1.778421e-04 3 1  ON 29
ci_31                -8.555852e-04 3 1  ON 30
ci_32                -3.990534e-04 3 1  ON 31
ci_33                -4.678110e-04 3 1  ON 32
ci_34                 8.745507e-04 3 1  ON 33
ci_35                 3.747899e-04 3 1  ON 34
ci_36                -5.396712e-04 3 1  ON 35
ci_37                -1.237165e-03 3 1  ON 36
ci_38                -2.568318e-04 3 1  ON 37
ci_39                -3.786211e-04 3 1  ON 38
ci_40                -1.027064e-03 3 1  ON 39
ci_41                 4.567233e-04 3 1  ON 40
ci_42                 3.486773e-04 3 1  ON 41
ci_43                -1.802473e-03 3 1  ON 42
ci_44                -1.878549e-03 3 1  ON 43
ci_45                -8.416906e-05 3 1  ON 44
ci_46                -2.816711e-04 3 1  ON 45
ci_47                -1.725091e-03 3 1  ON 46
ci_48                -2.279210e-04 3 1  ON 47
ci_49                -1.541207e-03 3 1  ON 48
ci_50                -1.148189e-03 3 1  ON 49
ci_51                 5.602146e-04 3 1  ON 50
ci_52                 4.107052e-04 3 1  ON 51
ci_53                -9.375819e-04 3 1  ON 52
ci_54                -1.036391e-03 3 1  ON 53
ci_55                -1.007833e-04 3 1  ON 54
ci_56                 6.416428e-04 3 1  ON 55
ci_57                 1.704655e-03 3 1  ON 56
ci_58                -1.362752e-03 3 1  ON 57
ci_59                -1.200193e-03 3 1  ON 58
ci_60                 1.310420e-03 3 1  ON 59
ci_61                 1.112429e-03 3 1  ON 60
ci_62                -1.368107e-03 3 1  ON 61
ci_63                 1.043558e-04 3 1  ON 62
ci_64                -9.336307e-04 3 1  ON 63
ci_65                -5.138149e-04 3 1  ON 64
ci_66                -8.893228e-04 3 1  ON 65
ci_67                -7.044554e-04 3 1  ON 66
ci_68                -7.369562e-04 3 1  ON 67
ci_69                -1.367056e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8023
    reference variance = 0.449348
====================================================
  Execution time = 2.5461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5376e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8837e-01
  Total weights = 1.963864760e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473550231642
                                         uncertainty =       0.002852546826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473550231642
                                         uncertainty =       0.002852546826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486571659
  error estimate for blocks of size 2^( 2) =       0.000507692220
  error estimate for blocks of size 2^( 3) =       0.000527300348
  error estimate for blocks of size 2^( 4) =       0.000543043337
  error estimate for blocks of size 2^( 5) =       0.000551987826
  error estimate for blocks of size 2^( 6) =       0.000557395791
  error estimate for blocks of size 2^( 7) =       0.000559236130

      target function =                  N/A
              le_mean =     -22.818544406008
             les_mean =     521.174337284972
             stat err =       0.000552915771
             autocorr =       1.291291633592
              std dev =       0.688116238745
             le_variance =       0.473503958025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281854440601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818544405944       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818550208899       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818550272609       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818550377494       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 8.450392e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818544405944       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818546406914       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818546391738       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818546395099       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 2.669293e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818544405944       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818544958587       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818544952894       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818544952958       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 7.156199e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9977e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.162438e-01 3 1  ON 0
ci_02                -2.538382e-02 3 1  ON 1
ci_03                -2.559814e-02 3 1  ON 2
ci_04                 2.457393e-02 3 1  ON 3
ci_05                -2.278177e-02 3 1  ON 4
ci_06                -2.276241e-02 3 1  ON 5
ci_07                 2.645145e-02 3 1  ON 6
ci_08                -4.302004e-03 3 1  ON 7
ci_09                -1.043918e-02 3 1  ON 8
ci_10                -1.004508e-02 3 1  ON 9
ci_11                 1.585669e-02 3 1  ON 10
ci_12                 1.116347e-02 3 1  ON 11
ci_13                 1.068532e-02 3 1  ON 12
ci_14                 1.556629e-02 3 1  ON 13
ci_15                 8.682851e-03 3 1  ON 14
ci_16                 8.046676e-03 3 1  ON 15
ci_17                -9.632357e-03 3 1  ON 16
ci_18                -9.542491e-03 3 1  ON 17
ci_19                 9.015914e-03 3 1  ON 18
ci_20                 9.454717e-03 3 1  ON 19
ci_21                 8.144247e-03 3 1  ON 20
ci_22                 6.785365e-03 3 1  ON 21
ci_23                 6.227552e-03 3 1  ON 22
ci_24                 7.227591e-03 3 1  ON 23
ci_25                 5.302677e-03 3 1  ON 24
ci_26                 3.235191e-03 3 1  ON 25
ci_27                 3.591954e-03 3 1  ON 26
ci_28                 3.534303e-03 3 1  ON 27
ci_29                 3.567114e-03 3 1  ON 28
ci_30                 2.170999e-04 3 1  ON 29
ci_31                -7.609467e-04 3 1  ON 30
ci_32                -4.807827e-04 3 1  ON 31
ci_33                -5.770223e-04 3 1  ON 32
ci_34                 7.798657e-04 3 1  ON 33
ci_35                 3.362848e-04 3 1  ON 34
ci_36                -6.286801e-04 3 1  ON 35
ci_37                -1.208483e-03 3 1  ON 36
ci_38                -3.212612e-04 3 1  ON 37
ci_39                -4.400281e-04 3 1  ON 38
ci_40                -1.128447e-03 3 1  ON 39
ci_41                 3.166211e-04 3 1  ON 40
ci_42                 9.594842e-05 3 1  ON 41
ci_43                -1.715145e-03 3 1  ON 42
ci_44                -1.896354e-03 3 1  ON 43
ci_45                -7.974733e-05 3 1  ON 44
ci_46                -5.083246e-04 3 1  ON 45
ci_47                -1.622553e-03 3 1  ON 46
ci_48                -4.052641e-04 3 1  ON 47
ci_49                -1.547333e-03 3 1  ON 48
ci_50                -9.246767e-04 3 1  ON 49
ci_51                 4.601405e-04 3 1  ON 50
ci_52                 4.322629e-04 3 1  ON 51
ci_53                -9.095720e-04 3 1  ON 52
ci_54                -9.713691e-04 3 1  ON 53
ci_55                -2.133834e-04 3 1  ON 54
ci_56                 7.702044e-04 3 1  ON 55
ci_57                 1.620291e-03 3 1  ON 56
ci_58                -1.237190e-03 3 1  ON 57
ci_59                -1.124485e-03 3 1  ON 58
ci_60                 1.281606e-03 3 1  ON 59
ci_61                 1.139509e-03 3 1  ON 60
ci_62                -1.212639e-03 3 1  ON 61
ci_63                -6.306583e-06 3 1  ON 62
ci_64                -8.172318e-04 3 1  ON 63
ci_65                -4.555634e-04 3 1  ON 64
ci_66                -9.051265e-04 3 1  ON 65
ci_67                -5.325206e-04 3 1  ON 66
ci_68                -8.417737e-04 3 1  ON 67
ci_69                -1.332717e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8527
    reference variance = 0.444142
====================================================
  Execution time = 2.4868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9115e-01
  Total weights = 1.9637e+06
  Execution time = 3.5167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474362453903
                                         uncertainty =       0.002561890987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474362453903
                                         uncertainty =       0.002561890987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487015145
  error estimate for blocks of size 2^( 2) =       0.000509186744
  error estimate for blocks of size 2^( 3) =       0.000529402040
  error estimate for blocks of size 2^( 4) =       0.000545364688
  error estimate for blocks of size 2^( 5) =       0.000556028875
  error estimate for blocks of size 2^( 6) =       0.000562168816
  error estimate for blocks of size 2^( 7) =       0.000564926030

      target function =                  N/A
              le_mean =     -22.819347894893
             les_mean =     521.217246345588
             stat err =       0.000557122102
             autocorr =       1.308626899108
              std dev =       0.688743423023
             le_variance =       0.474367502758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474462894501
                                         uncertainty =       0.002583574559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474462894501
                                         uncertainty =       0.002583574559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487067344
  error estimate for blocks of size 2^( 2) =       0.000509235415
  error estimate for blocks of size 2^( 3) =       0.000529442512
  error estimate for blocks of size 2^( 4) =       0.000545413330
  error estimate for blocks of size 2^( 5) =       0.000556055206
  error estimate for blocks of size 2^( 6) =       0.000562177338
  error estimate for blocks of size 2^( 7) =       0.000564927096

      target function =                  N/A
              le_mean =     -22.819360158096
             les_mean =     521.243477574830
             stat err =       0.000557143242
             autocorr =       1.308445714326
              std dev =       0.688817243824
             le_variance =       0.474469195389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474390139902
                                         uncertainty =       0.002576287370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474390139902
                                         uncertainty =       0.002576287370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487029812
  error estimate for blocks of size 2^( 2) =       0.000509200002
  error estimate for blocks of size 2^( 3) =       0.000529408203
  error estimate for blocks of size 2^( 4) =       0.000545377913
  error estimate for blocks of size 2^( 5) =       0.000556033875
  error estimate for blocks of size 2^( 6) =       0.000562158762
  error estimate for blocks of size 2^( 7) =       0.000564889645

      target function =                  N/A
              le_mean =     -22.819350614470
             les_mean =     521.215048378967
             stat err =       0.000557115049
             autocorr =       1.308514947733
              std dev =       0.688764165058
             le_variance =       0.474396075068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474361779275
                                         uncertainty =       0.002563465023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474361779275
                                         uncertainty =       0.002563465023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487014856
  error estimate for blocks of size 2^( 2) =       0.000509186156
  error estimate for blocks of size 2^( 3) =       0.000529402189
  error estimate for blocks of size 2^( 4) =       0.000545365463
  error estimate for blocks of size 2^( 5) =       0.000556030934
  error estimate for blocks of size 2^( 6) =       0.000562178814
  error estimate for blocks of size 2^( 7) =       0.000564930329

      target function =                  N/A
              le_mean =     -22.819349637202
             les_mean =     521.309865285754
             stat err =       0.000557126385
             autocorr =       1.308648572082
              std dev =       0.688743014189
             le_variance =       0.474366939595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819347894893        initial
     3.7253e-01     3.7253e+00             8.4504e-04       -22.819360158096  <--
     1.4901e+00     1.4901e+01             2.6693e-04       -22.819350614470
     5.9605e+00     5.9605e+01             7.1562e-05       -22.819349637202

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 4.2448e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_01                 1.164239e-01 3 1  ON 0
ci_02                -2.563397e-02 3 1  ON 1
ci_03                -2.566465e-02 3 1  ON 2
ci_04                 2.459362e-02 3 1  ON 3
ci_05                -2.322193e-02 3 1  ON 4
ci_06                -2.218430e-02 3 1  ON 5
ci_07                 2.620750e-02 3 1  ON 6
ci_08                -4.332025e-03 3 1  ON 7
ci_09                -1.057680e-02 3 1  ON 8
ci_10                -1.009542e-02 3 1  ON 9
ci_11                 1.618764e-02 3 1  ON 10
ci_12                 1.094681e-02 3 1  ON 11
ci_13                 1.096571e-02 3 1  ON 12
ci_14                 1.556441e-02 3 1  ON 13
ci_15                 8.873154e-03 3 1  ON 14
ci_16                 7.900806e-03 3 1  ON 15
ci_17                -9.353710e-03 3 1  ON 16
ci_18                -9.260949e-03 3 1  ON 17
ci_19                 8.883543e-03 3 1  ON 18
ci_20                 9.625348e-03 3 1  ON 19
ci_21                 8.400563e-03 3 1  ON 20
ci_22                 6.888733e-03 3 1  ON 21
ci_23                 6.024691e-03 3 1  ON 22
ci_24                 7.219541e-03 3 1  ON 23
ci_25                 5.163232e-03 3 1  ON 24
ci_26                 2.969141e-03 3 1  ON 25
ci_27                 3.498037e-03 3 1  ON 26
ci_28                 3.771227e-03 3 1  ON 27
ci_29                 3.644685e-03 3 1  ON 28
ci_30                 3.095043e-04 3 1  ON 29
ci_31                -5.193677e-04 3 1  ON 30
ci_32                -6.260471e-04 3 1  ON 31
ci_33                -7.548210e-04 3 1  ON 32
ci_34                 5.796893e-04 3 1  ON 33
ci_35                 2.457624e-04 3 1  ON 34
ci_36                -7.546379e-04 3 1  ON 35
ci_37                -1.159293e-03 3 1  ON 36
ci_38                -4.155697e-04 3 1  ON 37
ci_39                -5.548575e-04 3 1  ON 38
ci_40                -1.289805e-03 3 1  ON 39
ci_41                 7.073186e-05 3 1  ON 40
ci_42                -3.636786e-04 3 1  ON 41
ci_43                -1.558395e-03 3 1  ON 42
ci_44                -1.921462e-03 3 1  ON 43
ci_45                -7.803780e-05 3 1  ON 44
ci_46                -9.021074e-04 3 1  ON 45
ci_47                -1.367740e-03 3 1  ON 46
ci_48                -7.768564e-04 3 1  ON 47
ci_49                -1.562792e-03 3 1  ON 48
ci_50                -5.970707e-04 3 1  ON 49
ci_51                 2.941695e-04 3 1  ON 50
ci_52                 4.785789e-04 3 1  ON 51
ci_53                -8.630899e-04 3 1  ON 52
ci_54                -8.274192e-04 3 1  ON 53
ci_55                -4.430312e-04 3 1  ON 54
ci_56                 9.927520e-04 3 1  ON 55
ci_57                 1.452636e-03 3 1  ON 56
ci_58                -9.754035e-04 3 1  ON 57
ci_59                -9.672635e-04 3 1  ON 58
ci_60                 1.204198e-03 3 1  ON 59
ci_61                 1.203384e-03 3 1  ON 60
ci_62                -9.601075e-04 3 1  ON 61
ci_63                -1.836422e-04 3 1  ON 62
ci_64                -6.087539e-04 3 1  ON 63
ci_65                -3.448452e-04 3 1  ON 64
ci_66                -9.454860e-04 3 1  ON 65
ci_67                -2.314172e-04 3 1  ON 66
ci_68                -1.041668e-03 3 1  ON 67
ci_69                -1.266598e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8268
    reference variance = 0.337496
====================================================
  Execution time = 2.5533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8671e-01
  Total weights = 1.963594176e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470914604882
                                         uncertainty =       0.002301564738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470914604882
                                         uncertainty =       0.002301564738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485222226
  error estimate for blocks of size 2^( 2) =       0.000506295250
  error estimate for blocks of size 2^( 3) =       0.000526645306
  error estimate for blocks of size 2^( 4) =       0.000541990900
  error estimate for blocks of size 2^( 5) =       0.000552454560
  error estimate for blocks of size 2^( 6) =       0.000559309893
  error estimate for blocks of size 2^( 7) =       0.000565512406

      target function =                  N/A
              le_mean =     -22.819484781968
             les_mean =     521.215594120168
             stat err =       0.000554816940
             autocorr =       1.307428817105
              std dev =       0.686207853039
             le_variance =       0.470881217572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281948478197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819484781898       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819504912568       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819505052226       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819505515280       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819505924731       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 1.914426e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819484781898       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819495334184       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819495192685       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819495214076       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 9.331172e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819484781898       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819488416548       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819488386060       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819488373470       residual = 5.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 3.054997e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0046e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.167498e-01 3 1  ON 0
ci_02                -2.525876e-02 3 1  ON 1
ci_03                -2.583591e-02 3 1  ON 2
ci_04                 2.458316e-02 3 1  ON 3
ci_05                -2.276457e-02 3 1  ON 4
ci_06                -2.225403e-02 3 1  ON 5
ci_07                 2.609833e-02 3 1  ON 6
ci_08                -3.984798e-03 3 1  ON 7
ci_09                -1.108891e-02 3 1  ON 8
ci_10                -1.003597e-02 3 1  ON 9
ci_11                 1.605952e-02 3 1  ON 10
ci_12                 1.089602e-02 3 1  ON 11
ci_13                 1.100203e-02 3 1  ON 12
ci_14                 1.587311e-02 3 1  ON 13
ci_15                 8.333674e-03 3 1  ON 14
ci_16                 7.809945e-03 3 1  ON 15
ci_17                -9.545924e-03 3 1  ON 16
ci_18                -9.247397e-03 3 1  ON 17
ci_19                 8.693058e-03 3 1  ON 18
ci_20                 9.669190e-03 3 1  ON 19
ci_21                 8.073047e-03 3 1  ON 20
ci_22                 7.140572e-03 3 1  ON 21
ci_23                 5.991264e-03 3 1  ON 22
ci_24                 7.047159e-03 3 1  ON 23
ci_25                 5.486934e-03 3 1  ON 24
ci_26                 2.036024e-03 3 1  ON 25
ci_27                 3.172942e-03 3 1  ON 26
ci_28                 3.556205e-03 3 1  ON 27
ci_29                 3.485460e-03 3 1  ON 28
ci_30                -1.040739e-04 3 1  ON 29
ci_31                -1.401417e-04 3 1  ON 30
ci_32                -7.868965e-04 3 1  ON 31
ci_33                -4.907536e-04 3 1  ON 32
ci_34                 5.801510e-04 3 1  ON 33
ci_35                 5.138422e-04 3 1  ON 34
ci_36                -1.033793e-03 3 1  ON 35
ci_37                -9.919315e-04 3 1  ON 36
ci_38                -3.901606e-04 3 1  ON 37
ci_39                -4.184558e-04 3 1  ON 38
ci_40                -1.531518e-03 3 1  ON 39
ci_41                 3.265817e-04 3 1  ON 40
ci_42                -4.363093e-05 3 1  ON 41
ci_43                -1.401970e-03 3 1  ON 42
ci_44                -1.296980e-03 3 1  ON 43
ci_45                -4.864394e-04 3 1  ON 44
ci_46                -5.871973e-04 3 1  ON 45
ci_47                -1.276425e-03 3 1  ON 46
ci_48                -4.917380e-04 3 1  ON 47
ci_49                -1.676318e-03 3 1  ON 48
ci_50                -1.172284e-03 3 1  ON 49
ci_51                 2.549793e-04 3 1  ON 50
ci_52                 6.395144e-04 3 1  ON 51
ci_53                -8.943773e-04 3 1  ON 52
ci_54                -7.237798e-04 3 1  ON 53
ci_55                -8.494042e-04 3 1  ON 54
ci_56                 1.125471e-03 3 1  ON 55
ci_57                 1.785159e-03 3 1  ON 56
ci_58                -1.211434e-03 3 1  ON 57
ci_59                -1.161215e-03 3 1  ON 58
ci_60                 1.150130e-03 3 1  ON 59
ci_61                 1.625356e-03 3 1  ON 60
ci_62                -6.238942e-04 3 1  ON 61
ci_63                -7.396229e-04 3 1  ON 62
ci_64                -6.982004e-04 3 1  ON 63
ci_65                -2.334855e-04 3 1  ON 64
ci_66                -1.187127e-03 3 1  ON 65
ci_67                -5.791195e-04 3 1  ON 66
ci_68                -1.225890e-03 3 1  ON 67
ci_69                -1.027893e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7914
    reference variance = 0.412917
====================================================
  Execution time = 2.7214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8275e-01
  Total weights = 1.9637e+06
  Execution time = 3.5105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468853031585
                                         uncertainty =       0.001888381116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468853031585
                                         uncertainty =       0.001888381116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484164411
  error estimate for blocks of size 2^( 2) =       0.000505813327
  error estimate for blocks of size 2^( 3) =       0.000526231443
  error estimate for blocks of size 2^( 4) =       0.000542450992
  error estimate for blocks of size 2^( 5) =       0.000552408267
  error estimate for blocks of size 2^( 6) =       0.000559995368
  error estimate for blocks of size 2^( 7) =       0.000565298724

      target function =                  N/A
              le_mean =     -22.818334679241
             les_mean =     521.160919550552
             stat err =       0.000555038337
             autocorr =       1.314196293582
              std dev =       0.684711875855
             le_variance =       0.468830352936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469332760302
                                         uncertainty =       0.001921435525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469332760302
                                         uncertainty =       0.001921435525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484412105
  error estimate for blocks of size 2^( 2) =       0.000506053463
  error estimate for blocks of size 2^( 3) =       0.000526455168
  error estimate for blocks of size 2^( 4) =       0.000542659168
  error estimate for blocks of size 2^( 5) =       0.000552604630
  error estimate for blocks of size 2^( 6) =       0.000560250264
  error estimate for blocks of size 2^( 7) =       0.000565566733

      target function =                  N/A
              le_mean =     -22.818348827635
             les_mean =     523.119420375679
             stat err =       0.000555270199
             autocorr =       1.313949752102
              std dev =       0.685062168527
             le_variance =       0.469310174747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469156892373
                                         uncertainty =       0.001903152600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469156892373
                                         uncertainty =       0.001903152600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484321664
  error estimate for blocks of size 2^( 2) =       0.000505964011
  error estimate for blocks of size 2^( 3) =       0.000526359448
  error estimate for blocks of size 2^( 4) =       0.000542566812
  error estimate for blocks of size 2^( 5) =       0.000552481853
  error estimate for blocks of size 2^( 6) =       0.000560103872
  error estimate for blocks of size 2^( 7) =       0.000565427090

      target function =                  N/A
              le_mean =     -22.818343415710
             les_mean =     521.162822253076
             stat err =       0.000555144907
             autocorr =       1.313847404391
              std dev =       0.684934266243
             le_variance =       0.469134949074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468858945078
                                         uncertainty =       0.001888900377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.468858945078
                                         uncertainty =       0.001888900377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484167513
  error estimate for blocks of size 2^( 2) =       0.000505818075
  error estimate for blocks of size 2^( 3) =       0.000526230672
  error estimate for blocks of size 2^( 4) =       0.000542448599
  error estimate for blocks of size 2^( 5) =       0.000552393669
  error estimate for blocks of size 2^( 6) =       0.000559986675
  error estimate for blocks of size 2^( 7) =       0.000565298084

      target function =                  N/A
              le_mean =     -22.818328282935
             les_mean =     521.176203835743
             stat err =       0.000555031757
             autocorr =       1.314148289908
              std dev =       0.684716263325
             le_variance =       0.468836361261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818334679241        initial
     9.3132e-02     9.3132e-01             1.9144e-03       -22.818348827635  <--
     3.7253e-01     3.7253e+00             9.3312e-04       -22.818343415710
     1.4901e+00     1.4901e+01             3.0550e-04       -22.818328282935

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 4.4733e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_01                 1.172788e-01 3 1  ON 0
ci_02                -2.480808e-02 3 1  ON 1
ci_03                -2.601115e-02 3 1  ON 2
ci_04                 2.461550e-02 3 1  ON 3
ci_05                -2.224163e-02 3 1  ON 4
ci_06                -2.228427e-02 3 1  ON 5
ci_07                 2.594633e-02 3 1  ON 6
ci_08                -3.739089e-03 3 1  ON 7
ci_09                -1.177306e-02 3 1  ON 8
ci_10                -1.004330e-02 3 1  ON 9
ci_11                 1.588727e-02 3 1  ON 10
ci_12                 1.083428e-02 3 1  ON 11
ci_13                 1.105119e-02 3 1  ON 12
ci_14                 1.648739e-02 3 1  ON 13
ci_15                 7.689351e-03 3 1  ON 14
ci_16                 7.764791e-03 3 1  ON 15
ci_17                -9.725866e-03 3 1  ON 16
ci_18                -9.267950e-03 3 1  ON 17
ci_19                 8.548514e-03 3 1  ON 18
ci_20                 9.695480e-03 3 1  ON 19
ci_21                 7.699888e-03 3 1  ON 20
ci_22                 7.441828e-03 3 1  ON 21
ci_23                 5.978159e-03 3 1  ON 22
ci_24                 6.795110e-03 3 1  ON 23
ci_25                 5.775532e-03 3 1  ON 24
ci_26                 1.054715e-03 3 1  ON 25
ci_27                 2.836188e-03 3 1  ON 26
ci_28                 3.353925e-03 3 1  ON 27
ci_29                 3.312114e-03 3 1  ON 28
ci_30                -5.822146e-04 3 1  ON 29
ci_31                 3.291058e-04 3 1  ON 30
ci_32                -9.043019e-04 3 1  ON 31
ci_33                -2.675669e-04 3 1  ON 32
ci_34                 5.706442e-04 3 1  ON 33
ci_35                 8.468089e-04 3 1  ON 34
ci_36                -1.257871e-03 3 1  ON 35
ci_37                -8.353421e-04 3 1  ON 36
ci_38                -3.545143e-04 3 1  ON 37
ci_39                -3.294809e-04 3 1  ON 38
ci_40                -1.690073e-03 3 1  ON 39
ci_41                 5.538709e-04 3 1  ON 40
ci_42                 2.221244e-04 3 1  ON 41
ci_43                -1.222947e-03 3 1  ON 42
ci_44                -6.633112e-04 3 1  ON 43
ci_45                -8.085234e-04 3 1  ON 44
ci_46                -3.182512e-04 3 1  ON 45
ci_47                -1.172088e-03 3 1  ON 46
ci_48                -1.568594e-04 3 1  ON 47
ci_49                -1.770322e-03 3 1  ON 48
ci_50                -1.488796e-03 3 1  ON 49
ci_51                 2.063127e-04 3 1  ON 50
ci_52                 7.677974e-04 3 1  ON 51
ci_53                -9.051732e-04 3 1  ON 52
ci_54                -6.168530e-04 3 1  ON 53
ci_55                -1.282824e-03 3 1  ON 54
ci_56                 1.241062e-03 3 1  ON 55
ci_57                 2.039820e-03 3 1  ON 56
ci_58                -1.437266e-03 3 1  ON 57
ci_59                -1.352813e-03 3 1  ON 58
ci_60                 1.081061e-03 3 1  ON 59
ci_61                 2.407426e-03 3 1  ON 60
ci_62                -3.679016e-04 3 1  ON 61
ci_63                -1.131238e-03 3 1  ON 62
ci_64                -7.804950e-04 3 1  ON 63
ci_65                -1.183486e-04 3 1  ON 64
ci_66                -1.347764e-03 3 1  ON 65
ci_67                -8.740793e-04 3 1  ON 66
ci_68                -1.453894e-03 3 1  ON 67
ci_69                -8.460846e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7248
    reference variance = 0.438059
====================================================
  Execution time = 2.5315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5376e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9411e-01
  Total weights = 1.963542995e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475400509225
                                         uncertainty =       0.002235311893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475400509225
                                         uncertainty =       0.002235311893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487520157
  error estimate for blocks of size 2^( 2) =       0.000508965067
  error estimate for blocks of size 2^( 3) =       0.000529334353
  error estimate for blocks of size 2^( 4) =       0.000545568413
  error estimate for blocks of size 2^( 5) =       0.000555509515
  error estimate for blocks of size 2^( 6) =       0.000560985775
  error estimate for blocks of size 2^( 7) =       0.000565508464

      target function =                  N/A
              le_mean =     -22.819211060790
             les_mean =     521.210499233569
             stat err =       0.000556893042
             autocorr =       1.304843509629
              std dev =       0.689457617746
             le_variance =       0.475351806668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281921106079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819211060722       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819253917529       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819262312120       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819263596630       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819263213500       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819263688548       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-02 is 5.573415e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819211060722       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819244039936       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819248006633       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819248291066       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819248141647       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 3.298916e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819211060722       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819228220210       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819229070449       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819229088456       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 1.272424e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9826e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.139798e-01 3 1  ON 0
ci_02                -2.561395e-02 3 1  ON 1
ci_03                -2.641088e-02 3 1  ON 2
ci_04                 2.517622e-02 3 1  ON 3
ci_05                -2.253546e-02 3 1  ON 4
ci_06                -2.220113e-02 3 1  ON 5
ci_07                 2.622007e-02 3 1  ON 6
ci_08                -4.426549e-03 3 1  ON 7
ci_09                -1.103730e-02 3 1  ON 8
ci_10                -1.138648e-02 3 1  ON 9
ci_11                 1.551438e-02 3 1  ON 10
ci_12                 1.150719e-02 3 1  ON 11
ci_13                 1.127728e-02 3 1  ON 12
ci_14                 1.633039e-02 3 1  ON 13
ci_15                 8.267162e-03 3 1  ON 14
ci_16                 7.039821e-03 3 1  ON 15
ci_17                -8.416448e-03 3 1  ON 16
ci_18                -9.215364e-03 3 1  ON 17
ci_19                 9.874519e-03 3 1  ON 18
ci_20                 9.673257e-03 3 1  ON 19
ci_21                 8.669347e-03 3 1  ON 20
ci_22                 8.126705e-03 3 1  ON 21
ci_23                 6.371891e-03 3 1  ON 22
ci_24                 6.467847e-03 3 1  ON 23
ci_25                 5.891476e-03 3 1  ON 24
ci_26                 1.801582e-03 3 1  ON 25
ci_27                 3.594309e-03 3 1  ON 26
ci_28                 4.282396e-03 3 1  ON 27
ci_29                 4.124554e-03 3 1  ON 28
ci_30                -9.162376e-04 3 1  ON 29
ci_31                -2.639735e-04 3 1  ON 30
ci_32                -5.908675e-04 3 1  ON 31
ci_33                -3.283037e-04 3 1  ON 32
ci_34                -3.230320e-04 3 1  ON 33
ci_35                -4.808594e-04 3 1  ON 34
ci_36                -1.254397e-03 3 1  ON 35
ci_37                -9.701473e-04 3 1  ON 36
ci_38                 3.544212e-04 3 1  ON 37
ci_39                 5.671423e-04 3 1  ON 38
ci_40                -2.417675e-03 3 1  ON 39
ci_41                 8.516732e-05 3 1  ON 40
ci_42                 3.655579e-04 3 1  ON 41
ci_43                -1.988679e-03 3 1  ON 42
ci_44                -1.344278e-03 3 1  ON 43
ci_45                -2.304670e-04 3 1  ON 44
ci_46                -1.882707e-04 3 1  ON 45
ci_47                -9.290140e-04 3 1  ON 46
ci_48                -9.446709e-04 3 1  ON 47
ci_49                -1.139201e-03 3 1  ON 48
ci_50                -6.740831e-04 3 1  ON 49
ci_51                -2.087706e-04 3 1  ON 50
ci_52                -6.178977e-05 3 1  ON 51
ci_53                -1.418594e-03 3 1  ON 52
ci_54                -4.043956e-04 3 1  ON 53
ci_55                -1.920885e-03 3 1  ON 54
ci_56                 1.934172e-03 3 1  ON 55
ci_57                 1.411724e-03 3 1  ON 56
ci_58                -1.505469e-03 3 1  ON 57
ci_59                -7.729256e-04 3 1  ON 58
ci_60                 1.512656e-03 3 1  ON 59
ci_61                 1.876141e-03 3 1  ON 60
ci_62                -7.472180e-04 3 1  ON 61
ci_63                -4.561128e-04 3 1  ON 62
ci_64                -1.862475e-04 3 1  ON 63
ci_65                -2.126498e-04 3 1  ON 64
ci_66                -1.112556e-03 3 1  ON 65
ci_67                -8.634023e-04 3 1  ON 66
ci_68                -1.425534e-03 3 1  ON 67
ci_69                -1.491741e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7599
    reference variance = 0.307405
====================================================
  Execution time = 2.4692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8892e-01
  Total weights = 1.9636e+06
  Execution time = 3.5330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00875147
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473565117258
                                         uncertainty =       0.003321124000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473565117258
                                         uncertainty =       0.003321124000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486584731
  error estimate for blocks of size 2^( 2) =       0.000507819690
  error estimate for blocks of size 2^( 3) =       0.000528451997
  error estimate for blocks of size 2^( 4) =       0.000543760950
  error estimate for blocks of size 2^( 5) =       0.000553114488
  error estimate for blocks of size 2^( 6) =       0.000558605591
  error estimate for blocks of size 2^( 7) =       0.000563527488

      target function =                  N/A
              le_mean =     -22.818963207471
             les_mean =     521.273459541661
             stat err =       0.000554752129
             autocorr =       1.299813379401
              std dev =       0.688134725304
             le_variance =       0.473529400169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472456821949
                                         uncertainty =       0.002868674987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472456821949
                                         uncertainty =       0.002868674987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486014894
  error estimate for blocks of size 2^( 2) =       0.000507296046
  error estimate for blocks of size 2^( 3) =       0.000527988455
  error estimate for blocks of size 2^( 4) =       0.000543370897
  error estimate for blocks of size 2^( 5) =       0.000552763192
  error estimate for blocks of size 2^( 6) =       0.000558304192
  error estimate for blocks of size 2^( 7) =       0.000563307435

      target function =                  N/A
              le_mean =     -22.818913949467
             les_mean =     521.205718473662
             stat err =       0.000554436429
             autocorr =       1.301380690788
              std dev =       0.687328854488
             le_variance =       0.472420954212

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00857726
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.843342599399
                                         uncertainty =       0.367129990334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.843342599399
                                         uncertainty =       0.367129990334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000648876425
  error estimate for blocks of size 2^( 2) =       0.000664832508
  error estimate for blocks of size 2^( 3) =       0.000680681697
  error estimate for blocks of size 2^( 4) =       0.000692396270
  error estimate for blocks of size 2^( 5) =       0.000698377860
  error estimate for blocks of size 2^( 6) =       0.000702653996
  error estimate for blocks of size 2^( 7) =       0.000711880517

      target function =                  N/A
              le_mean =     -22.818514099440
             les_mean =     533.317668930399
             stat err =       0.000701327161
             autocorr =       1.168200332162
              std dev =       0.917649840557
             le_variance =       0.842081229874

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.142287
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472945854619
                                         uncertainty =       0.003130419290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472945854619
                                         uncertainty =       0.003130419290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486266658
  error estimate for blocks of size 2^( 2) =       0.000507521452
  error estimate for blocks of size 2^( 3) =       0.000528180071
  error estimate for blocks of size 2^( 4) =       0.000543510217
  error estimate for blocks of size 2^( 5) =       0.000552884728
  error estimate for blocks of size 2^( 6) =       0.000558428619
  error estimate for blocks of size 2^( 7) =       0.000563369487

      target function =                  N/A
              le_mean =     -22.818922798840
             les_mean =     521.358855460551
             stat err =       0.000554548262
             autocorr =       1.300557967410
              std dev =       0.687684902212
             le_variance =       0.472910524730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818963207471        initial  <--
     2.3283e-02     2.3283e-01             5.5734e-03       -22.818913949467
     9.3132e-02     9.3132e-01             3.2989e-03       -22.818514099440
     3.7253e-01     3.7253e+00             1.2724e-03       -22.818922798840

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2314
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_01                 1.172788e-01 3 1  ON 0
ci_02                -2.480808e-02 3 1  ON 1
ci_03                -2.601115e-02 3 1  ON 2
ci_04                 2.461550e-02 3 1  ON 3
ci_05                -2.224163e-02 3 1  ON 4
ci_06                -2.228427e-02 3 1  ON 5
ci_07                 2.594633e-02 3 1  ON 6
ci_08                -3.739089e-03 3 1  ON 7
ci_09                -1.177306e-02 3 1  ON 8
ci_10                -1.004330e-02 3 1  ON 9
ci_11                 1.588727e-02 3 1  ON 10
ci_12                 1.083428e-02 3 1  ON 11
ci_13                 1.105119e-02 3 1  ON 12
ci_14                 1.648739e-02 3 1  ON 13
ci_15                 7.689351e-03 3 1  ON 14
ci_16                 7.764791e-03 3 1  ON 15
ci_17                -9.725866e-03 3 1  ON 16
ci_18                -9.267950e-03 3 1  ON 17
ci_19                 8.548514e-03 3 1  ON 18
ci_20                 9.695480e-03 3 1  ON 19
ci_21                 7.699888e-03 3 1  ON 20
ci_22                 7.441828e-03 3 1  ON 21
ci_23                 5.978159e-03 3 1  ON 22
ci_24                 6.795110e-03 3 1  ON 23
ci_25                 5.775532e-03 3 1  ON 24
ci_26                 1.054715e-03 3 1  ON 25
ci_27                 2.836188e-03 3 1  ON 26
ci_28                 3.353925e-03 3 1  ON 27
ci_29                 3.312114e-03 3 1  ON 28
ci_30                -5.822146e-04 3 1  ON 29
ci_31                 3.291058e-04 3 1  ON 30
ci_32                -9.043019e-04 3 1  ON 31
ci_33                -2.675669e-04 3 1  ON 32
ci_34                 5.706442e-04 3 1  ON 33
ci_35                 8.468089e-04 3 1  ON 34
ci_36                -1.257871e-03 3 1  ON 35
ci_37                -8.353421e-04 3 1  ON 36
ci_38                -3.545143e-04 3 1  ON 37
ci_39                -3.294809e-04 3 1  ON 38
ci_40                -1.690073e-03 3 1  ON 39
ci_41                 5.538709e-04 3 1  ON 40
ci_42                 2.221244e-04 3 1  ON 41
ci_43                -1.222947e-03 3 1  ON 42
ci_44                -6.633112e-04 3 1  ON 43
ci_45                -8.085234e-04 3 1  ON 44
ci_46                -3.182512e-04 3 1  ON 45
ci_47                -1.172088e-03 3 1  ON 46
ci_48                -1.568594e-04 3 1  ON 47
ci_49                -1.770322e-03 3 1  ON 48
ci_50                -1.488796e-03 3 1  ON 49
ci_51                 2.063127e-04 3 1  ON 50
ci_52                 7.677974e-04 3 1  ON 51
ci_53                -9.051732e-04 3 1  ON 52
ci_54                -6.168530e-04 3 1  ON 53
ci_55                -1.282824e-03 3 1  ON 54
ci_56                 1.241062e-03 3 1  ON 55
ci_57                 2.039820e-03 3 1  ON 56
ci_58                -1.437266e-03 3 1  ON 57
ci_59                -1.352813e-03 3 1  ON 58
ci_60                 1.081061e-03 3 1  ON 59
ci_61                 2.407426e-03 3 1  ON 60
ci_62                -3.679016e-04 3 1  ON 61
ci_63                -1.131238e-03 3 1  ON 62
ci_64                -7.804950e-04 3 1  ON 63
ci_65                -1.183486e-04 3 1  ON 64
ci_66                -1.347764e-03 3 1  ON 65
ci_67                -8.740793e-04 3 1  ON 66
ci_68                -1.453894e-03 3 1  ON 67
ci_69                -8.460846e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7545
    reference variance = 0.373298
====================================================
  Execution time = 2.5389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8323e-01
  Total weights = 1.963467421e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469041182413
                                         uncertainty =       0.002211344358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469041182413
                                         uncertainty =       0.002211344358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484249687
  error estimate for blocks of size 2^( 2) =       0.000506214817
  error estimate for blocks of size 2^( 3) =       0.000526900516
  error estimate for blocks of size 2^( 4) =       0.000543559864
  error estimate for blocks of size 2^( 5) =       0.000554936662
  error estimate for blocks of size 2^( 6) =       0.000563215926
  error estimate for blocks of size 2^( 7) =       0.000570775112

      target function =                  N/A
              le_mean =     -22.818884703098
             les_mean =     521.184733495812
             stat err =       0.000558121891
             autocorr =       1.328371092373
              std dev =       0.684832475466
             le_variance =       0.468995519453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281888470310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818884703025       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818915576718       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818916035590       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818916329068       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 1.090121e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818884703025       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818896947755       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818897112156       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818897159722       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 4.450545e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818884703025       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818888290093       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818888362114       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818888372086       residual = 1.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 1.322767e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9916e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.171295e-01 3 1  ON 0
ci_02                -2.498792e-02 3 1  ON 1
ci_03                -2.606205e-02 3 1  ON 2
ci_04                 2.473732e-02 3 1  ON 3
ci_05                -2.237606e-02 3 1  ON 4
ci_06                -2.243990e-02 3 1  ON 5
ci_07                 2.592681e-02 3 1  ON 6
ci_08                -3.958078e-03 3 1  ON 7
ci_09                -1.171836e-02 3 1  ON 8
ci_10                -1.034294e-02 3 1  ON 9
ci_11                 1.585816e-02 3 1  ON 10
ci_12                 1.098563e-02 3 1  ON 11
ci_13                 1.108021e-02 3 1  ON 12
ci_14                 1.634664e-02 3 1  ON 13
ci_15                 7.686500e-03 3 1  ON 14
ci_16                 7.772202e-03 3 1  ON 15
ci_17                -9.886185e-03 3 1  ON 16
ci_18                -9.207578e-03 3 1  ON 17
ci_19                 8.933295e-03 3 1  ON 18
ci_20                 9.763369e-03 3 1  ON 19
ci_21                 7.814065e-03 3 1  ON 20
ci_22                 7.712034e-03 3 1  ON 21
ci_23                 6.137929e-03 3 1  ON 22
ci_24                 6.741999e-03 3 1  ON 23
ci_25                 5.838156e-03 3 1  ON 24
ci_26                 1.410061e-03 3 1  ON 25
ci_27                 2.835261e-03 3 1  ON 26
ci_28                 3.377812e-03 3 1  ON 27
ci_29                 3.408998e-03 3 1  ON 28
ci_30                -3.737438e-04 3 1  ON 29
ci_31                 4.855861e-04 3 1  ON 30
ci_32                -4.592474e-04 3 1  ON 31
ci_33                 1.790467e-05 3 1  ON 32
ci_34                 4.897264e-04 3 1  ON 33
ci_35                 7.480078e-04 3 1  ON 34
ci_36                -1.022048e-03 3 1  ON 35
ci_37                -1.073106e-03 3 1  ON 36
ci_38                -3.084646e-04 3 1  ON 37
ci_39                -3.385991e-04 3 1  ON 38
ci_40                -1.524072e-03 3 1  ON 39
ci_41                 6.118835e-04 3 1  ON 40
ci_42                 3.553205e-04 3 1  ON 41
ci_43                -1.282152e-03 3 1  ON 42
ci_44                -9.841694e-04 3 1  ON 43
ci_45                -6.295838e-04 3 1  ON 44
ci_46                -2.290726e-04 3 1  ON 45
ci_47                -1.126346e-03 3 1  ON 46
ci_48                -1.737195e-04 3 1  ON 47
ci_49                -1.726765e-03 3 1  ON 48
ci_50                -1.151557e-03 3 1  ON 49
ci_51                 2.561868e-06 3 1  ON 50
ci_52                 4.554897e-04 3 1  ON 51
ci_53                -8.258141e-04 3 1  ON 52
ci_54                -6.167997e-04 3 1  ON 53
ci_55                -1.327560e-03 3 1  ON 54
ci_56                 1.074698e-03 3 1  ON 55
ci_57                 1.950712e-03 3 1  ON 56
ci_58                -1.354971e-03 3 1  ON 57
ci_59                -1.596362e-03 3 1  ON 58
ci_60                 9.676303e-04 3 1  ON 59
ci_61                 2.426824e-03 3 1  ON 60
ci_62                -5.640338e-04 3 1  ON 61
ci_63                -9.887991e-04 3 1  ON 62
ci_64                -6.028925e-04 3 1  ON 63
ci_65                -3.852938e-04 3 1  ON 64
ci_66                -1.283028e-03 3 1  ON 65
ci_67                -7.812823e-04 3 1  ON 66
ci_68                -1.411314e-03 3 1  ON 67
ci_69                -9.305307e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -23.0298
    reference variance = 0.733097
====================================================
  Execution time = 2.4835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8589e-01
  Total weights = 1.9640e+06
  Execution time = 3.4861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470751010567
                                         uncertainty =       0.002368288665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470751010567
                                         uncertainty =       0.002368288665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485188670
  error estimate for blocks of size 2^( 2) =       0.000506438884
  error estimate for blocks of size 2^( 3) =       0.000526652480
  error estimate for blocks of size 2^( 4) =       0.000541757768
  error estimate for blocks of size 2^( 5) =       0.000551190293
  error estimate for blocks of size 2^( 6) =       0.000556095935
  error estimate for blocks of size 2^( 7) =       0.000557266948

      target function =                  N/A
              le_mean =     -22.819069661069
             les_mean =     521.242109592525
             stat err =       0.000551577736
             autocorr =       1.292385731242
              std dev =       0.686160397330
             le_variance =       0.470816090864

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.118345
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470875813903
                                         uncertainty =       0.002382699837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470875813903
                                         uncertainty =       0.002382699837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485253480
  error estimate for blocks of size 2^( 2) =       0.000506486657
  error estimate for blocks of size 2^( 3) =       0.000526710427
  error estimate for blocks of size 2^( 4) =       0.000541802734
  error estimate for blocks of size 2^( 5) =       0.000551209702
  error estimate for blocks of size 2^( 6) =       0.000556113784
  error estimate for blocks of size 2^( 7) =       0.000557274933

      target function =                  N/A
              le_mean =     -22.819084230351
             les_mean =     521.223054896871
             stat err =       0.000551600288
             autocorr =       1.292146190450
              std dev =       0.686252052598
             le_variance =       0.470941879696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470759149580
                                         uncertainty =       0.002376340497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470759149580
                                         uncertainty =       0.002376340497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485193320
  error estimate for blocks of size 2^( 2) =       0.000506438243
  error estimate for blocks of size 2^( 3) =       0.000526665543
  error estimate for blocks of size 2^( 4) =       0.000541763992
  error estimate for blocks of size 2^( 5) =       0.000551188515
  error estimate for blocks of size 2^( 6) =       0.000556113716
  error estimate for blocks of size 2^( 7) =       0.000557310037

      target function =                  N/A
              le_mean =     -22.819080223636
             les_mean =     521.201711023972
             stat err =       0.000551594065
             autocorr =       1.292437479249
              std dev =       0.686166973249
             le_variance =       0.470825115178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470698690626
                                         uncertainty =       0.002368973073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470698690626
                                         uncertainty =       0.002368973073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485161795
  error estimate for blocks of size 2^( 2) =       0.000506410524
  error estimate for blocks of size 2^( 3) =       0.000526629309
  error estimate for blocks of size 2^( 4) =       0.000541732161
  error estimate for blocks of size 2^( 5) =       0.000551165749
  error estimate for blocks of size 2^( 6) =       0.000556064485
  error estimate for blocks of size 2^( 7) =       0.000557253029

      target function =                  N/A
              le_mean =     -22.819073184262
             les_mean =     521.204036514410
             stat err =       0.000551553856
             autocorr =       1.292417001910
              std dev =       0.686122389773
             le_variance =       0.470763933748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819069661069        initial
     2.3283e-01     2.3283e+00             1.0901e-03       -22.819084230351  <--
     9.3132e-01     9.3132e+00             4.4505e-04       -22.819080223636
     3.7253e+00     3.7253e+01             1.3228e-04       -22.819073184262

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 4.2279e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_01                 1.168024e-01 3 1  ON 0
ci_02                -2.530364e-02 3 1  ON 1
ci_03                -2.614948e-02 3 1  ON 2
ci_04                 2.494805e-02 3 1  ON 3
ci_05                -2.263851e-02 3 1  ON 4
ci_06                -2.273363e-02 3 1  ON 5
ci_07                 2.587467e-02 3 1  ON 6
ci_08                -4.247426e-03 3 1  ON 7
ci_09                -1.161884e-02 3 1  ON 8
ci_10                -1.089013e-02 3 1  ON 9
ci_11                 1.581021e-02 3 1  ON 10
ci_12                 1.123218e-02 3 1  ON 11
ci_13                 1.122477e-02 3 1  ON 12
ci_14                 1.602929e-02 3 1  ON 13
ci_15                 7.681726e-03 3 1  ON 14
ci_16                 7.730909e-03 3 1  ON 15
ci_17                -1.017711e-02 3 1  ON 16
ci_18                -9.091139e-03 3 1  ON 17
ci_19                 9.487186e-03 3 1  ON 18
ci_20                 9.867402e-03 3 1  ON 19
ci_21                 8.005694e-03 3 1  ON 20
ci_22                 8.195285e-03 3 1  ON 21
ci_23                 6.363834e-03 3 1  ON 22
ci_24                 6.647589e-03 3 1  ON 23
ci_25                 5.935288e-03 3 1  ON 24
ci_26                 2.007213e-03 3 1  ON 25
ci_27                 2.820552e-03 3 1  ON 26
ci_28                 3.402890e-03 3 1  ON 27
ci_29                 3.581775e-03 3 1  ON 28
ci_30                 1.671333e-05 3 1  ON 29
ci_31                 7.778897e-04 3 1  ON 30
ci_32                 1.858187e-04 3 1  ON 31
ci_33                 4.188933e-04 3 1  ON 32
ci_34                 3.552441e-04 3 1  ON 33
ci_35                 5.645236e-04 3 1  ON 34
ci_36                -7.136829e-04 3 1  ON 35
ci_37                -1.418732e-03 3 1  ON 36
ci_38                -2.641372e-04 3 1  ON 37
ci_39                -3.335037e-04 3 1  ON 38
ci_40                -1.328991e-03 3 1  ON 39
ci_41                 6.663623e-04 3 1  ON 40
ci_42                 5.387894e-04 3 1  ON 41
ci_43                -1.360885e-03 3 1  ON 42
ci_44                -1.539850e-03 3 1  ON 43
ci_45                -3.611376e-04 3 1  ON 44
ci_46                -1.190211e-04 3 1  ON 45
ci_47                -1.005419e-03 3 1  ON 46
ci_48                -1.520688e-04 3 1  ON 47
ci_49                -1.658790e-03 3 1  ON 48
ci_50                -7.790748e-04 3 1  ON 49
ci_51                -2.790645e-04 3 1  ON 50
ci_52                 1.467867e-05 3 1  ON 51
ci_53                -7.274541e-04 3 1  ON 52
ci_54                -6.219248e-04 3 1  ON 53
ci_55                -1.387429e-03 3 1  ON 54
ci_56                 8.314954e-04 3 1  ON 55
ci_57                 1.834186e-03 3 1  ON 56
ci_58                -1.218971e-03 3 1  ON 57
ci_59                -2.004950e-03 3 1  ON 58
ci_60                 6.941912e-04 3 1  ON 59
ci_61                 2.473268e-03 3 1  ON 60
ci_62                -8.298684e-04 3 1  ON 61
ci_63                -8.139890e-04 3 1  ON 62
ci_64                -3.245321e-04 3 1  ON 63
ci_65                -8.068913e-04 3 1  ON 64
ci_66                -1.206692e-03 3 1  ON 65
ci_67                -6.536631e-04 3 1  ON 66
ci_68                -1.314825e-03 3 1  ON 67
ci_69                -1.054878e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7992
    reference variance = 0.385504
====================================================
  Execution time = 2.5461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 5.0439e-01
  Total weights = 1.964052979e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471791311471
                                         uncertainty =       0.002577813297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471791311471
                                         uncertainty =       0.002577813297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485791619
  error estimate for blocks of size 2^( 2) =       0.000507138084
  error estimate for blocks of size 2^( 3) =       0.000527139928
  error estimate for blocks of size 2^( 4) =       0.000543021558
  error estimate for blocks of size 2^( 5) =       0.000554761879
  error estimate for blocks of size 2^( 6) =       0.000559555805
  error estimate for blocks of size 2^( 7) =       0.000561749741

      target function =                  N/A
              le_mean =     -22.819455517868
             les_mean =     521.231935446185
             stat err =       0.000554772246
             autocorr =       1.304155618564
              std dev =       0.687013095590
             le_variance =       0.471986993512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281945551787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819455517769       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819477199258       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819478737685       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819477176087       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819477509839       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-02 is 1.862017e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819455517769       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819468869245       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819469189132       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819468936823       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 1.065169e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819455517769       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819460780882       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819460756218       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819460749314       residual = 5.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 4.373393e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9964e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.164973e-01 3 1  ON 0
ci_02                -2.577321e-02 3 1  ON 1
ci_03                -2.581954e-02 3 1  ON 2
ci_04                 2.508426e-02 3 1  ON 3
ci_05                -2.288149e-02 3 1  ON 4
ci_06                -2.246647e-02 3 1  ON 5
ci_07                 2.651624e-02 3 1  ON 6
ci_08                -4.476762e-03 3 1  ON 7
ci_09                -1.214795e-02 3 1  ON 8
ci_10                -1.096664e-02 3 1  ON 9
ci_11                 1.574076e-02 3 1  ON 10
ci_12                 1.098652e-02 3 1  ON 11
ci_13                 1.159663e-02 3 1  ON 12
ci_14                 1.641815e-02 3 1  ON 13
ci_15                 7.608655e-03 3 1  ON 14
ci_16                 7.334746e-03 3 1  ON 15
ci_17                -1.021129e-02 3 1  ON 16
ci_18                -9.196999e-03 3 1  ON 17
ci_19                 9.532782e-03 3 1  ON 18
ci_20                 1.067589e-02 3 1  ON 19
ci_21                 8.109142e-03 3 1  ON 20
ci_22                 7.823855e-03 3 1  ON 21
ci_23                 6.026534e-03 3 1  ON 22
ci_24                 6.811821e-03 3 1  ON 23
ci_25                 5.370142e-03 3 1  ON 24
ci_26                 1.200899e-03 3 1  ON 25
ci_27                 3.027257e-03 3 1  ON 26
ci_28                 3.878424e-03 3 1  ON 27
ci_29                 3.608992e-03 3 1  ON 28
ci_30                 1.875795e-04 3 1  ON 29
ci_31                 1.900226e-04 3 1  ON 30
ci_32                -2.192224e-04 3 1  ON 31
ci_33                -6.462757e-04 3 1  ON 32
ci_34                 7.560494e-04 3 1  ON 33
ci_35                 3.009798e-04 3 1  ON 34
ci_36                -1.042227e-03 3 1  ON 35
ci_37                -1.095895e-03 3 1  ON 36
ci_38                 6.502742e-04 3 1  ON 37
ci_39                -1.130181e-04 3 1  ON 38
ci_40                -2.176520e-03 3 1  ON 39
ci_41                 9.293567e-04 3 1  ON 40
ci_42                 2.459129e-04 3 1  ON 41
ci_43                -1.677917e-03 3 1  ON 42
ci_44                -2.587373e-03 3 1  ON 43
ci_45                -5.939696e-04 3 1  ON 44
ci_46                -1.190402e-05 3 1  ON 45
ci_47                -1.167494e-03 3 1  ON 46
ci_48                 2.784839e-04 3 1  ON 47
ci_49                -1.501818e-03 3 1  ON 48
ci_50                -1.055873e-03 3 1  ON 49
ci_51                 3.180551e-04 3 1  ON 50
ci_52                 2.085831e-04 3 1  ON 51
ci_53                -9.282935e-04 3 1  ON 52
ci_54                -3.396211e-04 3 1  ON 53
ci_55                -1.159319e-03 3 1  ON 54
ci_56                 7.381479e-04 3 1  ON 55
ci_57                 1.496371e-03 3 1  ON 56
ci_58                -9.083060e-04 3 1  ON 57
ci_59                -1.618076e-03 3 1  ON 58
ci_60                 7.863902e-04 3 1  ON 59
ci_61                 1.962581e-03 3 1  ON 60
ci_62                -6.899018e-04 3 1  ON 61
ci_63                -3.666793e-05 3 1  ON 62
ci_64                -3.454582e-04 3 1  ON 63
ci_65                -1.256835e-03 3 1  ON 64
ci_66                -6.699938e-04 3 1  ON 65
ci_67                -2.873070e-04 3 1  ON 66
ci_68                -3.673844e-04 3 1  ON 67
ci_69                -4.760924e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8294
    reference variance = 0.46545
====================================================
  Execution time = 2.4863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8601e-01
  Total weights = 1.9640e+06
  Execution time = 3.4855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474614047154
                                         uncertainty =       0.004452451909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474614047154
                                         uncertainty =       0.004452451909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487094728
  error estimate for blocks of size 2^( 2) =       0.000508413594
  error estimate for blocks of size 2^( 3) =       0.000529101909
  error estimate for blocks of size 2^( 4) =       0.000544314199
  error estimate for blocks of size 2^( 5) =       0.000554876206
  error estimate for blocks of size 2^( 6) =       0.000562321756
  error estimate for blocks of size 2^( 7) =       0.000566435954

      target function =                  N/A
              le_mean =     -22.819426713254
             les_mean =     521.727793311969
             stat err =       0.000556987029
             autocorr =       1.307565050807
              std dev =       0.688855970963
             le_variance =       0.474522548732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471703503225
                                         uncertainty =       0.003601161559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471703503225
                                         uncertainty =       0.003601161559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485603598
  error estimate for blocks of size 2^( 2) =       0.000506987754
  error estimate for blocks of size 2^( 3) =       0.000527769600
  error estimate for blocks of size 2^( 4) =       0.000543135367
  error estimate for blocks of size 2^( 5) =       0.000553679020
  error estimate for blocks of size 2^( 6) =       0.000561109005
  error estimate for blocks of size 2^( 7) =       0.000565202370

      target function =                  N/A
              le_mean =     -22.819434093309
             les_mean =     521.259450649500
             stat err =       0.000555781441
             autocorr =       1.309918537397
              std dev =       0.686747194500
             le_variance =       0.471621709153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481388422224
                                         uncertainty =       0.008746018909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.481388422224
                                         uncertainty =       0.008746018909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490555177
  error estimate for blocks of size 2^( 2) =       0.000511767809
  error estimate for blocks of size 2^( 3) =       0.000532384621
  error estimate for blocks of size 2^( 4) =       0.000547493402
  error estimate for blocks of size 2^( 5) =       0.000557978272
  error estimate for blocks of size 2^( 6) =       0.000565362148
  error estimate for blocks of size 2^( 7) =       0.000569700456

      target function =                  N/A
              le_mean =     -22.819415475032
             les_mean =     522.063584366323
             stat err =       0.000560133569
             autocorr =       1.303789487233
              std dev =       0.693749785018
             le_variance =       0.481288764212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474485162039
                                         uncertainty =       0.005118764405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474485162039
                                         uncertainty =       0.005118764405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487029636
  error estimate for blocks of size 2^( 2) =       0.000508311345
  error estimate for blocks of size 2^( 3) =       0.000528981420
  error estimate for blocks of size 2^( 4) =       0.000544376023
  error estimate for blocks of size 2^( 5) =       0.000554743161
  error estimate for blocks of size 2^( 6) =       0.000562213596
  error estimate for blocks of size 2^( 7) =       0.000566111171

      target function =                  N/A
              le_mean =     -22.819399743798
             les_mean =     521.344995944631
             stat err =       0.000556860988
             autocorr =       1.307322719399
              std dev =       0.688763916366
             le_variance =       0.474395732488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819426713254        initial
     5.8208e-02     5.8208e-01             1.8620e-03       -22.819434093309  <--
     2.3283e-01     2.3283e+00             1.0652e-03       -22.819415475032
     9.3132e-01     9.3132e+00             4.3734e-04       -22.819399743798

*****************************************************************************
Applying the update for shift_i =   5.8208e-02     and shift_s =   5.8208e-01
*****************************************************************************

  Execution time = 4.2350e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_01                 1.160810e-01 3 1  ON 0
ci_02                -2.619112e-02 3 1  ON 1
ci_03                -2.554507e-02 3 1  ON 2
ci_04                 2.512666e-02 3 1  ON 3
ci_05                -2.314810e-02 3 1  ON 4
ci_06                -2.231894e-02 3 1  ON 5
ci_07                 2.699910e-02 3 1  ON 6
ci_08                -4.572741e-03 3 1  ON 7
ci_09                -1.263717e-02 3 1  ON 8
ci_10                -1.111705e-02 3 1  ON 9
ci_11                 1.563662e-02 3 1  ON 10
ci_12                 1.082780e-02 3 1  ON 11
ci_13                 1.187688e-02 3 1  ON 12
ci_14                 1.677122e-02 3 1  ON 13
ci_15                 7.489126e-03 3 1  ON 14
ci_16                 7.047912e-03 3 1  ON 15
ci_17                -1.025685e-02 3 1  ON 16
ci_18                -9.227660e-03 3 1  ON 17
ci_19                 9.546055e-03 3 1  ON 18
ci_20                 1.128136e-02 3 1  ON 19
ci_21                 8.230535e-03 3 1  ON 20
ci_22                 7.678285e-03 3 1  ON 21
ci_23                 5.859760e-03 3 1  ON 22
ci_24                 6.989362e-03 3 1  ON 23
ci_25                 5.025179e-03 3 1  ON 24
ci_26                 5.827097e-04 3 1  ON 25
ci_27                 3.129895e-03 3 1  ON 26
ci_28                 4.220511e-03 3 1  ON 27
ci_29                 3.665271e-03 3 1  ON 28
ci_30                 3.892966e-04 3 1  ON 29
ci_31                -3.776340e-04 3 1  ON 30
ci_32                -4.535389e-04 3 1  ON 31
ci_33                -1.247031e-03 3 1  ON 32
ci_34                 1.118571e-03 3 1  ON 33
ci_35                 9.413969e-05 3 1  ON 34
ci_36                -1.259807e-03 3 1  ON 35
ci_37                -9.100204e-04 3 1  ON 36
ci_38                 1.175981e-03 3 1  ON 37
ci_39                 1.944179e-05 3 1  ON 38
ci_40                -2.539414e-03 3 1  ON 39
ci_41                 1.081187e-03 3 1  ON 40
ci_42                 9.058706e-05 3 1  ON 41
ci_43                -2.001361e-03 3 1  ON 42
ci_44                -3.401867e-03 3 1  ON 43
ci_45                -7.567794e-04 3 1  ON 44
ci_46                 3.505941e-05 3 1  ON 45
ci_47                -1.409277e-03 3 1  ON 46
ci_48                 5.977426e-04 3 1  ON 47
ci_49                -1.416418e-03 3 1  ON 48
ci_50                -1.155950e-03 3 1  ON 49
ci_51                 6.357360e-04 3 1  ON 50
ci_52                 3.006942e-04 3 1  ON 51
ci_53                -9.988961e-04 3 1  ON 52
ci_54                -1.532442e-04 3 1  ON 53
ci_55                -1.006909e-03 3 1  ON 54
ci_56                 6.473223e-04 3 1  ON 55
ci_57                 1.301658e-03 3 1  ON 56
ci_58                -6.874478e-04 3 1  ON 57
ci_59                -1.319810e-03 3 1  ON 58
ci_60                 9.386412e-04 3 1  ON 59
ci_61                 1.301189e-03 3 1  ON 60
ci_62                -6.269245e-04 3 1  ON 61
ci_63                 3.462294e-04 3 1  ON 62
ci_64                -3.679925e-04 3 1  ON 63
ci_65                -1.577659e-03 3 1  ON 64
ci_66                -3.770208e-04 3 1  ON 65
ci_67                -6.545074e-05 3 1  ON 66
ci_68                 2.787910e-04 3 1  ON 67
ci_69                -9.574805e-05 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7674
    reference variance = 0.421008
====================================================
  Execution time = 2.5467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8048e-01
  Total weights = 1.963599550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466371360499
                                         uncertainty =       0.002055472829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466371360499
                                         uncertainty =       0.002055472829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482958457
  error estimate for blocks of size 2^( 2) =       0.000504380066
  error estimate for blocks of size 2^( 3) =       0.000524927578
  error estimate for blocks of size 2^( 4) =       0.000539758845
  error estimate for blocks of size 2^( 5) =       0.000549522399
  error estimate for blocks of size 2^( 6) =       0.000554923893
  error estimate for blocks of size 2^( 7) =       0.000558714944

      target function =                  N/A
              le_mean =     -22.818932279726
             les_mean =     521.184146228386
             stat err =       0.000550730021
             autocorr =       1.300343077673
              std dev =       0.683006400508
             le_variance =       0.466497743134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281893227973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-02, overlap shift 1.4552e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818932279649       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819010619157       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819015134128       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819016109812       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819016695557       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819016227415       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-02 is 3.243005e-03

solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818932279649       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818997580309       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819000873273       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819001400781       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819001673899       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819001535638       residual = 9.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-02 is 2.605726e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818932279649       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818971481135       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818973681139       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818973810728       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818973854760       residual = 4.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 1.460813e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0012e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.168710e-01 3 1  ON 0
ci_02                -2.622662e-02 3 1  ON 1
ci_03                -2.615287e-02 3 1  ON 2
ci_04                 2.467497e-02 3 1  ON 3
ci_05                -2.260891e-02 3 1  ON 4
ci_06                -2.348971e-02 3 1  ON 5
ci_07                 2.675180e-02 3 1  ON 6
ci_08                -4.064197e-03 3 1  ON 7
ci_09                -1.108916e-02 3 1  ON 8
ci_10                -1.186405e-02 3 1  ON 9
ci_11                 1.518304e-02 3 1  ON 10
ci_12                 1.136363e-02 3 1  ON 11
ci_13                 1.240800e-02 3 1  ON 12
ci_14                 1.723104e-02 3 1  ON 13
ci_15                 8.952782e-03 3 1  ON 14
ci_16                 5.952660e-03 3 1  ON 15
ci_17                -9.921256e-03 3 1  ON 16
ci_18                -1.045883e-02 3 1  ON 17
ci_19                 8.984424e-03 3 1  ON 18
ci_20                 1.017444e-02 3 1  ON 19
ci_21                 7.434723e-03 3 1  ON 20
ci_22                 7.383464e-03 3 1  ON 21
ci_23                 6.288466e-03 3 1  ON 22
ci_24                 6.553550e-03 3 1  ON 23
ci_25                 4.981983e-03 3 1  ON 24
ci_26                 2.500889e-03 3 1  ON 25
ci_27                 2.934455e-03 3 1  ON 26
ci_28                 3.927251e-03 3 1  ON 27
ci_29                 3.977423e-03 3 1  ON 28
ci_30                 1.114191e-03 3 1  ON 29
ci_31                 1.731779e-03 3 1  ON 30
ci_32                -3.075868e-04 3 1  ON 31
ci_33                -6.895182e-04 3 1  ON 32
ci_34                -9.093830e-06 3 1  ON 33
ci_35                 1.908330e-03 3 1  ON 34
ci_36                -5.068888e-04 3 1  ON 35
ci_37                -1.387964e-03 3 1  ON 36
ci_38                 4.981451e-04 3 1  ON 37
ci_39                 1.342065e-03 3 1  ON 38
ci_40                -1.626748e-03 3 1  ON 39
ci_41                 6.097348e-04 3 1  ON 40
ci_42                 1.675293e-03 3 1  ON 41
ci_43                -1.691248e-03 3 1  ON 42
ci_44                -2.412702e-03 3 1  ON 43
ci_45                 7.601945e-05 3 1  ON 44
ci_46                 5.020485e-04 3 1  ON 45
ci_47                -4.015003e-03 3 1  ON 46
ci_48                -1.042979e-04 3 1  ON 47
ci_49                -1.149838e-03 3 1  ON 48
ci_50                -2.294729e-04 3 1  ON 49
ci_51                -1.237937e-04 3 1  ON 50
ci_52                 2.474001e-04 3 1  ON 51
ci_53                -3.968681e-04 3 1  ON 52
ci_54                 4.410562e-04 3 1  ON 53
ci_55                -1.194795e-03 3 1  ON 54
ci_56                 2.086805e-03 3 1  ON 55
ci_57                 8.116095e-04 3 1  ON 56
ci_58                -1.662138e-03 3 1  ON 57
ci_59                -1.466793e-03 3 1  ON 58
ci_60                -6.162970e-05 3 1  ON 59
ci_61                 2.785900e-03 3 1  ON 60
ci_62                -1.299049e-03 3 1  ON 61
ci_63                 5.058137e-04 3 1  ON 62
ci_64                -2.001254e-04 3 1  ON 63
ci_65                -1.268154e-03 3 1  ON 64
ci_66                -2.984832e-04 3 1  ON 65
ci_67                -2.344568e-04 3 1  ON 66
ci_68                -1.409308e-03 3 1  ON 67
ci_69                -9.365002e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6608
    reference variance = 0.502617
====================================================
  Execution time = 2.6155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8238e-01
  Total weights = 1.9638e+06
  Execution time = 3.7719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000578326
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487826073669
                                         uncertainty =       0.022333449069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487826073669
                                         uncertainty =       0.022333449069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493838318
  error estimate for blocks of size 2^( 2) =       0.000514717390
  error estimate for blocks of size 2^( 3) =       0.000534869360
  error estimate for blocks of size 2^( 4) =       0.000550035924
  error estimate for blocks of size 2^( 5) =       0.000560855500
  error estimate for blocks of size 2^( 6) =       0.000567794749
  error estimate for blocks of size 2^( 7) =       0.000571875664

      target function =                  N/A
              le_mean =     -22.819031936089
             les_mean =     521.236544168842
             stat err =       0.000562640459
             autocorr =       1.298052770925
              std dev =       0.698392846751
             le_variance =       0.487752568393

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.014138
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465444494356
                                         uncertainty =       0.002015049689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.465444494356
                                         uncertainty =       0.002015049689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482376534
  error estimate for blocks of size 2^( 2) =       0.000503808151
  error estimate for blocks of size 2^( 3) =       0.000524316063
  error estimate for blocks of size 2^( 4) =       0.000539910009
  error estimate for blocks of size 2^( 5) =       0.000550182819
  error estimate for blocks of size 2^( 6) =       0.000556807791
  error estimate for blocks of size 2^( 7) =       0.000560979843

      target function =                  N/A
              le_mean =     -22.818995928584
             les_mean =     521.231012012188
             stat err =       0.000551970116
             autocorr =       1.309359141145
              std dev =       0.682183436749
             le_variance =       0.465374241374

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000582021
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466452408130
                                         uncertainty =       0.002030936633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466452408130
                                         uncertainty =       0.002030936633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482898189
  error estimate for blocks of size 2^( 2) =       0.000504314736
  error estimate for blocks of size 2^( 3) =       0.000524820497
  error estimate for blocks of size 2^( 4) =       0.000540399060
  error estimate for blocks of size 2^( 5) =       0.000550635845
  error estimate for blocks of size 2^( 6) =       0.000557274869
  error estimate for blocks of size 2^( 7) =       0.000561482433

      target function =                  N/A
              le_mean =     -22.819069319605
             les_mean =     521.204893967259
             stat err =       0.000552448052
             autocorr =       1.308795340186
              std dev =       0.682921167685
             le_variance =       0.466381321273

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00358267
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466648581490
                                         uncertainty =       0.002177849138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.466648581490
                                         uncertainty =       0.002177849138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000482999813
  error estimate for blocks of size 2^( 2) =       0.000504396935
  error estimate for blocks of size 2^( 3) =       0.000524882093
  error estimate for blocks of size 2^( 4) =       0.000540439330
  error estimate for blocks of size 2^( 5) =       0.000550793631
  error estimate for blocks of size 2^( 6) =       0.000557566000
  error estimate for blocks of size 2^( 7) =       0.000561739280

      target function =                  N/A
              le_mean =     -22.819039368662
             les_mean =     521.261558020911
             stat err =       0.000552634560
             autocorr =       1.309128134662
              std dev =       0.683064886573
             le_variance =       0.466577639268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819031936089        initial
     1.4552e-02     1.4552e-01             3.2430e-03       -22.818995928584
     5.8208e-02     5.8208e-01             2.6057e-03       -22.819069319605  <--
     2.3283e-01     2.3283e+00             1.4608e-03       -22.819039368662

*****************************************************************************
Applying the update for shift_i =   5.8208e-02     and shift_s =   5.8208e-01
*****************************************************************************

  Execution time = 4.3935e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_01                 1.168710e-01 3 1  ON 0
ci_02                -2.622662e-02 3 1  ON 1
ci_03                -2.615287e-02 3 1  ON 2
ci_04                 2.467497e-02 3 1  ON 3
ci_05                -2.260891e-02 3 1  ON 4
ci_06                -2.348971e-02 3 1  ON 5
ci_07                 2.675180e-02 3 1  ON 6
ci_08                -4.064197e-03 3 1  ON 7
ci_09                -1.108916e-02 3 1  ON 8
ci_10                -1.186405e-02 3 1  ON 9
ci_11                 1.518304e-02 3 1  ON 10
ci_12                 1.136363e-02 3 1  ON 11
ci_13                 1.240800e-02 3 1  ON 12
ci_14                 1.723104e-02 3 1  ON 13
ci_15                 8.952782e-03 3 1  ON 14
ci_16                 5.952660e-03 3 1  ON 15
ci_17                -9.921256e-03 3 1  ON 16
ci_18                -1.045883e-02 3 1  ON 17
ci_19                 8.984424e-03 3 1  ON 18
ci_20                 1.017444e-02 3 1  ON 19
ci_21                 7.434723e-03 3 1  ON 20
ci_22                 7.383464e-03 3 1  ON 21
ci_23                 6.288466e-03 3 1  ON 22
ci_24                 6.553550e-03 3 1  ON 23
ci_25                 4.981983e-03 3 1  ON 24
ci_26                 2.500889e-03 3 1  ON 25
ci_27                 2.934455e-03 3 1  ON 26
ci_28                 3.927251e-03 3 1  ON 27
ci_29                 3.977423e-03 3 1  ON 28
ci_30                 1.114191e-03 3 1  ON 29
ci_31                 1.731779e-03 3 1  ON 30
ci_32                -3.075868e-04 3 1  ON 31
ci_33                -6.895182e-04 3 1  ON 32
ci_34                -9.093830e-06 3 1  ON 33
ci_35                 1.908330e-03 3 1  ON 34
ci_36                -5.068888e-04 3 1  ON 35
ci_37                -1.387964e-03 3 1  ON 36
ci_38                 4.981451e-04 3 1  ON 37
ci_39                 1.342065e-03 3 1  ON 38
ci_40                -1.626748e-03 3 1  ON 39
ci_41                 6.097348e-04 3 1  ON 40
ci_42                 1.675293e-03 3 1  ON 41
ci_43                -1.691248e-03 3 1  ON 42
ci_44                -2.412702e-03 3 1  ON 43
ci_45                 7.601945e-05 3 1  ON 44
ci_46                 5.020485e-04 3 1  ON 45
ci_47                -4.015003e-03 3 1  ON 46
ci_48                -1.042979e-04 3 1  ON 47
ci_49                -1.149838e-03 3 1  ON 48
ci_50                -2.294729e-04 3 1  ON 49
ci_51                -1.237937e-04 3 1  ON 50
ci_52                 2.474001e-04 3 1  ON 51
ci_53                -3.968681e-04 3 1  ON 52
ci_54                 4.410562e-04 3 1  ON 53
ci_55                -1.194795e-03 3 1  ON 54
ci_56                 2.086805e-03 3 1  ON 55
ci_57                 8.116095e-04 3 1  ON 56
ci_58                -1.662138e-03 3 1  ON 57
ci_59                -1.466793e-03 3 1  ON 58
ci_60                -6.162970e-05 3 1  ON 59
ci_61                 2.785900e-03 3 1  ON 60
ci_62                -1.299049e-03 3 1  ON 61
ci_63                 5.058137e-04 3 1  ON 62
ci_64                -2.001254e-04 3 1  ON 63
ci_65                -1.268154e-03 3 1  ON 64
ci_66                -2.984832e-04 3 1  ON 65
ci_67                -2.344568e-04 3 1  ON 66
ci_68                -1.409308e-03 3 1  ON 67
ci_69                -9.365002e-04 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.7882
    reference variance = 0.395368
====================================================
  Execution time = 2.5387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8613e-01
  Total weights = 1.963902397e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471533152936
                                         uncertainty =       0.002652648701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471533152936
                                         uncertainty =       0.002652648701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485539519
  error estimate for blocks of size 2^( 2) =       0.000506935727
  error estimate for blocks of size 2^( 3) =       0.000527129934
  error estimate for blocks of size 2^( 4) =       0.000542557123
  error estimate for blocks of size 2^( 5) =       0.000551590058
  error estimate for blocks of size 2^( 6) =       0.000556630195
  error estimate for blocks of size 2^( 7) =       0.000560661564

      target function =                  N/A
              le_mean =     -22.819700435719
             les_mean =     521.224855735329
             stat err =       0.000552859735
             autocorr =       1.296524581373
              std dev =       0.686656572635
             le_variance =       0.471497248743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281970043572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-02, overlap shift 1.4552e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819700435627       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819791880958       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819793995070       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819795366227       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819795819637       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819795667995       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-02 is 2.608573e-03

solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819700435627       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819777187643       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819778103906       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819778827153       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819779083406       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819779040560       residual = 9.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-02 is 2.040524e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819700435627       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819747158025       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819747217311       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819747363522       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819747444943       residual = 4.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 1.223444e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9934e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.154793e-01 3 1  ON 0
ci_02                -2.532527e-02 3 1  ON 1
ci_03                -2.625741e-02 3 1  ON 2
ci_04                 2.535702e-02 3 1  ON 3
ci_05                -2.286576e-02 3 1  ON 4
ci_06                -2.276912e-02 3 1  ON 5
ci_07                 2.545473e-02 3 1  ON 6
ci_08                -4.208141e-03 3 1  ON 7
ci_09                -1.059212e-02 3 1  ON 8
ci_10                -1.145479e-02 3 1  ON 9
ci_11                 1.583966e-02 3 1  ON 10
ci_12                 1.153525e-02 3 1  ON 11
ci_13                 1.284240e-02 3 1  ON 12
ci_14                 1.661152e-02 3 1  ON 13
ci_15                 8.100775e-03 3 1  ON 14
ci_16                 7.993184e-03 3 1  ON 15
ci_17                -8.918848e-03 3 1  ON 16
ci_18                -8.964900e-03 3 1  ON 17
ci_19                 9.860473e-03 3 1  ON 18
ci_20                 1.111787e-02 3 1  ON 19
ci_21                 7.110752e-03 3 1  ON 20
ci_22                 7.558893e-03 3 1  ON 21
ci_23                 6.137382e-03 3 1  ON 22
ci_24                 6.720943e-03 3 1  ON 23
ci_25                 5.091777e-03 3 1  ON 24
ci_26                 1.673745e-03 3 1  ON 25
ci_27                 3.268238e-03 3 1  ON 26
ci_28                 4.329384e-03 3 1  ON 27
ci_29                 3.929691e-03 3 1  ON 28
ci_30                 2.817908e-04 3 1  ON 29
ci_31                 5.488057e-04 3 1  ON 30
ci_32                -2.834149e-05 3 1  ON 31
ci_33                -3.776409e-04 3 1  ON 32
ci_34                 1.262595e-03 3 1  ON 33
ci_35                 2.539043e-03 3 1  ON 34
ci_36                -9.986663e-04 3 1  ON 35
ci_37                -9.478047e-04 3 1  ON 36
ci_38                -4.109265e-06 3 1  ON 37
ci_39                -5.705822e-04 3 1  ON 38
ci_40                -8.522068e-04 3 1  ON 39
ci_41                 6.253277e-04 3 1  ON 40
ci_42                 1.082364e-04 3 1  ON 41
ci_43                -1.066780e-03 3 1  ON 42
ci_44                -1.594659e-03 3 1  ON 43
ci_45                 4.027045e-04 3 1  ON 44
ci_46                 6.019536e-04 3 1  ON 45
ci_47                -2.500191e-03 3 1  ON 46
ci_48                -1.100802e-03 3 1  ON 47
ci_49                -1.510061e-03 3 1  ON 48
ci_50                 1.732106e-04 3 1  ON 49
ci_51                 1.650274e-04 3 1  ON 50
ci_52                 2.193504e-04 3 1  ON 51
ci_53                -4.378564e-04 3 1  ON 52
ci_54                -7.704479e-04 3 1  ON 53
ci_55                -1.716464e-03 3 1  ON 54
ci_56                 1.251567e-03 3 1  ON 55
ci_57                 1.269476e-03 3 1  ON 56
ci_58                -2.542724e-04 3 1  ON 57
ci_59                -1.393760e-04 3 1  ON 58
ci_60                 1.126719e-03 3 1  ON 59
ci_61                 2.707989e-03 3 1  ON 60
ci_62                -1.943712e-05 3 1  ON 61
ci_63                -2.188129e-04 3 1  ON 62
ci_64                -1.016616e-03 3 1  ON 63
ci_65                 8.530483e-05 3 1  ON 64
ci_66                -4.127431e-04 3 1  ON 65
ci_67                -4.525500e-04 3 1  ON 66
ci_68                -1.470350e-03 3 1  ON 67
ci_69                -1.384038e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6801
    reference variance = 0.847354
====================================================
  Execution time = 2.4800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8920e-01
  Total weights = 1.9636e+06
  Execution time = 3.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.214733
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476368235477
                                         uncertainty =       0.003827937251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476368235477
                                         uncertainty =       0.003827937251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488015789
  error estimate for blocks of size 2^( 2) =       0.000508830308
  error estimate for blocks of size 2^( 3) =       0.000529821528
  error estimate for blocks of size 2^( 4) =       0.000545506133
  error estimate for blocks of size 2^( 5) =       0.000554698239
  error estimate for blocks of size 2^( 6) =       0.000560936689
  error estimate for blocks of size 2^( 7) =       0.000563837818

      target function =                  N/A
              le_mean =     -22.818911371762
             les_mean =     523.719625004534
             stat err =       0.000556244720
             autocorr =       1.299164235670
              std dev =       0.690158547371
             le_variance =       0.476318820510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472234791600
                                         uncertainty =       0.002483176412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472234791600
                                         uncertainty =       0.002483176412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485894637
  error estimate for blocks of size 2^( 2) =       0.000506809547
  error estimate for blocks of size 2^( 3) =       0.000527854303
  error estimate for blocks of size 2^( 4) =       0.000543649757
  error estimate for blocks of size 2^( 5) =       0.000552865149
  error estimate for blocks of size 2^( 6) =       0.000559351238
  error estimate for blocks of size 2^( 7) =       0.000562527346

      target function =                  N/A
              le_mean =     -22.818911498064
             les_mean =     521.193818696987
             stat err =       0.000554598372
             autocorr =       1.302785660904
              std dev =       0.687158785744
             le_variance =       0.472187196825

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.205305
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487308963100
                                         uncertainty =       0.014114588352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.487308963100
                                         uncertainty =       0.014114588352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000493567004
  error estimate for blocks of size 2^( 2) =       0.000514199518
  error estimate for blocks of size 2^( 3) =       0.000534930162
  error estimate for blocks of size 2^( 4) =       0.000550573949
  error estimate for blocks of size 2^( 5) =       0.000559510630
  error estimate for blocks of size 2^( 6) =       0.000565913248
  error estimate for blocks of size 2^( 7) =       0.000569687454

      target function =                  N/A
              le_mean =     -22.818939473680
             les_mean =     522.591422905431
             stat err =       0.000561421320
             autocorr =       1.293854870431
              std dev =       0.698009151366
             le_variance =       0.487216775391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472253489005
                                         uncertainty =       0.002481976927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472253489005
                                         uncertainty =       0.002481976927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485903532
  error estimate for blocks of size 2^( 2) =       0.000506811160
  error estimate for blocks of size 2^( 3) =       0.000527846707
  error estimate for blocks of size 2^( 4) =       0.000543629482
  error estimate for blocks of size 2^( 5) =       0.000552837366
  error estimate for blocks of size 2^( 6) =       0.000559322025
  error estimate for blocks of size 2^( 7) =       0.000562444059

      target function =                  N/A
              le_mean =     -22.818914273577
             les_mean =     521.194598340171
             stat err =       0.000554558233
             autocorr =       1.302549398912
              std dev =       0.687171364836
             le_variance =       0.472204484651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818911371762        initial
     1.4552e-02     1.4552e-01             2.6086e-03       -22.818911498064
     5.8208e-02     5.8208e-01             2.0405e-03       -22.818939473680  <--
     2.3283e-01     2.3283e+00             1.2234e-03       -22.818914273577

*****************************************************************************
Applying the update for shift_i =   5.8208e-02     and shift_s =   5.8208e-01
*****************************************************************************

  Execution time = 4.2345e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_01                 1.154793e-01 3 1  ON 0
ci_02                -2.532527e-02 3 1  ON 1
ci_03                -2.625741e-02 3 1  ON 2
ci_04                 2.535702e-02 3 1  ON 3
ci_05                -2.286576e-02 3 1  ON 4
ci_06                -2.276912e-02 3 1  ON 5
ci_07                 2.545473e-02 3 1  ON 6
ci_08                -4.208141e-03 3 1  ON 7
ci_09                -1.059212e-02 3 1  ON 8
ci_10                -1.145479e-02 3 1  ON 9
ci_11                 1.583966e-02 3 1  ON 10
ci_12                 1.153525e-02 3 1  ON 11
ci_13                 1.284240e-02 3 1  ON 12
ci_14                 1.661152e-02 3 1  ON 13
ci_15                 8.100775e-03 3 1  ON 14
ci_16                 7.993184e-03 3 1  ON 15
ci_17                -8.918848e-03 3 1  ON 16
ci_18                -8.964900e-03 3 1  ON 17
ci_19                 9.860473e-03 3 1  ON 18
ci_20                 1.111787e-02 3 1  ON 19
ci_21                 7.110752e-03 3 1  ON 20
ci_22                 7.558893e-03 3 1  ON 21
ci_23                 6.137382e-03 3 1  ON 22
ci_24                 6.720943e-03 3 1  ON 23
ci_25                 5.091777e-03 3 1  ON 24
ci_26                 1.673745e-03 3 1  ON 25
ci_27                 3.268238e-03 3 1  ON 26
ci_28                 4.329384e-03 3 1  ON 27
ci_29                 3.929691e-03 3 1  ON 28
ci_30                 2.817908e-04 3 1  ON 29
ci_31                 5.488057e-04 3 1  ON 30
ci_32                -2.834149e-05 3 1  ON 31
ci_33                -3.776409e-04 3 1  ON 32
ci_34                 1.262595e-03 3 1  ON 33
ci_35                 2.539043e-03 3 1  ON 34
ci_36                -9.986663e-04 3 1  ON 35
ci_37                -9.478047e-04 3 1  ON 36
ci_38                -4.109265e-06 3 1  ON 37
ci_39                -5.705822e-04 3 1  ON 38
ci_40                -8.522068e-04 3 1  ON 39
ci_41                 6.253277e-04 3 1  ON 40
ci_42                 1.082364e-04 3 1  ON 41
ci_43                -1.066780e-03 3 1  ON 42
ci_44                -1.594659e-03 3 1  ON 43
ci_45                 4.027045e-04 3 1  ON 44
ci_46                 6.019536e-04 3 1  ON 45
ci_47                -2.500191e-03 3 1  ON 46
ci_48                -1.100802e-03 3 1  ON 47
ci_49                -1.510061e-03 3 1  ON 48
ci_50                 1.732106e-04 3 1  ON 49
ci_51                 1.650274e-04 3 1  ON 50
ci_52                 2.193504e-04 3 1  ON 51
ci_53                -4.378564e-04 3 1  ON 52
ci_54                -7.704479e-04 3 1  ON 53
ci_55                -1.716464e-03 3 1  ON 54
ci_56                 1.251567e-03 3 1  ON 55
ci_57                 1.269476e-03 3 1  ON 56
ci_58                -2.542724e-04 3 1  ON 57
ci_59                -1.393760e-04 3 1  ON 58
ci_60                 1.126719e-03 3 1  ON 59
ci_61                 2.707989e-03 3 1  ON 60
ci_62                -1.943712e-05 3 1  ON 61
ci_63                -2.188129e-04 3 1  ON 62
ci_64                -1.016616e-03 3 1  ON 63
ci_65                 8.530483e-05 3 1  ON 64
ci_66                -4.127431e-04 3 1  ON 65
ci_67                -4.525500e-04 3 1  ON 66
ci_68                -1.470350e-03 3 1  ON 67
ci_69                -1.384038e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.9324
    reference variance = 0.670894
====================================================
  Execution time = 2.5415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5345e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8560e-01
  Total weights = 1.963936505e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469351796030
                                         uncertainty =       0.002214154946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469351796030
                                         uncertainty =       0.002214154946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484430452
  error estimate for blocks of size 2^( 2) =       0.000505612680
  error estimate for blocks of size 2^( 3) =       0.000526282614
  error estimate for blocks of size 2^( 4) =       0.000542739045
  error estimate for blocks of size 2^( 5) =       0.000552161264
  error estimate for blocks of size 2^( 6) =       0.000557699384
  error estimate for blocks of size 2^( 7) =       0.000559954240

      target function =                  N/A
              le_mean =     -22.818970287981
             les_mean =     521.191001915261
             stat err =       0.000553138483
             autocorr =       1.303781687157
              std dev =       0.685088115914
             le_variance =       0.469345726566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281897028798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-02, overlap shift 1.4552e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818970287901       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819037788128       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819038651408       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819038867840       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819038298953       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819038595812       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-02 is 3.438487e-03

solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818970287901       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819025828726       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819025974125       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819025970177       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819025705975       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819025795746       residual = 7.10e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-02 is 2.771900e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818970287901       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819002792398       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819002655624       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819002595567       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-01 is 1.565108e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9959e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.157386e-01 3 1  ON 0
ci_02                -2.614525e-02 3 1  ON 1
ci_03                -2.524851e-02 3 1  ON 2
ci_04                 2.575088e-02 3 1  ON 3
ci_05                -2.299972e-02 3 1  ON 4
ci_06                -2.306774e-02 3 1  ON 5
ci_07                 2.513794e-02 3 1  ON 6
ci_08                -4.368860e-03 3 1  ON 7
ci_09                -1.008290e-02 3 1  ON 8
ci_10                -1.186547e-02 3 1  ON 9
ci_11                 1.727425e-02 3 1  ON 10
ci_12                 1.087224e-02 3 1  ON 11
ci_13                 1.098377e-02 3 1  ON 12
ci_14                 1.650308e-02 3 1  ON 13
ci_15                 8.508715e-03 3 1  ON 14
ci_16                 6.580418e-03 3 1  ON 15
ci_17                -7.746554e-03 3 1  ON 16
ci_18                -9.522784e-03 3 1  ON 17
ci_19                 9.863526e-03 3 1  ON 18
ci_20                 1.002305e-02 3 1  ON 19
ci_21                 7.367698e-03 3 1  ON 20
ci_22                 8.329857e-03 3 1  ON 21
ci_23                 6.614430e-03 3 1  ON 22
ci_24                 8.535327e-03 3 1  ON 23
ci_25                 5.343859e-03 3 1  ON 24
ci_26                 1.995728e-03 3 1  ON 25
ci_27                 2.317616e-03 3 1  ON 26
ci_28                 3.888380e-03 3 1  ON 27
ci_29                 3.997084e-03 3 1  ON 28
ci_30                 4.945175e-04 3 1  ON 29
ci_31                 4.166002e-04 3 1  ON 30
ci_32                -4.542408e-04 3 1  ON 31
ci_33                 3.492708e-04 3 1  ON 32
ci_34                 9.841390e-04 3 1  ON 33
ci_35                -2.328575e-04 3 1  ON 34
ci_36                -1.104201e-03 3 1  ON 35
ci_37                -6.021476e-04 3 1  ON 36
ci_38                -1.886157e-04 3 1  ON 37
ci_39                 3.296681e-04 3 1  ON 38
ci_40                -1.030892e-03 3 1  ON 39
ci_41                 8.134890e-04 3 1  ON 40
ci_42                 3.196588e-04 3 1  ON 41
ci_43                -2.050940e-03 3 1  ON 42
ci_44                -1.618265e-03 3 1  ON 43
ci_45                 1.207995e-04 3 1  ON 44
ci_46                -1.712352e-04 3 1  ON 45
ci_47                -1.649037e-03 3 1  ON 46
ci_48                -1.292800e-03 3 1  ON 47
ci_49                -1.315130e-03 3 1  ON 48
ci_50                -5.591638e-04 3 1  ON 49
ci_51                 6.640636e-04 3 1  ON 50
ci_52                -4.986739e-04 3 1  ON 51
ci_53                -3.997829e-04 3 1  ON 52
ci_54                -6.676702e-04 3 1  ON 53
ci_55                -2.629918e-04 3 1  ON 54
ci_56                 1.083424e-03 3 1  ON 55
ci_57                 1.469378e-03 3 1  ON 56
ci_58                -1.691176e-03 3 1  ON 57
ci_59                -1.720187e-03 3 1  ON 58
ci_60                 2.281696e-03 3 1  ON 59
ci_61                 1.611172e-03 3 1  ON 60
ci_62                -1.770309e-04 3 1  ON 61
ci_63                -6.394402e-04 3 1  ON 62
ci_64                -3.967517e-04 3 1  ON 63
ci_65                -5.579505e-04 3 1  ON 64
ci_66                -8.076077e-04 3 1  ON 65
ci_67                -8.609546e-04 3 1  ON 66
ci_68                 4.578721e-05 3 1  ON 67
ci_69                -1.111474e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8583
    reference variance = 0.377338
====================================================
  Execution time = 2.4733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9554e-01
  Total weights = 1.9633e+06
  Execution time = 3.4941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0722077
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.781189620695
                                         uncertainty =       0.299397717625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.781189620695
                                         uncertainty =       0.299397717625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000624632940
  error estimate for blocks of size 2^( 2) =       0.000641178731
  error estimate for blocks of size 2^( 3) =       0.000657934006
  error estimate for blocks of size 2^( 4) =       0.000670707534
  error estimate for blocks of size 2^( 5) =       0.000678739881
  error estimate for blocks of size 2^( 6) =       0.000683542018
  error estimate for blocks of size 2^( 7) =       0.000685081908

      target function =                  N/A
              le_mean =     -22.819134574358
             les_mean =     524.229916012415
             stat err =       0.000679517835
             autocorr =       1.183455558869
              std dev =       0.883364375182
             le_variance =       0.780332619341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479036182313
                                         uncertainty =       0.004446816005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479036182313
                                         uncertainty =       0.004446816005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489372759
  error estimate for blocks of size 2^( 2) =       0.000510364614
  error estimate for blocks of size 2^( 3) =       0.000530889669
  error estimate for blocks of size 2^( 4) =       0.000546543238
  error estimate for blocks of size 2^( 5) =       0.000556199085
  error estimate for blocks of size 2^( 6) =       0.000561903543
  error estimate for blocks of size 2^( 7) =       0.000564403232

      target function =                  N/A
              le_mean =     -22.818684640637
             les_mean =     521.189677057984
             stat err =       0.000557262275
             autocorr =       1.296700580426
              std dev =       0.692077592858
             le_variance =       0.478971394537

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0700576
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480513377071
                                         uncertainty =       0.004520559970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.480513377071
                                         uncertainty =       0.004520559970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000490125810
  error estimate for blocks of size 2^( 2) =       0.000511090800
  error estimate for blocks of size 2^( 3) =       0.000531621690
  error estimate for blocks of size 2^( 4) =       0.000547198055
  error estimate for blocks of size 2^( 5) =       0.000556911609
  error estimate for blocks of size 2^( 6) =       0.000562714863
  error estimate for blocks of size 2^( 7) =       0.000565109523

      target function =                  N/A
              le_mean =     -22.818763686527
             les_mean =     521.334716236370
             stat err =       0.000557983512
             autocorr =       1.296067401643
              std dev =       0.693142567143
             le_variance =       0.480446618386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479278044829
                                         uncertainty =       0.004416661195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.479278044829
                                         uncertainty =       0.004416661195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489496244
  error estimate for blocks of size 2^( 2) =       0.000510487407
  error estimate for blocks of size 2^( 3) =       0.000530994066
  error estimate for blocks of size 2^( 4) =       0.000546604978
  error estimate for blocks of size 2^( 5) =       0.000556242702
  error estimate for blocks of size 2^( 6) =       0.000561905516
  error estimate for blocks of size 2^( 7) =       0.000564441793

      target function =                  N/A
              le_mean =     -22.818697331078
             les_mean =     521.196071617563
             stat err =       0.000557298747
             autocorr =       1.296216084221
              std dev =       0.692252227030
             le_variance =       0.479213145829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819134574358        initial  <--
     1.4552e-02     1.4552e-01             3.4385e-03       -22.818684640637
     5.8208e-02     5.8208e-01             2.7719e-03       -22.818763686527
     2.3283e-01     2.3283e+00             1.5651e-03       -22.818697331078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2431
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_01                 1.154793e-01 3 1  ON 0
ci_02                -2.532527e-02 3 1  ON 1
ci_03                -2.625741e-02 3 1  ON 2
ci_04                 2.535702e-02 3 1  ON 3
ci_05                -2.286576e-02 3 1  ON 4
ci_06                -2.276912e-02 3 1  ON 5
ci_07                 2.545473e-02 3 1  ON 6
ci_08                -4.208141e-03 3 1  ON 7
ci_09                -1.059212e-02 3 1  ON 8
ci_10                -1.145479e-02 3 1  ON 9
ci_11                 1.583966e-02 3 1  ON 10
ci_12                 1.153525e-02 3 1  ON 11
ci_13                 1.284240e-02 3 1  ON 12
ci_14                 1.661152e-02 3 1  ON 13
ci_15                 8.100775e-03 3 1  ON 14
ci_16                 7.993184e-03 3 1  ON 15
ci_17                -8.918848e-03 3 1  ON 16
ci_18                -8.964900e-03 3 1  ON 17
ci_19                 9.860473e-03 3 1  ON 18
ci_20                 1.111787e-02 3 1  ON 19
ci_21                 7.110752e-03 3 1  ON 20
ci_22                 7.558893e-03 3 1  ON 21
ci_23                 6.137382e-03 3 1  ON 22
ci_24                 6.720943e-03 3 1  ON 23
ci_25                 5.091777e-03 3 1  ON 24
ci_26                 1.673745e-03 3 1  ON 25
ci_27                 3.268238e-03 3 1  ON 26
ci_28                 4.329384e-03 3 1  ON 27
ci_29                 3.929691e-03 3 1  ON 28
ci_30                 2.817908e-04 3 1  ON 29
ci_31                 5.488057e-04 3 1  ON 30
ci_32                -2.834149e-05 3 1  ON 31
ci_33                -3.776409e-04 3 1  ON 32
ci_34                 1.262595e-03 3 1  ON 33
ci_35                 2.539043e-03 3 1  ON 34
ci_36                -9.986663e-04 3 1  ON 35
ci_37                -9.478047e-04 3 1  ON 36
ci_38                -4.109265e-06 3 1  ON 37
ci_39                -5.705822e-04 3 1  ON 38
ci_40                -8.522068e-04 3 1  ON 39
ci_41                 6.253277e-04 3 1  ON 40
ci_42                 1.082364e-04 3 1  ON 41
ci_43                -1.066780e-03 3 1  ON 42
ci_44                -1.594659e-03 3 1  ON 43
ci_45                 4.027045e-04 3 1  ON 44
ci_46                 6.019536e-04 3 1  ON 45
ci_47                -2.500191e-03 3 1  ON 46
ci_48                -1.100802e-03 3 1  ON 47
ci_49                -1.510061e-03 3 1  ON 48
ci_50                 1.732106e-04 3 1  ON 49
ci_51                 1.650274e-04 3 1  ON 50
ci_52                 2.193504e-04 3 1  ON 51
ci_53                -4.378564e-04 3 1  ON 52
ci_54                -7.704479e-04 3 1  ON 53
ci_55                -1.716464e-03 3 1  ON 54
ci_56                 1.251567e-03 3 1  ON 55
ci_57                 1.269476e-03 3 1  ON 56
ci_58                -2.542724e-04 3 1  ON 57
ci_59                -1.393760e-04 3 1  ON 58
ci_60                 1.126719e-03 3 1  ON 59
ci_61                 2.707989e-03 3 1  ON 60
ci_62                -1.943712e-05 3 1  ON 61
ci_63                -2.188129e-04 3 1  ON 62
ci_64                -1.016616e-03 3 1  ON 63
ci_65                 8.530483e-05 3 1  ON 64
ci_66                -4.127431e-04 3 1  ON 65
ci_67                -4.525500e-04 3 1  ON 66
ci_68                -1.470350e-03 3 1  ON 67
ci_69                -1.384038e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8606
    reference variance = 0.379268
====================================================
  Execution time = 2.5375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8769e-01
  Total weights = 1.963759598e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472125006767
                                         uncertainty =       0.002771600501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472125006767
                                         uncertainty =       0.002771600501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485811314
  error estimate for blocks of size 2^( 2) =       0.000507633382
  error estimate for blocks of size 2^( 3) =       0.000528459438
  error estimate for blocks of size 2^( 4) =       0.000544839260
  error estimate for blocks of size 2^( 5) =       0.000554478258
  error estimate for blocks of size 2^( 6) =       0.000561092448
  error estimate for blocks of size 2^( 7) =       0.000562999767

      target function =                  N/A
              le_mean =     -22.819053860870
             les_mean =     521.196911518686
             stat err =       0.000555852433
             autocorr =       1.309133006971
              std dev =       0.687040949030
             le_variance =       0.472025265644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281905386087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819053860846       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819077802050       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819078032184       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819078003778       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-01 is 1.278703e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819053860846       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819064325401       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819064259375       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819064235378       residual = 9.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-01 is 5.438143e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819053860846       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819057079095       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819057056670       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819057044396       residual = 7.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 1.654638e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9883e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.152864e-01 3 1  ON 0
ci_02                -2.553125e-02 3 1  ON 1
ci_03                -2.639577e-02 3 1  ON 2
ci_04                 2.519441e-02 3 1  ON 3
ci_05                -2.297790e-02 3 1  ON 4
ci_06                -2.284359e-02 3 1  ON 5
ci_07                 2.543213e-02 3 1  ON 6
ci_08                -4.272634e-03 3 1  ON 7
ci_09                -1.061514e-02 3 1  ON 8
ci_10                -1.141290e-02 3 1  ON 9
ci_11                 1.568676e-02 3 1  ON 10
ci_12                 1.132563e-02 3 1  ON 11
ci_13                 1.263405e-02 3 1  ON 12
ci_14                 1.649571e-02 3 1  ON 13
ci_15                 8.247266e-03 3 1  ON 14
ci_16                 8.028504e-03 3 1  ON 15
ci_17                -9.136486e-03 3 1  ON 16
ci_18                -9.157151e-03 3 1  ON 17
ci_19                 9.819689e-03 3 1  ON 18
ci_20                 1.098248e-02 3 1  ON 19
ci_21                 7.453612e-03 3 1  ON 20
ci_22                 7.747587e-03 3 1  ON 21
ci_23                 6.087526e-03 3 1  ON 22
ci_24                 6.497302e-03 3 1  ON 23
ci_25                 5.019989e-03 3 1  ON 24
ci_26                 1.831452e-03 3 1  ON 25
ci_27                 3.020232e-03 3 1  ON 26
ci_28                 4.403666e-03 3 1  ON 27
ci_29                 4.115473e-03 3 1  ON 28
ci_30                 2.497365e-04 3 1  ON 29
ci_31                 3.565556e-04 3 1  ON 30
ci_32                -2.754750e-04 3 1  ON 31
ci_33                -3.636447e-04 3 1  ON 32
ci_34                 8.578103e-04 3 1  ON 33
ci_35                 2.150975e-03 3 1  ON 34
ci_36                -8.738784e-04 3 1  ON 35
ci_37                -1.098667e-03 3 1  ON 36
ci_38                -2.197688e-04 3 1  ON 37
ci_39                -3.009665e-04 3 1  ON 38
ci_40                -9.515224e-04 3 1  ON 39
ci_41                 8.532229e-04 3 1  ON 40
ci_42                 2.261204e-04 3 1  ON 41
ci_43                -1.407624e-03 3 1  ON 42
ci_44                -1.525187e-03 3 1  ON 43
ci_45                 9.013542e-05 3 1  ON 44
ci_46                 1.813731e-04 3 1  ON 45
ci_47                -2.287896e-03 3 1  ON 46
ci_48                -9.037681e-04 3 1  ON 47
ci_49                -1.496400e-03 3 1  ON 48
ci_50                 1.173611e-04 3 1  ON 49
ci_51                 1.519498e-04 3 1  ON 50
ci_52                -7.287682e-05 3 1  ON 51
ci_53                -7.368955e-04 3 1  ON 52
ci_54                -8.156427e-04 3 1  ON 53
ci_55                -1.172650e-03 3 1  ON 54
ci_56                 1.203767e-03 3 1  ON 55
ci_57                 1.266696e-03 3 1  ON 56
ci_58                -6.048083e-04 3 1  ON 57
ci_59                -3.330958e-04 3 1  ON 58
ci_60                 1.318016e-03 3 1  ON 59
ci_61                 2.752685e-03 3 1  ON 60
ci_62                -2.129911e-04 3 1  ON 61
ci_63                -4.242154e-04 3 1  ON 62
ci_64                -7.543480e-04 3 1  ON 63
ci_65                 1.504396e-04 3 1  ON 64
ci_66                -5.204605e-04 3 1  ON 65
ci_67                -6.563186e-04 3 1  ON 66
ci_68                -1.410552e-03 3 1  ON 67
ci_69                -1.336350e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.799
    reference variance = 0.40491
====================================================
  Execution time = 2.4809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8971e-01
  Total weights = 1.9639e+06
  Execution time = 3.4911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473404443304
                                         uncertainty =       0.002527898381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473404443304
                                         uncertainty =       0.002527898381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486491696
  error estimate for blocks of size 2^( 2) =       0.000508072973
  error estimate for blocks of size 2^( 3) =       0.000528778438
  error estimate for blocks of size 2^( 4) =       0.000544213845
  error estimate for blocks of size 2^( 5) =       0.000554037732
  error estimate for blocks of size 2^( 6) =       0.000559656233
  error estimate for blocks of size 2^( 7) =       0.000563399814

      target function =                  N/A
              le_mean =     -22.819185824763
             les_mean =     521.314105043426
             stat err =       0.000555326906
             autocorr =       1.303006461497
              std dev =       0.688003154007
             le_variance =       0.473348339924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473404961988
                                         uncertainty =       0.002497928556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473404961988
                                         uncertainty =       0.002497928556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486490964
  error estimate for blocks of size 2^( 2) =       0.000508074722
  error estimate for blocks of size 2^( 3) =       0.000528771710
  error estimate for blocks of size 2^( 4) =       0.000544209465
  error estimate for blocks of size 2^( 5) =       0.000553996620
  error estimate for blocks of size 2^( 6) =       0.000559598887
  error estimate for blocks of size 2^( 7) =       0.000563382324

      target function =                  N/A
              le_mean =     -22.819194866118
             les_mean =     521.208809313516
             stat err =       0.000555296824
             autocorr =       1.302869216653
              std dev =       0.688002119111
             le_variance =       0.473346915901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473377289694
                                         uncertainty =       0.002505205027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473377289694
                                         uncertainty =       0.002505205027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486476883
  error estimate for blocks of size 2^( 2) =       0.000508062121
  error estimate for blocks of size 2^( 3) =       0.000528762223
  error estimate for blocks of size 2^( 4) =       0.000544201450
  error estimate for blocks of size 2^( 5) =       0.000553988530
  error estimate for blocks of size 2^( 6) =       0.000559598892
  error estimate for blocks of size 2^( 7) =       0.000563374604

      target function =                  N/A
              le_mean =     -22.819190716632
             les_mean =     521.206457432974
             stat err =       0.000555290869
             autocorr =       1.302916693232
              std dev =       0.687982205944
             le_variance =       0.473319515696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473335659708
                                         uncertainty =       0.002523810436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473335659708
                                         uncertainty =       0.002523810436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486456249
  error estimate for blocks of size 2^( 2) =       0.000508040554
  error estimate for blocks of size 2^( 3) =       0.000528744869
  error estimate for blocks of size 2^( 4) =       0.000544183157
  error estimate for blocks of size 2^( 5) =       0.000553981647
  error estimate for blocks of size 2^( 6) =       0.000559605033
  error estimate for blocks of size 2^( 7) =       0.000563355307

      target function =                  N/A
              le_mean =     -22.819181822671
             les_mean =     521.209691512400
             stat err =       0.000555281286
             autocorr =       1.302982252792
              std dev =       0.687953025250
             le_variance =       0.473279364950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819185824763        initial
     1.4552e-01     1.4552e+00             1.2787e-03       -22.819194866118  <--
     5.8208e-01     5.8208e+00             5.4381e-04       -22.819190716632
     2.3283e+00     2.3283e+01             1.6546e-04       -22.819181822671

*****************************************************************************
Applying the update for shift_i =   1.4552e-01     and shift_s =   1.4552e+00
*****************************************************************************

  Execution time = 4.2310e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_01                 1.149196e-01 3 1  ON 0
ci_02                -2.587681e-02 3 1  ON 1
ci_03                -2.662912e-02 3 1  ON 2
ci_04                 2.501054e-02 3 1  ON 3
ci_05                -2.318720e-02 3 1  ON 4
ci_06                -2.297262e-02 3 1  ON 5
ci_07                 2.544353e-02 3 1  ON 6
ci_08                -4.325192e-03 3 1  ON 7
ci_09                -1.063923e-02 3 1  ON 8
ci_10                -1.131775e-02 3 1  ON 9
ci_11                 1.546382e-02 3 1  ON 10
ci_12                 1.106057e-02 3 1  ON 11
ci_13                 1.235223e-02 3 1  ON 12
ci_14                 1.622857e-02 3 1  ON 13
ci_15                 8.470016e-03 3 1  ON 14
ci_16                 8.070668e-03 3 1  ON 15
ci_17                -9.435175e-03 3 1  ON 16
ci_18                -9.442056e-03 3 1  ON 17
ci_19                 9.794696e-03 3 1  ON 18
ci_20                 1.077325e-02 3 1  ON 19
ci_21                 7.999726e-03 3 1  ON 20
ci_22                 8.037948e-03 3 1  ON 21
ci_23                 6.059615e-03 3 1  ON 22
ci_24                 6.155065e-03 3 1  ON 23
ci_25                 4.933035e-03 3 1  ON 24
ci_26                 2.059894e-03 3 1  ON 25
ci_27                 2.672302e-03 3 1  ON 26
ci_28                 4.508379e-03 3 1  ON 27
ci_29                 4.369524e-03 3 1  ON 28
ci_30                 1.436992e-04 3 1  ON 29
ci_31                 2.581178e-07 3 1  ON 30
ci_32                -5.749802e-04 3 1  ON 31
ci_33                -3.635740e-04 3 1  ON 32
ci_34                 2.845991e-04 3 1  ON 33
ci_35                 1.588330e-03 3 1  ON 34
ci_36                -7.139555e-04 3 1  ON 35
ci_37                -1.270747e-03 3 1  ON 36
ci_38                -4.542738e-04 3 1  ON 37
ci_39                 1.452124e-05 3 1  ON 38
ci_40                -1.014593e-03 3 1  ON 39
ci_41                 1.105704e-03 3 1  ON 40
ci_42                 3.439089e-04 3 1  ON 41
ci_43                -1.868907e-03 3 1  ON 42
ci_44                -1.410353e-03 3 1  ON 43
ci_45                -2.299240e-04 3 1  ON 44
ci_46                -2.871423e-04 3 1  ON 45
ci_47                -1.963261e-03 3 1  ON 46
ci_48                -5.992048e-04 3 1  ON 47
ci_49                -1.491244e-03 3 1  ON 48
ci_50                 8.809398e-05 3 1  ON 49
ci_51                 1.600789e-04 3 1  ON 50
ci_52                -3.875047e-04 3 1  ON 51
ci_53                -1.004363e-03 3 1  ON 52
ci_54                -8.933695e-04 3 1  ON 53
ci_55                -4.377614e-04 3 1  ON 54
ci_56                 1.169666e-03 3 1  ON 55
ci_57                 1.261646e-03 3 1  ON 56
ci_58                -1.075557e-03 3 1  ON 57
ci_59                -5.900238e-04 3 1  ON 58
ci_60                 1.713696e-03 3 1  ON 59
ci_61                 2.845182e-03 3 1  ON 60
ci_62                -4.043993e-04 3 1  ON 61
ci_63                -6.100446e-04 3 1  ON 62
ci_64                -4.409165e-04 3 1  ON 63
ci_65                 2.179875e-04 3 1  ON 64
ci_66                -6.284017e-04 3 1  ON 65
ci_67                -8.744917e-04 3 1  ON 66
ci_68                -1.313393e-03 3 1  ON 67
ci_69                -1.229799e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7874
    reference variance = 0.296448
====================================================
  Execution time = 2.5525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5369e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8590e-01
  Total weights = 1.963887189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469270497137
                                         uncertainty =       0.002916129777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469270497137
                                         uncertainty =       0.002916129777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484550047
  error estimate for blocks of size 2^( 2) =       0.000505811516
  error estimate for blocks of size 2^( 3) =       0.000526192704
  error estimate for blocks of size 2^( 4) =       0.000541862742
  error estimate for blocks of size 2^( 5) =       0.000551380276
  error estimate for blocks of size 2^( 6) =       0.000556908995
  error estimate for blocks of size 2^( 7) =       0.000559039247

      target function =                  N/A
              le_mean =     -22.819791710521
             les_mean =     521.228796485978
             stat err =       0.000552297815
             autocorr =       1.299180133701
              std dev =       0.685257247477
             le_variance =       0.469577495219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281979171052e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819791710483       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819807558685       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819811003567       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819812366986       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819811767224       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819811740325       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 2.128182e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819791710483       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819802659295       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819804361134       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819804713627       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819804587388       residual = 7.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-01 is 1.351739e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819791710483       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819796605813       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819797189088       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819797176568       residual = 6.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-01 is 5.505184e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0085e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.150273e-01 3 1  ON 0
ci_02                -2.609865e-02 3 1  ON 1
ci_03                -2.659305e-02 3 1  ON 2
ci_04                 2.483047e-02 3 1  ON 3
ci_05                -2.319832e-02 3 1  ON 4
ci_06                -2.298522e-02 3 1  ON 5
ci_07                 2.550840e-02 3 1  ON 6
ci_08                -4.329594e-03 3 1  ON 7
ci_09                -1.053115e-02 3 1  ON 8
ci_10                -1.150565e-02 3 1  ON 9
ci_11                 1.471962e-02 3 1  ON 10
ci_12                 1.070143e-02 3 1  ON 11
ci_13                 1.275061e-02 3 1  ON 12
ci_14                 1.721043e-02 3 1  ON 13
ci_15                 7.917429e-03 3 1  ON 14
ci_16                 7.090791e-03 3 1  ON 15
ci_17                -9.609255e-03 3 1  ON 16
ci_18                -9.175447e-03 3 1  ON 17
ci_19                 9.733261e-03 3 1  ON 18
ci_20                 1.031950e-02 3 1  ON 19
ci_21                 8.502806e-03 3 1  ON 20
ci_22                 8.539090e-03 3 1  ON 21
ci_23                 6.687990e-03 3 1  ON 22
ci_24                 7.121282e-03 3 1  ON 23
ci_25                 4.845263e-03 3 1  ON 24
ci_26                 2.174786e-03 3 1  ON 25
ci_27                 2.392491e-03 3 1  ON 26
ci_28                 4.060901e-03 3 1  ON 27
ci_29                 3.774015e-03 3 1  ON 28
ci_30                 4.055917e-05 3 1  ON 29
ci_31                -8.043168e-04 3 1  ON 30
ci_32                -2.429270e-04 3 1  ON 31
ci_33                -4.590237e-04 3 1  ON 32
ci_34                 1.027023e-03 3 1  ON 33
ci_35                 9.161889e-04 3 1  ON 34
ci_36                -6.887181e-04 3 1  ON 35
ci_37                -1.167782e-03 3 1  ON 36
ci_38                 1.133426e-04 3 1  ON 37
ci_39                -1.419757e-04 3 1  ON 38
ci_40                -1.597948e-03 3 1  ON 39
ci_41                 8.038348e-04 3 1  ON 40
ci_42                 1.080557e-04 3 1  ON 41
ci_43                -2.277690e-03 3 1  ON 42
ci_44                -1.659703e-03 3 1  ON 43
ci_45                 3.020842e-04 3 1  ON 44
ci_46                -5.388056e-04 3 1  ON 45
ci_47                -6.115222e-04 3 1  ON 46
ci_48                -3.069707e-04 3 1  ON 47
ci_49                -9.043389e-04 3 1  ON 48
ci_50                -6.264410e-04 3 1  ON 49
ci_51                 7.757286e-06 3 1  ON 50
ci_52                -3.578953e-04 3 1  ON 51
ci_53                -9.422642e-04 3 1  ON 52
ci_54                -1.358889e-03 3 1  ON 53
ci_55                -6.364951e-04 3 1  ON 54
ci_56                 1.355566e-03 3 1  ON 55
ci_57                 1.260575e-03 3 1  ON 56
ci_58                -9.019331e-04 3 1  ON 57
ci_59                -6.054119e-04 3 1  ON 58
ci_60                 1.693264e-03 3 1  ON 59
ci_61                 2.345895e-03 3 1  ON 60
ci_62                -6.514894e-04 3 1  ON 61
ci_63                -6.499326e-05 3 1  ON 62
ci_64                -1.517837e-04 3 1  ON 63
ci_65                 1.291293e-04 3 1  ON 64
ci_66                -2.628510e-04 3 1  ON 65
ci_67                -5.171816e-04 3 1  ON 66
ci_68                -4.516857e-04 3 1  ON 67
ci_69                -1.254000e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8614
    reference variance = 0.470645
====================================================
  Execution time = 2.4744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9185e-01
  Total weights = 1.9639e+06
  Execution time = 3.4947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473563858959
                                         uncertainty =       0.004451860910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473563858959
                                         uncertainty =       0.004451860910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486580926
  error estimate for blocks of size 2^( 2) =       0.000507448413
  error estimate for blocks of size 2^( 3) =       0.000527922384
  error estimate for blocks of size 2^( 4) =       0.000543654753
  error estimate for blocks of size 2^( 5) =       0.000553851578
  error estimate for blocks of size 2^( 6) =       0.000560029883
  error estimate for blocks of size 2^( 7) =       0.000561023399

      target function =                  N/A
              le_mean =     -22.819740938188
             les_mean =     521.243087993446
             stat err =       0.000554639903
             autocorr =       1.299307847415
              std dev =       0.688129344964
             le_variance =       0.473521995401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473336207685
                                         uncertainty =       0.004346343303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473336207685
                                         uncertainty =       0.004346343303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486464678
  error estimate for blocks of size 2^( 2) =       0.000507359310
  error estimate for blocks of size 2^( 3) =       0.000527845865
  error estimate for blocks of size 2^( 4) =       0.000543610345
  error estimate for blocks of size 2^( 5) =       0.000553793179
  error estimate for blocks of size 2^( 6) =       0.000559959888
  error estimate for blocks of size 2^( 7) =       0.000561028648

      target function =                  N/A
              le_mean =     -22.819742003563
             les_mean =     521.252367795852
             stat err =       0.000554598015
             autocorr =       1.299732560452
              std dev =       0.687964944667
             le_variance =       0.473295765091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473338454042
                                         uncertainty =       0.004333696399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473338454042
                                         uncertainty =       0.004333696399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486465850
  error estimate for blocks of size 2^( 2) =       0.000507363690
  error estimate for blocks of size 2^( 3) =       0.000527852136
  error estimate for blocks of size 2^( 4) =       0.000543598390
  error estimate for blocks of size 2^( 5) =       0.000553781720
  error estimate for blocks of size 2^( 6) =       0.000559955764
  error estimate for blocks of size 2^( 7) =       0.000561044920

      target function =                  N/A
              le_mean =     -22.819738877961
             les_mean =     521.333954895796
             stat err =       0.000554595198
             autocorr =       1.299713094100
              std dev =       0.687966602645
             le_variance =       0.473298046354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473380820826
                                         uncertainty =       0.004427793679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473380820826
                                         uncertainty =       0.004427793679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486487047
  error estimate for blocks of size 2^( 2) =       0.000507363762
  error estimate for blocks of size 2^( 3) =       0.000527841852
  error estimate for blocks of size 2^( 4) =       0.000543578910
  error estimate for blocks of size 2^( 5) =       0.000553769510
  error estimate for blocks of size 2^( 6) =       0.000559961696
  error estimate for blocks of size 2^( 7) =       0.000560982073

      target function =                  N/A
              le_mean =     -22.819724223992
             les_mean =     521.242732080003
             stat err =       0.000554573047
             autocorr =       1.299496021390
              std dev =       0.687996580003
             le_variance =       0.473339294096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819740938188        initial
     3.6380e-02     3.6380e-01             2.1282e-03       -22.819742003563  <--
     1.4552e-01     1.4552e+00             1.3517e-03       -22.819738877961
     5.8208e-01     5.8208e+00             5.5052e-04       -22.819724223992

*****************************************************************************
Applying the update for shift_i =   3.6380e-02     and shift_s =   3.6380e-01
*****************************************************************************

  Execution time = 4.3333e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_01                 1.150506e-01 3 1  ON 0
ci_02                -2.626291e-02 3 1  ON 1
ci_03                -2.653498e-02 3 1  ON 2
ci_04                 2.474494e-02 3 1  ON 3
ci_05                -2.322656e-02 3 1  ON 4
ci_06                -2.298227e-02 3 1  ON 5
ci_07                 2.549934e-02 3 1  ON 6
ci_08                -4.335741e-03 3 1  ON 7
ci_09                -1.050838e-02 3 1  ON 8
ci_10                -1.166704e-02 3 1  ON 9
ci_11                 1.417862e-02 3 1  ON 10
ci_12                 1.052726e-02 3 1  ON 11
ci_13                 1.300051e-02 3 1  ON 12
ci_14                 1.825337e-02 3 1  ON 13
ci_15                 7.642260e-03 3 1  ON 14
ci_16                 6.540161e-03 3 1  ON 15
ci_17                -9.720993e-03 3 1  ON 16
ci_18                -9.059394e-03 3 1  ON 17
ci_19                 9.723185e-03 3 1  ON 18
ci_20                 1.006118e-02 3 1  ON 19
ci_21                 8.910177e-03 3 1  ON 20
ci_22                 8.925575e-03 3 1  ON 21
ci_23                 6.907324e-03 3 1  ON 22
ci_24                 7.941978e-03 3 1  ON 23
ci_25                 4.800389e-03 3 1  ON 24
ci_26                 2.248111e-03 3 1  ON 25
ci_27                 2.261632e-03 3 1  ON 26
ci_28                 3.852262e-03 3 1  ON 27
ci_29                 3.521397e-03 3 1  ON 28
ci_30                -5.910774e-05 3 1  ON 29
ci_31                -1.285942e-03 3 1  ON 30
ci_32                -1.177461e-04 3 1  ON 31
ci_33                -5.063975e-04 3 1  ON 32
ci_34                 1.446331e-03 3 1  ON 33
ci_35                 5.571121e-04 3 1  ON 34
ci_36                -6.896082e-04 3 1  ON 35
ci_37                -1.131245e-03 3 1  ON 36
ci_38                 3.466919e-04 3 1  ON 37
ci_39                -1.896087e-04 3 1  ON 38
ci_40                -1.759647e-03 3 1  ON 39
ci_41                 6.818069e-04 3 1  ON 40
ci_42                 3.288227e-05 3 1  ON 41
ci_43                -2.493129e-03 3 1  ON 42
ci_44                -1.803506e-03 3 1  ON 43
ci_45                 5.000385e-04 3 1  ON 44
ci_46                -6.184495e-04 3 1  ON 45
ci_47                 1.649212e-04 3 1  ON 46
ci_48                -1.480534e-04 3 1  ON 47
ci_49                -6.871000e-04 3 1  ON 48
ci_50                -8.180415e-04 3 1  ON 49
ci_51                -8.334828e-05 3 1  ON 50
ci_52                -3.434283e-04 3 1  ON 51
ci_53                -9.211417e-04 3 1  ON 52
ci_54                -1.648942e-03 3 1  ON 53
ci_55                -7.722387e-04 3 1  ON 54
ci_56                 1.404797e-03 3 1  ON 55
ci_57                 1.245206e-03 3 1  ON 56
ci_58                -8.175928e-04 3 1  ON 57
ci_59                -6.169981e-04 3 1  ON 58
ci_60                 1.810760e-03 3 1  ON 59
ci_61                 1.928673e-03 3 1  ON 60
ci_62                -7.253595e-04 3 1  ON 61
ci_63                 1.074284e-04 3 1  ON 62
ci_64                -1.407949e-05 3 1  ON 63
ci_65                 7.614353e-05 3 1  ON 64
ci_66                -1.380558e-04 3 1  ON 65
ci_67                -3.727910e-04 3 1  ON 66
ci_68                -7.521089e-05 3 1  ON 67
ci_69                -1.290027e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8392
    reference variance = 0.452522
====================================================
  Execution time = 2.5390e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2818e+01
  VMC Evar = 4.8138e-01
  Total weights = 1.963936147e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467128208746
                                         uncertainty =       0.002529980113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467128208746
                                         uncertainty =       0.002529980113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483228843
  error estimate for blocks of size 2^( 2) =       0.000504976396
  error estimate for blocks of size 2^( 3) =       0.000525474963
  error estimate for blocks of size 2^( 4) =       0.000541641602
  error estimate for blocks of size 2^( 5) =       0.000551390890
  error estimate for blocks of size 2^( 6) =       0.000556856576
  error estimate for blocks of size 2^( 7) =       0.000558512827

      target function =                  N/A
              le_mean =     -22.818337273010
             les_mean =     521.157892027987
             stat err =       0.000552100474
             autocorr =       1.305360729377
              std dev =       0.683388782815
             le_variance =       0.467020228477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281833727301e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818337272961       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818376097363       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818382343123       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818381863644       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818382702443       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818383209493       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.818383161792       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 2.479727e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818337272961       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818371399457       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818375742414       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818375225745       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818375632986       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.818375829024       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 2.032436e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.818337272961       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.818360268960       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.818361757605       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.818361470382       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.818361526151       residual = 1.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-01 is 1.181251e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251836 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9918e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.151836e-01 3 1  ON 0
ci_02                -2.666987e-02 3 1  ON 1
ci_03                -2.670458e-02 3 1  ON 2
ci_04                 2.564022e-02 3 1  ON 3
ci_05                -2.294900e-02 3 1  ON 4
ci_06                -2.355249e-02 3 1  ON 5
ci_07                 2.643725e-02 3 1  ON 6
ci_08                -4.298323e-03 3 1  ON 7
ci_09                -1.051155e-02 3 1  ON 8
ci_10                -1.229367e-02 3 1  ON 9
ci_11                 1.621105e-02 3 1  ON 10
ci_12                 1.090819e-02 3 1  ON 11
ci_13                 1.151334e-02 3 1  ON 12
ci_14                 1.666693e-02 3 1  ON 13
ci_15                 7.702567e-03 3 1  ON 14
ci_16                 7.707873e-03 3 1  ON 15
ci_17                -9.658514e-03 3 1  ON 16
ci_18                -9.265957e-03 3 1  ON 17
ci_19                 9.218111e-03 3 1  ON 18
ci_20                 1.087546e-02 3 1  ON 19
ci_21                 8.073688e-03 3 1  ON 20
ci_22                 7.958495e-03 3 1  ON 21
ci_23                 6.802428e-03 3 1  ON 22
ci_24                 6.151702e-03 3 1  ON 23
ci_25                 5.204377e-03 3 1  ON 24
ci_26                 2.384725e-03 3 1  ON 25
ci_27                 2.244341e-03 3 1  ON 26
ci_28                 3.883464e-03 3 1  ON 27
ci_29                 4.179243e-03 3 1  ON 28
ci_30                 7.160399e-04 3 1  ON 29
ci_31                 6.442946e-04 3 1  ON 30
ci_32                 4.873074e-04 3 1  ON 31
ci_33                 8.498799e-06 3 1  ON 32
ci_34                 7.222227e-04 3 1  ON 33
ci_35                -8.301351e-04 3 1  ON 34
ci_36                -1.009796e-03 3 1  ON 35
ci_37                -7.421261e-04 3 1  ON 36
ci_38                -5.661924e-04 3 1  ON 37
ci_39                 3.180690e-05 3 1  ON 38
ci_40                -1.088369e-03 3 1  ON 39
ci_41                 1.234031e-03 3 1  ON 40
ci_42                 1.464522e-04 3 1  ON 41
ci_43                -2.192323e-03 3 1  ON 42
ci_44                -2.161703e-03 3 1  ON 43
ci_45                -1.795117e-04 3 1  ON 44
ci_46                -7.585786e-04 3 1  ON 45
ci_47                -1.575984e-03 3 1  ON 46
ci_48                -7.008849e-04 3 1  ON 47
ci_49                -1.385134e-03 3 1  ON 48
ci_50                -3.315893e-04 3 1  ON 49
ci_51                 4.472377e-04 3 1  ON 50
ci_52                 1.780962e-05 3 1  ON 51
ci_53                -1.009852e-03 3 1  ON 52
ci_54                -1.557371e-03 3 1  ON 53
ci_55                -1.348200e-03 3 1  ON 54
ci_56                 2.196043e-03 3 1  ON 55
ci_57                 1.304642e-03 3 1  ON 56
ci_58                -8.355310e-04 3 1  ON 57
ci_59                -1.879258e-03 3 1  ON 58
ci_60                 6.374822e-04 3 1  ON 59
ci_61                 1.477504e-03 3 1  ON 60
ci_62                -5.426204e-04 3 1  ON 61
ci_63                 9.554869e-05 3 1  ON 62
ci_64                -5.061233e-04 3 1  ON 63
ci_65                -6.536284e-04 3 1  ON 64
ci_66                 4.045451e-04 3 1  ON 65
ci_67                -5.426862e-04 3 1  ON 66
ci_68                -1.497324e-03 3 1  ON 67
ci_69                -1.892904e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7704
    reference variance = 0.338071
====================================================
  Execution time = 2.5132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9420e-01
  Total weights = 1.9637e+06
  Execution time = 3.4865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00110693
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474125045495
                                         uncertainty =       0.002977469699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474125045495
                                         uncertainty =       0.002977469699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486853134
  error estimate for blocks of size 2^( 2) =       0.000508440476
  error estimate for blocks of size 2^( 3) =       0.000528801107
  error estimate for blocks of size 2^( 4) =       0.000543570401
  error estimate for blocks of size 2^( 5) =       0.000553156476
  error estimate for blocks of size 2^( 6) =       0.000559279798
  error estimate for blocks of size 2^( 7) =       0.000564514792

      target function =                  N/A
              le_mean =     -22.819351119530
             les_mean =     521.358976697050
             stat err =       0.000555130367
             autocorr =       1.300151702885
              std dev =       0.688514305590
             le_variance =       0.474051949001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475016201679
                                         uncertainty =       0.004047789112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.475016201679
                                         uncertainty =       0.004047789112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487305397
  error estimate for blocks of size 2^( 2) =       0.000508834224
  error estimate for blocks of size 2^( 3) =       0.000529174477
  error estimate for blocks of size 2^( 4) =       0.000543920841
  error estimate for blocks of size 2^( 5) =       0.000553567724
  error estimate for blocks of size 2^( 6) =       0.000559748554
  error estimate for blocks of size 2^( 7) =       0.000564992588

      target function =                  N/A
              le_mean =     -22.819330917424
             les_mean =     521.288456399718
             stat err =       0.000555557427
             autocorr =       1.299736969725
              std dev =       0.689153901881
             le_variance =       0.474933100477

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00111634
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478722858449
                                         uncertainty =       0.006326925555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.478722858449
                                         uncertainty =       0.006326925555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000489193505
  error estimate for blocks of size 2^( 2) =       0.000510634455
  error estimate for blocks of size 2^( 3) =       0.000530905598
  error estimate for blocks of size 2^( 4) =       0.000545568813
  error estimate for blocks of size 2^( 5) =       0.000555185637
  error estimate for blocks of size 2^( 6) =       0.000561409580
  error estimate for blocks of size 2^( 7) =       0.000566620573

      target function =                  N/A
              le_mean =     -22.819398528915
             les_mean =     521.352121761374
             stat err =       0.000557196151
             autocorr =       1.297343114701
              std dev =       0.691824088949
             le_variance =       0.478620570050

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0560129
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474157642192
                                         uncertainty =       0.003472524002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474157642192
                                         uncertainty =       0.003472524002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486867736
  error estimate for blocks of size 2^( 2) =       0.000508418779
  error estimate for blocks of size 2^( 3) =       0.000528773836
  error estimate for blocks of size 2^( 4) =       0.000543533348
  error estimate for blocks of size 2^( 5) =       0.000553183501
  error estimate for blocks of size 2^( 6) =       0.000559303148
  error estimate for blocks of size 2^( 7) =       0.000564523430

      target function =                  N/A
              le_mean =     -22.819333965150
             les_mean =     521.491761469846
             stat err =       0.000555135857
             autocorr =       1.300099432241
              std dev =       0.688534955381
             le_variance =       0.474080384782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819351119530        initial
     9.0949e-03     9.0949e-02             2.4797e-03       -22.819330917424
     3.6380e-02     3.6380e-01             2.0324e-03       -22.819398528915  <--
     1.4552e-01     1.4552e+00             1.1813e-03       -22.819333965150

*****************************************************************************
Applying the update for shift_i =   3.6380e-02     and shift_s =   3.6380e-01
*****************************************************************************

  Execution time = 4.2647e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_01                 1.151836e-01 3 1  ON 0
ci_02                -2.666987e-02 3 1  ON 1
ci_03                -2.670458e-02 3 1  ON 2
ci_04                 2.564022e-02 3 1  ON 3
ci_05                -2.294900e-02 3 1  ON 4
ci_06                -2.355249e-02 3 1  ON 5
ci_07                 2.643725e-02 3 1  ON 6
ci_08                -4.298323e-03 3 1  ON 7
ci_09                -1.051155e-02 3 1  ON 8
ci_10                -1.229367e-02 3 1  ON 9
ci_11                 1.621105e-02 3 1  ON 10
ci_12                 1.090819e-02 3 1  ON 11
ci_13                 1.151334e-02 3 1  ON 12
ci_14                 1.666693e-02 3 1  ON 13
ci_15                 7.702567e-03 3 1  ON 14
ci_16                 7.707873e-03 3 1  ON 15
ci_17                -9.658514e-03 3 1  ON 16
ci_18                -9.265957e-03 3 1  ON 17
ci_19                 9.218111e-03 3 1  ON 18
ci_20                 1.087546e-02 3 1  ON 19
ci_21                 8.073688e-03 3 1  ON 20
ci_22                 7.958495e-03 3 1  ON 21
ci_23                 6.802428e-03 3 1  ON 22
ci_24                 6.151702e-03 3 1  ON 23
ci_25                 5.204377e-03 3 1  ON 24
ci_26                 2.384725e-03 3 1  ON 25
ci_27                 2.244341e-03 3 1  ON 26
ci_28                 3.883464e-03 3 1  ON 27
ci_29                 4.179243e-03 3 1  ON 28
ci_30                 7.160399e-04 3 1  ON 29
ci_31                 6.442946e-04 3 1  ON 30
ci_32                 4.873074e-04 3 1  ON 31
ci_33                 8.498799e-06 3 1  ON 32
ci_34                 7.222227e-04 3 1  ON 33
ci_35                -8.301351e-04 3 1  ON 34
ci_36                -1.009796e-03 3 1  ON 35
ci_37                -7.421261e-04 3 1  ON 36
ci_38                -5.661924e-04 3 1  ON 37
ci_39                 3.180690e-05 3 1  ON 38
ci_40                -1.088369e-03 3 1  ON 39
ci_41                 1.234031e-03 3 1  ON 40
ci_42                 1.464522e-04 3 1  ON 41
ci_43                -2.192323e-03 3 1  ON 42
ci_44                -2.161703e-03 3 1  ON 43
ci_45                -1.795117e-04 3 1  ON 44
ci_46                -7.585786e-04 3 1  ON 45
ci_47                -1.575984e-03 3 1  ON 46
ci_48                -7.008849e-04 3 1  ON 47
ci_49                -1.385134e-03 3 1  ON 48
ci_50                -3.315893e-04 3 1  ON 49
ci_51                 4.472377e-04 3 1  ON 50
ci_52                 1.780962e-05 3 1  ON 51
ci_53                -1.009852e-03 3 1  ON 52
ci_54                -1.557371e-03 3 1  ON 53
ci_55                -1.348200e-03 3 1  ON 54
ci_56                 2.196043e-03 3 1  ON 55
ci_57                 1.304642e-03 3 1  ON 56
ci_58                -8.355310e-04 3 1  ON 57
ci_59                -1.879258e-03 3 1  ON 58
ci_60                 6.374822e-04 3 1  ON 59
ci_61                 1.477504e-03 3 1  ON 60
ci_62                -5.426204e-04 3 1  ON 61
ci_63                 9.554869e-05 3 1  ON 62
ci_64                -5.061233e-04 3 1  ON 63
ci_65                -6.536284e-04 3 1  ON 64
ci_66                 4.045451e-04 3 1  ON 65
ci_67                -5.426862e-04 3 1  ON 66
ci_68                -1.497324e-03 3 1  ON 67
ci_69                -1.892904e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.8253
    reference variance = 0.380472
====================================================
  Execution time = 2.5440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.8061e-01
  Total weights = 1.963844857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467527489351
                                         uncertainty =       0.002280954076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.467527489351
                                         uncertainty =       0.002280954076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000483565518
  error estimate for blocks of size 2^( 2) =       0.000505266026
  error estimate for blocks of size 2^( 3) =       0.000525438003
  error estimate for blocks of size 2^( 4) =       0.000541707580
  error estimate for blocks of size 2^( 5) =       0.000550823653
  error estimate for blocks of size 2^( 6) =       0.000554784749
  error estimate for blocks of size 2^( 7) =       0.000559630035

      target function =                  N/A
              le_mean =     -22.819524502222
             les_mean =     521.211306084492
             stat err =       0.000551736504
             autocorr =       1.301825542971
              std dev =       0.683864913533
             le_variance =       0.467671219962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281952450222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-03, overlap shift 9.0949e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819524502143       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819537399096       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819539500661       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819540217303       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819539769855       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.819539743777       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-03 is 1.697116e-03

solving harmonic davidson linear method for identity shift 3.6380e-02, overlap shift 3.6380e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819524502143       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819536006909       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819537533254       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819538001485       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819537733631       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-02 is 1.395480e-03

solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819524502143       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819532537384       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819533139121       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819533281839       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-01 is 1.003557e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256853 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9941e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.154441e-01 3 1  ON 0
ci_02                -2.626021e-02 3 1  ON 1
ci_03                -2.601876e-02 3 1  ON 2
ci_04                 2.507876e-02 3 1  ON 3
ci_05                -2.313321e-02 3 1  ON 4
ci_06                -2.353956e-02 3 1  ON 5
ci_07                 2.597312e-02 3 1  ON 6
ci_08                -4.222527e-03 3 1  ON 7
ci_09                -1.157784e-02 3 1  ON 8
ci_10                -1.144042e-02 3 1  ON 9
ci_11                 1.492964e-02 3 1  ON 10
ci_12                 1.168839e-02 3 1  ON 11
ci_13                 1.180199e-02 3 1  ON 12
ci_14                 1.679982e-02 3 1  ON 13
ci_15                 7.977212e-03 3 1  ON 14
ci_16                 7.856527e-03 3 1  ON 15
ci_17                -1.024806e-02 3 1  ON 16
ci_18                -8.629567e-03 3 1  ON 17
ci_19                 9.565680e-03 3 1  ON 18
ci_20                 1.112186e-02 3 1  ON 19
ci_21                 8.057077e-03 3 1  ON 20
ci_22                 8.985113e-03 3 1  ON 21
ci_23                 5.722003e-03 3 1  ON 22
ci_24                 6.490160e-03 3 1  ON 23
ci_25                 5.456680e-03 3 1  ON 24
ci_26                 3.141837e-03 3 1  ON 25
ci_27                 3.295710e-03 3 1  ON 26
ci_28                 3.944551e-03 3 1  ON 27
ci_29                 4.139655e-03 3 1  ON 28
ci_30                 1.492071e-03 3 1  ON 29
ci_31                -7.072819e-04 3 1  ON 30
ci_32                 4.491289e-04 3 1  ON 31
ci_33                -2.195855e-04 3 1  ON 32
ci_34                 1.042863e-04 3 1  ON 33
ci_35                -1.805899e-04 3 1  ON 34
ci_36                -1.281283e-03 3 1  ON 35
ci_37                -1.070821e-03 3 1  ON 36
ci_38                -7.361774e-04 3 1  ON 37
ci_39                -8.469076e-05 3 1  ON 38
ci_40                -7.858694e-04 3 1  ON 39
ci_41                 9.736903e-04 3 1  ON 40
ci_42                 9.769560e-04 3 1  ON 41
ci_43                -1.594726e-03 3 1  ON 42
ci_44                -2.476307e-03 3 1  ON 43
ci_45                -6.622235e-04 3 1  ON 44
ci_46                 5.987304e-04 3 1  ON 45
ci_47                -1.904823e-03 3 1  ON 46
ci_48                -9.421143e-04 3 1  ON 47
ci_49                -1.258855e-03 3 1  ON 48
ci_50                -3.910650e-04 3 1  ON 49
ci_51                 3.189067e-04 3 1  ON 50
ci_52                -9.692649e-05 3 1  ON 51
ci_53                -7.600849e-04 3 1  ON 52
ci_54                -1.026465e-03 3 1  ON 53
ci_55                -1.231098e-03 3 1  ON 54
ci_56                 1.696426e-03 3 1  ON 55
ci_57                 2.019584e-03 3 1  ON 56
ci_58                -9.366373e-04 3 1  ON 57
ci_59                -1.174531e-03 3 1  ON 58
ci_60                 5.416929e-04 3 1  ON 59
ci_61                 5.781644e-04 3 1  ON 60
ci_62                 2.793005e-04 3 1  ON 61
ci_63                -3.902991e-04 3 1  ON 62
ci_64                -3.382690e-04 3 1  ON 63
ci_65                -8.791290e-04 3 1  ON 64
ci_66                -9.909352e-04 3 1  ON 65
ci_67                 2.025521e-04 3 1  ON 66
ci_68                -1.021497e-03 3 1  ON 67
ci_69                -1.018887e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7279
    reference variance = 0.462204
====================================================
  Execution time = 2.5140e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8544e-01
  Total weights = 1.9638e+06
  Execution time = 3.4860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00131767
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470614330622
                                         uncertainty =       0.002004565083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470614330622
                                         uncertainty =       0.002004565083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485108556
  error estimate for blocks of size 2^( 2) =       0.000506224037
  error estimate for blocks of size 2^( 3) =       0.000526027174
  error estimate for blocks of size 2^( 4) =       0.000541412312
  error estimate for blocks of size 2^( 5) =       0.000551681381
  error estimate for blocks of size 2^( 6) =       0.000555669291
  error estimate for blocks of size 2^( 7) =       0.000560499869

      target function =                  N/A
              le_mean =     -22.819017354043
             les_mean =     521.223475692302
             stat err =       0.000552315713
             autocorr =       1.296274353858
              std dev =       0.686047099083
             le_variance =       0.470660622160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470252440271
                                         uncertainty =       0.001995717251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470252440271
                                         uncertainty =       0.001995717251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484923968
  error estimate for blocks of size 2^( 2) =       0.000506074455
  error estimate for blocks of size 2^( 3) =       0.000525930254
  error estimate for blocks of size 2^( 4) =       0.000541313556
  error estimate for blocks of size 2^( 5) =       0.000551609852
  error estimate for blocks of size 2^( 6) =       0.000555685780
  error estimate for blocks of size 2^( 7) =       0.000560515633

      target function =                  N/A
              le_mean =     -22.818978660931
             les_mean =     521.191912009549
             stat err =       0.000552281205
             autocorr =       1.297099306849
              std dev =       0.685786052231
             le_variance =       0.470302509434

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00130615
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472661520362
                                         uncertainty =       0.002372790424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.472661520362
                                         uncertainty =       0.002372790424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486164337
  error estimate for blocks of size 2^( 2) =       0.000507256658
  error estimate for blocks of size 2^( 3) =       0.000527085969
  error estimate for blocks of size 2^( 4) =       0.000542451130
  error estimate for blocks of size 2^( 5) =       0.000552665669
  error estimate for blocks of size 2^( 6) =       0.000556747994
  error estimate for blocks of size 2^( 7) =       0.000561701060

      target function =                  N/A
              le_mean =     -22.818994039060
             les_mean =     521.437811986975
             stat err =       0.000553391463
             autocorr =       1.295682863488
              std dev =       0.687540199279
             le_variance =       0.472711525624

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.068657
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470167302901
                                         uncertainty =       0.001980501867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470167302901
                                         uncertainty =       0.001980501867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484878938
  error estimate for blocks of size 2^( 2) =       0.000506026562
  error estimate for blocks of size 2^( 3) =       0.000525868333
  error estimate for blocks of size 2^( 4) =       0.000541251521
  error estimate for blocks of size 2^( 5) =       0.000551538193
  error estimate for blocks of size 2^( 6) =       0.000555593561
  error estimate for blocks of size 2^( 7) =       0.000560420974

      target function =                  N/A
              le_mean =     -22.818986688701
             les_mean =     521.196109590143
             stat err =       0.000552201062
             autocorr =       1.296963744887
              std dev =       0.685722370106
             le_variance =       0.470215168864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819017354043        initial  <--
     9.0949e-03     9.0949e-02             1.6971e-03       -22.818978660931
     3.6380e-02     3.6380e-01             1.3955e-03       -22.818994039060
     1.4552e-01     1.4552e+00             1.0036e-03       -22.818986688701

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6257
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_01                 1.151836e-01 3 1  ON 0
ci_02                -2.666987e-02 3 1  ON 1
ci_03                -2.670458e-02 3 1  ON 2
ci_04                 2.564022e-02 3 1  ON 3
ci_05                -2.294900e-02 3 1  ON 4
ci_06                -2.355249e-02 3 1  ON 5
ci_07                 2.643725e-02 3 1  ON 6
ci_08                -4.298323e-03 3 1  ON 7
ci_09                -1.051155e-02 3 1  ON 8
ci_10                -1.229367e-02 3 1  ON 9
ci_11                 1.621105e-02 3 1  ON 10
ci_12                 1.090819e-02 3 1  ON 11
ci_13                 1.151334e-02 3 1  ON 12
ci_14                 1.666693e-02 3 1  ON 13
ci_15                 7.702567e-03 3 1  ON 14
ci_16                 7.707873e-03 3 1  ON 15
ci_17                -9.658514e-03 3 1  ON 16
ci_18                -9.265957e-03 3 1  ON 17
ci_19                 9.218111e-03 3 1  ON 18
ci_20                 1.087546e-02 3 1  ON 19
ci_21                 8.073688e-03 3 1  ON 20
ci_22                 7.958495e-03 3 1  ON 21
ci_23                 6.802428e-03 3 1  ON 22
ci_24                 6.151702e-03 3 1  ON 23
ci_25                 5.204377e-03 3 1  ON 24
ci_26                 2.384725e-03 3 1  ON 25
ci_27                 2.244341e-03 3 1  ON 26
ci_28                 3.883464e-03 3 1  ON 27
ci_29                 4.179243e-03 3 1  ON 28
ci_30                 7.160399e-04 3 1  ON 29
ci_31                 6.442946e-04 3 1  ON 30
ci_32                 4.873074e-04 3 1  ON 31
ci_33                 8.498799e-06 3 1  ON 32
ci_34                 7.222227e-04 3 1  ON 33
ci_35                -8.301351e-04 3 1  ON 34
ci_36                -1.009796e-03 3 1  ON 35
ci_37                -7.421261e-04 3 1  ON 36
ci_38                -5.661924e-04 3 1  ON 37
ci_39                 3.180690e-05 3 1  ON 38
ci_40                -1.088369e-03 3 1  ON 39
ci_41                 1.234031e-03 3 1  ON 40
ci_42                 1.464522e-04 3 1  ON 41
ci_43                -2.192323e-03 3 1  ON 42
ci_44                -2.161703e-03 3 1  ON 43
ci_45                -1.795117e-04 3 1  ON 44
ci_46                -7.585786e-04 3 1  ON 45
ci_47                -1.575984e-03 3 1  ON 46
ci_48                -7.008849e-04 3 1  ON 47
ci_49                -1.385134e-03 3 1  ON 48
ci_50                -3.315893e-04 3 1  ON 49
ci_51                 4.472377e-04 3 1  ON 50
ci_52                 1.780962e-05 3 1  ON 51
ci_53                -1.009852e-03 3 1  ON 52
ci_54                -1.557371e-03 3 1  ON 53
ci_55                -1.348200e-03 3 1  ON 54
ci_56                 2.196043e-03 3 1  ON 55
ci_57                 1.304642e-03 3 1  ON 56
ci_58                -8.355310e-04 3 1  ON 57
ci_59                -1.879258e-03 3 1  ON 58
ci_60                 6.374822e-04 3 1  ON 59
ci_61                 1.477504e-03 3 1  ON 60
ci_62                -5.426204e-04 3 1  ON 61
ci_63                 9.554869e-05 3 1  ON 62
ci_64                -5.061233e-04 3 1  ON 63
ci_65                -6.536284e-04 3 1  ON 64
ci_66                 4.045451e-04 3 1  ON 65
ci_67                -5.426862e-04 3 1  ON 66
ci_68                -1.497324e-03 3 1  ON 67
ci_69                -1.892904e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7606
    reference variance = 0.386608
====================================================
  Execution time = 2.5652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9421e-01
  Total weights = 1.963545296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476602803657
                                         uncertainty =       0.003872038502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.476602803657
                                         uncertainty =       0.003872038502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000488134476
  error estimate for blocks of size 2^( 2) =       0.000509207571
  error estimate for blocks of size 2^( 3) =       0.000529796126
  error estimate for blocks of size 2^( 4) =       0.000545623483
  error estimate for blocks of size 2^( 5) =       0.000556540541
  error estimate for blocks of size 2^( 6) =       0.000562024936
  error estimate for blocks of size 2^( 7) =       0.000563719942

      target function =                  N/A
              le_mean =     -22.819274729352
             les_mean =     521.213509733259
             stat err =       0.000556977225
             autocorr =       1.301954813012
              std dev =       0.690326395591
             le_variance =       0.476550532449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281927472935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-02, overlap shift 9.0949e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819274729305       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819296715141       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819292985411       residual = 8.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819292737375       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.819292996768       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-02 is 1.679781e-03

solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819274729305       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819286413889       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819284971713       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819285021764       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e-01 is 6.952584e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819274729305       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819278794686       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819278421102       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819278474351       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+00 is 2.509575e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0165e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.148098e-01 3 1  ON 0
ci_02                -2.689181e-02 3 1  ON 1
ci_03                -2.665207e-02 3 1  ON 2
ci_04                 2.519078e-02 3 1  ON 3
ci_05                -2.308885e-02 3 1  ON 4
ci_06                -2.354891e-02 3 1  ON 5
ci_07                 2.623284e-02 3 1  ON 6
ci_08                -4.069266e-03 3 1  ON 7
ci_09                -1.072723e-02 3 1  ON 8
ci_10                -1.240777e-02 3 1  ON 9
ci_11                 1.573842e-02 3 1  ON 10
ci_12                 1.123221e-02 3 1  ON 11
ci_13                 1.204570e-02 3 1  ON 12
ci_14                 1.669596e-02 3 1  ON 13
ci_15                 7.784454e-03 3 1  ON 14
ci_16                 7.833257e-03 3 1  ON 15
ci_17                -9.424844e-03 3 1  ON 16
ci_18                -9.530202e-03 3 1  ON 17
ci_19                 9.367137e-03 3 1  ON 18
ci_20                 1.053806e-02 3 1  ON 19
ci_21                 8.009739e-03 3 1  ON 20
ci_22                 7.724206e-03 3 1  ON 21
ci_23                 6.276896e-03 3 1  ON 22
ci_24                 6.197105e-03 3 1  ON 23
ci_25                 5.160116e-03 3 1  ON 24
ci_26                 2.333427e-03 3 1  ON 25
ci_27                 2.597629e-03 3 1  ON 26
ci_28                 3.491457e-03 3 1  ON 27
ci_29                 3.979590e-03 3 1  ON 28
ci_30                 3.356677e-04 3 1  ON 29
ci_31                 1.318041e-03 3 1  ON 30
ci_32                -1.802599e-04 3 1  ON 31
ci_33                -5.060116e-04 3 1  ON 32
ci_34                 5.423155e-04 3 1  ON 33
ci_35                -9.062571e-04 3 1  ON 34
ci_36                -1.122903e-03 3 1  ON 35
ci_37                -7.663493e-04 3 1  ON 36
ci_38                -7.123206e-04 3 1  ON 37
ci_39                -5.471771e-05 3 1  ON 38
ci_40                -1.454892e-03 3 1  ON 39
ci_41                 9.691226e-04 3 1  ON 40
ci_42                 5.618544e-04 3 1  ON 41
ci_43                -2.268196e-03 3 1  ON 42
ci_44                -2.439255e-03 3 1  ON 43
ci_45                 5.552294e-05 3 1  ON 44
ci_46                -6.332024e-05 3 1  ON 45
ci_47                -1.958741e-03 3 1  ON 46
ci_48                -6.662673e-04 3 1  ON 47
ci_49                -1.181920e-03 3 1  ON 48
ci_50                -4.927986e-04 3 1  ON 49
ci_51                 7.801907e-04 3 1  ON 50
ci_52                 2.816602e-04 3 1  ON 51
ci_53                -1.226355e-03 3 1  ON 52
ci_54                -1.680812e-03 3 1  ON 53
ci_55                -1.287110e-03 3 1  ON 54
ci_56                 1.707230e-03 3 1  ON 55
ci_57                 7.984565e-04 3 1  ON 56
ci_58                -6.775754e-04 3 1  ON 57
ci_59                -1.413868e-03 3 1  ON 58
ci_60                 1.253607e-03 3 1  ON 59
ci_61                 1.259719e-03 3 1  ON 60
ci_62                -2.073294e-04 3 1  ON 61
ci_63                -2.279209e-04 3 1  ON 62
ci_64                -4.419610e-04 3 1  ON 63
ci_65                -9.383810e-04 3 1  ON 64
ci_66                 9.363390e-05 3 1  ON 65
ci_67                -1.998113e-04 3 1  ON 66
ci_68                -1.935350e-03 3 1  ON 67
ci_69                -1.972224e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.9287
    reference variance = 0.589956
====================================================
  Execution time = 2.4732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.8557e-01
  Total weights = 1.9638e+06
  Execution time = 3.5021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469383198069
                                         uncertainty =       0.001848656014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469383198069
                                         uncertainty =       0.001848656014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484449198
  error estimate for blocks of size 2^( 2) =       0.000505795061
  error estimate for blocks of size 2^( 3) =       0.000525918386
  error estimate for blocks of size 2^( 4) =       0.000540989809
  error estimate for blocks of size 2^( 5) =       0.000551180936
  error estimate for blocks of size 2^( 6) =       0.000555990535
  error estimate for blocks of size 2^( 7) =       0.000559425906

      target function =                  N/A
              le_mean =     -22.819492184601
             les_mean =     521.227656314115
             stat err =       0.000551896797
             autocorr =       1.297834350983
              std dev =       0.685114625447
             le_variance =       0.469382050001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469353425530
                                         uncertainty =       0.001842932390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469353425530
                                         uncertainty =       0.001842932390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484433126
  error estimate for blocks of size 2^( 2) =       0.000505808258
  error estimate for blocks of size 2^( 3) =       0.000525949552
  error estimate for blocks of size 2^( 4) =       0.000541057319
  error estimate for blocks of size 2^( 5) =       0.000551265176
  error estimate for blocks of size 2^( 6) =       0.000556097943
  error estimate for blocks of size 2^( 7) =       0.000559446388

      target function =                  N/A
              le_mean =     -22.819478411073
             les_mean =     521.225238743166
             stat err =       0.000551966707
             autocorr =       1.298249307137
              std dev =       0.685091897211
             le_variance =       0.469350907625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469390807640
                                         uncertainty =       0.001844699570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469390807640
                                         uncertainty =       0.001844699570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484452529
  error estimate for blocks of size 2^( 2) =       0.000505828168
  error estimate for blocks of size 2^( 3) =       0.000525965179
  error estimate for blocks of size 2^( 4) =       0.000541075696
  error estimate for blocks of size 2^( 5) =       0.000551282585
  error estimate for blocks of size 2^( 6) =       0.000556106505
  error estimate for blocks of size 2^( 7) =       0.000559483257

      target function =                  N/A
              le_mean =     -22.819476156550
             les_mean =     521.220253519339
             stat err =       0.000551987011
             autocorr =       1.298240826075
              std dev =       0.685119336354
             le_variance =       0.469388505046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469315166257
                                         uncertainty =       0.001847957644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.469315166257
                                         uncertainty =       0.001847957644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484414080
  error estimate for blocks of size 2^( 2) =       0.000505765923
  error estimate for blocks of size 2^( 3) =       0.000525892610
  error estimate for blocks of size 2^( 4) =       0.000540972660
  error estimate for blocks of size 2^( 5) =       0.000551170728
  error estimate for blocks of size 2^( 6) =       0.000555984427
  error estimate for blocks of size 2^( 7) =       0.000559418535

      target function =                  N/A
              le_mean =     -22.819479413339
             les_mean =     521.217441041732
             stat err =       0.000551886587
             autocorr =       1.297974507502
              std dev =       0.685064961963
             le_variance =       0.469314002109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.819492184601        initial  <--
     9.0949e-02     9.0949e-01             1.6798e-03       -22.819478411073
     3.6380e-01     3.6380e+00             6.9526e-04       -22.819476156550
     1.4552e+00     1.4552e+01             2.5096e-04       -22.819479413339

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2538
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_01                 1.151836e-01 3 1  ON 0
ci_02                -2.666987e-02 3 1  ON 1
ci_03                -2.670458e-02 3 1  ON 2
ci_04                 2.564022e-02 3 1  ON 3
ci_05                -2.294900e-02 3 1  ON 4
ci_06                -2.355249e-02 3 1  ON 5
ci_07                 2.643725e-02 3 1  ON 6
ci_08                -4.298323e-03 3 1  ON 7
ci_09                -1.051155e-02 3 1  ON 8
ci_10                -1.229367e-02 3 1  ON 9
ci_11                 1.621105e-02 3 1  ON 10
ci_12                 1.090819e-02 3 1  ON 11
ci_13                 1.151334e-02 3 1  ON 12
ci_14                 1.666693e-02 3 1  ON 13
ci_15                 7.702567e-03 3 1  ON 14
ci_16                 7.707873e-03 3 1  ON 15
ci_17                -9.658514e-03 3 1  ON 16
ci_18                -9.265957e-03 3 1  ON 17
ci_19                 9.218111e-03 3 1  ON 18
ci_20                 1.087546e-02 3 1  ON 19
ci_21                 8.073688e-03 3 1  ON 20
ci_22                 7.958495e-03 3 1  ON 21
ci_23                 6.802428e-03 3 1  ON 22
ci_24                 6.151702e-03 3 1  ON 23
ci_25                 5.204377e-03 3 1  ON 24
ci_26                 2.384725e-03 3 1  ON 25
ci_27                 2.244341e-03 3 1  ON 26
ci_28                 3.883464e-03 3 1  ON 27
ci_29                 4.179243e-03 3 1  ON 28
ci_30                 7.160399e-04 3 1  ON 29
ci_31                 6.442946e-04 3 1  ON 30
ci_32                 4.873074e-04 3 1  ON 31
ci_33                 8.498799e-06 3 1  ON 32
ci_34                 7.222227e-04 3 1  ON 33
ci_35                -8.301351e-04 3 1  ON 34
ci_36                -1.009796e-03 3 1  ON 35
ci_37                -7.421261e-04 3 1  ON 36
ci_38                -5.661924e-04 3 1  ON 37
ci_39                 3.180690e-05 3 1  ON 38
ci_40                -1.088369e-03 3 1  ON 39
ci_41                 1.234031e-03 3 1  ON 40
ci_42                 1.464522e-04 3 1  ON 41
ci_43                -2.192323e-03 3 1  ON 42
ci_44                -2.161703e-03 3 1  ON 43
ci_45                -1.795117e-04 3 1  ON 44
ci_46                -7.585786e-04 3 1  ON 45
ci_47                -1.575984e-03 3 1  ON 46
ci_48                -7.008849e-04 3 1  ON 47
ci_49                -1.385134e-03 3 1  ON 48
ci_50                -3.315893e-04 3 1  ON 49
ci_51                 4.472377e-04 3 1  ON 50
ci_52                 1.780962e-05 3 1  ON 51
ci_53                -1.009852e-03 3 1  ON 52
ci_54                -1.557371e-03 3 1  ON 53
ci_55                -1.348200e-03 3 1  ON 54
ci_56                 2.196043e-03 3 1  ON 55
ci_57                 1.304642e-03 3 1  ON 56
ci_58                -8.355310e-04 3 1  ON 57
ci_59                -1.879258e-03 3 1  ON 58
ci_60                 6.374822e-04 3 1  ON 59
ci_61                 1.477504e-03 3 1  ON 60
ci_62                -5.426204e-04 3 1  ON 61
ci_63                 9.554869e-05 3 1  ON 62
ci_64                -5.061233e-04 3 1  ON 63
ci_65                -6.536284e-04 3 1  ON 64
ci_66                 4.045451e-04 3 1  ON 65
ci_67                -5.426862e-04 3 1  ON 66
ci_68                -1.497324e-03 3 1  ON 67
ci_69                -1.892904e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7913
    reference variance = 0.694664
====================================================
  Execution time = 2.5368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2820e+01
  VMC Evar = 4.9038e-01
  Total weights = 1.963633930e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470405570113
                                         uncertainty =       0.002745311955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.470405570113
                                         uncertainty =       0.002745311955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000484946707
  error estimate for blocks of size 2^( 2) =       0.000506094428
  error estimate for blocks of size 2^( 3) =       0.000527116400
  error estimate for blocks of size 2^( 4) =       0.000542881072
  error estimate for blocks of size 2^( 5) =       0.000553127224
  error estimate for blocks of size 2^( 6) =       0.000560076485
  error estimate for blocks of size 2^( 7) =       0.000561018975

      target function =                  N/A
              le_mean =     -22.819655887499
             les_mean =     521.227077171494
             stat err =       0.000554275939
             autocorr =       1.306363459093
              std dev =       0.685818209696
             le_variance =       0.470346616751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281965588750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819655887460       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819657739710       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819658423495       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819658375819       residual = 8.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e-01 is 4.506236e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819655887460       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819656423406       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819656570851       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819656561775       residual = 7.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+00 is 1.278748e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.819655887460       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.819656026935       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.819656061023       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.819656059590       residual = 8.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+01 is 3.309166e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9874e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.152285e-01 3 1  ON 0
ci_02                -2.662055e-02 3 1  ON 1
ci_03                -2.668956e-02 3 1  ON 2
ci_04                 2.558978e-02 3 1  ON 3
ci_05                -2.293320e-02 3 1  ON 4
ci_06                -2.350682e-02 3 1  ON 5
ci_07                 2.639187e-02 3 1  ON 6
ci_08                -4.318919e-03 3 1  ON 7
ci_09                -1.058202e-02 3 1  ON 8
ci_10                -1.224252e-02 3 1  ON 9
ci_11                 1.624958e-02 3 1  ON 10
ci_12                 1.097527e-02 3 1  ON 11
ci_13                 1.155254e-02 3 1  ON 12
ci_14                 1.668910e-02 3 1  ON 13
ci_15                 7.737985e-03 3 1  ON 14
ci_16                 7.719335e-03 3 1  ON 15
ci_17                -9.635833e-03 3 1  ON 16
ci_18                -9.265290e-03 3 1  ON 17
ci_19                 9.136439e-03 3 1  ON 18
ci_20                 1.092421e-02 3 1  ON 19
ci_21                 8.090310e-03 3 1  ON 20
ci_22                 7.959060e-03 3 1  ON 21
ci_23                 6.760500e-03 3 1  ON 22
ci_24                 6.184949e-03 3 1  ON 23
ci_25                 5.157217e-03 3 1  ON 24
ci_26                 2.395114e-03 3 1  ON 25
ci_27                 2.218895e-03 3 1  ON 26
ci_28                 3.880327e-03 3 1  ON 27
ci_29                 4.093622e-03 3 1  ON 28
ci_30                 7.089336e-04 3 1  ON 29
ci_31                 6.557568e-04 3 1  ON 30
ci_32                 3.888355e-04 3 1  ON 31
ci_33                -6.563350e-05 3 1  ON 32
ci_34                 7.386992e-04 3 1  ON 33
ci_35                -7.022603e-04 3 1  ON 34
ci_36                -1.006720e-03 3 1  ON 35
ci_37                -7.270055e-04 3 1  ON 36
ci_38                -5.333031e-04 3 1  ON 37
ci_39                 3.348814e-05 3 1  ON 38
ci_40                -1.094317e-03 3 1  ON 39
ci_41                 1.296346e-03 3 1  ON 40
ci_42                 2.173554e-04 3 1  ON 41
ci_43                -2.224188e-03 3 1  ON 42
ci_44                -2.091290e-03 3 1  ON 43
ci_45                -1.043286e-04 3 1  ON 44
ci_46                -7.197898e-04 3 1  ON 45
ci_47                -1.520014e-03 3 1  ON 46
ci_48                -7.280734e-04 3 1  ON 47
ci_49                -1.353716e-03 3 1  ON 48
ci_50                -2.795570e-04 3 1  ON 49
ci_51                 3.890906e-04 3 1  ON 50
ci_52                 4.978568e-05 3 1  ON 51
ci_53                -1.024188e-03 3 1  ON 52
ci_54                -1.546862e-03 3 1  ON 53
ci_55                -1.317902e-03 3 1  ON 54
ci_56                 2.166063e-03 3 1  ON 55
ci_57                 1.315760e-03 3 1  ON 56
ci_58                -8.599988e-04 3 1  ON 57
ci_59                -1.819006e-03 3 1  ON 58
ci_60                 6.942413e-04 3 1  ON 59
ci_61                 1.508218e-03 3 1  ON 60
ci_62                -5.825474e-04 3 1  ON 61
ci_63                 1.427533e-04 3 1  ON 62
ci_64                -5.204915e-04 3 1  ON 63
ci_65                -5.577154e-04 3 1  ON 64
ci_66                 3.149354e-04 3 1  ON 65
ci_67                -5.246701e-04 3 1  ON 66
ci_68                -1.450582e-03 3 1  ON 67
ci_69                -1.870528e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7938
    reference variance = 0.57958
====================================================
  Execution time = 2.4812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2819e+01
  VMC Evar = 4.9192e-01
  Total weights = 1.9634e+06
  Execution time = 3.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473710595735
                                         uncertainty =       0.002863209466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473710595735
                                         uncertainty =       0.002863209466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486740578
  error estimate for blocks of size 2^( 2) =       0.000508220849
  error estimate for blocks of size 2^( 3) =       0.000528295242
  error estimate for blocks of size 2^( 4) =       0.000544743832
  error estimate for blocks of size 2^( 5) =       0.000554491590
  error estimate for blocks of size 2^( 6) =       0.000561675398
  error estimate for blocks of size 2^( 7) =       0.000565337994

      target function =                  N/A
              le_mean =     -22.818725833021
             les_mean =     521.186390319046
             stat err =       0.000556562203
             autocorr =       1.307471744379
              std dev =       0.688355126747
             le_variance =       0.473832780519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473777184292
                                         uncertainty =       0.002880506571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473777184292
                                         uncertainty =       0.002880506571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486775593
  error estimate for blocks of size 2^( 2) =       0.000508254738
  error estimate for blocks of size 2^( 3) =       0.000528329799
  error estimate for blocks of size 2^( 4) =       0.000544774018
  error estimate for blocks of size 2^( 5) =       0.000554518826
  error estimate for blocks of size 2^( 6) =       0.000561703631
  error estimate for blocks of size 2^( 7) =       0.000565381151

      target function =                  N/A
              le_mean =     -22.818725690556
             les_mean =     521.187328068329
             stat err =       0.000556594406
             autocorr =       1.307434937554
              std dev =       0.688404645354
             le_variance =       0.473900955745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473742574553
                                         uncertainty =       0.002873099196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473742574553
                                         uncertainty =       0.002873099196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486757435
  error estimate for blocks of size 2^( 2) =       0.000508237394
  error estimate for blocks of size 2^( 3) =       0.000528312264
  error estimate for blocks of size 2^( 4) =       0.000544758302
  error estimate for blocks of size 2^( 5) =       0.000554504999
  error estimate for blocks of size 2^( 6) =       0.000561690061
  error estimate for blocks of size 2^( 7) =       0.000565358989

      target function =                  N/A
              le_mean =     -22.818724822592
             les_mean =     521.188363635911
             stat err =       0.000556578088
             autocorr =       1.307455813203
              std dev =       0.688378966617
             le_variance =       0.473865601681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473713708749
                                         uncertainty =       0.002864453804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.473713708749
                                         uncertainty =       0.002864453804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486742231
  error estimate for blocks of size 2^( 2) =       0.000508222502
  error estimate for blocks of size 2^( 3) =       0.000528297008
  error estimate for blocks of size 2^( 4) =       0.000544745452
  error estimate for blocks of size 2^( 5) =       0.000554493294
  error estimate for blocks of size 2^( 6) =       0.000561677262
  error estimate for blocks of size 2^( 7) =       0.000565340097

      target function =                  N/A
              le_mean =     -22.818725658484
             les_mean =     521.191354822006
             stat err =       0.000556564026
             autocorr =       1.307471426323
              std dev =       0.688357464949
             le_variance =       0.473835999551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.818725833021        initial  <--
     9.0949e-01     9.0949e+00             4.5062e-04       -22.818725690556
     3.6380e+00     3.6380e+01             1.2787e-04       -22.818724822592
     1.4552e+01     1.4552e+02             3.3092e-05       -22.818725658484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5485
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_01                 1.151836e-01 3 1  ON 0
ci_02                -2.666987e-02 3 1  ON 1
ci_03                -2.670458e-02 3 1  ON 2
ci_04                 2.564022e-02 3 1  ON 3
ci_05                -2.294900e-02 3 1  ON 4
ci_06                -2.355249e-02 3 1  ON 5
ci_07                 2.643725e-02 3 1  ON 6
ci_08                -4.298323e-03 3 1  ON 7
ci_09                -1.051155e-02 3 1  ON 8
ci_10                -1.229367e-02 3 1  ON 9
ci_11                 1.621105e-02 3 1  ON 10
ci_12                 1.090819e-02 3 1  ON 11
ci_13                 1.151334e-02 3 1  ON 12
ci_14                 1.666693e-02 3 1  ON 13
ci_15                 7.702567e-03 3 1  ON 14
ci_16                 7.707873e-03 3 1  ON 15
ci_17                -9.658514e-03 3 1  ON 16
ci_18                -9.265957e-03 3 1  ON 17
ci_19                 9.218111e-03 3 1  ON 18
ci_20                 1.087546e-02 3 1  ON 19
ci_21                 8.073688e-03 3 1  ON 20
ci_22                 7.958495e-03 3 1  ON 21
ci_23                 6.802428e-03 3 1  ON 22
ci_24                 6.151702e-03 3 1  ON 23
ci_25                 5.204377e-03 3 1  ON 24
ci_26                 2.384725e-03 3 1  ON 25
ci_27                 2.244341e-03 3 1  ON 26
ci_28                 3.883464e-03 3 1  ON 27
ci_29                 4.179243e-03 3 1  ON 28
ci_30                 7.160399e-04 3 1  ON 29
ci_31                 6.442946e-04 3 1  ON 30
ci_32                 4.873074e-04 3 1  ON 31
ci_33                 8.498799e-06 3 1  ON 32
ci_34                 7.222227e-04 3 1  ON 33
ci_35                -8.301351e-04 3 1  ON 34
ci_36                -1.009796e-03 3 1  ON 35
ci_37                -7.421261e-04 3 1  ON 36
ci_38                -5.661924e-04 3 1  ON 37
ci_39                 3.180690e-05 3 1  ON 38
ci_40                -1.088369e-03 3 1  ON 39
ci_41                 1.234031e-03 3 1  ON 40
ci_42                 1.464522e-04 3 1  ON 41
ci_43                -2.192323e-03 3 1  ON 42
ci_44                -2.161703e-03 3 1  ON 43
ci_45                -1.795117e-04 3 1  ON 44
ci_46                -7.585786e-04 3 1  ON 45
ci_47                -1.575984e-03 3 1  ON 46
ci_48                -7.008849e-04 3 1  ON 47
ci_49                -1.385134e-03 3 1  ON 48
ci_50                -3.315893e-04 3 1  ON 49
ci_51                 4.472377e-04 3 1  ON 50
ci_52                 1.780962e-05 3 1  ON 51
ci_53                -1.009852e-03 3 1  ON 52
ci_54                -1.557371e-03 3 1  ON 53
ci_55                -1.348200e-03 3 1  ON 54
ci_56                 2.196043e-03 3 1  ON 55
ci_57                 1.304642e-03 3 1  ON 56
ci_58                -8.355310e-04 3 1  ON 57
ci_59                -1.879258e-03 3 1  ON 58
ci_60                 6.374822e-04 3 1  ON 59
ci_61                 1.477504e-03 3 1  ON 60
ci_62                -5.426204e-04 3 1  ON 61
ci_63                 9.554869e-05 3 1  ON 62
ci_64                -5.061233e-04 3 1  ON 63
ci_65                -6.536284e-04 3 1  ON 64
ci_66                 4.045451e-04 3 1  ON 65
ci_67                -5.426862e-04 3 1  ON 66
ci_68                -1.497324e-03 3 1  ON 67
ci_69                -1.892904e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5433e+01 secs
  Total Execution time = 2.9375e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
